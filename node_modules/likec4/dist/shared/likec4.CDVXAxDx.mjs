import*as B$ from"node:fs";import{unwatchFile as W$,watchFile as dq,watch as fq,stat as pq,mkdirSync as hq,existsSync as mq}from"node:fs";import*as Ue from"node:path";import ea,{dirname as G$,resolve as vw,join as gq,relative as yq,sep as vq,basename as wq}from"node:path";import{fileURLToPath as bq,pathToFileURL as kq}from"node:url";import{t as at,r as _q,e as vh,n as Rq,a as It,b as Fc,f as zc,g as pl,d as xn,c as Sq}from"./likec4.CB2-Uaub.mjs";import{isatty as $q}from"tty";import K$,{stripVTControlCharacters as Tq}from"node:util";
import Eq from"util";import ww from"path";import Pq from"os";import Z$ from"crypto";import Cq from"net";import xq from"url";import bw from"fs";import Aq from"child_process";import*as hl from"@likec4/core";import{invariant as Ke,BBox as Uc,LikeC4Styles as Iq,RichText as Nq,extractStep as Dq,_stage as kw,_layout as J$,isDynamicView as Y$,isElementView as _w,isDeploymentView as Oq,FqnRef as Vt,nonexhaustive as ht,nonNullable as di,preferSummary as X$,Fqn as Lq,ancestorsFqn as Mq,isAutoLayoutDirection as jq,
isGlobalFqn as Q$,isDeploymentNode as qq,splitGlobalFqn as Fq,isSameHierarchy as e0,isAncestor as Rw,RelationExpr as wh,FqnExpr as Sw,memoizeProp as zq,GlobalFqn as Uq,isNonEmptyArray as Mn,exact as ml,nameFromFqn as Hq,LinkedList as t0,isOrOperator as n0,isAndOperator as r0,_type as Vq,applyManualLayout as Bq,calcDriftsFromSnapshot as Wq}from"@likec4/core";import{bundleRequire as Gq}from"bundle-require";import*as Kq from"node:fs/promises";import Zq,{lstat as $w,stat as gl,readdir as i0,realpath as bh,
open as Jq,writeFile as Yq,unlink as Xq}from"node:fs/promises";import{L as Qq,b as s0,x as eF,c as tF,a as a0,l as Hc,R as o0}from"./likec4.CXTvqtC-.mjs";import{compareNaturalHierarchically as Tw,invariant as An,nonexhaustive as ta,hierarchyDistance as nF,nameFromFqn as kh,nonNullable as mr,compareFqnHierarchically as rF,delay as iF,promiseNextTick as Ew,BiMap as sF,DefaultMap as aF,memoizeProp as _h,stringHash as oF,isAnyOf as fi,isSameHierarchy as lF,ifilter as Pw,MultiMap as nr,DefaultWeakMap as l0,
sortNaturalByFqn as cF,ancestorsFqn as uF,compareNatural as c0,isNonEmptyArray as dF,sortByFqnHierarchically as u0,parentFqn as d0,toArray as fF,onNextTick as f0}from"@likec4/core/utils";import{fdir as p0}from"fdir";import{EventEmitter as pF,once as h0,on as hF}from"node:events";import{Readable as mF}from"node:stream";import gF,{type as yF}from"node:os";import{t as hn,a as yl}from"./likec4.DOUP9ptn.mjs";import ji,{hrtime as m0}from"node:process";import{createServer as vF}from"http";import{Http2ServerRequest as Rh}from"http2";
import{Readable as g0}from"stream";import{webcrypto as y0}from"node:crypto";import{Vector as wF}from"@likec4/core/geometry";import{Graph as bF}from"@likec4/core/utils/graphology";import{LikeC4Styles as kF,ThemeColors as _F,assignTagColors as RF,computeColorValues as SF}from"@likec4/core/styles";import{Graphviz as Vc}from"@hpcc-js/wasm-graphviz";import{computeProjectsView as $F,resolveRulesExtendedViews as TF,computeView as EF}from"@likec4/core/compute-view";import{LikeC4Model as qi,modelConnection as PF}from"@likec4/core/model";
import{Buffer as CF}from"buffer";import{Fqn as xF,exact as ds,FqnRef as Jn,_type as v0,_stage as Cw,isExtendsElementView as AF,FqnExpr as gr}from"@likec4/core/types";import IF from"boxen";import{spawn as NF}from"node:child_process";import{pipeline as DF}from"node:stream/promises";import*as OF from"node:readline/promises";import w0 from"fs/promises";function xw(t){if(t===null||typeof t!="object")return!1;const e=Object.getPrototypeOf(t);return e!==null&&e!==Object.prototype&&Object.getPrototypeOf(
e)!==null||Symbol.iterator in t?!1:Symbol.toStringTag in t?Object.prototype.toString.call(t)==="[object Module]":!0}function Aw(t,e,n=".",r){if(!xw(e))return Aw(t,{},n,r);const i=Object.assign({},e);for(const s in t){if(s==="__proto__"||s==="constructor")continue;const a=t[s];a!=null&&(r&&r(i,s,a,n)||(Array.isArray(a)&&Array.isArray(i[s])?i[s]=[...a,...i[s]]:xw(a)&&xw(i[s])?i[s]=Aw(a,i[s],(n?`${n}.`:"")+s.toString(),r):i[s]=a))}return i}function LF(t){return(...e)=>e.reduce((n,r)=>Aw(n,r,"",t),{})}
const Iw=LF();function Xt(t){return typeof t=="object"&&t!==null&&typeof t.$type=="string"}function Yr(t){return typeof t=="object"&&t!==null&&typeof t.$refText=="string"}function MF(t){return typeof t=="object"&&t!==null&&typeof t.name=="string"&&typeof t.type=="string"&&typeof t.path=="string"}function Sh(t){return typeof t=="object"&&t!==null&&Xt(t.container)&&Yr(t.reference)&&typeof t.message=="string"}class b0{constructor(){this.subtypes={},this.allSubtypes={}}isInstance(e,n){return Xt(e)&&
this.isSubtype(e.$type,n)}isSubtype(e,n){if(e===n)return!0;let r=this.subtypes[e];r||(r=this.subtypes[e]={});const i=r[n];if(i!==void 0)return i;{const s=this.computeIsSubtype(e,n);return r[n]=s,s}}getAllSubTypes(e){const n=this.allSubtypes[e];if(n)return n;{const r=this.getAllTypes(),i=[];for(const s of r)this.isSubtype(s,e)&&i.push(s);return this.allSubtypes[e]=i,i}}}function na(t){return typeof t=="object"&&t!==null&&Array.isArray(t.content)}function Wa(t){return typeof t=="object"&&t!==null&&
typeof t.tokenType=="object"}function k0(t){return na(t)&&typeof t.fullText=="string"}class On{constructor(e,n){this.startFn=e,this.nextFn=n}iterator(){const e={state:this.startFn(),next:()=>this.nextFn(e.state),[Symbol.iterator]:()=>e};return e}[Symbol.iterator](){return this.iterator()}isEmpty(){return!!this.iterator().next().done}count(){const e=this.iterator();let n=0,r=e.next();for(;!r.done;)n++,r=e.next();return n}toArray(){const e=[],n=this.iterator();let r;do r=n.next(),r.value!==void 0&&
e.push(r.value);while(!r.done);return e}toSet(){return new Set(this)}toMap(e,n){const r=this.map(i=>[e?e(i):i,n?n(i):i]);return new Map(r)}toString(){return this.join()}concat(e){return new On(()=>({first:this.startFn(),firstDone:!1,iterator:e[Symbol.iterator]()}),n=>{let r;if(!n.firstDone){do if(r=this.nextFn(n.first),!r.done)return r;while(!r.done);n.firstDone=!0}do if(r=n.iterator.next(),!r.done)return r;while(!r.done);return yr})}join(e=","){const n=this.iterator();let r="",i,s=!1;do i=n.next(),
i.done||(s&&(r+=e),r+=jF(i.value)),s=!0;while(!i.done);return r}indexOf(e,n=0){const r=this.iterator();let i=0,s=r.next();for(;!s.done;){if(i>=n&&s.value===e)return i;s=r.next(),i++}return-1}every(e){const n=this.iterator();let r=n.next();for(;!r.done;){if(!e(r.value))return!1;r=n.next()}return!0}some(e){const n=this.iterator();let r=n.next();for(;!r.done;){if(e(r.value))return!0;r=n.next()}return!1}forEach(e){const n=this.iterator();let r=0,i=n.next();for(;!i.done;)e(i.value,r),i=n.next(),r++}map(e){
return new On(this.startFn,n=>{const{done:r,value:i}=this.nextFn(n);return r?yr:{done:!1,value:e(i)}})}filter(e){return new On(this.startFn,n=>{let r;do if(r=this.nextFn(n),!r.done&&e(r.value))return r;while(!r.done);return yr})}nonNullable(){return this.filter(e=>e!=null)}reduce(e,n){const r=this.iterator();let i=n,s=r.next();for(;!s.done;)i===void 0?i=s.value:i=e(i,s.value),s=r.next();return i}reduceRight(e,n){return this.recursiveReduce(this.iterator(),e,n)}recursiveReduce(e,n,r){const i=e.next();
if(i.done)return r;const s=this.recursiveReduce(e,n,r);return s===void 0?i.value:n(s,i.value)}find(e){const n=this.iterator();let r=n.next();for(;!r.done;){if(e(r.value))return r.value;r=n.next()}}findIndex(e){const n=this.iterator();let r=0,i=n.next();for(;!i.done;){if(e(i.value))return r;i=n.next(),r++}return-1}includes(e){const n=this.iterator();let r=n.next();for(;!r.done;){if(r.value===e)return!0;r=n.next()}return!1}flatMap(e){return new On(()=>({this:this.startFn()}),n=>{do{if(n.iterator){
const s=n.iterator.next();if(s.done)n.iterator=void 0;else return s}const{done:r,value:i}=this.nextFn(n.this);if(!r){const s=e(i);if($h(s))n.iterator=s[Symbol.iterator]();else return{done:!1,value:s}}}while(n.iterator);return yr})}flat(e){if(e===void 0&&(e=1),e<=0)return this;const n=e>1?this.flat(e-1):this;return new On(()=>({this:n.startFn()}),r=>{do{if(r.iterator){const a=r.iterator.next();if(a.done)r.iterator=void 0;else return a}const{done:i,value:s}=n.nextFn(r.this);if(!i)if($h(s))r.iterator=
s[Symbol.iterator]();else return{done:!1,value:s}}while(r.iterator);return yr})}head(){const n=this.iterator().next();if(!n.done)return n.value}tail(e=1){return new On(()=>{const n=this.startFn();for(let r=0;r<e;r++)if(this.nextFn(n).done)return n;return n},this.nextFn)}limit(e){return new On(()=>({size:0,state:this.startFn()}),n=>(n.size++,n.size>e?yr:this.nextFn(n.state)))}distinct(e){return new On(()=>({set:new Set,internalState:this.startFn()}),n=>{let r;do if(r=this.nextFn(n.internalState),
!r.done){const i=e?e(r.value):r.value;if(!n.set.has(i))return n.set.add(i),r}while(!r.done);return yr})}exclude(e,n){const r=new Set;for(const i of e){const s=n?n(i):i;r.add(s)}return this.filter(i=>{const s=n?n(i):i;return!r.has(s)})}}function jF(t){return typeof t=="string"?t:typeof t>"u"?"undefined":typeof t.toString=="function"?t.toString():Object.prototype.toString.call(t)}function $h(t){return!!t&&typeof t[Symbol.iterator]=="function"}const Bc=new On(()=>{},()=>yr),yr=Object.freeze({done:!0,
value:void 0});function dt(...t){if(t.length===1){const e=t[0];if(e instanceof On)return e;if($h(e))return new On(()=>e[Symbol.iterator](),n=>n.next());if(typeof e.length=="number")return new On(()=>({index:0}),n=>n.index<e.length?{done:!1,value:e[n.index++]}:yr)}return t.length>1?new On(()=>({collIndex:0,arrIndex:0}),e=>{do{if(e.iterator){const n=e.iterator.next();if(!n.done)return n;e.iterator=void 0}if(e.array){if(e.arrIndex<e.array.length)return{done:!1,value:e.array[e.arrIndex++]};e.array=void 0,
e.arrIndex=0}if(e.collIndex<t.length){const n=t[e.collIndex++];$h(n)?e.iterator=n[Symbol.iterator]():n&&typeof n.length=="number"&&(e.array=n)}}while(e.iterator||e.array||e.collIndex<t.length);return yr}):Bc}class vl extends On{constructor(e,n,r){super(()=>({iterators:r?.includeRoot?[[e][Symbol.iterator]()]:[n(e)[Symbol.iterator]()],pruned:!1}),i=>{for(i.pruned&&(i.iterators.pop(),i.pruned=!1);i.iterators.length>0;){const a=i.iterators[i.iterators.length-1].next();if(a.done)i.iterators.pop();else
return i.iterators.push(n(a.value)[Symbol.iterator]()),a}return yr})}iterator(){const e={state:this.startFn(),next:()=>this.nextFn(e.state),prune:()=>{e.state.pruned=!0},[Symbol.iterator]:()=>e};return e}}var Nw;(function(t){function e(s){return s.reduce((a,o)=>a+o,0)}t.sum=e;function n(s){return s.reduce((a,o)=>a*o,0)}t.product=n;function r(s){return s.reduce((a,o)=>Math.min(a,o))}t.min=r;function i(s){return s.reduce((a,o)=>Math.max(a,o))}t.max=i})(Nw||(Nw={}));function Th(t){return new vl(t,e=>na(
e)?e.content:[],{includeRoot:!0})}function qF(t){return Th(t).filter(Wa)}function FF(t,e){for(;t.container;)if(t=t.container,t===e)return!0;return!1}function Dw(t){return{start:{character:t.startColumn-1,line:t.startLine-1},end:{character:t.endColumn,line:t.endLine-1}}}function Eh(t){if(!t)return;const{offset:e,end:n,range:r}=t;return{range:r,offset:e,end:n,length:n-e}}var fs;(function(t){t[t.Before=0]="Before",t[t.After=1]="After",t[t.OverlapFront=2]="OverlapFront",t[t.OverlapBack=3]="OverlapBa\
ck",t[t.Inside=4]="Inside",t[t.Outside=5]="Outside"})(fs||(fs={}));function zF(t,e){if(t.end.line<e.start.line||t.end.line===e.start.line&&t.end.character<=e.start.character)return fs.Before;if(t.start.line>e.end.line||t.start.line===e.end.line&&t.start.character>=e.end.character)return fs.After;const n=t.start.line>e.start.line||t.start.line===e.start.line&&t.start.character>=e.start.character,r=t.end.line<e.end.line||t.end.line===e.end.line&&t.end.character<=e.end.character;return n&&r?fs.Inside:
n?fs.OverlapBack:r?fs.OverlapFront:fs.Outside}function _0(t,e){return zF(t,e)>fs.After}const R0=/^[\w\p{L}]$/u;function Ga(t,e,n=R0){if(t){if(e>0){const r=e-t.offset,i=t.text.charAt(r);n.test(i)||e--}return $0(t,e)}}function Wc(t,e){if(t){const n=UF(t,!0);if(n&&S0(n,e))return n;if(k0(t)){const r=t.content.findIndex(i=>!i.hidden);for(let i=r-1;i>=0;i--){const s=t.content[i];if(S0(s,e))return s}}}}function S0(t,e){return Wa(t)&&e.includes(t.tokenType.name)}function $0(t,e){if(Wa(t))return t;if(na(
t)){const n=T0(t,e,!1);if(n)return $0(n,e)}}function Ow(t,e){if(Wa(t))return t;if(na(t)){const n=T0(t,e,!0);if(n)return Ow(n,e)}}function T0(t,e,n){let r=0,i=t.content.length-1,s;for(;r<=i;){const a=Math.floor((r+i)/2),o=t.content[a];if(o.offset<=e&&o.end>e)return o;o.end<=e?(s=n?o:void 0,r=a+1):i=a-1}return s}function UF(t,e=!0){for(;t.container;){const n=t.container;let r=n.content.indexOf(t);for(;r>0;){r--;const i=n.content[r];if(e||!i.hidden)return i}t=n}}function HF(t,e=!0){for(;t.container;){
const n=t.container;let r=n.content.indexOf(t);const i=n.content.length-1;for(;r<i;){r++;const s=n.content[r];if(e||!s.hidden)return s}t=n}}function VF(t,e){const n=BF(t,e);return n?n.parent.content.slice(n.a+1,n.b):[]}function BF(t,e){const n=E0(t),r=E0(e);let i;for(let s=0;s<n.length&&s<r.length;s++){const a=n[s],o=r[s];if(a.parent===o.parent)i={parent:a.parent,a:a.index,b:o.index};else break}return i}function E0(t){const e=[];for(;t.container;){const n=t.container,r=n.content.indexOf(t);e.push(
{parent:n,index:r}),t=n}return e.reverse()}class P0 extends Error{constructor(e,n){super(e?`${n} at ${e.range.start.line}:${e.range.start.character}`:n)}}function Gc(t){throw new Error("Error! The input value was not handled.")}const Ph="AbstractRule",Ch="AbstractType",Lw="Condition",C0="TypeDefinition",Mw="ValueLiteral",Kc="AbstractElement";function jw(t){return gt.isInstance(t,Kc)}const xh="ArrayLiteral",Zc="ArrayType";function WF(t){return gt.isInstance(t,Zc)}const Jc="BooleanLiteral";function GF(t){
return gt.isInstance(t,Jc)}const Yc="Conjunction";function KF(t){return gt.isInstance(t,Yc)}const Xc="Disjunction";function ZF(t){return gt.isInstance(t,Xc)}const Ah="Grammar",qw="GrammarImport",Qc="InferredType";function Fw(t){return gt.isInstance(t,Qc)}const eu="Interface";function x0(t){return gt.isInstance(t,eu)}const zw="NamedArgument",tu="Negation";function JF(t){return gt.isInstance(t,tu)}const Ih="NumberLiteral",Nh="Parameter",nu="ParameterReference";function YF(t){return gt.isInstance(t,
nu)}const ru="ParserRule";function In(t){return gt.isInstance(t,ru)}const iu="ReferenceType";function XF(t){return gt.isInstance(t,iu)}const Dh="ReturnType";function QF(t){return gt.isInstance(t,Dh)}const su="SimpleType";function A0(t){return gt.isInstance(t,su)}const Oh="StringLiteral",wl="TerminalRule";function ps(t){return gt.isInstance(t,wl)}const au="Type";function Uw(t){return gt.isInstance(t,au)}const Hw="TypeAttribute",ou="UnionType";function e2(t){return gt.isInstance(t,ou)}const lu="Ac\
tion";function Ka(t){return gt.isInstance(t,lu)}const cu="Alternatives";function Vw(t){return gt.isInstance(t,cu)}const uu="Assignment";function Fi(t){return gt.isInstance(t,uu)}const du="CharacterRange";function t2(t){return gt.isInstance(t,du)}const fu="CrossReference";function Za(t){return gt.isInstance(t,fu)}const pu="EndOfFile";function n2(t){return gt.isInstance(t,pu)}const hu="Group";function ra(t){return gt.isInstance(t,hu)}const mu="Keyword";function Xr(t){return gt.isInstance(t,mu)}const gu="\
NegatedToken";function r2(t){return gt.isInstance(t,gu)}const yu="RegexToken";function i2(t){return gt.isInstance(t,yu)}const vu="RuleCall";function zi(t){return gt.isInstance(t,vu)}const wu="TerminalAlternatives";function s2(t){return gt.isInstance(t,wu)}const bu="TerminalGroup";function a2(t){return gt.isInstance(t,bu)}const ku="TerminalRuleCall";function I0(t){return gt.isInstance(t,ku)}const _u="UnorderedGroup";function Bw(t){return gt.isInstance(t,_u)}const Ru="UntilToken";function o2(t){return gt.
isInstance(t,Ru)}const Su="Wildcard";function l2(t){return gt.isInstance(t,Su)}class N0 extends b0{getAllTypes(){return[Kc,Ph,Ch,lu,cu,xh,Zc,uu,Jc,du,Lw,Yc,fu,Xc,pu,Ah,qw,hu,Qc,eu,mu,zw,gu,tu,Ih,Nh,nu,ru,iu,yu,Dh,vu,su,Oh,wu,bu,wl,ku,au,Hw,C0,ou,_u,Ru,Mw,Su]}computeIsSubtype(e,n){switch(e){case lu:case cu:case uu:case du:case fu:case pu:case hu:case mu:case gu:case yu:case vu:case wu:case bu:case ku:case _u:case Ru:case Su:return this.isSubtype(Kc,n);case xh:case Ih:case Oh:return this.isSubtype(
Mw,n);case Zc:case iu:case su:case ou:return this.isSubtype(C0,n);case Jc:return this.isSubtype(Lw,n)||this.isSubtype(Mw,n);case Yc:case Xc:case tu:case nu:return this.isSubtype(Lw,n);case Qc:case eu:case au:return this.isSubtype(Ch,n);case ru:return this.isSubtype(Ph,n)||this.isSubtype(Ch,n);case wl:return this.isSubtype(Ph,n);default:return!1}}getReferenceType(e){const n=`${e.container.$type}:${e.property}`;switch(n){case"Action:type":case"CrossReference:type":case"Interface:superTypes":case"P\
arserRule:returnType":case"SimpleType:typeRef":return Ch;case"Grammar:hiddenTokens":case"ParserRule:hiddenTokens":case"RuleCall:rule":return Ph;case"Grammar:usedGrammars":return Ah;case"NamedArgument:parameter":case"ParameterReference:parameter":return Nh;case"TerminalRuleCall:rule":return wl;default:throw new Error(`${n} is not a valid reference id.`)}}getTypeMetaData(e){switch(e){case Kc:return{name:Kc,properties:[{name:"cardinality"},{name:"lookahead"}]};case xh:return{name:xh,properties:[{name:"\
elements",defaultValue:[]}]};case Zc:return{name:Zc,properties:[{name:"elementType"}]};case Jc:return{name:Jc,properties:[{name:"true",defaultValue:!1}]};case Yc:return{name:Yc,properties:[{name:"left"},{name:"right"}]};case Xc:return{name:Xc,properties:[{name:"left"},{name:"right"}]};case Ah:return{name:Ah,properties:[{name:"definesHiddenTokens",defaultValue:!1},{name:"hiddenTokens",defaultValue:[]},{name:"imports",defaultValue:[]},{name:"interfaces",defaultValue:[]},{name:"isDeclared",defaultValue:!1},
{name:"name"},{name:"rules",defaultValue:[]},{name:"types",defaultValue:[]},{name:"usedGrammars",defaultValue:[]}]};case qw:return{name:qw,properties:[{name:"path"}]};case Qc:return{name:Qc,properties:[{name:"name"}]};case eu:return{name:eu,properties:[{name:"attributes",defaultValue:[]},{name:"name"},{name:"superTypes",defaultValue:[]}]};case zw:return{name:zw,properties:[{name:"calledByName",defaultValue:!1},{name:"parameter"},{name:"value"}]};case tu:return{name:tu,properties:[{name:"value"}]};case Ih:
return{name:Ih,properties:[{name:"value"}]};case Nh:return{name:Nh,properties:[{name:"name"}]};case nu:return{name:nu,properties:[{name:"parameter"}]};case ru:return{name:ru,properties:[{name:"dataType"},{name:"definesHiddenTokens",defaultValue:!1},{name:"definition"},{name:"entry",defaultValue:!1},{name:"fragment",defaultValue:!1},{name:"hiddenTokens",defaultValue:[]},{name:"inferredType"},{name:"name"},{name:"parameters",defaultValue:[]},{name:"returnType"},{name:"wildcard",defaultValue:!1}]};case iu:
return{name:iu,properties:[{name:"referenceType"}]};case Dh:return{name:Dh,properties:[{name:"name"}]};case su:return{name:su,properties:[{name:"primitiveType"},{name:"stringType"},{name:"typeRef"}]};case Oh:return{name:Oh,properties:[{name:"value"}]};case wl:return{name:wl,properties:[{name:"definition"},{name:"fragment",defaultValue:!1},{name:"hidden",defaultValue:!1},{name:"name"},{name:"type"}]};case au:return{name:au,properties:[{name:"name"},{name:"type"}]};case Hw:return{name:Hw,properties:[
{name:"defaultValue"},{name:"isOptional",defaultValue:!1},{name:"name"},{name:"type"}]};case ou:return{name:ou,properties:[{name:"types",defaultValue:[]}]};case lu:return{name:lu,properties:[{name:"cardinality"},{name:"feature"},{name:"inferredType"},{name:"lookahead"},{name:"operator"},{name:"type"}]};case cu:return{name:cu,properties:[{name:"cardinality"},{name:"elements",defaultValue:[]},{name:"lookahead"}]};case uu:return{name:uu,properties:[{name:"cardinality"},{name:"feature"},{name:"looka\
head"},{name:"operator"},{name:"terminal"}]};case du:return{name:du,properties:[{name:"cardinality"},{name:"left"},{name:"lookahead"},{name:"right"}]};case fu:return{name:fu,properties:[{name:"cardinality"},{name:"deprecatedSyntax",defaultValue:!1},{name:"lookahead"},{name:"terminal"},{name:"type"}]};case pu:return{name:pu,properties:[{name:"cardinality"},{name:"lookahead"}]};case hu:return{name:hu,properties:[{name:"cardinality"},{name:"elements",defaultValue:[]},{name:"guardCondition"},{name:"\
lookahead"}]};case mu:return{name:mu,properties:[{name:"cardinality"},{name:"lookahead"},{name:"value"}]};case gu:return{name:gu,properties:[{name:"cardinality"},{name:"lookahead"},{name:"terminal"}]};case yu:return{name:yu,properties:[{name:"cardinality"},{name:"lookahead"},{name:"regex"}]};case vu:return{name:vu,properties:[{name:"arguments",defaultValue:[]},{name:"cardinality"},{name:"lookahead"},{name:"rule"}]};case wu:return{name:wu,properties:[{name:"cardinality"},{name:"elements",defaultValue:[]},
{name:"lookahead"}]};case bu:return{name:bu,properties:[{name:"cardinality"},{name:"elements",defaultValue:[]},{name:"lookahead"}]};case ku:return{name:ku,properties:[{name:"cardinality"},{name:"lookahead"},{name:"rule"}]};case _u:return{name:_u,properties:[{name:"cardinality"},{name:"elements",defaultValue:[]},{name:"lookahead"}]};case Ru:return{name:Ru,properties:[{name:"cardinality"},{name:"lookahead"},{name:"terminal"}]};case Su:return{name:Su,properties:[{name:"cardinality"},{name:"lookahea\
d"}]};default:return{name:e,properties:[]}}}}const gt=new N0;function Ww(t){for(const[e,n]of Object.entries(t))e.startsWith("$")||(Array.isArray(n)?n.forEach((r,i)=>{Xt(r)&&(r.$container=t,r.$containerProperty=e,r.$containerIndex=i)}):Xt(n)&&(n.$container=t,n.$containerProperty=e))}function xr(t,e){let n=t;for(;n;){if(e(n))return n;n=n.$container}}function pi(t,e){let n=t;for(;n;){if(e(n))return!0;n=n.$container}return!1}function $t(t){const n=Lh(t).$document;if(!n)throw new Error("AST node has \
no document.");return n}function Lh(t){for(;t.$container;)t=t.$container;return t}function $u(t,e){if(!t)throw new Error("Node must be an AstNode.");const n=e?.range;return new On(()=>({keys:Object.keys(t),keyIndex:0,arrayIndex:0}),r=>{for(;r.keyIndex<r.keys.length;){const i=r.keys[r.keyIndex];if(!i.startsWith("$")){const s=t[i];if(Xt(s)){if(r.keyIndex++,Gw(s,n))return{done:!1,value:s}}else if(Array.isArray(s)){for(;r.arrayIndex<s.length;){const a=r.arrayIndex++,o=s[a];if(Xt(o)&&Gw(o,n))return{done:!1,
value:o}}r.arrayIndex=0}}r.keyIndex++}return yr})}function hi(t,e){if(!t)throw new Error("Root node must be an AstNode.");return new vl(t,n=>$u(n,e))}function hs(t,e){if(t){if(e?.range&&!Gw(t,e.range))return new vl(t,()=>[])}else throw new Error("Root node must be an AstNode.");return new vl(t,n=>$u(n,e),{includeRoot:!0})}function Gw(t,e){var n;if(!e)return!0;const r=(n=t.$cstNode)===null||n===void 0?void 0:n.range;return r?_0(r,e):!1}function Mh(t){return new On(()=>({keys:Object.keys(t),keyIndex:0,
arrayIndex:0}),e=>{for(;e.keyIndex<e.keys.length;){const n=e.keys[e.keyIndex];if(!n.startsWith("$")){const r=t[n];if(Yr(r))return e.keyIndex++,{done:!1,value:{reference:r,container:t,property:n}};if(Array.isArray(r)){for(;e.arrayIndex<r.length;){const i=e.arrayIndex++,s=r[i];if(Yr(s))return{done:!1,value:{reference:s,container:t,property:n,index:i}}}e.arrayIndex=0}}e.keyIndex++}return yr})}function c2(t,e=$t(t).parseResult.value){const n=[];return hs(e).forEach(r=>{Mh(r).forEach(i=>{i.reference.
ref===t&&n.push(i.reference)})}),dt(n)}function Kw(t,e){const n=t.getTypeMetaData(e.$type),r=e;for(const i of n.properties)i.defaultValue!==void 0&&r[i.name]===void 0&&(r[i.name]=D0(i.defaultValue))}function D0(t){return Array.isArray(t)?[...t.map(D0)]:t}function Zw(t,e){const n={$type:t.$type};for(const[r,i]of Object.entries(t))if(!r.startsWith("$"))if(Xt(i))n[r]=Zw(i,e);else if(Yr(i))n[r]=e(n,r,i.$refNode,i.$refText);else if(Array.isArray(i)){const s=[];for(const a of i)Xt(a)?s.push(Zw(a,e)):Yr(
a)?s.push(e(n,r,a.$refNode,a.$refText)):s.push(a);n[r]=s}else n[r]=i;return Ww(n),n}const bl={__proto__:null,assignMandatoryProperties:Kw,copyAstNode:Zw,findLocalReferences:c2,findRootNode:Lh,getContainerOfType:xr,getDocument:$t,hasContainerOfType:pi,linkContentToContainer:Ww,streamAllContents:hi,streamAst:hs,streamContents:$u,streamReferences:Mh};function He(t){return t.charCodeAt(0)}function Jw(t,e){Array.isArray(t)?t.forEach(function(n){e.push(n)}):e.push(t)}function Tu(t,e){if(t[e]===!0)throw"\
duplicate flag "+e;t[e],t[e]=!0}function kl(t){if(t===void 0)throw Error("Internal Error - Should never get here!");return!0}function u2(){throw Error("Internal Error - Should never get here!")}function O0(t){return t.type==="Character"}const jh=[];for(let t=He("0");t<=He("9");t++)jh.push(t);const qh=[He("_")].concat(jh);for(let t=He("a");t<=He("z");t++)qh.push(t);for(let t=He("A");t<=He("Z");t++)qh.push(t);const L0=[He(" "),He("\f"),He(`
`),He("\r"),He("	"),He("\v"),He("	"),He("\xA0"),He("\u1680"),He("\u2000"),He("\u2001"),He("\u2002"),He("\u2003"),He("\u2004"),He("\u2005"),He("\u2006"),He("\u2007"),He("\u2008"),He("\u2009"),He("\u200A"),He("\u2028"),He("\u2029"),He("\u202F"),He("\u205F"),He("\u3000"),He("\uFEFF")],d2=/[0-9a-fA-F]/,Fh=/[0-9]/,f2=/[1-9]/;class M0{constructor(){this.idx=0,this.input="",this.groupIdx=0}saveState(){return{idx:this.idx,input:this.input,groupIdx:this.groupIdx}}restoreState(e){this.idx=e.idx,this.input=
e.input,this.groupIdx=e.groupIdx}pattern(e){this.idx=0,this.input=e,this.groupIdx=0,this.consumeChar("/");const n=this.disjunction();this.consumeChar("/");const r={type:"Flags",loc:{begin:this.idx,end:e.length},global:!1,ignoreCase:!1,multiLine:!1,unicode:!1,sticky:!1};for(;this.isRegExpFlag();)switch(this.popChar()){case"g":Tu(r,"global");break;case"i":Tu(r,"ignoreCase");break;case"m":Tu(r,"multiLine");break;case"u":Tu(r,"unicode");break;case"y":Tu(r,"sticky");break}if(this.idx!==this.input.length)
throw Error("Redundant input: "+this.input.substring(this.idx));return{type:"Pattern",flags:r,value:n,loc:this.loc(0)}}disjunction(){const e=[],n=this.idx;for(e.push(this.alternative());this.peekChar()==="|";)this.consumeChar("|"),e.push(this.alternative());return{type:"Disjunction",value:e,loc:this.loc(n)}}alternative(){const e=[],n=this.idx;for(;this.isTerm();)e.push(this.term());return{type:"Alternative",value:e,loc:this.loc(n)}}term(){return this.isAssertion()?this.assertion():this.atom()}assertion(){
const e=this.idx;switch(this.popChar()){case"^":return{type:"StartAnchor",loc:this.loc(e)};case"$":return{type:"EndAnchor",loc:this.loc(e)};case"\\":switch(this.popChar()){case"b":return{type:"WordBoundary",loc:this.loc(e)};case"B":return{type:"NonWordBoundary",loc:this.loc(e)}}throw Error("Invalid Assertion Escape");case"(":this.consumeChar("?");let n;switch(this.popChar()){case"=":n="Lookahead";break;case"!":n="NegativeLookahead";break}kl(n);const r=this.disjunction();return this.consumeChar("\
)"),{type:n,value:r,loc:this.loc(e)}}return u2()}quantifier(e=!1){let n;const r=this.idx;switch(this.popChar()){case"*":n={atLeast:0,atMost:1/0};break;case"+":n={atLeast:1,atMost:1/0};break;case"?":n={atLeast:0,atMost:1};break;case"{":const i=this.integerIncludingZero();switch(this.popChar()){case"}":n={atLeast:i,atMost:i};break;case",":let s;this.isDigit()?(s=this.integerIncludingZero(),n={atLeast:i,atMost:s}):n={atLeast:i,atMost:1/0},this.consumeChar("}");break}if(e===!0&&n===void 0)return;kl(
n);break}if(!(e===!0&&n===void 0)&&kl(n))return this.peekChar(0)==="?"?(this.consumeChar("?"),n.greedy=!1):n.greedy=!0,n.type="Quantifier",n.loc=this.loc(r),n}atom(){let e;const n=this.idx;switch(this.peekChar()){case".":e=this.dotAll();break;case"\\":e=this.atomEscape();break;case"[":e=this.characterClass();break;case"(":e=this.group();break}if(e===void 0&&this.isPatternCharacter()&&(e=this.patternCharacter()),kl(e))return e.loc=this.loc(n),this.isQuantifier()&&(e.quantifier=this.quantifier()),
e}dotAll(){return this.consumeChar("."),{type:"Set",complement:!0,value:[He(`
`),He("\r"),He("\u2028"),He("\u2029")]}}atomEscape(){switch(this.consumeChar("\\"),this.peekChar()){case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return this.decimalEscapeAtom();case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.
regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}}decimalEscapeAtom(){return{type:"GroupBackReference",value:this.positiveInteger()}}characterClassEscape(){let e,n=!1;switch(this.popChar()){case"d":e=jh;break;case"D":e=jh,n=!0;break;case"s":e=L0;break;case"S":e=L0,n=!0;break;case"w":e=qh;break;case"W":e=qh,n=!0;break}if(kl(e))return{type:"Set",value:e,complement:n}}controlEscapeAtom(){let e;switch(this.popChar()){case"f":e=He("\f");break;case"n":e=He(`
`);break;case"r":e=He("\r");break;case"t":e=He("	");break;case"v":e=He("\v");break}if(kl(e))return{type:"Character",value:e}}controlLetterEscapeAtom(){this.consumeChar("c");const e=this.popChar();if(/[a-zA-Z]/.test(e)===!1)throw Error("Invalid ");return{type:"Character",value:e.toUpperCase().charCodeAt(0)-64}}nulCharacterAtom(){return this.consumeChar("0"),{type:"Character",value:He("\0")}}hexEscapeSequenceAtom(){return this.consumeChar("x"),this.parseHexDigits(2)}regExpUnicodeEscapeSequenceAtom(){
return this.consumeChar("u"),this.parseHexDigits(4)}identityEscapeAtom(){const e=this.popChar();return{type:"Character",value:He(e)}}classPatternCharacterAtom(){switch(this.peekChar()){case`
`:case"\r":case"\u2028":case"\u2029":case"\\":case"]":throw Error("TBD");default:const e=this.popChar();return{type:"Character",value:He(e)}}}characterClass(){const e=[];let n=!1;for(this.consumeChar("["),this.peekChar(0)==="^"&&(this.consumeChar("^"),n=!0);this.isClassAtom();){const r=this.classAtom();if(r.type,O0(r)&&this.isRangeDash()){this.consumeChar("-");const i=this.classAtom();if(i.type,O0(i)){if(i.value<r.value)throw Error("Range out of order in character class");e.push({from:r.value,to:i.
value})}else Jw(r.value,e),e.push(He("-")),Jw(i.value,e)}else Jw(r.value,e)}return this.consumeChar("]"),{type:"Set",complement:n,value:e}}classAtom(){switch(this.peekChar()){case"]":case`
`:case"\r":case"\u2028":case"\u2029":throw Error("TBD");case"\\":return this.classEscape();default:return this.classPatternCharacterAtom()}}classEscape(){switch(this.consumeChar("\\"),this.peekChar()){case"b":return this.consumeChar("b"),{type:"Character",value:He("\b")};case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"\
x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}}group(){let e=!0;this.consumeChar("("),this.peekChar(0)==="?"?(this.consumeChar("?"),this.consumeChar(":"),e=!1):this.groupIdx++;const n=this.disjunction();this.consumeChar(")");const r={type:"Group",capturing:e,value:n};return e&&(r.idx=this.groupIdx),r}positiveInteger(){let e=this.popChar();if(f2.test(e)===!1)throw Error("Expecting a positive integer");for(;Fh.
test(this.peekChar(0));)e+=this.popChar();return parseInt(e,10)}integerIncludingZero(){let e=this.popChar();if(Fh.test(e)===!1)throw Error("Expecting an integer");for(;Fh.test(this.peekChar(0));)e+=this.popChar();return parseInt(e,10)}patternCharacter(){const e=this.popChar();switch(e){case`
`:case"\r":case"\u2028":case"\u2029":case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":throw Error("TBD");default:return{type:"Character",value:He(e)}}}isRegExpFlag(){switch(this.peekChar(0)){case"g":case"i":case"m":case"u":case"y":return!0;default:return!1}}isRangeDash(){return this.peekChar()==="-"&&this.isClassAtom(1)}isDigit(){return Fh.test(this.peekChar(0))}isClassAtom(e=0){switch(this.peekChar(e)){case"]":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}}isTerm(){return this.isAtom()||this.isAssertion()}isAtom(){if(this.isPatternCharacter())return!0;switch(this.peekChar(0)){case".":case"\\":case"[":case"(":return!0;default:return!1}}isAssertion(){switch(this.peekChar(0)){case"^":case"$":return!0;case"\\":switch(this.peekChar(1)){case"b":case"B":return!0;default:return!1}case"(":return this.peekChar(1)==="?"&&(this.peekChar(2)==="="||this.peekChar(2)==="!");default:return!1}}isQuantifier(){
const e=this.saveState();try{return this.quantifier(!0)!==void 0}catch{return!1}finally{this.restoreState(e)}}isPatternCharacter(){switch(this.peekChar()){case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":case"/":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}}parseHexDigits(e){let n="";for(let i=0;i<e;i++){const s=this.popChar();if(d2.test(s)===!1)throw Error("Expecting a HexDecimal digits");n+=s}return{type:"Character",value:parseInt(n,16)}}peekChar(e=0){return this.input[this.idx+e]}popChar(){const e=this.peekChar(0);return this.consumeChar(void 0),e}consumeChar(e){if(e!==void 0&&this.input[this.idx]!==e)throw Error("Expected: '"+e+"' but found: '"+this.input[this.idx]+"' at offset: "+
this.idx);if(this.idx>=this.input.length)throw Error("Unexpected end of input");this.idx++}loc(e){return{begin:e,end:this.idx}}}class zh{visitChildren(e){for(const n in e){const r=e[n];e.hasOwnProperty(n)&&(r.type!==void 0?this.visit(r):Array.isArray(r)&&r.forEach(i=>{this.visit(i)},this))}}visit(e){switch(e.type){case"Pattern":this.visitPattern(e);break;case"Flags":this.visitFlags(e);break;case"Disjunction":this.visitDisjunction(e);break;case"Alternative":this.visitAlternative(e);break;case"Sta\
rtAnchor":this.visitStartAnchor(e);break;case"EndAnchor":this.visitEndAnchor(e);break;case"WordBoundary":this.visitWordBoundary(e);break;case"NonWordBoundary":this.visitNonWordBoundary(e);break;case"Lookahead":this.visitLookahead(e);break;case"NegativeLookahead":this.visitNegativeLookahead(e);break;case"Character":this.visitCharacter(e);break;case"Set":this.visitSet(e);break;case"Group":this.visitGroup(e);break;case"GroupBackReference":this.visitGroupBackReference(e);break;case"Quantifier":this.
visitQuantifier(e);break}this.visitChildren(e)}visitPattern(e){}visitFlags(e){}visitDisjunction(e){}visitAlternative(e){}visitStartAnchor(e){}visitEndAnchor(e){}visitWordBoundary(e){}visitNonWordBoundary(e){}visitLookahead(e){}visitNegativeLookahead(e){}visitCharacter(e){}visitSet(e){}visitGroup(e){}visitGroupBackReference(e){}visitQuantifier(e){}}const j0=/\r?\n/gm,p2=new M0;class h2 extends zh{constructor(){super(...arguments),this.isStarting=!0,this.endRegexpStack=[],this.multiline=!1}get endRegex(){
return this.endRegexpStack.join("")}reset(e){this.multiline=!1,this.regex=e,this.startRegexp="",this.isStarting=!0,this.endRegexpStack=[]}visitGroup(e){e.quantifier&&(this.isStarting=!1,this.endRegexpStack=[])}visitCharacter(e){const n=String.fromCharCode(e.value);if(!this.multiline&&n===`
`&&(this.multiline=!0),e.quantifier)this.isStarting=!1,this.endRegexpStack=[];else{const r=Uh(n);this.endRegexpStack.push(r),this.isStarting&&(this.startRegexp+=r)}}visitSet(e){if(!this.multiline){const n=this.regex.substring(e.loc.begin,e.loc.end),r=new RegExp(n);this.multiline=!!`
`.match(r)}if(e.quantifier)this.isStarting=!1,this.endRegexpStack=[];else{const n=this.regex.substring(e.loc.begin,e.loc.end);this.endRegexpStack.push(n),this.isStarting&&(this.startRegexp+=n)}}visitChildren(e){e.type==="Group"&&e.quantifier||super.visitChildren(e)}}const Yw=new h2;function m2(t){try{return typeof t=="string"&&(t=new RegExp(t)),t=t.toString(),Yw.reset(t),Yw.visit(p2.pattern(t)),Yw.multiline}catch{return!1}}const g2=`\f
\r	\v \xA0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF`.split("");function q0(t){const e=typeof t=="string"?new RegExp(t):t;return g2.some(n=>e.test(n))}function Uh(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function y2(t,e){const n=v2(t),r=e.match(n);return!!r&&r[0].length>0}function v2(t){typeof t=="string"&&(t=new RegExp(t));const e=t,n=t.source;let r=0;function i(){let s="",a;function o(c){s+=n.substr(r,c),r+=c}function l(c){
s+="(?:"+n.substr(r,c)+"|$)",r+=c}for(;r<n.length;)switch(n[r]){case"\\":switch(n[r+1]){case"c":l(3);break;case"x":l(4);break;case"u":e.unicode?n[r+2]==="{"?l(n.indexOf("}",r)-r+1):l(6):l(2);break;case"p":case"P":e.unicode?l(n.indexOf("}",r)-r+1):l(2);break;case"k":l(n.indexOf(">",r)-r+1);break;default:l(2);break}break;case"[":a=/\[(?:\\.|.)*?\]/g,a.lastIndex=r,a=a.exec(n)||[],l(a[0].length);break;case"|":case"^":case"$":case"*":case"+":case"?":o(1);break;case"{":a=/\{\d+,?\d*\}/g,a.lastIndex=r,
a=a.exec(n),a?o(a[0].length):l(1);break;case"(":if(n[r+1]==="?")switch(n[r+2]){case":":s+="(?:",r+=3,s+=i()+"|$)";break;case"=":s+="(?=",r+=3,s+=i()+")";break;case"!":a=r,r+=3,i(),s+=n.substr(a,r-a);break;case"<":switch(n[r+3]){case"=":case"!":a=r,r+=4,i(),s+=n.substr(a,r-a);break;default:o(n.indexOf(">",r)-r+1),s+=i()+"|$)";break}break}else o(1),s+=i()+"|$)";break;case")":return++r,s;default:l(1);break}return s}return new RegExp(i(),t.flags)}function Hh(t){return t.rules.find(e=>In(e)&&e.entry)}
function F0(t){return t.rules.filter(e=>ps(e)&&e.hidden)}function Xw(t,e){const n=new Set,r=Hh(t);if(!r)return new Set(t.rules);const i=[r].concat(F0(t));for(const a of i)z0(a,n,e);const s=new Set;for(const a of t.rules)(n.has(a.name)||ps(a)&&a.hidden)&&s.add(a);return s}function z0(t,e,n){e.add(t.name),hi(t).forEach(r=>{if(zi(r)||n&&I0(r)){const i=r.rule.ref;i&&!e.has(i.name)&&z0(i,e,n)}})}function w2(t){const e=new Set;return hi(t).forEach(n=>{Za(n)&&(In(n.type.ref)&&e.add(n.type.ref),Fw(n.type.
ref)&&In(n.type.ref.$container)&&e.add(n.type.ref.$container))}),e}function Qw(t){if(t.terminal)return t.terminal;if(t.type.ref){const e=rb(t.type.ref);return e?.terminal}}function U0(t){return t.hidden&&!q0(Cu(t))}function _l(t,e){return!t||!e?[]:eb(t,e,t.astNode,!0)}function Yn(t,e,n){if(!t||!e)return;const r=eb(t,e,t.astNode,!0);if(r.length!==0)return n!==void 0?n=Math.max(0,Math.min(n,r.length-1)):n=0,r[n]}function eb(t,e,n,r){if(!r){const i=xr(t.grammarSource,Fi);if(i&&i.feature===e)return[
t]}return na(t)&&t.astNode===n?t.content.flatMap(i=>eb(i,e,n,!1)):[]}function tb(t,e){return t?nb(t,e,t?.astNode):[]}function Eu(t,e,n){if(!t)return;const r=nb(t,e,t?.astNode);if(r.length!==0)return n!==void 0?n=Math.max(0,Math.min(n,r.length-1)):n=0,r[n]}function nb(t,e,n){if(t.astNode!==n)return[];if(Xr(t.grammarSource)&&t.grammarSource.value===e)return[t];const r=Th(t).iterator();let i;const s=[];do if(i=r.next(),!i.done){const a=i.value;a.astNode===n?Xr(a.grammarSource)&&a.grammarSource.value===
e&&s.push(a):r.prune()}while(!i.done);return s}function H0(t){var e;const n=t.astNode;for(;n===((e=t.container)===null||e===void 0?void 0:e.astNode);){const r=xr(t.grammarSource,Fi);if(r)return r;t=t.container}}function rb(t){let e=t;return Fw(e)&&(Ka(e.$container)?e=e.$container.$container:In(e.$container)?e=e.$container:Gc(e.$container)),V0(t,e,new Map)}function V0(t,e,n){var r;function i(s,a){let o;return xr(s,Fi)||(o=V0(a,a,n)),n.set(t,o),o}if(n.has(t))return n.get(t);n.set(t,void 0);for(const s of hi(
e)){if(Fi(s)&&s.feature.toLowerCase()==="name")return n.set(t,s),s;if(zi(s)&&In(s.rule.ref))return i(s,s.rule.ref);if(A0(s)&&(!((r=s.typeRef)===null||r===void 0)&&r.ref))return i(s,s.typeRef.ref)}}function B0(t){const e=t.$container;if(ra(e)){const n=e.elements,r=n.indexOf(t);for(let i=r-1;i>=0;i--){const s=n[i];if(Ka(s))return s;{const a=hi(n[i]).find(Ka);if(a)return a}}}if(jw(e))return B0(e)}function Rl(t,e){return t==="?"||t==="*"||ra(e)&&!!e.guardCondition}function W0(t){return t==="*"||t===
"+"}function b2(t){return t==="+="}function Vh(t){return G0(t,new Set)}function G0(t,e){if(e.has(t))return!0;e.add(t);for(const n of hi(t))if(zi(n)){if(!n.rule.ref||In(n.rule.ref)&&!G0(n.rule.ref,e))return!1}else{if(Fi(n))return!1;if(Ka(n))return!1}return!!t.definition}function k2(t){return ib(t.type,new Set)}function ib(t,e){if(e.has(t))return!0;if(e.add(t),WF(t))return!1;if(XF(t))return!1;if(e2(t))return t.types.every(n=>ib(n,e));if(A0(t)){if(t.primitiveType!==void 0)return!0;if(t.stringType!==
void 0)return!0;if(t.typeRef!==void 0){const n=t.typeRef.ref;return Uw(n)?ib(n.type,e):!1}else return!1}else return!1}function Ja(t){if(t.inferredType)return t.inferredType.name;if(t.dataType)return t.dataType;if(t.returnType){const e=t.returnType.ref;if(e){if(In(e))return e.name;if(x0(e)||Uw(e))return e.name}}}function Pu(t){var e;if(In(t))return Vh(t)?t.name:(e=Ja(t))!==null&&e!==void 0?e:t.name;if(x0(t)||Uw(t)||QF(t))return t.name;if(Ka(t)){const n=K0(t);if(n)return n}else if(Fw(t))return t.name;
throw new Error("Cannot get name of Unknown Type")}function K0(t){var e;if(t.inferredType)return t.inferredType.name;if(!((e=t.type)===null||e===void 0)&&e.ref)return Pu(t.type.ref)}function _2(t){var e,n,r;return ps(t)?(n=(e=t.type)===null||e===void 0?void 0:e.name)!==null&&n!==void 0?n:"string":Vh(t)?t.name:(r=Ja(t))!==null&&r!==void 0?r:t.name}function Z0(t){var e,n,r;return ps(t)?(n=(e=t.type)===null||e===void 0?void 0:e.name)!==null&&n!==void 0?n:"string":(r=Ja(t))!==null&&r!==void 0?r:t.name}
function Cu(t){const e={s:!1,i:!1,u:!1},n=Sl(t.definition,e),r=Object.entries(e).filter(([,i])=>i).map(([i])=>i).join("");return new RegExp(n,r)}const sb=/[\s\S]/.source;function Sl(t,e){if(s2(t))return R2(t);if(a2(t))return S2(t);if(t2(t))return E2(t);if(I0(t)){const n=t.rule.ref;if(!n)throw new Error("Missing rule reference.");return ms(Sl(n.definition),{cardinality:t.cardinality,lookahead:t.lookahead})}else{if(r2(t))return T2(t);if(o2(t))return $2(t);if(i2(t)){const n=t.regex.lastIndexOf("/"),
r=t.regex.substring(1,n),i=t.regex.substring(n+1);return e&&(e.i=i.includes("i"),e.s=i.includes("s"),e.u=i.includes("u")),ms(r,{cardinality:t.cardinality,lookahead:t.lookahead,wrap:!1})}else{if(l2(t))return ms(sb,{cardinality:t.cardinality,lookahead:t.lookahead});throw new Error(`Invalid terminal element: ${t?.$type}`)}}}function R2(t){return ms(t.elements.map(e=>Sl(e)).join("|"),{cardinality:t.cardinality,lookahead:t.lookahead})}function S2(t){return ms(t.elements.map(e=>Sl(e)).join(""),{cardinality:t.
cardinality,lookahead:t.lookahead})}function $2(t){return ms(`${sb}*?${Sl(t.terminal)}`,{cardinality:t.cardinality,lookahead:t.lookahead})}function T2(t){return ms(`(?!${Sl(t.terminal)})${sb}*?`,{cardinality:t.cardinality,lookahead:t.lookahead})}function E2(t){return t.right?ms(`[${ab(t.left)}-${ab(t.right)}]`,{cardinality:t.cardinality,lookahead:t.lookahead,wrap:!1}):ms(ab(t.left),{cardinality:t.cardinality,lookahead:t.lookahead,wrap:!1})}function ab(t){return Uh(t.value)}function ms(t,e){var n;
return(e.wrap!==!1||e.lookahead)&&(t=`(${(n=e.lookahead)!==null&&n!==void 0?n:""}${t})`),e.cardinality?`${t}${e.cardinality}`:t}const ob={__proto__:null,findAssignment:H0,findNameAssignment:rb,findNodeForKeyword:Eu,findNodeForProperty:Yn,findNodesForKeyword:tb,findNodesForKeywordInternal:nb,findNodesForProperty:_l,getActionAtElement:B0,getActionType:K0,getAllReachableRules:Xw,getAllRulesUsedForCrossReferences:w2,getCrossReferenceTerminal:Qw,getEntryRule:Hh,getExplicitRuleType:Ja,getHiddenRules:F0,
getRuleType:Z0,getRuleTypeName:_2,getTypeName:Pu,isArrayCardinality:W0,isArrayOperator:b2,isCommentTerminal:U0,isDataType:k2,isDataTypeRule:Vh,isOptionalCardinality:Rl,terminalRegex:Cu};function P2(t){const e=[],n=t.Grammar;for(const r of n.rules)ps(r)&&U0(r)&&m2(Cu(r))&&e.push(r.name);return{multilineCommentRules:e,nameRegexp:R0}}var J0=typeof global=="object"&&global&&global.Object===Object&&global,C2=typeof self=="object"&&self&&self.Object===Object&&self,Ui=J0||C2||Function("return this")(),
Qr=Ui.Symbol,Y0=Object.prototype,x2=Y0.hasOwnProperty,A2=Y0.toString,xu=Qr?Qr.toStringTag:void 0;function I2(t){var e=x2.call(t,xu),n=t[xu];try{t[xu]=void 0;var r=!0}catch{}var i=A2.call(t);return r&&(e?t[xu]=n:delete t[xu]),i}var N2=Object.prototype,D2=N2.toString;function O2(t){return D2.call(t)}var L2="[object Null]",M2="[object Undefined]",X0=Qr?Qr.toStringTag:void 0;function ia(t){return t==null?t===void 0?M2:L2:X0&&X0 in Object(t)?I2(t):O2(t)}function mi(t){return t!=null&&typeof t=="objec\
t"}var j2="[object Symbol]";function Au(t){return typeof t=="symbol"||mi(t)&&ia(t)==j2}function Bh(t,e){for(var n=-1,r=t==null?0:t.length,i=Array(r);++n<r;)i[n]=e(t[n],n,t);return i}var yt=Array.isArray,Q0=Qr?Qr.prototype:void 0,eT=Q0?Q0.toString:void 0;function tT(t){if(typeof t=="string")return t;if(yt(t))return Bh(t,tT)+"";if(Au(t))return eT?eT.call(t):"";var e=t+"";return e=="0"&&1/t==-1/0?"-0":e}var q2=/\s/;function F2(t){for(var e=t.length;e--&&q2.test(t.charAt(e)););return e}var z2=/^\s+/;
function U2(t){return t&&t.slice(0,F2(t)+1).replace(z2,"")}function ei(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var nT=NaN,H2=/^[-+]0x[0-9a-f]+$/i,V2=/^0b[01]+$/i,B2=/^0o[0-7]+$/i,W2=parseInt;function G2(t){if(typeof t=="number")return t;if(Au(t))return nT;if(ei(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=ei(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=U2(t);var n=V2.test(t);return n||B2.test(t)?W2(t.slice(2),n?2:8):H2.test(t)?nT:+t}var rT=1/0,K2=17976931348623157e292;
function Z2(t){if(!t)return t===0?t:0;if(t=G2(t),t===rT||t===-rT){var e=t<0?-1:1;return e*K2}return t===t?t:0}function Wh(t){var e=Z2(t),n=e%1;return e===e?n?e-n:e:0}function Ya(t){return t}var J2="[object AsyncFunction]",Y2="[object Function]",X2="[object GeneratorFunction]",Q2="[object Proxy]";function gs(t){if(!ei(t))return!1;var e=ia(t);return e==Y2||e==X2||e==J2||e==Q2}var lb=Ui["__core-js_shared__"],iT=(function(){var t=/[^.]+$/.exec(lb&&lb.keys&&lb.keys.IE_PROTO||"");return t?"Symbol(src)\
_1."+t:""})();function ez(t){return!!iT&&iT in t}var tz=Function.prototype,nz=tz.toString;function Xa(t){if(t!=null){try{return nz.call(t)}catch{}try{return t+""}catch{}}return""}var rz=/[\\^$.*+?()[\]{}|]/g,iz=/^\[object .+?Constructor\]$/,sz=Function.prototype,az=Object.prototype,oz=sz.toString,lz=az.hasOwnProperty,cz=RegExp("^"+oz.call(lz).replace(rz,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function uz(t){if(!ei(t)||ez(t))return!1;var e=gs(t)?cz:iz;
return e.test(Xa(t))}function dz(t,e){return t?.[e]}function Qa(t,e){var n=dz(t,e);return uz(n)?n:void 0}var cb=Qa(Ui,"WeakMap"),sT=Object.create,fz=(function(){function t(){}return function(e){if(!ei(e))return{};if(sT)return sT(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}})();function pz(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}function Sn(){}function hz(t,e){
var n=-1,r=t.length;for(e||(e=Array(r));++n<r;)e[n]=t[n];return e}var mz=800,gz=16,yz=Date.now;function vz(t){var e=0,n=0;return function(){var r=yz(),i=gz-(r-n);if(n=r,i>0){if(++e>=mz)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}function wz(t){return function(){return t}}var Gh=(function(){try{var t=Qa(Object,"defineProperty");return t({},"",{}),t}catch{}})(),bz=Gh?function(t,e){return Gh(t,"toString",{configurable:!0,enumerable:!1,value:wz(e),writable:!0})}:Ya,kz=vz(bz);function aT(t,e){
for(var n=-1,r=t==null?0:t.length;++n<r&&e(t[n],n,t)!==!1;);return t}function oT(t,e,n,r){for(var i=t.length,s=n+-1;++s<i;)if(e(t[s],s,t))return s;return-1}function _z(t){return t!==t}function Rz(t,e,n){for(var r=n-1,i=t.length;++r<i;)if(t[r]===e)return r;return-1}function ub(t,e,n){return e===e?Rz(t,e,n):oT(t,_z,n)}function lT(t,e){var n=t==null?0:t.length;return!!n&&ub(t,e,0)>-1}var Sz=9007199254740991,$z=/^(?:0|[1-9]\d*)$/;function Kh(t,e){var n=typeof t;return e=e??Sz,!!e&&(n=="number"||n!="\
symbol"&&$z.test(t))&&t>-1&&t%1==0&&t<e}function db(t,e,n){e=="__proto__"&&Gh?Gh(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}function Iu(t,e){return t===e||t!==t&&e!==e}var Tz=Object.prototype,Ez=Tz.hasOwnProperty;function Zh(t,e,n){var r=t[e];(!(Ez.call(t,e)&&Iu(r,n))||n===void 0&&!(e in t))&&db(t,e,n)}function Nu(t,e,n,r){var i=!n;n||(n={});for(var s=-1,a=e.length;++s<a;){var o=e[s],l=void 0;l===void 0&&(l=t[o]),i?db(n,o,l):Zh(n,o,l)}return n}var cT=Math.max;function Pz(t,e,n){
return e=cT(e===void 0?t.length-1:e,0),function(){for(var r=arguments,i=-1,s=cT(r.length-e,0),a=Array(s);++i<s;)a[i]=r[e+i];i=-1;for(var o=Array(e+1);++i<e;)o[i]=r[i];return o[e]=n(a),pz(t,this,o)}}function fb(t,e){return kz(Pz(t,e,Ya),t+"")}var Cz=9007199254740991;function pb(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=Cz}function Hi(t){return t!=null&&pb(t.length)&&!gs(t)}function uT(t,e,n){if(!ei(n))return!1;var r=typeof e;return(r=="number"?Hi(n)&&Kh(e,n.length):r=="string"&&e in n)?Iu(n[e],
t):!1}function xz(t){return fb(function(e,n){var r=-1,i=n.length,s=i>1?n[i-1]:void 0,a=i>2?n[2]:void 0;for(s=t.length>3&&typeof s=="function"?(i--,s):void 0,a&&uT(n[0],n[1],a)&&(s=i<3?void 0:s,i=1),e=Object(e);++r<i;){var o=n[r];o&&t(e,o,r,s)}return e})}var Az=Object.prototype;function Du(t){var e=t&&t.constructor,n=typeof e=="function"&&e.prototype||Az;return t===n}function Iz(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}var Nz="[object Arguments]";function dT(t){return mi(t)&&ia(t)==
Nz}var fT=Object.prototype,Dz=fT.hasOwnProperty,Oz=fT.propertyIsEnumerable,Jh=dT((function(){return arguments})())?dT:function(t){return mi(t)&&Dz.call(t,"callee")&&!Oz.call(t,"callee")};function Lz(){return!1}var pT=typeof exports=="object"&&exports&&!exports.nodeType&&exports,hT=pT&&typeof module=="object"&&module&&!module.nodeType&&module,Mz=hT&&hT.exports===pT,mT=Mz?Ui.Buffer:void 0,jz=mT?mT.isBuffer:void 0,Ou=jz||Lz,qz="[object Arguments]",Fz="[object Array]",zz="[object Boolean]",Uz="[obje\
ct Date]",Hz="[object Error]",Vz="[object Function]",Bz="[object Map]",Wz="[object Number]",Gz="[object Object]",Kz="[object RegExp]",Zz="[object Set]",Jz="[object String]",Yz="[object WeakMap]",Xz="[object ArrayBuffer]",Qz="[object DataView]",e4="[object Float32Array]",t4="[object Float64Array]",n4="[object Int8Array]",r4="[object Int16Array]",i4="[object Int32Array]",s4="[object Uint8Array]",a4="[object Uint8ClampedArray]",o4="[object Uint16Array]",l4="[object Uint32Array]",Bt={};Bt[e4]=Bt[t4]=
Bt[n4]=Bt[r4]=Bt[i4]=Bt[s4]=Bt[a4]=Bt[o4]=Bt[l4]=!0,Bt[qz]=Bt[Fz]=Bt[Xz]=Bt[zz]=Bt[Qz]=Bt[Uz]=Bt[Hz]=Bt[Vz]=Bt[Bz]=Bt[Wz]=Bt[Gz]=Bt[Kz]=Bt[Zz]=Bt[Jz]=Bt[Yz]=!1;function c4(t){return mi(t)&&pb(t.length)&&!!Bt[ia(t)]}function Yh(t){return function(e){return t(e)}}var gT=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Lu=gT&&typeof module=="object"&&module&&!module.nodeType&&module,u4=Lu&&Lu.exports===gT,hb=u4&&J0.process,sa=(function(){try{var t=Lu&&Lu.require&&Lu.require("util").types;
return t||hb&&hb.binding&&hb.binding("util")}catch{}})(),yT=sa&&sa.isTypedArray,mb=yT?Yh(yT):c4,d4=Object.prototype,f4=d4.hasOwnProperty;function vT(t,e){var n=yt(t),r=!n&&Jh(t),i=!n&&!r&&Ou(t),s=!n&&!r&&!i&&mb(t),a=n||r||i||s,o=a?Iz(t.length,String):[],l=o.length;for(var c in t)(e||f4.call(t,c))&&!(a&&(c=="length"||i&&(c=="offset"||c=="parent")||s&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||Kh(c,l)))&&o.push(c);return o}function wT(t,e){return function(n){return t(e(n))}}var p4=wT(Object.
keys,Object),h4=Object.prototype,m4=h4.hasOwnProperty;function bT(t){if(!Du(t))return p4(t);var e=[];for(var n in Object(t))m4.call(t,n)&&n!="constructor"&&e.push(n);return e}function ti(t){return Hi(t)?vT(t):bT(t)}var g4=Object.prototype,y4=g4.hasOwnProperty,Ar=xz(function(t,e){if(Du(e)||Hi(e)){Nu(e,ti(e),t);return}for(var n in e)y4.call(e,n)&&Zh(t,n,e[n])});function v4(t){var e=[];if(t!=null)for(var n in Object(t))e.push(n);return e}var w4=Object.prototype,b4=w4.hasOwnProperty;function k4(t){if(!ei(
t))return v4(t);var e=Du(t),n=[];for(var r in t)r=="constructor"&&(e||!b4.call(t,r))||n.push(r);return n}function gb(t){return Hi(t)?vT(t,!0):k4(t)}var _4=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,R4=/^\w*$/;function yb(t,e){if(yt(t))return!1;var n=typeof t;return n=="number"||n=="symbol"||n=="boolean"||t==null||Au(t)?!0:R4.test(t)||!_4.test(t)||e!=null&&t in Object(e)}var Mu=Qa(Object,"create");function S4(){this.__data__=Mu?Mu(null):{},this.size=0}function $4(t){var e=this.has(t)&&delete this.
__data__[t];return this.size-=e?1:0,e}var T4="__lodash_hash_undefined__",E4=Object.prototype,P4=E4.hasOwnProperty;function C4(t){var e=this.__data__;if(Mu){var n=e[t];return n===T4?void 0:n}return P4.call(e,t)?e[t]:void 0}var x4=Object.prototype,A4=x4.hasOwnProperty;function I4(t){var e=this.__data__;return Mu?e[t]!==void 0:A4.call(e,t)}var N4="__lodash_hash_undefined__";function D4(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=Mu&&e===void 0?N4:e,this}function eo(t){var e=-1,n=t==
null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}eo.prototype.clear=S4,eo.prototype.delete=$4,eo.prototype.get=C4,eo.prototype.has=I4,eo.prototype.set=D4;function O4(){this.__data__=[],this.size=0}function Xh(t,e){for(var n=t.length;n--;)if(Iu(t[n][0],e))return n;return-1}var L4=Array.prototype,M4=L4.splice;function j4(t){var e=this.__data__,n=Xh(e,t);if(n<0)return!1;var r=e.length-1;return n==r?e.pop():M4.call(e,n,1),--this.size,!0}function q4(t){var e=this.__data__,n=Xh(
e,t);return n<0?void 0:e[n][1]}function F4(t){return Xh(this.__data__,t)>-1}function z4(t,e){var n=this.__data__,r=Xh(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this}function ys(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}ys.prototype.clear=O4,ys.prototype.delete=j4,ys.prototype.get=q4,ys.prototype.has=F4,ys.prototype.set=z4;var ju=Qa(Ui,"Map");function U4(){this.size=0,this.__data__={hash:new eo,map:new(ju||ys),string:new eo}}function H4(t){
var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}function Qh(t,e){var n=t.__data__;return H4(e)?n[typeof e=="string"?"string":"hash"]:n.map}function V4(t){var e=Qh(this,t).delete(t);return this.size-=e?1:0,e}function B4(t){return Qh(this,t).get(t)}function W4(t){return Qh(this,t).has(t)}function G4(t,e){var n=Qh(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this}function vs(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];
this.set(r[0],r[1])}}vs.prototype.clear=U4,vs.prototype.delete=V4,vs.prototype.get=B4,vs.prototype.has=W4,vs.prototype.set=G4;var K4="Expected a function";function vb(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError(K4);var n=function(){var r=arguments,i=e?e.apply(this,r):r[0],s=n.cache;if(s.has(i))return s.get(i);var a=t.apply(this,r);return n.cache=s.set(i,a)||s,a};return n.cache=new(vb.Cache||vs),n}vb.Cache=vs;var Z4=500;function J4(t){var e=vb(t,function(r){return n.
size===Z4&&n.clear(),r}),n=e.cache;return e}var Y4=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,X4=/\\(\\)?/g,Q4=J4(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(Y4,function(n,r,i,s){e.push(i?s.replace(X4,"$1"):r||n)}),e});function eU(t){return t==null?"":tT(t)}function em(t,e){return yt(t)?t:yb(t,e)?[t]:Q4(eU(t))}function qu(t){if(typeof t=="string"||Au(t))return t;var e=t+"";return e=="0"&&1/t==-1/0?"-0":e}function wb(t,e){
e=em(e,t);for(var n=0,r=e.length;t!=null&&n<r;)t=t[qu(e[n++])];return n&&n==r?t:void 0}function tU(t,e,n){var r=t==null?void 0:wb(t,e);return r===void 0?n:r}function bb(t,e){for(var n=-1,r=e.length,i=t.length;++n<r;)t[i+n]=e[n];return t}var kT=Qr?Qr.isConcatSpreadable:void 0;function nU(t){return yt(t)||Jh(t)||!!(kT&&t&&t[kT])}function kb(t,e,n,r,i){var s=-1,a=t.length;for(n||(n=nU),i||(i=[]);++s<a;){var o=t[s];n(o)?bb(i,o):r||(i[i.length]=o)}return i}function ni(t){var e=t==null?0:t.length;return e?
kb(t):[]}var _T=wT(Object.getPrototypeOf,Object);function RT(t,e,n){var r=-1,i=t.length;e<0&&(e=-e>i?0:i+e),n=n>i?i:n,n<0&&(n+=i),i=e>n?0:n-e>>>0,e>>>=0;for(var s=Array(i);++r<i;)s[r]=t[r+e];return s}function rU(t,e,n,r){var i=-1,s=t==null?0:t.length;for(r&&s&&(n=t[++i]);++i<s;)n=e(n,t[i],i,t);return n}function iU(){this.__data__=new ys,this.size=0}function sU(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n}function aU(t){return this.__data__.get(t)}function oU(t){return this.__data__.
has(t)}var lU=200;function cU(t,e){var n=this.__data__;if(n instanceof ys){var r=n.__data__;if(!ju||r.length<lU-1)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new vs(r)}return n.set(t,e),this.size=n.size,this}function Vi(t){var e=this.__data__=new ys(t);this.size=e.size}Vi.prototype.clear=iU,Vi.prototype.delete=sU,Vi.prototype.get=aU,Vi.prototype.has=oU,Vi.prototype.set=cU;function uU(t,e){return t&&Nu(e,ti(e),t)}function dU(t,e){return t&&Nu(e,gb(e),t)}var ST=typeof exports=="ob\
ject"&&exports&&!exports.nodeType&&exports,$T=ST&&typeof module=="object"&&module&&!module.nodeType&&module,fU=$T&&$T.exports===ST,TT=fU?Ui.Buffer:void 0,ET=TT?TT.allocUnsafe:void 0;function pU(t,e){var n=t.length,r=ET?ET(n):new t.constructor(n);return t.copy(r),r}function _b(t,e){for(var n=-1,r=t==null?0:t.length,i=0,s=[];++n<r;){var a=t[n];e(a,n,t)&&(s[i++]=a)}return s}function PT(){return[]}var hU=Object.prototype,mU=hU.propertyIsEnumerable,CT=Object.getOwnPropertySymbols,Rb=CT?function(t){return t==
null?[]:(t=Object(t),_b(CT(t),function(e){return mU.call(t,e)}))}:PT;function gU(t,e){return Nu(t,Rb(t),e)}var yU=Object.getOwnPropertySymbols,xT=yU?function(t){for(var e=[];t;)bb(e,Rb(t)),t=_T(t);return e}:PT;function vU(t,e){return Nu(t,xT(t),e)}function AT(t,e,n){var r=e(t);return yt(t)?r:bb(r,n(t))}function Sb(t){return AT(t,ti,Rb)}function wU(t){return AT(t,gb,xT)}var $b=Qa(Ui,"DataView"),Tb=Qa(Ui,"Promise"),$l=Qa(Ui,"Set"),IT="[object Map]",bU="[object Object]",NT="[object Promise]",DT="[o\
bject Set]",OT="[object WeakMap]",LT="[object DataView]",kU=Xa($b),_U=Xa(ju),RU=Xa(Tb),SU=Xa($l),$U=Xa(cb),ri=ia;($b&&ri(new $b(new ArrayBuffer(1)))!=LT||ju&&ri(new ju)!=IT||Tb&&ri(Tb.resolve())!=NT||$l&&ri(new $l)!=DT||cb&&ri(new cb)!=OT)&&(ri=function(t){var e=ia(t),n=e==bU?t.constructor:void 0,r=n?Xa(n):"";if(r)switch(r){case kU:return LT;case _U:return IT;case RU:return NT;case SU:return DT;case $U:return OT}return e});var TU=Object.prototype,EU=TU.hasOwnProperty;function PU(t){var e=t.length,
n=new t.constructor(e);return e&&typeof t[0]=="string"&&EU.call(t,"index")&&(n.index=t.index,n.input=t.input),n}var tm=Ui.Uint8Array;function CU(t){var e=new t.constructor(t.byteLength);return new tm(e).set(new tm(t)),e}function xU(t,e){var n=t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}var AU=/\w*$/;function IU(t){var e=new t.constructor(t.source,AU.exec(t));return e.lastIndex=t.lastIndex,e}var MT=Qr?Qr.prototype:void 0,jT=MT?MT.valueOf:void 0;function NU(t){return jT?Object(jT.
call(t)):{}}function DU(t,e){var n=t.buffer;return new t.constructor(n,t.byteOffset,t.length)}var OU="[object Boolean]",LU="[object Date]",MU="[object Map]",jU="[object Number]",qU="[object RegExp]",FU="[object Set]",zU="[object String]",UU="[object Symbol]",HU="[object ArrayBuffer]",VU="[object DataView]",BU="[object Float32Array]",WU="[object Float64Array]",GU="[object Int8Array]",KU="[object Int16Array]",ZU="[object Int32Array]",JU="[object Uint8Array]",YU="[object Uint8ClampedArray]",XU="[ob\
ject Uint16Array]",QU="[object Uint32Array]";function eH(t,e,n){var r=t.constructor;switch(e){case HU:return CU(t);case OU:case LU:return new r(+t);case VU:return xU(t);case BU:case WU:case GU:case KU:case ZU:case JU:case YU:case XU:case QU:return DU(t);case MU:return new r;case jU:case zU:return new r(t);case qU:return IU(t);case FU:return new r;case UU:return NU(t)}}function tH(t){return typeof t.constructor=="function"&&!Du(t)?fz(_T(t)):{}}var nH="[object Map]";function rH(t){return mi(t)&&ri(
t)==nH}var qT=sa&&sa.isMap,iH=qT?Yh(qT):rH,sH="[object Set]";function aH(t){return mi(t)&&ri(t)==sH}var FT=sa&&sa.isSet,oH=FT?Yh(FT):aH,lH=2,zT="[object Arguments]",cH="[object Array]",uH="[object Boolean]",dH="[object Date]",fH="[object Error]",UT="[object Function]",pH="[object GeneratorFunction]",hH="[object Map]",mH="[object Number]",HT="[object Object]",gH="[object RegExp]",yH="[object Set]",vH="[object String]",wH="[object Symbol]",bH="[object WeakMap]",kH="[object ArrayBuffer]",_H="[objec\
t DataView]",RH="[object Float32Array]",SH="[object Float64Array]",$H="[object Int8Array]",TH="[object Int16Array]",EH="[object Int32Array]",PH="[object Uint8Array]",CH="[object Uint8ClampedArray]",xH="[object Uint16Array]",AH="[object Uint32Array]",qt={};qt[zT]=qt[cH]=qt[kH]=qt[_H]=qt[uH]=qt[dH]=qt[RH]=qt[SH]=qt[$H]=qt[TH]=qt[EH]=qt[hH]=qt[mH]=qt[HT]=qt[gH]=qt[yH]=qt[vH]=qt[wH]=qt[PH]=qt[CH]=qt[xH]=qt[AH]=!0,qt[fH]=qt[UT]=qt[bH]=!1;function nm(t,e,n,r,i,s){var a,o=e&lH;if(a!==void 0)return a;if(!ei(
t))return t;var l=yt(t);if(l)return a=PU(t),hz(t,a);var c=ri(t),u=c==UT||c==pH;if(Ou(t))return pU(t);if(c==HT||c==zT||u&&!i)return a=u?{}:tH(t),o?vU(t,dU(a,t)):gU(t,uU(a,t));if(!qt[c])return i?t:{};a=eH(t,c),s||(s=new Vi);var d=s.get(t);if(d)return d;s.set(t,a),oH(t)?t.forEach(function(m){a.add(nm(m,e,n,m,t,s))}):iH(t)&&t.forEach(function(m,w){a.set(w,nm(m,e,n,w,t,s))});var f=Sb,p=l?void 0:f(t);return aT(p||t,function(m,w){p&&(w=m,m=t[w]),Zh(a,w,nm(m,e,n,w,t,s))}),a}var IH=4;function jn(t){return nm(
t,IH)}function Fu(t){for(var e=-1,n=t==null?0:t.length,r=0,i=[];++e<n;){var s=t[e];s&&(i[r++]=s)}return i}var NH="__lodash_hash_undefined__";function DH(t){return this.__data__.set(t,NH),this}function OH(t){return this.__data__.has(t)}function Tl(t){var e=-1,n=t==null?0:t.length;for(this.__data__=new vs;++e<n;)this.add(t[e])}Tl.prototype.add=Tl.prototype.push=DH,Tl.prototype.has=OH;function VT(t,e){for(var n=-1,r=t==null?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}function Eb(t,e){return t.
has(e)}var LH=1,MH=2;function BT(t,e,n,r,i,s){var a=n&LH,o=t.length,l=e.length;if(o!=l&&!(a&&l>o))return!1;var c=s.get(t),u=s.get(e);if(c&&u)return c==e&&u==t;var d=-1,f=!0,p=n&MH?new Tl:void 0;for(s.set(t,e),s.set(e,t);++d<o;){var m=t[d],w=e[d];if(r)var v=a?r(w,m,d,e,t,s):r(m,w,d,t,e,s);if(v!==void 0){if(v)continue;f=!1;break}if(p){if(!VT(e,function(g,h){if(!Eb(p,h)&&(m===g||i(m,g,n,r,s)))return p.push(h)})){f=!1;break}}else if(!(m===w||i(m,w,n,r,s))){f=!1;break}}return s.delete(t),s.delete(e),
f}function jH(t){var e=-1,n=Array(t.size);return t.forEach(function(r,i){n[++e]=[i,r]}),n}function Pb(t){var e=-1,n=Array(t.size);return t.forEach(function(r){n[++e]=r}),n}var qH=1,FH=2,zH="[object Boolean]",UH="[object Date]",HH="[object Error]",VH="[object Map]",BH="[object Number]",WH="[object RegExp]",GH="[object Set]",KH="[object String]",ZH="[object Symbol]",JH="[object ArrayBuffer]",YH="[object DataView]",WT=Qr?Qr.prototype:void 0,Cb=WT?WT.valueOf:void 0;function XH(t,e,n,r,i,s,a){switch(n){case YH:
if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case JH:return!(t.byteLength!=e.byteLength||!s(new tm(t),new tm(e)));case zH:case UH:case BH:return Iu(+t,+e);case HH:return t.name==e.name&&t.message==e.message;case WH:case KH:return t==e+"";case VH:var o=jH;case GH:var l=r&qH;if(o||(o=Pb),t.size!=e.size&&!l)return!1;var c=a.get(t);if(c)return c==e;r|=FH,a.set(t,e);var u=BT(o(t),o(e),r,i,s,a);return a.delete(t),u;case ZH:if(Cb)return Cb.call(t)==Cb.call(e)}
return!1}var QH=1,eV=Object.prototype,tV=eV.hasOwnProperty;function nV(t,e,n,r,i,s){var a=n&QH,o=Sb(t),l=o.length,c=Sb(e),u=c.length;if(l!=u&&!a)return!1;for(var d=l;d--;){var f=o[d];if(!(a?f in e:tV.call(e,f)))return!1}var p=s.get(t),m=s.get(e);if(p&&m)return p==e&&m==t;var w=!0;s.set(t,e),s.set(e,t);for(var v=a;++d<l;){f=o[d];var g=t[f],h=e[f];if(r)var y=a?r(h,g,f,e,t,s):r(g,h,f,t,e,s);if(!(y===void 0?g===h||i(g,h,n,r,s):y)){w=!1;break}v||(v=f=="constructor")}if(w&&!v){var b=t.constructor,R=e.
constructor;b!=R&&"constructor"in t&&"constructor"in e&&!(typeof b=="function"&&b instanceof b&&typeof R=="function"&&R instanceof R)&&(w=!1)}return s.delete(t),s.delete(e),w}var rV=1,GT="[object Arguments]",KT="[object Array]",rm="[object Object]",iV=Object.prototype,ZT=iV.hasOwnProperty;function sV(t,e,n,r,i,s){var a=yt(t),o=yt(e),l=a?KT:ri(t),c=o?KT:ri(e);l=l==GT?rm:l,c=c==GT?rm:c;var u=l==rm,d=c==rm,f=l==c;if(f&&Ou(t)){if(!Ou(e))return!1;a=!0,u=!1}if(f&&!u)return s||(s=new Vi),a||mb(t)?BT(t,
e,n,r,i,s):XH(t,e,l,n,r,i,s);if(!(n&rV)){var p=u&&ZT.call(t,"__wrapped__"),m=d&&ZT.call(e,"__wrapped__");if(p||m){var w=p?t.value():t,v=m?e.value():e;return s||(s=new Vi),i(w,v,n,r,s)}}return f?(s||(s=new Vi),nV(t,e,n,r,i,s)):!1}function xb(t,e,n,r,i){return t===e?!0:t==null||e==null||!mi(t)&&!mi(e)?t!==t&&e!==e:sV(t,e,n,r,xb,i)}var aV=1,oV=2;function lV(t,e,n,r){var i=n.length,s=i;if(t==null)return!s;for(t=Object(t);i--;){var a=n[i];if(a[2]?a[1]!==t[a[0]]:!(a[0]in t))return!1}for(;++i<s;){a=n[i];
var o=a[0],l=t[o],c=a[1];if(a[2]){if(l===void 0&&!(o in t))return!1}else{var u=new Vi,d;if(!(d===void 0?xb(c,l,aV|oV,r,u):d))return!1}}return!0}function JT(t){return t===t&&!ei(t)}function cV(t){for(var e=ti(t),n=e.length;n--;){var r=e[n],i=t[r];e[n]=[r,i,JT(i)]}return e}function YT(t,e){return function(n){return n==null?!1:n[t]===e&&(e!==void 0||t in Object(n))}}function uV(t){var e=cV(t);return e.length==1&&e[0][2]?YT(e[0][0],e[0][1]):function(n){return n===t||lV(n,t,e)}}function dV(t,e){return t!=
null&&e in Object(t)}function XT(t,e,n){e=em(e,t);for(var r=-1,i=e.length,s=!1;++r<i;){var a=qu(e[r]);if(!(s=t!=null&&n(t,a)))break;t=t[a]}return s||++r!=i?s:(i=t==null?0:t.length,!!i&&pb(i)&&Kh(a,i)&&(yt(t)||Jh(t)))}function fV(t,e){return t!=null&&XT(t,e,dV)}var pV=1,hV=2;function mV(t,e){return yb(t)&&JT(e)?YT(qu(t),e):function(n){var r=tU(n,t);return r===void 0&&r===e?fV(n,t):xb(e,r,pV|hV)}}function gV(t){return function(e){return e?.[t]}}function yV(t){return function(e){return wb(e,t)}}function vV(t){
return yb(t)?gV(qu(t)):yV(t)}function gi(t){return typeof t=="function"?t:t==null?Ya:typeof t=="object"?yt(t)?mV(t[0],t[1]):uV(t):vV(t)}function wV(t,e,n,r){for(var i=-1,s=t==null?0:t.length;++i<s;){var a=t[i];e(r,a,n(a),t)}return r}function bV(t){return function(e,n,r){for(var i=-1,s=Object(e),a=r(e),o=a.length;o--;){var l=a[++i];if(n(s[l],l,s)===!1)break}return e}}var kV=bV();function _V(t,e){return t&&kV(t,e,ti)}function RV(t,e){return function(n,r){if(n==null)return n;if(!Hi(n))return t(n,r);
for(var i=n.length,s=-1,a=Object(n);++s<i&&r(a[s],s,a)!==!1;);return n}}var to=RV(_V);function SV(t,e,n,r){return to(t,function(i,s,a){e(r,i,n(i),a)}),r}function $V(t,e){return function(n,r){var i=yt(n)?wV:SV,s=e?e():{};return i(n,t,gi(r),s)}}var QT=Object.prototype,TV=QT.hasOwnProperty,Ab=fb(function(t,e){t=Object(t);var n=-1,r=e.length,i=r>2?e[2]:void 0;for(i&&uT(e[0],e[1],i)&&(r=1);++n<r;)for(var s=e[n],a=gb(s),o=-1,l=a.length;++o<l;){var c=a[o],u=t[c];(u===void 0||Iu(u,QT[c])&&!TV.call(t,c))&&
(t[c]=s[c])}return t});function eE(t){return mi(t)&&Hi(t)}var EV=200;function PV(t,e,n,r){var i=-1,s=lT,a=!0,o=t.length,l=[],c=e.length;if(!o)return l;e.length>=EV&&(s=Eb,a=!1,e=new Tl(e));e:for(;++i<o;){var u=t[i],d=u;if(u=u!==0?u:0,a&&d===d){for(var f=c;f--;)if(e[f]===d)continue e;l.push(u)}else s(e,d,r)||l.push(u)}return l}var im=fb(function(t,e){return eE(t)?PV(t,kb(e,1,eE,!0)):[]});function El(t){var e=t==null?0:t.length;return e?t[e-1]:void 0}function qn(t,e,n){var r=t==null?0:t.length;return r?
(e=e===void 0?1:Wh(e),RT(t,e<0?0:e,r)):[]}function zu(t,e,n){var r=t==null?0:t.length;return r?(e=e===void 0?1:Wh(e),e=r-e,RT(t,0,e<0?0:e)):[]}function CV(t){return typeof t=="function"?t:Ya}function je(t,e){var n=yt(t)?aT:to;return n(t,CV(e))}function xV(t,e){for(var n=-1,r=t==null?0:t.length;++n<r;)if(!e(t[n],n,t))return!1;return!0}function AV(t,e){var n=!0;return to(t,function(r,i,s){return n=!!e(r,i,s),n}),n}function yi(t,e,n){var r=yt(t)?xV:AV;return r(t,gi(e))}function tE(t,e){var n=[];return to(
t,function(r,i,s){e(r,i,s)&&n.push(r)}),n}function Ir(t,e){var n=yt(t)?_b:tE;return n(t,gi(e))}function IV(t){return function(e,n,r){var i=Object(e);if(!Hi(e)){var s=gi(n);e=ti(e),n=function(o){return s(i[o],o,i)}}var a=t(e,n,r);return a>-1?i[s?e[a]:a]:void 0}}var NV=Math.max;function DV(t,e,n){var r=t==null?0:t.length;if(!r)return-1;var i=n==null?0:Wh(n);return i<0&&(i=NV(r+i,0)),oT(t,gi(e),i)}var Pl=IV(DV);function vi(t){return t&&t.length?t[0]:void 0}function OV(t,e){var n=-1,r=Hi(t)?Array(t.
length):[];return to(t,function(i,s,a){r[++n]=e(i,s,a)}),r}function xe(t,e){var n=yt(t)?Bh:OV;return n(t,gi(e))}function Nr(t,e){return kb(xe(t,e))}var LV=Object.prototype,MV=LV.hasOwnProperty,jV=$V(function(t,e,n){MV.call(t,n)?t[n].push(e):db(t,n,[e])}),qV=Object.prototype,FV=qV.hasOwnProperty;function zV(t,e){return t!=null&&FV.call(t,e)}function qe(t,e){return t!=null&&XT(t,e,zV)}var UV="[object String]";function vr(t){return typeof t=="string"||!yt(t)&&mi(t)&&ia(t)==UV}function HV(t,e){return Bh(
e,function(n){return t[n]})}function $n(t){return t==null?[]:HV(t,ti(t))}var VV=Math.max;function rr(t,e,n,r){t=Hi(t)?t:$n(t),n=n?Wh(n):0;var i=t.length;return n<0&&(n=VV(i+n,0)),vr(t)?n<=i&&t.indexOf(e,n)>-1:!!i&&ub(t,e,n)>-1}function nE(t,e,n){var r=t==null?0:t.length;if(!r)return-1;var i=0;return ub(t,e,i)}var BV="[object Map]",WV="[object Set]",GV=Object.prototype,KV=GV.hasOwnProperty;function Ot(t){if(t==null)return!0;if(Hi(t)&&(yt(t)||typeof t=="string"||typeof t.splice=="function"||Ou(t)||
mb(t)||Jh(t)))return!t.length;var e=ri(t);if(e==BV||e==WV)return!t.size;if(Du(t))return!bT(t).length;for(var n in t)if(KV.call(t,n))return!1;return!0}var ZV="[object RegExp]";function JV(t){return mi(t)&&ia(t)==ZV}var rE=sa&&sa.isRegExp,ws=rE?Yh(rE):JV;function bs(t){return t===void 0}function YV(t,e){return t<e}function XV(t,e,n){for(var r=-1,i=t.length;++r<i;){var s=t[r],a=e(s);if(a!=null&&(o===void 0?a===a&&!Au(a):n(a,o)))var o=a,l=s}return l}function QV(t){return t&&t.length?XV(t,Ya,YV):void 0}
var eB="Expected a function";function tB(t){if(typeof t!="function")throw new TypeError(eB);return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}function nB(t,e,n,r){if(!ei(t))return t;e=em(e,t);for(var i=-1,s=e.length,a=s-1,o=t;o!=null&&++i<s;){var l=qu(e[i]),c=n;if(l==="__proto__"||l==="constructor"||l==="prototype")return t;if(i!=a){var u=o[l];
c=void 0,c===void 0&&(c=ei(u)?u:Kh(e[i+1])?[]:{})}Zh(o,l,c),o=o[l]}return t}function rB(t,e,n){for(var r=-1,i=e.length,s={};++r<i;){var a=e[r],o=wb(t,a);n(o,a)&&nB(s,em(a,t),o)}return s}function wi(t,e){if(t==null)return{};var n=Bh(wU(t),function(r){return[r]});return e=gi(e),rB(t,n,function(r,i){return e(r,i[0])})}function iB(t,e,n,r,i){return i(t,function(s,a,o){n=r?(r=!1,s):e(n,s,a,o)}),n}function ir(t,e,n){var r=yt(t)?rU:iB,i=arguments.length<3;return r(t,gi(e),n,i,to)}function sm(t,e){var n=yt(
t)?_b:tE;return n(t,tB(gi(e)))}function sB(t,e){var n;return to(t,function(r,i,s){return n=e(r,i,s),!n}),!!n}function iE(t,e,n){var r=yt(t)?VT:sB;return r(t,gi(e))}var aB=1/0,oB=$l&&1/Pb(new $l([,-0]))[1]==aB?function(t){return new $l(t)}:Sn,lB=200;function sE(t,e,n){var r=-1,i=lT,s=t.length,a=!0,o=[],l=o;if(s>=lB){var c=e?null:oB(t);if(c)return Pb(c);a=!1,i=Eb,l=new Tl}else l=e?[]:o;e:for(;++r<s;){var u=t[r],d=e?e(u):u;if(u=u!==0?u:0,a&&d===d){for(var f=l.length;f--;)if(l[f]===d)continue e;e&&l.
push(d),o.push(u)}else i(l,d,n)||(l!==o&&l.push(d),o.push(u))}return o}function Ib(t){return t&&t.length?sE(t):[]}function cB(t,e){return t&&t.length?sE(t,gi(e)):[]}function Nb(t){console&&console.error&&console.error(`Error: ${t}`)}function aE(t){console&&console.warn&&console.warn(`Warning: ${t}`)}function oE(t){const e=new Date().getTime(),n=t();return{time:new Date().getTime()-e,value:n}}function lE(t){function e(){}e.prototype=t;const n=new e;function r(){return typeof n.bar}return r(),r(),
t}function uB(t){return dB(t)?t.LABEL:t.name}function dB(t){return vr(t.LABEL)&&t.LABEL!==""}class Bi{get definition(){return this._definition}set definition(e){this._definition=e}constructor(e){this._definition=e}accept(e){e.visit(this),je(this.definition,n=>{n.accept(e)})}}class sr extends Bi{constructor(e){super([]),this.idx=1,Ar(this,wi(e,n=>n!==void 0))}set definition(e){}get definition(){return this.referencedRule!==void 0?this.referencedRule.definition:[]}accept(e){e.visit(this)}}class Cl extends Bi{constructor(e){
super(e.definition),this.orgText="",Ar(this,wi(e,n=>n!==void 0))}}class wr extends Bi{constructor(e){super(e.definition),this.ignoreAmbiguities=!1,Ar(this,wi(e,n=>n!==void 0))}}class Fn extends Bi{constructor(e){super(e.definition),this.idx=1,Ar(this,wi(e,n=>n!==void 0))}}class Dr extends Bi{constructor(e){super(e.definition),this.idx=1,Ar(this,wi(e,n=>n!==void 0))}}class Or extends Bi{constructor(e){super(e.definition),this.idx=1,Ar(this,wi(e,n=>n!==void 0))}}class cn extends Bi{constructor(e){
super(e.definition),this.idx=1,Ar(this,wi(e,n=>n!==void 0))}}class br extends Bi{constructor(e){super(e.definition),this.idx=1,Ar(this,wi(e,n=>n!==void 0))}}class kr extends Bi{get definition(){return this._definition}set definition(e){this._definition=e}constructor(e){super(e.definition),this.idx=1,this.ignoreAmbiguities=!1,this.hasPredicates=!1,Ar(this,wi(e,n=>n!==void 0))}}class Wt{constructor(e){this.idx=1,Ar(this,wi(e,n=>n!==void 0))}accept(e){e.visit(this)}}function fB(t){return xe(t,am)}function am(t){
function e(n){return xe(n,am)}if(t instanceof sr){const n={type:"NonTerminal",name:t.nonTerminalName,idx:t.idx};return vr(t.label)&&(n.label=t.label),n}else{if(t instanceof wr)return{type:"Alternative",definition:e(t.definition)};if(t instanceof Fn)return{type:"Option",idx:t.idx,definition:e(t.definition)};if(t instanceof Dr)return{type:"RepetitionMandatory",idx:t.idx,definition:e(t.definition)};if(t instanceof Or)return{type:"RepetitionMandatoryWithSeparator",idx:t.idx,separator:am(new Wt({terminalType:t.
separator})),definition:e(t.definition)};if(t instanceof br)return{type:"RepetitionWithSeparator",idx:t.idx,separator:am(new Wt({terminalType:t.separator})),definition:e(t.definition)};if(t instanceof cn)return{type:"Repetition",idx:t.idx,definition:e(t.definition)};if(t instanceof kr)return{type:"Alternation",idx:t.idx,definition:e(t.definition)};if(t instanceof Wt){const n={type:"Terminal",name:t.terminalType.name,label:uB(t.terminalType),idx:t.idx};vr(t.label)&&(n.terminalLabel=t.label);const r=t.
terminalType.PATTERN;return t.terminalType.PATTERN&&(n.pattern=ws(r)?r.source:r),n}else{if(t instanceof Cl)return{type:"Rule",name:t.name,orgText:t.orgText,definition:e(t.definition)};throw Error("non exhaustive match")}}}class xl{visit(e){const n=e;switch(n.constructor){case sr:return this.visitNonTerminal(n);case wr:return this.visitAlternative(n);case Fn:return this.visitOption(n);case Dr:return this.visitRepetitionMandatory(n);case Or:return this.visitRepetitionMandatoryWithSeparator(n);case br:
return this.visitRepetitionWithSeparator(n);case cn:return this.visitRepetition(n);case kr:return this.visitAlternation(n);case Wt:return this.visitTerminal(n);case Cl:return this.visitRule(n);default:throw Error("non exhaustive match")}}visitNonTerminal(e){}visitAlternative(e){}visitOption(e){}visitRepetition(e){}visitRepetitionMandatory(e){}visitRepetitionMandatoryWithSeparator(e){}visitRepetitionWithSeparator(e){}visitAlternation(e){}visitTerminal(e){}visitRule(e){}}function pB(t){return t instanceof
wr||t instanceof Fn||t instanceof cn||t instanceof Dr||t instanceof Or||t instanceof br||t instanceof Wt||t instanceof Cl}function om(t,e=[]){return t instanceof Fn||t instanceof cn||t instanceof br?!0:t instanceof kr?iE(t.definition,r=>om(r,e)):t instanceof sr&&rr(e,t)?!1:t instanceof Bi?(t instanceof sr&&e.push(t),yi(t.definition,r=>om(r,e))):!1}function hB(t){return t instanceof kr}function Wi(t){if(t instanceof sr)return"SUBRULE";if(t instanceof Fn)return"OPTION";if(t instanceof kr)return"OR";
if(t instanceof Dr)return"AT_LEAST_ONE";if(t instanceof Or)return"AT_LEAST_ONE_SEP";if(t instanceof br)return"MANY_SEP";if(t instanceof cn)return"MANY";if(t instanceof Wt)return"CONSUME";throw Error("non exhaustive match")}class lm{walk(e,n=[]){je(e.definition,(r,i)=>{const s=qn(e.definition,i+1);if(r instanceof sr)this.walkProdRef(r,s,n);else if(r instanceof Wt)this.walkTerminal(r,s,n);else if(r instanceof wr)this.walkFlat(r,s,n);else if(r instanceof Fn)this.walkOption(r,s,n);else if(r instanceof
Dr)this.walkAtLeastOne(r,s,n);else if(r instanceof Or)this.walkAtLeastOneSep(r,s,n);else if(r instanceof br)this.walkManySep(r,s,n);else if(r instanceof cn)this.walkMany(r,s,n);else if(r instanceof kr)this.walkOr(r,s,n);else throw Error("non exhaustive match")})}walkTerminal(e,n,r){}walkProdRef(e,n,r){}walkFlat(e,n,r){const i=n.concat(r);this.walk(e,i)}walkOption(e,n,r){const i=n.concat(r);this.walk(e,i)}walkAtLeastOne(e,n,r){const i=[new Fn({definition:e.definition})].concat(n,r);this.walk(e,i)}walkAtLeastOneSep(e,n,r){
const i=cE(e,n,r);this.walk(e,i)}walkMany(e,n,r){const i=[new Fn({definition:e.definition})].concat(n,r);this.walk(e,i)}walkManySep(e,n,r){const i=cE(e,n,r);this.walk(e,i)}walkOr(e,n,r){const i=n.concat(r);je(e.definition,s=>{const a=new wr({definition:[s]});this.walk(a,i)})}}function cE(t,e,n){return[new Fn({definition:[new Wt({terminalType:t.separator})].concat(t.definition)})].concat(e,n)}function Uu(t){if(t instanceof sr)return Uu(t.referencedRule);if(t instanceof Wt)return yB(t);if(pB(t))return mB(
t);if(hB(t))return gB(t);throw Error("non exhaustive match")}function mB(t){let e=[];const n=t.definition;let r=0,i=n.length>r,s,a=!0;for(;i&&a;)s=n[r],a=om(s),e=e.concat(Uu(s)),r=r+1,i=n.length>r;return Ib(e)}function gB(t){const e=xe(t.definition,n=>Uu(n));return Ib(ni(e))}function yB(t){return[t.terminalType]}const uE="_~IN~_";class vB extends lm{constructor(e){super(),this.topProd=e,this.follows={}}startWalking(){return this.walk(this.topProd),this.follows}walkTerminal(e,n,r){}walkProdRef(e,n,r){
const i=bB(e.referencedRule,e.idx)+this.topProd.name,s=n.concat(r),a=new wr({definition:s}),o=Uu(a);this.follows[i]=o}}function wB(t){const e={};return je(t,n=>{const r=new vB(n).startWalking();Ar(e,r)}),e}function bB(t,e){return t.name+e+uE}let cm={};const kB=new M0;function um(t){const e=t.toString();if(cm.hasOwnProperty(e))return cm[e];{const n=kB.pattern(e);return cm[e]=n,n}}function _B(){cm={}}const dE="Complement Sets are not supported for first char optimization",dm=`Unable to use "first \
char" lexer optimizations:
`;function RB(t,e=!1){try{const n=um(t);return Db(n.value,{},n.flags.ignoreCase)}catch(n){if(n.message===dE)e&&aE(`${dm}	Unable to optimize: < ${t.toString()} >
	Complement Sets cannot be automatically optimized.
	This will disable the lexer's first char optimizations.
	See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#COMPLEMENT for details.`);else{let r="";e&&(r=`
	This will disable the lexer's first char optimizations.
	See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#REGEXP_PARSING for details.`),Nb(`${dm}
	Failed parsing: < ${t.toString()} >
	Using the @chevrotain/regexp-to-ast library
	Please open an issue at: https://github.com/chevrotain/chevrotain/issues`+r)}}return[]}function Db(t,e,n){switch(t.type){case"Disjunction":for(let i=0;i<t.value.length;i++)Db(t.value[i],e,n);break;case"Alternative":const r=t.value;for(let i=0;i<r.length;i++){const s=r[i];switch(s.type){case"EndAnchor":case"GroupBackReference":case"Lookahead":case"NegativeLookahead":case"StartAnchor":case"WordBoundary":case"NonWordBoundary":continue}const a=s;switch(a.type){case"Character":fm(a.value,e,n);break;case"\
Set":if(a.complement===!0)throw Error(dE);je(a.value,l=>{if(typeof l=="number")fm(l,e,n);else{const c=l;if(n===!0)for(let u=c.from;u<=c.to;u++)fm(u,e,n);else{for(let u=c.from;u<=c.to&&u<Vu;u++)fm(u,e,n);if(c.to>=Vu){const u=c.from>=Vu?c.from:Vu,d=c.to,f=aa(u),p=aa(d);for(let m=f;m<=p;m++)e[m]=m}}}});break;case"Group":Db(a.value,e,n);break;default:throw Error("Non Exhaustive Match")}const o=a.quantifier!==void 0&&a.quantifier.atLeast===0;if(a.type==="Group"&&Ob(a)===!1||a.type!=="Group"&&o===!1)break}
break;default:throw Error("non exhaustive match!")}return $n(e)}function fm(t,e,n){const r=aa(t);e[r]=r,n===!0&&SB(t,e)}function SB(t,e){const n=String.fromCharCode(t),r=n.toUpperCase();if(r!==n){const i=aa(r.charCodeAt(0));e[i]=i}else{const i=n.toLowerCase();if(i!==n){const s=aa(i.charCodeAt(0));e[s]=s}}}function fE(t,e){return Pl(t.value,n=>{if(typeof n=="number")return rr(e,n);{const r=n;return Pl(e,i=>r.from<=i&&i<=r.to)!==void 0}})}function Ob(t){const e=t.quantifier;return e&&e.atLeast===0?
!0:t.value?yt(t.value)?yi(t.value,Ob):Ob(t.value):!1}class $B extends zh{constructor(e){super(),this.targetCharCodes=e,this.found=!1}visitChildren(e){if(this.found!==!0){switch(e.type){case"Lookahead":this.visitLookahead(e);return;case"NegativeLookahead":this.visitNegativeLookahead(e);return}super.visitChildren(e)}}visitCharacter(e){rr(this.targetCharCodes,e.value)&&(this.found=!0)}visitSet(e){e.complement?fE(e,this.targetCharCodes)===void 0&&(this.found=!0):fE(e,this.targetCharCodes)!==void 0&&
(this.found=!0)}}function Lb(t,e){if(e instanceof RegExp){const n=um(e),r=new $B(t);return r.visit(n),r.found}else return Pl(e,n=>rr(t,n.charCodeAt(0)))!==void 0}const no="PATTERN",Hu="defaultMode",pm="modes";let pE=typeof new RegExp("(?:)").sticky=="boolean";function TB(t,e){e=Ab(e,{useSticky:pE,debug:!1,safeMode:!1,positionTracking:"full",lineTerminatorCharacters:["\r",`
`],tracer:(h,y)=>y()});const n=e.tracer;n("initCharCodeToOptimizedIndexMap",()=>{ZB()});let r;n("Reject Lexer.NA",()=>{r=sm(t,h=>h[no]===_r.NA)});let i=!1,s;n("Transform Patterns",()=>{i=!1,s=xe(r,h=>{const y=h[no];if(ws(y)){const b=y.source;return b.length===1&&b!=="^"&&b!=="$"&&b!=="."&&!y.ignoreCase?b:b.length===2&&b[0]==="\\"&&!rr(["d","D","s","S","t","r","n","t","0","c","b","B","f","v","w","W"],b[1])?b[1]:e.useSticky?mE(y):hE(y)}else{if(gs(y))return i=!0,{exec:y};if(typeof y=="object")return i=
!0,y;if(typeof y=="string"){if(y.length===1)return y;{const b=y.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),R=new RegExp(b);return e.useSticky?mE(R):hE(R)}}else throw Error("non exhaustive match")}})});let a,o,l,c,u;n("misc mapping",()=>{a=xe(r,h=>h.tokenTypeIdx),o=xe(r,h=>{const y=h.GROUP;if(y!==_r.SKIPPED){if(vr(y))return y;if(bs(y))return!1;throw Error("non exhaustive match")}}),l=xe(r,h=>{const y=h.LONGER_ALT;if(y)return yt(y)?xe(y,R=>nE(r,R)):[nE(r,y)]}),c=xe(r,h=>h.PUSH_MODE),u=xe(r,h=>qe(h,"POP\
_MODE"))});let d;n("Line Terminator Handling",()=>{const h=vE(e.lineTerminatorCharacters);d=xe(r,y=>!1),e.positionTracking!=="onlyOffset"&&(d=xe(r,y=>qe(y,"LINE_BREAKS")?!!y.LINE_BREAKS:yE(y,h)===!1&&Lb(h,y.PATTERN)))});let f,p,m,w;n("Misc Mapping #2",()=>{f=xe(r,gE),p=xe(s,WB),m=ir(r,(h,y)=>{const b=y.GROUP;return vr(b)&&b!==_r.SKIPPED&&(h[b]=[]),h},{}),w=xe(s,(h,y)=>({pattern:s[y],longerAlt:l[y],canLineTerminator:d[y],isCustom:f[y],short:p[y],group:o[y],push:c[y],pop:u[y],tokenTypeIdx:a[y],tokenType:r[y]}))});
let v=!0,g=[];return e.safeMode||n("First Char Optimization",()=>{g=ir(r,(h,y,b)=>{if(typeof y.PATTERN=="string"){const R=y.PATTERN.charCodeAt(0),T=aa(R);Mb(h,T,w[b])}else if(yt(y.START_CHARS_HINT)){let R;je(y.START_CHARS_HINT,T=>{const N=typeof T=="string"?T.charCodeAt(0):T,q=aa(N);R!==q&&(R=q,Mb(h,q,w[b]))})}else if(ws(y.PATTERN))if(y.PATTERN.unicode)v=!1,e.ensureOptimizations&&Nb(`${dm}	Unable to analyze < ${y.PATTERN.toString()} > pattern.
	The regexp unicode flag is not currently supported by the regexp-to-ast library.
	This will disable the lexer's first char optimizations.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#UNICODE_OPTIMIZE`);else{const R=RB(y.PATTERN,e.ensureOptimizations);Ot(R)&&(v=!1),je(R,T=>{Mb(h,T,w[b])})}else e.ensureOptimizations&&Nb(`${dm}	TokenType: <${y.name}> is using a custom token pattern without providing <start_chars_hint> parameter.
	This will disable the lexer's first char optimizations.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#CUSTOM_OPTIMIZE`),v=!1;return h},[])}),{emptyGroups:m,patternIdxToConfig:w,charCodeToPatternIdxToConfig:g,hasCustom:i,canBeOptimized:v}}function EB(t,e){let n=[];const r=CB(t);n=n.concat(r.errors);const i=xB(r.valid),s=i.valid;return n=n.concat(i.errors),n=n.concat(PB(s)),n=n.concat(jB(s)),n=n.concat(qB(s,e)),n=n.concat(FB(s)),n}function PB(t){let e=[];const n=Ir(t,r=>ws(r[no]));return e=e.concat(IB(n)),e=e.concat(OB(
n)),e=e.concat(LB(n)),e=e.concat(MB(n)),e=e.concat(NB(n)),e}function CB(t){const e=Ir(t,i=>!qe(i,no)),n=xe(e,i=>({message:"Token Type: ->"+i.name+"<- missing static 'PATTERN' property",type:un.MISSING_PATTERN,tokenTypes:[i]})),r=im(t,e);return{errors:n,valid:r}}function xB(t){const e=Ir(t,i=>{const s=i[no];return!ws(s)&&!gs(s)&&!qe(s,"exec")&&!vr(s)}),n=xe(e,i=>({message:"Token Type: ->"+i.name+"<- static 'PATTERN' can only be a RegExp, a Function matching the {CustomPatternMatcherFunc} type or \
an Object matching the {ICustomPattern} interface.",type:un.INVALID_PATTERN,tokenTypes:[i]})),r=im(t,e);return{errors:n,valid:r}}const AB=/[^\\][$]/;function IB(t){class e extends zh{constructor(){super(...arguments),this.found=!1}visitEndAnchor(s){this.found=!0}}const n=Ir(t,i=>{const s=i.PATTERN;try{const a=um(s),o=new e;return o.visit(a),o.found}catch{return AB.test(s.source)}});return xe(n,i=>({message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+i.name+`<- static 'PATTERN' cannot contain end of input anchor '$'
	See chevrotain.io/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:un.EOI_ANCHOR_FOUND,tokenTypes:[i]}))}function NB(t){const e=Ir(t,r=>r.PATTERN.test(""));return xe(e,r=>({message:"Token Type: ->"+r.name+"<- static 'PATTERN' must not match an empty string",type:un.EMPTY_MATCH_PATTERN,tokenTypes:[r]}))}const DB=/[^\\[][\^]|^\^/;function OB(t){class e extends zh{constructor(){super(...arguments),this.found=!1}visitStartAnchor(s){this.found=!0}}const n=Ir(t,i=>{const s=i.PATTERN;
try{const a=um(s),o=new e;return o.visit(a),o.found}catch{return DB.test(s.source)}});return xe(n,i=>({message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+i.name+`<- static 'PATTERN' cannot contain start of input anchor '^'
	See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:un.SOI_ANCHOR_FOUND,tokenTypes:[i]}))}function LB(t){const e=Ir(t,r=>{const i=r[no];return i instanceof RegExp&&(i.multiline||i.global)});return xe(e,r=>({message:"Token Type: ->"+r.name+"<- static 'PATTERN' may NOT contain global('g') or multiline('m')",type:un.UNSUPPORTED_FLAGS_FOUND,tokenTypes:[r]}))}function MB(t){const e=[];let n=xe(t,s=>ir(t,(a,o)=>(s.PATTERN.source===o.PATTERN.source&&!rr(e,o)&&o.
PATTERN!==_r.NA&&(e.push(o),a.push(o)),a),[]));n=Fu(n);const r=Ir(n,s=>s.length>1);return xe(r,s=>{const a=xe(s,l=>l.name);return{message:`The same RegExp pattern ->${vi(s).PATTERN}<-has been used in all of the following Token Types: ${a.join(", ")} <-`,type:un.DUPLICATE_PATTERNS_FOUND,tokenTypes:s}})}function jB(t){const e=Ir(t,r=>{if(!qe(r,"GROUP"))return!1;const i=r.GROUP;return i!==_r.SKIPPED&&i!==_r.NA&&!vr(i)});return xe(e,r=>({message:"Token Type: ->"+r.name+"<- static 'GROUP' can only be\
 Lexer.SKIPPED/Lexer.NA/A String",type:un.INVALID_GROUP_TYPE_FOUND,tokenTypes:[r]}))}function qB(t,e){const n=Ir(t,i=>i.PUSH_MODE!==void 0&&!rr(e,i.PUSH_MODE));return xe(n,i=>({message:`Token Type: ->${i.name}<- static 'PUSH_MODE' value cannot refer to a Lexer Mode ->${i.PUSH_MODE}<-which does not exist`,type:un.PUSH_MODE_DOES_NOT_EXIST,tokenTypes:[i]}))}function FB(t){const e=[],n=ir(t,(r,i,s)=>{const a=i.PATTERN;return a===_r.NA||(vr(a)?r.push({str:a,idx:s,tokenType:i}):ws(a)&&UB(a)&&r.push({str:a.
source,idx:s,tokenType:i})),r},[]);return je(t,(r,i)=>{je(n,({str:s,idx:a,tokenType:o})=>{if(i<a&&zB(s,r.PATTERN)){const l=`Token: ->${o.name}<- can never be matched.
Because it appears AFTER the Token Type ->${r.name}<-in the lexer's definition.
See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#UNREACHABLE`;e.push({message:l,type:un.UNREACHABLE_PATTERN,tokenTypes:[r,o]})}})}),e}function zB(t,e){if(ws(e)){const n=e.exec(t);return n!==null&&n.index===0}else{if(gs(e))return e(t,0,[],{});if(qe(e,"exec"))return e.exec(t,0,[],{});if(typeof e=="string")return e===t;throw Error("non exhaustive match")}}function UB(t){return Pl([".","\\","[","]","|","^","$","(",")","?","*","+","{"],n=>t.source.indexOf(n)!==-1)===void 0}function hE(t){
const e=t.ignoreCase?"i":"";return new RegExp(`^(?:${t.source})`,e)}function mE(t){const e=t.ignoreCase?"iy":"y";return new RegExp(`${t.source}`,e)}function HB(t,e,n){const r=[];return qe(t,Hu)||r.push({message:"A MultiMode Lexer cannot be initialized without a <"+Hu+`> property in its definition
`,type:un.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE}),qe(t,pm)||r.push({message:"A MultiMode Lexer cannot be initialized without a <"+pm+`> property in its definition
`,type:un.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY}),qe(t,pm)&&qe(t,Hu)&&!qe(t.modes,t.defaultMode)&&r.push({message:`A MultiMode Lexer cannot be initialized with a ${Hu}: <${t.defaultMode}>which does not exist
`,type:un.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST}),qe(t,pm)&&je(t.modes,(i,s)=>{je(i,(a,o)=>{if(bs(a))r.push({message:`A Lexer cannot be initialized using an undefined Token Type. Mode:<${s}> at index: <${o}>
`,type:un.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED});else if(qe(a,"LONGER_ALT")){const l=yt(a.LONGER_ALT)?a.LONGER_ALT:[a.LONGER_ALT];je(l,c=>{!bs(c)&&!rr(i,c)&&r.push({message:`A MultiMode Lexer cannot be initialized with a longer_alt <${c.name}> on token <${a.name}> outside of mode <${s}>
`,type:un.MULTI_MODE_LEXER_LONGER_ALT_NOT_IN_CURRENT_MODE})})}})}),r}function VB(t,e,n){const r=[];let i=!1;const s=Fu(ni($n(t.modes))),a=sm(s,l=>l[no]===_r.NA),o=vE(n);return e&&je(a,l=>{const c=yE(l,o);if(c!==!1){const d={message:KB(l,c),type:c.issue,tokenType:l};r.push(d)}else qe(l,"LINE_BREAKS")?l.LINE_BREAKS===!0&&(i=!0):Lb(o,l.PATTERN)&&(i=!0)}),e&&!i&&r.push({message:`Warning: No LINE_BREAKS Found.
	This Lexer has been defined to track line and column information,
	But none of the Token Types can be identified as matching a line terminator.
	See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#LINE_BREAKS 
	for details.`,type:un.NO_LINE_BREAKS_FLAGS}),r}function BB(t){const e={},n=ti(t);return je(n,r=>{const i=t[r];if(yt(i))e[r]=[];else throw Error("non exhaustive match")}),e}function gE(t){const e=t.PATTERN;if(ws(e))return!1;if(gs(e))return!0;if(qe(e,"exec"))return!0;if(vr(e))return!1;throw Error("non exhaustive match")}function WB(t){return vr(t)&&t.length===1?t.charCodeAt(0):!1}const GB={test:function(t){const e=t.length;for(let n=this.lastIndex;n<e;n++){const r=t.charCodeAt(n);if(r===10)return this.
lastIndex=n+1,!0;if(r===13)return t.charCodeAt(n+1)===10?this.lastIndex=n+2:this.lastIndex=n+1,!0}return!1},lastIndex:0};function yE(t,e){if(qe(t,"LINE_BREAKS"))return!1;if(ws(t.PATTERN)){try{Lb(e,t.PATTERN)}catch(n){return{issue:un.IDENTIFY_TERMINATOR,errMsg:n.message}}return!1}else{if(vr(t.PATTERN))return!1;if(gE(t))return{issue:un.CUSTOM_LINE_BREAK};throw Error("non exhaustive match")}}function KB(t,e){if(e.issue===un.IDENTIFY_TERMINATOR)return`Warning: unable to identify line terminator usag\
e in pattern.
	The problem is in the <${t.name}> Token Type
	 Root cause: ${e.errMsg}.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#IDENTIFY_TERMINATOR`;if(e.issue===un.CUSTOM_LINE_BREAK)return`Warning: A Custom Token Pattern should specify the <line_breaks> option.
	The problem is in the <${t.name}> Token Type
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#CUSTOM_LINE_BREAK`;throw Error("non exhaustive match")}function vE(t){return xe(t,n=>vr(n)?n.charCodeAt(0):n)}function Mb(t,e,n){t[e]===void 0?t[e]=[n]:t[e].push(n)}const Vu=256;let hm=[];function aa(t){return t<Vu?t:hm[t]}function ZB(){if(Ot(hm)){hm=new Array(65536);for(let t=0;t<65536;t++)hm[t]=t>255?255+~~(t/255):t}}function Bu(t,e){const n=t.tokenTypeIdx;return n===e.tokenTypeIdx?!0:e.isParent===!0&&e.categoryMatchesMap[n]===
!0}function mm(t,e){return t.tokenTypeIdx===e.tokenTypeIdx}let wE=1;const bE={};function Wu(t){const e=JB(t);YB(e),QB(e),XB(e),je(e,n=>{n.isParent=n.categoryMatches.length>0})}function JB(t){let e=jn(t),n=t,r=!0;for(;r;){n=Fu(ni(xe(n,s=>s.CATEGORIES)));const i=im(n,e);e=e.concat(i),Ot(i)?r=!1:n=i}return e}function YB(t){je(t,e=>{_E(e)||(bE[wE]=e,e.tokenTypeIdx=wE++),RE(e)&&!yt(e.CATEGORIES)&&(e.CATEGORIES=[e.CATEGORIES]),RE(e)||(e.CATEGORIES=[]),eW(e)||(e.categoryMatches=[]),tW(e)||(e.categoryMatchesMap=
{})})}function XB(t){je(t,e=>{e.categoryMatches=[],je(e.categoryMatchesMap,(n,r)=>{e.categoryMatches.push(bE[r].tokenTypeIdx)})})}function QB(t){je(t,e=>{kE([],e)})}function kE(t,e){je(t,n=>{e.categoryMatchesMap[n.tokenTypeIdx]=!0}),je(e.CATEGORIES,n=>{const r=t.concat(e);rr(r,n)||kE(r,n)})}function _E(t){return qe(t,"tokenTypeIdx")}function RE(t){return qe(t,"CATEGORIES")}function eW(t){return qe(t,"categoryMatches")}function tW(t){return qe(t,"categoryMatchesMap")}function nW(t){return qe(t,"t\
okenTypeIdx")}const jb={buildUnableToPopLexerModeMessage(t){return`Unable to pop Lexer Mode after encountering Token ->${t.image}<- The Mode Stack is empty`},buildUnexpectedCharactersMessage(t,e,n,r,i){return`unexpected character: ->${t.charAt(e)}<- at offset: ${e}, skipped ${n} characters.`}};var un;(function(t){t[t.MISSING_PATTERN=0]="MISSING_PATTERN",t[t.INVALID_PATTERN=1]="INVALID_PATTERN",t[t.EOI_ANCHOR_FOUND=2]="EOI_ANCHOR_FOUND",t[t.UNSUPPORTED_FLAGS_FOUND=3]="UNSUPPORTED_FLAGS_FOUND",t[t.
DUPLICATE_PATTERNS_FOUND=4]="DUPLICATE_PATTERNS_FOUND",t[t.INVALID_GROUP_TYPE_FOUND=5]="INVALID_GROUP_TYPE_FOUND",t[t.PUSH_MODE_DOES_NOT_EXIST=6]="PUSH_MODE_DOES_NOT_EXIST",t[t.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE=7]="MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE",t[t.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY=8]="MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY",t[t.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST=9]="MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST",t[t.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED=
10]="LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED",t[t.SOI_ANCHOR_FOUND=11]="SOI_ANCHOR_FOUND",t[t.EMPTY_MATCH_PATTERN=12]="EMPTY_MATCH_PATTERN",t[t.NO_LINE_BREAKS_FLAGS=13]="NO_LINE_BREAKS_FLAGS",t[t.UNREACHABLE_PATTERN=14]="UNREACHABLE_PATTERN",t[t.IDENTIFY_TERMINATOR=15]="IDENTIFY_TERMINATOR",t[t.CUSTOM_LINE_BREAK=16]="CUSTOM_LINE_BREAK",t[t.MULTI_MODE_LEXER_LONGER_ALT_NOT_IN_CURRENT_MODE=17]="MULTI_MODE_LEXER_LONGER_ALT_NOT_IN_CURRENT_MODE"})(un||(un={}));const Gu={deferDefinitionErrorsHandling:!1,
positionTracking:"full",lineTerminatorsPattern:/\n|\r\n?/g,lineTerminatorCharacters:[`
`,"\r"],ensureOptimizations:!1,safeMode:!1,errorMessageProvider:jb,traceInitPerf:!1,skipValidations:!1,recoveryEnabled:!0};Object.freeze(Gu);class _r{constructor(e,n=Gu){if(this.lexerDefinition=e,this.lexerDefinitionErrors=[],this.lexerDefinitionWarning=[],this.patternIdxToConfig={},this.charCodeToPatternIdxToConfig={},this.modes=[],this.emptyGroups={},this.trackStartLines=!0,this.trackEndLines=!0,this.hasCustom=!1,this.canModeBeOptimized={},this.TRACE_INIT=(i,s)=>{if(this.traceInitPerf===!0){this.
traceInitIndent++;const a=new Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(`${a}--> <${i}>`);const{time:o,value:l}=oE(s),c=o>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&c(`${a}<-- <${i}> time: ${o}ms`),this.traceInitIndent--,l}else return s()},typeof n=="boolean")throw Error(`The second argument to the Lexer constructor is now an ILexerConfig Object.
a boolean 2nd argument is no longer supported`);this.config=Ar({},Gu,n);const r=this.config.traceInitPerf;r===!0?(this.traceInitMaxIdent=1/0,this.traceInitPerf=!0):typeof r=="number"&&(this.traceInitMaxIdent=r,this.traceInitPerf=!0),this.traceInitIndent=-1,this.TRACE_INIT("Lexer Constructor",()=>{let i,s=!0;this.TRACE_INIT("Lexer Config handling",()=>{if(this.config.lineTerminatorsPattern===Gu.lineTerminatorsPattern)this.config.lineTerminatorsPattern=GB;else if(this.config.lineTerminatorCharacters===
Gu.lineTerminatorCharacters)throw Error(`Error: Missing <lineTerminatorCharacters> property on the Lexer config.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#MISSING_LINE_TERM_CHARS`);if(n.safeMode&&n.ensureOptimizations)throw Error('"safeMode" and "ensureOptimizations" flags are mutually exclusive.');this.trackStartLines=/full|onlyStart/i.test(this.config.positionTracking),this.trackEndLines=/full/i.test(this.config.positionTracking),yt(e)?i={modes:{defaultMode:jn(e)},defaultMode:Hu}:(s=!1,i=jn(e))}),this.config.skipValidations===!1&&(this.TRACE_INIT("performRuntimeChecks",
()=>{this.lexerDefinitionErrors=this.lexerDefinitionErrors.concat(HB(i,this.trackStartLines,this.config.lineTerminatorCharacters))}),this.TRACE_INIT("performWarningRuntimeChecks",()=>{this.lexerDefinitionWarning=this.lexerDefinitionWarning.concat(VB(i,this.trackStartLines,this.config.lineTerminatorCharacters))})),i.modes=i.modes?i.modes:{},je(i.modes,(o,l)=>{i.modes[l]=sm(o,c=>bs(c))});const a=ti(i.modes);if(je(i.modes,(o,l)=>{this.TRACE_INIT(`Mode: <${l}> processing`,()=>{if(this.modes.push(l),
this.config.skipValidations===!1&&this.TRACE_INIT("validatePatterns",()=>{this.lexerDefinitionErrors=this.lexerDefinitionErrors.concat(EB(o,a))}),Ot(this.lexerDefinitionErrors)){Wu(o);let c;this.TRACE_INIT("analyzeTokenTypes",()=>{c=TB(o,{lineTerminatorCharacters:this.config.lineTerminatorCharacters,positionTracking:n.positionTracking,ensureOptimizations:n.ensureOptimizations,safeMode:n.safeMode,tracer:this.TRACE_INIT})}),this.patternIdxToConfig[l]=c.patternIdxToConfig,this.charCodeToPatternIdxToConfig[l]=
c.charCodeToPatternIdxToConfig,this.emptyGroups=Ar({},this.emptyGroups,c.emptyGroups),this.hasCustom=c.hasCustom||this.hasCustom,this.canModeBeOptimized[l]=c.canBeOptimized}})}),this.defaultMode=i.defaultMode,!Ot(this.lexerDefinitionErrors)&&!this.config.deferDefinitionErrorsHandling){const l=xe(this.lexerDefinitionErrors,c=>c.message).join(`-----------------------
`);throw new Error(`Errors detected in definition of Lexer:
`+l)}je(this.lexerDefinitionWarning,o=>{aE(o.message)}),this.TRACE_INIT("Choosing sub-methods implementations",()=>{if(pE?(this.chopInput=Ya,this.match=this.matchWithTest):(this.updateLastIndex=Sn,this.match=this.matchWithExec),s&&(this.handleModes=Sn),this.trackStartLines===!1&&(this.computeNewColumn=Ya),this.trackEndLines===!1&&(this.updateTokenEndLineColumnLocation=Sn),/full/i.test(this.config.positionTracking))this.createTokenInstance=this.createFullToken;else if(/onlyStart/i.test(this.config.
positionTracking))this.createTokenInstance=this.createStartOnlyToken;else if(/onlyOffset/i.test(this.config.positionTracking))this.createTokenInstance=this.createOffsetOnlyToken;else throw Error(`Invalid <positionTracking> config option: "${this.config.positionTracking}"`);this.hasCustom?(this.addToken=this.addTokenUsingPush,this.handlePayload=this.handlePayloadWithCustom):(this.addToken=this.addTokenUsingMemberAccess,this.handlePayload=this.handlePayloadNoCustom)}),this.TRACE_INIT("Failed Optim\
ization Warnings",()=>{const o=ir(this.canModeBeOptimized,(l,c,u)=>(c===!1&&l.push(u),l),[]);if(n.ensureOptimizations&&!Ot(o))throw Error(`Lexer Modes: < ${o.join(", ")} > cannot be optimized.
	 Disable the "ensureOptimizations" lexer config flag to silently ignore this and run the lexer in an un-optimized mode.
	 Or inspect the console log for details on how to resolve these issues.`)}),this.TRACE_INIT("clearRegExpParserCache",()=>{_B()}),this.TRACE_INIT("toFastProperties",()=>{lE(this)})})}tokenize(e,n=this.defaultMode){if(!Ot(this.lexerDefinitionErrors)){const i=xe(this.lexerDefinitionErrors,s=>s.message).join(`-----------------------
`);throw new Error(`Unable to Tokenize because Errors detected in definition of Lexer:
`+i)}return this.tokenizeInternal(e,n)}tokenizeInternal(e,n){let r,i,s,a,o,l,c,u,d,f,p,m,w,v,g;const h=e,y=h.length;let b=0,R=0;const T=this.hasCustom?0:Math.floor(e.length/10),N=new Array(T),q=[];let B=this.trackStartLines?1:void 0,ie=this.trackStartLines?1:void 0;const L=BB(this.emptyGroups),E=this.trackStartLines,$=this.config.lineTerminatorsPattern;let z=0,j=[],U=[];const W=[],le=[];Object.freeze(le);let ne;function P(){return j}function M(Y){const se=aa(Y),fe=U[se];return fe===void 0?le:fe}
const J=Y=>{if(W.length===1&&Y.tokenType.PUSH_MODE===void 0){const se=this.config.errorMessageProvider.buildUnableToPopLexerModeMessage(Y);q.push({offset:Y.startOffset,line:Y.startLine,column:Y.startColumn,length:Y.image.length,message:se})}else{W.pop();const se=El(W);j=this.patternIdxToConfig[se],U=this.charCodeToPatternIdxToConfig[se],z=j.length;const fe=this.canModeBeOptimized[se]&&this.config.safeMode===!1;U&&fe?ne=M:ne=P}};function G(Y){W.push(Y),U=this.charCodeToPatternIdxToConfig[Y],j=this.
patternIdxToConfig[Y],z=j.length,z=j.length;const se=this.canModeBeOptimized[Y]&&this.config.safeMode===!1;U&&se?ne=M:ne=P}G.call(this,n);let _;const I=this.config.recoveryEnabled;for(;b<y;){l=null;const Y=h.charCodeAt(b),se=ne(Y),fe=se.length;for(r=0;r<fe;r++){_=se[r];const _e=_.pattern;c=null;const pe=_.short;if(pe!==!1?Y===pe&&(l=_e):_.isCustom===!0?(g=_e.exec(h,b,N,L),g!==null?(l=g[0],g.payload!==void 0&&(c=g.payload)):l=null):(this.updateLastIndex(_e,b),l=this.match(_e,e,b)),l!==null){if(o=
_.longerAlt,o!==void 0){const x=o.length;for(s=0;s<x;s++){const O=j[o[s]],K=O.pattern;if(u=null,O.isCustom===!0?(g=K.exec(h,b,N,L),g!==null?(a=g[0],g.payload!==void 0&&(u=g.payload)):a=null):(this.updateLastIndex(K,b),a=this.match(K,e,b)),a&&a.length>l.length){l=a,c=u,_=O;break}}}break}}if(l!==null){if(d=l.length,f=_.group,f!==void 0&&(p=_.tokenTypeIdx,m=this.createTokenInstance(l,b,p,_.tokenType,B,ie,d),this.handlePayload(m,c),f===!1?R=this.addToken(N,R,m):L[f].push(m)),e=this.chopInput(e,d),b=
b+d,ie=this.computeNewColumn(ie,d),E===!0&&_.canLineTerminator===!0){let _e=0,pe,x;$.lastIndex=0;do pe=$.test(l),pe===!0&&(x=$.lastIndex-1,_e++);while(pe===!0);_e!==0&&(B=B+_e,ie=d-x,this.updateTokenEndLineColumnLocation(m,f,x,_e,B,ie,d))}this.handleModes(_,J,G,m)}else{const _e=b,pe=B,x=ie;let O=I===!1;for(;O===!1&&b<y;)for(e=this.chopInput(e,1),b++,i=0;i<z;i++){const K=j[i],F=K.pattern,ae=K.short;if(ae!==!1?h.charCodeAt(b)===ae&&(O=!0):K.isCustom===!0?O=F.exec(h,b,N,L)!==null:(this.updateLastIndex(
F,b),O=F.exec(e)!==null),O===!0)break}if(w=b-_e,ie=this.computeNewColumn(ie,w),v=this.config.errorMessageProvider.buildUnexpectedCharactersMessage(h,_e,w,pe,x),q.push({offset:_e,line:pe,column:x,length:w,message:v}),I===!1)break}}return this.hasCustom||(N.length=R),{tokens:N,groups:L,errors:q}}handleModes(e,n,r,i){if(e.pop===!0){const s=e.push;n(i),s!==void 0&&r.call(this,s)}else e.push!==void 0&&r.call(this,e.push)}chopInput(e,n){return e.substring(n)}updateLastIndex(e,n){e.lastIndex=n}updateTokenEndLineColumnLocation(e,n,r,i,s,a,o){
let l,c;n!==void 0&&(l=r===o-1,c=l?-1:0,i===1&&l===!0||(e.endLine=s+c,e.endColumn=a-1+-c))}computeNewColumn(e,n){return e+n}createOffsetOnlyToken(e,n,r,i){return{image:e,startOffset:n,tokenTypeIdx:r,tokenType:i}}createStartOnlyToken(e,n,r,i,s,a){return{image:e,startOffset:n,startLine:s,startColumn:a,tokenTypeIdx:r,tokenType:i}}createFullToken(e,n,r,i,s,a,o){return{image:e,startOffset:n,endOffset:n+o-1,startLine:s,endLine:s,startColumn:a,endColumn:a+o-1,tokenTypeIdx:r,tokenType:i}}addTokenUsingPush(e,n,r){
return e.push(r),n}addTokenUsingMemberAccess(e,n,r){return e[n]=r,n++,n}handlePayloadNoCustom(e,n){}handlePayloadWithCustom(e,n){n!==null&&(e.payload=n)}matchWithTest(e,n,r){return e.test(n)===!0?n.substring(r,e.lastIndex):null}matchWithExec(e,n){const r=e.exec(n);return r!==null?r[0]:null}}_r.SKIPPED="This marks a skipped Token pattern, this means each token identified by it willbe consumed and then thrown into oblivion, this can be used to for example to completely ignore whitespace.",_r.NA=/NOT_APPLICABLE/;
function Al(t){return SE(t)?t.LABEL:t.name}function SE(t){return vr(t.LABEL)&&t.LABEL!==""}const rW="parent",$E="categories",TE="label",EE="group",PE="push_mode",CE="pop_mode",xE="longer_alt",AE="line_breaks",IE="start_chars_hint";function NE(t){return iW(t)}function iW(t){const e=t.pattern,n={};if(n.name=t.name,bs(e)||(n.PATTERN=e),qe(t,rW))throw`The parent property is no longer supported.
See: https://github.com/chevrotain/chevrotain/issues/564#issuecomment-349062346 for details.`;return qe(t,$E)&&(n.CATEGORIES=t[$E]),Wu([n]),qe(t,TE)&&(n.LABEL=t[TE]),qe(t,EE)&&(n.GROUP=t[EE]),qe(t,CE)&&(n.POP_MODE=t[CE]),qe(t,PE)&&(n.PUSH_MODE=t[PE]),qe(t,xE)&&(n.LONGER_ALT=t[xE]),qe(t,AE)&&(n.LINE_BREAKS=t[AE]),qe(t,IE)&&(n.START_CHARS_HINT=t[IE]),n}const oa=NE({name:"EOF",pattern:_r.NA});Wu([oa]);function qb(t,e,n,r,i,s,a,o){return{image:e,startOffset:n,endOffset:r,startLine:i,endLine:s,startColumn:a,
endColumn:o,tokenTypeIdx:t.tokenTypeIdx,tokenType:t}}function DE(t,e){return Bu(t,e)}const Il={buildMismatchTokenMessage({expected:t,actual:e,previous:n,ruleName:r}){return`Expecting ${SE(t)?`--> ${Al(t)} <--`:`token of type --> ${t.name} <--`} but found --> '${e.image}' <--`},buildNotAllInputParsedMessage({firstRedundant:t,ruleName:e}){return"Redundant input, expecting EOF but found: "+t.image},buildNoViableAltMessage({expectedPathsPerAlt:t,actual:e,previous:n,customUserDescription:r,ruleName:i}){
const s="Expecting: ",o=`
but found: '`+vi(e).image+"'";if(r)return s+r+o;{const l=ir(t,(f,p)=>f.concat(p),[]),c=xe(l,f=>`[${xe(f,p=>Al(p)).join(", ")}]`),d=`one of these possible Token sequences:
${xe(c,(f,p)=>`  ${p+1}. ${f}`).join(`
`)}`;return s+d+o}},buildEarlyExitMessage({expectedIterationPaths:t,actual:e,customUserDescription:n,ruleName:r}){const i="Expecting: ",a=`
but found: '`+vi(e).image+"'";if(n)return i+n+a;{const l=`expecting at least one iteration which starts with one of these possible Token sequences::
  <${xe(t,c=>`[${xe(c,u=>Al(u)).join(",")}]`).join(" ,")}>`;return i+l+a}}};Object.freeze(Il);const sW={buildRuleNotFoundError(t,e){return"Invalid grammar, reference to a rule which is not defined: ->"+e.nonTerminalName+`<-
inside top level rule: ->`+t.name+"<-"}},ro={buildDuplicateFoundError(t,e){function n(u){return u instanceof Wt?u.terminalType.name:u instanceof sr?u.nonTerminalName:""}const r=t.name,i=vi(e),s=i.idx,a=Wi(i),o=n(i),l=s>0;let c=`->${a}${l?s:""}<- ${o?`with argument: ->${o}<-`:""}
                  appears more than once (${e.length} times) in the top level rule: ->${r}<-.                  
                  For further details see: https://chevrotain.io/docs/FAQ.html#NUMERICAL_SUFFIXES 
                  `;return c=c.replace(/[ \t]+/g," "),c=c.replace(/\s\s+/g,`
`),c},buildNamespaceConflictError(t){return`Namespace conflict found in grammar.
The grammar has both a Terminal(Token) and a Non-Terminal(Rule) named: <${t.name}>.
To resolve this make sure each Terminal and Non-Terminal names are unique
This is easy to accomplish by using the convention that Terminal names start with an uppercase letter
and Non-Terminal names start with a lower case letter.`},buildAlternationPrefixAmbiguityError(t){const e=xe(t.prefixPath,i=>Al(i)).join(", "),n=t.alternation.idx===0?"":t.alternation.idx;return`Ambiguous alternatives: <${t.ambiguityIndices.join(" ,")}> due to common lookahead prefix
in <OR${n}> inside <${t.topLevelRule.name}> Rule,
<${e}> may appears as a prefix path in all these alternatives.
See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#COMMON_PREFIX
For Further details.`},buildAlternationAmbiguityError(t){const e=xe(t.prefixPath,i=>Al(i)).join(", "),n=t.alternation.idx===0?"":t.alternation.idx;let r=`Ambiguous Alternatives Detected: <${t.ambiguityIndices.join(" ,")}> in <OR${n}> inside <${t.topLevelRule.name}> Rule,
<${e}> may appears as a prefix path in all these alternatives.
`;return r=r+`See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#AMBIGUOUS_ALTERNATIVES
For Further details.`,r},buildEmptyRepetitionError(t){let e=Wi(t.repetition);return t.repetition.idx!==0&&(e+=t.repetition.idx),`The repetition <${e}> within Rule <${t.topLevelRule.name}> can never consume any tokens.
This could lead to an infinite loop.`},buildTokenNameError(t){return"deprecated"},buildEmptyAlternationError(t){return`Ambiguous empty alternative: <${t.emptyChoiceIdx+1}> in <OR${t.alternation.idx}> inside <${t.topLevelRule.name}> Rule.
Only the last alternative may be an empty alternative.`},buildTooManyAlternativesError(t){return`An Alternation cannot have more than 256 alternatives:
<OR${t.alternation.idx}> inside <${t.topLevelRule.name}> Rule.
 has ${t.alternation.definition.length+1} alternatives.`},buildLeftRecursionError(t){const e=t.topLevelRule.name,n=xe(t.leftRecursionPath,s=>s.name),r=`${e} --> ${n.concat([e]).join(" --> ")}`;return`Left Recursion found in grammar.
rule: <${e}> can be invoked from itself (directly or indirectly)
without consuming any Tokens. The grammar path that causes this is: 
 ${r}
 To fix this refactor your grammar to remove the left recursion.
see: https://en.wikipedia.org/wiki/LL_parser#Left_factoring.`},buildInvalidRuleNameError(t){return"deprecated"},buildDuplicateRuleNameError(t){let e;return t.topLevelRule instanceof Cl?e=t.topLevelRule.name:e=t.topLevelRule,`Duplicate definition, rule: ->${e}<- is already defined in the grammar: ->${t.grammarName}<-`}};function aW(t,e){const n=new oW(t,e);return n.resolveRefs(),n.errors}class oW extends xl{constructor(e,n){super(),this.nameToTopRule=e,this.errMsgProvider=n,this.errors=[]}resolveRefs(){
je($n(this.nameToTopRule),e=>{this.currTopLevel=e,e.accept(this)})}visitNonTerminal(e){const n=this.nameToTopRule[e.nonTerminalName];if(n)e.referencedRule=n;else{const r=this.errMsgProvider.buildRuleNotFoundError(this.currTopLevel,e);this.errors.push({message:r,type:ar.UNRESOLVED_SUBRULE_REF,ruleName:this.currTopLevel.name,unresolvedRefName:e.nonTerminalName})}}}class lW extends lm{constructor(e,n){super(),this.topProd=e,this.path=n,this.possibleTokTypes=[],this.nextProductionName="",this.nextProductionOccurrence=
0,this.found=!1,this.isAtEndOfPath=!1}startWalking(){if(this.found=!1,this.path.ruleStack[0]!==this.topProd.name)throw Error("The path does not start with the walker's top Rule!");return this.ruleStack=jn(this.path.ruleStack).reverse(),this.occurrenceStack=jn(this.path.occurrenceStack).reverse(),this.ruleStack.pop(),this.occurrenceStack.pop(),this.updateExpectedNext(),this.walk(this.topProd),this.possibleTokTypes}walk(e,n=[]){this.found||super.walk(e,n)}walkProdRef(e,n,r){if(e.referencedRule.name===
this.nextProductionName&&e.idx===this.nextProductionOccurrence){const i=n.concat(r);this.updateExpectedNext(),this.walk(e.referencedRule,i)}}updateExpectedNext(){Ot(this.ruleStack)?(this.nextProductionName="",this.nextProductionOccurrence=0,this.isAtEndOfPath=!0):(this.nextProductionName=this.ruleStack.pop(),this.nextProductionOccurrence=this.occurrenceStack.pop())}}class cW extends lW{constructor(e,n){super(e,n),this.path=n,this.nextTerminalName="",this.nextTerminalOccurrence=0,this.nextTerminalName=
this.path.lastTok.name,this.nextTerminalOccurrence=this.path.lastTokOccurrence}walkTerminal(e,n,r){if(this.isAtEndOfPath&&e.terminalType.name===this.nextTerminalName&&e.idx===this.nextTerminalOccurrence&&!this.found){const i=n.concat(r),s=new wr({definition:i});this.possibleTokTypes=Uu(s),this.found=!0}}}class gm extends lm{constructor(e,n){super(),this.topRule=e,this.occurrence=n,this.result={token:void 0,occurrence:void 0,isEndOfRule:void 0}}startWalking(){return this.walk(this.topRule),this.result}}
class uW extends gm{walkMany(e,n,r){if(e.idx===this.occurrence){const i=vi(n.concat(r));this.result.isEndOfRule=i===void 0,i instanceof Wt&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else super.walkMany(e,n,r)}}class OE extends gm{walkManySep(e,n,r){if(e.idx===this.occurrence){const i=vi(n.concat(r));this.result.isEndOfRule=i===void 0,i instanceof Wt&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else super.walkManySep(e,n,r)}}class dW extends gm{walkAtLeastOne(e,n,r){
if(e.idx===this.occurrence){const i=vi(n.concat(r));this.result.isEndOfRule=i===void 0,i instanceof Wt&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else super.walkAtLeastOne(e,n,r)}}class LE extends gm{walkAtLeastOneSep(e,n,r){if(e.idx===this.occurrence){const i=vi(n.concat(r));this.result.isEndOfRule=i===void 0,i instanceof Wt&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else super.walkAtLeastOneSep(e,n,r)}}function Fb(t,e,n=[]){n=jn(n);let r=[],i=0;function s(o){
return o.concat(qn(t,i+1))}function a(o){const l=Fb(s(o),e,n);return r.concat(l)}for(;n.length<e&&i<t.length;){const o=t[i];if(o instanceof wr)return a(o.definition);if(o instanceof sr)return a(o.definition);if(o instanceof Fn)r=a(o.definition);else if(o instanceof Dr){const l=o.definition.concat([new cn({definition:o.definition})]);return a(l)}else if(o instanceof Or){const l=[new wr({definition:o.definition}),new cn({definition:[new Wt({terminalType:o.separator})].concat(o.definition)})];return a(
l)}else if(o instanceof br){const l=o.definition.concat([new cn({definition:[new Wt({terminalType:o.separator})].concat(o.definition)})]);r=a(l)}else if(o instanceof cn){const l=o.definition.concat([new cn({definition:o.definition})]);r=a(l)}else{if(o instanceof kr)return je(o.definition,l=>{Ot(l.definition)===!1&&(r=a(l.definition))}),r;if(o instanceof Wt)n.push(o.terminalType);else throw Error("non exhaustive match")}i++}return r.push({partialPath:n,suffixDef:qn(t,i)}),r}function ME(t,e,n,r){const i="\
EXIT_NONE_TERMINAL",s=[i],a="EXIT_ALTERNATIVE";let o=!1;const l=e.length,c=l-r-1,u=[],d=[];for(d.push({idx:-1,def:t,ruleStack:[],occurrenceStack:[]});!Ot(d);){const f=d.pop();if(f===a){o&&El(d).idx<=c&&d.pop();continue}const p=f.def,m=f.idx,w=f.ruleStack,v=f.occurrenceStack;if(Ot(p))continue;const g=p[0];if(g===i){const h={idx:m,def:qn(p),ruleStack:zu(w),occurrenceStack:zu(v)};d.push(h)}else if(g instanceof Wt)if(m<l-1){const h=m+1,y=e[h];if(n(y,g.terminalType)){const b={idx:h,def:qn(p),ruleStack:w,
occurrenceStack:v};d.push(b)}}else if(m===l-1)u.push({nextTokenType:g.terminalType,nextTokenOccurrence:g.idx,ruleStack:w,occurrenceStack:v}),o=!0;else throw Error("non exhaustive match");else if(g instanceof sr){const h=jn(w);h.push(g.nonTerminalName);const y=jn(v);y.push(g.idx);const b={idx:m,def:g.definition.concat(s,qn(p)),ruleStack:h,occurrenceStack:y};d.push(b)}else if(g instanceof Fn){const h={idx:m,def:qn(p),ruleStack:w,occurrenceStack:v};d.push(h),d.push(a);const y={idx:m,def:g.definition.
concat(qn(p)),ruleStack:w,occurrenceStack:v};d.push(y)}else if(g instanceof Dr){const h=new cn({definition:g.definition,idx:g.idx}),y=g.definition.concat([h],qn(p)),b={idx:m,def:y,ruleStack:w,occurrenceStack:v};d.push(b)}else if(g instanceof Or){const h=new Wt({terminalType:g.separator}),y=new cn({definition:[h].concat(g.definition),idx:g.idx}),b=g.definition.concat([y],qn(p)),R={idx:m,def:b,ruleStack:w,occurrenceStack:v};d.push(R)}else if(g instanceof br){const h={idx:m,def:qn(p),ruleStack:w,occurrenceStack:v};
d.push(h),d.push(a);const y=new Wt({terminalType:g.separator}),b=new cn({definition:[y].concat(g.definition),idx:g.idx}),R=g.definition.concat([b],qn(p)),T={idx:m,def:R,ruleStack:w,occurrenceStack:v};d.push(T)}else if(g instanceof cn){const h={idx:m,def:qn(p),ruleStack:w,occurrenceStack:v};d.push(h),d.push(a);const y=new cn({definition:g.definition,idx:g.idx}),b=g.definition.concat([y],qn(p)),R={idx:m,def:b,ruleStack:w,occurrenceStack:v};d.push(R)}else if(g instanceof kr)for(let h=g.definition.length-
1;h>=0;h--){const y=g.definition[h],b={idx:m,def:y.definition.concat(qn(p)),ruleStack:w,occurrenceStack:v};d.push(b),d.push(a)}else if(g instanceof wr)d.push({idx:m,def:g.definition.concat(qn(p)),ruleStack:w,occurrenceStack:v});else if(g instanceof Cl)d.push(fW(g,m,w,v));else throw Error("non exhaustive match")}return u}function fW(t,e,n,r){const i=jn(n);i.push(t.name);const s=jn(r);return s.push(1),{idx:e,def:t.definition,ruleStack:i,occurrenceStack:s}}var Qt;(function(t){t[t.OPTION=0]="OPTION",
t[t.REPETITION=1]="REPETITION",t[t.REPETITION_MANDATORY=2]="REPETITION_MANDATORY",t[t.REPETITION_MANDATORY_WITH_SEPARATOR=3]="REPETITION_MANDATORY_WITH_SEPARATOR",t[t.REPETITION_WITH_SEPARATOR=4]="REPETITION_WITH_SEPARATOR",t[t.ALTERNATION=5]="ALTERNATION"})(Qt||(Qt={}));function zb(t){if(t instanceof Fn||t==="Option")return Qt.OPTION;if(t instanceof cn||t==="Repetition")return Qt.REPETITION;if(t instanceof Dr||t==="RepetitionMandatory")return Qt.REPETITION_MANDATORY;if(t instanceof Or||t==="Rep\
etitionMandatoryWithSeparator")return Qt.REPETITION_MANDATORY_WITH_SEPARATOR;if(t instanceof br||t==="RepetitionWithSeparator")return Qt.REPETITION_WITH_SEPARATOR;if(t instanceof kr||t==="Alternation")return Qt.ALTERNATION;throw Error("non exhaustive match")}function jE(t){const{occurrence:e,rule:n,prodType:r,maxLookahead:i}=t,s=zb(r);return s===Qt.ALTERNATION?ym(e,n,i):vm(e,n,s,i)}function pW(t,e,n,r,i,s){const a=ym(t,e,n),o=UE(a)?mm:Bu;return s(a,r,o,i)}function hW(t,e,n,r,i,s){const a=vm(t,e,
i,n),o=UE(a)?mm:Bu;return s(a[0],o,r)}function mW(t,e,n,r){const i=t.length,s=yi(t,a=>yi(a,o=>o.length===1));if(e)return function(a){const o=xe(a,l=>l.GATE);for(let l=0;l<i;l++){const c=t[l],u=c.length,d=o[l];if(!(d!==void 0&&d.call(this)===!1))e:for(let f=0;f<u;f++){const p=c[f],m=p.length;for(let w=0;w<m;w++){const v=this.LA(w+1);if(n(v,p[w])===!1)continue e}return l}}};if(s&&!r){const a=xe(t,l=>ni(l)),o=ir(a,(l,c,u)=>(je(c,d=>{qe(l,d.tokenTypeIdx)||(l[d.tokenTypeIdx]=u),je(d.categoryMatches,f=>{
qe(l,f)||(l[f]=u)})}),l),{});return function(){const l=this.LA(1);return o[l.tokenTypeIdx]}}else return function(){for(let a=0;a<i;a++){const o=t[a],l=o.length;e:for(let c=0;c<l;c++){const u=o[c],d=u.length;for(let f=0;f<d;f++){const p=this.LA(f+1);if(n(p,u[f])===!1)continue e}return a}}}}function gW(t,e,n){const r=yi(t,s=>s.length===1),i=t.length;if(r&&!n){const s=ni(t);if(s.length===1&&Ot(s[0].categoryMatches)){const o=s[0].tokenTypeIdx;return function(){return this.LA(1).tokenTypeIdx===o}}else{
const a=ir(s,(o,l,c)=>(o[l.tokenTypeIdx]=!0,je(l.categoryMatches,u=>{o[u]=!0}),o),[]);return function(){const o=this.LA(1);return a[o.tokenTypeIdx]===!0}}}else return function(){e:for(let s=0;s<i;s++){const a=t[s],o=a.length;for(let l=0;l<o;l++){const c=this.LA(l+1);if(e(c,a[l])===!1)continue e}return!0}return!1}}class yW extends lm{constructor(e,n,r){super(),this.topProd=e,this.targetOccurrence=n,this.targetProdType=r}startWalking(){return this.walk(this.topProd),this.restDef}checkIsTarget(e,n,r,i){
return e.idx===this.targetOccurrence&&this.targetProdType===n?(this.restDef=r.concat(i),!0):!1}walkOption(e,n,r){this.checkIsTarget(e,Qt.OPTION,n,r)||super.walkOption(e,n,r)}walkAtLeastOne(e,n,r){this.checkIsTarget(e,Qt.REPETITION_MANDATORY,n,r)||super.walkOption(e,n,r)}walkAtLeastOneSep(e,n,r){this.checkIsTarget(e,Qt.REPETITION_MANDATORY_WITH_SEPARATOR,n,r)||super.walkOption(e,n,r)}walkMany(e,n,r){this.checkIsTarget(e,Qt.REPETITION,n,r)||super.walkOption(e,n,r)}walkManySep(e,n,r){this.checkIsTarget(
e,Qt.REPETITION_WITH_SEPARATOR,n,r)||super.walkOption(e,n,r)}}class qE extends xl{constructor(e,n,r){super(),this.targetOccurrence=e,this.targetProdType=n,this.targetRef=r,this.result=[]}checkIsTarget(e,n){e.idx===this.targetOccurrence&&this.targetProdType===n&&(this.targetRef===void 0||e===this.targetRef)&&(this.result=e.definition)}visitOption(e){this.checkIsTarget(e,Qt.OPTION)}visitRepetition(e){this.checkIsTarget(e,Qt.REPETITION)}visitRepetitionMandatory(e){this.checkIsTarget(e,Qt.REPETITION_MANDATORY)}visitRepetitionMandatoryWithSeparator(e){
this.checkIsTarget(e,Qt.REPETITION_MANDATORY_WITH_SEPARATOR)}visitRepetitionWithSeparator(e){this.checkIsTarget(e,Qt.REPETITION_WITH_SEPARATOR)}visitAlternation(e){this.checkIsTarget(e,Qt.ALTERNATION)}}function FE(t){const e=new Array(t);for(let n=0;n<t;n++)e[n]=[];return e}function Ub(t){let e=[""];for(let n=0;n<t.length;n++){const r=t[n],i=[];for(let s=0;s<e.length;s++){const a=e[s];i.push(a+"_"+r.tokenTypeIdx);for(let o=0;o<r.categoryMatches.length;o++){const l="_"+r.categoryMatches[o];i.push(
a+l)}}e=i}return e}function vW(t,e,n){for(let r=0;r<t.length;r++){if(r===n)continue;const i=t[r];for(let s=0;s<e.length;s++){const a=e[s];if(i[a]===!0)return!1}}return!0}function zE(t,e){const n=xe(t,a=>Fb([a],1)),r=FE(n.length),i=xe(n,a=>{const o={};return je(a,l=>{const c=Ub(l.partialPath);je(c,u=>{o[u]=!0})}),o});let s=n;for(let a=1;a<=e;a++){const o=s;s=FE(o.length);for(let l=0;l<o.length;l++){const c=o[l];for(let u=0;u<c.length;u++){const d=c[u].partialPath,f=c[u].suffixDef,p=Ub(d);if(vW(i,
p,l)||Ot(f)||d.length===e){const w=r[l];if(Hb(w,d)===!1){w.push(d);for(let v=0;v<p.length;v++){const g=p[v];i[l][g]=!0}}}else{const w=Fb(f,a+1,d);s[l]=s[l].concat(w),je(w,v=>{const g=Ub(v.partialPath);je(g,h=>{i[l][h]=!0})})}}}}return r}function ym(t,e,n,r){const i=new qE(t,Qt.ALTERNATION,r);return e.accept(i),zE(i.result,n)}function vm(t,e,n,r){const i=new qE(t,n);e.accept(i);const s=i.result,o=new yW(e,t,n).startWalking(),l=new wr({definition:s}),c=new wr({definition:o});return zE([l,c],r)}function Hb(t,e){
e:for(let n=0;n<t.length;n++){const r=t[n];if(r.length===e.length){for(let i=0;i<r.length;i++){const s=e[i],a=r[i];if((s===a||a.categoryMatchesMap[s.tokenTypeIdx]!==void 0)===!1)continue e}return!0}}return!1}function wW(t,e){return t.length<e.length&&yi(t,(n,r)=>{const i=e[r];return n===i||i.categoryMatchesMap[n.tokenTypeIdx]})}function UE(t){return yi(t,e=>yi(e,n=>yi(n,r=>Ot(r.categoryMatches))))}function bW(t){const e=t.lookaheadStrategy.validate({rules:t.rules,tokenTypes:t.tokenTypes,grammarName:t.
grammarName});return xe(e,n=>Object.assign({type:ar.CUSTOM_LOOKAHEAD_VALIDATION},n))}function kW(t,e,n,r){const i=Nr(t,l=>_W(l,n)),s=DW(t,e,n),a=Nr(t,l=>xW(l,n)),o=Nr(t,l=>$W(l,t,r,n));return i.concat(s,a,o)}function _W(t,e){const n=new SW;t.accept(n);const r=n.allProductions,i=jV(r,RW),s=wi(i,o=>o.length>1);return xe($n(s),o=>{const l=vi(o),c=e.buildDuplicateFoundError(t,o),u=Wi(l),d={message:c,type:ar.DUPLICATE_PRODUCTIONS,ruleName:t.name,dslName:u,occurrence:l.idx},f=HE(l);return f&&(d.parameter=
f),d})}function RW(t){return`${Wi(t)}_#_${t.idx}_#_${HE(t)}`}function HE(t){return t instanceof Wt?t.terminalType.name:t instanceof sr?t.nonTerminalName:""}class SW extends xl{constructor(){super(...arguments),this.allProductions=[]}visitNonTerminal(e){this.allProductions.push(e)}visitOption(e){this.allProductions.push(e)}visitRepetitionWithSeparator(e){this.allProductions.push(e)}visitRepetitionMandatory(e){this.allProductions.push(e)}visitRepetitionMandatoryWithSeparator(e){this.allProductions.
push(e)}visitRepetition(e){this.allProductions.push(e)}visitAlternation(e){this.allProductions.push(e)}visitTerminal(e){this.allProductions.push(e)}}function $W(t,e,n,r){const i=[];if(ir(e,(a,o)=>o.name===t.name?a+1:a,0)>1){const a=r.buildDuplicateRuleNameError({topLevelRule:t,grammarName:n});i.push({message:a,type:ar.DUPLICATE_RULE_NAME,ruleName:t.name})}return i}function TW(t,e,n){const r=[];let i;return rr(e,t)||(i=`Invalid rule override, rule: ->${t}<- cannot be overridden in the grammar: ->${n}\
<-as it is not defined in any of the super grammars `,r.push({message:i,type:ar.INVALID_RULE_OVERRIDE,ruleName:t})),r}function VE(t,e,n,r=[]){const i=[],s=wm(e.definition);if(Ot(s))return[];{const a=t.name;rr(s,t)&&i.push({message:n.buildLeftRecursionError({topLevelRule:t,leftRecursionPath:r}),type:ar.LEFT_RECURSION,ruleName:a});const l=im(s,r.concat([t])),c=Nr(l,u=>{const d=jn(r);return d.push(u),VE(t,u,n,d)});return i.concat(c)}}function wm(t){let e=[];if(Ot(t))return e;const n=vi(t);if(n instanceof
sr)e.push(n.referencedRule);else if(n instanceof wr||n instanceof Fn||n instanceof Dr||n instanceof Or||n instanceof br||n instanceof cn)e=e.concat(wm(n.definition));else if(n instanceof kr)e=ni(xe(n.definition,s=>wm(s.definition)));else if(!(n instanceof Wt))throw Error("non exhaustive match");const r=om(n),i=t.length>1;if(r&&i){const s=qn(t);return e.concat(wm(s))}else return e}class Vb extends xl{constructor(){super(...arguments),this.alternations=[]}visitAlternation(e){this.alternations.push(
e)}}function EW(t,e){const n=new Vb;t.accept(n);const r=n.alternations;return Nr(r,s=>{const a=zu(s.definition);return Nr(a,(o,l)=>{const c=ME([o],[],Bu,1);return Ot(c)?[{message:e.buildEmptyAlternationError({topLevelRule:t,alternation:s,emptyChoiceIdx:l}),type:ar.NONE_LAST_EMPTY_ALT,ruleName:t.name,occurrence:s.idx,alternative:l+1}]:[]})})}function PW(t,e,n){const r=new Vb;t.accept(r);let i=r.alternations;return i=sm(i,a=>a.ignoreAmbiguities===!0),Nr(i,a=>{const o=a.idx,l=a.maxLookahead||e,c=ym(
o,t,l,a),u=IW(c,a,t,n),d=NW(c,a,t,n);return u.concat(d)})}class CW extends xl{constructor(){super(...arguments),this.allProductions=[]}visitRepetitionWithSeparator(e){this.allProductions.push(e)}visitRepetitionMandatory(e){this.allProductions.push(e)}visitRepetitionMandatoryWithSeparator(e){this.allProductions.push(e)}visitRepetition(e){this.allProductions.push(e)}}function xW(t,e){const n=new Vb;t.accept(n);const r=n.alternations;return Nr(r,s=>s.definition.length>255?[{message:e.buildTooManyAlternativesError(
{topLevelRule:t,alternation:s}),type:ar.TOO_MANY_ALTS,ruleName:t.name,occurrence:s.idx}]:[])}function AW(t,e,n){const r=[];return je(t,i=>{const s=new CW;i.accept(s);const a=s.allProductions;je(a,o=>{const l=zb(o),c=o.maxLookahead||e,u=o.idx,f=vm(u,i,l,c)[0];if(Ot(ni(f))){const p=n.buildEmptyRepetitionError({topLevelRule:i,repetition:o});r.push({message:p,type:ar.NO_NON_EMPTY_LOOKAHEAD,ruleName:i.name})}})}),r}function IW(t,e,n,r){const i=[],s=ir(t,(o,l,c)=>(e.definition[c].ignoreAmbiguities===!0||
je(l,u=>{const d=[c];je(t,(f,p)=>{c!==p&&Hb(f,u)&&e.definition[p].ignoreAmbiguities!==!0&&d.push(p)}),d.length>1&&!Hb(i,u)&&(i.push(u),o.push({alts:d,path:u}))}),o),[]);return xe(s,o=>{const l=xe(o.alts,u=>u+1);return{message:r.buildAlternationAmbiguityError({topLevelRule:n,alternation:e,ambiguityIndices:l,prefixPath:o.path}),type:ar.AMBIGUOUS_ALTS,ruleName:n.name,occurrence:e.idx,alternatives:o.alts}})}function NW(t,e,n,r){const i=ir(t,(a,o,l)=>{const c=xe(o,u=>({idx:l,path:u}));return a.concat(
c)},[]);return Fu(Nr(i,a=>{if(e.definition[a.idx].ignoreAmbiguities===!0)return[];const l=a.idx,c=a.path,u=Ir(i,f=>e.definition[f.idx].ignoreAmbiguities!==!0&&f.idx<l&&wW(f.path,c));return xe(u,f=>{const p=[f.idx+1,l+1],m=e.idx===0?"":e.idx;return{message:r.buildAlternationPrefixAmbiguityError({topLevelRule:n,alternation:e,ambiguityIndices:p,prefixPath:f.path}),type:ar.AMBIGUOUS_PREFIX_ALTS,ruleName:n.name,occurrence:m,alternatives:p}})}))}function DW(t,e,n){const r=[],i=xe(e,s=>s.name);return je(
t,s=>{const a=s.name;if(rr(i,a)){const o=n.buildNamespaceConflictError(s);r.push({message:o,type:ar.CONFLICT_TOKENS_RULES_NAMESPACE,ruleName:a})}}),r}function OW(t){const e=Ab(t,{errMsgProvider:sW}),n={};return je(t.rules,r=>{n[r.name]=r}),aW(n,e.errMsgProvider)}function LW(t){return t=Ab(t,{errMsgProvider:ro}),kW(t.rules,t.tokenTypes,t.errMsgProvider,t.grammarName)}const BE="MismatchedTokenException",WE="NoViableAltException",GE="EarlyExitException",KE="NotAllInputParsedException",ZE=[BE,WE,GE,
KE];Object.freeze(ZE);function bm(t){return rr(ZE,t.name)}class km extends Error{constructor(e,n){super(e),this.token=n,this.resyncedTokens=[],Object.setPrototypeOf(this,new.target.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}}class JE extends km{constructor(e,n,r){super(e,n),this.previousToken=r,this.name=BE}}class MW extends km{constructor(e,n,r){super(e,n),this.previousToken=r,this.name=WE}}class jW extends km{constructor(e,n){super(e,n),this.name=KE}}class qW extends km{constructor(e,n,r){
super(e,n),this.previousToken=r,this.name=GE}}const Bb={},YE="InRuleRecoveryException";class FW extends Error{constructor(e){super(e),this.name=YE}}class zW{initRecoverable(e){this.firstAfterRepMap={},this.resyncFollows={},this.recoveryEnabled=qe(e,"recoveryEnabled")?e.recoveryEnabled:ks.recoveryEnabled,this.recoveryEnabled&&(this.attemptInRepetitionRecovery=UW)}getTokenToInsert(e){const n=qb(e,"",NaN,NaN,NaN,NaN,NaN,NaN);return n.isInsertedInRecovery=!0,n}canTokenTypeBeInsertedInRecovery(e){return!0}canTokenTypeBeDeletedInRecovery(e){
return!0}tryInRepetitionRecovery(e,n,r,i){const s=this.findReSyncTokenType(),a=this.exportLexerState(),o=[];let l=!1;const c=this.LA(1);let u=this.LA(1);const d=()=>{const f=this.LA(0),p=this.errorMessageProvider.buildMismatchTokenMessage({expected:i,actual:c,previous:f,ruleName:this.getCurrRuleFullName()}),m=new JE(p,c,this.LA(0));m.resyncedTokens=zu(o),this.SAVE_ERROR(m)};for(;!l;)if(this.tokenMatcher(u,i)){d();return}else if(r.call(this)){d(),e.apply(this,n);return}else this.tokenMatcher(u,s)?
l=!0:(u=this.SKIP_TOKEN(),this.addToResyncTokens(u,o));this.importLexerState(a)}shouldInRepetitionRecoveryBeTried(e,n,r){return!(r===!1||this.tokenMatcher(this.LA(1),e)||this.isBackTracking()||this.canPerformInRuleRecovery(e,this.getFollowsForInRuleRecovery(e,n)))}getFollowsForInRuleRecovery(e,n){const r=this.getCurrentGrammarPath(e,n);return this.getNextPossibleTokenTypes(r)}tryInRuleRecovery(e,n){if(this.canRecoverWithSingleTokenInsertion(e,n))return this.getTokenToInsert(e);if(this.canRecoverWithSingleTokenDeletion(
e)){const r=this.SKIP_TOKEN();return this.consumeToken(),r}throw new FW("sad sad panda")}canPerformInRuleRecovery(e,n){return this.canRecoverWithSingleTokenInsertion(e,n)||this.canRecoverWithSingleTokenDeletion(e)}canRecoverWithSingleTokenInsertion(e,n){if(!this.canTokenTypeBeInsertedInRecovery(e)||Ot(n))return!1;const r=this.LA(1);return Pl(n,s=>this.tokenMatcher(r,s))!==void 0}canRecoverWithSingleTokenDeletion(e){return this.canTokenTypeBeDeletedInRecovery(e)?this.tokenMatcher(this.LA(2),e):!1}isInCurrentRuleReSyncSet(e){
const n=this.getCurrFollowKey(),r=this.getFollowSetFromFollowKey(n);return rr(r,e)}findReSyncTokenType(){const e=this.flattenFollowSet();let n=this.LA(1),r=2;for(;;){const i=Pl(e,s=>DE(n,s));if(i!==void 0)return i;n=this.LA(r),r++}}getCurrFollowKey(){if(this.RULE_STACK.length===1)return Bb;const e=this.getLastExplicitRuleShortName(),n=this.getLastExplicitRuleOccurrenceIndex(),r=this.getPreviousExplicitRuleShortName();return{ruleName:this.shortRuleNameToFullName(e),idxInCallingRule:n,inRule:this.
shortRuleNameToFullName(r)}}buildFullFollowKeyStack(){const e=this.RULE_STACK,n=this.RULE_OCCURRENCE_STACK;return xe(e,(r,i)=>i===0?Bb:{ruleName:this.shortRuleNameToFullName(r),idxInCallingRule:n[i],inRule:this.shortRuleNameToFullName(e[i-1])})}flattenFollowSet(){const e=xe(this.buildFullFollowKeyStack(),n=>this.getFollowSetFromFollowKey(n));return ni(e)}getFollowSetFromFollowKey(e){if(e===Bb)return[oa];const n=e.ruleName+e.idxInCallingRule+uE+e.inRule;return this.resyncFollows[n]}addToResyncTokens(e,n){
return this.tokenMatcher(e,oa)||n.push(e),n}reSyncTo(e){const n=[];let r=this.LA(1);for(;this.tokenMatcher(r,e)===!1;)r=this.SKIP_TOKEN(),this.addToResyncTokens(r,n);return zu(n)}attemptInRepetitionRecovery(e,n,r,i,s,a,o){}getCurrentGrammarPath(e,n){const r=this.getHumanReadableRuleStack(),i=jn(this.RULE_OCCURRENCE_STACK);return{ruleStack:r,occurrenceStack:i,lastTok:e,lastTokOccurrence:n}}getHumanReadableRuleStack(){return xe(this.RULE_STACK,e=>this.shortRuleNameToFullName(e))}}function UW(t,e,n,r,i,s,a){
const o=this.getKeyForAutomaticLookahead(r,i);let l=this.firstAfterRepMap[o];if(l===void 0){const f=this.getCurrRuleFullName(),p=this.getGAstProductions()[f];l=new s(p,i).startWalking(),this.firstAfterRepMap[o]=l}let c=l.token,u=l.occurrence;const d=l.isEndOfRule;this.RULE_STACK.length===1&&d&&c===void 0&&(c=oa,u=1),!(c===void 0||u===void 0)&&this.shouldInRepetitionRecoveryBeTried(c,u,a)&&this.tryInRepetitionRecovery(t,e,n,c)}const HW=4,la=8,XE=1<<la,QE=2<<la,Wb=3<<la,Gb=4<<la,Kb=5<<la,_m=6<<la;
function Zb(t,e,n){return n|e|t}class Jb{constructor(e){var n;this.maxLookahead=(n=e?.maxLookahead)!==null&&n!==void 0?n:ks.maxLookahead}validate(e){const n=this.validateNoLeftRecursion(e.rules);if(Ot(n)){const r=this.validateEmptyOrAlternatives(e.rules),i=this.validateAmbiguousAlternationAlternatives(e.rules,this.maxLookahead),s=this.validateSomeNonEmptyLookaheadPath(e.rules,this.maxLookahead);return[...n,...r,...i,...s]}return n}validateNoLeftRecursion(e){return Nr(e,n=>VE(n,n,ro))}validateEmptyOrAlternatives(e){
return Nr(e,n=>EW(n,ro))}validateAmbiguousAlternationAlternatives(e,n){return Nr(e,r=>PW(r,n,ro))}validateSomeNonEmptyLookaheadPath(e,n){return AW(e,n,ro)}buildLookaheadForAlternation(e){return pW(e.prodOccurrence,e.rule,e.maxLookahead,e.hasPredicates,e.dynamicTokensEnabled,mW)}buildLookaheadForOptional(e){return hW(e.prodOccurrence,e.rule,e.maxLookahead,e.dynamicTokensEnabled,zb(e.prodType),gW)}}class VW{initLooksAhead(e){this.dynamicTokensEnabled=qe(e,"dynamicTokensEnabled")?e.dynamicTokensEnabled:
ks.dynamicTokensEnabled,this.maxLookahead=qe(e,"maxLookahead")?e.maxLookahead:ks.maxLookahead,this.lookaheadStrategy=qe(e,"lookaheadStrategy")?e.lookaheadStrategy:new Jb({maxLookahead:this.maxLookahead}),this.lookAheadFuncsCache=new Map}preComputeLookaheadFunctions(e){je(e,n=>{this.TRACE_INIT(`${n.name} Rule Lookahead`,()=>{const{alternation:r,repetition:i,option:s,repetitionMandatory:a,repetitionMandatoryWithSeparator:o,repetitionWithSeparator:l}=WW(n);je(r,c=>{const u=c.idx===0?"":c.idx;this.TRACE_INIT(
`${Wi(c)}${u}`,()=>{const d=this.lookaheadStrategy.buildLookaheadForAlternation({prodOccurrence:c.idx,rule:n,maxLookahead:c.maxLookahead||this.maxLookahead,hasPredicates:c.hasPredicates,dynamicTokensEnabled:this.dynamicTokensEnabled}),f=Zb(this.fullRuleNameToShort[n.name],XE,c.idx);this.setLaFuncCache(f,d)})}),je(i,c=>{this.computeLookaheadFunc(n,c.idx,Wb,"Repetition",c.maxLookahead,Wi(c))}),je(s,c=>{this.computeLookaheadFunc(n,c.idx,QE,"Option",c.maxLookahead,Wi(c))}),je(a,c=>{this.computeLookaheadFunc(
n,c.idx,Gb,"RepetitionMandatory",c.maxLookahead,Wi(c))}),je(o,c=>{this.computeLookaheadFunc(n,c.idx,_m,"RepetitionMandatoryWithSeparator",c.maxLookahead,Wi(c))}),je(l,c=>{this.computeLookaheadFunc(n,c.idx,Kb,"RepetitionWithSeparator",c.maxLookahead,Wi(c))})})})}computeLookaheadFunc(e,n,r,i,s,a){this.TRACE_INIT(`${a}${n===0?"":n}`,()=>{const o=this.lookaheadStrategy.buildLookaheadForOptional({prodOccurrence:n,rule:e,maxLookahead:s||this.maxLookahead,dynamicTokensEnabled:this.dynamicTokensEnabled,
prodType:i}),l=Zb(this.fullRuleNameToShort[e.name],r,n);this.setLaFuncCache(l,o)})}getKeyForAutomaticLookahead(e,n){const r=this.getLastExplicitRuleShortName();return Zb(r,e,n)}getLaFuncFromCache(e){return this.lookAheadFuncsCache.get(e)}setLaFuncCache(e,n){this.lookAheadFuncsCache.set(e,n)}}class BW extends xl{constructor(){super(...arguments),this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}}reset(){this.
dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}}visitOption(e){this.dslMethods.option.push(e)}visitRepetitionWithSeparator(e){this.dslMethods.repetitionWithSeparator.push(e)}visitRepetitionMandatory(e){this.dslMethods.repetitionMandatory.push(e)}visitRepetitionMandatoryWithSeparator(e){this.dslMethods.repetitionMandatoryWithSeparator.push(e)}visitRepetition(e){this.dslMethods.repetition.push(e)}visitAlternation(e){
this.dslMethods.alternation.push(e)}}const Rm=new BW;function WW(t){Rm.reset(),t.accept(Rm);const e=Rm.dslMethods;return Rm.reset(),e}function eP(t,e){isNaN(t.startOffset)===!0?(t.startOffset=e.startOffset,t.endOffset=e.endOffset):t.endOffset<e.endOffset&&(t.endOffset=e.endOffset)}function tP(t,e){isNaN(t.startOffset)===!0?(t.startOffset=e.startOffset,t.startColumn=e.startColumn,t.startLine=e.startLine,t.endOffset=e.endOffset,t.endColumn=e.endColumn,t.endLine=e.endLine):t.endOffset<e.endOffset&&
(t.endOffset=e.endOffset,t.endColumn=e.endColumn,t.endLine=e.endLine)}function GW(t,e,n){t.children[n]===void 0?t.children[n]=[e]:t.children[n].push(e)}function KW(t,e,n){t.children[e]===void 0?t.children[e]=[n]:t.children[e].push(n)}const ZW="name";function nP(t,e){Object.defineProperty(t,ZW,{enumerable:!1,configurable:!0,writable:!1,value:e})}function JW(t,e){const n=ti(t),r=n.length;for(let i=0;i<r;i++){const s=n[i],a=t[s],o=a.length;for(let l=0;l<o;l++){const c=a[l];c.tokenTypeIdx===void 0&&
this[c.name](c.children,e)}}}function YW(t,e){const n=function(){};nP(n,t+"BaseSemantics");const r={visit:function(i,s){if(yt(i)&&(i=i[0]),!bs(i))return this[i.name](i.children,s)},validateVisitor:function(){const i=QW(this,e);if(!Ot(i)){const s=xe(i,a=>a.msg);throw Error(`Errors Detected in CST Visitor <${this.constructor.name}>:
	${s.join(`

`).replace(/\n/g,`
	`)}`)}}};return n.prototype=r,n.prototype.constructor=n,n._RULE_NAMES=e,n}function XW(t,e,n){const r=function(){};nP(r,t+"BaseSemanticsWithDefaults");const i=Object.create(n.prototype);return je(e,s=>{i[s]=JW}),r.prototype=i,r.prototype.constructor=r,r}var Yb;(function(t){t[t.REDUNDANT_METHOD=0]="REDUNDANT_METHOD",t[t.MISSING_METHOD=1]="MISSING_METHOD"})(Yb||(Yb={}));function QW(t,e){return eG(t,e)}function eG(t,e){const n=Ir(e,i=>gs(t[i])===!1),r=xe(n,i=>({msg:`Missing visitor method: <${i}> o\
n ${t.constructor.name} CST Visitor.`,type:Yb.MISSING_METHOD,methodName:i}));return Fu(r)}class tG{initTreeBuilder(e){if(this.CST_STACK=[],this.outputCst=e.outputCst,this.nodeLocationTracking=qe(e,"nodeLocationTracking")?e.nodeLocationTracking:ks.nodeLocationTracking,!this.outputCst)this.cstInvocationStateUpdate=Sn,this.cstFinallyStateUpdate=Sn,this.cstPostTerminal=Sn,this.cstPostNonTerminal=Sn,this.cstPostRule=Sn;else if(/full/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=
tP,this.setNodeLocationFromNode=tP,this.cstPostRule=Sn,this.setInitialNodeLocation=this.setInitialNodeLocationFullRecovery):(this.setNodeLocationFromToken=Sn,this.setNodeLocationFromNode=Sn,this.cstPostRule=this.cstPostRuleFull,this.setInitialNodeLocation=this.setInitialNodeLocationFullRegular);else if(/onlyOffset/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=eP,this.setNodeLocationFromNode=eP,this.cstPostRule=Sn,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRecovery):
(this.setNodeLocationFromToken=Sn,this.setNodeLocationFromNode=Sn,this.cstPostRule=this.cstPostRuleOnlyOffset,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRegular);else if(/none/i.test(this.nodeLocationTracking))this.setNodeLocationFromToken=Sn,this.setNodeLocationFromNode=Sn,this.cstPostRule=Sn,this.setInitialNodeLocation=Sn;else throw Error(`Invalid <nodeLocationTracking> config option: "${e.nodeLocationTracking}"`)}setInitialNodeLocationOnlyOffsetRecovery(e){e.location={startOffset:NaN,
endOffset:NaN}}setInitialNodeLocationOnlyOffsetRegular(e){e.location={startOffset:this.LA(1).startOffset,endOffset:NaN}}setInitialNodeLocationFullRecovery(e){e.location={startOffset:NaN,startLine:NaN,startColumn:NaN,endOffset:NaN,endLine:NaN,endColumn:NaN}}setInitialNodeLocationFullRegular(e){const n=this.LA(1);e.location={startOffset:n.startOffset,startLine:n.startLine,startColumn:n.startColumn,endOffset:NaN,endLine:NaN,endColumn:NaN}}cstInvocationStateUpdate(e){const n={name:e,children:Object.
create(null)};this.setInitialNodeLocation(n),this.CST_STACK.push(n)}cstFinallyStateUpdate(){this.CST_STACK.pop()}cstPostRuleFull(e){const n=this.LA(0),r=e.location;r.startOffset<=n.startOffset?(r.endOffset=n.endOffset,r.endLine=n.endLine,r.endColumn=n.endColumn):(r.startOffset=NaN,r.startLine=NaN,r.startColumn=NaN)}cstPostRuleOnlyOffset(e){const n=this.LA(0),r=e.location;r.startOffset<=n.startOffset?r.endOffset=n.endOffset:r.startOffset=NaN}cstPostTerminal(e,n){const r=this.CST_STACK[this.CST_STACK.
length-1];GW(r,n,e),this.setNodeLocationFromToken(r.location,n)}cstPostNonTerminal(e,n){const r=this.CST_STACK[this.CST_STACK.length-1];KW(r,n,e),this.setNodeLocationFromNode(r.location,e.location)}getBaseCstVisitorConstructor(){if(bs(this.baseCstVisitorConstructor)){const e=YW(this.className,ti(this.gastProductionsCache));return this.baseCstVisitorConstructor=e,e}return this.baseCstVisitorConstructor}getBaseCstVisitorConstructorWithDefaults(){if(bs(this.baseCstVisitorWithDefaultsConstructor)){const e=XW(
this.className,ti(this.gastProductionsCache),this.getBaseCstVisitorConstructor());return this.baseCstVisitorWithDefaultsConstructor=e,e}return this.baseCstVisitorWithDefaultsConstructor}getLastExplicitRuleShortName(){const e=this.RULE_STACK;return e[e.length-1]}getPreviousExplicitRuleShortName(){const e=this.RULE_STACK;return e[e.length-2]}getLastExplicitRuleOccurrenceIndex(){const e=this.RULE_OCCURRENCE_STACK;return e[e.length-1]}}class nG{initLexerAdapter(){this.tokVector=[],this.tokVectorLength=
0,this.currIdx=-1}set input(e){if(this.selfAnalysisDone!==!0)throw Error("Missing <performSelfAnalysis> invocation at the end of the Parser's constructor.");this.reset(),this.tokVector=e,this.tokVectorLength=e.length}get input(){return this.tokVector}SKIP_TOKEN(){return this.currIdx<=this.tokVector.length-2?(this.consumeToken(),this.LA(1)):Tm}LA(e){const n=this.currIdx+e;return n<0||this.tokVectorLength<=n?Tm:this.tokVector[n]}consumeToken(){this.currIdx++}exportLexerState(){return this.currIdx}importLexerState(e){
this.currIdx=e}resetLexerState(){this.currIdx=-1}moveToTerminatedState(){this.currIdx=this.tokVector.length-1}getLexerPosition(){return this.exportLexerState()}}class rG{ACTION(e){return e.call(this)}consume(e,n,r){return this.consumeInternal(n,e,r)}subrule(e,n,r){return this.subruleInternal(n,e,r)}option(e,n){return this.optionInternal(n,e)}or(e,n){return this.orInternal(n,e)}many(e,n){return this.manyInternal(e,n)}atLeastOne(e,n){return this.atLeastOneInternal(e,n)}CONSUME(e,n){return this.consumeInternal(
e,0,n)}CONSUME1(e,n){return this.consumeInternal(e,1,n)}CONSUME2(e,n){return this.consumeInternal(e,2,n)}CONSUME3(e,n){return this.consumeInternal(e,3,n)}CONSUME4(e,n){return this.consumeInternal(e,4,n)}CONSUME5(e,n){return this.consumeInternal(e,5,n)}CONSUME6(e,n){return this.consumeInternal(e,6,n)}CONSUME7(e,n){return this.consumeInternal(e,7,n)}CONSUME8(e,n){return this.consumeInternal(e,8,n)}CONSUME9(e,n){return this.consumeInternal(e,9,n)}SUBRULE(e,n){return this.subruleInternal(e,0,n)}SUBRULE1(e,n){
return this.subruleInternal(e,1,n)}SUBRULE2(e,n){return this.subruleInternal(e,2,n)}SUBRULE3(e,n){return this.subruleInternal(e,3,n)}SUBRULE4(e,n){return this.subruleInternal(e,4,n)}SUBRULE5(e,n){return this.subruleInternal(e,5,n)}SUBRULE6(e,n){return this.subruleInternal(e,6,n)}SUBRULE7(e,n){return this.subruleInternal(e,7,n)}SUBRULE8(e,n){return this.subruleInternal(e,8,n)}SUBRULE9(e,n){return this.subruleInternal(e,9,n)}OPTION(e){return this.optionInternal(e,0)}OPTION1(e){return this.optionInternal(
e,1)}OPTION2(e){return this.optionInternal(e,2)}OPTION3(e){return this.optionInternal(e,3)}OPTION4(e){return this.optionInternal(e,4)}OPTION5(e){return this.optionInternal(e,5)}OPTION6(e){return this.optionInternal(e,6)}OPTION7(e){return this.optionInternal(e,7)}OPTION8(e){return this.optionInternal(e,8)}OPTION9(e){return this.optionInternal(e,9)}OR(e){return this.orInternal(e,0)}OR1(e){return this.orInternal(e,1)}OR2(e){return this.orInternal(e,2)}OR3(e){return this.orInternal(e,3)}OR4(e){return this.
orInternal(e,4)}OR5(e){return this.orInternal(e,5)}OR6(e){return this.orInternal(e,6)}OR7(e){return this.orInternal(e,7)}OR8(e){return this.orInternal(e,8)}OR9(e){return this.orInternal(e,9)}MANY(e){this.manyInternal(0,e)}MANY1(e){this.manyInternal(1,e)}MANY2(e){this.manyInternal(2,e)}MANY3(e){this.manyInternal(3,e)}MANY4(e){this.manyInternal(4,e)}MANY5(e){this.manyInternal(5,e)}MANY6(e){this.manyInternal(6,e)}MANY7(e){this.manyInternal(7,e)}MANY8(e){this.manyInternal(8,e)}MANY9(e){this.manyInternal(
9,e)}MANY_SEP(e){this.manySepFirstInternal(0,e)}MANY_SEP1(e){this.manySepFirstInternal(1,e)}MANY_SEP2(e){this.manySepFirstInternal(2,e)}MANY_SEP3(e){this.manySepFirstInternal(3,e)}MANY_SEP4(e){this.manySepFirstInternal(4,e)}MANY_SEP5(e){this.manySepFirstInternal(5,e)}MANY_SEP6(e){this.manySepFirstInternal(6,e)}MANY_SEP7(e){this.manySepFirstInternal(7,e)}MANY_SEP8(e){this.manySepFirstInternal(8,e)}MANY_SEP9(e){this.manySepFirstInternal(9,e)}AT_LEAST_ONE(e){this.atLeastOneInternal(0,e)}AT_LEAST_ONE1(e){
return this.atLeastOneInternal(1,e)}AT_LEAST_ONE2(e){this.atLeastOneInternal(2,e)}AT_LEAST_ONE3(e){this.atLeastOneInternal(3,e)}AT_LEAST_ONE4(e){this.atLeastOneInternal(4,e)}AT_LEAST_ONE5(e){this.atLeastOneInternal(5,e)}AT_LEAST_ONE6(e){this.atLeastOneInternal(6,e)}AT_LEAST_ONE7(e){this.atLeastOneInternal(7,e)}AT_LEAST_ONE8(e){this.atLeastOneInternal(8,e)}AT_LEAST_ONE9(e){this.atLeastOneInternal(9,e)}AT_LEAST_ONE_SEP(e){this.atLeastOneSepFirstInternal(0,e)}AT_LEAST_ONE_SEP1(e){this.atLeastOneSepFirstInternal(
1,e)}AT_LEAST_ONE_SEP2(e){this.atLeastOneSepFirstInternal(2,e)}AT_LEAST_ONE_SEP3(e){this.atLeastOneSepFirstInternal(3,e)}AT_LEAST_ONE_SEP4(e){this.atLeastOneSepFirstInternal(4,e)}AT_LEAST_ONE_SEP5(e){this.atLeastOneSepFirstInternal(5,e)}AT_LEAST_ONE_SEP6(e){this.atLeastOneSepFirstInternal(6,e)}AT_LEAST_ONE_SEP7(e){this.atLeastOneSepFirstInternal(7,e)}AT_LEAST_ONE_SEP8(e){this.atLeastOneSepFirstInternal(8,e)}AT_LEAST_ONE_SEP9(e){this.atLeastOneSepFirstInternal(9,e)}RULE(e,n,r=Em){if(rr(this.definedRulesNames,
e)){const a={message:ro.buildDuplicateRuleNameError({topLevelRule:e,grammarName:this.className}),type:ar.DUPLICATE_RULE_NAME,ruleName:e};this.definitionErrors.push(a)}this.definedRulesNames.push(e);const i=this.defineRule(e,n,r);return this[e]=i,i}OVERRIDE_RULE(e,n,r=Em){const i=TW(e,this.definedRulesNames,this.className);this.definitionErrors=this.definitionErrors.concat(i);const s=this.defineRule(e,n,r);return this[e]=s,s}BACKTRACK(e,n){return function(){this.isBackTrackingStack.push(1);const r=this.
saveRecogState();try{return e.apply(this,n),!0}catch(i){if(bm(i))return!1;throw i}finally{this.reloadRecogState(r),this.isBackTrackingStack.pop()}}}getGAstProductions(){return this.gastProductionsCache}getSerializedGastProductions(){return fB($n(this.gastProductionsCache))}}class iG{initRecognizerEngine(e,n){if(this.className=this.constructor.name,this.shortRuleNameToFull={},this.fullRuleNameToShort={},this.ruleShortNameIdx=256,this.tokenMatcher=mm,this.subruleIdx=0,this.definedRulesNames=[],this.
tokensMap={},this.isBackTrackingStack=[],this.RULE_STACK=[],this.RULE_OCCURRENCE_STACK=[],this.gastProductionsCache={},qe(n,"serializedGrammar"))throw Error(`The Parser's configuration can no longer contain a <serializedGrammar> property.
	See: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_6-0-0
	For Further details.`);if(yt(e)){if(Ot(e))throw Error(`A Token Vocabulary cannot be empty.
	Note that the first argument for the parser constructor
	is no longer a Token vector (since v4.0).`);if(typeof e[0].startOffset=="number")throw Error(`The Parser constructor no longer accepts a token vector as the first argument.
	See: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_4-0-0
	For Further details.`)}if(yt(e))this.tokensMap=ir(e,(s,a)=>(s[a.name]=a,s),{});else if(qe(e,"modes")&&yi(ni($n(e.modes)),nW)){const s=ni($n(e.modes)),a=Ib(s);this.tokensMap=ir(a,(o,l)=>(o[l.name]=l,o),{})}else if(ei(e))this.tokensMap=jn(e);else throw new Error("<tokensDictionary> argument must be An Array of Token constructors, A dictionary of Token constructors or an IMultiModeLexerDefinition");this.tokensMap.EOF=oa;const r=qe(e,"modes")?ni($n(e.modes)):$n(e),i=yi(r,s=>Ot(s.categoryMatches));this.
tokenMatcher=i?mm:Bu,Wu($n(this.tokensMap))}defineRule(e,n,r){if(this.selfAnalysisDone)throw Error(`Grammar rule <${e}> may not be defined after the 'performSelfAnalysis' method has been called'
Make sure that all grammar rule definitions are done before 'performSelfAnalysis' is called.`);const i=qe(r,"resyncEnabled")?r.resyncEnabled:Em.resyncEnabled,s=qe(r,"recoveryValueFunc")?r.recoveryValueFunc:Em.recoveryValueFunc,a=this.ruleShortNameIdx<<HW+la;this.ruleShortNameIdx++,this.shortRuleNameToFull[a]=e,this.fullRuleNameToShort[e]=a;let o;return this.outputCst===!0?o=function(...u){try{this.ruleInvocationStateUpdate(a,e,this.subruleIdx),n.apply(this,u);const d=this.CST_STACK[this.CST_STACK.
length-1];return this.cstPostRule(d),d}catch(d){return this.invokeRuleCatch(d,i,s)}finally{this.ruleFinallyStateUpdate()}}:o=function(...u){try{return this.ruleInvocationStateUpdate(a,e,this.subruleIdx),n.apply(this,u)}catch(d){return this.invokeRuleCatch(d,i,s)}finally{this.ruleFinallyStateUpdate()}},Object.assign(o,{ruleName:e,originalGrammarAction:n})}invokeRuleCatch(e,n,r){const i=this.RULE_STACK.length===1,s=n&&!this.isBackTracking()&&this.recoveryEnabled;if(bm(e)){const a=e;if(s){const o=this.
findReSyncTokenType();if(this.isInCurrentRuleReSyncSet(o))if(a.resyncedTokens=this.reSyncTo(o),this.outputCst){const l=this.CST_STACK[this.CST_STACK.length-1];return l.recoveredNode=!0,l}else return r(e);else{if(this.outputCst){const l=this.CST_STACK[this.CST_STACK.length-1];l.recoveredNode=!0,a.partialCstResult=l}throw a}}else{if(i)return this.moveToTerminatedState(),r(e);throw a}}else throw e}optionInternal(e,n){const r=this.getKeyForAutomaticLookahead(QE,n);return this.optionInternalLogic(e,n,
r)}optionInternalLogic(e,n,r){let i=this.getLaFuncFromCache(r),s;if(typeof e!="function"){s=e.DEF;const a=e.GATE;if(a!==void 0){const o=i;i=()=>a.call(this)&&o.call(this)}}else s=e;if(i.call(this)===!0)return s.call(this)}atLeastOneInternal(e,n){const r=this.getKeyForAutomaticLookahead(Gb,e);return this.atLeastOneInternalLogic(e,n,r)}atLeastOneInternalLogic(e,n,r){let i=this.getLaFuncFromCache(r),s;if(typeof n!="function"){s=n.DEF;const a=n.GATE;if(a!==void 0){const o=i;i=()=>a.call(this)&&o.call(
this)}}else s=n;if(i.call(this)===!0){let a=this.doSingleRepetition(s);for(;i.call(this)===!0&&a===!0;)a=this.doSingleRepetition(s)}else throw this.raiseEarlyExitException(e,Qt.REPETITION_MANDATORY,n.ERR_MSG);this.attemptInRepetitionRecovery(this.atLeastOneInternal,[e,n],i,Gb,e,dW)}atLeastOneSepFirstInternal(e,n){const r=this.getKeyForAutomaticLookahead(_m,e);this.atLeastOneSepFirstInternalLogic(e,n,r)}atLeastOneSepFirstInternalLogic(e,n,r){const i=n.DEF,s=n.SEP;if(this.getLaFuncFromCache(r).call(
this)===!0){i.call(this);const o=()=>this.tokenMatcher(this.LA(1),s);for(;this.tokenMatcher(this.LA(1),s)===!0;)this.CONSUME(s),i.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,s,o,i,LE],o,_m,e,LE)}else throw this.raiseEarlyExitException(e,Qt.REPETITION_MANDATORY_WITH_SEPARATOR,n.ERR_MSG)}manyInternal(e,n){const r=this.getKeyForAutomaticLookahead(Wb,e);return this.manyInternalLogic(e,n,r)}manyInternalLogic(e,n,r){let i=this.getLaFuncFromCache(r),s;if(typeof n!="f\
unction"){s=n.DEF;const o=n.GATE;if(o!==void 0){const l=i;i=()=>o.call(this)&&l.call(this)}}else s=n;let a=!0;for(;i.call(this)===!0&&a===!0;)a=this.doSingleRepetition(s);this.attemptInRepetitionRecovery(this.manyInternal,[e,n],i,Wb,e,uW,a)}manySepFirstInternal(e,n){const r=this.getKeyForAutomaticLookahead(Kb,e);this.manySepFirstInternalLogic(e,n,r)}manySepFirstInternalLogic(e,n,r){const i=n.DEF,s=n.SEP;if(this.getLaFuncFromCache(r).call(this)===!0){i.call(this);const o=()=>this.tokenMatcher(this.
LA(1),s);for(;this.tokenMatcher(this.LA(1),s)===!0;)this.CONSUME(s),i.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,s,o,i,OE],o,Kb,e,OE)}}repetitionSepSecondInternal(e,n,r,i,s){for(;r();)this.CONSUME(n),i.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,n,r,i,s],r,_m,e,s)}doSingleRepetition(e){const n=this.getLexerPosition();return e.call(this),this.getLexerPosition()>n}orInternal(e,n){const r=this.getKeyForAutomaticLookahead(XE,n),
i=yt(e)?e:e.DEF,a=this.getLaFuncFromCache(r).call(this,i);if(a!==void 0)return i[a].ALT.call(this);this.raiseNoAltException(n,e.ERR_MSG)}ruleFinallyStateUpdate(){if(this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstFinallyStateUpdate(),this.RULE_STACK.length===0&&this.isAtEndOfInput()===!1){const e=this.LA(1),n=this.errorMessageProvider.buildNotAllInputParsedMessage({firstRedundant:e,ruleName:this.getCurrRuleFullName()});this.SAVE_ERROR(new jW(n,e))}}subruleInternal(e,n,r){let i;try{
const s=r!==void 0?r.ARGS:void 0;return this.subruleIdx=n,i=e.apply(this,s),this.cstPostNonTerminal(i,r!==void 0&&r.LABEL!==void 0?r.LABEL:e.ruleName),i}catch(s){throw this.subruleInternalError(s,r,e.ruleName)}}subruleInternalError(e,n,r){throw bm(e)&&e.partialCstResult!==void 0&&(this.cstPostNonTerminal(e.partialCstResult,n!==void 0&&n.LABEL!==void 0?n.LABEL:r),delete e.partialCstResult),e}consumeInternal(e,n,r){let i;try{const s=this.LA(1);this.tokenMatcher(s,e)===!0?(this.consumeToken(),i=s):
this.consumeInternalError(e,s,r)}catch(s){i=this.consumeInternalRecovery(e,n,s)}return this.cstPostTerminal(r!==void 0&&r.LABEL!==void 0?r.LABEL:e.name,i),i}consumeInternalError(e,n,r){let i;const s=this.LA(0);throw r!==void 0&&r.ERR_MSG?i=r.ERR_MSG:i=this.errorMessageProvider.buildMismatchTokenMessage({expected:e,actual:n,previous:s,ruleName:this.getCurrRuleFullName()}),this.SAVE_ERROR(new JE(i,n,s))}consumeInternalRecovery(e,n,r){if(this.recoveryEnabled&&r.name==="MismatchedTokenException"&&!this.
isBackTracking()){const i=this.getFollowsForInRuleRecovery(e,n);try{return this.tryInRuleRecovery(e,i)}catch(s){throw s.name===YE?r:s}}else throw r}saveRecogState(){const e=this.errors,n=jn(this.RULE_STACK);return{errors:e,lexerState:this.exportLexerState(),RULE_STACK:n,CST_STACK:this.CST_STACK}}reloadRecogState(e){this.errors=e.errors,this.importLexerState(e.lexerState),this.RULE_STACK=e.RULE_STACK}ruleInvocationStateUpdate(e,n,r){this.RULE_OCCURRENCE_STACK.push(r),this.RULE_STACK.push(e),this.
cstInvocationStateUpdate(n)}isBackTracking(){return this.isBackTrackingStack.length!==0}getCurrRuleFullName(){const e=this.getLastExplicitRuleShortName();return this.shortRuleNameToFull[e]}shortRuleNameToFullName(e){return this.shortRuleNameToFull[e]}isAtEndOfInput(){return this.tokenMatcher(this.LA(1),oa)}reset(){this.resetLexerState(),this.subruleIdx=0,this.isBackTrackingStack=[],this.errors=[],this.RULE_STACK=[],this.CST_STACK=[],this.RULE_OCCURRENCE_STACK=[]}}class sG{initErrorHandler(e){this.
_errors=[],this.errorMessageProvider=qe(e,"errorMessageProvider")?e.errorMessageProvider:ks.errorMessageProvider}SAVE_ERROR(e){if(bm(e))return e.context={ruleStack:this.getHumanReadableRuleStack(),ruleOccurrenceStack:jn(this.RULE_OCCURRENCE_STACK)},this._errors.push(e),e;throw Error("Trying to save an Error which is not a RecognitionException")}get errors(){return jn(this._errors)}set errors(e){this._errors=e}raiseEarlyExitException(e,n,r){const i=this.getCurrRuleFullName(),s=this.getGAstProductions()[i],
o=vm(e,s,n,this.maxLookahead)[0],l=[];for(let u=1;u<=this.maxLookahead;u++)l.push(this.LA(u));const c=this.errorMessageProvider.buildEarlyExitMessage({expectedIterationPaths:o,actual:l,previous:this.LA(0),customUserDescription:r,ruleName:i});throw this.SAVE_ERROR(new qW(c,this.LA(1),this.LA(0)))}raiseNoAltException(e,n){const r=this.getCurrRuleFullName(),i=this.getGAstProductions()[r],s=ym(e,i,this.maxLookahead),a=[];for(let c=1;c<=this.maxLookahead;c++)a.push(this.LA(c));const o=this.LA(0),l=this.
errorMessageProvider.buildNoViableAltMessage({expectedPathsPerAlt:s,actual:a,previous:o,customUserDescription:n,ruleName:this.getCurrRuleFullName()});throw this.SAVE_ERROR(new MW(l,this.LA(1),o))}}class aG{initContentAssist(){}computeContentAssist(e,n){const r=this.gastProductionsCache[e];if(bs(r))throw Error(`Rule ->${e}<- does not exist in this grammar.`);return ME([r],n,this.tokenMatcher,this.maxLookahead)}getNextPossibleTokenTypes(e){const n=vi(e.ruleStack),i=this.getGAstProductions()[n];return new cW(
i,e).startWalking()}}const Sm={description:"This Object indicates the Parser is during Recording Phase"};Object.freeze(Sm);const rP=!0,iP=Math.pow(2,la)-1,sP=NE({name:"RECORDING_PHASE_TOKEN",pattern:_r.NA});Wu([sP]);const aP=qb(sP,`This IToken indicates the Parser is in Recording Phase
	See: https://chevrotain.io/docs/guide/internals.html#grammar-recording for details`,-1,-1,-1,-1,-1,-1);Object.freeze(aP);const oG={name:`This CSTNode indicates the Parser is in Recording Phase
	See: https://chevrotain.io/docs/guide/internals.html#grammar-recording for details`,children:{}};class lG{initGastRecorder(e){this.recordingProdStack=[],this.RECORDING_PHASE=!1}enableRecording(){this.RECORDING_PHASE=!0,this.TRACE_INIT("Enable Recording",()=>{for(let e=0;e<10;e++){const n=e>0?e:"";this[`CONSUME${n}`]=function(r,i){return this.consumeInternalRecord(r,e,i)},this[`SUBRULE${n}`]=function(r,i){return this.subruleInternalRecord(r,e,i)},this[`OPTION${n}`]=function(r){return this.optionInternalRecord(
r,e)},this[`OR${n}`]=function(r){return this.orInternalRecord(r,e)},this[`MANY${n}`]=function(r){this.manyInternalRecord(e,r)},this[`MANY_SEP${n}`]=function(r){this.manySepFirstInternalRecord(e,r)},this[`AT_LEAST_ONE${n}`]=function(r){this.atLeastOneInternalRecord(e,r)},this[`AT_LEAST_ONE_SEP${n}`]=function(r){this.atLeastOneSepFirstInternalRecord(e,r)}}this.consume=function(e,n,r){return this.consumeInternalRecord(n,e,r)},this.subrule=function(e,n,r){return this.subruleInternalRecord(n,e,r)},this.
option=function(e,n){return this.optionInternalRecord(n,e)},this.or=function(e,n){return this.orInternalRecord(n,e)},this.many=function(e,n){this.manyInternalRecord(e,n)},this.atLeastOne=function(e,n){this.atLeastOneInternalRecord(e,n)},this.ACTION=this.ACTION_RECORD,this.BACKTRACK=this.BACKTRACK_RECORD,this.LA=this.LA_RECORD})}disableRecording(){this.RECORDING_PHASE=!1,this.TRACE_INIT("Deleting Recording methods",()=>{const e=this;for(let n=0;n<10;n++){const r=n>0?n:"";delete e[`CONSUME${r}`],delete e[`\
SUBRULE${r}`],delete e[`OPTION${r}`],delete e[`OR${r}`],delete e[`MANY${r}`],delete e[`MANY_SEP${r}`],delete e[`AT_LEAST_ONE${r}`],delete e[`AT_LEAST_ONE_SEP${r}`]}delete e.consume,delete e.subrule,delete e.option,delete e.or,delete e.many,delete e.atLeastOne,delete e.ACTION,delete e.BACKTRACK,delete e.LA})}ACTION_RECORD(e){}BACKTRACK_RECORD(e,n){return()=>!0}LA_RECORD(e){return Tm}topLevelRuleRecord(e,n){try{const r=new Cl({definition:[],name:e});return r.name=e,this.recordingProdStack.push(r),
n.call(this),this.recordingProdStack.pop(),r}catch(r){if(r.KNOWN_RECORDER_ERROR!==!0)try{r.message=r.message+`
	 This error was thrown during the "grammar recording phase" For more info see:
	https://chevrotain.io/docs/guide/internals.html#grammar-recording`}catch{throw r}throw r}}optionInternalRecord(e,n){return Ku.call(this,Fn,e,n)}atLeastOneInternalRecord(e,n){Ku.call(this,Dr,n,e)}atLeastOneSepFirstInternalRecord(e,n){Ku.call(this,Or,n,e,rP)}manyInternalRecord(e,n){Ku.call(this,cn,n,e)}manySepFirstInternalRecord(e,n){Ku.call(this,br,n,e,rP)}orInternalRecord(e,n){return cG.call(this,e,n)}subruleInternalRecord(e,n,r){if($m(n),!e||qe(e,"ruleName")===!1){const o=new Error(`<SUBRULE${oP(
n)}> argument is invalid expecting a Parser method reference but got: <${JSON.stringify(e)}>
 inside top level rule: <${this.recordingProdStack[0].name}>`);throw o.KNOWN_RECORDER_ERROR=!0,o}const i=El(this.recordingProdStack),s=e.ruleName,a=new sr({idx:n,nonTerminalName:s,label:r?.LABEL,referencedRule:void 0});return i.definition.push(a),this.outputCst?oG:Sm}consumeInternalRecord(e,n,r){if($m(n),!_E(e)){const a=new Error(`<CONSUME${oP(n)}> argument is invalid expecting a TokenType reference but got: <${JSON.stringify(e)}>
 inside top level rule: <${this.recordingProdStack[0].name}>`);throw a.KNOWN_RECORDER_ERROR=!0,a}const i=El(this.recordingProdStack),s=new Wt({idx:n,terminalType:e,label:r?.LABEL});return i.definition.push(s),aP}}function Ku(t,e,n,r=!1){$m(n);const i=El(this.recordingProdStack),s=gs(e)?e:e.DEF,a=new t({definition:[],idx:n});return r&&(a.separator=e.SEP),qe(e,"MAX_LOOKAHEAD")&&(a.maxLookahead=e.MAX_LOOKAHEAD),this.recordingProdStack.push(a),s.call(this),i.definition.push(a),this.recordingProdStack.
pop(),Sm}function cG(t,e){$m(e);const n=El(this.recordingProdStack),r=yt(t)===!1,i=r===!1?t:t.DEF,s=new kr({definition:[],idx:e,ignoreAmbiguities:r&&t.IGNORE_AMBIGUITIES===!0});qe(t,"MAX_LOOKAHEAD")&&(s.maxLookahead=t.MAX_LOOKAHEAD);const a=iE(i,o=>gs(o.GATE));return s.hasPredicates=a,n.definition.push(s),je(i,o=>{const l=new wr({definition:[]});s.definition.push(l),qe(o,"IGNORE_AMBIGUITIES")?l.ignoreAmbiguities=o.IGNORE_AMBIGUITIES:qe(o,"GATE")&&(l.ignoreAmbiguities=!0),this.recordingProdStack.
push(l),o.ALT.call(this),this.recordingProdStack.pop()}),Sm}function oP(t){return t===0?"":`${t}`}function $m(t){if(t<0||t>iP){const e=new Error(`Invalid DSL Method idx value: <${t}>
	Idx value must be a none negative value smaller than ${iP+1}`);throw e.KNOWN_RECORDER_ERROR=!0,e}}class uG{initPerformanceTracer(e){if(qe(e,"traceInitPerf")){const n=e.traceInitPerf,r=typeof n=="number";this.traceInitMaxIdent=r?n:1/0,this.traceInitPerf=r?n>0:n}else this.traceInitMaxIdent=0,this.traceInitPerf=ks.traceInitPerf;this.traceInitIndent=-1}TRACE_INIT(e,n){if(this.traceInitPerf===!0){this.traceInitIndent++;const r=new Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&
console.log(`${r}--> <${e}>`);const{time:i,value:s}=oE(n),a=i>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&a(`${r}<-- <${e}> time: ${i}ms`),this.traceInitIndent--,s}else return n()}}function dG(t,e){e.forEach(n=>{const r=n.prototype;Object.getOwnPropertyNames(r).forEach(i=>{if(i==="constructor")return;const s=Object.getOwnPropertyDescriptor(r,i);s&&(s.get||s.set)?Object.defineProperty(t.prototype,i,s):t.prototype[i]=n.prototype[i]})})}const Tm=qb(oa,"",NaN,NaN,
NaN,NaN,NaN,NaN);Object.freeze(Tm);const ks=Object.freeze({recoveryEnabled:!1,maxLookahead:3,dynamicTokensEnabled:!1,outputCst:!0,errorMessageProvider:Il,nodeLocationTracking:"none",traceInitPerf:!1,skipValidations:!1}),Em=Object.freeze({recoveryValueFunc:()=>{},resyncEnabled:!0});var ar;(function(t){t[t.INVALID_RULE_NAME=0]="INVALID_RULE_NAME",t[t.DUPLICATE_RULE_NAME=1]="DUPLICATE_RULE_NAME",t[t.INVALID_RULE_OVERRIDE=2]="INVALID_RULE_OVERRIDE",t[t.DUPLICATE_PRODUCTIONS=3]="DUPLICATE_PRODUCTIONS",
t[t.UNRESOLVED_SUBRULE_REF=4]="UNRESOLVED_SUBRULE_REF",t[t.LEFT_RECURSION=5]="LEFT_RECURSION",t[t.NONE_LAST_EMPTY_ALT=6]="NONE_LAST_EMPTY_ALT",t[t.AMBIGUOUS_ALTS=7]="AMBIGUOUS_ALTS",t[t.CONFLICT_TOKENS_RULES_NAMESPACE=8]="CONFLICT_TOKENS_RULES_NAMESPACE",t[t.INVALID_TOKEN_NAME=9]="INVALID_TOKEN_NAME",t[t.NO_NON_EMPTY_LOOKAHEAD=10]="NO_NON_EMPTY_LOOKAHEAD",t[t.AMBIGUOUS_PREFIX_ALTS=11]="AMBIGUOUS_PREFIX_ALTS",t[t.TOO_MANY_ALTS=12]="TOO_MANY_ALTS",t[t.CUSTOM_LOOKAHEAD_VALIDATION=13]="CUSTOM_LOOKAH\
EAD_VALIDATION"})(ar||(ar={}));function lP(t=void 0){return function(){return t}}class hh{static performSelfAnalysis(e){throw Error("The **static** `performSelfAnalysis` method has been deprecated.	\nUse the **instance** method with the same name instead.")}performSelfAnalysis(){this.TRACE_INIT("performSelfAnalysis",()=>{let e;this.selfAnalysisDone=!0;const n=this.className;this.TRACE_INIT("toFastProps",()=>{lE(this)}),this.TRACE_INIT("Grammar Recording",()=>{try{this.enableRecording(),je(this.definedRulesNames,
i=>{const a=this[i].originalGrammarAction;let o;this.TRACE_INIT(`${i} Rule`,()=>{o=this.topLevelRuleRecord(i,a)}),this.gastProductionsCache[i]=o})}finally{this.disableRecording()}});let r=[];if(this.TRACE_INIT("Grammar Resolving",()=>{r=OW({rules:$n(this.gastProductionsCache)}),this.definitionErrors=this.definitionErrors.concat(r)}),this.TRACE_INIT("Grammar Validations",()=>{if(Ot(r)&&this.skipValidations===!1){const i=LW({rules:$n(this.gastProductionsCache),tokenTypes:$n(this.tokensMap),errMsgProvider:ro,
grammarName:n}),s=bW({lookaheadStrategy:this.lookaheadStrategy,rules:$n(this.gastProductionsCache),tokenTypes:$n(this.tokensMap),grammarName:n});this.definitionErrors=this.definitionErrors.concat(i,s)}}),Ot(this.definitionErrors)&&(this.recoveryEnabled&&this.TRACE_INIT("computeAllProdsFollows",()=>{const i=wB($n(this.gastProductionsCache));this.resyncFollows=i}),this.TRACE_INIT("ComputeLookaheadFunctions",()=>{var i,s;(s=(i=this.lookaheadStrategy).initialize)===null||s===void 0||s.call(i,{rules:$n(
this.gastProductionsCache)}),this.preComputeLookaheadFunctions($n(this.gastProductionsCache))})),!hh.DEFER_DEFINITION_ERRORS_HANDLING&&!Ot(this.definitionErrors))throw e=xe(this.definitionErrors,i=>i.message),new Error(`Parser Definition Errors detected:
 ${e.join(`
-------------------------------
`)}`)})}constructor(e,n){this.definitionErrors=[],this.selfAnalysisDone=!1;const r=this;if(r.initErrorHandler(n),r.initLexerAdapter(),r.initLooksAhead(n),r.initRecognizerEngine(e,n),r.initRecoverable(n),r.initTreeBuilder(n),r.initContentAssist(),r.initGastRecorder(n),r.initPerformanceTracer(n),qe(n,"ignoredIssues"))throw new Error(`The <ignoredIssues> IParserConfig property has been deprecated.
	Please use the <IGNORE_AMBIGUITIES> flag on the relevant DSL method instead.
	See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#IGNORING_AMBIGUITIES
	For further details.`);this.skipValidations=qe(n,"skipValidations")?n.skipValidations:ks.skipValidations}}hh.DEFER_DEFINITION_ERRORS_HANDLING=!1,dG(hh,[zW,VW,tG,nG,iG,rG,sG,aG,lG,uG]);class fG extends hh{constructor(e,n=ks){const r=jn(n);r.outputCst=!1,super(e,r)}}function Nl(t,e,n){return`${t.name}_${e}_${n}`}const ca=1,pG=2,cP=4,uP=5,Zu=7,hG=8,mG=9,gG=10,yG=11,dP=12;class Xb{constructor(e){this.target=e}isEpsilon(){return!1}}class Qb extends Xb{constructor(e,n){super(e),this.tokenType=n}}class fP extends Xb{constructor(e){
super(e)}isEpsilon(){return!0}}class ek extends Xb{constructor(e,n,r){super(e),this.rule=n,this.followState=r}isEpsilon(){return!0}}function vG(t){const e={decisionMap:{},decisionStates:[],ruleToStartState:new Map,ruleToStopState:new Map,states:[]};wG(e,t);const n=t.length;for(let r=0;r<n;r++){const i=t[r],s=io(e,i,i);s!==void 0&&xG(e,i,s)}return e}function wG(t,e){const n=e.length;for(let r=0;r<n;r++){const i=e[r],s=Nn(t,i,void 0,{type:pG}),a=Nn(t,i,void 0,{type:Zu});s.stop=a,t.ruleToStartState.
set(i,s),t.ruleToStopState.set(i,a)}}function pP(t,e,n){return n instanceof Wt?tk(t,e,n.terminalType,n):n instanceof sr?CG(t,e,n):n instanceof kr?SG(t,e,n):n instanceof Fn?$G(t,e,n):n instanceof cn?bG(t,e,n):n instanceof br?kG(t,e,n):n instanceof Dr?_G(t,e,n):n instanceof Or?RG(t,e,n):io(t,e,n)}function bG(t,e,n){const r=Nn(t,e,n,{type:uP});ua(t,r);const i=Dl(t,e,r,n,io(t,e,n));return mP(t,e,n,i)}function kG(t,e,n){const r=Nn(t,e,n,{type:uP});ua(t,r);const i=Dl(t,e,r,n,io(t,e,n)),s=tk(t,e,n.separator,
n);return mP(t,e,n,i,s)}function _G(t,e,n){const r=Nn(t,e,n,{type:cP});ua(t,r);const i=Dl(t,e,r,n,io(t,e,n));return hP(t,e,n,i)}function RG(t,e,n){const r=Nn(t,e,n,{type:cP});ua(t,r);const i=Dl(t,e,r,n,io(t,e,n)),s=tk(t,e,n.separator,n);return hP(t,e,n,i,s)}function SG(t,e,n){const r=Nn(t,e,n,{type:ca});ua(t,r);const i=xe(n.definition,a=>pP(t,e,a));return Dl(t,e,r,n,...i)}function $G(t,e,n){const r=Nn(t,e,n,{type:ca});ua(t,r);const i=Dl(t,e,r,n,io(t,e,n));return TG(t,e,n,i)}function io(t,e,n){const r=Ir(
xe(n.definition,i=>pP(t,e,i)),i=>i!==void 0);return r.length===1?r[0]:r.length===0?void 0:PG(t,r)}function hP(t,e,n,r,i){const s=r.left,a=r.right,o=Nn(t,e,n,{type:yG});ua(t,o);const l=Nn(t,e,n,{type:dP});return s.loopback=o,l.loopback=o,t.decisionMap[Nl(e,i?"RepetitionMandatoryWithSeparator":"RepetitionMandatory",n.idx)]=o,bn(a,o),i===void 0?(bn(o,s),bn(o,l)):(bn(o,l),bn(o,i.left),bn(i.right,s)),{left:s,right:l}}function mP(t,e,n,r,i){const s=r.left,a=r.right,o=Nn(t,e,n,{type:gG});ua(t,o);const l=Nn(
t,e,n,{type:dP}),c=Nn(t,e,n,{type:mG});return o.loopback=c,l.loopback=c,bn(o,s),bn(o,l),bn(a,c),i!==void 0?(bn(c,l),bn(c,i.left),bn(i.right,s)):bn(c,o),t.decisionMap[Nl(e,i?"RepetitionWithSeparator":"Repetition",n.idx)]=o,{left:o,right:l}}function TG(t,e,n,r){const i=r.left,s=r.right;return bn(i,s),t.decisionMap[Nl(e,"Option",n.idx)]=i,r}function ua(t,e){return t.decisionStates.push(e),e.decision=t.decisionStates.length-1,e.decision}function Dl(t,e,n,r,...i){const s=Nn(t,e,r,{type:hG,start:n});n.
end=s;for(const o of i)o!==void 0?(bn(n,o.left),bn(o.right,s)):bn(n,s);const a={left:n,right:s};return t.decisionMap[Nl(e,EG(r),r.idx)]=n,a}function EG(t){if(t instanceof kr)return"Alternation";if(t instanceof Fn)return"Option";if(t instanceof cn)return"Repetition";if(t instanceof br)return"RepetitionWithSeparator";if(t instanceof Dr)return"RepetitionMandatory";if(t instanceof Or)return"RepetitionMandatoryWithSeparator";throw new Error("Invalid production type encountered")}function PG(t,e){const n=e.
length;for(let s=0;s<n-1;s++){const a=e[s];let o;a.left.transitions.length===1&&(o=a.left.transitions[0]);const l=o instanceof ek,c=o,u=e[s+1].left;a.left.type===ca&&a.right.type===ca&&o!==void 0&&(l&&c.followState===a.right||o.target===a.right)?(l?c.followState=u:o.target=u,AG(t,a.right)):bn(a.right,u)}const r=e[0],i=e[n-1];return{left:r.left,right:i.right}}function tk(t,e,n,r){const i=Nn(t,e,r,{type:ca}),s=Nn(t,e,r,{type:ca});return nk(i,new Qb(s,n)),{left:i,right:s}}function CG(t,e,n){const r=n.
referencedRule,i=t.ruleToStartState.get(r),s=Nn(t,e,n,{type:ca}),a=Nn(t,e,n,{type:ca}),o=new ek(i,r,a);return nk(s,o),{left:s,right:a}}function xG(t,e,n){const r=t.ruleToStartState.get(e);bn(r,n.left);const i=t.ruleToStopState.get(e);return bn(n.right,i),{left:r,right:i}}function bn(t,e){const n=new fP(e);nk(t,n)}function Nn(t,e,n,r){const i=Object.assign({atn:t,production:n,epsilonOnlyTransitions:!1,rule:e,transitions:[],nextTokenWithinRule:[],stateNumber:t.states.length},r);return t.states.push(
i),i}function nk(t,e){t.transitions.length===0&&(t.epsilonOnlyTransitions=e.isEpsilon()),t.transitions.push(e)}function AG(t,e){t.states.splice(t.states.indexOf(e),1)}const Pm={};class rk{constructor(){this.map={},this.configs=[]}get size(){return this.configs.length}finalize(){this.map={}}add(e){const n=gP(e);n in this.map||(this.map[n]=this.configs.length,this.configs.push(e))}get elements(){return this.configs}get alts(){return xe(this.configs,e=>e.alt)}get key(){let e="";for(const n in this.
map)e+=n+":";return e}}function gP(t,e=!0){return`${e?`a${t.alt}`:""}s${t.state.stateNumber}:${t.stack.map(n=>n.stateNumber.toString()).join("_")}`}function IG(t,e){const n={};return r=>{const i=r.toString();let s=n[i];return s!==void 0||(s={atnStartState:t,decision:e,states:{}},n[i]=s),s}}class yP{constructor(){this.predicates=[]}is(e){return e>=this.predicates.length||this.predicates[e]}set(e,n){this.predicates[e]=n}toString(){let e="";const n=this.predicates.length;for(let r=0;r<n;r++)e+=this.
predicates[r]===!0?"1":"0";return e}}const vP=new yP;class NG extends Jb{constructor(e){var n;super(),this.logging=(n=e?.logging)!==null&&n!==void 0?n:(r=>console.log(r))}initialize(e){this.atn=vG(e.rules),this.dfas=DG(this.atn)}validateAmbiguousAlternationAlternatives(){return[]}validateEmptyOrAlternatives(){return[]}buildLookaheadForAlternation(e){const{prodOccurrence:n,rule:r,hasPredicates:i,dynamicTokensEnabled:s}=e,a=this.dfas,o=this.logging,l=Nl(r,"Alternation",n),u=this.atn.decisionMap[l].
decision,d=xe(jE({maxLookahead:1,occurrence:n,prodType:"Alternation",rule:r}),f=>xe(f,p=>p[0]));if(wP(d,!1)&&!s){const f=ir(d,(p,m,w)=>(je(m,v=>{v&&(p[v.tokenTypeIdx]=w,je(v.categoryMatches,g=>{p[g]=w}))}),p),{});return i?function(p){var m;const w=this.LA(1),v=f[w.tokenTypeIdx];if(p!==void 0&&v!==void 0){const g=(m=p[v])===null||m===void 0?void 0:m.GATE;if(g!==void 0&&g.call(this)===!1)return}return v}:function(){const p=this.LA(1);return f[p.tokenTypeIdx]}}else return i?function(f){const p=new yP,
m=f===void 0?0:f.length;for(let v=0;v<m;v++){const g=f?.[v].GATE;p.set(v,g===void 0||g.call(this))}const w=ik.call(this,a,u,p,o);return typeof w=="number"?w:void 0}:function(){const f=ik.call(this,a,u,vP,o);return typeof f=="number"?f:void 0}}buildLookaheadForOptional(e){const{prodOccurrence:n,rule:r,prodType:i,dynamicTokensEnabled:s}=e,a=this.dfas,o=this.logging,l=Nl(r,i,n),u=this.atn.decisionMap[l].decision,d=xe(jE({maxLookahead:1,occurrence:n,prodType:i,rule:r}),f=>xe(f,p=>p[0]));if(wP(d)&&d[0][0]&&
!s){const f=d[0],p=ni(f);if(p.length===1&&Ot(p[0].categoryMatches)){const w=p[0].tokenTypeIdx;return function(){return this.LA(1).tokenTypeIdx===w}}else{const m=ir(p,(w,v)=>(v!==void 0&&(w[v.tokenTypeIdx]=!0,je(v.categoryMatches,g=>{w[g]=!0})),w),{});return function(){const w=this.LA(1);return m[w.tokenTypeIdx]===!0}}}return function(){const f=ik.call(this,a,u,vP,o);return typeof f=="object"?!1:f===0}}}function wP(t,e=!0){const n=new Set;for(const r of t){const i=new Set;for(const s of r){if(s===
void 0){if(e)break;return!1}const a=[s.tokenTypeIdx].concat(s.categoryMatches);for(const o of a)if(n.has(o)){if(!i.has(o))return!1}else n.add(o),i.add(o)}}return!0}function DG(t){const e=t.decisionStates.length,n=Array(e);for(let r=0;r<e;r++)n[r]=IG(t.decisionStates[r],r);return n}function ik(t,e,n,r){const i=t[e](n);let s=i.start;if(s===void 0){const o=BG(i.atnStartState);s=_P(i,bP(o)),i.start=s}return OG.apply(this,[i,s,n,r])}function OG(t,e,n,r){let i=e,s=1;const a=[];let o=this.LA(s++);for(;;){
let l=zG(i,o);if(l===void 0&&(l=LG.apply(this,[t,i,o,s,n,r])),l===Pm)return FG(a,i,o);if(l.isAcceptState===!0)return l.prediction;i=l,a.push(o),o=this.LA(s++)}}function LG(t,e,n,r,i,s){const a=UG(e.configs,n,i);if(a.size===0)return kP(t,e,n,Pm),Pm;let o=bP(a);const l=VG(a,i);if(l!==void 0)o.isAcceptState=!0,o.prediction=l,o.configs.uniqueAlt=l;else if(ZG(a)){const c=QV(a.alts);o.isAcceptState=!0,o.prediction=c,o.configs.uniqueAlt=c,MG.apply(this,[t,r,a.alts,s])}return o=kP(t,e,n,o),o}function MG(t,e,n,r){
const i=[];for(let c=1;c<=e;c++)i.push(this.LA(c).tokenType);const s=t.atnStartState,a=s.rule,o=s.production,l=jG({topLevelRule:a,ambiguityIndices:n,production:o,prefixPath:i});r(l)}function jG(t){const e=xe(t.prefixPath,i=>Al(i)).join(", "),n=t.production.idx===0?"":t.production.idx;let r=`Ambiguous Alternatives Detected: <${t.ambiguityIndices.join(", ")}> in <${qG(t.production)}${n}> inside <${t.topLevelRule.name}> Rule,
<${e}> may appears as a prefix path in all these alternatives.
`;return r=r+`See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#AMBIGUOUS_ALTERNATIVES
For Further details.`,r}function qG(t){if(t instanceof sr)return"SUBRULE";if(t instanceof Fn)return"OPTION";if(t instanceof kr)return"OR";if(t instanceof Dr)return"AT_LEAST_ONE";if(t instanceof Or)return"AT_LEAST_ONE_SEP";if(t instanceof br)return"MANY_SEP";if(t instanceof cn)return"MANY";if(t instanceof Wt)return"CONSUME";throw Error("non exhaustive match")}function FG(t,e,n){const r=Nr(e.configs.elements,s=>s.state.transitions),i=cB(r.filter(s=>s instanceof Qb).map(s=>s.tokenType),s=>s.tokenTypeIdx);
return{actualToken:n,possibleTokenTypes:i,tokenPath:t}}function zG(t,e){return t.edges[e.tokenTypeIdx]}function UG(t,e,n){const r=new rk,i=[];for(const a of t.elements){if(n.is(a.alt)===!1)continue;if(a.state.type===Zu){i.push(a);continue}const o=a.state.transitions.length;for(let l=0;l<o;l++){const c=a.state.transitions[l],u=HG(c,e);u!==void 0&&r.add({state:u,alt:a.alt,stack:a.stack})}}let s;if(i.length===0&&r.size===1&&(s=r),s===void 0){s=new rk;for(const a of r.elements)Cm(a,s)}if(i.length>0&&
!GG(s))for(const a of i)s.add(a);return s}function HG(t,e){if(t instanceof Qb&&DE(e,t.tokenType))return t.target}function VG(t,e){let n;for(const r of t.elements)if(e.is(r.alt)===!0){if(n===void 0)n=r.alt;else if(n!==r.alt)return}return n}function bP(t){return{configs:t,edges:{},isAcceptState:!1,prediction:-1}}function kP(t,e,n,r){return r=_P(t,r),e.edges[n.tokenTypeIdx]=r,r}function _P(t,e){if(e===Pm)return e;const n=e.configs.key,r=t.states[n];return r!==void 0?r:(e.configs.finalize(),t.states[n]=
e,e)}function BG(t){const e=new rk,n=t.transitions.length;for(let r=0;r<n;r++){const s={state:t.transitions[r].target,alt:r,stack:[]};Cm(s,e)}return e}function Cm(t,e){const n=t.state;if(n.type===Zu){if(t.stack.length>0){const i=[...t.stack],a={state:i.pop(),alt:t.alt,stack:i};Cm(a,e)}else e.add(t);return}n.epsilonOnlyTransitions||e.add(t);const r=n.transitions.length;for(let i=0;i<r;i++){const s=n.transitions[i],a=WG(t,s);a!==void 0&&Cm(a,e)}}function WG(t,e){if(e instanceof fP)return{state:e.target,
alt:t.alt,stack:t.stack};if(e instanceof ek){const n=[...t.stack,e.followState];return{state:e.target,alt:t.alt,stack:n}}}function GG(t){for(const e of t.elements)if(e.state.type===Zu)return!0;return!1}function KG(t){for(const e of t.elements)if(e.state.type!==Zu)return!1;return!0}function ZG(t){if(KG(t))return!0;const e=JG(t.elements);return YG(e)&&!XG(e)}function JG(t){const e=new Map;for(const n of t){const r=gP(n,!1);let i=e.get(r);i===void 0&&(i={},e.set(r,i)),i[n.alt]=!0}return e}function YG(t){
for(const e of Array.from(t.values()))if(Object.keys(e).length>1)return!0;return!1}function XG(t){for(const e of Array.from(t.values()))if(Object.keys(e).length===1)return!0;return!1}var RP;(function(t){function e(n){return typeof n=="string"}t.is=e})(RP||(RP={}));var sk;(function(t){function e(n){return typeof n=="string"}t.is=e})(sk||(sk={}));var SP;(function(t){t.MIN_VALUE=-2147483648,t.MAX_VALUE=2147483647;function e(n){return typeof n=="number"&&t.MIN_VALUE<=n&&n<=t.MAX_VALUE}t.is=e})(SP||(SP=
{}));var xm;(function(t){t.MIN_VALUE=0,t.MAX_VALUE=2147483647;function e(n){return typeof n=="number"&&t.MIN_VALUE<=n&&n<=t.MAX_VALUE}t.is=e})(xm||(xm={}));var Rt;(function(t){function e(r,i){return r===Number.MAX_VALUE&&(r=xm.MAX_VALUE),i===Number.MAX_VALUE&&(i=xm.MAX_VALUE),{line:r,character:i}}t.create=e;function n(r){let i=r;return ee.objectLiteral(i)&&ee.uinteger(i.line)&&ee.uinteger(i.character)}t.is=n})(Rt||(Rt={}));var ft;(function(t){function e(r,i,s,a){if(ee.uinteger(r)&&ee.uinteger(i)&&
ee.uinteger(s)&&ee.uinteger(a))return{start:Rt.create(r,i),end:Rt.create(s,a)};if(Rt.is(r)&&Rt.is(i))return{start:r,end:i};throw new Error(`Range#create called with invalid arguments[${r}, ${i}, ${s}, ${a}]`)}t.create=e;function n(r){let i=r;return ee.objectLiteral(i)&&Rt.is(i.start)&&Rt.is(i.end)}t.is=n})(ft||(ft={}));var Am;(function(t){function e(r,i){return{uri:r,range:i}}t.create=e;function n(r){let i=r;return ee.objectLiteral(i)&&ft.is(i.range)&&(ee.string(i.uri)||ee.undefined(i.uri))}t.is=
n})(Am||(Am={}));var $P;(function(t){function e(r,i,s,a){return{targetUri:r,targetRange:i,targetSelectionRange:s,originSelectionRange:a}}t.create=e;function n(r){let i=r;return ee.objectLiteral(i)&&ft.is(i.targetRange)&&ee.string(i.targetUri)&&ft.is(i.targetSelectionRange)&&(ft.is(i.originSelectionRange)||ee.undefined(i.originSelectionRange))}t.is=n})($P||($P={}));var ak;(function(t){function e(r,i,s,a){return{red:r,green:i,blue:s,alpha:a}}t.create=e;function n(r){const i=r;return ee.objectLiteral(
i)&&ee.numberRange(i.red,0,1)&&ee.numberRange(i.green,0,1)&&ee.numberRange(i.blue,0,1)&&ee.numberRange(i.alpha,0,1)}t.is=n})(ak||(ak={}));var TP;(function(t){function e(r,i){return{range:r,color:i}}t.create=e;function n(r){const i=r;return ee.objectLiteral(i)&&ft.is(i.range)&&ak.is(i.color)}t.is=n})(TP||(TP={}));var EP;(function(t){function e(r,i,s){return{label:r,textEdit:i,additionalTextEdits:s}}t.create=e;function n(r){const i=r;return ee.objectLiteral(i)&&ee.string(i.label)&&(ee.undefined(i.
textEdit)||Rr.is(i))&&(ee.undefined(i.additionalTextEdits)||ee.typedArray(i.additionalTextEdits,Rr.is))}t.is=n})(EP||(EP={}));var PP;(function(t){t.Comment="comment",t.Imports="imports",t.Region="region"})(PP||(PP={}));var CP;(function(t){function e(r,i,s,a,o,l){const c={startLine:r,endLine:i};return ee.defined(s)&&(c.startCharacter=s),ee.defined(a)&&(c.endCharacter=a),ee.defined(o)&&(c.kind=o),ee.defined(l)&&(c.collapsedText=l),c}t.create=e;function n(r){const i=r;return ee.objectLiteral(i)&&ee.
uinteger(i.startLine)&&ee.uinteger(i.startLine)&&(ee.undefined(i.startCharacter)||ee.uinteger(i.startCharacter))&&(ee.undefined(i.endCharacter)||ee.uinteger(i.endCharacter))&&(ee.undefined(i.kind)||ee.string(i.kind))}t.is=n})(CP||(CP={}));var ok;(function(t){function e(r,i){return{location:r,message:i}}t.create=e;function n(r){let i=r;return ee.defined(i)&&Am.is(i.location)&&ee.string(i.message)}t.is=n})(ok||(ok={}));var so;(function(t){t.Error=1,t.Warning=2,t.Information=3,t.Hint=4})(so||(so={}));
var xP;(function(t){t.Unnecessary=1,t.Deprecated=2})(xP||(xP={}));var AP;(function(t){function e(n){const r=n;return ee.objectLiteral(r)&&ee.string(r.href)}t.is=e})(AP||(AP={}));var Im;(function(t){function e(r,i,s,a,o,l){let c={range:r,message:i};return ee.defined(s)&&(c.severity=s),ee.defined(a)&&(c.code=a),ee.defined(o)&&(c.source=o),ee.defined(l)&&(c.relatedInformation=l),c}t.create=e;function n(r){var i;let s=r;return ee.defined(s)&&ft.is(s.range)&&ee.string(s.message)&&(ee.number(s.severity)||
ee.undefined(s.severity))&&(ee.integer(s.code)||ee.string(s.code)||ee.undefined(s.code))&&(ee.undefined(s.codeDescription)||ee.string((i=s.codeDescription)===null||i===void 0?void 0:i.href))&&(ee.string(s.source)||ee.undefined(s.source))&&(ee.undefined(s.relatedInformation)||ee.typedArray(s.relatedInformation,ok.is))}t.is=n})(Im||(Im={}));var Ol;(function(t){function e(r,i,...s){let a={title:r,command:i};return ee.defined(s)&&s.length>0&&(a.arguments=s),a}t.create=e;function n(r){let i=r;return ee.
defined(i)&&ee.string(i.title)&&ee.string(i.command)}t.is=n})(Ol||(Ol={}));var Rr;(function(t){function e(s,a){return{range:s,newText:a}}t.replace=e;function n(s,a){return{range:{start:s,end:s},newText:a}}t.insert=n;function r(s){return{range:s,newText:""}}t.del=r;function i(s){const a=s;return ee.objectLiteral(a)&&ee.string(a.newText)&&ft.is(a.range)}t.is=i})(Rr||(Rr={}));var lk;(function(t){function e(r,i,s){const a={label:r};return i!==void 0&&(a.needsConfirmation=i),s!==void 0&&(a.description=
s),a}t.create=e;function n(r){const i=r;return ee.objectLiteral(i)&&ee.string(i.label)&&(ee.boolean(i.needsConfirmation)||i.needsConfirmation===void 0)&&(ee.string(i.description)||i.description===void 0)}t.is=n})(lk||(lk={}));var Ll;(function(t){function e(n){const r=n;return ee.string(r)}t.is=e})(Ll||(Ll={}));var IP;(function(t){function e(s,a,o){return{range:s,newText:a,annotationId:o}}t.replace=e;function n(s,a,o){return{range:{start:s,end:s},newText:a,annotationId:o}}t.insert=n;function r(s,a){
return{range:s,newText:"",annotationId:a}}t.del=r;function i(s){const a=s;return Rr.is(a)&&(lk.is(a.annotationId)||Ll.is(a.annotationId))}t.is=i})(IP||(IP={}));var ck;(function(t){function e(r,i){return{textDocument:r,edits:i}}t.create=e;function n(r){let i=r;return ee.defined(i)&&hk.is(i.textDocument)&&Array.isArray(i.edits)}t.is=n})(ck||(ck={}));var uk;(function(t){function e(r,i,s){let a={kind:"create",uri:r};return i!==void 0&&(i.overwrite!==void 0||i.ignoreIfExists!==void 0)&&(a.options=i),
s!==void 0&&(a.annotationId=s),a}t.create=e;function n(r){let i=r;return i&&i.kind==="create"&&ee.string(i.uri)&&(i.options===void 0||(i.options.overwrite===void 0||ee.boolean(i.options.overwrite))&&(i.options.ignoreIfExists===void 0||ee.boolean(i.options.ignoreIfExists)))&&(i.annotationId===void 0||Ll.is(i.annotationId))}t.is=n})(uk||(uk={}));var dk;(function(t){function e(r,i,s,a){let o={kind:"rename",oldUri:r,newUri:i};return s!==void 0&&(s.overwrite!==void 0||s.ignoreIfExists!==void 0)&&(o.options=
s),a!==void 0&&(o.annotationId=a),o}t.create=e;function n(r){let i=r;return i&&i.kind==="rename"&&ee.string(i.oldUri)&&ee.string(i.newUri)&&(i.options===void 0||(i.options.overwrite===void 0||ee.boolean(i.options.overwrite))&&(i.options.ignoreIfExists===void 0||ee.boolean(i.options.ignoreIfExists)))&&(i.annotationId===void 0||Ll.is(i.annotationId))}t.is=n})(dk||(dk={}));var fk;(function(t){function e(r,i,s){let a={kind:"delete",uri:r};return i!==void 0&&(i.recursive!==void 0||i.ignoreIfNotExists!==
void 0)&&(a.options=i),s!==void 0&&(a.annotationId=s),a}t.create=e;function n(r){let i=r;return i&&i.kind==="delete"&&ee.string(i.uri)&&(i.options===void 0||(i.options.recursive===void 0||ee.boolean(i.options.recursive))&&(i.options.ignoreIfNotExists===void 0||ee.boolean(i.options.ignoreIfNotExists)))&&(i.annotationId===void 0||Ll.is(i.annotationId))}t.is=n})(fk||(fk={}));var pk;(function(t){function e(n){let r=n;return r&&(r.changes!==void 0||r.documentChanges!==void 0)&&(r.documentChanges===void 0||
r.documentChanges.every(i=>ee.string(i.kind)?uk.is(i)||dk.is(i)||fk.is(i):ck.is(i)))}t.is=e})(pk||(pk={}));var NP;(function(t){function e(r){return{uri:r}}t.create=e;function n(r){let i=r;return ee.defined(i)&&ee.string(i.uri)}t.is=n})(NP||(NP={}));var DP;(function(t){function e(r,i){return{uri:r,version:i}}t.create=e;function n(r){let i=r;return ee.defined(i)&&ee.string(i.uri)&&ee.integer(i.version)}t.is=n})(DP||(DP={}));var hk;(function(t){function e(r,i){return{uri:r,version:i}}t.create=e;function n(r){
let i=r;return ee.defined(i)&&ee.string(i.uri)&&(i.version===null||ee.integer(i.version))}t.is=n})(hk||(hk={}));var OP;(function(t){function e(r,i,s,a){return{uri:r,languageId:i,version:s,text:a}}t.create=e;function n(r){let i=r;return ee.defined(i)&&ee.string(i.uri)&&ee.string(i.languageId)&&ee.integer(i.version)&&ee.string(i.text)}t.is=n})(OP||(OP={}));var mk;(function(t){t.PlainText="plaintext",t.Markdown="markdown";function e(n){const r=n;return r===t.PlainText||r===t.Markdown}t.is=e})(mk||(mk=
{}));var Ju;(function(t){function e(n){const r=n;return ee.objectLiteral(n)&&mk.is(r.kind)&&ee.string(r.value)}t.is=e})(Ju||(Ju={}));var Lt;(function(t){t.Text=1,t.Method=2,t.Function=3,t.Constructor=4,t.Field=5,t.Variable=6,t.Class=7,t.Interface=8,t.Module=9,t.Property=10,t.Unit=11,t.Value=12,t.Enum=13,t.Keyword=14,t.Snippet=15,t.Color=16,t.File=17,t.Reference=18,t.Folder=19,t.EnumMember=20,t.Constant=21,t.Struct=22,t.Event=23,t.Operator=24,t.TypeParameter=25})(Lt||(Lt={}));var Dn;(function(t){
t.PlainText=1,t.Snippet=2})(Dn||(Dn={}));var LP;(function(t){t.Deprecated=1})(LP||(LP={}));var MP;(function(t){function e(r,i,s){return{newText:r,insert:i,replace:s}}t.create=e;function n(r){const i=r;return i&&ee.string(i.newText)&&ft.is(i.insert)&&ft.is(i.replace)}t.is=n})(MP||(MP={}));var jP;(function(t){t.asIs=1,t.adjustIndentation=2})(jP||(jP={}));var qP;(function(t){function e(n){const r=n;return r&&(ee.string(r.detail)||r.detail===void 0)&&(ee.string(r.description)||r.description===void 0)}
t.is=e})(qP||(qP={}));var FP;(function(t){function e(n){return{label:n}}t.create=e})(FP||(FP={}));var zP;(function(t){function e(n,r){return{items:n||[],isIncomplete:!!r}}t.create=e})(zP||(zP={}));var Nm;(function(t){function e(r){return r.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")}t.fromPlainText=e;function n(r){const i=r;return ee.string(i)||ee.objectLiteral(i)&&ee.string(i.language)&&ee.string(i.value)}t.is=n})(Nm||(Nm={}));var UP;(function(t){function e(n){let r=n;return!!r&&ee.objectLiteral(r)&&
(Ju.is(r.contents)||Nm.is(r.contents)||ee.typedArray(r.contents,Nm.is))&&(n.range===void 0||ft.is(n.range))}t.is=e})(UP||(UP={}));var HP;(function(t){function e(n,r){return r?{label:n,documentation:r}:{label:n}}t.create=e})(HP||(HP={}));var VP;(function(t){function e(n,r,...i){let s={label:n};return ee.defined(r)&&(s.documentation=r),ee.defined(i)?s.parameters=i:s.parameters=[],s}t.create=e})(VP||(VP={}));var BP;(function(t){t.Text=1,t.Read=2,t.Write=3})(BP||(BP={}));var WP;(function(t){function e(n,r){
let i={range:n};return ee.number(r)&&(i.kind=r),i}t.create=e})(WP||(WP={}));var bi;(function(t){t.File=1,t.Module=2,t.Namespace=3,t.Package=4,t.Class=5,t.Method=6,t.Property=7,t.Field=8,t.Constructor=9,t.Enum=10,t.Interface=11,t.Function=12,t.Variable=13,t.Constant=14,t.String=15,t.Number=16,t.Boolean=17,t.Array=18,t.Object=19,t.Key=20,t.Null=21,t.EnumMember=22,t.Struct=23,t.Event=24,t.Operator=25,t.TypeParameter=26})(bi||(bi={}));var GP;(function(t){t.Deprecated=1})(GP||(GP={}));var KP;(function(t){
function e(n,r,i,s,a){let o={name:n,kind:r,location:{uri:s,range:i}};return a&&(o.containerName=a),o}t.create=e})(KP||(KP={}));var ZP;(function(t){function e(n,r,i,s){return s!==void 0?{name:n,kind:r,location:{uri:i,range:s}}:{name:n,kind:r,location:{uri:i}}}t.create=e})(ZP||(ZP={}));var JP;(function(t){function e(r,i,s,a,o,l){let c={name:r,detail:i,kind:s,range:a,selectionRange:o};return l!==void 0&&(c.children=l),c}t.create=e;function n(r){let i=r;return i&&ee.string(i.name)&&ee.number(i.kind)&&
ft.is(i.range)&&ft.is(i.selectionRange)&&(i.detail===void 0||ee.string(i.detail))&&(i.deprecated===void 0||ee.boolean(i.deprecated))&&(i.children===void 0||Array.isArray(i.children))&&(i.tags===void 0||Array.isArray(i.tags))}t.is=n})(JP||(JP={}));var YP;(function(t){t.Empty="",t.QuickFix="quickfix",t.Refactor="refactor",t.RefactorExtract="refactor.extract",t.RefactorInline="refactor.inline",t.RefactorRewrite="refactor.rewrite",t.Source="source",t.SourceOrganizeImports="source.organizeImports",t.
SourceFixAll="source.fixAll"})(YP||(YP={}));var Dm;(function(t){t.Invoked=1,t.Automatic=2})(Dm||(Dm={}));var XP;(function(t){function e(r,i,s){let a={diagnostics:r};return i!=null&&(a.only=i),s!=null&&(a.triggerKind=s),a}t.create=e;function n(r){let i=r;return ee.defined(i)&&ee.typedArray(i.diagnostics,Im.is)&&(i.only===void 0||ee.typedArray(i.only,ee.string))&&(i.triggerKind===void 0||i.triggerKind===Dm.Invoked||i.triggerKind===Dm.Automatic)}t.is=n})(XP||(XP={}));var QP;(function(t){function e(r,i,s){
let a={title:r},o=!0;return typeof i=="string"?(o=!1,a.kind=i):Ol.is(i)?a.command=i:a.edit=i,o&&s!==void 0&&(a.kind=s),a}t.create=e;function n(r){let i=r;return i&&ee.string(i.title)&&(i.diagnostics===void 0||ee.typedArray(i.diagnostics,Im.is))&&(i.kind===void 0||ee.string(i.kind))&&(i.edit!==void 0||i.command!==void 0)&&(i.command===void 0||Ol.is(i.command))&&(i.isPreferred===void 0||ee.boolean(i.isPreferred))&&(i.edit===void 0||pk.is(i.edit))}t.is=n})(QP||(QP={}));var eC;(function(t){function e(r,i){
let s={range:r};return ee.defined(i)&&(s.data=i),s}t.create=e;function n(r){let i=r;return ee.defined(i)&&ft.is(i.range)&&(ee.undefined(i.command)||Ol.is(i.command))}t.is=n})(eC||(eC={}));var tC;(function(t){function e(r,i){return{tabSize:r,insertSpaces:i}}t.create=e;function n(r){let i=r;return ee.defined(i)&&ee.uinteger(i.tabSize)&&ee.boolean(i.insertSpaces)}t.is=n})(tC||(tC={}));var nC;(function(t){function e(r,i,s){return{range:r,target:i,data:s}}t.create=e;function n(r){let i=r;return ee.defined(
i)&&ft.is(i.range)&&(ee.undefined(i.target)||ee.string(i.target))}t.is=n})(nC||(nC={}));var rC;(function(t){function e(r,i){return{range:r,parent:i}}t.create=e;function n(r){let i=r;return ee.objectLiteral(i)&&ft.is(i.range)&&(i.parent===void 0||t.is(i.parent))}t.is=n})(rC||(rC={}));var Om;(function(t){t.namespace="namespace",t.type="type",t.class="class",t.enum="enum",t.interface="interface",t.struct="struct",t.typeParameter="typeParameter",t.parameter="parameter",t.variable="variable",t.property=
"property",t.enumMember="enumMember",t.event="event",t.function="function",t.method="method",t.macro="macro",t.keyword="keyword",t.modifier="modifier",t.comment="comment",t.string="string",t.number="number",t.regexp="regexp",t.operator="operator",t.decorator="decorator"})(Om||(Om={}));var gk;(function(t){t.declaration="declaration",t.definition="definition",t.readonly="readonly",t.static="static",t.deprecated="deprecated",t.abstract="abstract",t.async="async",t.modification="modification",t.documentation=
"documentation",t.defaultLibrary="defaultLibrary"})(gk||(gk={}));var iC;(function(t){function e(n){const r=n;return ee.objectLiteral(r)&&(r.resultId===void 0||typeof r.resultId=="string")&&Array.isArray(r.data)&&(r.data.length===0||typeof r.data[0]=="number")}t.is=e})(iC||(iC={}));var sC;(function(t){function e(r,i){return{range:r,text:i}}t.create=e;function n(r){const i=r;return i!=null&&ft.is(i.range)&&ee.string(i.text)}t.is=n})(sC||(sC={}));var aC;(function(t){function e(r,i,s){return{range:r,
variableName:i,caseSensitiveLookup:s}}t.create=e;function n(r){const i=r;return i!=null&&ft.is(i.range)&&ee.boolean(i.caseSensitiveLookup)&&(ee.string(i.variableName)||i.variableName===void 0)}t.is=n})(aC||(aC={}));var oC;(function(t){function e(r,i){return{range:r,expression:i}}t.create=e;function n(r){const i=r;return i!=null&&ft.is(i.range)&&(ee.string(i.expression)||i.expression===void 0)}t.is=n})(oC||(oC={}));var lC;(function(t){function e(r,i){return{frameId:r,stoppedLocation:i}}t.create=e;
function n(r){const i=r;return ee.defined(i)&&ft.is(r.stoppedLocation)}t.is=n})(lC||(lC={}));var yk;(function(t){t.Type=1,t.Parameter=2;function e(n){return n===1||n===2}t.is=e})(yk||(yk={}));var vk;(function(t){function e(r){return{value:r}}t.create=e;function n(r){const i=r;return ee.objectLiteral(i)&&(i.tooltip===void 0||ee.string(i.tooltip)||Ju.is(i.tooltip))&&(i.location===void 0||Am.is(i.location))&&(i.command===void 0||Ol.is(i.command))}t.is=n})(vk||(vk={}));var cC;(function(t){function e(r,i,s){
const a={position:r,label:i};return s!==void 0&&(a.kind=s),a}t.create=e;function n(r){const i=r;return ee.objectLiteral(i)&&Rt.is(i.position)&&(ee.string(i.label)||ee.typedArray(i.label,vk.is))&&(i.kind===void 0||yk.is(i.kind))&&i.textEdits===void 0||ee.typedArray(i.textEdits,Rr.is)&&(i.tooltip===void 0||ee.string(i.tooltip)||Ju.is(i.tooltip))&&(i.paddingLeft===void 0||ee.boolean(i.paddingLeft))&&(i.paddingRight===void 0||ee.boolean(i.paddingRight))}t.is=n})(cC||(cC={}));var uC;(function(t){function e(n){
return{kind:"snippet",value:n}}t.createSnippet=e})(uC||(uC={}));var dC;(function(t){function e(n,r,i,s){return{insertText:n,filterText:r,range:i,command:s}}t.create=e})(dC||(dC={}));var fC;(function(t){function e(n){return{items:n}}t.create=e})(fC||(fC={}));var pC;(function(t){t.Invoked=0,t.Automatic=1})(pC||(pC={}));var hC;(function(t){function e(n,r){return{range:n,text:r}}t.create=e})(hC||(hC={}));var mC;(function(t){function e(n,r){return{triggerKind:n,selectedCompletionInfo:r}}t.create=e})(
mC||(mC={}));var gC;(function(t){function e(n){const r=n;return ee.objectLiteral(r)&&sk.is(r.uri)&&ee.string(r.name)}t.is=e})(gC||(gC={}));var yC;(function(t){function e(s,a,o,l){return new QG(s,a,o,l)}t.create=e;function n(s){let a=s;return!!(ee.defined(a)&&ee.string(a.uri)&&(ee.undefined(a.languageId)||ee.string(a.languageId))&&ee.uinteger(a.lineCount)&&ee.func(a.getText)&&ee.func(a.positionAt)&&ee.func(a.offsetAt))}t.is=n;function r(s,a){let o=s.getText(),l=i(a,(u,d)=>{let f=u.range.start.line-
d.range.start.line;return f===0?u.range.start.character-d.range.start.character:f}),c=o.length;for(let u=l.length-1;u>=0;u--){let d=l[u],f=s.offsetAt(d.range.start),p=s.offsetAt(d.range.end);if(p<=c)o=o.substring(0,f)+d.newText+o.substring(p,o.length);else throw new Error("Overlapping edit");c=f}return o}t.applyEdits=r;function i(s,a){if(s.length<=1)return s;const o=s.length/2|0,l=s.slice(0,o),c=s.slice(o);i(l,a),i(c,a);let u=0,d=0,f=0;for(;u<l.length&&d<c.length;)a(l[u],c[d])<=0?s[f++]=l[u++]:s[f++]=
c[d++];for(;u<l.length;)s[f++]=l[u++];for(;d<c.length;)s[f++]=c[d++];return s}})(yC||(yC={}));let QG=class{constructor(e,n,r,i){this._uri=e,this._languageId=n,this._version=r,this._content=i,this._lineOffsets=void 0}get uri(){return this._uri}get languageId(){return this._languageId}get version(){return this._version}getText(e){if(e){let n=this.offsetAt(e.start),r=this.offsetAt(e.end);return this._content.substring(n,r)}return this._content}update(e,n){this._content=e.text,this._version=n,this._lineOffsets=
void 0}getLineOffsets(){if(this._lineOffsets===void 0){let e=[],n=this._content,r=!0;for(let i=0;i<n.length;i++){r&&(e.push(i),r=!1);let s=n.charAt(i);r=s==="\r"||s===`
`,s==="\r"&&i+1<n.length&&n.charAt(i+1)===`
`&&i++}r&&n.length>0&&e.push(n.length),this._lineOffsets=e}return this._lineOffsets}positionAt(e){e=Math.max(Math.min(e,this._content.length),0);let n=this.getLineOffsets(),r=0,i=n.length;if(i===0)return Rt.create(0,e);for(;r<i;){let a=Math.floor((r+i)/2);n[a]>e?i=a:r=a+1}let s=r-1;return Rt.create(s,e-n[s])}offsetAt(e){let n=this.getLineOffsets();if(e.line>=n.length)return this._content.length;if(e.line<0)return 0;let r=n[e.line],i=e.line+1<n.length?n[e.line+1]:this._content.length;return Math.
max(Math.min(r+e.character,i),r)}get lineCount(){return this.getLineOffsets().length}};var ee;(function(t){const e=Object.prototype.toString;function n(p){return typeof p<"u"}t.defined=n;function r(p){return typeof p>"u"}t.undefined=r;function i(p){return p===!0||p===!1}t.boolean=i;function s(p){return e.call(p)==="[object String]"}t.string=s;function a(p){return e.call(p)==="[object Number]"}t.number=a;function o(p,m,w){return e.call(p)==="[object Number]"&&m<=p&&p<=w}t.numberRange=o;function l(p){
return e.call(p)==="[object Number]"&&-2147483648<=p&&p<=2147483647}t.integer=l;function c(p){return e.call(p)==="[object Number]"&&0<=p&&p<=2147483647}t.uinteger=c;function u(p){return e.call(p)==="[object Function]"}t.func=u;function d(p){return p!==null&&typeof p=="object"}t.objectLiteral=d;function f(p,m){return Array.isArray(p)&&p.every(m)}t.typedArray=f})(ee||(ee={}));class eK{constructor(){this.nodeStack=[]}get current(){var e;return(e=this.nodeStack[this.nodeStack.length-1])!==null&&e!==
void 0?e:this.rootNode}buildRootNode(e){return this.rootNode=new wC(e),this.rootNode.root=this.rootNode,this.nodeStack=[this.rootNode],this.rootNode}buildCompositeNode(e){const n=new bk;return n.grammarSource=e,n.root=this.rootNode,this.current.content.push(n),this.nodeStack.push(n),n}buildLeafNode(e,n){const r=new wk(e.startOffset,e.image.length,Dw(e),e.tokenType,!n);return r.grammarSource=n,r.root=this.rootNode,this.current.content.push(r),r}removeNode(e){const n=e.container;if(n){const r=n.content.
indexOf(e);r>=0&&n.content.splice(r,1)}}addHiddenNodes(e){const n=[];for(const s of e){const a=new wk(s.startOffset,s.image.length,Dw(s),s.tokenType,!0);a.root=this.rootNode,n.push(a)}let r=this.current,i=!1;if(r.content.length>0){r.content.push(...n);return}for(;r.container;){const s=r.container.content.indexOf(r);if(s>0){r.container.content.splice(s,0,...n),i=!0;break}r=r.container}i||this.rootNode.content.unshift(...n)}construct(e){const n=this.current;typeof e.$type=="string"&&(this.current.
astNode=e),e.$cstNode=n;const r=this.nodeStack.pop();r?.content.length===0&&this.removeNode(r)}}class vC{get parent(){return this.container}get feature(){return this.grammarSource}get hidden(){return!1}get astNode(){var e,n;const r=typeof((e=this._astNode)===null||e===void 0?void 0:e.$type)=="string"?this._astNode:(n=this.container)===null||n===void 0?void 0:n.astNode;if(!r)throw new Error("This node has no associated AST element");return r}set astNode(e){this._astNode=e}get element(){return this.
astNode}get text(){return this.root.fullText.substring(this.offset,this.end)}}class wk extends vC{get offset(){return this._offset}get length(){return this._length}get end(){return this._offset+this._length}get hidden(){return this._hidden}get tokenType(){return this._tokenType}get range(){return this._range}constructor(e,n,r,i,s=!1){super(),this._hidden=s,this._offset=e,this._tokenType=i,this._length=n,this._range=r}}class bk extends vC{constructor(){super(...arguments),this.content=new F$(this)}get children(){
return this.content}get offset(){var e,n;return(n=(e=this.firstNonHiddenNode)===null||e===void 0?void 0:e.offset)!==null&&n!==void 0?n:0}get length(){return this.end-this.offset}get end(){var e,n;return(n=(e=this.lastNonHiddenNode)===null||e===void 0?void 0:e.end)!==null&&n!==void 0?n:0}get range(){const e=this.firstNonHiddenNode,n=this.lastNonHiddenNode;if(e&&n){if(this._rangeCache===void 0){const{range:r}=e,{range:i}=n;this._rangeCache={start:r.start,end:i.end.line<r.start.line?r.start:i.end}}
return this._rangeCache}else return{start:Rt.create(0,0),end:Rt.create(0,0)}}get firstNonHiddenNode(){for(const e of this.content)if(!e.hidden)return e;return this.content[0]}get lastNonHiddenNode(){for(let e=this.content.length-1;e>=0;e--){const n=this.content[e];if(!n.hidden)return n}return this.content[this.content.length-1]}}class F$ extends Array{constructor(e){super(),this.parent=e,Object.setPrototypeOf(this,F$.prototype)}push(...e){return this.addParents(e),super.push(...e)}unshift(...e){
return this.addParents(e),super.unshift(...e)}splice(e,n,...r){return this.addParents(r),super.splice(e,n,...r)}addParents(e){for(const n of e)n.container=this.parent}}class wC extends bk{get text(){return this._text.substring(this.offset,this.end)}get fullText(){return this._text}constructor(e){super(),this._text="",this._text=e??""}}const kk=Symbol("Datatype");function _k(t){return t.$type===kk}const bC="\u200B",kC=t=>t.endsWith(bC)?t:t+bC;class _C{constructor(e){this._unorderedGroups=new Map,
this.allRules=new Map,this.lexer=e.parser.Lexer;const n=this.lexer.definition,r=e.LanguageMetaData.mode==="production";this.wrapper=new sK(n,Object.assign(Object.assign({},e.parser.ParserConfig),{skipValidations:r,errorMessageProvider:e.parser.ParserErrorMessageProvider}))}alternatives(e,n){this.wrapper.wrapOr(e,n)}optional(e,n){this.wrapper.wrapOption(e,n)}many(e,n){this.wrapper.wrapMany(e,n)}atLeastOne(e,n){this.wrapper.wrapAtLeastOne(e,n)}getRule(e){return this.allRules.get(e)}isRecording(){return this.
wrapper.IS_RECORDING}get unorderedGroups(){return this._unorderedGroups}getRuleStack(){return this.wrapper.RULE_STACK}finalize(){this.wrapper.wrapSelfAnalysis()}}class tK extends _C{get current(){return this.stack[this.stack.length-1]}constructor(e){super(e),this.nodeBuilder=new eK,this.stack=[],this.assignmentMap=new Map,this.linker=e.references.Linker,this.converter=e.parser.ValueConverter,this.astReflection=e.shared.AstReflection}rule(e,n){const r=this.computeRuleType(e),i=this.wrapper.DEFINE_RULE(
kC(e.name),this.startImplementation(r,n).bind(this));return this.allRules.set(e.name,i),e.entry&&(this.mainRule=i),i}computeRuleType(e){if(!e.fragment){if(Vh(e))return kk;{const n=Ja(e);return n??e.name}}}parse(e,n={}){this.nodeBuilder.buildRootNode(e);const r=this.lexerResult=this.lexer.tokenize(e);this.wrapper.input=r.tokens;const i=n.rule?this.allRules.get(n.rule):this.mainRule;if(!i)throw new Error(n.rule?`No rule found with name '${n.rule}'`:"No main rule available.");const s=this.doParse(i);
return this.nodeBuilder.addHiddenNodes(r.hidden),this.unorderedGroups.clear(),this.lexerResult=void 0,{value:s,lexerErrors:r.errors,lexerReport:r.report,parserErrors:this.wrapper.errors}}doParse(e){let n=e.call(this.wrapper,{});if(this.stack.length>0&&(n=this.construct()),n===void 0)throw new Error("No result from parser");if(this.stack.length>0)throw new Error("Parser stack is not empty after parsing");return n}startImplementation(e,n){return r=>{const i=!this.isRecording()&&e!==void 0;if(i){const s={
$type:e};this.stack.push(s),e===kk&&(s.value="")}return n(r),i?this.construct():void 0}}extractHiddenTokens(e){const n=this.lexerResult.hidden;if(!n.length)return[];const r=e.startOffset;for(let i=0;i<n.length;i++)if(n[i].startOffset>r)return n.splice(0,i);return n.splice(0,n.length)}consume(e,n,r){const i=this.wrapper.wrapConsume(e,n);if(!this.isRecording()&&this.isValidToken(i)){const s=this.extractHiddenTokens(i);this.nodeBuilder.addHiddenNodes(s);const a=this.nodeBuilder.buildLeafNode(i,r),{
assignment:o,isCrossRef:l}=this.getAssignment(r),c=this.current;if(o){const u=Xr(r)?i.image:this.converter.convert(i.image,a);this.assign(o.operator,o.feature,u,a,l)}else if(_k(c)){let u=i.image;Xr(r)||(u=this.converter.convert(u,a).toString()),c.value+=u}}}isValidToken(e){return!e.isInsertedInRecovery&&!isNaN(e.startOffset)&&typeof e.endOffset=="number"&&!isNaN(e.endOffset)}subrule(e,n,r,i,s){let a;!this.isRecording()&&!r&&(a=this.nodeBuilder.buildCompositeNode(i));let o;try{o=this.wrapper.wrapSubrule(
e,n,s)}finally{this.isRecording()||(o===void 0&&!r&&(o=this.construct()),o!==void 0&&a&&a.length>0&&this.performSubruleAssignment(o,i,a))}}performSubruleAssignment(e,n,r){const{assignment:i,isCrossRef:s}=this.getAssignment(n);if(i)this.assign(i.operator,i.feature,e,r,s);else if(!i){const a=this.current;if(_k(a))a.value+=e.toString();else if(typeof e=="object"&&e){const l=this.assignWithoutOverride(e,a);this.stack.pop(),this.stack.push(l)}}}action(e,n){if(!this.isRecording()){let r=this.current;if(n.
feature&&n.operator){r=this.construct(),this.nodeBuilder.removeNode(r.$cstNode),this.nodeBuilder.buildCompositeNode(n).content.push(r.$cstNode);const s={$type:e};this.stack.push(s),this.assign(n.operator,n.feature,r,r.$cstNode,!1)}else r.$type=e}}construct(){if(this.isRecording())return;const e=this.current;return Ww(e),this.nodeBuilder.construct(e),this.stack.pop(),_k(e)?this.converter.convert(e.value,e.$cstNode):(Kw(this.astReflection,e),e)}getAssignment(e){if(!this.assignmentMap.has(e)){const n=xr(
e,Fi);this.assignmentMap.set(e,{assignment:n,isCrossRef:n?Za(n.terminal):!1})}return this.assignmentMap.get(e)}assign(e,n,r,i,s){const a=this.current;let o;switch(s&&typeof r=="string"?o=this.linker.buildReference(a,n,i,r):o=r,e){case"=":{a[n]=o;break}case"?=":{a[n]=!0;break}case"+=":Array.isArray(a[n])||(a[n]=[]),a[n].push(o)}}assignWithoutOverride(e,n){for(const[i,s]of Object.entries(n)){const a=e[i];a===void 0?e[i]=s:Array.isArray(a)&&Array.isArray(s)&&(s.push(...a),e[i]=s)}const r=e.$cstNode;
return r&&(r.astNode=void 0,e.$cstNode=void 0),e}get definitionErrors(){return this.wrapper.definitionErrors}}class nK{buildMismatchTokenMessage(e){return Il.buildMismatchTokenMessage(e)}buildNotAllInputParsedMessage(e){return Il.buildNotAllInputParsedMessage(e)}buildNoViableAltMessage(e){return Il.buildNoViableAltMessage(e)}buildEarlyExitMessage(e){return Il.buildEarlyExitMessage(e)}}class RC extends nK{buildMismatchTokenMessage({expected:e,actual:n}){return`Expecting ${e.LABEL?"`"+e.LABEL+"`":
e.name.endsWith(":KW")?`keyword '${e.name.substring(0,e.name.length-3)}'`:`token of type '${e.name}'`} but found \`${n.image}\`.`}buildNotAllInputParsedMessage({firstRedundant:e}){return`Expecting end of file but found \`${e.image}\`.`}}class rK extends _C{constructor(){super(...arguments),this.tokens=[],this.elementStack=[],this.lastElementStack=[],this.nextTokenIndex=0,this.stackSize=0}action(){}construct(){}parse(e){this.resetState();const n=this.lexer.tokenize(e,{mode:"partial"});return this.
tokens=n.tokens,this.wrapper.input=[...this.tokens],this.mainRule.call(this.wrapper,{}),this.unorderedGroups.clear(),{tokens:this.tokens,elementStack:[...this.lastElementStack],tokenIndex:this.nextTokenIndex}}rule(e,n){const r=this.wrapper.DEFINE_RULE(kC(e.name),this.startImplementation(n).bind(this));return this.allRules.set(e.name,r),e.entry&&(this.mainRule=r),r}resetState(){this.elementStack=[],this.lastElementStack=[],this.nextTokenIndex=0,this.stackSize=0}startImplementation(e){return n=>{const r=this.
keepStackSize();try{e(n)}finally{this.resetStackSize(r)}}}removeUnexpectedElements(){this.elementStack.splice(this.stackSize)}keepStackSize(){const e=this.elementStack.length;return this.stackSize=e,e}resetStackSize(e){this.removeUnexpectedElements(),this.stackSize=e}consume(e,n,r){this.wrapper.wrapConsume(e,n),this.isRecording()||(this.lastElementStack=[...this.elementStack,r],this.nextTokenIndex=this.currIdx+1)}subrule(e,n,r,i,s){this.before(i),this.wrapper.wrapSubrule(e,n,s),this.after(i)}before(e){
this.isRecording()||this.elementStack.push(e)}after(e){if(!this.isRecording()){const n=this.elementStack.lastIndexOf(e);n>=0&&this.elementStack.splice(n)}}get currIdx(){return this.wrapper.currIdx}}const iK={recoveryEnabled:!0,nodeLocationTracking:"full",skipValidations:!0,errorMessageProvider:new RC};class sK extends fG{constructor(e,n){const r=n&&"maxLookahead"in n;super(e,Object.assign(Object.assign(Object.assign({},iK),{lookaheadStrategy:r?new Jb({maxLookahead:n.maxLookahead}):new NG({logging:n.
skipValidations?()=>{}:void 0})}),n))}get IS_RECORDING(){return this.RECORDING_PHASE}DEFINE_RULE(e,n,r){return this.RULE(e,n,r)}wrapSelfAnalysis(){this.performSelfAnalysis()}wrapConsume(e,n){return this.consume(e,n,void 0)}wrapSubrule(e,n,r){return this.subrule(e,n,{ARGS:[r]})}wrapOr(e,n){this.or(e,n)}wrapOption(e,n){this.option(e,n)}wrapMany(e,n){this.many(e,n)}wrapAtLeastOne(e,n){this.atLeastOne(e,n)}}function SC(t,e,n){return aK({parser:e,tokens:n,ruleNames:new Map},t),e}function aK(t,e){const n=Xw(
e,!1),r=dt(e.rules).filter(In).filter(i=>n.has(i));for(const i of r){const s=Object.assign(Object.assign({},t),{consume:1,optional:1,subrule:1,many:1,or:1});t.parser.rule(i,ao(s,i.definition))}}function ao(t,e,n=!1){let r;if(Xr(e))r=pK(t,e);else if(Ka(e))r=oK(t,e);else if(Fi(e))r=ao(t,e.terminal);else if(Za(e))r=$C(t,e);else if(zi(e))r=lK(t,e);else if(Vw(e))r=uK(t,e);else if(Bw(e))r=dK(t,e);else if(ra(e))r=fK(t,e);else if(n2(e)){const i=t.consume++;r=()=>t.parser.consume(i,oa,e)}else throw new P0(
e.$cstNode,`Unexpected element type: ${e.$type}`);return TC(t,n?void 0:Lm(e),r,e.cardinality)}function oK(t,e){const n=Pu(e);return()=>t.parser.action(n,e)}function lK(t,e){const n=e.rule.ref;if(In(n)){const r=t.subrule++,i=n.fragment,s=e.arguments.length>0?cK(n,e.arguments):()=>({});return a=>t.parser.subrule(r,EC(t,n),i,e,s(a))}else if(ps(n)){const r=t.consume++,i=Rk(t,n.name);return()=>t.parser.consume(r,i,e)}else if(n)Gc();else throw new P0(e.$cstNode,`Undefined rule: ${e.rule.$refText}`)}function cK(t,e){
const n=e.map(r=>_s(r.value));return r=>{const i={};for(let s=0;s<n.length;s++){const a=t.parameters[s],o=n[s];i[a.name]=o(r)}return i}}function _s(t){if(ZF(t)){const e=_s(t.left),n=_s(t.right);return r=>e(r)||n(r)}else if(KF(t)){const e=_s(t.left),n=_s(t.right);return r=>e(r)&&n(r)}else if(JF(t)){const e=_s(t.value);return n=>!e(n)}else if(YF(t)){const e=t.parameter.ref.name;return n=>n!==void 0&&n[e]===!0}else if(GF(t)){const e=!!t.true;return()=>e}Gc()}function uK(t,e){if(e.elements.length===
1)return ao(t,e.elements[0]);{const n=[];for(const i of e.elements){const s={ALT:ao(t,i,!0)},a=Lm(i);a&&(s.GATE=_s(a)),n.push(s)}const r=t.or++;return i=>t.parser.alternatives(r,n.map(s=>{const a={ALT:()=>s.ALT(i)},o=s.GATE;return o&&(a.GATE=()=>o(i)),a}))}}function dK(t,e){if(e.elements.length===1)return ao(t,e.elements[0]);const n=[];for(const o of e.elements){const l={ALT:ao(t,o,!0)},c=Lm(o);c&&(l.GATE=_s(c)),n.push(l)}const r=t.or++,i=(o,l)=>{const c=l.getRuleStack().join("-");return`uGroup_${o}\
_${c}`},s=o=>t.parser.alternatives(r,n.map((l,c)=>{const u={ALT:()=>!0},d=t.parser;u.ALT=()=>{if(l.ALT(o),!d.isRecording()){const p=i(r,d);d.unorderedGroups.get(p)||d.unorderedGroups.set(p,[]);const m=d.unorderedGroups.get(p);typeof m?.[c]>"u"&&(m[c]=!0)}};const f=l.GATE;return f?u.GATE=()=>f(o):u.GATE=()=>{const p=d.unorderedGroups.get(i(r,d));return!p?.[c]},u})),a=TC(t,Lm(e),s,"*");return o=>{a(o),t.parser.isRecording()||t.parser.unorderedGroups.delete(i(r,t.parser))}}function fK(t,e){const n=e.
elements.map(r=>ao(t,r));return r=>n.forEach(i=>i(r))}function Lm(t){if(ra(t))return t.guardCondition}function $C(t,e,n=e.terminal){if(n)if(zi(n)&&In(n.rule.ref)){const r=n.rule.ref,i=t.subrule++;return s=>t.parser.subrule(i,EC(t,r),!1,e,s)}else if(zi(n)&&ps(n.rule.ref)){const r=t.consume++,i=Rk(t,n.rule.ref.name);return()=>t.parser.consume(r,i,e)}else if(Xr(n)){const r=t.consume++,i=Rk(t,n.value);return()=>t.parser.consume(r,i,e)}else throw new Error("Could not build cross reference parser");else{
if(!e.type.ref)throw new Error("Could not resolve reference to type: "+e.type.$refText);const r=rb(e.type.ref),i=r?.terminal;if(!i)throw new Error("Could not find name assignment for type: "+Pu(e.type.ref));return $C(t,e,i)}}function pK(t,e){const n=t.consume++,r=t.tokens[e.value];if(!r)throw new Error("Could not find token for keyword: "+e.value);return()=>t.parser.consume(n,r,e)}function TC(t,e,n,r){const i=e&&_s(e);if(!r)if(i){const s=t.or++;return a=>t.parser.alternatives(s,[{ALT:()=>n(a),GATE:()=>i(
a)},{ALT:lP(),GATE:()=>!i(a)}])}else return n;if(r==="*"){const s=t.many++;return a=>t.parser.many(s,{DEF:()=>n(a),GATE:i?()=>i(a):void 0})}else if(r==="+"){const s=t.many++;if(i){const a=t.or++;return o=>t.parser.alternatives(a,[{ALT:()=>t.parser.atLeastOne(s,{DEF:()=>n(o)}),GATE:()=>i(o)},{ALT:lP(),GATE:()=>!i(o)}])}else return a=>t.parser.atLeastOne(s,{DEF:()=>n(a)})}else if(r==="?"){const s=t.optional++;return a=>t.parser.optional(s,{DEF:()=>n(a),GATE:i?()=>i(a):void 0})}else Gc()}function EC(t,e){
const n=hK(t,e),r=t.parser.getRule(n);if(!r)throw new Error(`Rule "${n}" not found."`);return r}function hK(t,e){if(In(e))return e.name;if(t.ruleNames.has(e))return t.ruleNames.get(e);{let n=e,r=n.$container,i=e.$type;for(;!In(r);)(ra(r)||Vw(r)||Bw(r))&&(i=r.elements.indexOf(n).toString()+":"+i),n=r,r=r.$container;return i=r.name+":"+i,t.ruleNames.set(e,i),i}}function Rk(t,e){const n=t.tokens[e];if(!n)throw new Error(`Token "${e}" not found."`);return n}function mK(t){const e=t.Grammar,n=t.parser.
Lexer,r=new rK(t);return SC(e,r,n.definition),r.finalize(),r}function gK(t){const e=yK(t);return e.finalize(),e}function yK(t){const e=t.Grammar,n=t.parser.Lexer,r=new tK(t);return SC(e,r,n.definition)}class vK{constructor(){this.diagnostics=[]}buildTokens(e,n){const r=dt(Xw(e,!1)),i=this.buildTerminalTokens(r),s=this.buildKeywordTokens(r,i,n);return s.push(...i),s}flushLexingReport(e){return{diagnostics:this.popDiagnostics()}}popDiagnostics(){const e=[...this.diagnostics];return this.diagnostics=
[],e}buildTerminalTokens(e){return e.filter(ps).filter(n=>!n.fragment).map(n=>this.buildTerminalToken(n)).toArray()}buildTerminalToken(e){const n=Cu(e),r=this.requiresCustomPattern(n)?this.regexPatternFunction(n):n,i={name:e.name,PATTERN:r};return typeof r=="function"&&(i.LINE_BREAKS=!0),e.hidden&&(i.GROUP=q0(n)?_r.SKIPPED:"hidden"),i}requiresCustomPattern(e){return e.flags.includes("u")||e.flags.includes("s")?!0:!!(e.source.includes("?<=")||e.source.includes("?<!"))}regexPatternFunction(e){const n=new RegExp(
e,e.flags+"y");return(r,i)=>(n.lastIndex=i,n.exec(r))}buildKeywordTokens(e,n,r){return e.filter(In).flatMap(i=>hi(i).filter(Xr)).distinct(i=>i.value).toArray().sort((i,s)=>s.value.length-i.value.length).map(i=>this.buildKeywordToken(i,n,!!r?.caseInsensitive))}buildKeywordToken(e,n,r){const i=this.buildKeywordPattern(e,r),s={name:e.value,PATTERN:i,LONGER_ALT:this.findLongerAlt(e,n)};return typeof i=="function"&&(s.LINE_BREAKS=!0),s}buildKeywordPattern(e,n){return n?new RegExp(Uh(e.value),"i"):e.value}findLongerAlt(e,n){
return n.reduce((r,i)=>{const s=i?.PATTERN;return s?.source&&y2("^"+s.source+"$",e.value)&&r.push(i),r},[])}}class PC{convert(e,n){let r=n.grammarSource;if(Za(r)&&(r=Qw(r)),zi(r)){const i=r.rule.ref;if(!i)throw new Error("This cst node was not parsed by a rule.");return this.runConverter(i,e,n)}return e}runConverter(e,n,r){var i;switch(e.name.toUpperCase()){case"INT":return Gi.convertInt(n);case"STRING":return Gi.convertString(n);case"ID":return Gi.convertID(n)}switch((i=Z0(e))===null||i===void 0?
void 0:i.toLowerCase()){case"number":return Gi.convertNumber(n);case"boolean":return Gi.convertBoolean(n);case"bigint":return Gi.convertBigint(n);case"date":return Gi.convertDate(n);default:return n}}}var Gi;(function(t){function e(c){let u="";for(let d=1;d<c.length-1;d++){const f=c.charAt(d);if(f==="\\"){const p=c.charAt(++d);u+=n(p)}else u+=f}return u}t.convertString=e;function n(c){switch(c){case"b":return"\b";case"f":return"\f";case"n":return`
`;case"r":return"\r";case"t":return"	";case"v":return"\v";case"0":return"\0";default:return c}}function r(c){return c.charAt(0)==="^"?c.substring(1):c}t.convertID=r;function i(c){return parseInt(c)}t.convertInt=i;function s(c){return BigInt(c)}t.convertBigint=s;function a(c){return new Date(c)}t.convertDate=a;function o(c){return Number(c)}t.convertNumber=o;function l(c){return c.toLowerCase()==="true"}t.convertBoolean=l})(Gi||(Gi={}));function oo(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.
call(t,"default")?t.default:t}function Sk(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var i=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return t[r]}})}),n}var lo={},Mm={},CC;function co(){
if(CC)return Mm;CC=1,Object.defineProperty(Mm,"__esModule",{value:!0});let t;function e(){if(t===void 0)throw new Error("No runtime abstraction layer installed");return t}return(function(n){function r(i){if(i===void 0)throw new Error("No runtime abstraction layer provided");t=i}n.install=r})(e||(e={})),Mm.default=e,Mm}var zn={},xC;function Yu(){if(xC)return zn;xC=1,Object.defineProperty(zn,"__esModule",{value:!0}),zn.stringArray=zn.array=zn.func=zn.error=zn.number=zn.string=zn.boolean=void 0;function t(o){
return o===!0||o===!1}zn.boolean=t;function e(o){return typeof o=="string"||o instanceof String}zn.string=e;function n(o){return typeof o=="number"||o instanceof Number}zn.number=n;function r(o){return o instanceof Error}zn.error=r;function i(o){return typeof o=="function"}zn.func=i;function s(o){return Array.isArray(o)}zn.array=s;function a(o){return s(o)&&o.every(l=>e(l))}return zn.stringArray=a,zn}var uo={},AC;function Ml(){if(AC)return uo;AC=1,Object.defineProperty(uo,"__esModule",{value:!0}),
uo.Emitter=uo.Event=void 0;const t=co();var e;(function(i){const s={dispose(){}};i.None=function(){return s}})(e||(uo.Event=e={}));class n{add(s,a=null,o){this._callbacks||(this._callbacks=[],this._contexts=[]),this._callbacks.push(s),this._contexts.push(a),Array.isArray(o)&&o.push({dispose:()=>this.remove(s,a)})}remove(s,a=null){if(!this._callbacks)return;let o=!1;for(let l=0,c=this._callbacks.length;l<c;l++)if(this._callbacks[l]===s)if(this._contexts[l]===a){this._callbacks.splice(l,1),this._contexts.
splice(l,1);return}else o=!0;if(o)throw new Error("When adding a listener with a context, you should remove it with the same context")}invoke(...s){if(!this._callbacks)return[];const a=[],o=this._callbacks.slice(0),l=this._contexts.slice(0);for(let c=0,u=o.length;c<u;c++)try{a.push(o[c].apply(l[c],s))}catch(d){(0,t.default)().console.error(d)}return a}isEmpty(){return!this._callbacks||this._callbacks.length===0}dispose(){this._callbacks=void 0,this._contexts=void 0}}class r{constructor(s){this._options=
s}get event(){return this._event||(this._event=(s,a,o)=>{this._callbacks||(this._callbacks=new n),this._options&&this._options.onFirstListenerAdd&&this._callbacks.isEmpty()&&this._options.onFirstListenerAdd(this),this._callbacks.add(s,a);const l={dispose:()=>{this._callbacks&&(this._callbacks.remove(s,a),l.dispose=r._noop,this._options&&this._options.onLastListenerRemove&&this._callbacks.isEmpty()&&this._options.onLastListenerRemove(this))}};return Array.isArray(o)&&o.push(l),l}),this._event}fire(s){
this._callbacks&&this._callbacks.invoke.call(this._callbacks,s)}dispose(){this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0)}}return uo.Emitter=r,r._noop=function(){},uo}var IC;function jm(){if(IC)return lo;IC=1,Object.defineProperty(lo,"__esModule",{value:!0}),lo.CancellationTokenSource=lo.CancellationToken=void 0;const t=co(),e=Yu(),n=Ml();var r;(function(o){o.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:n.Event.None}),o.Cancelled=Object.freeze({isCancellationRequested:!0,
onCancellationRequested:n.Event.None});function l(c){const u=c;return u&&(u===o.None||u===o.Cancelled||e.boolean(u.isCancellationRequested)&&!!u.onCancellationRequested)}o.is=l})(r||(lo.CancellationToken=r={}));const i=Object.freeze(function(o,l){const c=(0,t.default)().timer.setTimeout(o.bind(l),0);return{dispose(){c.dispose()}}});class s{constructor(){this._isCancelled=!1}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){
return this._isCancelled}get onCancellationRequested(){return this._isCancelled?i:(this._emitter||(this._emitter=new n.Emitter),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=void 0)}}class a{get token(){return this._token||(this._token=new s),this._token}cancel(){this._token?this._token.cancel():this._token=r.Cancelled}dispose(){this._token?this._token instanceof s&&this._token.dispose():this._token=r.None}}return lo.CancellationTokenSource=a,lo}var Mt=jm();
function wK(){return new Promise(t=>{typeof setImmediate>"u"?setTimeout(t,0):setImmediate(t)})}let qm=0,bK=10;function kK(){return qm=performance.now(),new Mt.CancellationTokenSource}const Xu=Symbol("OperationCancelled");function da(t){return t===Xu}async function mn(t){if(t===Mt.CancellationToken.None)return;const e=performance.now();if(e-qm>=bK&&(qm=e,await wK(),qm=performance.now()),t.isCancellationRequested)throw Xu}class $k{constructor(){this.promise=new Promise((e,n)=>{this.resolve=r=>(e(r),
this),this.reject=r=>(n(r),this)})}}class mh{constructor(e,n,r,i){this._uri=e,this._languageId=n,this._version=r,this._content=i,this._lineOffsets=void 0}get uri(){return this._uri}get languageId(){return this._languageId}get version(){return this._version}getText(e){if(e){const n=this.offsetAt(e.start),r=this.offsetAt(e.end);return this._content.substring(n,r)}return this._content}update(e,n){for(const r of e)if(mh.isIncremental(r)){const i=OC(r.range),s=this.offsetAt(i.start),a=this.offsetAt(i.
end);this._content=this._content.substring(0,s)+r.text+this._content.substring(a,this._content.length);const o=Math.max(i.start.line,0),l=Math.max(i.end.line,0);let c=this._lineOffsets;const u=NC(r.text,!1,s);if(l-o===u.length)for(let f=0,p=u.length;f<p;f++)c[f+o+1]=u[f];else u.length<1e4?c.splice(o+1,l-o,...u):this._lineOffsets=c=c.slice(0,o+1).concat(u,c.slice(l+1));const d=r.text.length-(a-s);if(d!==0)for(let f=o+1+u.length,p=c.length;f<p;f++)c[f]=c[f]+d}else if(mh.isFull(r))this._content=r.text,
this._lineOffsets=void 0;else throw new Error("Unknown change event received");this._version=n}getLineOffsets(){return this._lineOffsets===void 0&&(this._lineOffsets=NC(this._content,!0)),this._lineOffsets}positionAt(e){e=Math.max(Math.min(e,this._content.length),0);const n=this.getLineOffsets();let r=0,i=n.length;if(i===0)return{line:0,character:e};for(;r<i;){const a=Math.floor((r+i)/2);n[a]>e?i=a:r=a+1}const s=r-1;return e=this.ensureBeforeEOL(e,n[s]),{line:s,character:e-n[s]}}offsetAt(e){const n=this.
getLineOffsets();if(e.line>=n.length)return this._content.length;if(e.line<0)return 0;const r=n[e.line];if(e.character<=0)return r;const i=e.line+1<n.length?n[e.line+1]:this._content.length,s=Math.min(r+e.character,i);return this.ensureBeforeEOL(s,r)}ensureBeforeEOL(e,n){for(;e>n&&DC(this._content.charCodeAt(e-1));)e--;return e}get lineCount(){return this.getLineOffsets().length}static isIncremental(e){const n=e;return n!=null&&typeof n.text=="string"&&n.range!==void 0&&(n.rangeLength===void 0||
typeof n.rangeLength=="number")}static isFull(e){const n=e;return n!=null&&typeof n.text=="string"&&n.range===void 0&&n.rangeLength===void 0}}var Fm;(function(t){function e(i,s,a,o){return new mh(i,s,a,o)}t.create=e;function n(i,s,a){if(i instanceof mh)return i.update(s,a),i;throw new Error("TextDocument.update: document must be created by TextDocument.create")}t.update=n;function r(i,s){const a=i.getText(),o=Tk(s.map(_K),(u,d)=>{const f=u.range.start.line-d.range.start.line;return f===0?u.range.
start.character-d.range.start.character:f});let l=0;const c=[];for(const u of o){const d=i.offsetAt(u.range.start);if(d<l)throw new Error("Overlapping edit");d>l&&c.push(a.substring(l,d)),u.newText.length&&c.push(u.newText),l=i.offsetAt(u.range.end)}return c.push(a.substr(l)),c.join("")}t.applyEdits=r})(Fm||(Fm={}));function Tk(t,e){if(t.length<=1)return t;const n=t.length/2|0,r=t.slice(0,n),i=t.slice(n);Tk(r,e),Tk(i,e);let s=0,a=0,o=0;for(;s<r.length&&a<i.length;)e(r[s],i[a])<=0?t[o++]=r[s++]:t[o++]=
i[a++];for(;s<r.length;)t[o++]=r[s++];for(;a<i.length;)t[o++]=i[a++];return t}function NC(t,e,n=0){const r=e?[n]:[];for(let i=0;i<t.length;i++){const s=t.charCodeAt(i);DC(s)&&(s===13&&i+1<t.length&&t.charCodeAt(i+1)===10&&i++,r.push(n+i+1))}return r}function DC(t){return t===13||t===10}function OC(t){const e=t.start,n=t.end;return e.line>n.line||e.line===n.line&&e.character>n.character?{start:n,end:e}:t}function _K(t){const e=OC(t.range);return e!==t.range?{newText:t.newText,range:e}:t}var LC;(()=>{
var t={975:L=>{function E(j){if(typeof j!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(j))}function $(j,U){for(var W,le="",ne=0,P=-1,M=0,J=0;J<=j.length;++J){if(J<j.length)W=j.charCodeAt(J);else{if(W===47)break;W=47}if(W===47){if(!(P===J-1||M===1))if(P!==J-1&&M===2){if(le.length<2||ne!==2||le.charCodeAt(le.length-1)!==46||le.charCodeAt(le.length-2)!==46){if(le.length>2){var G=le.lastIndexOf("/");if(G!==le.length-1){G===-1?(le="",ne=0):ne=(le=le.slice(0,G)).length-
1-le.lastIndexOf("/"),P=J,M=0;continue}}else if(le.length===2||le.length===1){le="",ne=0,P=J,M=0;continue}}U&&(le.length>0?le+="/..":le="..",ne=2)}else le.length>0?le+="/"+j.slice(P+1,J):le=j.slice(P+1,J),ne=J-P-1;P=J,M=0}else W===46&&M!==-1?++M:M=-1}return le}var z={resolve:function(){for(var j,U="",W=!1,le=arguments.length-1;le>=-1&&!W;le--){var ne;le>=0?ne=arguments[le]:(j===void 0&&(j=process.cwd()),ne=j),E(ne),ne.length!==0&&(U=ne+"/"+U,W=ne.charCodeAt(0)===47)}return U=$(U,!W),W?U.length>0?
"/"+U:"/":U.length>0?U:"."},normalize:function(j){if(E(j),j.length===0)return".";var U=j.charCodeAt(0)===47,W=j.charCodeAt(j.length-1)===47;return(j=$(j,!U)).length!==0||U||(j="."),j.length>0&&W&&(j+="/"),U?"/"+j:j},isAbsolute:function(j){return E(j),j.length>0&&j.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var j,U=0;U<arguments.length;++U){var W=arguments[U];E(W),W.length>0&&(j===void 0?j=W:j+="/"+W)}return j===void 0?".":z.normalize(j)},relative:function(j,U){if(E(
j),E(U),j===U||(j=z.resolve(j))===(U=z.resolve(U)))return"";for(var W=1;W<j.length&&j.charCodeAt(W)===47;++W);for(var le=j.length,ne=le-W,P=1;P<U.length&&U.charCodeAt(P)===47;++P);for(var M=U.length-P,J=ne<M?ne:M,G=-1,_=0;_<=J;++_){if(_===J){if(M>J){if(U.charCodeAt(P+_)===47)return U.slice(P+_+1);if(_===0)return U.slice(P+_)}else ne>J&&(j.charCodeAt(W+_)===47?G=_:_===0&&(G=0));break}var I=j.charCodeAt(W+_);if(I!==U.charCodeAt(P+_))break;I===47&&(G=_)}var Y="";for(_=W+G+1;_<=le;++_)_!==le&&j.charCodeAt(
_)!==47||(Y.length===0?Y+="..":Y+="/..");return Y.length>0?Y+U.slice(P+G):(P+=G,U.charCodeAt(P)===47&&++P,U.slice(P))},_makeLong:function(j){return j},dirname:function(j){if(E(j),j.length===0)return".";for(var U=j.charCodeAt(0),W=U===47,le=-1,ne=!0,P=j.length-1;P>=1;--P)if((U=j.charCodeAt(P))===47){if(!ne){le=P;break}}else ne=!1;return le===-1?W?"/":".":W&&le===1?"//":j.slice(0,le)},basename:function(j,U){if(U!==void 0&&typeof U!="string")throw new TypeError('"ext" argument must be a string');E(
j);var W,le=0,ne=-1,P=!0;if(U!==void 0&&U.length>0&&U.length<=j.length){if(U.length===j.length&&U===j)return"";var M=U.length-1,J=-1;for(W=j.length-1;W>=0;--W){var G=j.charCodeAt(W);if(G===47){if(!P){le=W+1;break}}else J===-1&&(P=!1,J=W+1),M>=0&&(G===U.charCodeAt(M)?--M==-1&&(ne=W):(M=-1,ne=J))}return le===ne?ne=J:ne===-1&&(ne=j.length),j.slice(le,ne)}for(W=j.length-1;W>=0;--W)if(j.charCodeAt(W)===47){if(!P){le=W+1;break}}else ne===-1&&(P=!1,ne=W+1);return ne===-1?"":j.slice(le,ne)},extname:function(j){
E(j);for(var U=-1,W=0,le=-1,ne=!0,P=0,M=j.length-1;M>=0;--M){var J=j.charCodeAt(M);if(J!==47)le===-1&&(ne=!1,le=M+1),J===46?U===-1?U=M:P!==1&&(P=1):U!==-1&&(P=-1);else if(!ne){W=M+1;break}}return U===-1||le===-1||P===0||P===1&&U===le-1&&U===W+1?"":j.slice(U,le)},format:function(j){if(j===null||typeof j!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof j);return(function(U,W){var le=W.dir||W.root,ne=W.base||(W.name||"")+(W.ext||"");return le?le===
W.root?le+ne:le+"/"+ne:ne})(0,j)},parse:function(j){E(j);var U={root:"",dir:"",base:"",ext:"",name:""};if(j.length===0)return U;var W,le=j.charCodeAt(0),ne=le===47;ne?(U.root="/",W=1):W=0;for(var P=-1,M=0,J=-1,G=!0,_=j.length-1,I=0;_>=W;--_)if((le=j.charCodeAt(_))!==47)J===-1&&(G=!1,J=_+1),le===46?P===-1?P=_:I!==1&&(I=1):P!==-1&&(I=-1);else if(!G){M=_+1;break}return P===-1||J===-1||I===0||I===1&&P===J-1&&P===M+1?J!==-1&&(U.base=U.name=M===0&&ne?j.slice(1,J):j.slice(M,J)):(M===0&&ne?(U.name=j.slice(
1,P),U.base=j.slice(1,J)):(U.name=j.slice(M,P),U.base=j.slice(M,J)),U.ext=j.slice(P,J)),M>0?U.dir=j.slice(0,M-1):ne&&(U.dir="/"),U},sep:"/",delimiter:":",win32:null,posix:null};z.posix=z,L.exports=z}},e={};function n(L){var E=e[L];if(E!==void 0)return E.exports;var $=e[L]={exports:{}};return t[L]($,$.exports,n),$.exports}n.d=(L,E)=>{for(var $ in E)n.o(E,$)&&!n.o(L,$)&&Object.defineProperty(L,$,{enumerable:!0,get:E[$]})},n.o=(L,E)=>Object.prototype.hasOwnProperty.call(L,E),n.r=L=>{typeof Symbol<"\
u"&&Symbol.toStringTag&&Object.defineProperty(L,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(L,"__esModule",{value:!0})};var r={};let i;n.r(r),n.d(r,{URI:()=>f,Utils:()=>ie}),typeof process=="object"?i=process.platform==="win32":typeof navigator=="object"&&(i=navigator.userAgent.indexOf("Windows")>=0);const s=/^\w[\w\d+.-]*$/,a=/^\//,o=/^\/\//;function l(L,E){if(!L.scheme&&E)throw new Error(`[UriError]: Scheme is missing: {scheme: "", authority: "${L.authority}", path: "${L.path}",\
 query: "${L.query}", fragment: "${L.fragment}"}`);if(L.scheme&&!s.test(L.scheme))throw new Error("[UriError]: Scheme contains illegal characters.");if(L.path){if(L.authority){if(!a.test(L.path))throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}else if(o.test(L.path))throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash chara\
cters ("//")')}}const c="",u="/",d=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/;class f{static isUri(E){return E instanceof f||!!E&&typeof E.authority=="string"&&typeof E.fragment=="string"&&typeof E.path=="string"&&typeof E.query=="string"&&typeof E.scheme=="string"&&typeof E.fsPath=="string"&&typeof E.with=="function"&&typeof E.toString=="function"}scheme;authority;path;query;fragment;constructor(E,$,z,j,U,W=!1){typeof E=="object"?(this.scheme=E.scheme||c,this.authority=E.authority||
c,this.path=E.path||c,this.query=E.query||c,this.fragment=E.fragment||c):(this.scheme=(function(le,ne){return le||ne?le:"file"})(E,W),this.authority=$||c,this.path=(function(le,ne){switch(le){case"https":case"http":case"file":ne?ne[0]!==u&&(ne=u+ne):ne=u}return ne})(this.scheme,z||c),this.query=j||c,this.fragment=U||c,l(this,W))}get fsPath(){return h(this)}with(E){if(!E)return this;let{scheme:$,authority:z,path:j,query:U,fragment:W}=E;return $===void 0?$=this.scheme:$===null&&($=c),z===void 0?z=
this.authority:z===null&&(z=c),j===void 0?j=this.path:j===null&&(j=c),U===void 0?U=this.query:U===null&&(U=c),W===void 0?W=this.fragment:W===null&&(W=c),$===this.scheme&&z===this.authority&&j===this.path&&U===this.query&&W===this.fragment?this:new m($,z,j,U,W)}static parse(E,$=!1){const z=d.exec(E);return z?new m(z[2]||c,T(z[4]||c),T(z[5]||c),T(z[7]||c),T(z[9]||c),$):new m(c,c,c,c,c)}static file(E){let $=c;if(i&&(E=E.replace(/\\/g,u)),E[0]===u&&E[1]===u){const z=E.indexOf(u,2);z===-1?($=E.substring(
2),E=u):($=E.substring(2,z),E=E.substring(z)||u)}return new m("file",$,E,c,c)}static from(E){const $=new m(E.scheme,E.authority,E.path,E.query,E.fragment);return l($,!0),$}toString(E=!1){return y(this,E)}toJSON(){return this}static revive(E){if(E){if(E instanceof f)return E;{const $=new m(E);return $._formatted=E.external,$._fsPath=E._sep===p?E.fsPath:null,$}}return E}}const p=i?1:void 0;class m extends f{_formatted=null;_fsPath=null;get fsPath(){return this._fsPath||(this._fsPath=h(this)),this.
_fsPath}toString(E=!1){return E?y(this,!0):(this._formatted||(this._formatted=y(this,!1)),this._formatted)}toJSON(){const E={$mid:1};return this._fsPath&&(E.fsPath=this._fsPath,E._sep=p),this._formatted&&(E.external=this._formatted),this.path&&(E.path=this.path),this.scheme&&(E.scheme=this.scheme),this.authority&&(E.authority=this.authority),this.query&&(E.query=this.query),this.fragment&&(E.fragment=this.fragment),E}}const w={58:"%3A",47:"%2F",63:"%3F",35:"%23",91:"%5B",93:"%5D",64:"%40",33:"%2\
1",36:"%24",38:"%26",39:"%27",40:"%28",41:"%29",42:"%2A",43:"%2B",44:"%2C",59:"%3B",61:"%3D",32:"%20"};function v(L,E,$){let z,j=-1;for(let U=0;U<L.length;U++){const W=L.charCodeAt(U);if(W>=97&&W<=122||W>=65&&W<=90||W>=48&&W<=57||W===45||W===46||W===95||W===126||E&&W===47||$&&W===91||$&&W===93||$&&W===58)j!==-1&&(z+=encodeURIComponent(L.substring(j,U)),j=-1),z!==void 0&&(z+=L.charAt(U));else{z===void 0&&(z=L.substr(0,U));const le=w[W];le!==void 0?(j!==-1&&(z+=encodeURIComponent(L.substring(j,U)),
j=-1),z+=le):j===-1&&(j=U)}}return j!==-1&&(z+=encodeURIComponent(L.substring(j))),z!==void 0?z:L}function g(L){let E;for(let $=0;$<L.length;$++){const z=L.charCodeAt($);z===35||z===63?(E===void 0&&(E=L.substr(0,$)),E+=w[z]):E!==void 0&&(E+=L[$])}return E!==void 0?E:L}function h(L,E){let $;return $=L.authority&&L.path.length>1&&L.scheme==="file"?`//${L.authority}${L.path}`:L.path.charCodeAt(0)===47&&(L.path.charCodeAt(1)>=65&&L.path.charCodeAt(1)<=90||L.path.charCodeAt(1)>=97&&L.path.charCodeAt(
1)<=122)&&L.path.charCodeAt(2)===58?L.path[1].toLowerCase()+L.path.substr(2):L.path,i&&($=$.replace(/\//g,"\\")),$}function y(L,E){const $=E?g:v;let z="",{scheme:j,authority:U,path:W,query:le,fragment:ne}=L;if(j&&(z+=j,z+=":"),(U||j==="file")&&(z+=u,z+=u),U){let P=U.indexOf("@");if(P!==-1){const M=U.substr(0,P);U=U.substr(P+1),P=M.lastIndexOf(":"),P===-1?z+=$(M,!1,!1):(z+=$(M.substr(0,P),!1,!1),z+=":",z+=$(M.substr(P+1),!1,!0)),z+="@"}U=U.toLowerCase(),P=U.lastIndexOf(":"),P===-1?z+=$(U,!1,!0):(z+=
$(U.substr(0,P),!1,!0),z+=U.substr(P))}if(W){if(W.length>=3&&W.charCodeAt(0)===47&&W.charCodeAt(2)===58){const P=W.charCodeAt(1);P>=65&&P<=90&&(W=`/${String.fromCharCode(P+32)}:${W.substr(3)}`)}else if(W.length>=2&&W.charCodeAt(1)===58){const P=W.charCodeAt(0);P>=65&&P<=90&&(W=`${String.fromCharCode(P+32)}:${W.substr(2)}`)}z+=$(W,!0,!1)}return le&&(z+="?",z+=$(le,!1,!1)),ne&&(z+="#",z+=E?ne:v(ne,!1,!1)),z}function b(L){try{return decodeURIComponent(L)}catch{return L.length>3?L.substr(0,3)+b(L.substr(
3)):L}}const R=/(%[0-9A-Za-z][0-9A-Za-z])+/g;function T(L){return L.match(R)?L.replace(R,(E=>b(E))):L}var N=n(975);const q=N.posix||N,B="/";var ie;(function(L){L.joinPath=function(E,...$){return E.with({path:q.join(E.path,...$)})},L.resolvePath=function(E,...$){let z=E.path,j=!1;z[0]!==B&&(z=B+z,j=!0);let U=q.resolve(z,...$);return j&&U[0]===B&&!E.authority&&(U=U.substring(1)),E.with({path:U})},L.dirname=function(E){if(E.path.length===0||E.path===B)return E;let $=q.dirname(E.path);return $.length===
1&&$.charCodeAt(0)===46&&($=""),E.with({path:$})},L.basename=function(E){return q.basename(E.path)},L.extname=function(E){return q.extname(E.path)}})(ie||(ie={})),LC=r})();const{URI:ot,Utils:Qu}=LC;var tt;(function(t){t.basename=Qu.basename,t.dirname=Qu.dirname,t.extname=Qu.extname,t.joinPath=Qu.joinPath,t.resolvePath=Qu.resolvePath;const e=typeof process=="object"&&(process==null?void 0:process.platform)==="win32";function n(s,a){return s?.toString()===a?.toString()}t.equals=n;function r(s,a){const o=typeof s==
"string"?ot.parse(s).path:s.path,l=typeof a=="string"?ot.parse(a).path:a.path,c=o.split("/").filter(m=>m.length>0),u=l.split("/").filter(m=>m.length>0);if(e){const m=/^[A-Z]:$/;if(c[0]&&m.test(c[0])&&(c[0]=c[0].toLowerCase()),u[0]&&m.test(u[0])&&(u[0]=u[0].toLowerCase()),c[0]!==u[0])return l.substring(1)}let d=0;for(;d<c.length&&c[d]===u[d];d++);const f="../".repeat(c.length-d),p=u.slice(d).join("/");return f+p}t.relative=r;function i(s){return ot.parse(s.toString()).toString()}t.normalize=i})(tt||
(tt={}));var Ve;(function(t){t[t.Changed=0]="Changed",t[t.Parsed=1]="Parsed",t[t.IndexedContent=2]="IndexedContent",t[t.ComputedScopes=3]="ComputedScopes",t[t.Linked=4]="Linked",t[t.IndexedReferences=5]="IndexedReferences",t[t.Validated=6]="Validated"})(Ve||(Ve={}));class RK{constructor(e){this.serviceRegistry=e.ServiceRegistry,this.textDocuments=e.workspace.TextDocuments,this.fileSystemProvider=e.workspace.FileSystemProvider}async fromUri(e,n=Mt.CancellationToken.None){const r=await this.fileSystemProvider.
readFile(e);return this.createAsync(e,r,n)}fromTextDocument(e,n,r){return n=n??ot.parse(e.uri),Mt.CancellationToken.is(r)?this.createAsync(n,e,r):this.create(n,e,r)}fromString(e,n,r){return Mt.CancellationToken.is(r)?this.createAsync(n,e,r):this.create(n,e,r)}fromModel(e,n){return this.create(n,{$model:e})}create(e,n,r){if(typeof n=="string"){const i=this.parse(e,n,r);return this.createLangiumDocument(i,e,void 0,n)}else if("$model"in n){const i={value:n.$model,parserErrors:[],lexerErrors:[]};return this.
createLangiumDocument(i,e)}else{const i=this.parse(e,n.getText(),r);return this.createLangiumDocument(i,e,n)}}async createAsync(e,n,r){if(typeof n=="string"){const i=await this.parseAsync(e,n,r);return this.createLangiumDocument(i,e,void 0,n)}else{const i=await this.parseAsync(e,n.getText(),r);return this.createLangiumDocument(i,e,n)}}createLangiumDocument(e,n,r,i){let s;if(r)s={parseResult:e,uri:n,state:Ve.Parsed,references:[],textDocument:r};else{const a=this.createTextDocumentGetter(n,i);s={parseResult:e,
uri:n,state:Ve.Parsed,references:[],get textDocument(){return a()}}}return e.value.$document=s,s}async update(e,n){var r,i;const s=(r=e.parseResult.value.$cstNode)===null||r===void 0?void 0:r.root.fullText,a=(i=this.textDocuments)===null||i===void 0?void 0:i.get(e.uri.toString()),o=a?a.getText():await this.fileSystemProvider.readFile(e.uri);if(a)Object.defineProperty(e,"textDocument",{value:a});else{const l=this.createTextDocumentGetter(e.uri,o);Object.defineProperty(e,"textDocument",{get:l})}return s!==
o&&(e.parseResult=await this.parseAsync(e.uri,o,n),e.parseResult.value.$document=e),e.state=Ve.Parsed,e}parse(e,n,r){return this.serviceRegistry.getServices(e).parser.LangiumParser.parse(n,r)}parseAsync(e,n,r){return this.serviceRegistry.getServices(e).parser.AsyncParser.parse(n,r)}createTextDocumentGetter(e,n){const r=this.serviceRegistry;let i;return()=>i??(i=Fm.create(e.toString(),r.getServices(e).LanguageMetaData.languageId,0,n??""))}}class MC{constructor(e){this.documentMap=new Map,this.langiumDocumentFactory=
e.workspace.LangiumDocumentFactory,this.serviceRegistry=e.ServiceRegistry}get all(){return dt(this.documentMap.values())}addDocument(e){const n=e.uri.toString();if(this.documentMap.has(n))throw new Error(`A document with the URI '${n}' is already present.`);this.documentMap.set(n,e)}getDocument(e){const n=e.toString();return this.documentMap.get(n)}async getOrCreateDocument(e,n){let r=this.getDocument(e);return r||(r=await this.langiumDocumentFactory.fromUri(e,n),this.addDocument(r),r)}createDocument(e,n,r){
if(r)return this.langiumDocumentFactory.fromString(n,e,r).then(i=>(this.addDocument(i),i));{const i=this.langiumDocumentFactory.fromString(n,e);return this.addDocument(i),i}}hasDocument(e){return this.documentMap.has(e.toString())}invalidateDocument(e){const n=e.toString(),r=this.documentMap.get(n);return r&&(this.serviceRegistry.getServices(e).references.Linker.unlink(r),r.state=Ve.Changed,r.precomputedScopes=void 0,r.diagnostics=void 0),r}deleteDocument(e){const n=e.toString(),r=this.documentMap.
get(n);return r&&(r.state=Ve.Changed,this.documentMap.delete(n)),r}}const Ek=Symbol("ref_resolving");class SK{constructor(e){this.reflection=e.shared.AstReflection,this.langiumDocuments=()=>e.shared.workspace.LangiumDocuments,this.scopeProvider=e.references.ScopeProvider,this.astNodeLocator=e.workspace.AstNodeLocator}async link(e,n=Mt.CancellationToken.None){for(const r of hs(e.parseResult.value))await mn(n),Mh(r).forEach(i=>this.doLink(i,e))}doLink(e,n){var r;const i=e.reference;if(i._ref===void 0){
i._ref=Ek;try{const s=this.getCandidate(e);if(Sh(s))i._ref=s;else if(i._nodeDescription=s,this.langiumDocuments().hasDocument(s.documentUri)){const a=this.loadAstNode(s);i._ref=a??this.createLinkingError(e,s)}else i._ref=void 0}catch(s){console.error(`An error occurred while resolving reference to '${i.$refText}':`,s);const a=(r=s.message)!==null&&r!==void 0?r:String(s);i._ref=Object.assign(Object.assign({},e),{message:`An error occurred while resolving reference to '${i.$refText}': ${a}`})}n.references.
push(i)}}unlink(e){for(const n of e.references)delete n._ref,delete n._nodeDescription;e.references=[]}getCandidate(e){const r=this.scopeProvider.getScope(e).getElement(e.reference.$refText);return r??this.createLinkingError(e)}buildReference(e,n,r,i){const s=this,a={$refNode:r,$refText:i,get ref(){var o;if(Xt(this._ref))return this._ref;if(MF(this._nodeDescription)){const l=s.loadAstNode(this._nodeDescription);this._ref=l??s.createLinkingError({reference:a,container:e,property:n},this._nodeDescription)}else if(this.
_ref===void 0){this._ref=Ek;const l=Lh(e).$document,c=s.getLinkedNode({reference:a,container:e,property:n});if(c.error&&l&&l.state<Ve.ComputedScopes)return this._ref=void 0;this._ref=(o=c.node)!==null&&o!==void 0?o:c.error,this._nodeDescription=c.descr,l?.references.push(this)}else if(this._ref===Ek)throw new Error(`Cyclic reference resolution detected: ${s.astNodeLocator.getAstNodePath(e)}/${n} (symbol '${i}')`);return Xt(this._ref)?this._ref:void 0},get $nodeDescription(){return this._nodeDescription},
get error(){return Sh(this._ref)?this._ref:void 0}};return a}getLinkedNode(e){var n;try{const r=this.getCandidate(e);if(Sh(r))return{error:r};const i=this.loadAstNode(r);return i?{node:i,descr:r}:{descr:r,error:this.createLinkingError(e,r)}}catch(r){console.error(`An error occurred while resolving reference to '${e.reference.$refText}':`,r);const i=(n=r.message)!==null&&n!==void 0?n:String(r);return{error:Object.assign(Object.assign({},e),{message:`An error occurred while resolving reference to \
'${e.reference.$refText}': ${i}`})}}}loadAstNode(e){if(e.node)return e.node;const n=this.langiumDocuments().getDocument(e.documentUri);if(n)return this.astNodeLocator.getAstNode(n.parseResult.value,e.path)}createLinkingError(e,n){const r=Lh(e.container).$document;r&&r.state<Ve.ComputedScopes&&console.warn(`Attempted reference resolution before document reached ComputedScopes state (${r.uri}).`);const i=this.reflection.getReferenceType(e);return Object.assign(Object.assign({},e),{message:`Could n\
ot resolve reference to ${i} named '${e.reference.$refText}'.`,targetDescription:n})}}function zm(t){return typeof t.name=="string"}class jC{getName(e){if(zm(e))return e.name}getNameNode(e){return Yn(e.$cstNode,"name")}}class $K{constructor(e){this.nameProvider=e.references.NameProvider,this.index=e.shared.workspace.IndexManager,this.nodeLocator=e.workspace.AstNodeLocator}findDeclaration(e){if(e){const n=H0(e),r=e.astNode;if(n&&r){const i=r[n.feature];if(Yr(i))return i.ref;if(Array.isArray(i)){for(const s of i)
if(Yr(s)&&s.$refNode&&s.$refNode.offset<=e.offset&&s.$refNode.end>=e.end)return s.ref}}if(r){const i=this.nameProvider.getNameNode(r);if(i&&(i===e||FF(e,i)))return r}}}findDeclarationNode(e){const n=this.findDeclaration(e);if(n?.$cstNode){const r=this.nameProvider.getNameNode(n);return r??n.$cstNode}}findReferences(e,n){const r=[];if(n.includeDeclaration){const s=this.getReferenceToSelf(e);s&&r.push(s)}let i=this.index.findAllReferences(e,this.nodeLocator.getAstNodePath(e));return n.documentUri&&
(i=i.filter(s=>tt.equals(s.sourceUri,n.documentUri))),r.push(...i),dt(r)}getReferenceToSelf(e){const n=this.nameProvider.getNameNode(e);if(n){const r=$t(e),i=this.nodeLocator.getAstNodePath(e);return{sourceUri:r.uri,sourcePath:i,targetUri:r.uri,targetPath:i,segment:Eh(n),local:!0}}}}class fo{constructor(e){if(this.map=new Map,e)for(const[n,r]of e)this.add(n,r)}get size(){return Nw.sum(dt(this.map.values()).map(e=>e.length))}clear(){this.map.clear()}delete(e,n){if(n===void 0)return this.map.delete(
e);{const r=this.map.get(e);if(r){const i=r.indexOf(n);if(i>=0)return r.length===1?this.map.delete(e):r.splice(i,1),!0}return!1}}get(e){var n;return(n=this.map.get(e))!==null&&n!==void 0?n:[]}has(e,n){if(n===void 0)return this.map.has(e);{const r=this.map.get(e);return r?r.indexOf(n)>=0:!1}}add(e,n){return this.map.has(e)?this.map.get(e).push(n):this.map.set(e,[n]),this}addAll(e,n){return this.map.has(e)?this.map.get(e).push(...n):this.map.set(e,Array.from(n)),this}forEach(e){this.map.forEach((n,r)=>n.
forEach(i=>e(i,r,this)))}[Symbol.iterator](){return this.entries().iterator()}entries(){return dt(this.map.entries()).flatMap(([e,n])=>n.map(r=>[e,r]))}keys(){return dt(this.map.keys())}values(){return dt(this.map.values()).flat()}entriesGroupedByKey(){return dt(this.map.entries())}}class qC{get size(){return this.map.size}constructor(e){if(this.map=new Map,this.inverse=new Map,e)for(const[n,r]of e)this.set(n,r)}clear(){this.map.clear(),this.inverse.clear()}set(e,n){return this.map.set(e,n),this.
inverse.set(n,e),this}get(e){return this.map.get(e)}getKey(e){return this.inverse.get(e)}delete(e){const n=this.map.get(e);return n!==void 0?(this.map.delete(e),this.inverse.delete(n),!0):!1}}class FC{constructor(e){this.nameProvider=e.references.NameProvider,this.descriptions=e.workspace.AstNodeDescriptionProvider}async computeExports(e,n=Mt.CancellationToken.None){return this.computeExportsForNode(e.parseResult.value,e,void 0,n)}async computeExportsForNode(e,n,r=$u,i=Mt.CancellationToken.None){
const s=[];this.exportNode(e,s,n);for(const a of r(e))await mn(i),this.exportNode(a,s,n);return s}exportNode(e,n,r){const i=this.nameProvider.getName(e);i&&n.push(this.descriptions.createDescription(e,i,r))}async computeLocalScopes(e,n=Mt.CancellationToken.None){const r=e.parseResult.value,i=new fo;for(const s of hi(r))await mn(n),this.processNode(s,e,i);return i}processNode(e,n,r){const i=e.$container;if(i){const s=this.nameProvider.getName(e);s&&r.add(i,this.descriptions.createDescription(e,s,
n))}}}class po{constructor(e,n,r){var i;this.elements=e,this.outerScope=n,this.caseInsensitive=(i=r?.caseInsensitive)!==null&&i!==void 0?i:!1}getAllElements(){return this.outerScope?this.elements.concat(this.outerScope.getAllElements()):this.elements}getElement(e){const n=this.caseInsensitive?this.elements.find(r=>r.name.toLowerCase()===e.toLowerCase()):this.elements.find(r=>r.name===e);if(n)return n;if(this.outerScope)return this.outerScope.getElement(e)}}class zC{constructor(e,n,r){var i;this.
elements=new Map,this.caseInsensitive=(i=r?.caseInsensitive)!==null&&i!==void 0?i:!1;for(const s of e){const a=this.caseInsensitive?s.name.toLowerCase():s.name;this.elements.set(a,s)}this.outerScope=n}getElement(e){const n=this.caseInsensitive?e.toLowerCase():e,r=this.elements.get(n);if(r)return r;if(this.outerScope)return this.outerScope.getElement(e)}getAllElements(){let e=dt(this.elements.values());return this.outerScope&&(e=e.concat(this.outerScope.getAllElements())),e}}const TK={getElement(){},
getAllElements(){return Bc}};class UC{constructor(){this.toDispose=[],this.isDisposed=!1}onDispose(e){this.toDispose.push(e)}dispose(){this.throwIfDisposed(),this.clear(),this.isDisposed=!0,this.toDispose.forEach(e=>e.dispose())}throwIfDisposed(){if(this.isDisposed)throw new Error("This cache has already been disposed")}}class EK extends UC{constructor(){super(...arguments),this.cache=new Map}has(e){return this.throwIfDisposed(),this.cache.has(e)}set(e,n){this.throwIfDisposed(),this.cache.set(e,
n)}get(e,n){if(this.throwIfDisposed(),this.cache.has(e))return this.cache.get(e);if(n){const r=n();return this.cache.set(e,r),r}else return}delete(e){return this.throwIfDisposed(),this.cache.delete(e)}clear(){this.throwIfDisposed(),this.cache.clear()}}class PK extends UC{constructor(e){super(),this.cache=new Map,this.converter=e??(n=>n)}has(e,n){return this.throwIfDisposed(),this.cacheForContext(e).has(n)}set(e,n,r){this.throwIfDisposed(),this.cacheForContext(e).set(n,r)}get(e,n,r){this.throwIfDisposed();
const i=this.cacheForContext(e);if(i.has(n))return i.get(n);if(r){const s=r();return i.set(n,s),s}else return}delete(e,n){return this.throwIfDisposed(),this.cacheForContext(e).delete(n)}clear(e){if(this.throwIfDisposed(),e){const n=this.converter(e);this.cache.delete(n)}else this.cache.clear()}cacheForContext(e){const n=this.converter(e);let r=this.cache.get(n);return r||(r=new Map,this.cache.set(n,r)),r}}class jl extends EK{constructor(e,n){super(),n?(this.toDispose.push(e.workspace.DocumentBuilder.
onBuildPhase(n,()=>{this.clear()})),this.toDispose.push(e.workspace.DocumentBuilder.onUpdate((r,i)=>{i.length>0&&this.clear()}))):this.toDispose.push(e.workspace.DocumentBuilder.onUpdate(()=>{this.clear()}))}}class HC{constructor(e){this.reflection=e.shared.AstReflection,this.nameProvider=e.references.NameProvider,this.descriptions=e.workspace.AstNodeDescriptionProvider,this.indexManager=e.shared.workspace.IndexManager,this.globalScopeCache=new jl(e.shared)}getScope(e){const n=[],r=this.reflection.
getReferenceType(e),i=$t(e.container).precomputedScopes;if(i){let a=e.container;do{const o=i.get(a);o.length>0&&n.push(dt(o).filter(l=>this.reflection.isSubtype(l.type,r))),a=a.$container}while(a)}let s=this.getGlobalScope(r,e);for(let a=n.length-1;a>=0;a--)s=this.createScope(n[a],s);return s}createScope(e,n,r){return new po(dt(e),n,r)}createScopeForNodes(e,n,r){const i=dt(e).map(s=>{const a=this.nameProvider.getName(s);if(a)return this.descriptions.createDescription(s,a)}).nonNullable();return new po(
i,n,r)}getGlobalScope(e,n){return this.globalScopeCache.get(e,()=>new zC(this.indexManager.allElements(e)))}}function VC(t){return typeof t.$comment=="string"}function BC(t){return typeof t=="object"&&!!t&&("$ref"in t||"$error"in t)}class CK{constructor(e){this.ignoreProperties=new Set(["$container","$containerProperty","$containerIndex","$document","$cstNode"]),this.langiumDocuments=e.shared.workspace.LangiumDocuments,this.astNodeLocator=e.workspace.AstNodeLocator,this.nameProvider=e.references.
NameProvider,this.commentProvider=e.documentation.CommentProvider}serialize(e,n){const r=n??{},i=n?.replacer,s=(o,l)=>this.replacer(o,l,r),a=i?(o,l)=>i(o,l,s):s;try{return this.currentDocument=$t(e),JSON.stringify(e,a,n?.space)}finally{this.currentDocument=void 0}}deserialize(e,n){const r=n??{},i=JSON.parse(e);return this.linkNode(i,i,r),i}replacer(e,n,{refText:r,sourceText:i,textRegions:s,comments:a,uriConverter:o}){var l,c,u,d;if(!this.ignoreProperties.has(e))if(Yr(n)){const f=n.ref,p=r?n.$refText:
void 0;if(f){const m=$t(f);let w="";this.currentDocument&&this.currentDocument!==m&&(o?w=o(m.uri,n):w=m.uri.toString());const v=this.astNodeLocator.getAstNodePath(f);return{$ref:`${w}#${v}`,$refText:p}}else return{$error:(c=(l=n.error)===null||l===void 0?void 0:l.message)!==null&&c!==void 0?c:"Could not resolve reference",$refText:p}}else if(Xt(n)){let f;if(s&&(f=this.addAstNodeRegionWithAssignmentsTo(Object.assign({},n)),(!e||n.$document)&&f?.$textRegion&&(f.$textRegion.documentURI=(u=this.currentDocument)===
null||u===void 0?void 0:u.uri.toString())),i&&!e&&(f??(f=Object.assign({},n)),f.$sourceText=(d=n.$cstNode)===null||d===void 0?void 0:d.text),a){f??(f=Object.assign({},n));const p=this.commentProvider.getComment(n);p&&(f.$comment=p.replace(/\r/g,""))}return f??n}else return n}addAstNodeRegionWithAssignmentsTo(e){const n=r=>({offset:r.offset,end:r.end,length:r.length,range:r.range});if(e.$cstNode){const r=e.$textRegion=n(e.$cstNode),i=r.assignments={};return Object.keys(e).filter(s=>!s.startsWith(
"$")).forEach(s=>{const a=_l(e.$cstNode,s).map(n);a.length!==0&&(i[s]=a)}),e}}linkNode(e,n,r,i,s,a){for(const[l,c]of Object.entries(e))if(Array.isArray(c))for(let u=0;u<c.length;u++){const d=c[u];BC(d)?c[u]=this.reviveReference(e,l,n,d,r):Xt(d)&&this.linkNode(d,n,r,e,l,u)}else BC(c)?e[l]=this.reviveReference(e,l,n,c,r):Xt(c)&&this.linkNode(c,n,r,e,l);const o=e;o.$container=i,o.$containerProperty=s,o.$containerIndex=a}reviveReference(e,n,r,i,s){let a=i.$refText,o=i.$error;if(i.$ref){const l=this.
getRefNode(r,i.$ref,s.uriConverter);if(Xt(l))return a||(a=this.nameProvider.getName(l)),{$refText:a??"",ref:l};o=l}if(o){const l={$refText:a??""};return l.error={container:e,property:n,message:o,reference:l},l}else return}getRefNode(e,n,r){try{const i=n.indexOf("#");if(i===0){const l=this.astNodeLocator.getAstNode(e,n.substring(1));return l||"Could not resolve path: "+n}if(i<0){const l=r?r(n):ot.parse(n),c=this.langiumDocuments.getDocument(l);return c?c.parseResult.value:"Could not find document\
 for URI: "+n}const s=r?r(n.substring(0,i)):ot.parse(n.substring(0,i)),a=this.langiumDocuments.getDocument(s);if(!a)return"Could not find document for URI: "+n;if(i===n.length-1)return a.parseResult.value;const o=this.astNodeLocator.getAstNode(a.parseResult.value,n.substring(i+1));return o||"Could not resolve URI: "+n}catch(i){return String(i)}}}class xK{get map(){return this.fileExtensionMap}constructor(e){this.languageIdMap=new Map,this.fileExtensionMap=new Map,this.fileNameMap=new Map,this.textDocuments=
e?.workspace.TextDocuments}register(e){const n=e.LanguageMetaData;for(const r of n.fileExtensions)this.fileExtensionMap.has(r)&&console.warn(`The file extension ${r} is used by multiple languages. It is now assigned to '${n.languageId}'.`),this.fileExtensionMap.set(r,e);if(n.fileNames)for(const r of n.fileNames)this.fileNameMap.has(r)&&console.warn(`The file name ${r} is used by multiple languages. It is now assigned to '${n.languageId}'.`),this.fileNameMap.set(r,e);this.languageIdMap.set(n.languageId,
e),this.languageIdMap.size===1?this.singleton=e:this.singleton=void 0}getServices(e){var n,r,i;if(this.singleton!==void 0)return this.singleton;if(this.languageIdMap.size===0)throw new Error("The service registry is empty. Use `register` to register the services of a language.");const s=(r=(n=this.textDocuments)===null||n===void 0?void 0:n.get(e))===null||r===void 0?void 0:r.languageId;if(s!==void 0){const c=this.languageIdMap.get(s);if(c)return c}const a=tt.extname(e),o=tt.basename(e),l=(i=this.
fileNameMap.get(o))!==null&&i!==void 0?i:this.fileExtensionMap.get(a);if(!l)throw s?new Error(`The service registry contains no services for the extension '${a}' for language '${s}'.`):new Error(`The service registry contains no services for the extension '${a}'.`);return l}hasServices(e){try{return this.getServices(e),!0}catch{return!1}}get all(){return Array.from(this.languageIdMap.values())}}function ed(t){return{code:t}}var Um;(function(t){t.all=["fast","slow","built-in"]})(Um||(Um={}));class AK{constructor(e){
this.entries=new fo,this.entriesBefore=[],this.entriesAfter=[],this.reflection=e.shared.AstReflection}register(e,n=this,r="fast"){if(r==="built-in")throw new Error("The 'built-in' category is reserved for lexer, parser, and linker errors.");for(const[i,s]of Object.entries(e)){const a=s;if(Array.isArray(a))for(const o of a){const l={check:this.wrapValidationException(o,n),category:r};this.addEntry(i,l)}else if(typeof a=="function"){const o={check:this.wrapValidationException(a,n),category:r};this.
addEntry(i,o)}else Gc()}}wrapValidationException(e,n){return async(r,i,s)=>{await this.handleException(()=>e.call(n,r,i,s),"An error occurred during validation",i,r)}}async handleException(e,n,r,i){try{await e()}catch(s){if(da(s))throw s;console.error(`${n}:`,s),s instanceof Error&&s.stack&&console.error(s.stack);const a=s instanceof Error?s.message:String(s);r("error",`${n}: ${a}`,{node:i})}}addEntry(e,n){if(e==="AstNode"){this.entries.add("AstNode",n);return}for(const r of this.reflection.getAllSubTypes(
e))this.entries.add(r,n)}getChecks(e,n){let r=dt(this.entries.get(e)).concat(this.entries.get("AstNode"));return n&&(r=r.filter(i=>n.includes(i.category))),r.map(i=>i.check)}registerBeforeDocument(e,n=this){this.entriesBefore.push(this.wrapPreparationException(e,"An error occurred during set-up of the validation",n))}registerAfterDocument(e,n=this){this.entriesAfter.push(this.wrapPreparationException(e,"An error occurred during tear-down of the validation",n))}wrapPreparationException(e,n,r){return async(i,s,a,o)=>{
await this.handleException(()=>e.call(r,i,s,a,o),n,s,i)}}get checksBefore(){return this.entriesBefore}get checksAfter(){return this.entriesAfter}}class WC{constructor(e){this.validationRegistry=e.validation.ValidationRegistry,this.metadata=e.LanguageMetaData}async validateDocument(e,n={},r=Mt.CancellationToken.None){const i=e.parseResult,s=[];if(await mn(r),(!n.categories||n.categories.includes("built-in"))&&(this.processLexingErrors(i,s,n),n.stopAfterLexingErrors&&s.some(a=>{var o;return((o=a.data)===
null||o===void 0?void 0:o.code)===ki.LexingError})||(this.processParsingErrors(i,s,n),n.stopAfterParsingErrors&&s.some(a=>{var o;return((o=a.data)===null||o===void 0?void 0:o.code)===ki.ParsingError}))||(this.processLinkingErrors(e,s,n),n.stopAfterLinkingErrors&&s.some(a=>{var o;return((o=a.data)===null||o===void 0?void 0:o.code)===ki.LinkingError}))))return s;try{s.push(...await this.validateAst(i.value,n,r))}catch(a){if(da(a))throw a;console.error("An error occurred during validation:",a)}return await mn(
r),s}processLexingErrors(e,n,r){var i,s,a;const o=[...e.lexerErrors,...(s=(i=e.lexerReport)===null||i===void 0?void 0:i.diagnostics)!==null&&s!==void 0?s:[]];for(const l of o){const c=(a=l.severity)!==null&&a!==void 0?a:"error",u={severity:Pk(c),range:{start:{line:l.line-1,character:l.column-1},end:{line:l.line-1,character:l.column+l.length-1}},message:l.message,data:NK(c),source:this.getSource()};n.push(u)}}processParsingErrors(e,n,r){for(const i of e.parserErrors){let s;if(isNaN(i.token.startOffset)){
if("previousToken"in i){const a=i.previousToken;if(isNaN(a.startOffset)){const o={line:0,character:0};s={start:o,end:o}}else{const o={line:a.endLine-1,character:a.endColumn};s={start:o,end:o}}}}else s=Dw(i.token);if(s){const a={severity:Pk("error"),range:s,message:i.message,data:ed(ki.ParsingError),source:this.getSource()};n.push(a)}}}processLinkingErrors(e,n,r){for(const i of e.references){const s=i.error;if(s){const a={node:s.container,property:s.property,index:s.index,data:{code:ki.LinkingError,
containerType:s.container.$type,property:s.property,refText:s.reference.$refText}};n.push(this.toDiagnostic("error",s.message,a))}}}async validateAst(e,n,r=Mt.CancellationToken.None){const i=[],s=(a,o,l)=>{i.push(this.toDiagnostic(a,o,l))};return await this.validateAstBefore(e,n,s,r),await this.validateAstNodes(e,n,s,r),await this.validateAstAfter(e,n,s,r),i}async validateAstBefore(e,n,r,i=Mt.CancellationToken.None){var s;const a=this.validationRegistry.checksBefore;for(const o of a)await mn(i),
await o(e,r,(s=n.categories)!==null&&s!==void 0?s:[],i)}async validateAstNodes(e,n,r,i=Mt.CancellationToken.None){await Promise.all(hs(e).map(async s=>{await mn(i);const a=this.validationRegistry.getChecks(s.$type,n.categories);for(const o of a)await o(s,r,i)}))}async validateAstAfter(e,n,r,i=Mt.CancellationToken.None){var s;const a=this.validationRegistry.checksAfter;for(const o of a)await mn(i),await o(e,r,(s=n.categories)!==null&&s!==void 0?s:[],i)}toDiagnostic(e,n,r){return{message:n,range:IK(
r),severity:Pk(e),code:r.code,codeDescription:r.codeDescription,tags:r.tags,relatedInformation:r.relatedInformation,data:r.data,source:this.getSource()}}getSource(){return this.metadata.languageId}}function IK(t){if(t.range)return t.range;let e;return typeof t.property=="string"?e=Yn(t.node.$cstNode,t.property,t.index):typeof t.keyword=="string"&&(e=Eu(t.node.$cstNode,t.keyword,t.index)),e??(e=t.node.$cstNode),e?e.range:{start:{line:0,character:0},end:{line:0,character:0}}}function Pk(t){switch(t){case"\
error":return 1;case"warning":return 2;case"info":return 3;case"hint":return 4;default:throw new Error("Invalid diagnostic severity: "+t)}}function NK(t){switch(t){case"error":return ed(ki.LexingError);case"warning":return ed(ki.LexingWarning);case"info":return ed(ki.LexingInfo);case"hint":return ed(ki.LexingHint);default:throw new Error("Invalid diagnostic severity: "+t)}}var ki;(function(t){t.LexingError="lexing-error",t.LexingWarning="lexing-warning",t.LexingInfo="lexing-info",t.LexingHint="l\
exing-hint",t.ParsingError="parsing-error",t.LinkingError="linking-error"})(ki||(ki={}));class GC{constructor(e){this.astNodeLocator=e.workspace.AstNodeLocator,this.nameProvider=e.references.NameProvider}createDescription(e,n,r){const i=r??$t(e);n??(n=this.nameProvider.getName(e));const s=this.astNodeLocator.getAstNodePath(e);if(!n)throw new Error(`Node at path ${s} has no name.`);let a;const o=()=>{var l;return a??(a=Eh((l=this.nameProvider.getNameNode(e))!==null&&l!==void 0?l:e.$cstNode))};return{
node:e,name:n,get nameSegment(){return o()},selectionSegment:Eh(e.$cstNode),type:e.$type,documentUri:i.uri,path:s}}}class DK{constructor(e){this.nodeLocator=e.workspace.AstNodeLocator}async createDescriptions(e,n=Mt.CancellationToken.None){const r=[],i=e.parseResult.value;for(const s of hs(i))await mn(n),Mh(s).filter(a=>!Sh(a)).forEach(a=>{const o=this.createDescription(a);o&&r.push(o)});return r}createDescription(e){const n=e.reference.$nodeDescription,r=e.reference.$refNode;if(!n||!r)return;const i=$t(
e.container).uri;return{sourceUri:i,sourcePath:this.nodeLocator.getAstNodePath(e.container),targetUri:n.documentUri,targetPath:n.path,segment:Eh(r),local:tt.equals(n.documentUri,i)}}}class OK{constructor(){this.segmentSeparator="/",this.indexSeparator="@"}getAstNodePath(e){if(e.$container){const n=this.getAstNodePath(e.$container),r=this.getPathSegment(e);return n+this.segmentSeparator+r}return""}getPathSegment({$containerProperty:e,$containerIndex:n}){if(!e)throw new Error("Missing '$containerP\
roperty' in AST node.");return n!==void 0?e+this.indexSeparator+n:e}getAstNode(e,n){return n.split(this.segmentSeparator).reduce((i,s)=>{if(!i||s.length===0)return i;const a=s.indexOf(this.indexSeparator);if(a>0){const o=s.substring(0,a),l=parseInt(s.substring(a+1)),c=i[o];return c?.[l]}return i[s]},e)}}var LK=Ml();class MK{constructor(e){this._ready=new $k,this.settings={},this.workspaceConfig=!1,this.onConfigurationSectionUpdateEmitter=new LK.Emitter,this.serviceRegistry=e.ServiceRegistry}get ready(){
return this._ready.promise}initialize(e){var n,r;this.workspaceConfig=(r=(n=e.capabilities.workspace)===null||n===void 0?void 0:n.configuration)!==null&&r!==void 0?r:!1}async initialized(e){if(this.workspaceConfig){if(e.register){const n=this.serviceRegistry.all;e.register({section:n.map(r=>this.toSectionName(r.LanguageMetaData.languageId))})}if(e.fetchConfiguration){const n=this.serviceRegistry.all.map(i=>({section:this.toSectionName(i.LanguageMetaData.languageId)})),r=await e.fetchConfiguration(
n);n.forEach((i,s)=>{this.updateSectionConfiguration(i.section,r[s])})}}this._ready.resolve()}updateConfiguration(e){e.settings&&Object.keys(e.settings).forEach(n=>{const r=e.settings[n];this.updateSectionConfiguration(n,r),this.onConfigurationSectionUpdateEmitter.fire({section:n,configuration:r})})}updateSectionConfiguration(e,n){this.settings[e]=n}async getConfiguration(e,n){await this.ready;const r=this.toSectionName(e);if(this.settings[r])return this.settings[r][n]}toSectionName(e){return`${e}`}get onConfigurationSectionUpdate(){
return this.onConfigurationSectionUpdateEmitter.event}}var ho;(function(t){function e(n){return{dispose:async()=>await n()}}t.create=e})(ho||(ho={}));class jK{constructor(e){this.updateBuildOptions={validation:{categories:["built-in","fast"]}},this.updateListeners=[],this.buildPhaseListeners=new fo,this.documentPhaseListeners=new fo,this.buildState=new Map,this.documentBuildWaiters=new Map,this.currentState=Ve.Changed,this.langiumDocuments=e.workspace.LangiumDocuments,this.langiumDocumentFactory=
e.workspace.LangiumDocumentFactory,this.textDocuments=e.workspace.TextDocuments,this.indexManager=e.workspace.IndexManager,this.serviceRegistry=e.ServiceRegistry}async build(e,n={},r=Mt.CancellationToken.None){var i,s;for(const a of e){const o=a.uri.toString();if(a.state===Ve.Validated){if(typeof n.validation=="boolean"&&n.validation)a.state=Ve.IndexedReferences,a.diagnostics=void 0,this.buildState.delete(o);else if(typeof n.validation=="object"){const l=this.buildState.get(o),c=(i=l?.result)===
null||i===void 0?void 0:i.validationChecks;if(c){const d=((s=n.validation.categories)!==null&&s!==void 0?s:Um.all).filter(f=>!c.includes(f));d.length>0&&(this.buildState.set(o,{completed:!1,options:{validation:Object.assign(Object.assign({},n.validation),{categories:d})},result:l.result}),a.state=Ve.IndexedReferences)}}}else this.buildState.delete(o)}this.currentState=Ve.Changed,await this.emitUpdate(e.map(a=>a.uri),[]),await this.buildDocuments(e,n,r)}async update(e,n,r=Mt.CancellationToken.None){
this.currentState=Ve.Changed;for(const a of n)this.langiumDocuments.deleteDocument(a),this.buildState.delete(a.toString()),this.indexManager.remove(a);for(const a of e){if(!this.langiumDocuments.invalidateDocument(a)){const l=this.langiumDocumentFactory.fromModel({$type:"INVALID"},a);l.state=Ve.Changed,this.langiumDocuments.addDocument(l)}this.buildState.delete(a.toString())}const i=dt(e).concat(n).map(a=>a.toString()).toSet();this.langiumDocuments.all.filter(a=>!i.has(a.uri.toString())&&this.shouldRelink(
a,i)).forEach(a=>{this.serviceRegistry.getServices(a.uri).references.Linker.unlink(a),a.state=Math.min(a.state,Ve.ComputedScopes),a.diagnostics=void 0}),await this.emitUpdate(e,n),await mn(r);const s=this.sortDocuments(this.langiumDocuments.all.filter(a=>{var o;return a.state<Ve.Linked||!(!((o=this.buildState.get(a.uri.toString()))===null||o===void 0)&&o.completed)}).toArray());await this.buildDocuments(s,this.updateBuildOptions,r)}async emitUpdate(e,n){await Promise.all(this.updateListeners.map(
r=>r(e,n)))}sortDocuments(e){let n=0,r=e.length-1;for(;n<r;){for(;n<e.length&&this.hasTextDocument(e[n]);)n++;for(;r>=0&&!this.hasTextDocument(e[r]);)r--;n<r&&([e[n],e[r]]=[e[r],e[n]])}return e}hasTextDocument(e){var n;return!!(!((n=this.textDocuments)===null||n===void 0)&&n.get(e.uri))}shouldRelink(e,n){return e.references.some(r=>r.error!==void 0)?!0:this.indexManager.isAffected(e,n)}onUpdate(e){return this.updateListeners.push(e),ho.create(()=>{const n=this.updateListeners.indexOf(e);n>=0&&this.
updateListeners.splice(n,1)})}async buildDocuments(e,n,r){this.prepareBuild(e,n),await this.runCancelable(e,Ve.Parsed,r,a=>this.langiumDocumentFactory.update(a,r)),await this.runCancelable(e,Ve.IndexedContent,r,a=>this.indexManager.updateContent(a,r)),await this.runCancelable(e,Ve.ComputedScopes,r,async a=>{const o=this.serviceRegistry.getServices(a.uri).references.ScopeComputation;a.precomputedScopes=await o.computeLocalScopes(a,r)});const i=e.filter(a=>this.shouldLink(a));await this.runCancelable(
i,Ve.Linked,r,a=>this.serviceRegistry.getServices(a.uri).references.Linker.link(a,r)),await this.runCancelable(i,Ve.IndexedReferences,r,a=>this.indexManager.updateReferences(a,r));const s=e.filter(a=>this.shouldValidate(a));await this.runCancelable(s,Ve.Validated,r,a=>this.validate(a,r));for(const a of e){const o=this.buildState.get(a.uri.toString());o&&(o.completed=!0)}}prepareBuild(e,n){for(const r of e){const i=r.uri.toString(),s=this.buildState.get(i);(!s||s.completed)&&this.buildState.set(i,
{completed:!1,options:n,result:s?.result})}}async runCancelable(e,n,r,i){const s=e.filter(o=>o.state<n);for(const o of s)await mn(r),await i(o),o.state=n,await this.notifyDocumentPhase(o,n,r);const a=e.filter(o=>o.state===n);await this.notifyBuildPhase(a,n,r),this.currentState=n}onBuildPhase(e,n){return this.buildPhaseListeners.add(e,n),ho.create(()=>{this.buildPhaseListeners.delete(e,n)})}onDocumentPhase(e,n){return this.documentPhaseListeners.add(e,n),ho.create(()=>{this.documentPhaseListeners.
delete(e,n)})}waitUntil(e,n,r){let i;if(n&&"path"in n?i=n:r=n,r??(r=Mt.CancellationToken.None),i){const s=this.langiumDocuments.getDocument(i);if(s&&s.state>=e)return Promise.resolve(i)}return this.currentState>=e?Promise.resolve(void 0):r.isCancellationRequested?Promise.reject(Xu):new Promise((s,a)=>{const o=this.onBuildPhase(e,()=>{if(o.dispose(),l.dispose(),i){const c=this.langiumDocuments.getDocument(i);s(c?.uri)}else s(void 0)}),l=r.onCancellationRequested(()=>{o.dispose(),l.dispose(),a(Xu)})})}async notifyDocumentPhase(e,n,r){
const s=this.documentPhaseListeners.get(n).slice();for(const a of s)try{await a(e,r)}catch(o){if(!da(o))throw o}}async notifyBuildPhase(e,n,r){if(e.length===0)return;const s=this.buildPhaseListeners.get(n).slice();for(const a of s)await mn(r),await a(e,r)}shouldLink(e){var n;return(n=this.getBuildOptions(e).eagerLinking)!==null&&n!==void 0?n:!0}shouldValidate(e){return!!this.getBuildOptions(e).validation}async validate(e,n){var r,i;const s=this.serviceRegistry.getServices(e.uri).validation.DocumentValidator,
a=this.getBuildOptions(e).validation,o=typeof a=="object"?a:void 0,l=await s.validateDocument(e,o,n);e.diagnostics?e.diagnostics.push(...l):e.diagnostics=l;const c=this.buildState.get(e.uri.toString());if(c){(r=c.result)!==null&&r!==void 0||(c.result={});const u=(i=o?.categories)!==null&&i!==void 0?i:Um.all;c.result.validationChecks?c.result.validationChecks.push(...u):c.result.validationChecks=[...u]}}getBuildOptions(e){var n,r;return(r=(n=this.buildState.get(e.uri.toString()))===null||n===void 0?
void 0:n.options)!==null&&r!==void 0?r:{}}}class KC{constructor(e){this.symbolIndex=new Map,this.symbolByTypeIndex=new PK,this.referenceIndex=new Map,this.documents=e.workspace.LangiumDocuments,this.serviceRegistry=e.ServiceRegistry,this.astReflection=e.AstReflection}findAllReferences(e,n){const r=$t(e).uri,i=[];return this.referenceIndex.forEach(s=>{s.forEach(a=>{tt.equals(a.targetUri,r)&&a.targetPath===n&&i.push(a)})}),dt(i)}allElements(e,n){let r=dt(this.symbolIndex.keys());return n&&(r=r.filter(
i=>!n||n.has(i))),r.map(i=>this.getFileDescriptions(i,e)).flat()}getFileDescriptions(e,n){var r;return n?this.symbolByTypeIndex.get(e,n,()=>{var s;return((s=this.symbolIndex.get(e))!==null&&s!==void 0?s:[]).filter(o=>this.astReflection.isSubtype(o.type,n))}):(r=this.symbolIndex.get(e))!==null&&r!==void 0?r:[]}remove(e){const n=e.toString();this.symbolIndex.delete(n),this.symbolByTypeIndex.clear(n),this.referenceIndex.delete(n)}async updateContent(e,n=Mt.CancellationToken.None){const i=await this.
serviceRegistry.getServices(e.uri).references.ScopeComputation.computeExports(e,n),s=e.uri.toString();this.symbolIndex.set(s,i),this.symbolByTypeIndex.clear(s)}async updateReferences(e,n=Mt.CancellationToken.None){const i=await this.serviceRegistry.getServices(e.uri).workspace.ReferenceDescriptionProvider.createDescriptions(e,n);this.referenceIndex.set(e.uri.toString(),i)}isAffected(e,n){const r=this.referenceIndex.get(e.uri.toString());return r?r.some(i=>!i.local&&n.has(i.targetUri.toString())):
!1}}class ZC{constructor(e){this.initialBuildOptions={},this._ready=new $k,this.serviceRegistry=e.ServiceRegistry,this.langiumDocuments=e.workspace.LangiumDocuments,this.documentBuilder=e.workspace.DocumentBuilder,this.fileSystemProvider=e.workspace.FileSystemProvider,this.mutex=e.workspace.WorkspaceLock}get ready(){return this._ready.promise}get workspaceFolders(){return this.folders}initialize(e){var n;this.folders=(n=e.workspaceFolders)!==null&&n!==void 0?n:void 0}initialized(e){return this.mutex.
write(n=>{var r;return this.initializeWorkspace((r=this.folders)!==null&&r!==void 0?r:[],n)})}async initializeWorkspace(e,n=Mt.CancellationToken.None){const r=await this.performStartup(e);await mn(n),await this.documentBuilder.build(r,this.initialBuildOptions,n)}async performStartup(e){const n=this.serviceRegistry.all.flatMap(a=>a.LanguageMetaData.fileExtensions),r=this.serviceRegistry.all.flatMap(a=>{var o;return(o=a.LanguageMetaData.fileNames)!==null&&o!==void 0?o:[]}),i=[],s=a=>{i.push(a),this.
langiumDocuments.hasDocument(a.uri)||this.langiumDocuments.addDocument(a)};return await this.loadAdditionalDocuments(e,s),await Promise.all(e.map(a=>[a,this.getRootFolder(a)]).map(async a=>this.traverseFolder(...a,{fileExtensions:n,fileNames:r},s))),this._ready.resolve(),i}loadAdditionalDocuments(e,n){return Promise.resolve()}getRootFolder(e){return ot.parse(e.uri)}async traverseFolder(e,n,r,i){const s=await this.fileSystemProvider.readDirectory(n);await Promise.all(s.map(async a=>{if(this.includeEntry(
e,a,r)){if(a.isDirectory)await this.traverseFolder(e,a.uri,r,i);else if(a.isFile){const o=await this.langiumDocuments.getOrCreateDocument(a.uri);i(o)}}}))}includeEntry(e,n,r){const i=tt.basename(n.uri);return i.startsWith(".")?!1:n.isDirectory?i!=="node_modules"&&i!=="out":n.isFile?r.fileExtensions.includes(tt.extname(n.uri))||r.fileNames.includes(tt.basename(n.uri)):!1}}class qK{buildUnexpectedCharactersMessage(e,n,r,i,s){return jb.buildUnexpectedCharactersMessage(e,n,r,i,s)}buildUnableToPopLexerModeMessage(e){
return jb.buildUnableToPopLexerModeMessage(e)}}const FK={mode:"full"};class zK{constructor(e){this.errorMessageProvider=e.parser.LexerErrorMessageProvider,this.tokenBuilder=e.parser.TokenBuilder;const n=this.tokenBuilder.buildTokens(e.Grammar,{caseInsensitive:e.LanguageMetaData.caseInsensitive});this.tokenTypes=this.toTokenTypeDictionary(n);const r=YC(n)?Object.values(n):n,i=e.LanguageMetaData.mode==="production";this.chevrotainLexer=new _r(r,{positionTracking:"full",skipValidations:i,errorMessageProvider:this.
errorMessageProvider})}get definition(){return this.tokenTypes}tokenize(e,n=FK){var r,i,s;const a=this.chevrotainLexer.tokenize(e);return{tokens:a.tokens,errors:a.errors,hidden:(r=a.groups.hidden)!==null&&r!==void 0?r:[],report:(s=(i=this.tokenBuilder).flushLexingReport)===null||s===void 0?void 0:s.call(i,e)}}toTokenTypeDictionary(e){if(YC(e))return e;const n=JC(e)?Object.values(e.modes).flat():e,r={};return n.forEach(i=>r[i.name]=i),r}}function UK(t){return Array.isArray(t)&&(t.length===0||"nam\
e"in t[0])}function JC(t){return t&&"modes"in t&&"defaultMode"in t}function YC(t){return!UK(t)&&!JC(t)}function XC(t,e,n){let r,i;typeof t=="string"?(i=e,r=n):(i=t.range.start,r=e),i||(i=Rt.create(0,0));const s=ex(t),a=xk(r),o=VK({lines:s,position:i,options:a});return ZK({index:0,tokens:o,position:i})}function QC(t,e){const n=xk(e),r=ex(t);if(r.length===0)return!1;const i=r[0],s=r[r.length-1],a=n.start,o=n.end;return!!a?.exec(i)&&!!o?.exec(s)}function ex(t){let e="";return typeof t=="string"?e=t:
e=t.text,e.split(j0)}const tx=/\s*(@([\p{L}][\p{L}\p{N}]*)?)/uy,HK=/\{(@[\p{L}][\p{L}\p{N}]*)(\s*)([^\r\n}]+)?\}/gu;function VK(t){var e,n,r;const i=[];let s=t.position.line,a=t.position.character;for(let o=0;o<t.lines.length;o++){const l=o===0,c=o===t.lines.length-1;let u=t.lines[o],d=0;if(l&&t.options.start){const p=(e=t.options.start)===null||e===void 0?void 0:e.exec(u);p&&(d=p.index+p[0].length)}else{const p=(n=t.options.line)===null||n===void 0?void 0:n.exec(u);p&&(d=p.index+p[0].length)}if(c){
const p=(r=t.options.end)===null||r===void 0?void 0:r.exec(u);p&&(u=u.substring(0,p.index))}if(u=u.substring(0,KK(u)),Ck(u,d)>=u.length){if(i.length>0){const p=Rt.create(s,a);i.push({type:"break",content:"",range:ft.create(p,p)})}}else{tx.lastIndex=d;const p=tx.exec(u);if(p){const m=p[0],w=p[1],v=Rt.create(s,a+d),g=Rt.create(s,a+d+m.length);i.push({type:"tag",content:w,range:ft.create(v,g)}),d+=m.length,d=Ck(u,d)}if(d<u.length){const m=u.substring(d),w=Array.from(m.matchAll(HK));i.push(...BK(w,m,
s,a+d))}}s++,a=0}return i.length>0&&i[i.length-1].type==="break"?i.slice(0,-1):i}function BK(t,e,n,r){const i=[];if(t.length===0){const s=Rt.create(n,r),a=Rt.create(n,r+e.length);i.push({type:"text",content:e,range:ft.create(s,a)})}else{let s=0;for(const o of t){const l=o.index,c=e.substring(s,l);c.length>0&&i.push({type:"text",content:e.substring(s,l),range:ft.create(Rt.create(n,s+r),Rt.create(n,l+r))});let u=c.length+1;const d=o[1];if(i.push({type:"inline-tag",content:d,range:ft.create(Rt.create(
n,s+u+r),Rt.create(n,s+u+d.length+r))}),u+=d.length,o.length===4){u+=o[2].length;const f=o[3];i.push({type:"text",content:f,range:ft.create(Rt.create(n,s+u+r),Rt.create(n,s+u+f.length+r))})}else i.push({type:"text",content:"",range:ft.create(Rt.create(n,s+u+r),Rt.create(n,s+u+r))});s=l+o[0].length}const a=e.substring(s);a.length>0&&i.push({type:"text",content:a,range:ft.create(Rt.create(n,s+r),Rt.create(n,s+r+a.length))})}return i}const WK=/\S/,GK=/\s*$/;function Ck(t,e){const n=t.substring(e).match(
WK);return n?e+n.index:t.length}function KK(t){const e=t.match(GK);if(e&&typeof e.index=="number")return e.index}function ZK(t){var e,n,r,i;const s=Rt.create(t.position.line,t.position.character);if(t.tokens.length===0)return new sx([],ft.create(s,s));const a=[];for(;t.index<t.tokens.length;){const c=JK(t,a[a.length-1]);c&&a.push(c)}const o=(n=(e=a[0])===null||e===void 0?void 0:e.range.start)!==null&&n!==void 0?n:s,l=(i=(r=a[a.length-1])===null||r===void 0?void 0:r.range.end)!==null&&i!==void 0?
i:s;return new sx(a,ft.create(o,l))}function JK(t,e){const n=t.tokens[t.index];if(n.type==="tag")return rx(t,!1);if(n.type==="text"||n.type==="inline-tag")return nx(t);YK(n,e),t.index++}function YK(t,e){if(e){const n=new ax("",t.range);"inlines"in e?e.inlines.push(n):e.content.inlines.push(n)}}function nx(t){let e=t.tokens[t.index];const n=e;let r=e;const i=[];for(;e&&e.type!=="break"&&e.type!=="tag";)i.push(XK(t)),r=e,e=t.tokens[t.index];return new Nk(i,ft.create(n.range.start,r.range.end))}function XK(t){
return t.tokens[t.index].type==="inline-tag"?rx(t,!0):ix(t)}function rx(t,e){const n=t.tokens[t.index++],r=n.content.substring(1),i=t.tokens[t.index];if(i?.type==="text")if(e){const s=ix(t);return new Ik(r,new Nk([s],s.range),e,ft.create(n.range.start,s.range.end))}else{const s=nx(t);return new Ik(r,s,e,ft.create(n.range.start,s.range.end))}else{const s=n.range;return new Ik(r,new Nk([],s),e,s)}}function ix(t){const e=t.tokens[t.index++];return new ax(e.content,e.range)}function xk(t){if(!t)return xk(
{start:"/**",end:"*/",line:"*"});const{start:e,end:n,line:r}=t;return{start:Ak(e,!0),end:Ak(n,!1),line:Ak(r,!0)}}function Ak(t,e){if(typeof t=="string"||typeof t=="object"){const n=typeof t=="string"?Uh(t):t.source;return e?new RegExp(`^\\s*${n}`):new RegExp(`\\s*${n}\\s*$`)}else return t}class sx{constructor(e,n){this.elements=e,this.range=n}getTag(e){return this.getAllTags().find(n=>n.name===e)}getTags(e){return this.getAllTags().filter(n=>n.name===e)}getAllTags(){return this.elements.filter(e=>"\
name"in e)}toString(){let e="";for(const n of this.elements)if(e.length===0)e=n.toString();else{const r=n.toString();e+=ox(e)+r}return e.trim()}toMarkdown(e){let n="";for(const r of this.elements)if(n.length===0)n=r.toMarkdown(e);else{const i=r.toMarkdown(e);n+=ox(n)+i}return n.trim()}}class Ik{constructor(e,n,r,i){this.name=e,this.content=n,this.inline=r,this.range=i}toString(){let e=`@${this.name}`;const n=this.content.toString();return this.content.inlines.length===1?e=`${e} ${n}`:this.content.
inlines.length>1&&(e=`${e}
${n}`),this.inline?`{${e}}`:e}toMarkdown(e){var n,r;return(r=(n=e?.renderTag)===null||n===void 0?void 0:n.call(e,this))!==null&&r!==void 0?r:this.toMarkdownDefault(e)}toMarkdownDefault(e){const n=this.content.toMarkdown(e);if(this.inline){const s=QK(this.name,n,e??{});if(typeof s=="string")return s}let r="";e?.tag==="italic"||e?.tag===void 0?r="*":e?.tag==="bold"?r="**":e?.tag==="bold-italic"&&(r="***");let i=`${r}@${this.name}${r}`;return this.content.inlines.length===1?i=`${i} \u2014 ${n}`:this.
content.inlines.length>1&&(i=`${i}
${n}`),this.inline?`{${i}}`:i}}function QK(t,e,n){var r,i;if(t==="linkplain"||t==="linkcode"||t==="link"){const s=e.indexOf(" ");let a=e;if(s>0){const l=Ck(e,s);a=e.substring(l),e=e.substring(0,s)}return(t==="linkcode"||t==="link"&&n.link==="code")&&(a=`\`${a}\``),(i=(r=n.renderLink)===null||r===void 0?void 0:r.call(n,e,a))!==null&&i!==void 0?i:e3(e,a)}}function e3(t,e){try{return ot.parse(t,!0),`[${e}](${t})`}catch{return t}}class Nk{constructor(e,n){this.inlines=e,this.range=n}toString(){let e="";
for(let n=0;n<this.inlines.length;n++){const r=this.inlines[n],i=this.inlines[n+1];e+=r.toString(),i&&i.range.start.line>r.range.start.line&&(e+=`
`)}return e}toMarkdown(e){let n="";for(let r=0;r<this.inlines.length;r++){const i=this.inlines[r],s=this.inlines[r+1];n+=i.toMarkdown(e),s&&s.range.start.line>i.range.start.line&&(n+=`
`)}return n}}class ax{constructor(e,n){this.text=e,this.range=n}toString(){return this.text}toMarkdown(){return this.text}}function ox(t){return t.endsWith(`
`)?`
`:`

`}class t3{constructor(e){this.indexManager=e.shared.workspace.IndexManager,this.commentProvider=e.documentation.CommentProvider}getDocumentation(e){const n=this.commentProvider.getComment(e);if(n&&QC(n))return XC(n).toMarkdown({renderLink:(i,s)=>this.documentationLinkRenderer(e,i,s),renderTag:i=>this.documentationTagRenderer(e,i)})}documentationLinkRenderer(e,n,r){var i;const s=(i=this.findNameInPrecomputedScopes(e,n))!==null&&i!==void 0?i:this.findNameInGlobalScope(e,n);if(s&&s.nameSegment){const a=s.
nameSegment.range.start.line+1,o=s.nameSegment.range.start.character+1,l=s.documentUri.with({fragment:`L${a},${o}`});return`[${r}](${l.toString()})`}else return}documentationTagRenderer(e,n){}findNameInPrecomputedScopes(e,n){const i=$t(e).precomputedScopes;if(!i)return;let s=e;do{const o=i.get(s).find(l=>l.name===n);if(o)return o;s=s.$container}while(s)}findNameInGlobalScope(e,n){return this.indexManager.allElements().find(i=>i.name===n)}}class n3{constructor(e){this.grammarConfig=()=>e.parser.GrammarConfig}getComment(e){
var n;return VC(e)?e.$comment:(n=Wc(e.$cstNode,this.grammarConfig().multilineCommentRules))===null||n===void 0?void 0:n.text}}class r3{constructor(e){this.syncParser=e.parser.LangiumParser}parse(e,n){return Promise.resolve(this.syncParser.parse(e))}}class i3{constructor(){this.previousTokenSource=new Mt.CancellationTokenSource,this.writeQueue=[],this.readQueue=[],this.done=!0}write(e){this.cancelWrite();const n=kK();return this.previousTokenSource=n,this.enqueue(this.writeQueue,e,n.token)}read(e){
return this.enqueue(this.readQueue,e)}enqueue(e,n,r=Mt.CancellationToken.None){const i=new $k,s={action:n,deferred:i,cancellationToken:r};return e.push(s),this.performNextOperation(),i.promise}async performNextOperation(){if(!this.done)return;const e=[];if(this.writeQueue.length>0)e.push(this.writeQueue.shift());else if(this.readQueue.length>0)e.push(...this.readQueue.splice(0,this.readQueue.length));else return;this.done=!1,await Promise.all(e.map(async({action:n,deferred:r,cancellationToken:i})=>{
try{const s=await Promise.resolve().then(()=>n(i));r.resolve(s)}catch(s){da(s)?r.resolve(void 0):r.reject(s)}})),this.done=!0,this.performNextOperation()}cancelWrite(){this.previousTokenSource.cancel()}}class s3{constructor(e){this.grammarElementIdMap=new qC,this.tokenTypeIdMap=new qC,this.grammar=e.Grammar,this.lexer=e.parser.Lexer,this.linker=e.references.Linker}dehydrate(e){return{lexerErrors:e.lexerErrors,lexerReport:e.lexerReport?this.dehydrateLexerReport(e.lexerReport):void 0,parserErrors:e.
parserErrors.map(n=>Object.assign(Object.assign({},n),{message:n.message})),value:this.dehydrateAstNode(e.value,this.createDehyrationContext(e.value))}}dehydrateLexerReport(e){return e}createDehyrationContext(e){const n=new Map,r=new Map;for(const i of hs(e))n.set(i,{});if(e.$cstNode)for(const i of Th(e.$cstNode))r.set(i,{});return{astNodes:n,cstNodes:r}}dehydrateAstNode(e,n){const r=n.astNodes.get(e);r.$type=e.$type,r.$containerIndex=e.$containerIndex,r.$containerProperty=e.$containerProperty,e.
$cstNode!==void 0&&(r.$cstNode=this.dehydrateCstNode(e.$cstNode,n));for(const[i,s]of Object.entries(e))if(!i.startsWith("$"))if(Array.isArray(s)){const a=[];r[i]=a;for(const o of s)Xt(o)?a.push(this.dehydrateAstNode(o,n)):Yr(o)?a.push(this.dehydrateReference(o,n)):a.push(o)}else Xt(s)?r[i]=this.dehydrateAstNode(s,n):Yr(s)?r[i]=this.dehydrateReference(s,n):s!==void 0&&(r[i]=s);return r}dehydrateReference(e,n){const r={};return r.$refText=e.$refText,e.$refNode&&(r.$refNode=n.cstNodes.get(e.$refNode)),
r}dehydrateCstNode(e,n){const r=n.cstNodes.get(e);return k0(e)?r.fullText=e.fullText:r.grammarSource=this.getGrammarElementId(e.grammarSource),r.hidden=e.hidden,r.astNode=n.astNodes.get(e.astNode),na(e)?r.content=e.content.map(i=>this.dehydrateCstNode(i,n)):Wa(e)&&(r.tokenType=e.tokenType.name,r.offset=e.offset,r.length=e.length,r.startLine=e.range.start.line,r.startColumn=e.range.start.character,r.endLine=e.range.end.line,r.endColumn=e.range.end.character),r}hydrate(e){const n=e.value,r=this.createHydrationContext(
n);return"$cstNode"in n&&this.hydrateCstNode(n.$cstNode,r),{lexerErrors:e.lexerErrors,lexerReport:e.lexerReport,parserErrors:e.parserErrors,value:this.hydrateAstNode(n,r)}}createHydrationContext(e){const n=new Map,r=new Map;for(const s of hs(e))n.set(s,{});let i;if(e.$cstNode)for(const s of Th(e.$cstNode)){let a;"fullText"in s?(a=new wC(s.fullText),i=a):"content"in s?a=new bk:"tokenType"in s&&(a=this.hydrateCstLeafNode(s)),a&&(r.set(s,a),a.root=i)}return{astNodes:n,cstNodes:r}}hydrateAstNode(e,n){
const r=n.astNodes.get(e);r.$type=e.$type,r.$containerIndex=e.$containerIndex,r.$containerProperty=e.$containerProperty,e.$cstNode&&(r.$cstNode=n.cstNodes.get(e.$cstNode));for(const[i,s]of Object.entries(e))if(!i.startsWith("$"))if(Array.isArray(s)){const a=[];r[i]=a;for(const o of s)Xt(o)?a.push(this.setParent(this.hydrateAstNode(o,n),r)):Yr(o)?a.push(this.hydrateReference(o,r,i,n)):a.push(o)}else Xt(s)?r[i]=this.setParent(this.hydrateAstNode(s,n),r):Yr(s)?r[i]=this.hydrateReference(s,r,i,n):s!==
void 0&&(r[i]=s);return r}setParent(e,n){return e.$container=n,e}hydrateReference(e,n,r,i){return this.linker.buildReference(n,r,i.cstNodes.get(e.$refNode),e.$refText)}hydrateCstNode(e,n,r=0){const i=n.cstNodes.get(e);if(typeof e.grammarSource=="number"&&(i.grammarSource=this.getGrammarElement(e.grammarSource)),i.astNode=n.astNodes.get(e.astNode),na(i))for(const s of e.content){const a=this.hydrateCstNode(s,n,r++);i.content.push(a)}return i}hydrateCstLeafNode(e){const n=this.getTokenType(e.tokenType),
r=e.offset,i=e.length,s=e.startLine,a=e.startColumn,o=e.endLine,l=e.endColumn,c=e.hidden;return new wk(r,i,{start:{line:s,character:a},end:{line:o,character:l}},n,c)}getTokenType(e){return this.lexer.definition[e]}getGrammarElementId(e){if(e)return this.grammarElementIdMap.size===0&&this.createGrammarElementIdMap(),this.grammarElementIdMap.get(e)}getGrammarElement(e){return this.grammarElementIdMap.size===0&&this.createGrammarElementIdMap(),this.grammarElementIdMap.getKey(e)}createGrammarElementIdMap(){
let e=0;for(const n of hs(this.grammar))jw(n)&&this.grammarElementIdMap.set(n,e++)}}function lx(t){return{documentation:{CommentProvider:e=>new n3(e),DocumentationProvider:e=>new t3(e)},parser:{AsyncParser:e=>new r3(e),GrammarConfig:e=>P2(e),LangiumParser:e=>gK(e),CompletionParser:e=>mK(e),ValueConverter:()=>new PC,TokenBuilder:()=>new vK,Lexer:e=>new zK(e),ParserErrorMessageProvider:()=>new RC,LexerErrorMessageProvider:()=>new qK},workspace:{AstNodeLocator:()=>new OK,AstNodeDescriptionProvider:e=>new GC(
e),ReferenceDescriptionProvider:e=>new DK(e)},references:{Linker:e=>new SK(e),NameProvider:()=>new jC,ScopeProvider:e=>new HC(e),ScopeComputation:e=>new FC(e),References:e=>new $K(e)},serializer:{Hydrator:e=>new s3(e),JsonSerializer:e=>new CK(e)},validation:{DocumentValidator:e=>new WC(e),ValidationRegistry:e=>new AK(e)},shared:()=>t.shared}}function cx(t){return{ServiceRegistry:e=>new xK(e),workspace:{LangiumDocuments:e=>new MC(e),LangiumDocumentFactory:e=>new RK(e),DocumentBuilder:e=>new jK(e),
IndexManager:e=>new KC(e),WorkspaceManager:e=>new ZC(e),FileSystemProvider:e=>t.fileSystemProvider(e),WorkspaceLock:()=>new i3,ConfigurationProvider:e=>new MK(e)}}}var Hm;(function(t){t.merge=(e,n)=>Bm(Bm({},e),n)})(Hm||(Hm={}));function Vm(t,e,n,r,i,s,a,o,l){const c=[t,e,n,r,i,s,a,o,l].reduce(Bm,{});return dx(c)}const ux=Symbol("isProxy");function Dk(t){if(t&&t[ux])for(const e of Object.values(t))Dk(e);return t}function dx(t,e){const n=new Proxy({},{deleteProperty:()=>!1,set:()=>{throw new Error(
"Cannot set property on injected service container")},get:(r,i)=>i===ux?!0:px(r,i,t,e||n),getOwnPropertyDescriptor:(r,i)=>(px(r,i,t,e||n),Object.getOwnPropertyDescriptor(r,i)),has:(r,i)=>i in t,ownKeys:()=>[...Object.getOwnPropertyNames(t)]});return n}const fx=Symbol();function px(t,e,n,r){if(e in t){if(t[e]instanceof Error)throw new Error("Construction failure. Please make sure that your dependencies are constructable.",{cause:t[e]});if(t[e]===fx)throw new Error('Cycle detected. Please make "'+
String(e)+'" lazy. Visit https://langium.org/docs/reference/configuration-services/#resolving-cyclic-dependencies');return t[e]}else if(e in n){const i=n[e];t[e]=fx;try{t[e]=typeof i=="function"?i(r):dx(i,r)}catch(s){throw t[e]=s instanceof Error?s:void 0,s}return t[e]}else return}function Bm(t,e){if(e){for(const[n,r]of Object.entries(e))if(r!==void 0){const i=t[n];i!==null&&r!==null&&typeof i=="object"&&typeof r=="object"?t[n]=Bm(i,r):t[n]=r}}return t}class a3{readFile(){throw new Error("No fil\
e system is available.")}async readDirectory(){return[]}}const o3={fileSystemProvider:()=>new a3},l3={Grammar:()=>{},LanguageMetaData:()=>({caseInsensitive:!1,fileExtensions:[".langium"],languageId:"langium"})},c3={AstReflection:()=>new N0};function u3(){const t=Vm(cx(o3),c3),e=Vm(lx({shared:t}),l3);return t.ServiceRegistry.register(e),e}function d3(t){var e;const n=u3(),r=n.serializer.JsonSerializer.deserialize(t);return n.shared.workspace.LangiumDocumentFactory.fromModel(r,ot.parse(`memory://${(e=
r.name)!==null&&e!==void 0?e:"grammar"}.langium`)),r}function f3(...t){return hn(p3,t)}const p3=(t,e)=>e.some(n=>n(t));function h3(...t){return hn(m3,t)}function m3(t,e){if(e<1)throw RangeError(`chunk: A chunk size of '${e.toString()}' would result in an infinite array`);if(t.length===0)return[];if(e>=t.length)return[[...t]];let n=Math.ceil(t.length/e),r=Array(n);if(e===1)for(let[i,s]of t.entries())r[i]=[s];else for(let i=0;i<n;i+=1){let s=i*e;r[i]=t.slice(s,s+e)}return r}function hx(...t){return hn(
g3,t)}const g3=(t,{min:e,max:n})=>e!==void 0&&t<e?e:n!==void 0&&t>n?n:t;function mx(...t){return hn(y3,t)}const y3=(t,e)=>[...t,...e];function gx(t,e){let n=e.length-t.length;if(n===1){let[r,...i]=e;return at(r,{lazy:t,lazyArgs:i})}if(n===0){let r={lazy:t,lazyArgs:e};return Object.assign(i=>at(i,r),r)}throw Error("Wrong number of arguments")}function v3(...t){return gx(w3,t)}function w3(t){if(t.length===0)return _q;let e=new Map;for(let n of t)e.set(n,(e.get(n)??0)+1);return n=>{let r=e.get(n);return r===
void 0||r===0?{done:!1,hasNext:!0,next:n}:(e.set(n,r-1),vh)}}function Wm(...t){return hn(Object.entries,t)}function nt(...t){return hn(b3,t,k3)}const b3=(t,e)=>t.filter(e),k3=t=>(e,n,r)=>t(e,n,r)?{done:!1,hasNext:!0,next:e}:vh,yx=t=>Object.assign(t,{single:!0});function Ok(...t){return hn(_3,t,yx(R3))}const _3=(t,e)=>t.find(e),R3=t=>(e,n,r)=>t(e,n,r)?{done:!0,hasNext:!0,next:e}:vh;function vx(...t){return hn(S3,t)}const S3=(t,e)=>{for(let n=t.length-1;n>=0;n--){let r=t[n];if(e(r,n,t))return r}};
function ql(...t){return hn($3,t,yx(T3))}const $3=([t])=>t,T3=()=>E3,E3=t=>({hasNext:!0,next:t,done:!0});function Rs(...t){return hn(P3,t,C3)}const P3=(t,e)=>t.flatMap(e),C3=t=>(e,n,r)=>{let i=t(e,n,r);return Array.isArray(i)?{done:!1,hasNext:!0,hasMany:!0,next:i}:{done:!1,hasNext:!0,next:i}};function wx(...t){return hn(x3,t,A3)}function x3(t,e){return t.forEach(e),t}const A3=t=>(e,n,r)=>(t(e,n,r),{done:!1,hasNext:!0,next:e});function bx(...t){return hn(I3,t)}function I3(t,e){for(let[n,r]of Object.
entries(t))e(r,n,t);return t}const kx=Symbol("funnel/voidReducer"),N3=()=>kx;function D3(t,{triggerAt:e="end",minQuietPeriodMs:n,maxBurstDurationMs:r,minGapMs:i,reducer:s=N3}){let a,o,l,c,u=()=>{let p=l;p!==void 0&&(l=void 0,p===kx?t():t(p),i!==void 0&&(o=setTimeout(d,i)))},d=()=>{clearTimeout(o),o=void 0,a===void 0&&u()},f=()=>{clearTimeout(a),a=void 0,c=void 0,o===void 0&&u()};return{call:(...p)=>{let m=a===void 0&&o===void 0;if((e!=="start"||m)&&(l=s(l,...p)),!(a===void 0&&!m)){{clearTimeout(
a);let w=Date.now();c??=w;let v=Math.min(n,r-(w-c));a=setTimeout(f,v)}e!=="end"&&m&&u()}},cancel:()=>{clearTimeout(a),a=void 0,c=void 0,clearTimeout(o),o=void 0,l=void 0},flush:()=>{f(),d()},get isIdle(){return a===void 0&&o===void 0}}}function O3(){return L3}const L3=t=>t;function td(...t){return hn(M3,t)}function M3(t,e){let n={};for(let[r,i]of t.entries()){let s=e(i,r,t);n[s]=i}return n}function j3(t){return Array.isArray(t)}function _x(t){return typeof t=="boolean"}function Un(t){return t!==
void 0}function Nt(t){return t===""||t===void 0?!0:Array.isArray(t)?t.length===0:Object.keys(t).length===0}function Ki(t){return t!=null}function Gt(t){return t==null}function Zi(t){return typeof t=="number"&&!Number.isNaN(t)}function q3(t){return t instanceof Promise}function fa(t){return typeof t=="string"}function ke(t){return!!t}function Lr(...t){return hn(Object.keys,t)}function ii(...t){return hn(F3,t)}function F3(t,e){let n={};for(let[r,i]of t.entries()){let[s,a]=e(i,r,t);n[s]=a}return n}
function Rx(...t){return hn(z3,t)}function z3(t,e){let n={...t};for(let[r,i]of Object.entries(n))e(i,r,t)&&delete n[r];return n}function _i(t,...e){return typeof t=="string"||typeof t=="number"||typeof t=="symbol"?n=>Sx(n,t,...e):Sx(t,...e)}function Sx(t,...e){let n=t;for(let r of e){if(n==null)return;n=n[r]}return n}function Lk(...t){return hn(U3,t)}const U3=(t,e,n)=>t.reduce(e,n);function H3(...t){return hn(V3,t)}function V3(t){return[...t].reverse()}function Gm(...t){return hn(B3,t)}function B3(t,e){
let n=[...t];return n.sort(e),n}function W3(...t){return hn(G3,t,K3)}const G3=(t,e)=>e<0?[]:t.slice(0,e);function K3(t){if(t<=0)return Rq;let e=t;return n=>(--e,{done:e<=0,hasNext:!0,next:n})}function Z3(...t){return hn(J3,t)}function J3(t,e){return e(t),t}function Ss(...t){return gx(Y3,t)}function Y3(){let t=new Set;return e=>t.has(e)?vh:(t.add(e),{done:!1,hasNext:!0,next:e})}var X3={reset:[0,0],bold:[1,22,"\x1B[22m\x1B[1m"],dim:[2,22,"\x1B[22m\x1B[2m"],italic:[3,23],underline:[4,24],inverse:[7,
27],hidden:[8,28],strikethrough:[9,29],black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],gray:[90,39],bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],blackBright:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39],bgBlackBright:[100,49],bgRedBright:[101,49],bgGreenBright:[
102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]},Q3=Object.entries(X3);function Mk(t){return String(t)}Mk.open="",Mk.close="";function e9(t=!1){let e=typeof process<"u"?process:void 0,n=e?.env||{},r=e?.argv||[];return!("NO_COLOR"in n||r.includes("--no-color"))&&("FORCE_COLOR"in n||r.includes("--color")||e?.platform==="win32"||t&&n.TERM!=="dumb"||"CI"in n)||typeof window<"u"&&!!window.chrome}function t9(t=!1){let e=e9(t),
n=(a,o,l,c)=>{let u="",d=0;do u+=a.substring(d,c)+l,d=c+o.length,c=a.indexOf(o,d);while(~c);return u+a.substring(d)},r=(a,o,l=a)=>{let c=u=>{let d=String(u),f=d.indexOf(o,a.length);return~f?a+n(d,o,l,f)+o:a+d+o};return c.open=a,c.close=o,c},i={isColorSupported:e},s=a=>`\x1B[${a}m`;for(let[a,o]of Q3)i[a]=e?r(s(o[0]),s(o[1]),o[2]):Mk;return i}var n9=process.env.FORCE_TTY!==void 0||$q(1),Sr=t9(n9);function r9(t){return typeof t=="function"?t:i9(t)}function i9(t){if(t==null)return()=>!1;if(t==="fata\
l")return e=>e.level==="fatal";if(t==="error")return e=>e.level==="fatal"||e.level==="error";if(t==="warning")return e=>e.level==="fatal"||e.level==="error"||e.level==="warning";if(t==="info")return e=>e.level==="fatal"||e.level==="error"||e.level==="warning"||e.level==="info";if(t==="debug")return e=>e.level==="fatal"||e.level==="error"||e.level==="warning"||e.level==="info"||e.level==="debug";if(t==="trace")return()=>!0;throw new TypeError(`Invalid log level: ${t}.`)}const $x=["trace","debug",
"info","warning","error","fatal"];function Tx(t,e){const n=$x.indexOf(t);if(n<0)throw new TypeError(`Invalid log level: ${JSON.stringify(t)}.`);const r=$x.indexOf(e);if(r<0)throw new TypeError(`Invalid log level: ${JSON.stringify(e)}.`);return n-r}function s9(t=[]){return pa.getLogger(t)}const jk=Symbol.for("logtape.rootLogger");var pa=class ph{parent;children;category;sinks;parentSinks="inherit";filters;lowestLevel="trace";contextLocalStorage;static getLogger(e=[]){let n=jk in globalThis?globalThis[jk]??
null:null;return n==null&&(n=new ph(null,[]),globalThis[jk]=n),typeof e=="string"?n.getChild(e):e.length===0?n:n.getChild(e)}constructor(e,n){this.parent=e,this.children={},this.category=n,this.sinks=[],this.filters=[]}getChild(e){const n=typeof e=="string"?e:e[0],r=this.children[n];let i=r instanceof ph?r:r?.deref();return i==null&&(i=new ph(this,[...this.category,n]),this.children[n]="WeakRef"in globalThis?new WeakRef(i):i),typeof e=="string"||e.length===1?i:i.getChild(e.slice(1))}reset(){for(;this.
sinks.length>0;)this.sinks.shift();for(this.parentSinks="inherit";this.filters.length>0;)this.filters.shift();this.lowestLevel="trace"}resetDescendants(){for(const e of Object.values(this.children)){const n=e instanceof ph?e:e.deref();n?.resetDescendants()}this.reset()}with(e){return new a9(this,{...e})}filter(e){for(const n of this.filters)if(!n(e))return!1;return this.filters.length<1?this.parent?.filter(e)??!0:!0}*getSinks(e){if(!(this.lowestLevel===null||Tx(e,this.lowestLevel)<0)){if(this.parent!=
null&&this.parentSinks==="inherit")for(const n of this.parent.getSinks(e))yield n;for(const n of this.sinks)yield n}}emit(e,n){const r=h9(),i="category"in e?e.category:this.category,s=r.length>0?[...r,...i]:i,a=Object.getOwnPropertyDescriptors(e);a.category={value:s,enumerable:!0,configurable:!0};const o=Object.defineProperties({},a);if(!(this.lowestLevel===null||Tx(o.level,this.lowestLevel)<0||!this.filter(o))){for(const l of this.getSinks(o.level))if(!n?.has(l))try{l(o)}catch(c){const u=new Set(
n);u.add(l),o9.log("fatal","Failed to emit a log record to sink {sink}: {error}",{sink:l,error:c,record:o},u)}}}log(e,n,r,i){const s=qk();let a;const o=typeof r=="function"?{category:this.category,level:e,timestamp:Date.now(),get message(){return Ex(n,this.properties)},rawMessage:n,get properties(){return a==null&&(a={...s,...r()}),a}}:{category:this.category,level:e,timestamp:Date.now(),message:Ex(n,{...s,...r}),rawMessage:n,properties:{...s,...r}};this.emit(o,i)}logLazily(e,n,r={}){const i=qk();
let s,a;function o(){if((a==null||s==null)&&(a=n((l,...c)=>(s=l,Px(l,c))),s==null))throw new TypeError("No log record was made.");return[a,s]}this.emit({category:this.category,level:e,get message(){return o()[0]},get rawMessage(){return o()[1]},timestamp:Date.now(),properties:{...i,...r}})}logTemplate(e,n,r,i={}){const s=qk();this.emit({category:this.category,level:e,message:Px(n,r),rawMessage:n,timestamp:Date.now(),properties:{...s,...i}})}trace(e,...n){typeof e=="string"?this.log("trace",e,n[0]??
{}):typeof e=="function"?this.logLazily("trace",e):Array.isArray(e)?this.logTemplate("trace",e,n):this.log("trace","{*}",e)}debug(e,...n){typeof e=="string"?this.log("debug",e,n[0]??{}):typeof e=="function"?this.logLazily("debug",e):Array.isArray(e)?this.logTemplate("debug",e,n):this.log("debug","{*}",e)}info(e,...n){typeof e=="string"?this.log("info",e,n[0]??{}):typeof e=="function"?this.logLazily("info",e):Array.isArray(e)?this.logTemplate("info",e,n):this.log("info","{*}",e)}warn(e,...n){typeof e==
"string"?this.log("warning",e,n[0]??{}):typeof e=="function"?this.logLazily("warning",e):Array.isArray(e)?this.logTemplate("warning",e,n):this.log("warning","{*}",e)}warning(e,...n){this.warn(e,...n)}error(e,...n){typeof e=="string"?this.log("error",e,n[0]??{}):typeof e=="function"?this.logLazily("error",e):Array.isArray(e)?this.logTemplate("error",e,n):this.log("error","{*}",e)}fatal(e,...n){typeof e=="string"?this.log("fatal",e,n[0]??{}):typeof e=="function"?this.logLazily("fatal",e):Array.isArray(
e)?this.logTemplate("fatal",e,n):this.log("fatal","{*}",e)}},a9=class aq{logger;properties;constructor(e,n){this.logger=e,this.properties=n}get category(){return this.logger.category}get parent(){return this.logger.parent}getChild(e){return this.logger.getChild(e).with(this.properties)}with(e){return new aq(this.logger,{...this.properties,...e})}log(e,n,r,i){this.logger.log(e,n,typeof r=="function"?()=>({...this.properties,...r()}):{...this.properties,...r},i)}logLazily(e,n){this.logger.logLazily(
e,n,this.properties)}logTemplate(e,n,r){this.logger.logTemplate(e,n,r,this.properties)}emit(e){const n={...e,properties:{...this.properties,...e.properties}};this.logger.emit(n)}trace(e,...n){typeof e=="string"?this.log("trace",e,n[0]??{}):typeof e=="function"?this.logLazily("trace",e):Array.isArray(e)?this.logTemplate("trace",e,n):this.log("trace","{*}",e)}debug(e,...n){typeof e=="string"?this.log("debug",e,n[0]??{}):typeof e=="function"?this.logLazily("debug",e):Array.isArray(e)?this.logTemplate(
"debug",e,n):this.log("debug","{*}",e)}info(e,...n){typeof e=="string"?this.log("info",e,n[0]??{}):typeof e=="function"?this.logLazily("info",e):Array.isArray(e)?this.logTemplate("info",e,n):this.log("info","{*}",e)}warn(e,...n){typeof e=="string"?this.log("warning",e,n[0]??{}):typeof e=="function"?this.logLazily("warning",e):Array.isArray(e)?this.logTemplate("warning",e,n):this.log("warning","{*}",e)}warning(e,...n){this.warn(e,...n)}error(e,...n){typeof e=="string"?this.log("error",e,n[0]??{}):
typeof e=="function"?this.logLazily("error",e):Array.isArray(e)?this.logTemplate("error",e,n):this.log("error","{*}",e)}fatal(e,...n){typeof e=="string"?this.log("fatal",e,n[0]??{}):typeof e=="function"?this.logLazily("fatal",e):Array.isArray(e)?this.logTemplate("fatal",e,n):this.log("fatal","{*}",e)}};const o9=pa.getLogger(["logtape","meta"]);function l9(t){return t.includes(".")||t.includes("[")||t.includes("?.")}function c9(t,e){if(!(e==="__proto__"||e==="prototype"||e==="constructor")&&(typeof t==
"object"||typeof t=="function")&&t!==null)return Object.prototype.hasOwnProperty.call(t,e)?t[e]:void 0}function u9(t,e){const n=t.length;let r=e;if(r>=n)return null;let i;if(t[r]==="["){if(r++,r>=n)return null;if(t[r]==='"'||t[r]==="'"){const s=t[r];r++;let a="";for(;r<n&&t[r]!==s;)if(t[r]==="\\"){if(r++,r<n){const o=t[r];switch(o){case"n":a+=`
`;break;case"t":a+="	";break;case"r":a+="\r";break;case"b":a+="\b";break;case"f":a+="\f";break;case"v":a+="\v";break;case"0":a+="\0";break;case"\\":a+="\\";break;case'"':a+='"';break;case"'":a+="'";break;case"u":if(r+4<n){const l=t.slice(r+1,r+5),c=Number.parseInt(l,16);Number.isNaN(c)?a+=o:(a+=String.fromCharCode(c),r+=4)}else a+=o;break;default:a+=o}r++}}else a+=t[r],r++;if(r>=n)return null;i=a,r++}else{const s=r;for(;r<n&&t[r]!=="]"&&t[r]!=="'"&&t[r]!=='"';)r++;if(r>=n)return null;const a=t.slice(
s,r);if(a.length===0)return null;const o=Number(a);i=Number.isNaN(o)?a:o}for(;r<n&&t[r]!=="]";)r++;r<n&&r++}else{const s=r;for(;r<n&&t[r]!=="."&&t[r]!=="["&&t[r]!=="?"&&t[r]!=="]";)r++;if(i=t.slice(s,r),i.length===0)return null}return r<n&&t[r]==="."&&r++,{segment:i,nextIndex:r}}function d9(t,e){if(typeof e=="string")return c9(t,e);if(Array.isArray(t)&&e>=0&&e<t.length)return t[e]}function f9(t,e){if(t==null||e.length===0||e.endsWith("."))return;let n=t,r=0;const i=e.length;for(;r<i;){if(e.slice(
r,r+2)==="?."){if(r+=2,n==null)return}else if(n==null)return;const a=u9(e,r);if(a===null)return;const{segment:o,nextIndex:l}=a;if(r=l,n=d9(n,o),n===void 0)return}return n}function Ex(t,e){const n=t.length;if(n===0)return[""];if(!t.includes("{"))return[t];const r=[];let i=0;for(let a=0;a<n;a++){const o=t[a];if(o==="{"){if((a+1<n?t[a+1]:"")==="{"){a++;continue}const c=t.indexOf("}",a+1);if(c===-1)continue;const u=t.slice(i,a);r.push(u.replace(/{{/g,"{").replace(/}}/g,"}"));const d=t.slice(a+1,c);let f;
const p=d.trim();p==="*"?f=d in e?e[d]:"*"in e?e["*"]:e:(d!==p?f=d in e?e[d]:e[p]:f=e[d],f===void 0&&l9(p)&&(f=f9(e,p))),r.push(f),a=c,i=a+1}else o==="}"&&a+1<n&&t[a+1]==="}"&&a++}const s=t.slice(i);return r.push(s.replace(/{{/g,"{").replace(/}}/g,"}")),r}function Px(t,e){const n=[];for(let r=0;r<t.length;r++)n.push(t[r]),r<e.length&&n.push(e[r]);return n}const p9=Symbol.for("logtape.categoryPrefix");function h9(){const e=pa.getLogger().contextLocalStorage?.getStore();if(e==null)return[];const n=e[p9];
return Array.isArray(n)?n:[]}function qk(){const e=pa.getLogger().contextLocalStorage?.getStore();if(e==null)return{};const n={};for(const r of Object.keys(e))n[r]=e[r];return n}function Fk(t,e){return K$.inspect(t,e)}const m9={__proto__:null,inspect:Fk},Cx={trace:"TRC",debug:"DBG",info:"INF",warning:"WRN",error:"ERR",fatal:"FTL"},xx=typeof document<"u"||typeof navigator<"u"&&navigator.product==="ReactNative"?t=>JSON.stringify(t):"Deno"in globalThis&&"inspect"in globalThis.Deno&&typeof globalThis.
Deno.inspect=="function"?(t,e)=>globalThis.Deno.inspect(t,{strAbbreviateSize:1/0,iterableLimit:1/0,...e}):m9!=null&&typeof Fk=="function"?(t,e)=>Fk(t,{maxArrayLength:1/0,maxStringLength:1/0,...e}):t=>JSON.stringify(t);function Ft(t){return t<10?`0${t}`:`${t}`}function Fl(t){return t<10?`00${t}`:t<100?`0${t}`:`${t}`}const Km={"date-time-timezone":t=>{const e=new Date(t),n=e.getUTCFullYear(),r=Ft(e.getUTCMonth()+1),i=Ft(e.getUTCDate()),s=Ft(e.getUTCHours()),a=Ft(e.getUTCMinutes()),o=Ft(e.getUTCSeconds()),
l=Fl(e.getUTCMilliseconds());return`${n}-${r}-${i} ${s}:${a}:${o}.${l} +00:00`},"date-time-tz":t=>{const e=new Date(t),n=e.getUTCFullYear(),r=Ft(e.getUTCMonth()+1),i=Ft(e.getUTCDate()),s=Ft(e.getUTCHours()),a=Ft(e.getUTCMinutes()),o=Ft(e.getUTCSeconds()),l=Fl(e.getUTCMilliseconds());return`${n}-${r}-${i} ${s}:${a}:${o}.${l} +00`},"date-time":t=>{const e=new Date(t),n=e.getUTCFullYear(),r=Ft(e.getUTCMonth()+1),i=Ft(e.getUTCDate()),s=Ft(e.getUTCHours()),a=Ft(e.getUTCMinutes()),o=Ft(e.getUTCSeconds()),
l=Fl(e.getUTCMilliseconds());return`${n}-${r}-${i} ${s}:${a}:${o}.${l}`},"time-timezone":t=>{const e=new Date(t),n=Ft(e.getUTCHours()),r=Ft(e.getUTCMinutes()),i=Ft(e.getUTCSeconds()),s=Fl(e.getUTCMilliseconds());return`${n}:${r}:${i}.${s} +00:00`},"time-tz":t=>{const e=new Date(t),n=Ft(e.getUTCHours()),r=Ft(e.getUTCMinutes()),i=Ft(e.getUTCSeconds()),s=Fl(e.getUTCMilliseconds());return`${n}:${r}:${i}.${s} +00`},time:t=>{const e=new Date(t),n=Ft(e.getUTCHours()),r=Ft(e.getUTCMinutes()),i=Ft(e.getUTCSeconds()),
s=Fl(e.getUTCMilliseconds());return`${n}:${r}:${i}.${s}`},date:t=>{const e=new Date(t),n=e.getUTCFullYear(),r=Ft(e.getUTCMonth()+1),i=Ft(e.getUTCDate());return`${n}-${r}-${i}`},rfc3339:t=>new Date(t).toISOString(),none:()=>null},zl={ABBR:Cx,abbr:{trace:"trc",debug:"dbg",info:"inf",warning:"wrn",error:"err",fatal:"ftl"},FULL:{trace:"TRACE",debug:"DEBUG",info:"INFO",warning:"WARNING",error:"ERROR",fatal:"FATAL"},full:{trace:"trace",debug:"debug",info:"info",warning:"warning",error:"error",fatal:"f\
atal"},L:{trace:"T",debug:"D",info:"I",warning:"W",error:"E",fatal:"F"},l:{trace:"t",debug:"d",info:"i",warning:"w",error:"e",fatal:"f"}};function Ax(t={}){const e=(()=>{const a=t.timestamp;return a==null?Km["date-time-timezone"]:a==="disabled"?Km.none:typeof a=="string"&&a in Km?Km[a]:a})(),n=t.category??"\xB7",r=t.value?a=>t.value(a,xx):xx,i=(()=>{const a=t.level;return a==null||a==="ABBR"?o=>zl.ABBR[o]:a==="abbr"?o=>zl.abbr[o]:a==="FULL"?o=>zl.FULL[o]:a==="full"?o=>zl.full[o]:a==="L"?o=>zl.L[o]:
a==="l"?o=>zl.l[o]:a})(),s=t.format??(({timestamp:a,level:o,category:l,message:c})=>`${a?`${a} `:""}[${o}] ${l}: ${c}`);return a=>{const o=a.message,l=o.length;let c;if(l===1)c=o[0];else if(l<=6){c="";for(let m=0;m<l;m++)c+=m%2===0?o[m]:r(o[m])}else{const m=new Array(l);for(let w=0;w<l;w++)m[w]=w%2===0?o[w]:r(o[w]);c=m.join("")}const u=e(a.timestamp),d=i(a.level),f=typeof n=="function"?n(a.category):a.category.join(n);return`${s({timestamp:u,level:d,category:f,message:c,record:a})}
`}}Ax();const zk="\x1B[0m",Uk={black:"\x1B[30m",red:"\x1B[31m",green:"\x1B[32m",yellow:"\x1B[33m",blue:"\x1B[34m",magenta:"\x1B[35m",cyan:"\x1B[36m",white:"\x1B[37m"},Hk={bold:"\x1B[1m",dim:"\x1B[2m",italic:"\x1B[3m",underline:"\x1B[4m",strikethrough:"\x1B[9m"},g9={trace:null,debug:"blue",info:"green",warning:"yellow",error:"red",fatal:"magenta"};function Ix(t={}){const e=t.format,n=typeof t.timestampStyle>"u"?"dim":t.timestampStyle,r=t.timestampColor??null,i=`${n==null?"":Hk[n]}${r==null?"":Uk[r]}`,
s=n==null&&r==null?"":zk,a=typeof t.levelStyle>"u"?"bold":t.levelStyle,o=t.levelColors??g9,l=typeof t.categoryStyle>"u"?"dim":t.categoryStyle,c=t.categoryColor??null,u=`${l==null?"":Hk[l]}${c==null?"":Uk[c]}`,d=l==null&&c==null?"":zk;return Ax({timestamp:"date-time-tz",value(f,p){return p(f,{colors:!0})},...t,format({timestamp:f,level:p,category:m,message:w,record:v}){const g=o[v.level];return f=`${i}${f}${s}`,p=`${a==null?"":Hk[a]}${g==null?"":Uk[g]}${p}${a==null&&g==null?"":zk}`,e==null?`${f} ${p}\
 ${u}${m}:${d} ${w}`:e({timestamp:f,level:p,category:`${u}${m}${d}`,message:w,record:v})}})}Ix();function y9(t={}){if(!t.categorySeparator&&!t.message&&!t.properties)return a=>{if(a.message.length===3)return JSON.stringify({"@timestamp":new Date(a.timestamp).toISOString(),level:a.level==="warning"?"WARN":a.level.toUpperCase(),message:a.message[0]+JSON.stringify(a.message[1])+a.message[2],logger:a.category.join("."),properties:a.properties})+`
`;if(a.message.length===1)return JSON.stringify({"@timestamp":new Date(a.timestamp).toISOString(),level:a.level==="warning"?"WARN":a.level.toUpperCase(),message:a.message[0],logger:a.category.join("."),properties:a.properties})+`
`;let o=a.message[0];for(let l=1;l<a.message.length;l++)o+=l&1?JSON.stringify(a.message[l]):a.message[l];return JSON.stringify({"@timestamp":new Date(a.timestamp).toISOString(),level:a.level==="warning"?"WARN":a.level.toUpperCase(),message:o,logger:a.category.join("."),properties:a.properties})+`
`};const e=t.message==="template",n=t.properties??"nest:properties";let r;if(typeof t.categorySeparator=="function")r=t.categorySeparator;else{const a=t.categorySeparator??".";r=o=>o.join(a)}let i;if(n==="flatten")i=a=>a;else if(n.startsWith("prepend:")){const a=n.substring(8);if(a==="")throw new TypeError(`Invalid properties option: ${JSON.stringify(n)}. It must be of the form "prepend:<prefix>" where <prefix> is a non-empty string.`);i=o=>{const l={};for(const c in o)l[`${a}${c}`]=o[c];return l}}else if(n.
startsWith("nest:")){const a=n.substring(5);i=o=>({[a]:o})}else throw new TypeError(`Invalid properties option: ${JSON.stringify(n)}. It must be "flatten", "prepend:<prefix>", or "nest:<key>".`);let s;return e?s=a=>{if(typeof a.rawMessage=="string")return a.rawMessage;let o="";for(let l=0;l<a.rawMessage.length;l++)o+=l%2<1?a.rawMessage[l]:"{}";return o}:s=a=>{const o=a.message.length;if(o===1)return a.message[0];let l="";for(let c=0;c<o;c++)l+=c%2<1?a.message[c]:JSON.stringify(a.message[c]);return l},
a=>JSON.stringify({"@timestamp":new Date(a.timestamp).toISOString(),level:a.level==="warning"?"WARN":a.level.toUpperCase(),message:s(a),logger:r(a.category),...i(a.properties)})+`
`}y9();const v9={trace:"background-color: gray; color: white;",debug:"background-color: gray; color: white;",info:"background-color: white; color: black;",warning:"background-color: orange; color: black;",error:"background-color: red; color: white;",fatal:"background-color: maroon; color: white;"};function w9(t){let e="";const n=[];for(let s=0;s<t.message.length;s++)s%2===0?e+=t.message[s]:(e+="%o",n.push(t.message[s]));const r=new Date(t.timestamp);return[`%c${`${r.getUTCHours().toString().padStart(
2,"0")}:${r.getUTCMinutes().toString().padStart(2,"0")}:${r.getUTCSeconds().toString().padStart(2,"0")}.${r.getUTCMilliseconds().toString().padStart(3,"0")}`} %c${Cx[t.level]}%c %c${t.category.join("\xB7")} %c${e}`,"color: gray;",v9[t.level],"background-color: default;","color: gray;","color: default;",...n]}function Nx(t={}){const e=t.formatter??w9,n={trace:"debug",debug:"debug",info:"info",warning:"warn",error:"error",fatal:"error",...t.levelMap??{}},r=t.console??globalThis.console,i=g=>{const h=e(
g),y=n[g.level];if(y===void 0)throw new TypeError(`Invalid log level: ${g.level}.`);if(typeof h=="string"){const b=h.replace(/\r?\n$/,"");r[y](b)}else r[y](...h)};if(!t.nonBlocking)return i;const s=t.nonBlocking===!0?{}:t.nonBlocking,a=s.bufferSize??100,o=s.flushInterval??100,l=[];let c=null,u=!1,d=!1;const f=a*2;function p(){if(l.length===0)return;const g=l.splice(0);for(const h of g)try{i(h)}catch{}}function m(){d||(d=!0,setTimeout(()=>{d=!1,p()},0))}function w(){c!==null||u||(c=setInterval(()=>{
p()},o))}const v=g=>{u||(l.length>=f&&l.shift(),l.push(g),l.length>=a?m():c===null&&w())};return v[Symbol.dispose]=()=>{u=!0,c!==null&&(clearInterval(c),c=null),p()},v}let Vk=null;const Dx=new Set,Zm=new Set,b9=new Set;function k9(t){return t.category.length===0||t.category.length===1&&t.category[0]==="logtape"||t.category.length===2&&t.category[0]==="logtape"&&t.category[1]==="meta"}function _9(t){if(Vk!=null&&!t.reset)throw new ha("Already configured; if you want to reset, turn on the reset fl\
ag.");if(b9.size>0)throw new ha("Previously configured async disposables are still active. Use configure() instead or explicitly dispose them using dispose().");Ox();try{R9(t,!1)}catch(e){throw e instanceof ha&&Ox(),e}}function R9(t,e){Vk=t;let n=!1;const r=new Set;for(const s of t.loggers){k9(s)&&(n=!0);const a=Array.isArray(s.category)?JSON.stringify(s.category):JSON.stringify([s.category]);if(r.has(a))throw new ha(`Duplicate logger configuration for category: ${a}. Each category can only be c\
onfigured once.`);r.add(a);const o=pa.getLogger(s.category);for(const l of s.sinks??[]){const c=t.sinks[l];if(!c)throw new ha(`Sink not found: ${l}.`);o.sinks.push(c)}o.parentSinks=s.parentSinks??"inherit",s.lowestLevel!==void 0&&(o.lowestLevel=s.lowestLevel);for(const l of s.filters??[]){const c=t.filters?.[l];if(c===void 0)throw new ha(`Filter not found: ${l}.`);o.filters.push(r9(c))}Dx.add(o)}pa.getLogger().contextLocalStorage=t.contextLocalStorage;for(const s of Object.values(t.sinks)){if(Symbol.
asyncDispose in s)throw new ha("Async disposables cannot be used with configureSync().");Symbol.dispose in s&&Zm.add(s)}for(const s of Object.values(t.filters??{}))if(!(s==null||typeof s=="string")){if(Symbol.asyncDispose in s)throw new ha("Async disposables cannot be used with configureSync().");Symbol.dispose in s&&Zm.add(s)}if(typeof globalThis.EdgeRuntime!="string"&&"process"in globalThis&&!("Deno"in globalThis)){const s=globalThis.process,a=s?.on;typeof a=="function"&&a.call(s,"exit",Bk)}else
addEventListener("unload",Bk);const i=pa.getLogger(["logtape","meta"]);n||i.sinks.push(Nx()),i.info("LogTape loggers are configured.  Note that LogTape itself uses the meta logger, which has category {metaLoggerCategory}.  The meta logger purposes to log internal errors such as sink exceptions.  If you are seeing this message, the meta logger is automatically configured.  It's recommended to configure the meta logger with a separate sink so that you can easily notice if logging itself fails or i\
s misconfigured.  To turn off this message, configure the meta logger with higher log levels than {dismissLevel}.  See also <https://logtape.org/manual/categories#meta-logger>.",{metaLoggerCategory:["logtape","meta"],dismissLevel:"info"})}function Ox(){Bk(),S9()}function S9(){const t=pa.getLogger([]);t.resetDescendants(),delete t.contextLocalStorage,Dx.clear(),Vk=null}function Bk(){for(const t of Zm)t[Symbol.dispose]();Zm.clear()}var ha=class extends Error{constructor(t){super(t),this.name="Conf\
igureError"}};const $9=t=>{Wk.forEach(e=>{T9(t,e)})},Wk=["name","message","stack","cause","errors"],T9=(t,e)=>{const n=Gk(t,e);if(n!==void 0){if(E9(n)){$s(t,e,t[e]);return}P9(n)&&Lx(t,e,n)}},Gk=(t,e)=>{const n=Object.getOwnPropertyDescriptor(t,e);if(n!==void 0)return n;const r=Object.getPrototypeOf(t);return r===null?void 0:Gk(r,e)},E9=({get:t,set:e})=>t!==void 0&&e===void 0,P9=({enumerable:t,writable:e})=>t||!e,$s=(t,e,n)=>{Lx(t,e,{value:n})},Lx=(t,e,n)=>{Object.defineProperty(t,e,{...n,..."get"in
n||"set"in n?{}:{writable:!0},enumerable:!1,configurable:!0})},C9=(t,e)=>{if(Array.isArray(t.errors)){const n=t.errors.filter(x9).map(e).filter(Boolean);$s(t,"errors",n)}else A9(t)?$s(t,"errors",[]):t.errors!==void 0&&I9(t)},x9=t=>t!==void 0,A9=t=>"AggregateError"in globalThis&&(t.name==="AggregateError"||t instanceof AggregateError),I9=t=>{delete t.errors,t.errors!==void 0&&$s(t,"errors",[])},N9=(t,e)=>{if(!("cause"in t))return;const n=t.cause===void 0?t.cause:e(t.cause);n===void 0?delete t.cause:
$s(t,"cause",n)},Mx=t=>D9(t)||O9(t),D9=t=>{try{return t instanceof Error}catch{return!1}},O9=t=>{try{return L9.has(Object.prototype.toString.call(t))}catch{return!1}},L9=new Set(["[object Error]","[object DOMException]","[object DOMError]","[object Exception]"]);function Jm(t){if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)}const M9=t=>!Object.isExtensible(
t)||Wk.some(e=>j9(t,e)||q9(t,e)),j9=(t,e)=>{const n=Object.getOwnPropertyDescriptor(t,e);return n!==void 0&&!n.configurable},q9=(t,e)=>{try{return t[e],!1}catch{return!0}},Kk=t=>{const e=F9(t.message,t.name);$s(t,"stack",e)},F9=(t="",e="Error")=>{const n=z9(e),{stack:r}=new n(t);return typeof r=="string"&&r!==""?r:`${e}: ${t}`},z9=t=>{const e={value:t,enumerable:!1,writable:!0,configurable:!0},n=Object.defineProperty(class extends Error{},"name",e);return Object.defineProperty(n.prototype,"name",
e),n},U9=t=>{const e={};for(const n of H9(t))try{const r=t[n],{enumerable:i,configurable:s,writable:a=!0}=Gk(t,n);Object.defineProperty(e,n,{value:r,enumerable:i,configurable:s,writable:a})}catch{}return e},H9=t=>{const e=V9(t);for(const n of Wk)B9(t,n)&&e.push(n);return e},V9=t=>{try{return Reflect.ownKeys(t)}catch{return[]}},B9=(t,e)=>{try{return e in t&&!Object.hasOwn(t,e)}catch{return!1}},jx=t=>{const{name:e,message:n,stack:r,cause:i,errors:s,...a}=U9(t),o=W9(n,a),l=J9(e,o);return n===o&&Y9(
l,a),Object.entries({name:e,stack:r,cause:i,errors:s}).forEach(([c,u])=>{X9(l,c,u)}),r===void 0&&Kk(l),l},W9=(t,e)=>typeof t=="string"&&t!==""?t:Z9(G9(e)),G9=t=>{try{return JSON.stringify(t)}catch{return K9(t)}},K9=t=>{try{return String(t)}catch{return"Invalid error"}},Z9=t=>t.length<qx?t:`${t.slice(0,qx)}...`,qx=1e3,J9=(t,e)=>t==="AggregateError"&&"AggregateError"in globalThis?new AggregateError([],e):t in Fx?new Fx[t](e):new Error(e),Fx={Error,ReferenceError,TypeError,SyntaxError,RangeError,URIError,
EvalError},Y9=(t,e)=>{for(const n in e)n in t||(t[n]=e[n])},X9=(t,e,n)=>{n!==void 0&&$s(t,e,n)},Q9=t=>{try{const e=new Error(String(t));return Kk(e),e}catch(e){return e}},{toString:e6}=Object.prototype,t6=t=>n6(t)?jx(t):Mx(t)?r6(t)?jx(t):t:Q9(t),n6=t=>{try{return Jm(t)}catch{return!1}},r6=t=>i6(t)||M9(t)||s6(t),i6=t=>{try{return e6.call(t)==="[object Object]"}catch{return!0}},s6=t=>typeof t.constructor!="function"||typeof t.constructor.name!="string"||t.constructor.name===""||t.constructor.prototype!==
Object.getPrototypeOf(t),Ym=(t,{shallow:e=!1}={})=>zx(t,[],e),zx=(t,e,n)=>{if(e.includes(t))return;const r=n?a6:s=>zx(s,[...e,t],n),i=t6(t);return o6(i,r),i},a6=t=>t,o6=(t,e)=>{l6(t),c6(t),u6(t),N9(t,e),C9(t,e),$9(t)},l6=t=>{if(Xm(t.name))return;const e=Object.getPrototypeOf(t).name,n=Xm(e)?e:t.constructor.name;$s(t,"name",n)},c6=t=>{Xm(t.message)||$s(t,"message","")},u6=t=>{Xm(t.stack)||Kk(t)},Xm=t=>typeof t=="string"&&t!=="",d6=(t,e,n=t.name)=>{if(f6(e),typeof n!="string")throw new TypeError(`\
currentName must be a string: ${n}`);return n},f6=t=>{if(!p6(t))throw new TypeError(`ErrorClass must be a class: ${t}`);if(!Ux(t.prototype))throw new TypeError(`ErrorClass must inherit from Error: ${t}`);if(!h6(t))throw new TypeError(`ErrorClass must be have a valid constructor: ${t}`)},p6=t=>typeof t=="function"&&typeof t.prototype=="object"&&t.prototype!==null,Ux=t=>t!==null&&(t.name==="Error"||Ux(Object.getPrototypeOf(t))),h6=t=>typeof t.prototype.constructor=="function",Hx=(t,e,n)=>{Object.defineProperty(
t,e,{value:n,enumerable:!1,writable:!0,configurable:!0})},m6=(t,e)=>{Object.getPrototypeOf(t)!==e.prototype&&(g6(t,e),Wx(t,"constructor"),y6(t,e))},g6=(t,e)=>{Object.setPrototypeOf(t,e.prototype)},y6=(t,e)=>{Wx(t,"name");const n=Vx(e.prototype);t.name!==n&&Hx(t,"name",n)},Vx=t=>v6(t)??w6(t)??Vx(Object.getPrototypeOf(t)),v6=t=>Object.hasOwn(t,"name")&&Bx(t.name)?t.name:void 0,w6=t=>typeof t.constructor=="function"&&Bx(t.constructor.name)?t.constructor.name:void 0,Bx=t=>typeof t=="string"&&t!=="",
Wx=(t,e)=>{Object.hasOwn(t,e)&&delete t[e]},b6=(t,e)=>{if(!k6(t,e))return;const n=R6(t,e);Hx(t,"stack",n)},k6=(t,e)=>e!==t.name&&e!==""&&t.stack.includes(e)&&_6(),_6=()=>{class t extends Error{}const e={value:Gx,enumerable:!1,writable:!0,configurable:!0};Object.defineProperty(t,"name",e),Object.defineProperty(t.prototype,"name",e);const{stack:n}=new t("");return typeof n=="string"&&n.includes(Gx)},Gx="SetErrorClassError",R6=({name:t,stack:e},n)=>{if(e.startsWith(`${n}: `))return e.replace(n,t);const r=S6(
n,t),[i,s]=r.find(([a])=>e.includes(a));return e.replace(i,s)},S6=(t,e)=>[[`
${t}: `,`
${e}: `],[`${t}: `,`${e}: `],[`${t} `,`${e} `],[t,e]],$6=(t,e,n)=>{const r=Ym(t),i=d6(r,e,n);return m6(r,e),b6(r,i),r},T6=(t,e)=>e.configurable===!1?E6(t,e):x6(t,e),E6=(t,e)=>({...e,...P6(t,e),...C6(t,e)}),P6=(t,e)=>e.writable===!0&&t.writable===!1?{writable:!1}:{},C6=(t,e)=>t.hasValue&&"value"in e&&e.writable===!0?{value:t.value}:{},x6=(t,e)=>{const n=nd(t.enumerable,e.enumerable,!0),r=nd(t.writable,e.writable,!0),i=nd(t.configurable,e.configurable,!0);return{...A6(t,e,r),enumerable:n,configurable:i}},
A6=(t,e,n)=>t.hasValue?{value:t.value,writable:n}:!Kx(t)&&!Kx(e)?{value:e.value,writable:n}:{get:nd(t.get,e.get),set:nd(t.set,e.set)},Kx=({get:t,set:e})=>t!==void 0||e!==void 0,nd=(t,e,n)=>t??e??n,I6=(t,e,n)=>{if(!N6(t))throw new TypeError(`Argument must be an object: ${t}`);if(!D6(e))throw new TypeError(`Property key must be a string, a symbol or an integer: ${e}`);return O6(n)},N6=t=>typeof t=="object"&&t!==null,D6=t=>{const e=typeof t;return e==="string"||e==="symbol"||e==="number"},O6=t=>{if(!Jm(
t))throw new TypeError(`Descriptor must be a plain object: ${t}`);const{enumerable:e,writable:n,configurable:r,value:i,get:s,set:a,...o}=t,l="value"in t;return L6({enumerable:e,writable:n,configurable:r,get:s,set:a,unknownProps:o,hasValue:l}),{enumerable:e,writable:n,configurable:r,value:i,get:s,set:a,hasValue:l}},L6=({enumerable:t,writable:e,configurable:n,get:r,set:i,unknownProps:s,hasValue:a})=>{Zx(a,r,"get"),Zx(a,i,"set"),Zk(t,"enumerable"),Zk(e,"writable"),Zk(n,"configurable"),j6(s)},Zx=(t,e,n)=>{
if(M6(e,n),t&&e!==void 0)throw new TypeError(`Descriptor property "value" and "${n}" must not both be defined: ${e}`)},M6=(t,e)=>{if(t!==void 0&&typeof t!="function")throw new TypeError(`Descriptor property "${e}" must be a function: ${t}`)},Zk=(t,e)=>{if(t!==void 0&&typeof t!="boolean")throw new TypeError(`Descriptor property "${e}" must be a boolean: ${t}`)},j6=t=>{const[e]=Object.keys(t);if(e!==void 0)throw new TypeError(`Unknown descriptor property "${e}": ${t[e]}`)},q6=(t,e,n)=>{const r=I6(
t,e,n),i=Jx(t,e),s=T6(r,i);return F6(t,e,s),t},Jx=(t,e)=>{const n=Object.getOwnPropertyDescriptor(t,e);if(n!==void 0)return n;const r=Object.getPrototypeOf(t);return r===null?{}:Jx(r,e)},F6=(t,e,n)=>{try{Object.defineProperty(t,e,n)}catch{}},z6=(t,e,n)=>{if(n!==void 0)return Yx(t,e,n);try{delete t[e]}catch{}if(t[e]!==void 0)return Yx(t,e)},Yx=(t,e,n)=>{const r=U6(e);q6(t,e,{value:n,...r})},U6=t=>typeof t=="string"&&t.startsWith("_")?{enumerable:!1}:{},H6=(t,e,n={})=>{if(Xx(t,"First argument"),Xx(
e,"Second argument"),!Jm(n))throw new TypeError(`Options must be a plain object: ${n}`);const{soft:r=!1}=n;if(typeof r!="boolean")throw new TypeError(`Option "soft" must be a boolean: ${r}`);return{soft:r}},Xx=(t,e)=>{if(t===void 0)throw new TypeError(`${e} is required.`);if(!V6(t))throw new TypeError(`${e} must be a plain object or an error: ${t}`)},V6=t=>Jm(t)||Mx(t),B6=({error:t,props:e,propName:n,soft:r})=>W6(n)||!Z6.call(e,n)||r&&t[n]!==void 0,W6=t=>t in G6||K6.has(t),G6=new Error("check"),
K6=new Set(["prototype","errors","cause"]),{propertyIsEnumerable:Z6}=Object.prototype,J6=(t,e,n)=>{const{soft:r}=H6(t,e,n);for(const i of Reflect.ownKeys(e))Y6({error:t,props:e,propName:i,soft:r});return t},Y6=({error:t,props:e,propName:n,soft:r})=>{B6({error:t,props:e,propName:n,soft:r})||z6(t,n,e[n])},Qm=(t,e,n)=>{Object.defineProperty(t,e,{value:n,writable:!0,enumerable:!1,configurable:!0})},X6=(t,e)=>{if(t.errors===void 0)return;const n=t.errors.map(r=>e(r).error).filter(Boolean);Qm(t,"error\
s",n)},Q6=({target:t,source:e,parent:n,child:r})=>{if(!Qx(t)){e5(t,e);return}Qx(e)&&Qm(t,"errors",[...r.errors,...n.errors])},e5=(t,e)=>{e.errors!==void 0&&Qm(t,"errors",e.errors)},Qx=t=>t.errors!==void 0&&t.errors.length!==0,t5=(t,e,n=t.message)=>{if(typeof e!="string")throw new TypeError(`newMessage must be a string: ${e}`);if(typeof n!="string")throw new TypeError(`currentMessage must be a string: ${n}`);return n},n5=({name:t,stack:e},n,r)=>r!==""&&e.includes(r)?r5({name:t,stack:e,newMessage:n,
currentMessage:r}):s5(t,e,n),r5=({name:t,stack:e,newMessage:n,currentMessage:r})=>{const i=i5(t,n,r),[s,a]=i.find(([o])=>e.includes(o));return e.replace(s,a)},i5=(t,e,n)=>[[`${t}: ${n}`,`${t}: ${e}`],[`: ${n}`,`: ${e}`],[`
${n}`,`
${e}`],[` ${n}`,` ${e}`],[n,e]],s5=(t,e,n)=>{const r=`${t}: `,i=n.trimEnd();return e===t||e.startsWith(`${t}
`)?e.replace(t,`${r}${i}`):e.startsWith(r)?e.replace(r,`${r}${i}
`):`${r}${i}
${e}`},a5=(t,e,n)=>{const r=Ym(t),i=t5(r,e,n);return tA(r,"message",e),o5(r,e,i),r},o5=(t,e,n)=>{if(e===n||!l5())return;const r=n5(t,e,n);tA(t,"stack",r)},l5=()=>{const{stack:t}=new Error(eA);return typeof t=="string"&&t.includes(eA)},eA="set-error-message test message",tA=(t,e,n)=>{Object.defineProperty(t,e,{value:n,enumerable:!1,writable:!0,configurable:!0})},nA=(t,e,n)=>{if(typeof e!="string")throw new TypeError(`Second argument must be a message string: ${e}`);const r=Ym(t),i=c5(e,r.message);
return a5(r,i,n)},c5=(t,e)=>{const n=t.trim(),r=e.trim();return n===""?r:r===""?n:u5(n,r,t)},u5=(t,e,n)=>t.endsWith(d5)?n.endsWith(f5)?`${t}
${e}`:`${t} ${e}`:`${e}
${t}`,d5=":",f5=`
`,p5=({parent:t,child:e,target:n,stackError:r})=>{const i=t.message,s=r.message;return n.message=e.message,nA(n,i,s)},h5=(t,e)=>rA(t)===e,rA=t=>typeof t=="object"&&t!==null?t.stack:void 0,m5=({wrap:t,target:e,source:n,childHasStack:r})=>t===r?e:(Qm(e,"stack",n.stack),n),g5=t=>{const{wrap:e,name:n}=t;return typeof e!="boolean"?n==="Error":(Object.hasOwn(t,"wrap")&&delete t.wrap,e)},iA=t=>sA(t,[]).error,sA=(t,e)=>{if(e.includes(t))return{};const n=l=>sA(l,[...e,t]),r=rA(t),i=Ym(t,{shallow:!0}),s=h5(
i,r);X6(i,n);const{parent:a,childHasStack:o}=y5(i,n);return{error:a,errorHasStack:s||o}},y5=(t,e)=>{const n=g5(t);if(t.cause===void 0)return{parent:t,childHasStack:!1};const{error:r,errorHasStack:i}=e(t.cause);return delete t.cause,{parent:v5({parent:t,child:r,childHasStack:i,wrap:n}),childHasStack:i}},v5=({parent:t,child:e,childHasStack:n,wrap:r})=>{if(e===void 0)return t;const[i,s]=r?[e,t]:[t,e],a=m5({wrap:r,target:i,source:s,childHasStack:n}),o=$6(i,i.constructor,a.name),l=p5({parent:t,child:e,
target:o,stackError:a});return Q6({target:l,source:s,parent:t,child:e}),J6(l,s,{soft:!r})};function w5(t){const e=function(n,r){if(typeof r?.toJSON=="function"&&(r=r.toJSON()),!(r!==null&&typeof r=="object"))return r;if(t.has(r))return"[Circular]";t.add(r);const i=Array.isArray(r)?[]:{};for(const[s,a]of Object.entries(r))i[s]=e(s,a);return t.delete(r),i};return e}function b5(t,{indentation:e}={}){return JSON.stringify(t,w5(new WeakSet),e)}const aA=t=>t.split(`
`).map(e=>e.trim().replace("file://",""));function Jk(t,e=2){t=Array.isArray(t)?t:t.split(`
`);const n=" ".repeat(e);return t.map(r=>`${n}${r}`).join(`
`)}function rt(t){if(typeof t=="string")return t;if(t instanceof Error){const e=iA(t);if(e.stack){const n=aA(e.stack);return e.message+`
`+Jk(n.slice(1))}return e.message}return b5(t,{indentation:"	"})}function oA(t,e){return nA(t,e)}function k5(t){const e=Object.entries(t.properties).flatMap(([n,r])=>{if(r instanceof Error){const i=iA(r);return i.stack&&(i.stack=aA(i.stack).join(`
`)),[i]}return n==="error"||n==="err"?[new Error(`${r}`)]:[]});return e.length===0?null:e.length===1?e[0]:new AggregateError(e)}function _5(t,e=!1){const n=k5(t.record);if(n){let r=n.message;return n.stack&&(r=r+`
`+Jk(n.stack.split(`
`).slice(1))),e&&(r=`${T5.red}${r}${$5}`),{...t,message:t.message+`
`+Jk(r)}}return t}const R5={trace:"TRACE",debug:"DEBUG",info:"INFO ",warning:"WARN ",error:"ERROR",fatal:"FATAL"},S5=t=>R5[t],$5="\x1B[0m",T5={red:"\x1B[31m"};function E5(t){const e=(({timestamp:n,level:r,category:i,message:s})=>`${n} ${r} ${i} ${s}`);return Ix({timestamp:"time",level:S5,categoryStyle:"bold",categoryColor:"cyan",category:".",...t,format:n=>e(_5(n,!0))})}function Yk(t){return e=>{const{message:n,properties:r}=e;return r&&Object.keys(r).length>0?[...n,r]:n}}function lA(t){return Nx(
{formatter:Yk(),...t})}function P5(t){const e=Yk();return n=>{const r=e(n);if(typeof r=="string"){const i=r.replace(/\r?\n$/,"");console.error(i)}else console.error(...r)}}const Mr=s9("likec4");function cA(t){return Mr.getChild(t)}function uA(t){try{const e=t?.sinks??{};_9({reset:!0,...t,sinks:{console:lA(),...e},loggers:[{category:["logtape","meta"],sinks:["console"],lowestLevel:"warning"},...t?.loggers??[{category:"likec4",sinks:["console"],lowestLevel:"debug"}]]})}catch(e){console.error(e)}}var mo={},
gn={},dA;function Xk(){if(dA)return gn;dA=1,Object.defineProperty(gn,"__esModule",{value:!0}),gn.thenable=gn.typedArray=gn.stringArray=gn.array=gn.func=gn.error=gn.number=gn.string=gn.boolean=void 0;function t(c){return c===!0||c===!1}gn.boolean=t;function e(c){return typeof c=="string"||c instanceof String}gn.string=e;function n(c){return typeof c=="number"||c instanceof Number}gn.number=n;function r(c){return c instanceof Error}gn.error=r;function i(c){return typeof c=="function"}gn.func=i;function s(c){
return Array.isArray(c)}gn.array=s;function a(c){return s(c)&&c.every(u=>e(u))}gn.stringArray=a;function o(c,u){return Array.isArray(c)&&c.every(u)}gn.typedArray=o;function l(c){return c&&i(c.then)}return gn.thenable=l,gn}var vt={},go={},yo={},eg={},Qk={},De={},fA;function pA(){if(fA)return De;fA=1,Object.defineProperty(De,"__esModule",{value:!0}),De.Message=De.NotificationType9=De.NotificationType8=De.NotificationType7=De.NotificationType6=De.NotificationType5=De.NotificationType4=De.NotificationType3=
De.NotificationType2=De.NotificationType1=De.NotificationType0=De.NotificationType=De.RequestType9=De.RequestType8=De.RequestType7=De.RequestType6=De.RequestType5=De.RequestType4=De.RequestType3=De.RequestType2=De.RequestType1=De.RequestType=De.RequestType0=De.AbstractMessageSignature=De.ParameterStructures=De.ResponseError=De.ErrorCodes=void 0;const t=Yu();var e;(function(E){E.ParseError=-32700,E.InvalidRequest=-32600,E.MethodNotFound=-32601,E.InvalidParams=-32602,E.InternalError=-32603,E.jsonrpcReservedErrorRangeStart=
-32099,E.serverErrorStart=-32099,E.MessageWriteError=-32099,E.MessageReadError=-32098,E.PendingResponseRejected=-32097,E.ConnectionInactive=-32096,E.ServerNotInitialized=-32002,E.UnknownErrorCode=-32001,E.jsonrpcReservedErrorRangeEnd=-32e3,E.serverErrorEnd=-32e3})(e||(De.ErrorCodes=e={}));class n extends Error{constructor($,z,j){super(z),this.code=t.number($)?$:e.UnknownErrorCode,this.data=j,Object.setPrototypeOf(this,n.prototype)}toJson(){const $={code:this.code,message:this.message};return this.
data!==void 0&&($.data=this.data),$}}De.ResponseError=n;class r{constructor($){this.kind=$}static is($){return $===r.auto||$===r.byName||$===r.byPosition}toString(){return this.kind}}De.ParameterStructures=r,r.auto=new r("auto"),r.byPosition=new r("byPosition"),r.byName=new r("byName");class i{constructor($,z){this.method=$,this.numberOfParams=z}get parameterStructures(){return r.auto}}De.AbstractMessageSignature=i;class s extends i{constructor($){super($,0)}}De.RequestType0=s;class a extends i{constructor($,z=r.
auto){super($,1),this._parameterStructures=z}get parameterStructures(){return this._parameterStructures}}De.RequestType=a;class o extends i{constructor($,z=r.auto){super($,1),this._parameterStructures=z}get parameterStructures(){return this._parameterStructures}}De.RequestType1=o;class l extends i{constructor($){super($,2)}}De.RequestType2=l;class c extends i{constructor($){super($,3)}}De.RequestType3=c;class u extends i{constructor($){super($,4)}}De.RequestType4=u;class d extends i{constructor($){
super($,5)}}De.RequestType5=d;class f extends i{constructor($){super($,6)}}De.RequestType6=f;class p extends i{constructor($){super($,7)}}De.RequestType7=p;class m extends i{constructor($){super($,8)}}De.RequestType8=m;class w extends i{constructor($){super($,9)}}De.RequestType9=w;class v extends i{constructor($,z=r.auto){super($,1),this._parameterStructures=z}get parameterStructures(){return this._parameterStructures}}De.NotificationType=v;class g extends i{constructor($){super($,0)}}De.NotificationType0=
g;class h extends i{constructor($,z=r.auto){super($,1),this._parameterStructures=z}get parameterStructures(){return this._parameterStructures}}De.NotificationType1=h;class y extends i{constructor($){super($,2)}}De.NotificationType2=y;class b extends i{constructor($){super($,3)}}De.NotificationType3=b;class R extends i{constructor($){super($,4)}}De.NotificationType4=R;class T extends i{constructor($){super($,5)}}De.NotificationType5=T;class N extends i{constructor($){super($,6)}}De.NotificationType6=
N;class q extends i{constructor($){super($,7)}}De.NotificationType7=q;class B extends i{constructor($){super($,8)}}De.NotificationType8=B;class ie extends i{constructor($){super($,9)}}De.NotificationType9=ie;var L;return(function(E){function $(U){const W=U;return W&&t.string(W.method)&&(t.string(W.id)||t.number(W.id))}E.isRequest=$;function z(U){const W=U;return W&&t.string(W.method)&&U.id===void 0}E.isNotification=z;function j(U){const W=U;return W&&(W.result!==void 0||!!W.error)&&(t.string(W.id)||
t.number(W.id)||W.id===null)}E.isResponse=j})(L||(De.Message=L={})),De}var Ts={},hA;function mA(){if(hA)return Ts;hA=1;var t;Object.defineProperty(Ts,"__esModule",{value:!0}),Ts.LRUCache=Ts.LinkedMap=Ts.Touch=void 0;var e;(function(i){i.None=0,i.First=1,i.AsOld=i.First,i.Last=2,i.AsNew=i.Last})(e||(Ts.Touch=e={}));class n{constructor(){this[t]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,
this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){return this._head?.value}get last(){return this._tail?.value}has(s){return this._map.has(s)}get(s,a=e.None){const o=this._map.get(s);if(o)return a!==e.None&&this.touch(o,a),o.value}set(s,a,o=e.None){let l=this._map.get(s);if(l)l.value=a,o!==e.None&&this.touch(l,o);else{switch(l={key:s,value:a,next:void 0,previous:void 0},o){case e.None:this.addItemLast(l);break;case e.First:this.addItemFirst(
l);break;case e.Last:this.addItemLast(l);break;default:this.addItemLast(l);break}this._map.set(s,l),this._size++}return this}delete(s){return!!this.remove(s)}remove(s){const a=this._map.get(s);if(a)return this._map.delete(s),this.removeItem(a),this._size--,a.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");const s=this._head;return this._map.delete(s.key),this.removeItem(s),this._size--,s.value}forEach(s,a){const o=this._state;let l=this.
_head;for(;l;){if(a?s.bind(a)(l.value,l.key,this):s(l.value,l.key,this),this._state!==o)throw new Error("LinkedMap got modified during iteration.");l=l.next}}keys(){const s=this._state;let a=this._head;const o={[Symbol.iterator]:()=>o,next:()=>{if(this._state!==s)throw new Error("LinkedMap got modified during iteration.");if(a){const l={value:a.key,done:!1};return a=a.next,l}else return{value:void 0,done:!0}}};return o}values(){const s=this._state;let a=this._head;const o={[Symbol.iterator]:()=>o,
next:()=>{if(this._state!==s)throw new Error("LinkedMap got modified during iteration.");if(a){const l={value:a.value,done:!1};return a=a.next,l}else return{value:void 0,done:!0}}};return o}entries(){const s=this._state;let a=this._head;const o={[Symbol.iterator]:()=>o,next:()=>{if(this._state!==s)throw new Error("LinkedMap got modified during iteration.");if(a){const l={value:[a.key,a.value],done:!1};return a=a.next,l}else return{value:void 0,done:!0}}};return o}[(t=Symbol.toStringTag,Symbol.iterator)](){
return this.entries()}trimOld(s){if(s>=this.size)return;if(s===0){this.clear();return}let a=this._head,o=this.size;for(;a&&o>s;)this._map.delete(a.key),a=a.next,o--;this._head=a,this._size=o,a&&(a.previous=void 0),this._state++}addItemFirst(s){if(!this._head&&!this._tail)this._tail=s;else if(this._head)s.next=this._head,this._head.previous=s;else throw new Error("Invalid list");this._head=s,this._state++}addItemLast(s){if(!this._head&&!this._tail)this._head=s;else if(this._tail)s.previous=this._tail,
this._tail.next=s;else throw new Error("Invalid list");this._tail=s,this._state++}removeItem(s){if(s===this._head&&s===this._tail)this._head=void 0,this._tail=void 0;else if(s===this._head){if(!s.next)throw new Error("Invalid list");s.next.previous=void 0,this._head=s.next}else if(s===this._tail){if(!s.previous)throw new Error("Invalid list");s.previous.next=void 0,this._tail=s.previous}else{const a=s.next,o=s.previous;if(!a||!o)throw new Error("Invalid list");a.previous=o,o.next=a}s.next=void 0,
s.previous=void 0,this._state++}touch(s,a){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(a!==e.First&&a!==e.Last)){if(a===e.First){if(s===this._head)return;const o=s.next,l=s.previous;s===this._tail?(l.next=void 0,this._tail=l):(o.previous=l,l.next=o),s.previous=void 0,s.next=this._head,this._head.previous=s,this._head=s,this._state++}else if(a===e.Last){if(s===this._tail)return;const o=s.next,l=s.previous;s===this._head?(o.previous=void 0,this._head=o):(o.previous=l,l.next=o),
s.next=void 0,s.previous=this._tail,this._tail.next=s,this._tail=s,this._state++}}}toJSON(){const s=[];return this.forEach((a,o)=>{s.push([o,a])}),s}fromJSON(s){this.clear();for(const[a,o]of s)this.set(a,o)}}Ts.LinkedMap=n;class r extends n{constructor(s,a=1){super(),this._limit=s,this._ratio=Math.min(Math.max(0,a),1)}get limit(){return this._limit}set limit(s){this._limit=s,this.checkTrim()}get ratio(){return this._ratio}set ratio(s){this._ratio=Math.min(Math.max(0,s),1),this.checkTrim()}get(s,a=e.
AsNew){return super.get(s,a)}peek(s){return super.get(s,e.None)}set(s,a){return super.set(s,a,e.Last),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}}return Ts.LRUCache=r,Ts}var rd={},gA;function C5(){if(gA)return rd;gA=1,Object.defineProperty(rd,"__esModule",{value:!0}),rd.Disposable=void 0;var t;return(function(e){function n(r){return{dispose:r}}e.create=n})(t||(rd.Disposable=t={})),rd}var vo={},yA;function x5(){if(yA)return vo;yA=1,Object.
defineProperty(vo,"__esModule",{value:!0}),vo.SharedArrayReceiverStrategy=vo.SharedArraySenderStrategy=void 0;const t=jm();var e;(function(a){a.Continue=0,a.Cancelled=1})(e||(e={}));class n{constructor(){this.buffers=new Map}enableCancellation(o){if(o.id===null)return;const l=new SharedArrayBuffer(4),c=new Int32Array(l,0,1);c[0]=e.Continue,this.buffers.set(o.id,l),o.$cancellationData=l}async sendCancellation(o,l){const c=this.buffers.get(l);if(c===void 0)return;const u=new Int32Array(c,0,1);Atomics.
store(u,0,e.Cancelled)}cleanup(o){this.buffers.delete(o)}dispose(){this.buffers.clear()}}vo.SharedArraySenderStrategy=n;class r{constructor(o){this.data=new Int32Array(o,0,1)}get isCancellationRequested(){return Atomics.load(this.data,0)===e.Cancelled}get onCancellationRequested(){throw new Error("Cancellation over SharedArrayBuffer doesn't support cancellation events")}}class i{constructor(o){this.token=new r(o)}cancel(){}dispose(){}}class s{constructor(){this.kind="request"}createCancellationTokenSource(o){
const l=o.$cancellationData;return l===void 0?new t.CancellationTokenSource:new i(l)}}return vo.SharedArrayReceiverStrategy=s,vo}var Es={},id={},vA;function wA(){if(vA)return id;vA=1,Object.defineProperty(id,"__esModule",{value:!0}),id.Semaphore=void 0;const t=co();class e{constructor(r=1){if(r<=0)throw new Error("Capacity must be greater than 0");this._capacity=r,this._active=0,this._waiting=[]}lock(r){return new Promise((i,s)=>{this._waiting.push({thunk:r,resolve:i,reject:s}),this.runNext()})}get active(){
return this._active}runNext(){this._waiting.length===0||this._active===this._capacity||(0,t.default)().timer.setImmediate(()=>this.doRunNext())}doRunNext(){if(this._waiting.length===0||this._active===this._capacity)return;const r=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{const i=r.thunk();i instanceof Promise?i.then(s=>{this._active--,r.resolve(s),this.runNext()},s=>{this._active--,r.reject(s),this.runNext()}):(this._active--,
r.resolve(i),this.runNext())}catch(i){this._active--,r.reject(i),this.runNext()}}}return id.Semaphore=e,id}var bA;function A5(){if(bA)return Es;bA=1,Object.defineProperty(Es,"__esModule",{value:!0}),Es.ReadableStreamMessageReader=Es.AbstractMessageReader=Es.MessageReader=void 0;const t=co(),e=Yu(),n=Ml(),r=wA();var i;(function(l){function c(u){let d=u;return d&&e.func(d.listen)&&e.func(d.dispose)&&e.func(d.onError)&&e.func(d.onClose)&&e.func(d.onPartialMessage)}l.is=c})(i||(Es.MessageReader=i={}));
class s{constructor(){this.errorEmitter=new n.Emitter,this.closeEmitter=new n.Emitter,this.partialMessageEmitter=new n.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(c){this.errorEmitter.fire(this.asError(c))}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}get onPartialMessage(){return this.partialMessageEmitter.event}firePartialMessage(c){this.partialMessageEmitter.fire(c)}asError(c){
return c instanceof Error?c:new Error(`Reader received error. Reason: ${e.string(c.message)?c.message:"unknown"}`)}}Es.AbstractMessageReader=s;var a;(function(l){function c(u){let d,f;const p=new Map;let m;const w=new Map;if(u===void 0||typeof u=="string")d=u??"utf-8";else{if(d=u.charset??"utf-8",u.contentDecoder!==void 0&&(f=u.contentDecoder,p.set(f.name,f)),u.contentDecoders!==void 0)for(const v of u.contentDecoders)p.set(v.name,v);if(u.contentTypeDecoder!==void 0&&(m=u.contentTypeDecoder,w.set(
m.name,m)),u.contentTypeDecoders!==void 0)for(const v of u.contentTypeDecoders)w.set(v.name,v)}return m===void 0&&(m=(0,t.default)().applicationJson.decoder,w.set(m.name,m)),{charset:d,contentDecoder:f,contentDecoders:p,contentTypeDecoder:m,contentTypeDecoders:w}}l.fromOptions=c})(a||(a={}));class o extends s{constructor(c,u){super(),this.readable=c,this.options=a.fromOptions(u),this.buffer=(0,t.default)().messageBuffer.create(this.options.charset),this._partialMessageTimeout=1e4,this.nextMessageLength=
-1,this.messageToken=0,this.readSemaphore=new r.Semaphore(1)}set partialMessageTimeout(c){this._partialMessageTimeout=c}get partialMessageTimeout(){return this._partialMessageTimeout}listen(c){this.nextMessageLength=-1,this.messageToken=0,this.partialMessageTimer=void 0,this.callback=c;const u=this.readable.onData(d=>{this.onData(d)});return this.readable.onError(d=>this.fireError(d)),this.readable.onClose(()=>this.fireClose()),u}onData(c){try{for(this.buffer.append(c);;){if(this.nextMessageLength===
-1){const d=this.buffer.tryReadHeaders(!0);if(!d)return;const f=d.get("content-length");if(!f){this.fireError(new Error(`Header must provide a Content-Length property.
${JSON.stringify(Object.fromEntries(d))}`));return}const p=parseInt(f);if(isNaN(p)){this.fireError(new Error(`Content-Length value must be a number. Got ${f}`));return}this.nextMessageLength=p}const u=this.buffer.tryReadBody(this.nextMessageLength);if(u===void 0){this.setPartialMessageTimer();return}this.clearPartialMessageTimer(),this.nextMessageLength=-1,this.readSemaphore.lock(async()=>{const d=this.options.contentDecoder!==void 0?await this.options.contentDecoder.decode(u):u,f=await this.options.
contentTypeDecoder.decode(d,this.options);this.callback(f)}).catch(d=>{this.fireError(d)})}}catch(u){this.fireError(u)}}clearPartialMessageTimer(){this.partialMessageTimer&&(this.partialMessageTimer.dispose(),this.partialMessageTimer=void 0)}setPartialMessageTimer(){this.clearPartialMessageTimer(),!(this._partialMessageTimeout<=0)&&(this.partialMessageTimer=(0,t.default)().timer.setTimeout((c,u)=>{this.partialMessageTimer=void 0,c===this.messageToken&&(this.firePartialMessage({messageToken:c,waitingTime:u}),
this.setPartialMessageTimer())},this._partialMessageTimeout,this.messageToken,this._partialMessageTimeout))}}return Es.ReadableStreamMessageReader=o,Es}var Ps={},kA;function I5(){if(kA)return Ps;kA=1,Object.defineProperty(Ps,"__esModule",{value:!0}),Ps.WriteableStreamMessageWriter=Ps.AbstractMessageWriter=Ps.MessageWriter=void 0;const t=co(),e=Yu(),n=wA(),r=Ml(),i="Content-Length: ",s=`\r
`;var a;(function(u){function d(f){let p=f;return p&&e.func(p.dispose)&&e.func(p.onClose)&&e.func(p.onError)&&e.func(p.write)}u.is=d})(a||(Ps.MessageWriter=a={}));class o{constructor(){this.errorEmitter=new r.Emitter,this.closeEmitter=new r.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(d,f,p){this.errorEmitter.fire([this.asError(d),f,p])}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(
void 0)}asError(d){return d instanceof Error?d:new Error(`Writer received error. Reason: ${e.string(d.message)?d.message:"unknown"}`)}}Ps.AbstractMessageWriter=o;var l;(function(u){function d(f){return f===void 0||typeof f=="string"?{charset:f??"utf-8",contentTypeEncoder:(0,t.default)().applicationJson.encoder}:{charset:f.charset??"utf-8",contentEncoder:f.contentEncoder,contentTypeEncoder:f.contentTypeEncoder??(0,t.default)().applicationJson.encoder}}u.fromOptions=d})(l||(l={}));class c extends o{constructor(d,f){
super(),this.writable=d,this.options=l.fromOptions(f),this.errorCount=0,this.writeSemaphore=new n.Semaphore(1),this.writable.onError(p=>this.fireError(p)),this.writable.onClose(()=>this.fireClose())}async write(d){return this.writeSemaphore.lock(async()=>this.options.contentTypeEncoder.encode(d,this.options).then(p=>this.options.contentEncoder!==void 0?this.options.contentEncoder.encode(p):p).then(p=>{const m=[];return m.push(i,p.byteLength.toString(),s),m.push(s),this.doWrite(d,m,p)},p=>{throw this.
fireError(p),p}))}async doWrite(d,f,p){try{return await this.writable.write(f.join(""),"ascii"),this.writable.write(p)}catch(m){return this.handleError(m,d),Promise.reject(m)}}handleError(d,f){this.errorCount++,this.fireError(d,f,this.errorCount)}end(){this.writable.end()}}return Ps.WriteableStreamMessageWriter=c,Ps}var sd={},_A;function N5(){if(_A)return sd;_A=1,Object.defineProperty(sd,"__esModule",{value:!0}),sd.AbstractMessageBuffer=void 0;const t=13,e=10,n=`\r
`;class r{constructor(s="utf-8"){this._encoding=s,this._chunks=[],this._totalLength=0}get encoding(){return this._encoding}append(s){const a=typeof s=="string"?this.fromString(s,this._encoding):s;this._chunks.push(a),this._totalLength+=a.byteLength}tryReadHeaders(s=!1){if(this._chunks.length===0)return;let a=0,o=0,l=0,c=0;e:for(;o<this._chunks.length;){const p=this._chunks[o];for(l=0;l<p.length;){switch(p[l]){case t:switch(a){case 0:a=1;break;case 2:a=3;break;default:a=0}break;case e:switch(a){case 1:
a=2;break;case 3:a=4,l++;break e;default:a=0}break;default:a=0}l++}c+=p.byteLength,o++}if(a!==4)return;const u=this._read(c+l),d=new Map,f=this.toString(u,"ascii").split(n);if(f.length<2)return d;for(let p=0;p<f.length-2;p++){const m=f[p],w=m.indexOf(":");if(w===-1)throw new Error(`Message header must separate key and value using ':'
${m}`);const v=m.substr(0,w),g=m.substr(w+1).trim();d.set(s?v.toLowerCase():v,g)}return d}tryReadBody(s){if(!(this._totalLength<s))return this._read(s)}get numberOfBytes(){return this._totalLength}_read(s){if(s===0)return this.emptyBuffer();if(s>this._totalLength)throw new Error("Cannot read so many bytes!");if(this._chunks[0].byteLength===s){const c=this._chunks[0];return this._chunks.shift(),this._totalLength-=s,this.asNative(c)}if(this._chunks[0].byteLength>s){const c=this._chunks[0],u=this.asNative(
c,s);return this._chunks[0]=c.slice(s),this._totalLength-=s,u}const a=this.allocNative(s);let o=0,l=0;for(;s>0;){const c=this._chunks[l];if(c.byteLength>s){const u=c.slice(0,s);a.set(u,o),o+=s,this._chunks[l]=c.slice(s),this._totalLength-=s,s-=s}else a.set(c,o),o+=c.byteLength,this._chunks.shift(),this._totalLength-=c.byteLength,s-=c.byteLength}return a}}return sd.AbstractMessageBuffer=r,sd}var e_={},RA;function D5(){return RA||(RA=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),
t.createMessageConnection=t.ConnectionOptions=t.MessageStrategy=t.CancellationStrategy=t.CancellationSenderStrategy=t.CancellationReceiverStrategy=t.RequestCancellationReceiverStrategy=t.IdCancellationReceiverStrategy=t.ConnectionStrategy=t.ConnectionError=t.ConnectionErrors=t.LogTraceNotification=t.SetTraceNotification=t.TraceFormat=t.TraceValues=t.Trace=t.NullLogger=t.ProgressType=t.ProgressToken=void 0;const e=co(),n=Yu(),r=pA(),i=mA(),s=Ml(),a=jm();var o;(function($){$.type=new r.NotificationType(
"$/cancelRequest")})(o||(o={}));var l;(function($){function z(j){return typeof j=="string"||typeof j=="number"}$.is=z})(l||(t.ProgressToken=l={}));var c;(function($){$.type=new r.NotificationType("$/progress")})(c||(c={}));class u{constructor(){}}t.ProgressType=u;var d;(function($){function z(j){return n.func(j)}$.is=z})(d||(d={})),t.NullLogger=Object.freeze({error:()=>{},warn:()=>{},info:()=>{},log:()=>{}});var f;(function($){$[$.Off=0]="Off",$[$.Messages=1]="Messages",$[$.Compact=2]="Compact",
$[$.Verbose=3]="Verbose"})(f||(t.Trace=f={}));var p;(function($){$.Off="off",$.Messages="messages",$.Compact="compact",$.Verbose="verbose"})(p||(t.TraceValues=p={})),(function($){function z(U){if(!n.string(U))return $.Off;switch(U=U.toLowerCase(),U){case"off":return $.Off;case"messages":return $.Messages;case"compact":return $.Compact;case"verbose":return $.Verbose;default:return $.Off}}$.fromString=z;function j(U){switch(U){case $.Off:return"off";case $.Messages:return"messages";case $.Compact:
return"compact";case $.Verbose:return"verbose";default:return"off"}}$.toString=j})(f||(t.Trace=f={}));var m;(function($){$.Text="text",$.JSON="json"})(m||(t.TraceFormat=m={})),(function($){function z(j){return n.string(j)?(j=j.toLowerCase(),j==="json"?$.JSON:$.Text):$.Text}$.fromString=z})(m||(t.TraceFormat=m={}));var w;(function($){$.type=new r.NotificationType("$/setTrace")})(w||(t.SetTraceNotification=w={}));var v;(function($){$.type=new r.NotificationType("$/logTrace")})(v||(t.LogTraceNotification=
v={}));var g;(function($){$[$.Closed=1]="Closed",$[$.Disposed=2]="Disposed",$[$.AlreadyListening=3]="AlreadyListening"})(g||(t.ConnectionErrors=g={}));class h extends Error{constructor(z,j){super(j),this.code=z,Object.setPrototypeOf(this,h.prototype)}}t.ConnectionError=h;var y;(function($){function z(j){const U=j;return U&&n.func(U.cancelUndispatched)}$.is=z})(y||(t.ConnectionStrategy=y={}));var b;(function($){function z(j){const U=j;return U&&(U.kind===void 0||U.kind==="id")&&n.func(U.createCancellationTokenSource)&&
(U.dispose===void 0||n.func(U.dispose))}$.is=z})(b||(t.IdCancellationReceiverStrategy=b={}));var R;(function($){function z(j){const U=j;return U&&U.kind==="request"&&n.func(U.createCancellationTokenSource)&&(U.dispose===void 0||n.func(U.dispose))}$.is=z})(R||(t.RequestCancellationReceiverStrategy=R={}));var T;(function($){$.Message=Object.freeze({createCancellationTokenSource(j){return new a.CancellationTokenSource}});function z(j){return b.is(j)||R.is(j)}$.is=z})(T||(t.CancellationReceiverStrategy=
T={}));var N;(function($){$.Message=Object.freeze({sendCancellation(j,U){return j.sendNotification(o.type,{id:U})},cleanup(j){}});function z(j){const U=j;return U&&n.func(U.sendCancellation)&&n.func(U.cleanup)}$.is=z})(N||(t.CancellationSenderStrategy=N={}));var q;(function($){$.Message=Object.freeze({receiver:T.Message,sender:N.Message});function z(j){const U=j;return U&&T.is(U.receiver)&&N.is(U.sender)}$.is=z})(q||(t.CancellationStrategy=q={}));var B;(function($){function z(j){const U=j;return U&&
n.func(U.handleMessage)}$.is=z})(B||(t.MessageStrategy=B={}));var ie;(function($){function z(j){const U=j;return U&&(q.is(U.cancellationStrategy)||y.is(U.connectionStrategy)||B.is(U.messageStrategy))}$.is=z})(ie||(t.ConnectionOptions=ie={}));var L;(function($){$[$.New=1]="New",$[$.Listening=2]="Listening",$[$.Closed=3]="Closed",$[$.Disposed=4]="Disposed"})(L||(L={}));function E($,z,j,U){const W=j!==void 0?j:t.NullLogger;let le=0,ne=0,P=0;const M="2.0";let J;const G=new Map;let _;const I=new Map,
Y=new Map;let se,fe=new i.LinkedMap,_e=new Map,pe=new Set,x=new Map,O=f.Off,K=m.Text,F,ae=L.New;const Re=new s.Emitter,ze=new s.Emitter,ye=new s.Emitter,Me=new s.Emitter,me=new s.Emitter,$e=U&&U.cancellationStrategy?U.cancellationStrategy:q.Message;function Ge(A){if(A===null)throw new Error("Can't send requests with id null since the response can't be correlated.");return"req-"+A.toString()}function st(A){return A===null?"res-unknown-"+(++P).toString():"res-"+A.toString()}function ut(){return"no\
t-"+(++ne).toString()}function ln(A,te){r.Message.isRequest(te)?A.set(Ge(te.id),te):r.Message.isResponse(te)?A.set(st(te.id),te):A.set(ut(),te)}function Yt(A){}function _n(){return ae===L.Listening}function ce(){return ae===L.Closed}function ue(){return ae===L.Disposed}function Se(){(ae===L.New||ae===L.Listening)&&(ae=L.Closed,ze.fire(void 0))}function Ln(A){Re.fire([A,void 0,void 0])}function Cn(A){Re.fire(A)}$.onClose(Se),$.onError(Ln),z.onClose(Se),z.onError(Cn);function Oi(){se||fe.size===0||
(se=(0,e.default)().timer.setImmediate(()=>{se=void 0,ja()}))}function Ys(A){r.Message.isRequest(A)?Fa(A):r.Message.isNotification(A)?Xs(A):r.Message.isResponse(A)?za(A):Qs(A)}function ja(){if(fe.size===0)return;const A=fe.shift();try{const te=U?.messageStrategy;B.is(te)?te.handleMessage(A,Ys):Ys(A)}finally{Oi()}}const qa=A=>{try{if(r.Message.isNotification(A)&&A.method===o.type.method){const te=A.params.id,ge=Ge(te),be=fe.get(ge);if(r.Message.isRequest(be)){const Ye=U?.connectionStrategy,kt=Ye&&
Ye.cancelUndispatched?Ye.cancelUndispatched(be,Yt):void 0;if(kt&&(kt.error!==void 0||kt.result!==void 0)){fe.delete(ge),x.delete(te),kt.id=be.id,Li(kt,A.method,Date.now()),z.write(kt).catch(()=>W.error("Sending response for canceled message failed."));return}}const lt=x.get(te);if(lt!==void 0){lt.cancel(),us(A);return}else pe.add(te)}ln(fe,A)}finally{Oi()}};function Fa(A){if(ue())return;function te(Xe,At,_t){const Rn={jsonrpc:M,id:A.id};Xe instanceof r.ResponseError?Rn.error=Xe.toJson():Rn.result=
Xe===void 0?null:Xe,Li(Rn,At,_t),z.write(Rn).catch(()=>W.error("Sending response failed."))}function ge(Xe,At,_t){const Rn={jsonrpc:M,id:A.id,error:Xe.toJson()};Li(Rn,At,_t),z.write(Rn).catch(()=>W.error("Sending response failed."))}function be(Xe,At,_t){Xe===void 0&&(Xe=null);const Rn={jsonrpc:M,id:A.id,result:Xe};Li(Rn,At,_t),z.write(Rn).catch(()=>W.error("Sending response failed."))}Va(A);const lt=G.get(A.method);let Ye,kt;lt&&(Ye=lt.type,kt=lt.handler);const Ne=Date.now();if(kt||J){const Xe=A.
id??String(Date.now()),At=b.is($e.receiver)?$e.receiver.createCancellationTokenSource(Xe):$e.receiver.createCancellationTokenSource(A);A.id!==null&&pe.has(A.id)&&At.cancel(),A.id!==null&&x.set(Xe,At);try{let _t;if(kt)if(A.params===void 0){if(Ye!==void 0&&Ye.numberOfParams!==0){ge(new r.ResponseError(r.ErrorCodes.InvalidParams,`Request ${A.method} defines ${Ye.numberOfParams} params but received none.`),A.method,Ne);return}_t=kt(At.token)}else if(Array.isArray(A.params)){if(Ye!==void 0&&Ye.parameterStructures===
r.ParameterStructures.byName){ge(new r.ResponseError(r.ErrorCodes.InvalidParams,`Request ${A.method} defines parameters by name but received parameters by position`),A.method,Ne);return}_t=kt(...A.params,At.token)}else{if(Ye!==void 0&&Ye.parameterStructures===r.ParameterStructures.byPosition){ge(new r.ResponseError(r.ErrorCodes.InvalidParams,`Request ${A.method} defines parameters by position but received parameters by name`),A.method,Ne);return}_t=kt(A.params,At.token)}else J&&(_t=J(A.method,A.
params,At.token));const Rn=_t;_t?Rn.then?Rn.then(tr=>{x.delete(Xe),te(tr,A.method,Ne)},tr=>{x.delete(Xe),tr instanceof r.ResponseError?ge(tr,A.method,Ne):tr&&n.string(tr.message)?ge(new r.ResponseError(r.ErrorCodes.InternalError,`Request ${A.method} failed with message: ${tr.message}`),A.method,Ne):ge(new r.ResponseError(r.ErrorCodes.InternalError,`Request ${A.method} failed unexpectedly without providing any details.`),A.method,Ne)}):(x.delete(Xe),te(_t,A.method,Ne)):(x.delete(Xe),be(_t,A.method,
Ne))}catch(_t){x.delete(Xe),_t instanceof r.ResponseError?te(_t,A.method,Ne):_t&&n.string(_t.message)?ge(new r.ResponseError(r.ErrorCodes.InternalError,`Request ${A.method} failed with message: ${_t.message}`),A.method,Ne):ge(new r.ResponseError(r.ErrorCodes.InternalError,`Request ${A.method} failed unexpectedly without providing any details.`),A.method,Ne)}}else ge(new r.ResponseError(r.ErrorCodes.MethodNotFound,`Unhandled method ${A.method}`),A.method,Ne)}function za(A){if(!ue())if(A.id===null)
A.error?W.error(`Received response message without id: Error is: 
${JSON.stringify(A.error,void 0,4)}`):W.error("Received response message without id. No further error information provided.");else{const te=A.id,ge=_e.get(te);if(Ba(A,ge),ge!==void 0){_e.delete(te);try{if(A.error){const be=A.error;ge.reject(new r.ResponseError(be.code,be.message,be.data))}else if(A.result!==void 0)ge.resolve(A.result);else throw new Error("Should never happen.")}catch(be){be.message?W.error(`Response handler '${ge.method}' failed with message: ${be.message}`):W.error(`Response h\
andler '${ge.method}' failed unexpectedly.`)}}}}function Xs(A){if(ue())return;let te,ge;if(A.method===o.type.method){const be=A.params.id;pe.delete(be),us(A);return}else{const be=I.get(A.method);be&&(ge=be.handler,te=be.type)}if(ge||_)try{if(us(A),ge)if(A.params===void 0)te!==void 0&&te.numberOfParams!==0&&te.parameterStructures!==r.ParameterStructures.byName&&W.error(`Notification ${A.method} defines ${te.numberOfParams} params but received none.`),ge();else if(Array.isArray(A.params)){const be=A.
params;A.method===c.type.method&&be.length===2&&l.is(be[0])?ge({token:be[0],value:be[1]}):(te!==void 0&&(te.parameterStructures===r.ParameterStructures.byName&&W.error(`Notification ${A.method} defines parameters by name but received parameters by position`),te.numberOfParams!==A.params.length&&W.error(`Notification ${A.method} defines ${te.numberOfParams} params but received ${be.length} arguments`)),ge(...be))}else te!==void 0&&te.parameterStructures===r.ParameterStructures.byPosition&&W.error(
`Notification ${A.method} defines parameters by position but received parameters by name`),ge(A.params);else _&&_(A.method,A.params)}catch(be){be.message?W.error(`Notification handler '${A.method}' failed with message: ${be.message}`):W.error(`Notification handler '${A.method}' failed unexpectedly.`)}else ye.fire(A)}function Qs(A){if(!A){W.error("Received empty message.");return}W.error(`Received message which is neither a response nor a notification message:
${JSON.stringify(A,null,4)}`);const te=A;if(n.string(te.id)||n.number(te.id)){const ge=te.id,be=_e.get(ge);be&&be.reject(new Error("The received response has neither a result nor an error property."))}}function hr(A){if(A!=null)switch(O){case f.Verbose:return JSON.stringify(A,null,4);case f.Compact:return JSON.stringify(A);default:return}}function Ua(A){if(!(O===f.Off||!F))if(K===m.Text){let te;(O===f.Verbose||O===f.Compact)&&A.params&&(te=`Params: ${hr(A.params)}

`),F.log(`Sending request '${A.method} - (${A.id})'.`,te)}else Jr("send-request",A)}function Ha(A){if(!(O===f.Off||!F))if(K===m.Text){let te;(O===f.Verbose||O===f.Compact)&&(A.params?te=`Params: ${hr(A.params)}

`:te=`No parameters provided.

`),F.log(`Sending notification '${A.method}'.`,te)}else Jr("send-notification",A)}function Li(A,te,ge){if(!(O===f.Off||!F))if(K===m.Text){let be;(O===f.Verbose||O===f.Compact)&&(A.error&&A.error.data?be=`Error data: ${hr(A.error.data)}

`:A.result?be=`Result: ${hr(A.result)}

`:A.error===void 0&&(be=`No result returned.

`)),F.log(`Sending response '${te} - (${A.id})'. Processing request took ${Date.now()-ge}ms`,be)}else Jr("send-response",A)}function Va(A){if(!(O===f.Off||!F))if(K===m.Text){let te;(O===f.Verbose||O===f.Compact)&&A.params&&(te=`Params: ${hr(A.params)}

`),F.log(`Received request '${A.method} - (${A.id})'.`,te)}else Jr("receive-request",A)}function us(A){if(!(O===f.Off||!F||A.method===v.type.method))if(K===m.Text){let te;(O===f.Verbose||O===f.Compact)&&(A.params?te=`Params: ${hr(A.params)}

`:te=`No parameters provided.

`),F.log(`Received notification '${A.method}'.`,te)}else Jr("receive-notification",A)}function Ba(A,te){if(!(O===f.Off||!F))if(K===m.Text){let ge;if((O===f.Verbose||O===f.Compact)&&(A.error&&A.error.data?ge=`Error data: ${hr(A.error.data)}

`:A.result?ge=`Result: ${hr(A.result)}

`:A.error===void 0&&(ge=`No result returned.

`)),te){const be=A.error?` Request failed: ${A.error.message} (${A.error.code}).`:"";F.log(`Received response '${te.method} - (${A.id})' in ${Date.now()-te.timerStart}ms.${be}`,ge)}else F.log(`Received response ${A.id} without active response promise.`,ge)}else Jr("receive-response",A)}function Jr(A,te){if(!F||O===f.Off)return;const ge={isLSPMessage:!0,type:A,message:te,timestamp:Date.now()};F.log(ge)}function ui(){if(ce())throw new h(g.Closed,"Connection is closed.");if(ue())throw new h(g.Disposed,
"Connection is disposed.")}function fl(){if(_n())throw new h(g.AlreadyListening,"Connection is already listening")}function X(){if(!_n())throw new Error("Call listen() first.")}function C(A){return A===void 0?null:A}function H(A){if(A!==null)return A}function k(A){return A!=null&&!Array.isArray(A)&&typeof A=="object"}function D(A,te){switch(A){case r.ParameterStructures.auto:return k(te)?H(te):[C(te)];case r.ParameterStructures.byName:if(!k(te))throw new Error("Received parameters by name but pa\
ram is not an object literal.");return H(te);case r.ParameterStructures.byPosition:return[C(te)];default:throw new Error(`Unknown parameter structure ${A.toString()}`)}}function S(A,te){let ge;const be=A.numberOfParams;switch(be){case 0:ge=void 0;break;case 1:ge=D(A.parameterStructures,te[0]);break;default:ge=[];for(let lt=0;lt<te.length&&lt<be;lt++)ge.push(C(te[lt]));if(te.length<be)for(let lt=te.length;lt<be;lt++)ge.push(null);break}return ge}const V={sendNotification:(A,...te)=>{ui();let ge,be;
if(n.string(A)){ge=A;const Ye=te[0];let kt=0,Ne=r.ParameterStructures.auto;r.ParameterStructures.is(Ye)&&(kt=1,Ne=Ye);let Xe=te.length;const At=Xe-kt;switch(At){case 0:be=void 0;break;case 1:be=D(Ne,te[kt]);break;default:if(Ne===r.ParameterStructures.byName)throw new Error(`Received ${At} parameters for 'by Name' notification parameter structure.`);be=te.slice(kt,Xe).map(_t=>C(_t));break}}else{const Ye=te;ge=A.method,be=S(A,Ye)}const lt={jsonrpc:M,method:ge,params:be};return Ha(lt),z.write(lt).catch(
Ye=>{throw W.error("Sending notification failed."),Ye})},onNotification:(A,te)=>{ui();let ge;return n.func(A)?_=A:te&&(n.string(A)?(ge=A,I.set(A,{type:void 0,handler:te})):(ge=A.method,I.set(A.method,{type:A,handler:te}))),{dispose:()=>{ge!==void 0?I.delete(ge):_=void 0}}},onProgress:(A,te,ge)=>{if(Y.has(te))throw new Error(`Progress handler for token ${te} already registered`);return Y.set(te,ge),{dispose:()=>{Y.delete(te)}}},sendProgress:(A,te,ge)=>V.sendNotification(c.type,{token:te,value:ge}),
onUnhandledProgress:Me.event,sendRequest:(A,...te)=>{ui(),X();let ge,be,lt;if(n.string(A)){ge=A;const Xe=te[0],At=te[te.length-1];let _t=0,Rn=r.ParameterStructures.auto;r.ParameterStructures.is(Xe)&&(_t=1,Rn=Xe);let tr=te.length;a.CancellationToken.is(At)&&(tr=tr-1,lt=At);const Mi=tr-_t;switch(Mi){case 0:be=void 0;break;case 1:be=D(Rn,te[_t]);break;default:if(Rn===r.ParameterStructures.byName)throw new Error(`Received ${Mi} parameters for 'by Name' request parameter structure.`);be=te.slice(_t,tr).
map(uq=>C(uq));break}}else{const Xe=te;ge=A.method,be=S(A,Xe);const At=A.numberOfParams;lt=a.CancellationToken.is(Xe[At])?Xe[At]:void 0}const Ye=le++;let kt;lt&&(kt=lt.onCancellationRequested(()=>{const Xe=$e.sender.sendCancellation(V,Ye);return Xe===void 0?(W.log(`Received no promise from cancellation strategy when cancelling id ${Ye}`),Promise.resolve()):Xe.catch(()=>{W.log(`Sending cancellation messages for id ${Ye} failed`)})}));const Ne={jsonrpc:M,id:Ye,method:ge,params:be};return Ua(Ne),typeof $e.
sender.enableCancellation=="function"&&$e.sender.enableCancellation(Ne),new Promise(async(Xe,At)=>{const _t=Mi=>{Xe(Mi),$e.sender.cleanup(Ye),kt?.dispose()},Rn=Mi=>{At(Mi),$e.sender.cleanup(Ye),kt?.dispose()},tr={method:ge,timerStart:Date.now(),resolve:_t,reject:Rn};try{_e.set(Ye,tr),await z.write(Ne)}catch(Mi){throw _e.delete(Ye),tr.reject(new r.ResponseError(r.ErrorCodes.MessageWriteError,Mi.message?Mi.message:"Unknown reason")),W.error("Sending request failed."),Mi}})},onRequest:(A,te)=>{ui();
let ge=null;return d.is(A)?(ge=void 0,J=A):n.string(A)?(ge=null,te!==void 0&&(ge=A,G.set(A,{handler:te,type:void 0}))):te!==void 0&&(ge=A.method,G.set(A.method,{type:A,handler:te})),{dispose:()=>{ge!==null&&(ge!==void 0?G.delete(ge):J=void 0)}}},hasPendingResponse:()=>_e.size>0,trace:async(A,te,ge)=>{let be=!1,lt=m.Text;ge!==void 0&&(n.boolean(ge)?be=ge:(be=ge.sendNotification||!1,lt=ge.traceFormat||m.Text)),O=A,K=lt,O===f.Off?F=void 0:F=te,be&&!ce()&&!ue()&&await V.sendNotification(w.type,{value:f.
toString(A)})},onError:Re.event,onClose:ze.event,onUnhandledNotification:ye.event,onDispose:me.event,end:()=>{z.end()},dispose:()=>{if(ue())return;ae=L.Disposed,me.fire(void 0);const A=new r.ResponseError(r.ErrorCodes.PendingResponseRejected,"Pending response rejected since connection got disposed");for(const te of _e.values())te.reject(A);_e=new Map,x=new Map,pe=new Set,fe=new i.LinkedMap,n.func(z.dispose)&&z.dispose(),n.func($.dispose)&&$.dispose()},listen:()=>{ui(),fl(),ae=L.Listening,$.listen(
qa)},inspect:()=>{(0,e.default)().console.log("inspect")}};return V.onNotification(v.type,A=>{if(O===f.Off||!F)return;const te=O===f.Verbose||O===f.Compact;F.log(A.message,te?A.verbose:void 0)}),V.onNotification(c.type,A=>{const te=Y.get(A.token);te?te(A.value):Me.fire(A)}),V}t.createMessageConnection=E})(e_)),e_}var SA;function t_(){return SA||(SA=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ProgressType=t.ProgressToken=t.createMessageConnection=t.NullLogger=t.ConnectionOptions=
t.ConnectionStrategy=t.AbstractMessageBuffer=t.WriteableStreamMessageWriter=t.AbstractMessageWriter=t.MessageWriter=t.ReadableStreamMessageReader=t.AbstractMessageReader=t.MessageReader=t.SharedArrayReceiverStrategy=t.SharedArraySenderStrategy=t.CancellationToken=t.CancellationTokenSource=t.Emitter=t.Event=t.Disposable=t.LRUCache=t.Touch=t.LinkedMap=t.ParameterStructures=t.NotificationType9=t.NotificationType8=t.NotificationType7=t.NotificationType6=t.NotificationType5=t.NotificationType4=t.NotificationType3=
t.NotificationType2=t.NotificationType1=t.NotificationType0=t.NotificationType=t.ErrorCodes=t.ResponseError=t.RequestType9=t.RequestType8=t.RequestType7=t.RequestType6=t.RequestType5=t.RequestType4=t.RequestType3=t.RequestType2=t.RequestType1=t.RequestType0=t.RequestType=t.Message=t.RAL=void 0,t.MessageStrategy=t.CancellationStrategy=t.CancellationSenderStrategy=t.CancellationReceiverStrategy=t.ConnectionError=t.ConnectionErrors=t.LogTraceNotification=t.SetTraceNotification=t.TraceFormat=t.TraceValues=
t.Trace=void 0;const e=pA();Object.defineProperty(t,"Message",{enumerable:!0,get:function(){return e.Message}}),Object.defineProperty(t,"RequestType",{enumerable:!0,get:function(){return e.RequestType}}),Object.defineProperty(t,"RequestType0",{enumerable:!0,get:function(){return e.RequestType0}}),Object.defineProperty(t,"RequestType1",{enumerable:!0,get:function(){return e.RequestType1}}),Object.defineProperty(t,"RequestType2",{enumerable:!0,get:function(){return e.RequestType2}}),Object.defineProperty(
t,"RequestType3",{enumerable:!0,get:function(){return e.RequestType3}}),Object.defineProperty(t,"RequestType4",{enumerable:!0,get:function(){return e.RequestType4}}),Object.defineProperty(t,"RequestType5",{enumerable:!0,get:function(){return e.RequestType5}}),Object.defineProperty(t,"RequestType6",{enumerable:!0,get:function(){return e.RequestType6}}),Object.defineProperty(t,"RequestType7",{enumerable:!0,get:function(){return e.RequestType7}}),Object.defineProperty(t,"RequestType8",{enumerable:!0,
get:function(){return e.RequestType8}}),Object.defineProperty(t,"RequestType9",{enumerable:!0,get:function(){return e.RequestType9}}),Object.defineProperty(t,"ResponseError",{enumerable:!0,get:function(){return e.ResponseError}}),Object.defineProperty(t,"ErrorCodes",{enumerable:!0,get:function(){return e.ErrorCodes}}),Object.defineProperty(t,"NotificationType",{enumerable:!0,get:function(){return e.NotificationType}}),Object.defineProperty(t,"NotificationType0",{enumerable:!0,get:function(){return e.
NotificationType0}}),Object.defineProperty(t,"NotificationType1",{enumerable:!0,get:function(){return e.NotificationType1}}),Object.defineProperty(t,"NotificationType2",{enumerable:!0,get:function(){return e.NotificationType2}}),Object.defineProperty(t,"NotificationType3",{enumerable:!0,get:function(){return e.NotificationType3}}),Object.defineProperty(t,"NotificationType4",{enumerable:!0,get:function(){return e.NotificationType4}}),Object.defineProperty(t,"NotificationType5",{enumerable:!0,get:function(){
return e.NotificationType5}}),Object.defineProperty(t,"NotificationType6",{enumerable:!0,get:function(){return e.NotificationType6}}),Object.defineProperty(t,"NotificationType7",{enumerable:!0,get:function(){return e.NotificationType7}}),Object.defineProperty(t,"NotificationType8",{enumerable:!0,get:function(){return e.NotificationType8}}),Object.defineProperty(t,"NotificationType9",{enumerable:!0,get:function(){return e.NotificationType9}}),Object.defineProperty(t,"ParameterStructures",{enumerable:!0,
get:function(){return e.ParameterStructures}});const n=mA();Object.defineProperty(t,"LinkedMap",{enumerable:!0,get:function(){return n.LinkedMap}}),Object.defineProperty(t,"LRUCache",{enumerable:!0,get:function(){return n.LRUCache}}),Object.defineProperty(t,"Touch",{enumerable:!0,get:function(){return n.Touch}});const r=C5();Object.defineProperty(t,"Disposable",{enumerable:!0,get:function(){return r.Disposable}});const i=Ml();Object.defineProperty(t,"Event",{enumerable:!0,get:function(){return i.
Event}}),Object.defineProperty(t,"Emitter",{enumerable:!0,get:function(){return i.Emitter}});const s=jm();Object.defineProperty(t,"CancellationTokenSource",{enumerable:!0,get:function(){return s.CancellationTokenSource}}),Object.defineProperty(t,"CancellationToken",{enumerable:!0,get:function(){return s.CancellationToken}});const a=x5();Object.defineProperty(t,"SharedArraySenderStrategy",{enumerable:!0,get:function(){return a.SharedArraySenderStrategy}}),Object.defineProperty(t,"SharedArrayRecei\
verStrategy",{enumerable:!0,get:function(){return a.SharedArrayReceiverStrategy}});const o=A5();Object.defineProperty(t,"MessageReader",{enumerable:!0,get:function(){return o.MessageReader}}),Object.defineProperty(t,"AbstractMessageReader",{enumerable:!0,get:function(){return o.AbstractMessageReader}}),Object.defineProperty(t,"ReadableStreamMessageReader",{enumerable:!0,get:function(){return o.ReadableStreamMessageReader}});const l=I5();Object.defineProperty(t,"MessageWriter",{enumerable:!0,get:function(){
return l.MessageWriter}}),Object.defineProperty(t,"AbstractMessageWriter",{enumerable:!0,get:function(){return l.AbstractMessageWriter}}),Object.defineProperty(t,"WriteableStreamMessageWriter",{enumerable:!0,get:function(){return l.WriteableStreamMessageWriter}});const c=N5();Object.defineProperty(t,"AbstractMessageBuffer",{enumerable:!0,get:function(){return c.AbstractMessageBuffer}});const u=D5();Object.defineProperty(t,"ConnectionStrategy",{enumerable:!0,get:function(){return u.ConnectionStrategy}}),
Object.defineProperty(t,"ConnectionOptions",{enumerable:!0,get:function(){return u.ConnectionOptions}}),Object.defineProperty(t,"NullLogger",{enumerable:!0,get:function(){return u.NullLogger}}),Object.defineProperty(t,"createMessageConnection",{enumerable:!0,get:function(){return u.createMessageConnection}}),Object.defineProperty(t,"ProgressToken",{enumerable:!0,get:function(){return u.ProgressToken}}),Object.defineProperty(t,"ProgressType",{enumerable:!0,get:function(){return u.ProgressType}}),
Object.defineProperty(t,"Trace",{enumerable:!0,get:function(){return u.Trace}}),Object.defineProperty(t,"TraceValues",{enumerable:!0,get:function(){return u.TraceValues}}),Object.defineProperty(t,"TraceFormat",{enumerable:!0,get:function(){return u.TraceFormat}}),Object.defineProperty(t,"SetTraceNotification",{enumerable:!0,get:function(){return u.SetTraceNotification}}),Object.defineProperty(t,"LogTraceNotification",{enumerable:!0,get:function(){return u.LogTraceNotification}}),Object.defineProperty(
t,"ConnectionErrors",{enumerable:!0,get:function(){return u.ConnectionErrors}}),Object.defineProperty(t,"ConnectionError",{enumerable:!0,get:function(){return u.ConnectionError}}),Object.defineProperty(t,"CancellationReceiverStrategy",{enumerable:!0,get:function(){return u.CancellationReceiverStrategy}}),Object.defineProperty(t,"CancellationSenderStrategy",{enumerable:!0,get:function(){return u.CancellationSenderStrategy}}),Object.defineProperty(t,"CancellationStrategy",{enumerable:!0,get:function(){
return u.CancellationStrategy}}),Object.defineProperty(t,"MessageStrategy",{enumerable:!0,get:function(){return u.MessageStrategy}});const d=co();t.RAL=d.default})(Qk)),Qk}var $A;function O5(){if($A)return eg;$A=1,Object.defineProperty(eg,"__esModule",{value:!0});const t=Eq,e=t_();class n extends e.AbstractMessageBuffer{constructor(l="utf-8"){super(l)}emptyBuffer(){return n.emptyBuffer}fromString(l,c){return Buffer.from(l,c)}toString(l,c){return l instanceof Buffer?l.toString(c):new t.TextDecoder(
c).decode(l)}asNative(l,c){return c===void 0?l instanceof Buffer?l:Buffer.from(l):l instanceof Buffer?l.slice(0,c):Buffer.from(l,0,c)}allocNative(l){return Buffer.allocUnsafe(l)}}n.emptyBuffer=Buffer.allocUnsafe(0);class r{constructor(l){this.stream=l}onClose(l){return this.stream.on("close",l),e.Disposable.create(()=>this.stream.off("close",l))}onError(l){return this.stream.on("error",l),e.Disposable.create(()=>this.stream.off("error",l))}onEnd(l){return this.stream.on("end",l),e.Disposable.create(
()=>this.stream.off("end",l))}onData(l){return this.stream.on("data",l),e.Disposable.create(()=>this.stream.off("data",l))}}class i{constructor(l){this.stream=l}onClose(l){return this.stream.on("close",l),e.Disposable.create(()=>this.stream.off("close",l))}onError(l){return this.stream.on("error",l),e.Disposable.create(()=>this.stream.off("error",l))}onEnd(l){return this.stream.on("end",l),e.Disposable.create(()=>this.stream.off("end",l))}write(l,c){return new Promise((u,d)=>{const f=p=>{p==null?
u():d(p)};typeof l=="string"?this.stream.write(l,c,f):this.stream.write(l,f)})}end(){this.stream.end()}}const s=Object.freeze({messageBuffer:Object.freeze({create:o=>new n(o)}),applicationJson:Object.freeze({encoder:Object.freeze({name:"application/json",encode:(o,l)=>{try{return Promise.resolve(Buffer.from(JSON.stringify(o,void 0,0),l.charset))}catch(c){return Promise.reject(c)}}}),decoder:Object.freeze({name:"application/json",decode:(o,l)=>{try{return o instanceof Buffer?Promise.resolve(JSON.
parse(o.toString(l.charset))):Promise.resolve(JSON.parse(new t.TextDecoder(l.charset).decode(o)))}catch(c){return Promise.reject(c)}}})}),stream:Object.freeze({asReadableStream:o=>new r(o),asWritableStream:o=>new i(o)}),console,timer:Object.freeze({setTimeout(o,l,...c){const u=setTimeout(o,l,...c);return{dispose:()=>clearTimeout(u)}},setImmediate(o,...l){const c=setImmediate(o,...l);return{dispose:()=>clearImmediate(c)}},setInterval(o,l,...c){const u=setInterval(o,l,...c);return{dispose:()=>clearInterval(
u)}}})});function a(){return s}return(function(o){function l(){e.RAL.install(s)}o.install=l})(a||(a={})),eg.default=a,eg}var TA;function wo(){return TA||(TA=1,(function(t){var e=yo&&yo.__createBinding||(Object.create?(function(L,E,$,z){z===void 0&&(z=$);var j=Object.getOwnPropertyDescriptor(E,$);(!j||("get"in j?!E.__esModule:j.writable||j.configurable))&&(j={enumerable:!0,get:function(){return E[$]}}),Object.defineProperty(L,z,j)}):(function(L,E,$,z){z===void 0&&(z=$),L[z]=E[$]})),n=yo&&yo.__exportStar||
function(L,E){for(var $ in L)$!=="default"&&!Object.prototype.hasOwnProperty.call(E,$)&&e(E,L,$)};Object.defineProperty(t,"__esModule",{value:!0}),t.createMessageConnection=t.createServerSocketTransport=t.createClientSocketTransport=t.createServerPipeTransport=t.createClientPipeTransport=t.generateRandomPipeName=t.StreamMessageWriter=t.StreamMessageReader=t.SocketMessageWriter=t.SocketMessageReader=t.PortMessageWriter=t.PortMessageReader=t.IPCMessageWriter=t.IPCMessageReader=void 0;const r=O5();
r.default.install();const i=ww,s=Pq,a=Z$,o=Cq,l=t_();n(t_(),t);class c extends l.AbstractMessageReader{constructor(E){super(),this.process=E;let $=this.process;$.on("error",z=>this.fireError(z)),$.on("close",()=>this.fireClose())}listen(E){return this.process.on("message",E),l.Disposable.create(()=>this.process.off("message",E))}}t.IPCMessageReader=c;class u extends l.AbstractMessageWriter{constructor(E){super(),this.process=E,this.errorCount=0;const $=this.process;$.on("error",z=>this.fireError(
z)),$.on("close",()=>this.fireClose)}write(E){try{return typeof this.process.send=="function"&&this.process.send(E,void 0,void 0,$=>{$?(this.errorCount++,this.handleError($,E)):this.errorCount=0}),Promise.resolve()}catch($){return this.handleError($,E),Promise.reject($)}}handleError(E,$){this.errorCount++,this.fireError(E,$,this.errorCount)}end(){}}t.IPCMessageWriter=u;class d extends l.AbstractMessageReader{constructor(E){super(),this.onData=new l.Emitter,E.on("close",()=>this.fireClose),E.on("\
error",$=>this.fireError($)),E.on("message",$=>{this.onData.fire($)})}listen(E){return this.onData.event(E)}}t.PortMessageReader=d;class f extends l.AbstractMessageWriter{constructor(E){super(),this.port=E,this.errorCount=0,E.on("close",()=>this.fireClose()),E.on("error",$=>this.fireError($))}write(E){try{return this.port.postMessage(E),Promise.resolve()}catch($){return this.handleError($,E),Promise.reject($)}}handleError(E,$){this.errorCount++,this.fireError(E,$,this.errorCount)}end(){}}t.PortMessageWriter=
f;class p extends l.ReadableStreamMessageReader{constructor(E,$="utf-8"){super((0,r.default)().stream.asReadableStream(E),$)}}t.SocketMessageReader=p;class m extends l.WriteableStreamMessageWriter{constructor(E,$){super((0,r.default)().stream.asWritableStream(E),$),this.socket=E}dispose(){super.dispose(),this.socket.destroy()}}t.SocketMessageWriter=m;class w extends l.ReadableStreamMessageReader{constructor(E,$){super((0,r.default)().stream.asReadableStream(E),$)}}t.StreamMessageReader=w;class v extends l.
WriteableStreamMessageWriter{constructor(E,$){super((0,r.default)().stream.asWritableStream(E),$)}}t.StreamMessageWriter=v;const g=process.env.XDG_RUNTIME_DIR,h=new Map([["linux",107],["darwin",103]]);function y(){const L=(0,a.randomBytes)(21).toString("hex");if(process.platform==="win32")return`\\\\.\\pipe\\vscode-jsonrpc-${L}-sock`;let E;g?E=i.join(g,`vscode-ipc-${L}.sock`):E=i.join(s.tmpdir(),`vscode-${L}.sock`);const $=h.get(process.platform);return $!==void 0&&E.length>$&&(0,r.default)().console.
warn(`WARNING: IPC handle "${E}" is longer than ${$} characters.`),E}t.generateRandomPipeName=y;function b(L,E="utf-8"){let $;const z=new Promise((j,U)=>{$=j});return new Promise((j,U)=>{let W=(0,o.createServer)(le=>{W.close(),$([new p(le,E),new m(le,E)])});W.on("error",U),W.listen(L,()=>{W.removeListener("error",U),j({onConnected:()=>z})})})}t.createClientPipeTransport=b;function R(L,E="utf-8"){const $=(0,o.createConnection)(L);return[new p($,E),new m($,E)]}t.createServerPipeTransport=R;function T(L,E="\
utf-8"){let $;const z=new Promise((j,U)=>{$=j});return new Promise((j,U)=>{const W=(0,o.createServer)(le=>{W.close(),$([new p(le,E),new m(le,E)])});W.on("error",U),W.listen(L,"127.0.0.1",()=>{W.removeListener("error",U),j({onConnected:()=>z})})})}t.createClientSocketTransport=T;function N(L,E="utf-8"){const $=(0,o.createConnection)(L,"127.0.0.1");return[new p($,E),new m($,E)]}t.createServerSocketTransport=N;function q(L){const E=L;return E.read!==void 0&&E.addListener!==void 0}function B(L){const E=L;
return E.write!==void 0&&E.addListener!==void 0}function ie(L,E,$,z){$||($=l.NullLogger);const j=q(L)?new w(L):L,U=B(E)?new v(E):E;return l.ConnectionStrategy.is(z)&&(z={connectionStrategy:z}),(0,l.createMessageConnection)(j,U,$,z)}t.createMessageConnection=ie})(yo)),yo}var n_,EA;function PA(){return EA||(EA=1,n_=wo()),n_}var bo={};function L5(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugi\
n-commonjs appropriately for this require call to work.')}var tg={exports:{}},CA;function r_(){return CA||(CA=1,(function(t,e){(function(n){{var r=n(L5,e);r!==void 0&&(t.exports=r)}})(function(n,r){Object.defineProperty(r,"__esModule",{value:!0}),r.TextDocument=r.EOL=r.WorkspaceFolder=r.InlineCompletionContext=r.SelectedCompletionInfo=r.InlineCompletionTriggerKind=r.InlineCompletionList=r.InlineCompletionItem=r.StringValue=r.InlayHint=r.InlayHintLabelPart=r.InlayHintKind=r.InlineValueContext=r.InlineValueEvaluatableExpression=
r.InlineValueVariableLookup=r.InlineValueText=r.SemanticTokens=r.SemanticTokenModifiers=r.SemanticTokenTypes=r.SelectionRange=r.DocumentLink=r.FormattingOptions=r.CodeLens=r.CodeAction=r.CodeActionContext=r.CodeActionTriggerKind=r.CodeActionKind=r.DocumentSymbol=r.WorkspaceSymbol=r.SymbolInformation=r.SymbolTag=r.SymbolKind=r.DocumentHighlight=r.DocumentHighlightKind=r.SignatureInformation=r.ParameterInformation=r.Hover=r.MarkedString=r.CompletionList=r.CompletionItem=r.CompletionItemLabelDetails=
r.InsertTextMode=r.InsertReplaceEdit=r.CompletionItemTag=r.InsertTextFormat=r.CompletionItemKind=r.MarkupContent=r.MarkupKind=r.TextDocumentItem=r.OptionalVersionedTextDocumentIdentifier=r.VersionedTextDocumentIdentifier=r.TextDocumentIdentifier=r.WorkspaceChange=r.WorkspaceEdit=r.DeleteFile=r.RenameFile=r.CreateFile=r.TextDocumentEdit=r.AnnotatedTextEdit=r.ChangeAnnotationIdentifier=r.ChangeAnnotation=r.TextEdit=r.Command=r.Diagnostic=r.CodeDescription=r.DiagnosticTag=r.DiagnosticSeverity=r.DiagnosticRelatedInformation=
r.FoldingRange=r.FoldingRangeKind=r.ColorPresentation=r.ColorInformation=r.Color=r.LocationLink=r.Location=r.Range=r.Position=r.uinteger=r.integer=r.URI=r.DocumentUri=void 0;var i;(function(C){function H(k){return typeof k=="string"}C.is=H})(i||(r.DocumentUri=i={}));var s;(function(C){function H(k){return typeof k=="string"}C.is=H})(s||(r.URI=s={}));var a;(function(C){C.MIN_VALUE=-2147483648,C.MAX_VALUE=2147483647;function H(k){return typeof k=="number"&&C.MIN_VALUE<=k&&k<=C.MAX_VALUE}C.is=H})(a||
(r.integer=a={}));var o;(function(C){C.MIN_VALUE=0,C.MAX_VALUE=2147483647;function H(k){return typeof k=="number"&&C.MIN_VALUE<=k&&k<=C.MAX_VALUE}C.is=H})(o||(r.uinteger=o={}));var l;(function(C){function H(D,S){return D===Number.MAX_VALUE&&(D=o.MAX_VALUE),S===Number.MAX_VALUE&&(S=o.MAX_VALUE),{line:D,character:S}}C.create=H;function k(D){var S=D;return X.objectLiteral(S)&&X.uinteger(S.line)&&X.uinteger(S.character)}C.is=k})(l||(r.Position=l={}));var c;(function(C){function H(D,S,V,A){if(X.uinteger(
D)&&X.uinteger(S)&&X.uinteger(V)&&X.uinteger(A))return{start:l.create(D,S),end:l.create(V,A)};if(l.is(D)&&l.is(S))return{start:D,end:S};throw new Error("Range#create called with invalid arguments[".concat(D,", ").concat(S,", ").concat(V,", ").concat(A,"]"))}C.create=H;function k(D){var S=D;return X.objectLiteral(S)&&l.is(S.start)&&l.is(S.end)}C.is=k})(c||(r.Range=c={}));var u;(function(C){function H(D,S){return{uri:D,range:S}}C.create=H;function k(D){var S=D;return X.objectLiteral(S)&&c.is(S.range)&&
(X.string(S.uri)||X.undefined(S.uri))}C.is=k})(u||(r.Location=u={}));var d;(function(C){function H(D,S,V,A){return{targetUri:D,targetRange:S,targetSelectionRange:V,originSelectionRange:A}}C.create=H;function k(D){var S=D;return X.objectLiteral(S)&&c.is(S.targetRange)&&X.string(S.targetUri)&&c.is(S.targetSelectionRange)&&(c.is(S.originSelectionRange)||X.undefined(S.originSelectionRange))}C.is=k})(d||(r.LocationLink=d={}));var f;(function(C){function H(D,S,V,A){return{red:D,green:S,blue:V,alpha:A}}
C.create=H;function k(D){var S=D;return X.objectLiteral(S)&&X.numberRange(S.red,0,1)&&X.numberRange(S.green,0,1)&&X.numberRange(S.blue,0,1)&&X.numberRange(S.alpha,0,1)}C.is=k})(f||(r.Color=f={}));var p;(function(C){function H(D,S){return{range:D,color:S}}C.create=H;function k(D){var S=D;return X.objectLiteral(S)&&c.is(S.range)&&f.is(S.color)}C.is=k})(p||(r.ColorInformation=p={}));var m;(function(C){function H(D,S,V){return{label:D,textEdit:S,additionalTextEdits:V}}C.create=H;function k(D){var S=D;
return X.objectLiteral(S)&&X.string(S.label)&&(X.undefined(S.textEdit)||N.is(S))&&(X.undefined(S.additionalTextEdits)||X.typedArray(S.additionalTextEdits,N.is))}C.is=k})(m||(r.ColorPresentation=m={}));var w;(function(C){C.Comment="comment",C.Imports="imports",C.Region="region"})(w||(r.FoldingRangeKind=w={}));var v;(function(C){function H(D,S,V,A,te,ge){var be={startLine:D,endLine:S};return X.defined(V)&&(be.startCharacter=V),X.defined(A)&&(be.endCharacter=A),X.defined(te)&&(be.kind=te),X.defined(
ge)&&(be.collapsedText=ge),be}C.create=H;function k(D){var S=D;return X.objectLiteral(S)&&X.uinteger(S.startLine)&&X.uinteger(S.startLine)&&(X.undefined(S.startCharacter)||X.uinteger(S.startCharacter))&&(X.undefined(S.endCharacter)||X.uinteger(S.endCharacter))&&(X.undefined(S.kind)||X.string(S.kind))}C.is=k})(v||(r.FoldingRange=v={}));var g;(function(C){function H(D,S){return{location:D,message:S}}C.create=H;function k(D){var S=D;return X.defined(S)&&u.is(S.location)&&X.string(S.message)}C.is=k})(
g||(r.DiagnosticRelatedInformation=g={}));var h;(function(C){C.Error=1,C.Warning=2,C.Information=3,C.Hint=4})(h||(r.DiagnosticSeverity=h={}));var y;(function(C){C.Unnecessary=1,C.Deprecated=2})(y||(r.DiagnosticTag=y={}));var b;(function(C){function H(k){var D=k;return X.objectLiteral(D)&&X.string(D.href)}C.is=H})(b||(r.CodeDescription=b={}));var R;(function(C){function H(D,S,V,A,te,ge){var be={range:D,message:S};return X.defined(V)&&(be.severity=V),X.defined(A)&&(be.code=A),X.defined(te)&&(be.source=
te),X.defined(ge)&&(be.relatedInformation=ge),be}C.create=H;function k(D){var S,V=D;return X.defined(V)&&c.is(V.range)&&X.string(V.message)&&(X.number(V.severity)||X.undefined(V.severity))&&(X.integer(V.code)||X.string(V.code)||X.undefined(V.code))&&(X.undefined(V.codeDescription)||X.string((S=V.codeDescription)===null||S===void 0?void 0:S.href))&&(X.string(V.source)||X.undefined(V.source))&&(X.undefined(V.relatedInformation)||X.typedArray(V.relatedInformation,g.is))}C.is=k})(R||(r.Diagnostic=R=
{}));var T;(function(C){function H(D,S){for(var V=[],A=2;A<arguments.length;A++)V[A-2]=arguments[A];var te={title:D,command:S};return X.defined(V)&&V.length>0&&(te.arguments=V),te}C.create=H;function k(D){var S=D;return X.defined(S)&&X.string(S.title)&&X.string(S.command)}C.is=k})(T||(r.Command=T={}));var N;(function(C){function H(V,A){return{range:V,newText:A}}C.replace=H;function k(V,A){return{range:{start:V,end:V},newText:A}}C.insert=k;function D(V){return{range:V,newText:""}}C.del=D;function S(V){
var A=V;return X.objectLiteral(A)&&X.string(A.newText)&&c.is(A.range)}C.is=S})(N||(r.TextEdit=N={}));var q;(function(C){function H(D,S,V){var A={label:D};return S!==void 0&&(A.needsConfirmation=S),V!==void 0&&(A.description=V),A}C.create=H;function k(D){var S=D;return X.objectLiteral(S)&&X.string(S.label)&&(X.boolean(S.needsConfirmation)||S.needsConfirmation===void 0)&&(X.string(S.description)||S.description===void 0)}C.is=k})(q||(r.ChangeAnnotation=q={}));var B;(function(C){function H(k){var D=k;
return X.string(D)}C.is=H})(B||(r.ChangeAnnotationIdentifier=B={}));var ie;(function(C){function H(V,A,te){return{range:V,newText:A,annotationId:te}}C.replace=H;function k(V,A,te){return{range:{start:V,end:V},newText:A,annotationId:te}}C.insert=k;function D(V,A){return{range:V,newText:"",annotationId:A}}C.del=D;function S(V){var A=V;return N.is(A)&&(q.is(A.annotationId)||B.is(A.annotationId))}C.is=S})(ie||(r.AnnotatedTextEdit=ie={}));var L;(function(C){function H(D,S){return{textDocument:D,edits:S}}
C.create=H;function k(D){var S=D;return X.defined(S)&&M.is(S.textDocument)&&Array.isArray(S.edits)}C.is=k})(L||(r.TextDocumentEdit=L={}));var E;(function(C){function H(D,S,V){var A={kind:"create",uri:D};return S!==void 0&&(S.overwrite!==void 0||S.ignoreIfExists!==void 0)&&(A.options=S),V!==void 0&&(A.annotationId=V),A}C.create=H;function k(D){var S=D;return S&&S.kind==="create"&&X.string(S.uri)&&(S.options===void 0||(S.options.overwrite===void 0||X.boolean(S.options.overwrite))&&(S.options.ignoreIfExists===
void 0||X.boolean(S.options.ignoreIfExists)))&&(S.annotationId===void 0||B.is(S.annotationId))}C.is=k})(E||(r.CreateFile=E={}));var $;(function(C){function H(D,S,V,A){var te={kind:"rename",oldUri:D,newUri:S};return V!==void 0&&(V.overwrite!==void 0||V.ignoreIfExists!==void 0)&&(te.options=V),A!==void 0&&(te.annotationId=A),te}C.create=H;function k(D){var S=D;return S&&S.kind==="rename"&&X.string(S.oldUri)&&X.string(S.newUri)&&(S.options===void 0||(S.options.overwrite===void 0||X.boolean(S.options.
overwrite))&&(S.options.ignoreIfExists===void 0||X.boolean(S.options.ignoreIfExists)))&&(S.annotationId===void 0||B.is(S.annotationId))}C.is=k})($||(r.RenameFile=$={}));var z;(function(C){function H(D,S,V){var A={kind:"delete",uri:D};return S!==void 0&&(S.recursive!==void 0||S.ignoreIfNotExists!==void 0)&&(A.options=S),V!==void 0&&(A.annotationId=V),A}C.create=H;function k(D){var S=D;return S&&S.kind==="delete"&&X.string(S.uri)&&(S.options===void 0||(S.options.recursive===void 0||X.boolean(S.options.
recursive))&&(S.options.ignoreIfNotExists===void 0||X.boolean(S.options.ignoreIfNotExists)))&&(S.annotationId===void 0||B.is(S.annotationId))}C.is=k})(z||(r.DeleteFile=z={}));var j;(function(C){function H(k){var D=k;return D&&(D.changes!==void 0||D.documentChanges!==void 0)&&(D.documentChanges===void 0||D.documentChanges.every(function(S){return X.string(S.kind)?E.is(S)||$.is(S)||z.is(S):L.is(S)}))}C.is=H})(j||(r.WorkspaceEdit=j={}));var U=(function(){function C(H,k){this.edits=H,this.changeAnnotations=
k}return C.prototype.insert=function(H,k,D){var S,V;if(D===void 0?S=N.insert(H,k):B.is(D)?(V=D,S=ie.insert(H,k,D)):(this.assertChangeAnnotations(this.changeAnnotations),V=this.changeAnnotations.manage(D),S=ie.insert(H,k,V)),this.edits.push(S),V!==void 0)return V},C.prototype.replace=function(H,k,D){var S,V;if(D===void 0?S=N.replace(H,k):B.is(D)?(V=D,S=ie.replace(H,k,D)):(this.assertChangeAnnotations(this.changeAnnotations),V=this.changeAnnotations.manage(D),S=ie.replace(H,k,V)),this.edits.push(S),
V!==void 0)return V},C.prototype.delete=function(H,k){var D,S;if(k===void 0?D=N.del(H):B.is(k)?(S=k,D=ie.del(H,k)):(this.assertChangeAnnotations(this.changeAnnotations),S=this.changeAnnotations.manage(k),D=ie.del(H,S)),this.edits.push(D),S!==void 0)return S},C.prototype.add=function(H){this.edits.push(H)},C.prototype.all=function(){return this.edits},C.prototype.clear=function(){this.edits.splice(0,this.edits.length)},C.prototype.assertChangeAnnotations=function(H){if(H===void 0)throw new Error(
"Text edit change is not configured to manage change annotations.")},C})(),W=(function(){function C(H){this._annotations=H===void 0?Object.create(null):H,this._counter=0,this._size=0}return C.prototype.all=function(){return this._annotations},Object.defineProperty(C.prototype,"size",{get:function(){return this._size},enumerable:!1,configurable:!0}),C.prototype.manage=function(H,k){var D;if(B.is(H)?D=H:(D=this.nextId(),k=H),this._annotations[D]!==void 0)throw new Error("Id ".concat(D," is already\
 in use."));if(k===void 0)throw new Error("No annotation provided for id ".concat(D));return this._annotations[D]=k,this._size++,D},C.prototype.nextId=function(){return this._counter++,this._counter.toString()},C})(),le=(function(){function C(H){var k=this;this._textEditChanges=Object.create(null),H!==void 0?(this._workspaceEdit=H,H.documentChanges?(this._changeAnnotations=new W(H.changeAnnotations),H.changeAnnotations=this._changeAnnotations.all(),H.documentChanges.forEach(function(D){if(L.is(D)){
var S=new U(D.edits,k._changeAnnotations);k._textEditChanges[D.textDocument.uri]=S}})):H.changes&&Object.keys(H.changes).forEach(function(D){var S=new U(H.changes[D]);k._textEditChanges[D]=S})):this._workspaceEdit={}}return Object.defineProperty(C.prototype,"edit",{get:function(){return this.initDocumentChanges(),this._changeAnnotations!==void 0&&(this._changeAnnotations.size===0?this._workspaceEdit.changeAnnotations=void 0:this._workspaceEdit.changeAnnotations=this._changeAnnotations.all()),this.
_workspaceEdit},enumerable:!1,configurable:!0}),C.prototype.getTextEditChange=function(H){if(M.is(H)){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var k={uri:H.uri,version:H.version},D=this._textEditChanges[k.uri];if(!D){var S=[],V={textDocument:k,edits:S};this._workspaceEdit.documentChanges.push(V),D=new U(S,this._changeAnnotations),this._textEditChanges[k.uri]=D}return D}else{if(this.initChanges(),
this._workspaceEdit.changes===void 0)throw new Error("Workspace edit is not configured for normal text edit changes.");var D=this._textEditChanges[H];if(!D){var S=[];this._workspaceEdit.changes[H]=S,D=new U(S),this._textEditChanges[H]=D}return D}},C.prototype.initDocumentChanges=function(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._changeAnnotations=new W,this._workspaceEdit.documentChanges=[],this._workspaceEdit.changeAnnotations=this._changeAnnotations.
all())},C.prototype.initChanges=function(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._workspaceEdit.changes=Object.create(null))},C.prototype.createFile=function(H,k,D){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var S;q.is(k)||B.is(k)?S=k:D=k;var V,A;if(S===void 0?V=E.create(H,D):(A=B.is(S)?S:this._changeAnnotations.manage(S),V=E.create(H,D,A)),
this._workspaceEdit.documentChanges.push(V),A!==void 0)return A},C.prototype.renameFile=function(H,k,D,S){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var V;q.is(D)||B.is(D)?V=D:S=D;var A,te;if(V===void 0?A=$.create(H,k,S):(te=B.is(V)?V:this._changeAnnotations.manage(V),A=$.create(H,k,S,te)),this._workspaceEdit.documentChanges.push(A),te!==void 0)return te},C.prototype.deleteFile=function(H,k,D){
if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var S;q.is(k)||B.is(k)?S=k:D=k;var V,A;if(S===void 0?V=z.create(H,D):(A=B.is(S)?S:this._changeAnnotations.manage(S),V=z.create(H,D,A)),this._workspaceEdit.documentChanges.push(V),A!==void 0)return A},C})();r.WorkspaceChange=le;var ne;(function(C){function H(D){return{uri:D}}C.create=H;function k(D){var S=D;return X.defined(S)&&X.string(S.uri)}C.is=k})(
ne||(r.TextDocumentIdentifier=ne={}));var P;(function(C){function H(D,S){return{uri:D,version:S}}C.create=H;function k(D){var S=D;return X.defined(S)&&X.string(S.uri)&&X.integer(S.version)}C.is=k})(P||(r.VersionedTextDocumentIdentifier=P={}));var M;(function(C){function H(D,S){return{uri:D,version:S}}C.create=H;function k(D){var S=D;return X.defined(S)&&X.string(S.uri)&&(S.version===null||X.integer(S.version))}C.is=k})(M||(r.OptionalVersionedTextDocumentIdentifier=M={}));var J;(function(C){function H(D,S,V,A){
return{uri:D,languageId:S,version:V,text:A}}C.create=H;function k(D){var S=D;return X.defined(S)&&X.string(S.uri)&&X.string(S.languageId)&&X.integer(S.version)&&X.string(S.text)}C.is=k})(J||(r.TextDocumentItem=J={}));var G;(function(C){C.PlainText="plaintext",C.Markdown="markdown";function H(k){var D=k;return D===C.PlainText||D===C.Markdown}C.is=H})(G||(r.MarkupKind=G={}));var _;(function(C){function H(k){var D=k;return X.objectLiteral(k)&&G.is(D.kind)&&X.string(D.value)}C.is=H})(_||(r.MarkupContent=
_={}));var I;(function(C){C.Text=1,C.Method=2,C.Function=3,C.Constructor=4,C.Field=5,C.Variable=6,C.Class=7,C.Interface=8,C.Module=9,C.Property=10,C.Unit=11,C.Value=12,C.Enum=13,C.Keyword=14,C.Snippet=15,C.Color=16,C.File=17,C.Reference=18,C.Folder=19,C.EnumMember=20,C.Constant=21,C.Struct=22,C.Event=23,C.Operator=24,C.TypeParameter=25})(I||(r.CompletionItemKind=I={}));var Y;(function(C){C.PlainText=1,C.Snippet=2})(Y||(r.InsertTextFormat=Y={}));var se;(function(C){C.Deprecated=1})(se||(r.CompletionItemTag=
se={}));var fe;(function(C){function H(D,S,V){return{newText:D,insert:S,replace:V}}C.create=H;function k(D){var S=D;return S&&X.string(S.newText)&&c.is(S.insert)&&c.is(S.replace)}C.is=k})(fe||(r.InsertReplaceEdit=fe={}));var _e;(function(C){C.asIs=1,C.adjustIndentation=2})(_e||(r.InsertTextMode=_e={}));var pe;(function(C){function H(k){var D=k;return D&&(X.string(D.detail)||D.detail===void 0)&&(X.string(D.description)||D.description===void 0)}C.is=H})(pe||(r.CompletionItemLabelDetails=pe={}));var x;
(function(C){function H(k){return{label:k}}C.create=H})(x||(r.CompletionItem=x={}));var O;(function(C){function H(k,D){return{items:k||[],isIncomplete:!!D}}C.create=H})(O||(r.CompletionList=O={}));var K;(function(C){function H(D){return D.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")}C.fromPlainText=H;function k(D){var S=D;return X.string(S)||X.objectLiteral(S)&&X.string(S.language)&&X.string(S.value)}C.is=k})(K||(r.MarkedString=K={}));var F;(function(C){function H(k){var D=k;return!!D&&X.objectLiteral(
D)&&(_.is(D.contents)||K.is(D.contents)||X.typedArray(D.contents,K.is))&&(k.range===void 0||c.is(k.range))}C.is=H})(F||(r.Hover=F={}));var ae;(function(C){function H(k,D){return D?{label:k,documentation:D}:{label:k}}C.create=H})(ae||(r.ParameterInformation=ae={}));var Re;(function(C){function H(k,D){for(var S=[],V=2;V<arguments.length;V++)S[V-2]=arguments[V];var A={label:k};return X.defined(D)&&(A.documentation=D),X.defined(S)?A.parameters=S:A.parameters=[],A}C.create=H})(Re||(r.SignatureInformation=
Re={}));var ze;(function(C){C.Text=1,C.Read=2,C.Write=3})(ze||(r.DocumentHighlightKind=ze={}));var ye;(function(C){function H(k,D){var S={range:k};return X.number(D)&&(S.kind=D),S}C.create=H})(ye||(r.DocumentHighlight=ye={}));var Me;(function(C){C.File=1,C.Module=2,C.Namespace=3,C.Package=4,C.Class=5,C.Method=6,C.Property=7,C.Field=8,C.Constructor=9,C.Enum=10,C.Interface=11,C.Function=12,C.Variable=13,C.Constant=14,C.String=15,C.Number=16,C.Boolean=17,C.Array=18,C.Object=19,C.Key=20,C.Null=21,C.
EnumMember=22,C.Struct=23,C.Event=24,C.Operator=25,C.TypeParameter=26})(Me||(r.SymbolKind=Me={}));var me;(function(C){C.Deprecated=1})(me||(r.SymbolTag=me={}));var $e;(function(C){function H(k,D,S,V,A){var te={name:k,kind:D,location:{uri:V,range:S}};return A&&(te.containerName=A),te}C.create=H})($e||(r.SymbolInformation=$e={}));var Ge;(function(C){function H(k,D,S,V){return V!==void 0?{name:k,kind:D,location:{uri:S,range:V}}:{name:k,kind:D,location:{uri:S}}}C.create=H})(Ge||(r.WorkspaceSymbol=Ge=
{}));var st;(function(C){function H(D,S,V,A,te,ge){var be={name:D,detail:S,kind:V,range:A,selectionRange:te};return ge!==void 0&&(be.children=ge),be}C.create=H;function k(D){var S=D;return S&&X.string(S.name)&&X.number(S.kind)&&c.is(S.range)&&c.is(S.selectionRange)&&(S.detail===void 0||X.string(S.detail))&&(S.deprecated===void 0||X.boolean(S.deprecated))&&(S.children===void 0||Array.isArray(S.children))&&(S.tags===void 0||Array.isArray(S.tags))}C.is=k})(st||(r.DocumentSymbol=st={}));var ut;(function(C){
C.Empty="",C.QuickFix="quickfix",C.Refactor="refactor",C.RefactorExtract="refactor.extract",C.RefactorInline="refactor.inline",C.RefactorRewrite="refactor.rewrite",C.Source="source",C.SourceOrganizeImports="source.organizeImports",C.SourceFixAll="source.fixAll"})(ut||(r.CodeActionKind=ut={}));var ln;(function(C){C.Invoked=1,C.Automatic=2})(ln||(r.CodeActionTriggerKind=ln={}));var Yt;(function(C){function H(D,S,V){var A={diagnostics:D};return S!=null&&(A.only=S),V!=null&&(A.triggerKind=V),A}C.create=
H;function k(D){var S=D;return X.defined(S)&&X.typedArray(S.diagnostics,R.is)&&(S.only===void 0||X.typedArray(S.only,X.string))&&(S.triggerKind===void 0||S.triggerKind===ln.Invoked||S.triggerKind===ln.Automatic)}C.is=k})(Yt||(r.CodeActionContext=Yt={}));var _n;(function(C){function H(D,S,V){var A={title:D},te=!0;return typeof S=="string"?(te=!1,A.kind=S):T.is(S)?A.command=S:A.edit=S,te&&V!==void 0&&(A.kind=V),A}C.create=H;function k(D){var S=D;return S&&X.string(S.title)&&(S.diagnostics===void 0||
X.typedArray(S.diagnostics,R.is))&&(S.kind===void 0||X.string(S.kind))&&(S.edit!==void 0||S.command!==void 0)&&(S.command===void 0||T.is(S.command))&&(S.isPreferred===void 0||X.boolean(S.isPreferred))&&(S.edit===void 0||j.is(S.edit))}C.is=k})(_n||(r.CodeAction=_n={}));var ce;(function(C){function H(D,S){var V={range:D};return X.defined(S)&&(V.data=S),V}C.create=H;function k(D){var S=D;return X.defined(S)&&c.is(S.range)&&(X.undefined(S.command)||T.is(S.command))}C.is=k})(ce||(r.CodeLens=ce={}));var ue;
(function(C){function H(D,S){return{tabSize:D,insertSpaces:S}}C.create=H;function k(D){var S=D;return X.defined(S)&&X.uinteger(S.tabSize)&&X.boolean(S.insertSpaces)}C.is=k})(ue||(r.FormattingOptions=ue={}));var Se;(function(C){function H(D,S,V){return{range:D,target:S,data:V}}C.create=H;function k(D){var S=D;return X.defined(S)&&c.is(S.range)&&(X.undefined(S.target)||X.string(S.target))}C.is=k})(Se||(r.DocumentLink=Se={}));var Ln;(function(C){function H(D,S){return{range:D,parent:S}}C.create=H;function k(D){
var S=D;return X.objectLiteral(S)&&c.is(S.range)&&(S.parent===void 0||C.is(S.parent))}C.is=k})(Ln||(r.SelectionRange=Ln={}));var Cn;(function(C){C.namespace="namespace",C.type="type",C.class="class",C.enum="enum",C.interface="interface",C.struct="struct",C.typeParameter="typeParameter",C.parameter="parameter",C.variable="variable",C.property="property",C.enumMember="enumMember",C.event="event",C.function="function",C.method="method",C.macro="macro",C.keyword="keyword",C.modifier="modifier",C.comment=
"comment",C.string="string",C.number="number",C.regexp="regexp",C.operator="operator",C.decorator="decorator"})(Cn||(r.SemanticTokenTypes=Cn={}));var Oi;(function(C){C.declaration="declaration",C.definition="definition",C.readonly="readonly",C.static="static",C.deprecated="deprecated",C.abstract="abstract",C.async="async",C.modification="modification",C.documentation="documentation",C.defaultLibrary="defaultLibrary"})(Oi||(r.SemanticTokenModifiers=Oi={}));var Ys;(function(C){function H(k){var D=k;
return X.objectLiteral(D)&&(D.resultId===void 0||typeof D.resultId=="string")&&Array.isArray(D.data)&&(D.data.length===0||typeof D.data[0]=="number")}C.is=H})(Ys||(r.SemanticTokens=Ys={}));var ja;(function(C){function H(D,S){return{range:D,text:S}}C.create=H;function k(D){var S=D;return S!=null&&c.is(S.range)&&X.string(S.text)}C.is=k})(ja||(r.InlineValueText=ja={}));var qa;(function(C){function H(D,S,V){return{range:D,variableName:S,caseSensitiveLookup:V}}C.create=H;function k(D){var S=D;return S!=
null&&c.is(S.range)&&X.boolean(S.caseSensitiveLookup)&&(X.string(S.variableName)||S.variableName===void 0)}C.is=k})(qa||(r.InlineValueVariableLookup=qa={}));var Fa;(function(C){function H(D,S){return{range:D,expression:S}}C.create=H;function k(D){var S=D;return S!=null&&c.is(S.range)&&(X.string(S.expression)||S.expression===void 0)}C.is=k})(Fa||(r.InlineValueEvaluatableExpression=Fa={}));var za;(function(C){function H(D,S){return{frameId:D,stoppedLocation:S}}C.create=H;function k(D){var S=D;return X.
defined(S)&&c.is(D.stoppedLocation)}C.is=k})(za||(r.InlineValueContext=za={}));var Xs;(function(C){C.Type=1,C.Parameter=2;function H(k){return k===1||k===2}C.is=H})(Xs||(r.InlayHintKind=Xs={}));var Qs;(function(C){function H(D){return{value:D}}C.create=H;function k(D){var S=D;return X.objectLiteral(S)&&(S.tooltip===void 0||X.string(S.tooltip)||_.is(S.tooltip))&&(S.location===void 0||u.is(S.location))&&(S.command===void 0||T.is(S.command))}C.is=k})(Qs||(r.InlayHintLabelPart=Qs={}));var hr;(function(C){
function H(D,S,V){var A={position:D,label:S};return V!==void 0&&(A.kind=V),A}C.create=H;function k(D){var S=D;return X.objectLiteral(S)&&l.is(S.position)&&(X.string(S.label)||X.typedArray(S.label,Qs.is))&&(S.kind===void 0||Xs.is(S.kind))&&S.textEdits===void 0||X.typedArray(S.textEdits,N.is)&&(S.tooltip===void 0||X.string(S.tooltip)||_.is(S.tooltip))&&(S.paddingLeft===void 0||X.boolean(S.paddingLeft))&&(S.paddingRight===void 0||X.boolean(S.paddingRight))}C.is=k})(hr||(r.InlayHint=hr={}));var Ua;(function(C){
function H(k){return{kind:"snippet",value:k}}C.createSnippet=H})(Ua||(r.StringValue=Ua={}));var Ha;(function(C){function H(k,D,S,V){return{insertText:k,filterText:D,range:S,command:V}}C.create=H})(Ha||(r.InlineCompletionItem=Ha={}));var Li;(function(C){function H(k){return{items:k}}C.create=H})(Li||(r.InlineCompletionList=Li={}));var Va;(function(C){C.Invoked=0,C.Automatic=1})(Va||(r.InlineCompletionTriggerKind=Va={}));var us;(function(C){function H(k,D){return{range:k,text:D}}C.create=H})(us||(r.
SelectedCompletionInfo=us={}));var Ba;(function(C){function H(k,D){return{triggerKind:k,selectedCompletionInfo:D}}C.create=H})(Ba||(r.InlineCompletionContext=Ba={}));var Jr;(function(C){function H(k){var D=k;return X.objectLiteral(D)&&s.is(D.uri)&&X.string(D.name)}C.is=H})(Jr||(r.WorkspaceFolder=Jr={})),r.EOL=[`
`,`\r
`,"\r"];var ui;(function(C){function H(V,A,te,ge){return new fl(V,A,te,ge)}C.create=H;function k(V){var A=V;return!!(X.defined(A)&&X.string(A.uri)&&(X.undefined(A.languageId)||X.string(A.languageId))&&X.uinteger(A.lineCount)&&X.func(A.getText)&&X.func(A.positionAt)&&X.func(A.offsetAt))}C.is=k;function D(V,A){for(var te=V.getText(),ge=S(A,function(Xe,At){var _t=Xe.range.start.line-At.range.start.line;return _t===0?Xe.range.start.character-At.range.start.character:_t}),be=te.length,lt=ge.length-1;lt>=
0;lt--){var Ye=ge[lt],kt=V.offsetAt(Ye.range.start),Ne=V.offsetAt(Ye.range.end);if(Ne<=be)te=te.substring(0,kt)+Ye.newText+te.substring(Ne,te.length);else throw new Error("Overlapping edit");be=kt}return te}C.applyEdits=D;function S(V,A){if(V.length<=1)return V;var te=V.length/2|0,ge=V.slice(0,te),be=V.slice(te);S(ge,A),S(be,A);for(var lt=0,Ye=0,kt=0;lt<ge.length&&Ye<be.length;){var Ne=A(ge[lt],be[Ye]);Ne<=0?V[kt++]=ge[lt++]:V[kt++]=be[Ye++]}for(;lt<ge.length;)V[kt++]=ge[lt++];for(;Ye<be.length;)
V[kt++]=be[Ye++];return V}})(ui||(r.TextDocument=ui={}));var fl=(function(){function C(H,k,D,S){this._uri=H,this._languageId=k,this._version=D,this._content=S,this._lineOffsets=void 0}return Object.defineProperty(C.prototype,"uri",{get:function(){return this._uri},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"languageId",{get:function(){return this._languageId},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"version",{get:function(){return this._version},enumerable:!1,
configurable:!0}),C.prototype.getText=function(H){if(H){var k=this.offsetAt(H.start),D=this.offsetAt(H.end);return this._content.substring(k,D)}return this._content},C.prototype.update=function(H,k){this._content=H.text,this._version=k,this._lineOffsets=void 0},C.prototype.getLineOffsets=function(){if(this._lineOffsets===void 0){for(var H=[],k=this._content,D=!0,S=0;S<k.length;S++){D&&(H.push(S),D=!1);var V=k.charAt(S);D=V==="\r"||V===`
`,V==="\r"&&S+1<k.length&&k.charAt(S+1)===`
`&&S++}D&&k.length>0&&H.push(k.length),this._lineOffsets=H}return this._lineOffsets},C.prototype.positionAt=function(H){H=Math.max(Math.min(H,this._content.length),0);var k=this.getLineOffsets(),D=0,S=k.length;if(S===0)return l.create(0,H);for(;D<S;){var V=Math.floor((D+S)/2);k[V]>H?S=V:D=V+1}var A=D-1;return l.create(A,H-k[A])},C.prototype.offsetAt=function(H){var k=this.getLineOffsets();if(H.line>=k.length)return this._content.length;if(H.line<0)return 0;var D=k[H.line],S=H.line+1<k.length?k[H.
line+1]:this._content.length;return Math.max(Math.min(D+H.character,S),D)},Object.defineProperty(C.prototype,"lineCount",{get:function(){return this.getLineOffsets().length},enumerable:!1,configurable:!0}),C})(),X;(function(C){var H=Object.prototype.toString;function k(Ne){return typeof Ne<"u"}C.defined=k;function D(Ne){return typeof Ne>"u"}C.undefined=D;function S(Ne){return Ne===!0||Ne===!1}C.boolean=S;function V(Ne){return H.call(Ne)==="[object String]"}C.string=V;function A(Ne){return H.call(
Ne)==="[object Number]"}C.number=A;function te(Ne,Xe,At){return H.call(Ne)==="[object Number]"&&Xe<=Ne&&Ne<=At}C.numberRange=te;function ge(Ne){return H.call(Ne)==="[object Number]"&&-2147483648<=Ne&&Ne<=2147483647}C.integer=ge;function be(Ne){return H.call(Ne)==="[object Number]"&&0<=Ne&&Ne<=2147483647}C.uinteger=be;function lt(Ne){return H.call(Ne)==="[object Function]"}C.func=lt;function Ye(Ne){return Ne!==null&&typeof Ne=="object"}C.objectLiteral=Ye;function kt(Ne,Xe){return Array.isArray(Ne)&&
Ne.every(Xe)}C.typedArray=kt})(X||(X={}))})})(tg,tg.exports)),tg.exports}var or={},xA;function en(){if(xA)return or;xA=1,Object.defineProperty(or,"__esModule",{value:!0}),or.ProtocolNotificationType=or.ProtocolNotificationType0=or.ProtocolRequestType=or.ProtocolRequestType0=or.RegistrationType=or.MessageDirection=void 0;const t=wo();var e;(function(o){o.clientToServer="clientToServer",o.serverToClient="serverToClient",o.both="both"})(e||(or.MessageDirection=e={}));class n{constructor(l){this.method=
l}}or.RegistrationType=n;class r extends t.RequestType0{constructor(l){super(l)}}or.ProtocolRequestType0=r;class i extends t.RequestType{constructor(l){super(l,t.ParameterStructures.byName)}}or.ProtocolRequestType=i;class s extends t.NotificationType0{constructor(l){super(l)}}or.ProtocolNotificationType0=s;class a extends t.NotificationType{constructor(l){super(l,t.ParameterStructures.byName)}}return or.ProtocolNotificationType=a,or}var i_={},yn={},AA;function s_(){if(AA)return yn;AA=1,Object.defineProperty(
yn,"__esModule",{value:!0}),yn.objectLiteral=yn.typedArray=yn.stringArray=yn.array=yn.func=yn.error=yn.number=yn.string=yn.boolean=void 0;function t(c){return c===!0||c===!1}yn.boolean=t;function e(c){return typeof c=="string"||c instanceof String}yn.string=e;function n(c){return typeof c=="number"||c instanceof Number}yn.number=n;function r(c){return c instanceof Error}yn.error=r;function i(c){return typeof c=="function"}yn.func=i;function s(c){return Array.isArray(c)}yn.array=s;function a(c){return s(
c)&&c.every(u=>e(u))}yn.stringArray=a;function o(c,u){return Array.isArray(c)&&c.every(u)}yn.typedArray=o;function l(c){return c!==null&&typeof c=="object"}return yn.objectLiteral=l,yn}var ad={},IA;function M5(){if(IA)return ad;IA=1,Object.defineProperty(ad,"__esModule",{value:!0}),ad.ImplementationRequest=void 0;const t=en();var e;return(function(n){n.method="textDocument/implementation",n.messageDirection=t.MessageDirection.clientToServer,n.type=new t.ProtocolRequestType(n.method)})(e||(ad.ImplementationRequest=
e={})),ad}var od={},NA;function j5(){if(NA)return od;NA=1,Object.defineProperty(od,"__esModule",{value:!0}),od.TypeDefinitionRequest=void 0;const t=en();var e;return(function(n){n.method="textDocument/typeDefinition",n.messageDirection=t.MessageDirection.clientToServer,n.type=new t.ProtocolRequestType(n.method)})(e||(od.TypeDefinitionRequest=e={})),od}var ko={},DA;function q5(){if(DA)return ko;DA=1,Object.defineProperty(ko,"__esModule",{value:!0}),ko.DidChangeWorkspaceFoldersNotification=ko.WorkspaceFoldersRequest=
void 0;const t=en();var e;(function(r){r.method="workspace/workspaceFolders",r.messageDirection=t.MessageDirection.serverToClient,r.type=new t.ProtocolRequestType0(r.method)})(e||(ko.WorkspaceFoldersRequest=e={}));var n;return(function(r){r.method="workspace/didChangeWorkspaceFolders",r.messageDirection=t.MessageDirection.clientToServer,r.type=new t.ProtocolNotificationType(r.method)})(n||(ko.DidChangeWorkspaceFoldersNotification=n={})),ko}var ld={},OA;function F5(){if(OA)return ld;OA=1,Object.defineProperty(
ld,"__esModule",{value:!0}),ld.ConfigurationRequest=void 0;const t=en();var e;return(function(n){n.method="workspace/configuration",n.messageDirection=t.MessageDirection.serverToClient,n.type=new t.ProtocolRequestType(n.method)})(e||(ld.ConfigurationRequest=e={})),ld}var _o={},LA;function z5(){if(LA)return _o;LA=1,Object.defineProperty(_o,"__esModule",{value:!0}),_o.ColorPresentationRequest=_o.DocumentColorRequest=void 0;const t=en();var e;(function(r){r.method="textDocument/documentColor",r.messageDirection=
t.MessageDirection.clientToServer,r.type=new t.ProtocolRequestType(r.method)})(e||(_o.DocumentColorRequest=e={}));var n;return(function(r){r.method="textDocument/colorPresentation",r.messageDirection=t.MessageDirection.clientToServer,r.type=new t.ProtocolRequestType(r.method)})(n||(_o.ColorPresentationRequest=n={})),_o}var Ro={},MA;function U5(){if(MA)return Ro;MA=1,Object.defineProperty(Ro,"__esModule",{value:!0}),Ro.FoldingRangeRefreshRequest=Ro.FoldingRangeRequest=void 0;const t=en();var e;(function(r){
r.method="textDocument/foldingRange",r.messageDirection=t.MessageDirection.clientToServer,r.type=new t.ProtocolRequestType(r.method)})(e||(Ro.FoldingRangeRequest=e={}));var n;return(function(r){r.method="workspace/foldingRange/refresh",r.messageDirection=t.MessageDirection.serverToClient,r.type=new t.ProtocolRequestType0(r.method)})(n||(Ro.FoldingRangeRefreshRequest=n={})),Ro}var cd={},jA;function H5(){if(jA)return cd;jA=1,Object.defineProperty(cd,"__esModule",{value:!0}),cd.DeclarationRequest=void 0;
const t=en();var e;return(function(n){n.method="textDocument/declaration",n.messageDirection=t.MessageDirection.clientToServer,n.type=new t.ProtocolRequestType(n.method)})(e||(cd.DeclarationRequest=e={})),cd}var ud={},qA;function V5(){if(qA)return ud;qA=1,Object.defineProperty(ud,"__esModule",{value:!0}),ud.SelectionRangeRequest=void 0;const t=en();var e;return(function(n){n.method="textDocument/selectionRange",n.messageDirection=t.MessageDirection.clientToServer,n.type=new t.ProtocolRequestType(
n.method)})(e||(ud.SelectionRangeRequest=e={})),ud}var Cs={},FA;function B5(){if(FA)return Cs;FA=1,Object.defineProperty(Cs,"__esModule",{value:!0}),Cs.WorkDoneProgressCancelNotification=Cs.WorkDoneProgressCreateRequest=Cs.WorkDoneProgress=void 0;const t=wo(),e=en();var n;(function(s){s.type=new t.ProgressType;function a(o){return o===s.type}s.is=a})(n||(Cs.WorkDoneProgress=n={}));var r;(function(s){s.method="window/workDoneProgress/create",s.messageDirection=e.MessageDirection.serverToClient,s.
type=new e.ProtocolRequestType(s.method)})(r||(Cs.WorkDoneProgressCreateRequest=r={}));var i;return(function(s){s.method="window/workDoneProgress/cancel",s.messageDirection=e.MessageDirection.clientToServer,s.type=new e.ProtocolNotificationType(s.method)})(i||(Cs.WorkDoneProgressCancelNotification=i={})),Cs}var xs={},zA;function W5(){if(zA)return xs;zA=1,Object.defineProperty(xs,"__esModule",{value:!0}),xs.CallHierarchyOutgoingCallsRequest=xs.CallHierarchyIncomingCallsRequest=xs.CallHierarchyPrepareRequest=
void 0;const t=en();var e;(function(i){i.method="textDocument/prepareCallHierarchy",i.messageDirection=t.MessageDirection.clientToServer,i.type=new t.ProtocolRequestType(i.method)})(e||(xs.CallHierarchyPrepareRequest=e={}));var n;(function(i){i.method="callHierarchy/incomingCalls",i.messageDirection=t.MessageDirection.clientToServer,i.type=new t.ProtocolRequestType(i.method)})(n||(xs.CallHierarchyIncomingCallsRequest=n={}));var r;return(function(i){i.method="callHierarchy/outgoingCalls",i.messageDirection=
t.MessageDirection.clientToServer,i.type=new t.ProtocolRequestType(i.method)})(r||(xs.CallHierarchyOutgoingCallsRequest=r={})),xs}var lr={},UA;function G5(){if(UA)return lr;UA=1,Object.defineProperty(lr,"__esModule",{value:!0}),lr.SemanticTokensRefreshRequest=lr.SemanticTokensRangeRequest=lr.SemanticTokensDeltaRequest=lr.SemanticTokensRequest=lr.SemanticTokensRegistrationType=lr.TokenFormat=void 0;const t=en();var e;(function(o){o.Relative="relative"})(e||(lr.TokenFormat=e={}));var n;(function(o){
o.method="textDocument/semanticTokens",o.type=new t.RegistrationType(o.method)})(n||(lr.SemanticTokensRegistrationType=n={}));var r;(function(o){o.method="textDocument/semanticTokens/full",o.messageDirection=t.MessageDirection.clientToServer,o.type=new t.ProtocolRequestType(o.method),o.registrationMethod=n.method})(r||(lr.SemanticTokensRequest=r={}));var i;(function(o){o.method="textDocument/semanticTokens/full/delta",o.messageDirection=t.MessageDirection.clientToServer,o.type=new t.ProtocolRequestType(
o.method),o.registrationMethod=n.method})(i||(lr.SemanticTokensDeltaRequest=i={}));var s;(function(o){o.method="textDocument/semanticTokens/range",o.messageDirection=t.MessageDirection.clientToServer,o.type=new t.ProtocolRequestType(o.method),o.registrationMethod=n.method})(s||(lr.SemanticTokensRangeRequest=s={}));var a;return(function(o){o.method="workspace/semanticTokens/refresh",o.messageDirection=t.MessageDirection.serverToClient,o.type=new t.ProtocolRequestType0(o.method)})(a||(lr.SemanticTokensRefreshRequest=
a={})),lr}var dd={},HA;function K5(){if(HA)return dd;HA=1,Object.defineProperty(dd,"__esModule",{value:!0}),dd.ShowDocumentRequest=void 0;const t=en();var e;return(function(n){n.method="window/showDocument",n.messageDirection=t.MessageDirection.serverToClient,n.type=new t.ProtocolRequestType(n.method)})(e||(dd.ShowDocumentRequest=e={})),dd}var fd={},VA;function Z5(){if(VA)return fd;VA=1,Object.defineProperty(fd,"__esModule",{value:!0}),fd.LinkedEditingRangeRequest=void 0;const t=en();var e;return(function(n){
n.method="textDocument/linkedEditingRange",n.messageDirection=t.MessageDirection.clientToServer,n.type=new t.ProtocolRequestType(n.method)})(e||(fd.LinkedEditingRangeRequest=e={})),fd}var Hn={},BA;function J5(){if(BA)return Hn;BA=1,Object.defineProperty(Hn,"__esModule",{value:!0}),Hn.WillDeleteFilesRequest=Hn.DidDeleteFilesNotification=Hn.DidRenameFilesNotification=Hn.WillRenameFilesRequest=Hn.DidCreateFilesNotification=Hn.WillCreateFilesRequest=Hn.FileOperationPatternKind=void 0;const t=en();var e;
(function(l){l.file="file",l.folder="folder"})(e||(Hn.FileOperationPatternKind=e={}));var n;(function(l){l.method="workspace/willCreateFiles",l.messageDirection=t.MessageDirection.clientToServer,l.type=new t.ProtocolRequestType(l.method)})(n||(Hn.WillCreateFilesRequest=n={}));var r;(function(l){l.method="workspace/didCreateFiles",l.messageDirection=t.MessageDirection.clientToServer,l.type=new t.ProtocolNotificationType(l.method)})(r||(Hn.DidCreateFilesNotification=r={}));var i;(function(l){l.method=
"workspace/willRenameFiles",l.messageDirection=t.MessageDirection.clientToServer,l.type=new t.ProtocolRequestType(l.method)})(i||(Hn.WillRenameFilesRequest=i={}));var s;(function(l){l.method="workspace/didRenameFiles",l.messageDirection=t.MessageDirection.clientToServer,l.type=new t.ProtocolNotificationType(l.method)})(s||(Hn.DidRenameFilesNotification=s={}));var a;(function(l){l.method="workspace/didDeleteFiles",l.messageDirection=t.MessageDirection.clientToServer,l.type=new t.ProtocolNotificationType(
l.method)})(a||(Hn.DidDeleteFilesNotification=a={}));var o;return(function(l){l.method="workspace/willDeleteFiles",l.messageDirection=t.MessageDirection.clientToServer,l.type=new t.ProtocolRequestType(l.method)})(o||(Hn.WillDeleteFilesRequest=o={})),Hn}var As={},WA;function Y5(){if(WA)return As;WA=1,Object.defineProperty(As,"__esModule",{value:!0}),As.MonikerRequest=As.MonikerKind=As.UniquenessLevel=void 0;const t=en();var e;(function(i){i.document="document",i.project="project",i.group="group",
i.scheme="scheme",i.global="global"})(e||(As.UniquenessLevel=e={}));var n;(function(i){i.$import="import",i.$export="export",i.local="local"})(n||(As.MonikerKind=n={}));var r;return(function(i){i.method="textDocument/moniker",i.messageDirection=t.MessageDirection.clientToServer,i.type=new t.ProtocolRequestType(i.method)})(r||(As.MonikerRequest=r={})),As}var Is={},GA;function X5(){if(GA)return Is;GA=1,Object.defineProperty(Is,"__esModule",{value:!0}),Is.TypeHierarchySubtypesRequest=Is.TypeHierarchySupertypesRequest=
Is.TypeHierarchyPrepareRequest=void 0;const t=en();var e;(function(i){i.method="textDocument/prepareTypeHierarchy",i.messageDirection=t.MessageDirection.clientToServer,i.type=new t.ProtocolRequestType(i.method)})(e||(Is.TypeHierarchyPrepareRequest=e={}));var n;(function(i){i.method="typeHierarchy/supertypes",i.messageDirection=t.MessageDirection.clientToServer,i.type=new t.ProtocolRequestType(i.method)})(n||(Is.TypeHierarchySupertypesRequest=n={}));var r;return(function(i){i.method="typeHierarch\
y/subtypes",i.messageDirection=t.MessageDirection.clientToServer,i.type=new t.ProtocolRequestType(i.method)})(r||(Is.TypeHierarchySubtypesRequest=r={})),Is}var So={},KA;function Q5(){if(KA)return So;KA=1,Object.defineProperty(So,"__esModule",{value:!0}),So.InlineValueRefreshRequest=So.InlineValueRequest=void 0;const t=en();var e;(function(r){r.method="textDocument/inlineValue",r.messageDirection=t.MessageDirection.clientToServer,r.type=new t.ProtocolRequestType(r.method)})(e||(So.InlineValueRequest=
e={}));var n;return(function(r){r.method="workspace/inlineValue/refresh",r.messageDirection=t.MessageDirection.serverToClient,r.type=new t.ProtocolRequestType0(r.method)})(n||(So.InlineValueRefreshRequest=n={})),So}var Ns={},ZA;function eZ(){if(ZA)return Ns;ZA=1,Object.defineProperty(Ns,"__esModule",{value:!0}),Ns.InlayHintRefreshRequest=Ns.InlayHintResolveRequest=Ns.InlayHintRequest=void 0;const t=en();var e;(function(i){i.method="textDocument/inlayHint",i.messageDirection=t.MessageDirection.clientToServer,
i.type=new t.ProtocolRequestType(i.method)})(e||(Ns.InlayHintRequest=e={}));var n;(function(i){i.method="inlayHint/resolve",i.messageDirection=t.MessageDirection.clientToServer,i.type=new t.ProtocolRequestType(i.method)})(n||(Ns.InlayHintResolveRequest=n={}));var r;return(function(i){i.method="workspace/inlayHint/refresh",i.messageDirection=t.MessageDirection.serverToClient,i.type=new t.ProtocolRequestType0(i.method)})(r||(Ns.InlayHintRefreshRequest=r={})),Ns}var jr={},JA;function tZ(){if(JA)return jr;
JA=1,Object.defineProperty(jr,"__esModule",{value:!0}),jr.DiagnosticRefreshRequest=jr.WorkspaceDiagnosticRequest=jr.DocumentDiagnosticRequest=jr.DocumentDiagnosticReportKind=jr.DiagnosticServerCancellationData=void 0;const t=wo(),e=s_(),n=en();var r;(function(l){function c(u){const d=u;return d&&e.boolean(d.retriggerRequest)}l.is=c})(r||(jr.DiagnosticServerCancellationData=r={}));var i;(function(l){l.Full="full",l.Unchanged="unchanged"})(i||(jr.DocumentDiagnosticReportKind=i={}));var s;(function(l){
l.method="textDocument/diagnostic",l.messageDirection=n.MessageDirection.clientToServer,l.type=new n.ProtocolRequestType(l.method),l.partialResult=new t.ProgressType})(s||(jr.DocumentDiagnosticRequest=s={}));var a;(function(l){l.method="workspace/diagnostic",l.messageDirection=n.MessageDirection.clientToServer,l.type=new n.ProtocolRequestType(l.method),l.partialResult=new t.ProgressType})(a||(jr.WorkspaceDiagnosticRequest=a={}));var o;return(function(l){l.method="workspace/diagnostic/refresh",l.
messageDirection=n.MessageDirection.serverToClient,l.type=new n.ProtocolRequestType0(l.method)})(o||(jr.DiagnosticRefreshRequest=o={})),jr}var tn={},YA;function nZ(){if(YA)return tn;YA=1,Object.defineProperty(tn,"__esModule",{value:!0}),tn.DidCloseNotebookDocumentNotification=tn.DidSaveNotebookDocumentNotification=tn.DidChangeNotebookDocumentNotification=tn.NotebookCellArrayChange=tn.DidOpenNotebookDocumentNotification=tn.NotebookDocumentSyncRegistrationType=tn.NotebookDocument=tn.NotebookCell=tn.
ExecutionSummary=tn.NotebookCellKind=void 0;const t=r_(),e=s_(),n=en();var r;(function(p){p.Markup=1,p.Code=2;function m(w){return w===1||w===2}p.is=m})(r||(tn.NotebookCellKind=r={}));var i;(function(p){function m(g,h){const y={executionOrder:g};return(h===!0||h===!1)&&(y.success=h),y}p.create=m;function w(g){const h=g;return e.objectLiteral(h)&&t.uinteger.is(h.executionOrder)&&(h.success===void 0||e.boolean(h.success))}p.is=w;function v(g,h){return g===h?!0:g==null||h===null||h===void 0?!1:g.executionOrder===
h.executionOrder&&g.success===h.success}p.equals=v})(i||(tn.ExecutionSummary=i={}));var s;(function(p){function m(h,y){return{kind:h,document:y}}p.create=m;function w(h){const y=h;return e.objectLiteral(y)&&r.is(y.kind)&&t.DocumentUri.is(y.document)&&(y.metadata===void 0||e.objectLiteral(y.metadata))}p.is=w;function v(h,y){const b=new Set;return h.document!==y.document&&b.add("document"),h.kind!==y.kind&&b.add("kind"),h.executionSummary!==y.executionSummary&&b.add("executionSummary"),(h.metadata!==
void 0||y.metadata!==void 0)&&!g(h.metadata,y.metadata)&&b.add("metadata"),(h.executionSummary!==void 0||y.executionSummary!==void 0)&&!i.equals(h.executionSummary,y.executionSummary)&&b.add("executionSummary"),b}p.diff=v;function g(h,y){if(h===y)return!0;if(h==null||y===null||y===void 0||typeof h!=typeof y||typeof h!="object")return!1;const b=Array.isArray(h),R=Array.isArray(y);if(b!==R)return!1;if(b&&R){if(h.length!==y.length)return!1;for(let T=0;T<h.length;T++)if(!g(h[T],y[T]))return!1}if(e.objectLiteral(
h)&&e.objectLiteral(y)){const T=Object.keys(h),N=Object.keys(y);if(T.length!==N.length||(T.sort(),N.sort(),!g(T,N)))return!1;for(let q=0;q<T.length;q++){const B=T[q];if(!g(h[B],y[B]))return!1}}return!0}})(s||(tn.NotebookCell=s={}));var a;(function(p){function m(v,g,h,y){return{uri:v,notebookType:g,version:h,cells:y}}p.create=m;function w(v){const g=v;return e.objectLiteral(g)&&e.string(g.uri)&&t.integer.is(g.version)&&e.typedArray(g.cells,s.is)}p.is=w})(a||(tn.NotebookDocument=a={}));var o;(function(p){
p.method="notebookDocument/sync",p.messageDirection=n.MessageDirection.clientToServer,p.type=new n.RegistrationType(p.method)})(o||(tn.NotebookDocumentSyncRegistrationType=o={}));var l;(function(p){p.method="notebookDocument/didOpen",p.messageDirection=n.MessageDirection.clientToServer,p.type=new n.ProtocolNotificationType(p.method),p.registrationMethod=o.method})(l||(tn.DidOpenNotebookDocumentNotification=l={}));var c;(function(p){function m(v){const g=v;return e.objectLiteral(g)&&t.uinteger.is(
g.start)&&t.uinteger.is(g.deleteCount)&&(g.cells===void 0||e.typedArray(g.cells,s.is))}p.is=m;function w(v,g,h){const y={start:v,deleteCount:g};return h!==void 0&&(y.cells=h),y}p.create=w})(c||(tn.NotebookCellArrayChange=c={}));var u;(function(p){p.method="notebookDocument/didChange",p.messageDirection=n.MessageDirection.clientToServer,p.type=new n.ProtocolNotificationType(p.method),p.registrationMethod=o.method})(u||(tn.DidChangeNotebookDocumentNotification=u={}));var d;(function(p){p.method="n\
otebookDocument/didSave",p.messageDirection=n.MessageDirection.clientToServer,p.type=new n.ProtocolNotificationType(p.method),p.registrationMethod=o.method})(d||(tn.DidSaveNotebookDocumentNotification=d={}));var f;return(function(p){p.method="notebookDocument/didClose",p.messageDirection=n.MessageDirection.clientToServer,p.type=new n.ProtocolNotificationType(p.method),p.registrationMethod=o.method})(f||(tn.DidCloseNotebookDocumentNotification=f={})),tn}var pd={},XA;function rZ(){if(XA)return pd;
XA=1,Object.defineProperty(pd,"__esModule",{value:!0}),pd.InlineCompletionRequest=void 0;const t=en();var e;return(function(n){n.method="textDocument/inlineCompletion",n.messageDirection=t.MessageDirection.clientToServer,n.type=new t.ProtocolRequestType(n.method)})(e||(pd.InlineCompletionRequest=e={})),pd}var QA;function iZ(){return QA||(QA=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.WorkspaceSymbolRequest=t.CodeActionResolveRequest=t.CodeActionRequest=t.DocumentSymbolRequest=
t.DocumentHighlightRequest=t.ReferencesRequest=t.DefinitionRequest=t.SignatureHelpRequest=t.SignatureHelpTriggerKind=t.HoverRequest=t.CompletionResolveRequest=t.CompletionRequest=t.CompletionTriggerKind=t.PublishDiagnosticsNotification=t.WatchKind=t.RelativePattern=t.FileChangeType=t.DidChangeWatchedFilesNotification=t.WillSaveTextDocumentWaitUntilRequest=t.WillSaveTextDocumentNotification=t.TextDocumentSaveReason=t.DidSaveTextDocumentNotification=t.DidCloseTextDocumentNotification=t.DidChangeTextDocumentNotification=
t.TextDocumentContentChangeEvent=t.DidOpenTextDocumentNotification=t.TextDocumentSyncKind=t.TelemetryEventNotification=t.LogMessageNotification=t.ShowMessageRequest=t.ShowMessageNotification=t.MessageType=t.DidChangeConfigurationNotification=t.ExitNotification=t.ShutdownRequest=t.InitializedNotification=t.InitializeErrorCodes=t.InitializeRequest=t.WorkDoneProgressOptions=t.TextDocumentRegistrationOptions=t.StaticRegistrationOptions=t.PositionEncodingKind=t.FailureHandlingKind=t.ResourceOperationKind=
t.UnregistrationRequest=t.RegistrationRequest=t.DocumentSelector=t.NotebookCellTextDocumentFilter=t.NotebookDocumentFilter=t.TextDocumentFilter=void 0,t.MonikerRequest=t.MonikerKind=t.UniquenessLevel=t.WillDeleteFilesRequest=t.DidDeleteFilesNotification=t.WillRenameFilesRequest=t.DidRenameFilesNotification=t.WillCreateFilesRequest=t.DidCreateFilesNotification=t.FileOperationPatternKind=t.LinkedEditingRangeRequest=t.ShowDocumentRequest=t.SemanticTokensRegistrationType=t.SemanticTokensRefreshRequest=
t.SemanticTokensRangeRequest=t.SemanticTokensDeltaRequest=t.SemanticTokensRequest=t.TokenFormat=t.CallHierarchyPrepareRequest=t.CallHierarchyOutgoingCallsRequest=t.CallHierarchyIncomingCallsRequest=t.WorkDoneProgressCancelNotification=t.WorkDoneProgressCreateRequest=t.WorkDoneProgress=t.SelectionRangeRequest=t.DeclarationRequest=t.FoldingRangeRefreshRequest=t.FoldingRangeRequest=t.ColorPresentationRequest=t.DocumentColorRequest=t.ConfigurationRequest=t.DidChangeWorkspaceFoldersNotification=t.WorkspaceFoldersRequest=
t.TypeDefinitionRequest=t.ImplementationRequest=t.ApplyWorkspaceEditRequest=t.ExecuteCommandRequest=t.PrepareRenameRequest=t.RenameRequest=t.PrepareSupportDefaultBehavior=t.DocumentOnTypeFormattingRequest=t.DocumentRangesFormattingRequest=t.DocumentRangeFormattingRequest=t.DocumentFormattingRequest=t.DocumentLinkResolveRequest=t.DocumentLinkRequest=t.CodeLensRefreshRequest=t.CodeLensResolveRequest=t.CodeLensRequest=t.WorkspaceSymbolResolveRequest=void 0,t.InlineCompletionRequest=t.DidCloseNotebookDocumentNotification=
t.DidSaveNotebookDocumentNotification=t.DidChangeNotebookDocumentNotification=t.NotebookCellArrayChange=t.DidOpenNotebookDocumentNotification=t.NotebookDocumentSyncRegistrationType=t.NotebookDocument=t.NotebookCell=t.ExecutionSummary=t.NotebookCellKind=t.DiagnosticRefreshRequest=t.WorkspaceDiagnosticRequest=t.DocumentDiagnosticRequest=t.DocumentDiagnosticReportKind=t.DiagnosticServerCancellationData=t.InlayHintRefreshRequest=t.InlayHintResolveRequest=t.InlayHintRequest=t.InlineValueRefreshRequest=
t.InlineValueRequest=t.TypeHierarchySupertypesRequest=t.TypeHierarchySubtypesRequest=t.TypeHierarchyPrepareRequest=void 0;const e=en(),n=r_(),r=s_(),i=M5();Object.defineProperty(t,"ImplementationRequest",{enumerable:!0,get:function(){return i.ImplementationRequest}});const s=j5();Object.defineProperty(t,"TypeDefinitionRequest",{enumerable:!0,get:function(){return s.TypeDefinitionRequest}});const a=q5();Object.defineProperty(t,"WorkspaceFoldersRequest",{enumerable:!0,get:function(){return a.WorkspaceFoldersRequest}}),
Object.defineProperty(t,"DidChangeWorkspaceFoldersNotification",{enumerable:!0,get:function(){return a.DidChangeWorkspaceFoldersNotification}});const o=F5();Object.defineProperty(t,"ConfigurationRequest",{enumerable:!0,get:function(){return o.ConfigurationRequest}});const l=z5();Object.defineProperty(t,"DocumentColorRequest",{enumerable:!0,get:function(){return l.DocumentColorRequest}}),Object.defineProperty(t,"ColorPresentationRequest",{enumerable:!0,get:function(){return l.ColorPresentationRequest}});
const c=U5();Object.defineProperty(t,"FoldingRangeRequest",{enumerable:!0,get:function(){return c.FoldingRangeRequest}}),Object.defineProperty(t,"FoldingRangeRefreshRequest",{enumerable:!0,get:function(){return c.FoldingRangeRefreshRequest}});const u=H5();Object.defineProperty(t,"DeclarationRequest",{enumerable:!0,get:function(){return u.DeclarationRequest}});const d=V5();Object.defineProperty(t,"SelectionRangeRequest",{enumerable:!0,get:function(){return d.SelectionRangeRequest}});const f=B5();
Object.defineProperty(t,"WorkDoneProgress",{enumerable:!0,get:function(){return f.WorkDoneProgress}}),Object.defineProperty(t,"WorkDoneProgressCreateRequest",{enumerable:!0,get:function(){return f.WorkDoneProgressCreateRequest}}),Object.defineProperty(t,"WorkDoneProgressCancelNotification",{enumerable:!0,get:function(){return f.WorkDoneProgressCancelNotification}});const p=W5();Object.defineProperty(t,"CallHierarchyIncomingCallsRequest",{enumerable:!0,get:function(){return p.CallHierarchyIncomingCallsRequest}}),
Object.defineProperty(t,"CallHierarchyOutgoingCallsRequest",{enumerable:!0,get:function(){return p.CallHierarchyOutgoingCallsRequest}}),Object.defineProperty(t,"CallHierarchyPrepareRequest",{enumerable:!0,get:function(){return p.CallHierarchyPrepareRequest}});const m=G5();Object.defineProperty(t,"TokenFormat",{enumerable:!0,get:function(){return m.TokenFormat}}),Object.defineProperty(t,"SemanticTokensRequest",{enumerable:!0,get:function(){return m.SemanticTokensRequest}}),Object.defineProperty(t,
"SemanticTokensDeltaRequest",{enumerable:!0,get:function(){return m.SemanticTokensDeltaRequest}}),Object.defineProperty(t,"SemanticTokensRangeRequest",{enumerable:!0,get:function(){return m.SemanticTokensRangeRequest}}),Object.defineProperty(t,"SemanticTokensRefreshRequest",{enumerable:!0,get:function(){return m.SemanticTokensRefreshRequest}}),Object.defineProperty(t,"SemanticTokensRegistrationType",{enumerable:!0,get:function(){return m.SemanticTokensRegistrationType}});const w=K5();Object.defineProperty(
t,"ShowDocumentRequest",{enumerable:!0,get:function(){return w.ShowDocumentRequest}});const v=Z5();Object.defineProperty(t,"LinkedEditingRangeRequest",{enumerable:!0,get:function(){return v.LinkedEditingRangeRequest}});const g=J5();Object.defineProperty(t,"FileOperationPatternKind",{enumerable:!0,get:function(){return g.FileOperationPatternKind}}),Object.defineProperty(t,"DidCreateFilesNotification",{enumerable:!0,get:function(){return g.DidCreateFilesNotification}}),Object.defineProperty(t,"Wil\
lCreateFilesRequest",{enumerable:!0,get:function(){return g.WillCreateFilesRequest}}),Object.defineProperty(t,"DidRenameFilesNotification",{enumerable:!0,get:function(){return g.DidRenameFilesNotification}}),Object.defineProperty(t,"WillRenameFilesRequest",{enumerable:!0,get:function(){return g.WillRenameFilesRequest}}),Object.defineProperty(t,"DidDeleteFilesNotification",{enumerable:!0,get:function(){return g.DidDeleteFilesNotification}}),Object.defineProperty(t,"WillDeleteFilesRequest",{enumerable:!0,
get:function(){return g.WillDeleteFilesRequest}});const h=Y5();Object.defineProperty(t,"UniquenessLevel",{enumerable:!0,get:function(){return h.UniquenessLevel}}),Object.defineProperty(t,"MonikerKind",{enumerable:!0,get:function(){return h.MonikerKind}}),Object.defineProperty(t,"MonikerRequest",{enumerable:!0,get:function(){return h.MonikerRequest}});const y=X5();Object.defineProperty(t,"TypeHierarchyPrepareRequest",{enumerable:!0,get:function(){return y.TypeHierarchyPrepareRequest}}),Object.defineProperty(
t,"TypeHierarchySubtypesRequest",{enumerable:!0,get:function(){return y.TypeHierarchySubtypesRequest}}),Object.defineProperty(t,"TypeHierarchySupertypesRequest",{enumerable:!0,get:function(){return y.TypeHierarchySupertypesRequest}});const b=Q5();Object.defineProperty(t,"InlineValueRequest",{enumerable:!0,get:function(){return b.InlineValueRequest}}),Object.defineProperty(t,"InlineValueRefreshRequest",{enumerable:!0,get:function(){return b.InlineValueRefreshRequest}});const R=eZ();Object.defineProperty(
t,"InlayHintRequest",{enumerable:!0,get:function(){return R.InlayHintRequest}}),Object.defineProperty(t,"InlayHintResolveRequest",{enumerable:!0,get:function(){return R.InlayHintResolveRequest}}),Object.defineProperty(t,"InlayHintRefreshRequest",{enumerable:!0,get:function(){return R.InlayHintRefreshRequest}});const T=tZ();Object.defineProperty(t,"DiagnosticServerCancellationData",{enumerable:!0,get:function(){return T.DiagnosticServerCancellationData}}),Object.defineProperty(t,"DocumentDiagnost\
icReportKind",{enumerable:!0,get:function(){return T.DocumentDiagnosticReportKind}}),Object.defineProperty(t,"DocumentDiagnosticRequest",{enumerable:!0,get:function(){return T.DocumentDiagnosticRequest}}),Object.defineProperty(t,"WorkspaceDiagnosticRequest",{enumerable:!0,get:function(){return T.WorkspaceDiagnosticRequest}}),Object.defineProperty(t,"DiagnosticRefreshRequest",{enumerable:!0,get:function(){return T.DiagnosticRefreshRequest}});const N=nZ();Object.defineProperty(t,"NotebookCellKind",
{enumerable:!0,get:function(){return N.NotebookCellKind}}),Object.defineProperty(t,"ExecutionSummary",{enumerable:!0,get:function(){return N.ExecutionSummary}}),Object.defineProperty(t,"NotebookCell",{enumerable:!0,get:function(){return N.NotebookCell}}),Object.defineProperty(t,"NotebookDocument",{enumerable:!0,get:function(){return N.NotebookDocument}}),Object.defineProperty(t,"NotebookDocumentSyncRegistrationType",{enumerable:!0,get:function(){return N.NotebookDocumentSyncRegistrationType}}),Object.
defineProperty(t,"DidOpenNotebookDocumentNotification",{enumerable:!0,get:function(){return N.DidOpenNotebookDocumentNotification}}),Object.defineProperty(t,"NotebookCellArrayChange",{enumerable:!0,get:function(){return N.NotebookCellArrayChange}}),Object.defineProperty(t,"DidChangeNotebookDocumentNotification",{enumerable:!0,get:function(){return N.DidChangeNotebookDocumentNotification}}),Object.defineProperty(t,"DidSaveNotebookDocumentNotification",{enumerable:!0,get:function(){return N.DidSaveNotebookDocumentNotification}}),
Object.defineProperty(t,"DidCloseNotebookDocumentNotification",{enumerable:!0,get:function(){return N.DidCloseNotebookDocumentNotification}});const q=rZ();Object.defineProperty(t,"InlineCompletionRequest",{enumerable:!0,get:function(){return q.InlineCompletionRequest}});var B;(function(k){function D(S){const V=S;return r.string(V)||r.string(V.language)||r.string(V.scheme)||r.string(V.pattern)}k.is=D})(B||(t.TextDocumentFilter=B={}));var ie;(function(k){function D(S){const V=S;return r.objectLiteral(
V)&&(r.string(V.notebookType)||r.string(V.scheme)||r.string(V.pattern))}k.is=D})(ie||(t.NotebookDocumentFilter=ie={}));var L;(function(k){function D(S){const V=S;return r.objectLiteral(V)&&(r.string(V.notebook)||ie.is(V.notebook))&&(V.language===void 0||r.string(V.language))}k.is=D})(L||(t.NotebookCellTextDocumentFilter=L={}));var E;(function(k){function D(S){if(!Array.isArray(S))return!1;for(let V of S)if(!r.string(V)&&!B.is(V)&&!L.is(V))return!1;return!0}k.is=D})(E||(t.DocumentSelector=E={}));
var $;(function(k){k.method="client/registerCapability",k.messageDirection=e.MessageDirection.serverToClient,k.type=new e.ProtocolRequestType(k.method)})($||(t.RegistrationRequest=$={}));var z;(function(k){k.method="client/unregisterCapability",k.messageDirection=e.MessageDirection.serverToClient,k.type=new e.ProtocolRequestType(k.method)})(z||(t.UnregistrationRequest=z={}));var j;(function(k){k.Create="create",k.Rename="rename",k.Delete="delete"})(j||(t.ResourceOperationKind=j={}));var U;(function(k){
k.Abort="abort",k.Transactional="transactional",k.TextOnlyTransactional="textOnlyTransactional",k.Undo="undo"})(U||(t.FailureHandlingKind=U={}));var W;(function(k){k.UTF8="utf-8",k.UTF16="utf-16",k.UTF32="utf-32"})(W||(t.PositionEncodingKind=W={}));var le;(function(k){function D(S){const V=S;return V&&r.string(V.id)&&V.id.length>0}k.hasId=D})(le||(t.StaticRegistrationOptions=le={}));var ne;(function(k){function D(S){const V=S;return V&&(V.documentSelector===null||E.is(V.documentSelector))}k.is=D})(
ne||(t.TextDocumentRegistrationOptions=ne={}));var P;(function(k){function D(V){const A=V;return r.objectLiteral(A)&&(A.workDoneProgress===void 0||r.boolean(A.workDoneProgress))}k.is=D;function S(V){const A=V;return A&&r.boolean(A.workDoneProgress)}k.hasWorkDoneProgress=S})(P||(t.WorkDoneProgressOptions=P={}));var M;(function(k){k.method="initialize",k.messageDirection=e.MessageDirection.clientToServer,k.type=new e.ProtocolRequestType(k.method)})(M||(t.InitializeRequest=M={}));var J;(function(k){
k.unknownProtocolVersion=1})(J||(t.InitializeErrorCodes=J={}));var G;(function(k){k.method="initialized",k.messageDirection=e.MessageDirection.clientToServer,k.type=new e.ProtocolNotificationType(k.method)})(G||(t.InitializedNotification=G={}));var _;(function(k){k.method="shutdown",k.messageDirection=e.MessageDirection.clientToServer,k.type=new e.ProtocolRequestType0(k.method)})(_||(t.ShutdownRequest=_={}));var I;(function(k){k.method="exit",k.messageDirection=e.MessageDirection.clientToServer,
k.type=new e.ProtocolNotificationType0(k.method)})(I||(t.ExitNotification=I={}));var Y;(function(k){k.method="workspace/didChangeConfiguration",k.messageDirection=e.MessageDirection.clientToServer,k.type=new e.ProtocolNotificationType(k.method)})(Y||(t.DidChangeConfigurationNotification=Y={}));var se;(function(k){k.Error=1,k.Warning=2,k.Info=3,k.Log=4,k.Debug=5})(se||(t.MessageType=se={}));var fe;(function(k){k.method="window/showMessage",k.messageDirection=e.MessageDirection.serverToClient,k.type=
new e.ProtocolNotificationType(k.method)})(fe||(t.ShowMessageNotification=fe={}));var _e;(function(k){k.method="window/showMessageRequest",k.messageDirection=e.MessageDirection.serverToClient,k.type=new e.ProtocolRequestType(k.method)})(_e||(t.ShowMessageRequest=_e={}));var pe;(function(k){k.method="window/logMessage",k.messageDirection=e.MessageDirection.serverToClient,k.type=new e.ProtocolNotificationType(k.method)})(pe||(t.LogMessageNotification=pe={}));var x;(function(k){k.method="telemetry/\
event",k.messageDirection=e.MessageDirection.serverToClient,k.type=new e.ProtocolNotificationType(k.method)})(x||(t.TelemetryEventNotification=x={}));var O;(function(k){k.None=0,k.Full=1,k.Incremental=2})(O||(t.TextDocumentSyncKind=O={}));var K;(function(k){k.method="textDocument/didOpen",k.messageDirection=e.MessageDirection.clientToServer,k.type=new e.ProtocolNotificationType(k.method)})(K||(t.DidOpenTextDocumentNotification=K={}));var F;(function(k){function D(V){let A=V;return A!=null&&typeof A.
text=="string"&&A.range!==void 0&&(A.rangeLength===void 0||typeof A.rangeLength=="number")}k.isIncremental=D;function S(V){let A=V;return A!=null&&typeof A.text=="string"&&A.range===void 0&&A.rangeLength===void 0}k.isFull=S})(F||(t.TextDocumentContentChangeEvent=F={}));var ae;(function(k){k.method="textDocument/didChange",k.messageDirection=e.MessageDirection.clientToServer,k.type=new e.ProtocolNotificationType(k.method)})(ae||(t.DidChangeTextDocumentNotification=ae={}));var Re;(function(k){k.method=
"textDocument/didClose",k.messageDirection=e.MessageDirection.clientToServer,k.type=new e.ProtocolNotificationType(k.method)})(Re||(t.DidCloseTextDocumentNotification=Re={}));var ze;(function(k){k.method="textDocument/didSave",k.messageDirection=e.MessageDirection.clientToServer,k.type=new e.ProtocolNotificationType(k.method)})(ze||(t.DidSaveTextDocumentNotification=ze={}));var ye;(function(k){k.Manual=1,k.AfterDelay=2,k.FocusOut=3})(ye||(t.TextDocumentSaveReason=ye={}));var Me;(function(k){k.method=
"textDocument/willSave",k.messageDirection=e.MessageDirection.clientToServer,k.type=new e.ProtocolNotificationType(k.method)})(Me||(t.WillSaveTextDocumentNotification=Me={}));var me;(function(k){k.method="textDocument/willSaveWaitUntil",k.messageDirection=e.MessageDirection.clientToServer,k.type=new e.ProtocolRequestType(k.method)})(me||(t.WillSaveTextDocumentWaitUntilRequest=me={}));var $e;(function(k){k.method="workspace/didChangeWatchedFiles",k.messageDirection=e.MessageDirection.clientToServer,
k.type=new e.ProtocolNotificationType(k.method)})($e||(t.DidChangeWatchedFilesNotification=$e={}));var Ge;(function(k){k.Created=1,k.Changed=2,k.Deleted=3})(Ge||(t.FileChangeType=Ge={}));var st;(function(k){function D(S){const V=S;return r.objectLiteral(V)&&(n.URI.is(V.baseUri)||n.WorkspaceFolder.is(V.baseUri))&&r.string(V.pattern)}k.is=D})(st||(t.RelativePattern=st={}));var ut;(function(k){k.Create=1,k.Change=2,k.Delete=4})(ut||(t.WatchKind=ut={}));var ln;(function(k){k.method="textDocument/pub\
lishDiagnostics",k.messageDirection=e.MessageDirection.serverToClient,k.type=new e.ProtocolNotificationType(k.method)})(ln||(t.PublishDiagnosticsNotification=ln={}));var Yt;(function(k){k.Invoked=1,k.TriggerCharacter=2,k.TriggerForIncompleteCompletions=3})(Yt||(t.CompletionTriggerKind=Yt={}));var _n;(function(k){k.method="textDocument/completion",k.messageDirection=e.MessageDirection.clientToServer,k.type=new e.ProtocolRequestType(k.method)})(_n||(t.CompletionRequest=_n={}));var ce;(function(k){
k.method="completionItem/resolve",k.messageDirection=e.MessageDirection.clientToServer,k.type=new e.ProtocolRequestType(k.method)})(ce||(t.CompletionResolveRequest=ce={}));var ue;(function(k){k.method="textDocument/hover",k.messageDirection=e.MessageDirection.clientToServer,k.type=new e.ProtocolRequestType(k.method)})(ue||(t.HoverRequest=ue={}));var Se;(function(k){k.Invoked=1,k.TriggerCharacter=2,k.ContentChange=3})(Se||(t.SignatureHelpTriggerKind=Se={}));var Ln;(function(k){k.method="textDocum\
ent/signatureHelp",k.messageDirection=e.MessageDirection.clientToServer,k.type=new e.ProtocolRequestType(k.method)})(Ln||(t.SignatureHelpRequest=Ln={}));var Cn;(function(k){k.method="textDocument/definition",k.messageDirection=e.MessageDirection.clientToServer,k.type=new e.ProtocolRequestType(k.method)})(Cn||(t.DefinitionRequest=Cn={}));var Oi;(function(k){k.method="textDocument/references",k.messageDirection=e.MessageDirection.clientToServer,k.type=new e.ProtocolRequestType(k.method)})(Oi||(t.ReferencesRequest=
Oi={}));var Ys;(function(k){k.method="textDocument/documentHighlight",k.messageDirection=e.MessageDirection.clientToServer,k.type=new e.ProtocolRequestType(k.method)})(Ys||(t.DocumentHighlightRequest=Ys={}));var ja;(function(k){k.method="textDocument/documentSymbol",k.messageDirection=e.MessageDirection.clientToServer,k.type=new e.ProtocolRequestType(k.method)})(ja||(t.DocumentSymbolRequest=ja={}));var qa;(function(k){k.method="textDocument/codeAction",k.messageDirection=e.MessageDirection.clientToServer,
k.type=new e.ProtocolRequestType(k.method)})(qa||(t.CodeActionRequest=qa={}));var Fa;(function(k){k.method="codeAction/resolve",k.messageDirection=e.MessageDirection.clientToServer,k.type=new e.ProtocolRequestType(k.method)})(Fa||(t.CodeActionResolveRequest=Fa={}));var za;(function(k){k.method="workspace/symbol",k.messageDirection=e.MessageDirection.clientToServer,k.type=new e.ProtocolRequestType(k.method)})(za||(t.WorkspaceSymbolRequest=za={}));var Xs;(function(k){k.method="workspaceSymbol/reso\
lve",k.messageDirection=e.MessageDirection.clientToServer,k.type=new e.ProtocolRequestType(k.method)})(Xs||(t.WorkspaceSymbolResolveRequest=Xs={}));var Qs;(function(k){k.method="textDocument/codeLens",k.messageDirection=e.MessageDirection.clientToServer,k.type=new e.ProtocolRequestType(k.method)})(Qs||(t.CodeLensRequest=Qs={}));var hr;(function(k){k.method="codeLens/resolve",k.messageDirection=e.MessageDirection.clientToServer,k.type=new e.ProtocolRequestType(k.method)})(hr||(t.CodeLensResolveRequest=
hr={}));var Ua;(function(k){k.method="workspace/codeLens/refresh",k.messageDirection=e.MessageDirection.serverToClient,k.type=new e.ProtocolRequestType0(k.method)})(Ua||(t.CodeLensRefreshRequest=Ua={}));var Ha;(function(k){k.method="textDocument/documentLink",k.messageDirection=e.MessageDirection.clientToServer,k.type=new e.ProtocolRequestType(k.method)})(Ha||(t.DocumentLinkRequest=Ha={}));var Li;(function(k){k.method="documentLink/resolve",k.messageDirection=e.MessageDirection.clientToServer,k.
type=new e.ProtocolRequestType(k.method)})(Li||(t.DocumentLinkResolveRequest=Li={}));var Va;(function(k){k.method="textDocument/formatting",k.messageDirection=e.MessageDirection.clientToServer,k.type=new e.ProtocolRequestType(k.method)})(Va||(t.DocumentFormattingRequest=Va={}));var us;(function(k){k.method="textDocument/rangeFormatting",k.messageDirection=e.MessageDirection.clientToServer,k.type=new e.ProtocolRequestType(k.method)})(us||(t.DocumentRangeFormattingRequest=us={}));var Ba;(function(k){
k.method="textDocument/rangesFormatting",k.messageDirection=e.MessageDirection.clientToServer,k.type=new e.ProtocolRequestType(k.method)})(Ba||(t.DocumentRangesFormattingRequest=Ba={}));var Jr;(function(k){k.method="textDocument/onTypeFormatting",k.messageDirection=e.MessageDirection.clientToServer,k.type=new e.ProtocolRequestType(k.method)})(Jr||(t.DocumentOnTypeFormattingRequest=Jr={}));var ui;(function(k){k.Identifier=1})(ui||(t.PrepareSupportDefaultBehavior=ui={}));var fl;(function(k){k.method=
"textDocument/rename",k.messageDirection=e.MessageDirection.clientToServer,k.type=new e.ProtocolRequestType(k.method)})(fl||(t.RenameRequest=fl={}));var X;(function(k){k.method="textDocument/prepareRename",k.messageDirection=e.MessageDirection.clientToServer,k.type=new e.ProtocolRequestType(k.method)})(X||(t.PrepareRenameRequest=X={}));var C;(function(k){k.method="workspace/executeCommand",k.messageDirection=e.MessageDirection.clientToServer,k.type=new e.ProtocolRequestType(k.method)})(C||(t.ExecuteCommandRequest=
C={}));var H;(function(k){k.method="workspace/applyEdit",k.messageDirection=e.MessageDirection.serverToClient,k.type=new e.ProtocolRequestType("workspace/applyEdit")})(H||(t.ApplyWorkspaceEditRequest=H={}))})(i_)),i_}var hd={},eI;function sZ(){if(eI)return hd;eI=1,Object.defineProperty(hd,"__esModule",{value:!0}),hd.createProtocolConnection=void 0;const t=wo();function e(n,r,i,s){return t.ConnectionStrategy.is(s)&&(s={connectionStrategy:s}),(0,t.createMessageConnection)(n,r,i,s)}return hd.createProtocolConnection=
e,hd}var tI;function aZ(){return tI||(tI=1,(function(t){var e=bo&&bo.__createBinding||(Object.create?(function(s,a,o,l){l===void 0&&(l=o);var c=Object.getOwnPropertyDescriptor(a,o);(!c||("get"in c?!a.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return a[o]}}),Object.defineProperty(s,l,c)}):(function(s,a,o,l){l===void 0&&(l=o),s[l]=a[o]})),n=bo&&bo.__exportStar||function(s,a){for(var o in s)o!=="default"&&!Object.prototype.hasOwnProperty.call(a,o)&&e(a,s,o)};Object.defineProperty(
t,"__esModule",{value:!0}),t.LSPErrorCodes=t.createProtocolConnection=void 0,n(wo(),t),n(r_(),t),n(en(),t),n(iZ(),t);var r=sZ();Object.defineProperty(t,"createProtocolConnection",{enumerable:!0,get:function(){return r.createProtocolConnection}});var i;(function(s){s.lspReservedErrorRangeStart=-32899,s.RequestFailed=-32803,s.ServerCancelled=-32802,s.ContentModified=-32801,s.RequestCancelled=-32800,s.lspReservedErrorRangeEnd=-32800})(i||(t.LSPErrorCodes=i={}))})(bo)),bo}var nI;function vn(){return nI||
(nI=1,(function(t){var e=go&&go.__createBinding||(Object.create?(function(s,a,o,l){l===void 0&&(l=o);var c=Object.getOwnPropertyDescriptor(a,o);(!c||("get"in c?!a.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return a[o]}}),Object.defineProperty(s,l,c)}):(function(s,a,o,l){l===void 0&&(l=o),s[l]=a[o]})),n=go&&go.__exportStar||function(s,a){for(var o in s)o!=="default"&&!Object.prototype.hasOwnProperty.call(a,o)&&e(a,s,o)};Object.defineProperty(t,"__esModule",{value:!0}),
t.createProtocolConnection=void 0;const r=PA();n(PA(),t),n(aZ(),t);function i(s,a,o,l){return(0,r.createMessageConnection)(s,a,o,l)}t.createProtocolConnection=i})(go)),go}var qr={},rI;function iI(){if(rI)return qr;rI=1,Object.defineProperty(qr,"__esModule",{value:!0}),qr.generateUuid=qr.parse=qr.isUUID=qr.v4=qr.empty=void 0;class t{constructor(l){this._value=l}asHex(){return this._value}equals(l){return this.asHex()===l.asHex()}}class e extends t{static _oneOf(l){return l[Math.floor(l.length*Math.
random())]}static _randomHex(){return e._oneOf(e._chars)}constructor(){super([e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),"-",e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),"-","4",e._randomHex(),e._randomHex(),e._randomHex(),"-",e._oneOf(e._timeHighBits),e._randomHex(),e._randomHex(),e._randomHex(),"-",e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e.
_randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex()].join(""))}}e._chars=["0","1","2","3","4","5","6","6","7","8","9","a","b","c","d","e","f"],e._timeHighBits=["8","9","a","b"],qr.empty=new t("00000000-0000-0000-0000-000000000000");function n(){return new e}qr.v4=n;const r=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function i(o){return r.test(o)}qr.isUUID=i;function s(o){if(!i(o))throw new Error("invalid uuid");return new t(o)}qr.parse=s;function a(){return n().
asHex()}return qr.generateUuid=a,qr}var Ds={},sI;function oZ(){if(sI)return Ds;sI=1,Object.defineProperty(Ds,"__esModule",{value:!0}),Ds.attachPartialResult=Ds.ProgressFeature=Ds.attachWorkDone=void 0;const t=vn(),e=iI();class n{constructor(f,p){this._connection=f,this._token=p,n.Instances.set(this._token,this)}begin(f,p,m,w){let v={kind:"begin",title:f,percentage:p,message:m,cancellable:w};this._connection.sendProgress(t.WorkDoneProgress.type,this._token,v)}report(f,p){let m={kind:"report"};typeof f==
"number"?(m.percentage=f,p!==void 0&&(m.message=p)):m.message=f,this._connection.sendProgress(t.WorkDoneProgress.type,this._token,m)}done(){n.Instances.delete(this._token),this._connection.sendProgress(t.WorkDoneProgress.type,this._token,{kind:"end"})}}n.Instances=new Map;class r extends n{constructor(f,p){super(f,p),this._source=new t.CancellationTokenSource}get token(){return this._source.token}done(){this._source.dispose(),super.done()}cancel(){this._source.cancel()}}class i{constructor(){}begin(){}report(){}done(){}}
class s extends i{constructor(){super(),this._source=new t.CancellationTokenSource}get token(){return this._source.token}done(){this._source.dispose()}cancel(){this._source.cancel()}}function a(d,f){if(f===void 0||f.workDoneToken===void 0)return new i;const p=f.workDoneToken;return delete f.workDoneToken,new n(d,p)}Ds.attachWorkDone=a;const o=d=>class extends d{constructor(){super(),this._progressSupported=!1}initialize(f){super.initialize(f),f?.window?.workDoneProgress===!0&&(this._progressSupported=
!0,this.connection.onNotification(t.WorkDoneProgressCancelNotification.type,p=>{let m=n.Instances.get(p.token);(m instanceof r||m instanceof s)&&m.cancel()}))}attachWorkDoneProgress(f){return f===void 0?new i:new n(this.connection,f)}createWorkDoneProgress(){if(this._progressSupported){const f=(0,e.generateUuid)();return this.connection.sendRequest(t.WorkDoneProgressCreateRequest.type,{token:f}).then(()=>new r(this.connection,f))}else return Promise.resolve(new s)}};Ds.ProgressFeature=o;var l;(function(d){
d.type=new t.ProgressType})(l||(l={}));class c{constructor(f,p){this._connection=f,this._token=p}report(f){this._connection.sendProgress(l.type,this._token,f)}}function u(d,f){if(f===void 0||f.partialResultToken===void 0)return;const p=f.partialResultToken;return delete f.partialResultToken,new c(d,p)}return Ds.attachPartialResult=u,Ds}var md={},aI;function lZ(){if(aI)return md;aI=1,Object.defineProperty(md,"__esModule",{value:!0}),md.ConfigurationFeature=void 0;const t=vn(),e=Xk(),n=r=>class extends r{getConfiguration(i){
return i?e.string(i)?this._getConfiguration({section:i}):this._getConfiguration(i):this._getConfiguration({})}_getConfiguration(i){let s={items:Array.isArray(i)?i:[i]};return this.connection.sendRequest(t.ConfigurationRequest.type,s).then(a=>Array.isArray(a)?Array.isArray(i)?a:a[0]:Array.isArray(i)?[]:null)}};return md.ConfigurationFeature=n,md}var gd={},oI;function cZ(){if(oI)return gd;oI=1,Object.defineProperty(gd,"__esModule",{value:!0}),gd.WorkspaceFoldersFeature=void 0;const t=vn(),e=n=>class extends n{constructor(){
super(),this._notificationIsAutoRegistered=!1}initialize(r){super.initialize(r);let i=r.workspace;i&&i.workspaceFolders&&(this._onDidChangeWorkspaceFolders=new t.Emitter,this.connection.onNotification(t.DidChangeWorkspaceFoldersNotification.type,s=>{this._onDidChangeWorkspaceFolders.fire(s.event)}))}fillServerCapabilities(r){super.fillServerCapabilities(r);const i=r.workspace?.workspaceFolders?.changeNotifications;this._notificationIsAutoRegistered=i===!0||typeof i=="string"}getWorkspaceFolders(){
return this.connection.sendRequest(t.WorkspaceFoldersRequest.type)}get onDidChangeWorkspaceFolders(){if(!this._onDidChangeWorkspaceFolders)throw new Error("Client doesn't support sending workspace folder change events.");return!this._notificationIsAutoRegistered&&!this._unregistration&&(this._unregistration=this.connection.client.register(t.DidChangeWorkspaceFoldersNotification.type)),this._onDidChangeWorkspaceFolders.event}};return gd.WorkspaceFoldersFeature=e,gd}var yd={},lI;function uZ(){if(lI)
return yd;lI=1,Object.defineProperty(yd,"__esModule",{value:!0}),yd.CallHierarchyFeature=void 0;const t=vn(),e=n=>class extends n{get callHierarchy(){return{onPrepare:r=>this.connection.onRequest(t.CallHierarchyPrepareRequest.type,(i,s)=>r(i,s,this.attachWorkDoneProgress(i),void 0)),onIncomingCalls:r=>{const i=t.CallHierarchyIncomingCallsRequest.type;return this.connection.onRequest(i,(s,a)=>r(s,a,this.attachWorkDoneProgress(s),this.attachPartialResultProgress(i,s)))},onOutgoingCalls:r=>{const i=t.
CallHierarchyOutgoingCallsRequest.type;return this.connection.onRequest(i,(s,a)=>r(s,a,this.attachWorkDoneProgress(s),this.attachPartialResultProgress(i,s)))}}}};return yd.CallHierarchyFeature=e,yd}var Os={},cI;function uI(){if(cI)return Os;cI=1,Object.defineProperty(Os,"__esModule",{value:!0}),Os.SemanticTokensBuilder=Os.SemanticTokensDiff=Os.SemanticTokensFeature=void 0;const t=vn(),e=i=>class extends i{get semanticTokens(){return{refresh:()=>this.connection.sendRequest(t.SemanticTokensRefreshRequest.
type),on:s=>{const a=t.SemanticTokensRequest.type;return this.connection.onRequest(a,(o,l)=>s(o,l,this.attachWorkDoneProgress(o),this.attachPartialResultProgress(a,o)))},onDelta:s=>{const a=t.SemanticTokensDeltaRequest.type;return this.connection.onRequest(a,(o,l)=>s(o,l,this.attachWorkDoneProgress(o),this.attachPartialResultProgress(a,o)))},onRange:s=>{const a=t.SemanticTokensRangeRequest.type;return this.connection.onRequest(a,(o,l)=>s(o,l,this.attachWorkDoneProgress(o),this.attachPartialResultProgress(
a,o)))}}}};Os.SemanticTokensFeature=e;class n{constructor(s,a){this.originalSequence=s,this.modifiedSequence=a}computeDiff(){const s=this.originalSequence.length,a=this.modifiedSequence.length;let o=0;for(;o<a&&o<s&&this.originalSequence[o]===this.modifiedSequence[o];)o++;if(o<a&&o<s){let l=s-1,c=a-1;for(;l>=o&&c>=o&&this.originalSequence[l]===this.modifiedSequence[c];)l--,c--;(l<o||c<o)&&(l++,c++);const u=l-o+1,d=this.modifiedSequence.slice(o,c+1);return d.length===1&&d[0]===this.originalSequence[l]?
[{start:o,deleteCount:u-1}]:[{start:o,deleteCount:u,data:d}]}else return o<a?[{start:o,deleteCount:0,data:this.modifiedSequence.slice(o)}]:o<s?[{start:o,deleteCount:s-o}]:[]}}Os.SemanticTokensDiff=n;class r{constructor(){this._prevData=void 0,this.initialize()}initialize(){this._id=Date.now(),this._prevLine=0,this._prevChar=0,this._data=[],this._dataLen=0}push(s,a,o,l,c){let u=s,d=a;this._dataLen>0&&(u-=this._prevLine,u===0&&(d-=this._prevChar)),this._data[this._dataLen++]=u,this._data[this._dataLen++]=
d,this._data[this._dataLen++]=o,this._data[this._dataLen++]=l,this._data[this._dataLen++]=c,this._prevLine=s,this._prevChar=a}get id(){return this._id.toString()}previousResult(s){this.id===s&&(this._prevData=this._data),this.initialize()}build(){return this._prevData=void 0,{resultId:this.id,data:this._data}}canBuildEdits(){return this._prevData!==void 0}buildEdits(){return this._prevData!==void 0?{resultId:this.id,edits:new n(this._prevData,this._data).computeDiff()}:this.build()}}return Os.SemanticTokensBuilder=
r,Os}var vd={},dI;function dZ(){if(dI)return vd;dI=1,Object.defineProperty(vd,"__esModule",{value:!0}),vd.ShowDocumentFeature=void 0;const t=vn(),e=n=>class extends n{showDocument(r){return this.connection.sendRequest(t.ShowDocumentRequest.type,r)}};return vd.ShowDocumentFeature=e,vd}var wd={},fI;function fZ(){if(fI)return wd;fI=1,Object.defineProperty(wd,"__esModule",{value:!0}),wd.FileOperationsFeature=void 0;const t=vn(),e=n=>class extends n{onDidCreateFiles(r){return this.connection.onNotification(
t.DidCreateFilesNotification.type,i=>{r(i)})}onDidRenameFiles(r){return this.connection.onNotification(t.DidRenameFilesNotification.type,i=>{r(i)})}onDidDeleteFiles(r){return this.connection.onNotification(t.DidDeleteFilesNotification.type,i=>{r(i)})}onWillCreateFiles(r){return this.connection.onRequest(t.WillCreateFilesRequest.type,(i,s)=>r(i,s))}onWillRenameFiles(r){return this.connection.onRequest(t.WillRenameFilesRequest.type,(i,s)=>r(i,s))}onWillDeleteFiles(r){return this.connection.onRequest(
t.WillDeleteFilesRequest.type,(i,s)=>r(i,s))}};return wd.FileOperationsFeature=e,wd}var bd={},pI;function pZ(){if(pI)return bd;pI=1,Object.defineProperty(bd,"__esModule",{value:!0}),bd.LinkedEditingRangeFeature=void 0;const t=vn(),e=n=>class extends n{onLinkedEditingRange(r){return this.connection.onRequest(t.LinkedEditingRangeRequest.type,(i,s)=>r(i,s,this.attachWorkDoneProgress(i),void 0))}};return bd.LinkedEditingRangeFeature=e,bd}var kd={},hI;function hZ(){if(hI)return kd;hI=1,Object.defineProperty(
kd,"__esModule",{value:!0}),kd.TypeHierarchyFeature=void 0;const t=vn(),e=n=>class extends n{get typeHierarchy(){return{onPrepare:r=>this.connection.onRequest(t.TypeHierarchyPrepareRequest.type,(i,s)=>r(i,s,this.attachWorkDoneProgress(i),void 0)),onSupertypes:r=>{const i=t.TypeHierarchySupertypesRequest.type;return this.connection.onRequest(i,(s,a)=>r(s,a,this.attachWorkDoneProgress(s),this.attachPartialResultProgress(i,s)))},onSubtypes:r=>{const i=t.TypeHierarchySubtypesRequest.type;return this.
connection.onRequest(i,(s,a)=>r(s,a,this.attachWorkDoneProgress(s),this.attachPartialResultProgress(i,s)))}}}};return kd.TypeHierarchyFeature=e,kd}var _d={},mI;function mZ(){if(mI)return _d;mI=1,Object.defineProperty(_d,"__esModule",{value:!0}),_d.InlineValueFeature=void 0;const t=vn(),e=n=>class extends n{get inlineValue(){return{refresh:()=>this.connection.sendRequest(t.InlineValueRefreshRequest.type),on:r=>this.connection.onRequest(t.InlineValueRequest.type,(i,s)=>r(i,s,this.attachWorkDoneProgress(
i)))}}};return _d.InlineValueFeature=e,_d}var Rd={},gI;function gZ(){if(gI)return Rd;gI=1,Object.defineProperty(Rd,"__esModule",{value:!0}),Rd.FoldingRangeFeature=void 0;const t=vn(),e=n=>class extends n{get foldingRange(){return{refresh:()=>this.connection.sendRequest(t.FoldingRangeRefreshRequest.type),on:r=>{const i=t.FoldingRangeRequest.type;return this.connection.onRequest(i,(s,a)=>r(s,a,this.attachWorkDoneProgress(s),this.attachPartialResultProgress(i,s)))}}}};return Rd.FoldingRangeFeature=
e,Rd}var Sd={},yI;function yZ(){if(yI)return Sd;yI=1,Object.defineProperty(Sd,"__esModule",{value:!0}),Sd.InlayHintFeature=void 0;const t=vn(),e=n=>class extends n{get inlayHint(){return{refresh:()=>this.connection.sendRequest(t.InlayHintRefreshRequest.type),on:r=>this.connection.onRequest(t.InlayHintRequest.type,(i,s)=>r(i,s,this.attachWorkDoneProgress(i))),resolve:r=>this.connection.onRequest(t.InlayHintResolveRequest.type,(i,s)=>r(i,s))}}};return Sd.InlayHintFeature=e,Sd}var $d={},vI;function vZ(){
if(vI)return $d;vI=1,Object.defineProperty($d,"__esModule",{value:!0}),$d.DiagnosticFeature=void 0;const t=vn(),e=n=>class extends n{get diagnostics(){return{refresh:()=>this.connection.sendRequest(t.DiagnosticRefreshRequest.type),on:r=>this.connection.onRequest(t.DocumentDiagnosticRequest.type,(i,s)=>r(i,s,this.attachWorkDoneProgress(i),this.attachPartialResultProgress(t.DocumentDiagnosticRequest.partialResult,i))),onWorkspace:r=>this.connection.onRequest(t.WorkspaceDiagnosticRequest.type,(i,s)=>r(
i,s,this.attachWorkDoneProgress(i),this.attachPartialResultProgress(t.WorkspaceDiagnosticRequest.partialResult,i)))}}};return $d.DiagnosticFeature=e,$d}var $o={},Td={},wI;function bI(){if(wI)return Td;wI=1,Object.defineProperty(Td,"__esModule",{value:!0}),Td.TextDocuments=void 0;const t=vn();class e{constructor(r){this._configuration=r,this._syncedDocuments=new Map,this._onDidChangeContent=new t.Emitter,this._onDidOpen=new t.Emitter,this._onDidClose=new t.Emitter,this._onDidSave=new t.Emitter,this.
_onWillSave=new t.Emitter}get onDidOpen(){return this._onDidOpen.event}get onDidChangeContent(){return this._onDidChangeContent.event}get onWillSave(){return this._onWillSave.event}onWillSaveWaitUntil(r){this._willSaveWaitUntil=r}get onDidSave(){return this._onDidSave.event}get onDidClose(){return this._onDidClose.event}get(r){return this._syncedDocuments.get(r)}all(){return Array.from(this._syncedDocuments.values())}keys(){return Array.from(this._syncedDocuments.keys())}listen(r){r.__textDocumentSync=
t.TextDocumentSyncKind.Incremental;const i=[];return i.push(r.onDidOpenTextDocument(s=>{const a=s.textDocument,o=this._configuration.create(a.uri,a.languageId,a.version,a.text);this._syncedDocuments.set(a.uri,o);const l=Object.freeze({document:o});this._onDidOpen.fire(l),this._onDidChangeContent.fire(l)})),i.push(r.onDidChangeTextDocument(s=>{const a=s.textDocument,o=s.contentChanges;if(o.length===0)return;const{version:l}=a;if(l==null)throw new Error(`Received document change event for ${a.uri}\
 without valid version identifier`);let c=this._syncedDocuments.get(a.uri);c!==void 0&&(c=this._configuration.update(c,o,l),this._syncedDocuments.set(a.uri,c),this._onDidChangeContent.fire(Object.freeze({document:c})))})),i.push(r.onDidCloseTextDocument(s=>{let a=this._syncedDocuments.get(s.textDocument.uri);a!==void 0&&(this._syncedDocuments.delete(s.textDocument.uri),this._onDidClose.fire(Object.freeze({document:a})))})),i.push(r.onWillSaveTextDocument(s=>{let a=this._syncedDocuments.get(s.textDocument.
uri);a!==void 0&&this._onWillSave.fire(Object.freeze({document:a,reason:s.reason}))})),i.push(r.onWillSaveTextDocumentWaitUntil((s,a)=>{let o=this._syncedDocuments.get(s.textDocument.uri);return o!==void 0&&this._willSaveWaitUntil?this._willSaveWaitUntil(Object.freeze({document:o,reason:s.reason}),a):[]})),i.push(r.onDidSaveTextDocument(s=>{let a=this._syncedDocuments.get(s.textDocument.uri);a!==void 0&&this._onDidSave.fire(Object.freeze({document:a}))})),t.Disposable.create(()=>{i.forEach(s=>s.
dispose())})}}return Td.TextDocuments=e,Td}var kI;function _I(){if(kI)return $o;kI=1,Object.defineProperty($o,"__esModule",{value:!0}),$o.NotebookDocuments=$o.NotebookSyncFeature=void 0;const t=vn(),e=bI(),n=s=>class extends s{get synchronization(){return{onDidOpenNotebookDocument:a=>this.connection.onNotification(t.DidOpenNotebookDocumentNotification.type,o=>{a(o)}),onDidChangeNotebookDocument:a=>this.connection.onNotification(t.DidChangeNotebookDocumentNotification.type,o=>{a(o)}),onDidSaveNotebookDocument:a=>this.
connection.onNotification(t.DidSaveNotebookDocumentNotification.type,o=>{a(o)}),onDidCloseNotebookDocument:a=>this.connection.onNotification(t.DidCloseNotebookDocumentNotification.type,o=>{a(o)})}}};$o.NotebookSyncFeature=n;class r{onDidOpenTextDocument(a){return this.openHandler=a,t.Disposable.create(()=>{this.openHandler=void 0})}openTextDocument(a){this.openHandler&&this.openHandler(a)}onDidChangeTextDocument(a){return this.changeHandler=a,t.Disposable.create(()=>{this.changeHandler=a})}changeTextDocument(a){
this.changeHandler&&this.changeHandler(a)}onDidCloseTextDocument(a){return this.closeHandler=a,t.Disposable.create(()=>{this.closeHandler=void 0})}closeTextDocument(a){this.closeHandler&&this.closeHandler(a)}onWillSaveTextDocument(){return r.NULL_DISPOSE}onWillSaveTextDocumentWaitUntil(){return r.NULL_DISPOSE}onDidSaveTextDocument(){return r.NULL_DISPOSE}}r.NULL_DISPOSE=Object.freeze({dispose:()=>{}});class i{constructor(a){a instanceof e.TextDocuments?this._cellTextDocuments=a:this._cellTextDocuments=
new e.TextDocuments(a),this.notebookDocuments=new Map,this.notebookCellMap=new Map,this._onDidOpen=new t.Emitter,this._onDidChange=new t.Emitter,this._onDidSave=new t.Emitter,this._onDidClose=new t.Emitter}get cellTextDocuments(){return this._cellTextDocuments}getCellTextDocument(a){return this._cellTextDocuments.get(a.document)}getNotebookDocument(a){return this.notebookDocuments.get(a)}getNotebookCell(a){const o=this.notebookCellMap.get(a);return o&&o[0]}findNotebookDocumentForCell(a){const o=typeof a==
"string"?a:a.document,l=this.notebookCellMap.get(o);return l&&l[1]}get onDidOpen(){return this._onDidOpen.event}get onDidSave(){return this._onDidSave.event}get onDidChange(){return this._onDidChange.event}get onDidClose(){return this._onDidClose.event}listen(a){const o=new r,l=[];return l.push(this.cellTextDocuments.listen(o)),l.push(a.notebooks.synchronization.onDidOpenNotebookDocument(c=>{this.notebookDocuments.set(c.notebookDocument.uri,c.notebookDocument);for(const u of c.cellTextDocuments)
o.openTextDocument({textDocument:u});this.updateCellMap(c.notebookDocument),this._onDidOpen.fire(c.notebookDocument)})),l.push(a.notebooks.synchronization.onDidChangeNotebookDocument(c=>{const u=this.notebookDocuments.get(c.notebookDocument.uri);if(u===void 0)return;u.version=c.notebookDocument.version;const d=u.metadata;let f=!1;const p=c.change;p.metadata!==void 0&&(f=!0,u.metadata=p.metadata);const m=[],w=[],v=[],g=[];if(p.cells!==void 0){const T=p.cells;if(T.structure!==void 0){const N=T.structure.
array;if(u.cells.splice(N.start,N.deleteCount,...N.cells!==void 0?N.cells:[]),T.structure.didOpen!==void 0)for(const q of T.structure.didOpen)o.openTextDocument({textDocument:q}),m.push(q.uri);if(T.structure.didClose)for(const q of T.structure.didClose)o.closeTextDocument({textDocument:q}),w.push(q.uri)}if(T.data!==void 0){const N=new Map(T.data.map(q=>[q.document,q]));for(let q=0;q<=u.cells.length;q++){const B=N.get(u.cells[q].document);if(B!==void 0){const ie=u.cells.splice(q,1,B);if(v.push({old:ie[0],
new:B}),N.delete(B.document),N.size===0)break}}}if(T.textContent!==void 0)for(const N of T.textContent)o.changeTextDocument({textDocument:N.document,contentChanges:N.changes}),g.push(N.document.uri)}this.updateCellMap(u);const h={notebookDocument:u};f&&(h.metadata={old:d,new:u.metadata});const y=[];for(const T of m)y.push(this.getNotebookCell(T));const b=[];for(const T of w)b.push(this.getNotebookCell(T));const R=[];for(const T of g)R.push(this.getNotebookCell(T));(y.length>0||b.length>0||v.length>
0||R.length>0)&&(h.cells={added:y,removed:b,changed:{data:v,textContent:R}}),(h.metadata!==void 0||h.cells!==void 0)&&this._onDidChange.fire(h)})),l.push(a.notebooks.synchronization.onDidSaveNotebookDocument(c=>{const u=this.notebookDocuments.get(c.notebookDocument.uri);u!==void 0&&this._onDidSave.fire(u)})),l.push(a.notebooks.synchronization.onDidCloseNotebookDocument(c=>{const u=this.notebookDocuments.get(c.notebookDocument.uri);if(u!==void 0){this._onDidClose.fire(u);for(const d of c.cellTextDocuments)
o.closeTextDocument({textDocument:d});this.notebookDocuments.delete(c.notebookDocument.uri);for(const d of u.cells)this.notebookCellMap.delete(d.document)}})),t.Disposable.create(()=>{l.forEach(c=>c.dispose())})}updateCellMap(a){for(const o of a.cells)this.notebookCellMap.set(o.document,[o,a])}}return $o.NotebookDocuments=i,$o}var Ed={},RI;function wZ(){if(RI)return Ed;RI=1,Object.defineProperty(Ed,"__esModule",{value:!0}),Ed.MonikerFeature=void 0;const t=vn(),e=n=>class extends n{get moniker(){
return{on:r=>{const i=t.MonikerRequest.type;return this.connection.onRequest(i,(s,a)=>r(s,a,this.attachWorkDoneProgress(s),this.attachPartialResultProgress(i,s)))}}}};return Ed.MonikerFeature=e,Ed}var SI;function $I(){if(SI)return vt;SI=1,Object.defineProperty(vt,"__esModule",{value:!0}),vt.createConnection=vt.combineFeatures=vt.combineNotebooksFeatures=vt.combineLanguagesFeatures=vt.combineWorkspaceFeatures=vt.combineWindowFeatures=vt.combineClientFeatures=vt.combineTracerFeatures=vt.combineTelemetryFeatures=
vt.combineConsoleFeatures=vt._NotebooksImpl=vt._LanguagesImpl=vt.BulkUnregistration=vt.BulkRegistration=vt.ErrorMessageTracker=void 0;const t=vn(),e=Xk(),n=iI(),r=oZ(),i=lZ(),s=cZ(),a=uZ(),o=uI(),l=dZ(),c=fZ(),u=pZ(),d=hZ(),f=mZ(),p=gZ(),m=yZ(),w=vZ(),v=_I(),g=wZ();function h(pe){if(pe!==null)return pe}class y{constructor(){this._messages=Object.create(null)}add(x){let O=this._messages[x];O||(O=0),O++,this._messages[x]=O}sendErrors(x){Object.keys(this._messages).forEach(O=>{x.window.showErrorMessage(
O)})}}vt.ErrorMessageTracker=y;class b{constructor(){}rawAttach(x){this._rawConnection=x}attach(x){this._connection=x}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}fillServerCapabilities(x){}initialize(x){}error(x){this.send(t.MessageType.Error,x)}warn(x){this.send(t.MessageType.Warning,x)}info(x){this.send(t.MessageType.Info,x)}log(x){this.send(t.MessageType.Log,x)}debug(x){this.send(t.MessageType.Debug,x)}send(x,O){
this._rawConnection&&this._rawConnection.sendNotification(t.LogMessageNotification.type,{type:x,message:O}).catch(()=>{(0,t.RAL)().console.error("Sending log message failed")})}}class R{constructor(){}attach(x){this._connection=x}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(x){}fillServerCapabilities(x){}showErrorMessage(x,...O){let K={type:t.MessageType.Error,message:x,actions:O};return this.connection.sendRequest(
t.ShowMessageRequest.type,K).then(h)}showWarningMessage(x,...O){let K={type:t.MessageType.Warning,message:x,actions:O};return this.connection.sendRequest(t.ShowMessageRequest.type,K).then(h)}showInformationMessage(x,...O){let K={type:t.MessageType.Info,message:x,actions:O};return this.connection.sendRequest(t.ShowMessageRequest.type,K).then(h)}}const T=(0,l.ShowDocumentFeature)((0,r.ProgressFeature)(R));var N;(function(pe){function x(){return new q}pe.create=x})(N||(vt.BulkRegistration=N={}));class q{constructor(){
this._registrations=[],this._registered=new Set}add(x,O){const K=e.string(x)?x:x.method;if(this._registered.has(K))throw new Error(`${K} is already added to this registration`);const F=n.generateUuid();this._registrations.push({id:F,method:K,registerOptions:O||{}}),this._registered.add(K)}asRegistrationParams(){return{registrations:this._registrations}}}var B;(function(pe){function x(){return new ie(void 0,[])}pe.create=x})(B||(vt.BulkUnregistration=B={}));class ie{constructor(x,O){this._connection=
x,this._unregistrations=new Map,O.forEach(K=>{this._unregistrations.set(K.method,K)})}get isAttached(){return!!this._connection}attach(x){this._connection=x}add(x){this._unregistrations.set(x.method,x)}dispose(){let x=[];for(let K of this._unregistrations.values())x.push(K);let O={unregisterations:x};this._connection.sendRequest(t.UnregistrationRequest.type,O).catch(()=>{this._connection.console.info("Bulk unregistration failed.")})}disposeSingle(x){const O=e.string(x)?x:x.method,K=this._unregistrations.
get(O);if(!K)return!1;let F={unregisterations:[K]};return this._connection.sendRequest(t.UnregistrationRequest.type,F).then(()=>{this._unregistrations.delete(O)},ae=>{this._connection.console.info(`Un-registering request handler for ${K.id} failed.`)}),!0}}class L{attach(x){this._connection=x}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(x){}fillServerCapabilities(x){}register(x,O,K){return x instanceof q?this.
registerMany(x):x instanceof ie?this.registerSingle1(x,O,K):this.registerSingle2(x,O)}registerSingle1(x,O,K){const F=e.string(O)?O:O.method,ae=n.generateUuid();let Re={registrations:[{id:ae,method:F,registerOptions:K||{}}]};return x.isAttached||x.attach(this.connection),this.connection.sendRequest(t.RegistrationRequest.type,Re).then(ze=>(x.add({id:ae,method:F}),x),ze=>(this.connection.console.info(`Registering request handler for ${F} failed.`),Promise.reject(ze)))}registerSingle2(x,O){const K=e.
string(x)?x:x.method,F=n.generateUuid();let ae={registrations:[{id:F,method:K,registerOptions:O||{}}]};return this.connection.sendRequest(t.RegistrationRequest.type,ae).then(Re=>t.Disposable.create(()=>{this.unregisterSingle(F,K).catch(()=>{this.connection.console.info(`Un-registering capability with id ${F} failed.`)})}),Re=>(this.connection.console.info(`Registering request handler for ${K} failed.`),Promise.reject(Re)))}unregisterSingle(x,O){let K={unregisterations:[{id:x,method:O}]};return this.
connection.sendRequest(t.UnregistrationRequest.type,K).catch(()=>{this.connection.console.info(`Un-registering request handler for ${x} failed.`)})}registerMany(x){let O=x.asRegistrationParams();return this.connection.sendRequest(t.RegistrationRequest.type,O).then(()=>new ie(this._connection,O.registrations.map(K=>({id:K.id,method:K.method}))),K=>(this.connection.console.info("Bulk registration failed."),Promise.reject(K)))}}class E{constructor(){}attach(x){this._connection=x}get connection(){if(!this.
_connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(x){}fillServerCapabilities(x){}applyEdit(x){function O(F){return F&&!!F.edit}let K=O(x)?x:{edit:x};return this.connection.sendRequest(t.ApplyWorkspaceEditRequest.type,K)}}const $=(0,c.FileOperationsFeature)((0,s.WorkspaceFoldersFeature)((0,i.ConfigurationFeature)(E)));class z{constructor(){this._trace=t.Trace.Off}attach(x){this._connection=x}get connection(){if(!this._connection)throw new Error(
"Remote is not attached to a connection yet.");return this._connection}initialize(x){}fillServerCapabilities(x){}set trace(x){this._trace=x}log(x,O){this._trace!==t.Trace.Off&&this.connection.sendNotification(t.LogTraceNotification.type,{message:x,verbose:this._trace===t.Trace.Verbose?O:void 0}).catch(()=>{})}}class j{constructor(){}attach(x){this._connection=x}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(x){}fillServerCapabilities(x){}logEvent(x){
this.connection.sendNotification(t.TelemetryEventNotification.type,x).catch(()=>{this.connection.console.log("Sending TelemetryEventNotification failed")})}}class U{constructor(){}attach(x){this._connection=x}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(x){}fillServerCapabilities(x){}attachWorkDoneProgress(x){return(0,r.attachWorkDone)(this.connection,x)}attachPartialResultProgress(x,O){return(0,r.attachPartialResult)(
this.connection,O)}}vt._LanguagesImpl=U;const W=(0,p.FoldingRangeFeature)((0,g.MonikerFeature)((0,w.DiagnosticFeature)((0,m.InlayHintFeature)((0,f.InlineValueFeature)((0,d.TypeHierarchyFeature)((0,u.LinkedEditingRangeFeature)((0,o.SemanticTokensFeature)((0,a.CallHierarchyFeature)(U)))))))));class le{constructor(){}attach(x){this._connection=x}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(x){}fillServerCapabilities(x){}attachWorkDoneProgress(x){
return(0,r.attachWorkDone)(this.connection,x)}attachPartialResultProgress(x,O){return(0,r.attachPartialResult)(this.connection,O)}}vt._NotebooksImpl=le;const ne=(0,v.NotebookSyncFeature)(le);function P(pe,x){return function(O){return x(pe(O))}}vt.combineConsoleFeatures=P;function M(pe,x){return function(O){return x(pe(O))}}vt.combineTelemetryFeatures=M;function J(pe,x){return function(O){return x(pe(O))}}vt.combineTracerFeatures=J;function G(pe,x){return function(O){return x(pe(O))}}vt.combineClientFeatures=
G;function _(pe,x){return function(O){return x(pe(O))}}vt.combineWindowFeatures=_;function I(pe,x){return function(O){return x(pe(O))}}vt.combineWorkspaceFeatures=I;function Y(pe,x){return function(O){return x(pe(O))}}vt.combineLanguagesFeatures=Y;function se(pe,x){return function(O){return x(pe(O))}}vt.combineNotebooksFeatures=se;function fe(pe,x){function O(F,ae,Re){return F&&ae?Re(F,ae):F||ae}return{__brand:"features",console:O(pe.console,x.console,P),tracer:O(pe.tracer,x.tracer,J),telemetry:O(
pe.telemetry,x.telemetry,M),client:O(pe.client,x.client,G),window:O(pe.window,x.window,_),workspace:O(pe.workspace,x.workspace,I),languages:O(pe.languages,x.languages,Y),notebooks:O(pe.notebooks,x.notebooks,se)}}vt.combineFeatures=fe;function _e(pe,x,O){const K=O&&O.console?new(O.console(b)):new b,F=pe(K);K.rawAttach(F);const ae=O&&O.tracer?new(O.tracer(z)):new z,Re=O&&O.telemetry?new(O.telemetry(j)):new j,ze=O&&O.client?new(O.client(L)):new L,ye=O&&O.window?new(O.window(T)):new T,Me=O&&O.workspace?
new(O.workspace($)):new $,me=O&&O.languages?new(O.languages(W)):new W,$e=O&&O.notebooks?new(O.notebooks(ne)):new ne,Ge=[K,ae,Re,ze,ye,Me,me,$e];function st(ce){return ce instanceof Promise?ce:e.thenable(ce)?new Promise((ue,Se)=>{ce.then(Ln=>ue(Ln),Ln=>Se(Ln))}):Promise.resolve(ce)}let ut,ln,Yt,_n={listen:()=>F.listen(),sendRequest:(ce,...ue)=>F.sendRequest(e.string(ce)?ce:ce.method,...ue),onRequest:(ce,ue)=>F.onRequest(ce,ue),sendNotification:(ce,ue)=>{const Se=e.string(ce)?ce:ce.method;return F.
sendNotification(Se,ue)},onNotification:(ce,ue)=>F.onNotification(ce,ue),onProgress:F.onProgress,sendProgress:F.sendProgress,onInitialize:ce=>(ln=ce,{dispose:()=>{ln=void 0}}),onInitialized:ce=>F.onNotification(t.InitializedNotification.type,ce),onShutdown:ce=>(ut=ce,{dispose:()=>{ut=void 0}}),onExit:ce=>(Yt=ce,{dispose:()=>{Yt=void 0}}),get console(){return K},get telemetry(){return Re},get tracer(){return ae},get client(){return ze},get window(){return ye},get workspace(){return Me},get languages(){
return me},get notebooks(){return $e},onDidChangeConfiguration:ce=>F.onNotification(t.DidChangeConfigurationNotification.type,ce),onDidChangeWatchedFiles:ce=>F.onNotification(t.DidChangeWatchedFilesNotification.type,ce),__textDocumentSync:void 0,onDidOpenTextDocument:ce=>F.onNotification(t.DidOpenTextDocumentNotification.type,ce),onDidChangeTextDocument:ce=>F.onNotification(t.DidChangeTextDocumentNotification.type,ce),onDidCloseTextDocument:ce=>F.onNotification(t.DidCloseTextDocumentNotification.
type,ce),onWillSaveTextDocument:ce=>F.onNotification(t.WillSaveTextDocumentNotification.type,ce),onWillSaveTextDocumentWaitUntil:ce=>F.onRequest(t.WillSaveTextDocumentWaitUntilRequest.type,ce),onDidSaveTextDocument:ce=>F.onNotification(t.DidSaveTextDocumentNotification.type,ce),sendDiagnostics:ce=>F.sendNotification(t.PublishDiagnosticsNotification.type,ce),onHover:ce=>F.onRequest(t.HoverRequest.type,(ue,Se)=>ce(ue,Se,(0,r.attachWorkDone)(F,ue),void 0)),onCompletion:ce=>F.onRequest(t.CompletionRequest.
type,(ue,Se)=>ce(ue,Se,(0,r.attachWorkDone)(F,ue),(0,r.attachPartialResult)(F,ue))),onCompletionResolve:ce=>F.onRequest(t.CompletionResolveRequest.type,ce),onSignatureHelp:ce=>F.onRequest(t.SignatureHelpRequest.type,(ue,Se)=>ce(ue,Se,(0,r.attachWorkDone)(F,ue),void 0)),onDeclaration:ce=>F.onRequest(t.DeclarationRequest.type,(ue,Se)=>ce(ue,Se,(0,r.attachWorkDone)(F,ue),(0,r.attachPartialResult)(F,ue))),onDefinition:ce=>F.onRequest(t.DefinitionRequest.type,(ue,Se)=>ce(ue,Se,(0,r.attachWorkDone)(F,
ue),(0,r.attachPartialResult)(F,ue))),onTypeDefinition:ce=>F.onRequest(t.TypeDefinitionRequest.type,(ue,Se)=>ce(ue,Se,(0,r.attachWorkDone)(F,ue),(0,r.attachPartialResult)(F,ue))),onImplementation:ce=>F.onRequest(t.ImplementationRequest.type,(ue,Se)=>ce(ue,Se,(0,r.attachWorkDone)(F,ue),(0,r.attachPartialResult)(F,ue))),onReferences:ce=>F.onRequest(t.ReferencesRequest.type,(ue,Se)=>ce(ue,Se,(0,r.attachWorkDone)(F,ue),(0,r.attachPartialResult)(F,ue))),onDocumentHighlight:ce=>F.onRequest(t.DocumentHighlightRequest.
type,(ue,Se)=>ce(ue,Se,(0,r.attachWorkDone)(F,ue),(0,r.attachPartialResult)(F,ue))),onDocumentSymbol:ce=>F.onRequest(t.DocumentSymbolRequest.type,(ue,Se)=>ce(ue,Se,(0,r.attachWorkDone)(F,ue),(0,r.attachPartialResult)(F,ue))),onWorkspaceSymbol:ce=>F.onRequest(t.WorkspaceSymbolRequest.type,(ue,Se)=>ce(ue,Se,(0,r.attachWorkDone)(F,ue),(0,r.attachPartialResult)(F,ue))),onWorkspaceSymbolResolve:ce=>F.onRequest(t.WorkspaceSymbolResolveRequest.type,ce),onCodeAction:ce=>F.onRequest(t.CodeActionRequest.type,
(ue,Se)=>ce(ue,Se,(0,r.attachWorkDone)(F,ue),(0,r.attachPartialResult)(F,ue))),onCodeActionResolve:ce=>F.onRequest(t.CodeActionResolveRequest.type,(ue,Se)=>ce(ue,Se)),onCodeLens:ce=>F.onRequest(t.CodeLensRequest.type,(ue,Se)=>ce(ue,Se,(0,r.attachWorkDone)(F,ue),(0,r.attachPartialResult)(F,ue))),onCodeLensResolve:ce=>F.onRequest(t.CodeLensResolveRequest.type,(ue,Se)=>ce(ue,Se)),onDocumentFormatting:ce=>F.onRequest(t.DocumentFormattingRequest.type,(ue,Se)=>ce(ue,Se,(0,r.attachWorkDone)(F,ue),void 0)),
onDocumentRangeFormatting:ce=>F.onRequest(t.DocumentRangeFormattingRequest.type,(ue,Se)=>ce(ue,Se,(0,r.attachWorkDone)(F,ue),void 0)),onDocumentOnTypeFormatting:ce=>F.onRequest(t.DocumentOnTypeFormattingRequest.type,(ue,Se)=>ce(ue,Se)),onRenameRequest:ce=>F.onRequest(t.RenameRequest.type,(ue,Se)=>ce(ue,Se,(0,r.attachWorkDone)(F,ue),void 0)),onPrepareRename:ce=>F.onRequest(t.PrepareRenameRequest.type,(ue,Se)=>ce(ue,Se)),onDocumentLinks:ce=>F.onRequest(t.DocumentLinkRequest.type,(ue,Se)=>ce(ue,Se,
(0,r.attachWorkDone)(F,ue),(0,r.attachPartialResult)(F,ue))),onDocumentLinkResolve:ce=>F.onRequest(t.DocumentLinkResolveRequest.type,(ue,Se)=>ce(ue,Se)),onDocumentColor:ce=>F.onRequest(t.DocumentColorRequest.type,(ue,Se)=>ce(ue,Se,(0,r.attachWorkDone)(F,ue),(0,r.attachPartialResult)(F,ue))),onColorPresentation:ce=>F.onRequest(t.ColorPresentationRequest.type,(ue,Se)=>ce(ue,Se,(0,r.attachWorkDone)(F,ue),(0,r.attachPartialResult)(F,ue))),onFoldingRanges:ce=>F.onRequest(t.FoldingRangeRequest.type,(ue,Se)=>ce(
ue,Se,(0,r.attachWorkDone)(F,ue),(0,r.attachPartialResult)(F,ue))),onSelectionRanges:ce=>F.onRequest(t.SelectionRangeRequest.type,(ue,Se)=>ce(ue,Se,(0,r.attachWorkDone)(F,ue),(0,r.attachPartialResult)(F,ue))),onExecuteCommand:ce=>F.onRequest(t.ExecuteCommandRequest.type,(ue,Se)=>ce(ue,Se,(0,r.attachWorkDone)(F,ue),void 0)),dispose:()=>F.dispose()};for(let ce of Ge)ce.attach(_n);return F.onRequest(t.InitializeRequest.type,ce=>{x.initialize(ce),e.string(ce.trace)&&(ae.trace=t.Trace.fromString(ce.trace));
for(let ue of Ge)ue.initialize(ce.capabilities);if(ln){let ue=ln(ce,new t.CancellationTokenSource().token,(0,r.attachWorkDone)(F,ce),void 0);return st(ue).then(Se=>{if(Se instanceof t.ResponseError)return Se;let Ln=Se;Ln||(Ln={capabilities:{}});let Cn=Ln.capabilities;Cn||(Cn={},Ln.capabilities=Cn),Cn.textDocumentSync===void 0||Cn.textDocumentSync===null?Cn.textDocumentSync=e.number(_n.__textDocumentSync)?_n.__textDocumentSync:t.TextDocumentSyncKind.None:!e.number(Cn.textDocumentSync)&&!e.number(
Cn.textDocumentSync.change)&&(Cn.textDocumentSync.change=e.number(_n.__textDocumentSync)?_n.__textDocumentSync:t.TextDocumentSyncKind.None);for(let Oi of Ge)Oi.fillServerCapabilities(Cn);return Ln})}else{let ue={capabilities:{textDocumentSync:t.TextDocumentSyncKind.None}};for(let Se of Ge)Se.fillServerCapabilities(ue.capabilities);return ue}}),F.onRequest(t.ShutdownRequest.type,()=>{if(x.shutdownReceived=!0,ut)return ut(new t.CancellationTokenSource().token)}),F.onNotification(t.ExitNotification.
type,()=>{try{Yt&&Yt()}finally{x.shutdownReceived?x.exit(0):x.exit(1)}}),F.onNotification(t.SetTraceNotification.type,ce=>{ae.trace=t.Trace.fromString(ce.value)}),_n}return vt.createConnection=_e,vt}var cr={},TI;function bZ(){if(TI)return cr;TI=1,Object.defineProperty(cr,"__esModule",{value:!0}),cr.resolveModulePath=cr.FileSystem=cr.resolveGlobalYarnPath=cr.resolveGlobalNodePath=cr.resolve=cr.uriToFilePath=void 0;const t=xq,e=ww,n=bw,r=Aq;function i(d){let f=t.parse(d);if(f.protocol!=="file:"||!f.
path)return;let p=f.path.split("/");for(var m=0,w=p.length;m<w;m++)p[m]=decodeURIComponent(p[m]);if(process.platform==="win32"&&p.length>1){let v=p[0],g=p[1];v.length===0&&g.length>1&&g[1]===":"&&p.shift()}return e.normalize(p.join("/"))}cr.uriToFilePath=i;function s(){return process.platform==="win32"}function a(d,f,p,m){const w="NODE_PATH",v=["var p = process;","p.on('message',function(m){","if(m.c==='e'){","p.exit(0);","}","else if(m.c==='rs'){","try{","var r=require.resolve(m.a);","p.send({c\
:'r',s:true,r:r});","}","catch(err){","p.send({c:'r',s:false});","}","}","});"].join("");return new Promise((g,h)=>{let y=process.env,b=Object.create(null);Object.keys(y).forEach(R=>b[R]=y[R]),f&&n.existsSync(f)&&(b[w]?b[w]=f+e.delimiter+b[w]:b[w]=f,m&&m(`NODE_PATH value is: ${b[w]}`)),b.ELECTRON_RUN_AS_NODE="1";try{let R=(0,r.fork)("",[],{cwd:p,env:b,execArgv:["-e",v]});if(R.pid===void 0){h(new Error(`Starting process to resolve node module  ${d} failed`));return}R.on("error",N=>{h(N)}),R.on("m\
essage",N=>{N.c==="r"&&(R.send({c:"e"}),N.s?g(N.r):h(new Error(`Failed to resolve module: ${d}`)))});let T={c:"rs",a:d};R.send(T)}catch(R){h(R)}})}cr.resolve=a;function o(d){let f="npm";const p=Object.create(null);Object.keys(process.env).forEach(v=>p[v]=process.env[v]),p.NO_UPDATE_NOTIFIER="true";const m={encoding:"utf8",env:p};s()&&(f="npm.cmd",m.shell=!0);let w=()=>{};try{process.on("SIGPIPE",w);let v=(0,r.spawnSync)(f,["config","get","prefix"],m).stdout;if(!v){d&&d("'npm config get prefix' d\
idn't return a value.");return}let g=v.trim();return d&&d(`'npm config get prefix' value is: ${g}`),g.length>0?s()?e.join(g,"node_modules"):e.join(g,"lib","node_modules"):void 0}catch{return}finally{process.removeListener("SIGPIPE",w)}}cr.resolveGlobalNodePath=o;function l(d){let f="yarn",p={encoding:"utf8"};s()&&(f="yarn.cmd",p.shell=!0);let m=()=>{};try{process.on("SIGPIPE",m);let w=(0,r.spawnSync)(f,["global","dir","--json"],p),v=w.stdout;if(!v){d&&(d("'yarn global dir' didn't return a value."),
w.stderr&&d(w.stderr));return}let g=v.trim().split(/\r?\n/);for(let h of g)try{let y=JSON.parse(h);if(y.type==="log")return e.join(y.data,"node_modules")}catch{}return}catch{return}finally{process.removeListener("SIGPIPE",m)}}cr.resolveGlobalYarnPath=l;var c;(function(d){let f;function p(){return f!==void 0||(process.platform==="win32"?f=!1:f=!n.existsSync(__filename.toUpperCase())||!n.existsSync(__filename.toLowerCase())),f}d.isCaseSensitive=p;function m(w,v){return p()?e.normalize(v).indexOf(e.
normalize(w))===0:e.normalize(v).toLowerCase().indexOf(e.normalize(w).toLowerCase())===0}d.isParent=m})(c||(cr.FileSystem=c={}));function u(d,f,p,m){return p?(e.isAbsolute(p)||(p=e.join(d,p)),a(f,p,p,m).then(w=>c.isParent(p,w)?w:Promise.reject(new Error(`Failed to load ${f} from node path location.`))).then(void 0,w=>a(f,o(m),d,m))):a(f,o(m),d,m)}return cr.resolveModulePath=u,cr}var a_,EI;function PI(){return EI||(EI=1,a_=vn()),a_}var To={},Pd={},CI;function kZ(){if(CI)return Pd;CI=1,Object.defineProperty(
Pd,"__esModule",{value:!0}),Pd.InlineCompletionFeature=void 0;const t=vn(),e=n=>class extends n{get inlineCompletion(){return{on:r=>this.connection.onRequest(t.InlineCompletionRequest.type,(i,s)=>r(i,s,this.attachWorkDoneProgress(i)))}}};return Pd.InlineCompletionFeature=e,Pd}var xI;function _Z(){return xI||(xI=1,(function(t){var e=To&&To.__createBinding||(Object.create?(function(l,c,u,d){d===void 0&&(d=u);var f=Object.getOwnPropertyDescriptor(c,u);(!f||("get"in f?!c.__esModule:f.writable||f.configurable))&&
(f={enumerable:!0,get:function(){return c[u]}}),Object.defineProperty(l,d,f)}):(function(l,c,u,d){d===void 0&&(d=u),l[d]=c[u]})),n=To&&To.__exportStar||function(l,c){for(var u in l)u!=="default"&&!Object.prototype.hasOwnProperty.call(c,u)&&e(c,l,u)};Object.defineProperty(t,"__esModule",{value:!0}),t.ProposedFeatures=t.NotebookDocuments=t.TextDocuments=t.SemanticTokensBuilder=void 0;const r=uI();Object.defineProperty(t,"SemanticTokensBuilder",{enumerable:!0,get:function(){return r.SemanticTokensBuilder}});
const i=kZ();n(vn(),t);const s=bI();Object.defineProperty(t,"TextDocuments",{enumerable:!0,get:function(){return s.TextDocuments}});const a=_I();Object.defineProperty(t,"NotebookDocuments",{enumerable:!0,get:function(){return a.NotebookDocuments}}),n($I(),t);var o;(function(l){l.all={__brand:"features",languages:i.InlineCompletionFeature}})(o||(t.ProposedFeatures=o={}))})(To)),To}var AI;function II(){return AI||(AI=1,(function(t){var e=mo&&mo.__createBinding||(Object.create?(function(g,h,y,b){b===
void 0&&(b=y);var R=Object.getOwnPropertyDescriptor(h,y);(!R||("get"in R?!h.__esModule:R.writable||R.configurable))&&(R={enumerable:!0,get:function(){return h[y]}}),Object.defineProperty(g,b,R)}):(function(g,h,y,b){b===void 0&&(b=y),g[b]=h[y]})),n=mo&&mo.__exportStar||function(g,h){for(var y in g)y!=="default"&&!Object.prototype.hasOwnProperty.call(h,y)&&e(h,g,y)};Object.defineProperty(t,"__esModule",{value:!0}),t.createConnection=t.Files=void 0;const r=K$,i=Xk(),s=$I(),a=bZ(),o=PI();n(PI(),t),n(
_Z(),t);var l;(function(g){g.uriToFilePath=a.uriToFilePath,g.resolveGlobalNodePath=a.resolveGlobalNodePath,g.resolveGlobalYarnPath=a.resolveGlobalYarnPath,g.resolve=a.resolve,g.resolveModulePath=a.resolveModulePath})(l||(t.Files=l={}));function c(){}let u=!1,d;function f(){const g="--clientProcessId";function h(y){try{let b=parseInt(y);isNaN(b)||(d=setInterval(()=>{try{process.kill(b,0)}catch{process.exit(u?0:1)}},3e3))}catch{}}for(let y=2;y<process.argv.length;y++){let b=process.argv[y];if(b===
g&&y+1<process.argv.length){h(process.argv[y+1]);return}else{let R=b.split("=");R[0]===g&&h(R[1])}}}f();const p={initialize:g=>{const h=g.processId;i.number(h)&&d===void 0&&setInterval(()=>{try{process.kill(h,0)}catch{process.exit(u?0:1)}},3e3)},get shutdownReceived(){return u},set shutdownReceived(g){u=g},exit:g=>{process.exit(g)}};function m(g,h,y,b){let R,T,N,q;return g!==void 0&&g.__brand==="features"&&(R=g,g=h,h=y,y=b),o.ConnectionStrategy.is(g)||o.ConnectionOptions.is(g)?q=g:(T=g,N=h,q=y),
w(T,N,q,R)}t.createConnection=m;function w(g,h,y,b){let R=!1;if(!g&&!h&&process.argv.length>2){let B,ie,L=process.argv.slice(2);for(let E=0;E<L.length;E++){let $=L[E];if($==="--node-ipc"){g=new o.IPCMessageReader(process),h=new o.IPCMessageWriter(process);break}else if($==="--stdio"){R=!0,g=process.stdin,h=process.stdout;break}else if($==="--socket"){B=parseInt(L[E+1]);break}else if($==="--pipe"){ie=L[E+1];break}else{var T=$.split("=");if(T[0]==="--socket"){B=parseInt(T[1]);break}else if(T[0]===
"--pipe"){ie=T[1];break}}}if(B){let E=(0,o.createServerSocketTransport)(B);g=E[0],h=E[1]}else if(ie){let E=(0,o.createServerPipeTransport)(ie);g=E[0],h=E[1]}}var N="Use arguments of createConnection or set command line parameters: '--node-ipc', '--stdio' or '--socket={number}'";if(!g)throw new Error("Connection input stream is not set. "+N);if(!h)throw new Error("Connection output stream is not set. "+N);if(i.func(g.read)&&i.func(g.on)){let B=g;B.on("end",()=>{process.exit(u?0:1)}),B.on("close",
()=>{process.exit(u?0:1)})}const q=B=>{const ie=(0,o.createProtocolConnection)(g,h,B,y);return R&&v(B),ie};return(0,s.createConnection)(q,p,b)}function v(g){function h(b){return b.map(R=>typeof R=="string"?R:(0,r.inspect)(R)).join(" ")}const y=new Map;console.assert=function(R,...T){if(!R)if(T.length===0)g.error("Assertion failed");else{const[N,...q]=T;g.error(`Assertion failed: ${N} ${h(q)}`)}},console.count=function(R="default"){const T=String(R);let N=y.get(T)??0;N+=1,y.set(T,N),g.log(`${T}: ${T}`)},
console.countReset=function(R){R===void 0?y.clear():y.delete(String(R))},console.debug=function(...R){g.log(h(R))},console.dir=function(R,T){g.log((0,r.inspect)(R,T))},console.log=function(...R){g.log(h(R))},console.error=function(...R){g.error(h(R))},console.trace=function(...R){const T=new Error().stack.replace(/(.+\n){2}/,"");let N="Trace";R.length!==0&&(N+=`: ${h(R)}`),g.log(`${N}
${T}`)},console.warn=function(...R){g.warn(h(R))}}})(mo)),mo}var Pe=II();function NI(t,e){const n={stacks:t,tokens:e};return RZ(n),n.stacks.flat().forEach(i=>{i.property=void 0}),OI(n.stacks).map(i=>i[i.length-1])}function o_(t){const{next:e,cardinalities:n,visited:r,plus:i}=t,s=[],a=e.feature;if(r.has(a))return[];ra(a)||r.add(a);let o,l=a;for(;l.$container;)if(ra(l.$container)){o=l.$container;break}else if(jw(l.$container))l=l.$container;else break;if(W0(l.cardinality)){const c=Ul({next:{feature:l,
type:e.type},cardinalities:n,visited:r,plus:i});for(const u of c)i.add(u.feature);s.push(...c)}if(o){const c=o.elements.indexOf(l);c!==void 0&&c<o.elements.length-1&&s.push(...DI({feature:o,type:e.type},c+1,n,r,i)),s.every(u=>Rl(u.feature.cardinality,u.feature)||Rl(n.get(u.feature))||i.has(u.feature))&&s.push(...o_({next:{feature:o,type:e.type},cardinalities:n,visited:r,plus:i}))}return s}function l_(t){return Xt(t)&&(t={feature:t}),Ul({next:t,cardinalities:new Map,visited:new Set,plus:new Set})}
function Ul(t){var e,n,r;const{next:i,cardinalities:s,visited:a,plus:o}=t;if(i===void 0)return[];const{feature:l,type:c}=i;if(ra(l))return a.has(l)?[]:(a.add(l),DI(i,0,s,a,o).map(u=>ng(u,l.cardinality,s)));if(Vw(l)||Bw(l))return l.elements.flatMap(u=>Ul({next:{feature:u,type:c,property:i.property},cardinalities:s,visited:a,plus:o})).map(u=>ng(u,l.cardinality,s));if(Fi(l)){const u={feature:l.terminal,type:c,property:(e=i.property)!==null&&e!==void 0?e:l.feature};return Ul({next:u,cardinalities:s,
visited:a,plus:o}).map(d=>ng(d,l.cardinality,s))}else{if(Ka(l))return o_({next:{feature:l,type:Pu(l),property:(n=i.property)!==null&&n!==void 0?n:l.feature},cardinalities:s,visited:a,plus:o});if(zi(l)&&In(l.rule.ref)){const u=l.rule.ref,d={feature:u.definition,type:u.fragment||u.dataType?void 0:(r=Ja(u))!==null&&r!==void 0?r:u.name,property:i.property};return Ul({next:d,cardinalities:s,visited:a,plus:o}).map(f=>ng(f,l.cardinality,s))}else return[i]}}function ng(t,e,n){return n.set(t.feature,e),t}
function DI(t,e,n,r,i){var s;const a=[];let o;for(;e<t.feature.elements.length&&(o={feature:t.feature.elements[e++],type:t.type},a.push(...Ul({next:o,cardinalities:n,visited:r,plus:i})),!!Rl((s=o.feature.cardinality)!==null&&s!==void 0?s:n.get(o.feature),o.feature)););return a}function RZ(t){for(const e of t.tokens){const n=OI(t.stacks,e);t.stacks=n}}function OI(t,e){const n=[];for(const r of t)n.push(...SZ(r,e));return n}function SZ(t,e){const n=new Map,r=new Set(t.map(s=>s.feature).filter($Z)),
i=[];for(;t.length>0;){const s=t.pop(),a=o_({next:s,cardinalities:n,plus:r,visited:new Set}).filter(o=>e?c_(o.feature,e):!0);for(const o of a)i.push([...t,o]);if(!a.every(o=>Rl(o.feature.cardinality,o.feature)||Rl(n.get(o.feature))))break}return i}function $Z(t){if(t.cardinality==="+")return!0;const e=xr(t,Fi);return!!(e&&e.cardinality==="+")}function c_(t,e){if(Xr(t))return t.value===e.image;if(zi(t))return TZ(t.rule.ref,e);if(Za(t)){const n=Qw(t);if(n)return c_(n,e)}return!1}function TZ(t,e){return In(
t)?l_(t.definition).some(r=>c_(r.feature,e)):ps(t)?Cu(t).test(e.image):!1}function EZ(t){const e=Array.from(new Set(t.flatMap(r=>{var i;return(i=r?.triggerCharacters)!==null&&i!==void 0?i:[]}))),n=Array.from(new Set(t.flatMap(r=>{var i;return(i=r?.allCommitCharacters)!==null&&i!==void 0?i:[]})));return{triggerCharacters:e.length>0?e:void 0,allCommitCharacters:n.length>0?n:void 0}}class LI{constructor(e){this.scopeProvider=e.references.ScopeProvider,this.grammar=e.Grammar,this.completionParser=e.
parser.CompletionParser,this.nameProvider=e.references.NameProvider,this.lexer=e.parser.Lexer,this.nodeKindProvider=e.shared.lsp.NodeKindProvider,this.fuzzyMatcher=e.shared.lsp.FuzzyMatcher,this.grammarConfig=e.parser.GrammarConfig,this.astReflection=e.shared.AstReflection,this.documentationProvider=e.documentation.DocumentationProvider}async getCompletion(e,n,r){const i=[],s=this.buildContexts(e,n.position),a=(c,u)=>{const d=this.fillCompletionItem(c,u);d&&i.push(d)},o=c=>Xr(c.feature)?c.feature.
value:c.feature,l=[];for(const c of s)if(await Promise.all(dt(c.features).distinct(o).exclude(l).map(u=>this.completionFor(c,u,a))),l.push(...c.features),!this.continueCompletion(i))break;return Pe.CompletionList.create(this.deduplicateItems(i),!0)}deduplicateItems(e){return dt(e).distinct(n=>`${n.kind}_${n.label}_${n.detail}`).toArray()}findFeaturesAt(e,n){const r=e.getText({start:Pe.Position.create(0,0),end:e.positionAt(n)}),i=this.completionParser.parse(r),s=i.tokens;if(i.tokenIndex===0){const l=Hh(
this.grammar),c=l_({feature:l.definition,type:Ja(l)});return s.length>0?(s.shift(),NI(c.map(u=>[u]),s)):c}const a=[...s].splice(i.tokenIndex);return NI([i.elementStack.map(l=>({feature:l}))],a)}*buildContexts(e,n){var r,i;const s=e.parseResult.value.$cstNode;if(!s)return;const a=e.textDocument,o=a.getText(),l=a.offsetAt(n),c={document:e,textDocument:a,offset:l,position:n},u=this.findDataTypeRuleStart(s,l);if(u){const[h,y]=u,b=(r=Ow(s,h))===null||r===void 0?void 0:r.astNode;yield Object.assign(Object.
assign({},c),{node:b,tokenOffset:h,tokenEndOffset:y,features:this.findFeaturesAt(a,h)})}const{nextTokenStart:d,nextTokenEnd:f,previousTokenStart:p,previousTokenEnd:m}=this.backtrackToAnyToken(o,l);let w=d;l<=d&&p!==void 0&&(w=p);const v=(i=Ow(s,w))===null||i===void 0?void 0:i.astNode;let g=!0;if(p!==void 0&&m!==void 0&&m===l&&(yield Object.assign(Object.assign({},c),{node:v,tokenOffset:p,tokenEndOffset:m,features:this.findFeaturesAt(a,p)}),g=this.performNextTokenCompletion(e,o.substring(p,m),p,m),
g&&(yield Object.assign(Object.assign({},c),{node:v,tokenOffset:m,tokenEndOffset:m,features:this.findFeaturesAt(a,m)}))),v)g&&(yield Object.assign(Object.assign({},c),{node:v,tokenOffset:d,tokenEndOffset:f,features:this.findFeaturesAt(a,d)}));else{const h=Hh(this.grammar);if(!h)throw new Error("Missing entry parser rule");yield Object.assign(Object.assign({},c),{tokenOffset:d,tokenEndOffset:f,features:l_(h.definition)})}}performNextTokenCompletion(e,n,r,i){return new RegExp("\\P{L}$","u").test(n)}findDataTypeRuleStart(e,n){
var r,i;let s=Ga(e,n,this.grammarConfig.nameRegexp),a=!!(!((r=xr(s?.grammarSource,In))===null||r===void 0)&&r.dataType);if(a){for(;a;)s=s?.container,a=!!(!((i=xr(s?.grammarSource,In))===null||i===void 0)&&i.dataType);if(s)return[s.offset,s.end]}}continueCompletion(e){return e.length===0}backtrackToAnyToken(e,n){const r=this.lexer.tokenize(e).tokens;if(r.length===0)return{nextTokenStart:n,nextTokenEnd:n};let i;for(const s of r){if(s.startOffset>=n)return{nextTokenStart:n,nextTokenEnd:n,previousTokenStart:i?
i.startOffset:void 0,previousTokenEnd:i?i.endOffset+1:void 0};if(s.endOffset>=n)return{nextTokenStart:s.startOffset,nextTokenEnd:s.endOffset+1,previousTokenStart:i?i.startOffset:void 0,previousTokenEnd:i?i.endOffset+1:void 0};i=s}return{nextTokenStart:n,nextTokenEnd:n,previousTokenStart:i?i.startOffset:void 0,previousTokenEnd:i?i.endOffset+1:void 0}}completionFor(e,n,r){if(Xr(n.feature))return this.completionForKeyword(e,n.feature,r);if(Za(n.feature)&&e.node)return this.completionForCrossReference(
e,n,r)}completionForCrossReference(e,n,r){const i=xr(n.feature,Fi);let s=e.node;if(i&&s){n.type&&(s={$type:n.type,$container:s,$containerProperty:n.property},Kw(this.astReflection,s));const a={reference:{$refText:""},container:s,property:i.feature};try{for(const o of this.getReferenceCandidates(a,e))r(e,this.createReferenceCompletionItem(o))}catch(o){console.error(o)}}}getReferenceCandidates(e,n){return this.scopeProvider.getScope(e).getAllElements()}createReferenceCompletionItem(e){const n=this.
nodeKindProvider.getCompletionItemKind(e),r=this.getReferenceDocumentation(e);return{nodeDescription:e,kind:n,documentation:r,detail:e.type,sortText:"0"}}getReferenceDocumentation(e){if(!e.node)return;const n=this.documentationProvider.getDocumentation(e.node);if(n)return{kind:"markdown",value:n}}completionForKeyword(e,n,r){this.filterKeyword(e,n)&&r(e,{label:n.value,kind:this.getKeywordCompletionItemKind(n),detail:"Keyword",sortText:"1"})}getKeywordCompletionItemKind(e){return Pe.CompletionItemKind.
Keyword}filterKeyword(e,n){return new RegExp("\\p{L}","u").test(n.value)}fillCompletionItem(e,n){var r,i;let s;if(typeof n.label=="string")s=n.label;else if("node"in n){const c=this.nameProvider.getName(n.node);if(!c)return;s=c}else if("nodeDescription"in n)s=n.nodeDescription.name;else return;let a;typeof((r=n.textEdit)===null||r===void 0?void 0:r.newText)=="string"?a=n.textEdit.newText:typeof n.insertText=="string"?a=n.insertText:a=s;const o=(i=n.textEdit)!==null&&i!==void 0?i:this.buildCompletionTextEdit(
e,s,a);return o?{additionalTextEdits:n.additionalTextEdits,command:n.command,commitCharacters:n.commitCharacters,data:n.data,detail:n.detail,documentation:n.documentation,filterText:n.filterText,insertText:n.insertText,insertTextFormat:n.insertTextFormat,insertTextMode:n.insertTextMode,kind:n.kind,labelDetails:n.labelDetails,preselect:n.preselect,sortText:n.sortText,tags:n.tags,textEditText:n.textEditText,textEdit:o,label:s}:void 0}buildCompletionTextEdit(e,n,r){const s=e.textDocument.getText().
substring(e.tokenOffset,e.offset);if(this.fuzzyMatcher.match(s,n)){const a=e.textDocument.positionAt(e.tokenOffset),o=e.position;return{newText:r,range:{start:a,end:o}}}else return}}class PZ{constructor(e){this.nameProvider=e.references.NameProvider,this.references=e.references.References,this.grammarConfig=e.parser.GrammarConfig}getDefinition(e,n,r){const i=e.parseResult.value;if(i.$cstNode){const s=i.$cstNode,a=Ga(s,e.textDocument.offsetAt(n.position),this.grammarConfig.nameRegexp);if(a)return this.
collectLocationLinks(a,n)}}collectLocationLinks(e,n){var r;const i=this.findLink(e);if(i)return[Pe.LocationLink.create(i.targetDocument.textDocument.uri,((r=i.target.astNode.$cstNode)!==null&&r!==void 0?r:i.target).range,i.target.range,i.source.range)]}findLink(e){const n=this.references.findDeclarationNode(e);if(n?.astNode){const r=$t(n.astNode);if(n&&r)return{source:e,target:n,targetDocument:r}}}}class MI{constructor(e){this.references=e.references.References,this.nameProvider=e.references.NameProvider,
this.grammarConfig=e.parser.GrammarConfig}getDocumentHighlight(e,n,r){const i=e.parseResult.value.$cstNode;if(!i)return;const s=Ga(i,e.textDocument.offsetAt(n.position),this.grammarConfig.nameRegexp);if(!s)return;const a=this.references.findDeclaration(s);if(a){const o=tt.equals($t(a).uri,e.uri),l={documentUri:e.uri,includeDeclaration:o};return this.references.findReferences(a,l).map(u=>this.createDocumentHighlight(u)).toArray()}}createDocumentHighlight(e){return Pe.DocumentHighlight.create(e.segment.
range)}}class CZ{constructor(e){this.nameProvider=e.references.NameProvider,this.nodeKindProvider=e.shared.lsp.NodeKindProvider}getSymbols(e,n,r){return this.getSymbol(e,e.parseResult.value)}getSymbol(e,n){const r=n.$cstNode,i=this.nameProvider.getNameNode(n);if(i&&r){const s=this.nameProvider.getName(n);return[{kind:this.nodeKindProvider.getSymbolKind(n),name:s||i.text,range:r.range,selectionRange:i.range,children:this.getChildSymbols(e,n)}]}else return this.getChildSymbols(e,n)||[]}getChildSymbols(e,n){
const r=[];for(const i of $u(n)){const s=this.getSymbol(e,i);r.push(...s)}if(r.length>0)return r}}class xZ{constructor(e){this.workspaceManager=e.workspace.WorkspaceManager,this.documentBuilder=e.workspace.DocumentBuilder,this.workspaceLock=e.workspace.WorkspaceLock,this.serviceRegistry=e.ServiceRegistry;let n=!1;e.lsp.LanguageServer.onInitialize(r=>{var i,s;n=!!(!((s=(i=r.capabilities.workspace)===null||i===void 0?void 0:i.didChangeWatchedFiles)===null||s===void 0)&&s.dynamicRegistration)}),e.lsp.
LanguageServer.onInitialized(r=>{n&&this.registerFileWatcher(e)})}registerFileWatcher(e){const n=[],r=dt(e.ServiceRegistry.all).flatMap(s=>s.LanguageMetaData.fileExtensions).map(s=>s.startsWith(".")?s.substring(1):s).distinct().toArray();r.length>0&&n.push({globPattern:r.length===1?`**/*.${r[0]}`:`**/*.{${r.join(",")}}`});const i=dt(e.ServiceRegistry.all).flatMap(s=>{var a;return(a=s.LanguageMetaData.fileNames)!==null&&a!==void 0?a:[]}).distinct().toArray();if(i.length>0&&n.push({globPattern:i.length===
1?`**/${i[0]}`:`**/{${i.join(",")}}`}),n.length>0){const s=e.lsp.Connection,a={watchers:n};s?.client.register(Pe.DidChangeWatchedFilesNotification.type,a)}}fireDocumentUpdate(e,n){e=e.filter(r=>this.serviceRegistry.hasServices(r)),this.workspaceManager.ready.then(()=>{this.workspaceLock.write(r=>this.documentBuilder.update(e,n,r))}).catch(r=>{console.error("Workspace initialization failed. Could not perform document update.",r)})}didChangeContent(e){this.fireDocumentUpdate([ot.parse(e.document.uri)],
[])}didChangeWatchedFiles(e){const n=dt(e.changes).filter(i=>i.type!==Pe.FileChangeType.Deleted).distinct(i=>i.uri).map(i=>ot.parse(i.uri)).toArray(),r=dt(e.changes).filter(i=>i.type===Pe.FileChangeType.Deleted).distinct(i=>i.uri).map(i=>ot.parse(i.uri)).toArray();this.fireDocumentUpdate(n,r)}}class AZ{constructor(e){this.commentNames=e.parser.GrammarConfig.multilineCommentRules}getFoldingRanges(e,n,r){const i=[],s=a=>i.push(a);return this.collectFolding(e,s),i}collectFolding(e,n){var r;const i=(r=
e.parseResult)===null||r===void 0?void 0:r.value;if(i){if(this.shouldProcessContent(i)){const s=hi(i).iterator();let a;do if(a=s.next(),!a.done){const o=a.value;this.shouldProcess(o)&&this.collectObjectFolding(e,o,n),this.shouldProcessContent(o)||s.prune()}while(!a.done)}this.collectCommentFolding(e,i,n)}}shouldProcess(e){return!0}shouldProcessContent(e){return!0}collectObjectFolding(e,n,r){const i=n.$cstNode;if(i){const s=this.toFoldingRange(e,i);s&&r(s)}}collectCommentFolding(e,n,r){const i=n.
$cstNode;if(i){for(const s of qF(i))if(this.commentNames.includes(s.tokenType.name)){const a=this.toFoldingRange(e,s,Pe.FoldingRangeKind.Comment);a&&r(a)}}}toFoldingRange(e,n,r){const i=n.range,s=i.start;let a=i.end;if(!(a.line-s.line<2))return this.includeLastFoldingLine(n,r)||(a=e.textDocument.positionAt(e.textDocument.offsetAt({line:a.line,character:0})-1)),Pe.FoldingRange.create(s.line,a.line,s.character,a.character,r)}includeLastFoldingLine(e,n){if(n===Pe.FoldingRangeKind.Comment)return!1;const r=e.
text,i=r.charAt(r.length-1);return!(i==="}"||i===")"||i==="]")}}class IZ{match(e,n){if(e.length===0)return!0;let r=!1,i,s=0;const a=n.length;for(let o=0;o<a;o++){const l=n.charCodeAt(o),c=e.charCodeAt(s);if((l===c||this.toUpperCharCode(l)===this.toUpperCharCode(c))&&(r||(r=i===void 0||this.isWordTransition(i,l)),r&&s++,s===e.length))return!0;i=l}return!1}isWordTransition(e,n){return jI<=e&&e<=qI&&NZ<=n&&n<=DZ||e===FI&&n!==FI}toUpperCharCode(e){return jI<=e&&e<=qI?e-32:e}}const jI=97,qI=122,NZ=65,
DZ=90,FI=95;class zI{constructor(e){this.references=e.references.References,this.grammarConfig=e.parser.GrammarConfig}getHoverContent(e,n){var r,i;const s=(i=(r=e.parseResult)===null||r===void 0?void 0:r.value)===null||i===void 0?void 0:i.$cstNode;if(s){const a=e.textDocument.offsetAt(n.position),o=Ga(s,a,this.grammarConfig.nameRegexp);if(o&&o.offset+o.length>a){const l=this.references.findDeclaration(o);if(l)return this.getAstNodeHoverContent(l);if(Xr(o.grammarSource))return this.getKeywordHoverContent(
o.grammarSource)}}}getKeywordHoverContent(e){var n;let r=VC(e)?e.$comment:void 0;if(r||(r=(n=Wc(e.$cstNode,["ML_COMMENT"]))===null||n===void 0?void 0:n.text),r&&QC(r)){const i=XC(r).toMarkdown();if(i)return{contents:{kind:"markdown",value:i}}}}}class OZ extends zI{constructor(e){super(e),this.documentationProvider=e.documentation.DocumentationProvider}getAstNodeHoverContent(e){const n=this.documentationProvider.getDocumentation(e);if(n)return{contents:{kind:"markdown",value:n}}}}var Ji=vn();const LZ={
[Pe.SemanticTokenTypes.class]:0,[Pe.SemanticTokenTypes.comment]:1,[Pe.SemanticTokenTypes.enum]:2,[Pe.SemanticTokenTypes.enumMember]:3,[Pe.SemanticTokenTypes.event]:4,[Pe.SemanticTokenTypes.function]:5,[Pe.SemanticTokenTypes.interface]:6,[Pe.SemanticTokenTypes.keyword]:7,[Pe.SemanticTokenTypes.macro]:8,[Pe.SemanticTokenTypes.method]:9,[Pe.SemanticTokenTypes.modifier]:10,[Pe.SemanticTokenTypes.namespace]:11,[Pe.SemanticTokenTypes.number]:12,[Pe.SemanticTokenTypes.operator]:13,[Pe.SemanticTokenTypes.
parameter]:14,[Pe.SemanticTokenTypes.property]:15,[Pe.SemanticTokenTypes.regexp]:16,[Pe.SemanticTokenTypes.string]:17,[Pe.SemanticTokenTypes.struct]:18,[Pe.SemanticTokenTypes.type]:19,[Pe.SemanticTokenTypes.typeParameter]:20,[Pe.SemanticTokenTypes.variable]:21,[Pe.SemanticTokenTypes.decorator]:22},MZ={[Pe.SemanticTokenModifiers.abstract]:1,[Pe.SemanticTokenModifiers.async]:2,[Pe.SemanticTokenModifiers.declaration]:4,[Pe.SemanticTokenModifiers.defaultLibrary]:8,[Pe.SemanticTokenModifiers.definition]:16,
[Pe.SemanticTokenModifiers.deprecated]:32,[Pe.SemanticTokenModifiers.documentation]:64,[Pe.SemanticTokenModifiers.modification]:128,[Pe.SemanticTokenModifiers.readonly]:256,[Pe.SemanticTokenModifiers.static]:512};function jZ(t){const e=[],n=[];let r=!0,i=!0,s=!0;for(const a of t)a&&(a.legend.tokenTypes.forEach((o,l)=>{const c=e[l];if(c&&c!==o)throw new Error(`Cannot merge '${c}' and '${o}' token types. They use the same index ${l}.`);e[l]=o}),a.legend.tokenModifiers.forEach((o,l)=>{const c=n[l];
if(c&&c!==o)throw new Error(`Cannot merge '${c}' and '${o}' token modifier. They use the same index ${l}.`);n[l]=o}),a.full?typeof a.full=="object"&&!a.full.delta&&(i=!1):r=!1,a.range||(s=!1));return{legend:{tokenTypes:e,tokenModifiers:n},full:r&&{delta:i},range:s}}class qZ extends Pe.SemanticTokensBuilder{constructor(){super(...arguments),this._tokens=[]}push(e,n,r,i,s){this._tokens.push({line:e,char:n,length:r,tokenType:i,tokenModifiers:s})}build(){return this.applyTokens(),super.build()}buildEdits(){
return this.applyTokens(),super.buildEdits()}flush(){this.previousResult(this.id)}applyTokens(){for(const e of this._tokens.sort(this.compareTokens))super.push(e.line,e.char,e.length,e.tokenType,e.tokenModifiers);this._tokens=[]}compareTokens(e,n){return e.line===n.line?e.char-n.char:e.line-n.line}}class FZ{constructor(e){this.tokensBuilders=new Map,e.shared.workspace.TextDocuments.onDidClose(n=>{this.tokensBuilders.delete(n.document.uri)}),e.shared.lsp.LanguageServer.onInitialize(n=>{var r;this.
initialize((r=n.capabilities.textDocument)===null||r===void 0?void 0:r.semanticTokens)})}initialize(e){this.clientCapabilities=e}get tokenTypes(){return LZ}get tokenModifiers(){return MZ}get semanticTokensOptions(){return{legend:{tokenTypes:Object.keys(this.tokenTypes),tokenModifiers:Object.keys(this.tokenModifiers)},full:{delta:!0},range:!0}}async semanticHighlight(e,n,r=Mt.CancellationToken.None){return this.currentRange=void 0,this.currentDocument=e,this.currentTokensBuilder=this.getDocumentTokensBuilder(
e),this.currentTokensBuilder.flush(),await this.computeHighlighting(e,this.createAcceptor(),r),this.currentTokensBuilder.build()}async semanticHighlightRange(e,n,r=Mt.CancellationToken.None){return this.currentRange=n.range,this.currentDocument=e,this.currentTokensBuilder=this.getDocumentTokensBuilder(e),this.currentTokensBuilder.flush(),await this.computeHighlighting(e,this.createAcceptor(),r),this.currentTokensBuilder.build()}async semanticHighlightDelta(e,n,r=Mt.CancellationToken.None){return this.
currentRange=void 0,this.currentDocument=e,this.currentTokensBuilder=this.getDocumentTokensBuilder(e),this.currentTokensBuilder.previousResult(n.previousResultId),await this.computeHighlighting(e,this.createAcceptor(),r),this.currentTokensBuilder.buildEdits()}createAcceptor(){return n=>{"line"in n?this.highlightToken({range:{start:{line:n.line,character:n.char},end:{line:n.line,character:n.char+n.length}},type:n.type,modifier:n.modifier}):"range"in n?this.highlightToken(n):"keyword"in n?this.highlightKeyword(
n):"property"in n?this.highlightProperty(n):this.highlightNode({node:n.cst,type:n.type,modifier:n.modifier})}}getDocumentTokensBuilder(e){const n=this.tokensBuilders.get(e.uri.toString());if(n)return n;const r=new qZ;return this.tokensBuilders.set(e.uri.toString(),r),r}async computeHighlighting(e,n,r){const i=e.parseResult.value,s=hs(i,{range:this.currentRange}).iterator();let a;do if(a=s.next(),!a.done){await mn(r);const o=a.value;this.highlightElement(o,n)==="prune"&&s.prune()}while(!a.done)}highlightToken(e){
var n;const{range:r,type:i}=e;let s=e.modifier;if(this.currentRange&&!_0(r,this.currentRange)||!this.currentDocument||!this.currentTokensBuilder)return;const a=this.tokenTypes[i];let o=0;if(s!==void 0){typeof s=="string"&&(s=[s]);for(const u of s){const d=this.tokenModifiers[u];o|=d}}const l=r.start.line,c=r.end.line;if(l===c){const u=r.start.character,d=r.end.character-u;this.currentTokensBuilder.push(l,u,d,a,o)}else if(!((n=this.clientCapabilities)===null||n===void 0)&&n.multilineTokenSupport){
const u=r.start.character,d=this.currentDocument.textDocument.offsetAt(r.start),f=this.currentDocument.textDocument.offsetAt(r.end);this.currentTokensBuilder.push(l,u,f-d,a,o)}else{const u=r.start;let d=this.currentDocument.textDocument.offsetAt({line:l+1,character:0});this.currentTokensBuilder.push(u.line,u.character,d-u.character-1,a,o);for(let f=l+1;f<c;f++){const p=d;d=this.currentDocument.textDocument.offsetAt({line:f+1,character:0}),this.currentTokensBuilder.push(f,0,d-p-1,a,o)}this.currentTokensBuilder.
push(c,0,r.end.character,a,o)}}highlightProperty(e){const n=[];if(typeof e.index=="number"){const s=Yn(e.node.$cstNode,e.property,e.index);s&&n.push(s)}else n.push(..._l(e.node.$cstNode,e.property));const{type:r,modifier:i}=e;for(const s of n)this.highlightNode({node:s,type:r,modifier:i})}highlightKeyword(e){const{node:n,keyword:r,type:i,index:s,modifier:a}=e,o=[];if(typeof s=="number"){const l=Eu(n.$cstNode,r,s);l&&o.push(l)}else o.push(...tb(n.$cstNode,r));for(const l of o)this.highlightNode({
node:l,type:i,modifier:a})}highlightNode(e){const{node:n,type:r,modifier:i}=e,s=n.range;this.highlightToken({range:s,type:r,modifier:i})}}var UI;(function(t){function e(r,i,s){const a=new Map;Object.entries(i).forEach(([c,u])=>a.set(u,c));let o=0,l=0;return n(r.data,5).map(c=>{o+=c[0],c[0]!==0&&(l=0),l+=c[1];const u=c[2];return{offset:s.textDocument.offsetAt({line:o,character:l}),tokenType:a.get(c[3]),tokenModifiers:c[4],text:s.textDocument.getText({start:{line:o,character:l},end:{line:o,character:l+
u}})}})}t.decode=e;function n(r,i){const s=[];for(let a=0;a<r.length;a+=i){const o=r.slice(a,a+i);s.push(o)}return s}})(UI||(UI={}));function zZ(t){const e=[],n=[];t.forEach(i=>{i?.triggerCharacters&&e.push(...i.triggerCharacters),i?.retriggerCharacters&&n.push(...i.retriggerCharacters)});const r={triggerCharacters:e.length>0?Array.from(new Set(e)).sort():void 0,retriggerCharacters:n.length>0?Array.from(new Set(n)).sort():void 0};return r.triggerCharacters?r:void 0}class UZ{constructor(e){this.onInitializeEmitter=
new Ji.Emitter,this.onInitializedEmitter=new Ji.Emitter,this.services=e}get onInitialize(){return this.onInitializeEmitter.event}get onInitialized(){return this.onInitializedEmitter.event}async initialize(e){return this.eagerLoadServices(),this.fireInitializeOnDefaultServices(e),this.onInitializeEmitter.fire(e),this.onInitializeEmitter.dispose(),this.buildInitializeResult(e)}eagerLoadServices(){Dk(this.services),this.services.ServiceRegistry.all.forEach(e=>Dk(e))}hasService(e){return this.services.
ServiceRegistry.all.some(r=>e(r)!==void 0)}buildInitializeResult(e){var n,r,i,s;const a=this.services.lsp.DocumentUpdateHandler,o=(n=this.services.lsp.FileOperationHandler)===null||n===void 0?void 0:n.fileOperationOptions,l=this.services.ServiceRegistry.all,c=this.hasService(ne=>{var P;return(P=ne.lsp)===null||P===void 0?void 0:P.Formatter}),u=l.map(ne=>{var P,M;return(M=(P=ne.lsp)===null||P===void 0?void 0:P.Formatter)===null||M===void 0?void 0:M.formatOnTypeOptions}).find(ne=>!!ne),d=this.hasService(
ne=>{var P;return(P=ne.lsp)===null||P===void 0?void 0:P.CodeActionProvider}),f=this.hasService(ne=>{var P;return(P=ne.lsp)===null||P===void 0?void 0:P.SemanticTokenProvider}),p=jZ(l.map(ne=>{var P,M;return(M=(P=ne.lsp)===null||P===void 0?void 0:P.SemanticTokenProvider)===null||M===void 0?void 0:M.semanticTokensOptions})),m=(i=(r=this.services.lsp)===null||r===void 0?void 0:r.ExecuteCommandHandler)===null||i===void 0?void 0:i.commands,w=this.hasService(ne=>{var P;return(P=ne.lsp)===null||P===void 0?
void 0:P.DocumentLinkProvider}),v=zZ(l.map(ne=>{var P,M;return(M=(P=ne.lsp)===null||P===void 0?void 0:P.SignatureHelp)===null||M===void 0?void 0:M.signatureHelpOptions})),g=this.hasService(ne=>{var P;return(P=ne.lsp)===null||P===void 0?void 0:P.TypeProvider}),h=this.hasService(ne=>{var P;return(P=ne.lsp)===null||P===void 0?void 0:P.ImplementationProvider}),y=this.hasService(ne=>{var P;return(P=ne.lsp)===null||P===void 0?void 0:P.CompletionProvider}),b=EZ(l.map(ne=>{var P,M;return(M=(P=ne.lsp)===
null||P===void 0?void 0:P.CompletionProvider)===null||M===void 0?void 0:M.completionOptions})),R=this.hasService(ne=>{var P;return(P=ne.lsp)===null||P===void 0?void 0:P.ReferencesProvider}),T=this.hasService(ne=>{var P;return(P=ne.lsp)===null||P===void 0?void 0:P.DocumentSymbolProvider}),N=this.hasService(ne=>{var P;return(P=ne.lsp)===null||P===void 0?void 0:P.DefinitionProvider}),q=this.hasService(ne=>{var P;return(P=ne.lsp)===null||P===void 0?void 0:P.DocumentHighlightProvider}),B=this.hasService(
ne=>{var P;return(P=ne.lsp)===null||P===void 0?void 0:P.FoldingRangeProvider}),ie=this.hasService(ne=>{var P;return(P=ne.lsp)===null||P===void 0?void 0:P.HoverProvider}),L=this.hasService(ne=>{var P;return(P=ne.lsp)===null||P===void 0?void 0:P.RenameProvider}),E=this.hasService(ne=>{var P;return(P=ne.lsp)===null||P===void 0?void 0:P.CallHierarchyProvider}),$=this.hasService(ne=>{var P;return(P=ne.lsp)===null||P===void 0?void 0:P.TypeHierarchyProvider}),z=this.hasService(ne=>{var P;return(P=ne.lsp)===
null||P===void 0?void 0:P.CodeLensProvider}),j=this.hasService(ne=>{var P;return(P=ne.lsp)===null||P===void 0?void 0:P.DeclarationProvider}),U=this.hasService(ne=>{var P;return(P=ne.lsp)===null||P===void 0?void 0:P.InlayHintProvider}),W=(s=this.services.lsp)===null||s===void 0?void 0:s.WorkspaceSymbolProvider;return{capabilities:{workspace:{workspaceFolders:{supported:!0},fileOperations:o},executeCommandProvider:m&&{commands:m},textDocumentSync:{change:Ji.TextDocumentSyncKind.Incremental,openClose:!0,
save:!!a.didSaveDocument,willSave:!!a.willSaveDocument,willSaveWaitUntil:!!a.willSaveDocumentWaitUntil},completionProvider:y?b:void 0,referencesProvider:R,documentSymbolProvider:T,definitionProvider:N,typeDefinitionProvider:g,documentHighlightProvider:q,codeActionProvider:d,documentFormattingProvider:c,documentRangeFormattingProvider:c,documentOnTypeFormattingProvider:u,foldingRangeProvider:B,hoverProvider:ie,renameProvider:L?{prepareProvider:!0}:void 0,semanticTokensProvider:f?p:void 0,signatureHelpProvider:v,
implementationProvider:h,callHierarchyProvider:E?{}:void 0,typeHierarchyProvider:$?{}:void 0,documentLinkProvider:w?{resolveProvider:!1}:void 0,codeLensProvider:z?{resolveProvider:!1}:void 0,declarationProvider:j,inlayHintProvider:U?{resolveProvider:!1}:void 0,workspaceSymbolProvider:W?{resolveProvider:!!W.resolveSymbol}:void 0}}}initialized(e){this.fireInitializedOnDefaultServices(e),this.onInitializedEmitter.fire(e),this.onInitializedEmitter.dispose()}fireInitializeOnDefaultServices(e){this.services.
workspace.ConfigurationProvider.initialize(e),this.services.workspace.WorkspaceManager.initialize(e)}fireInitializedOnDefaultServices(e){const n=this.services.lsp.Connection,r=n?Object.assign(Object.assign({},e),{register:i=>n.client.register(Ji.DidChangeConfigurationNotification.type,i),fetchConfiguration:i=>n.workspace.getConfiguration(i)}):e;this.services.workspace.ConfigurationProvider.initialized(r).catch(i=>console.error("Error in ConfigurationProvider initialization:",i)),this.services.workspace.
WorkspaceManager.initialized(e).catch(i=>console.error("Error in WorkspaceManager initialization:",i))}}class HZ{getSymbolKind(e){return Pe.SymbolKind.Field}getCompletionItemKind(e){return Pe.CompletionItemKind.Reference}}class VZ{constructor(e){this.nameProvider=e.references.NameProvider,this.references=e.references.References,this.grammarConfig=e.parser.GrammarConfig}findReferences(e,n,r){const i=e.parseResult.value.$cstNode;if(!i)return[];const s=Ga(i,e.textDocument.offsetAt(n.position),this.
grammarConfig.nameRegexp);return s?this.getReferences(s,n,e):[]}getReferences(e,n,r){const i=[],s=this.references.findDeclaration(e);if(s){const a={includeDeclaration:n.context.includeDeclaration};this.references.findReferences(s,a).forEach(o=>{i.push(Pe.Location.create(o.sourceUri.toString(),o.segment.range))})}return i}}class BZ{constructor(e){this.references=e.references.References,this.nameProvider=e.references.NameProvider,this.grammarConfig=e.parser.GrammarConfig}async rename(e,n,r){const i={},
s=e.parseResult.value.$cstNode;if(!s)return;const a=e.textDocument.offsetAt(n.position),o=Ga(s,a,this.grammarConfig.nameRegexp);if(!o)return;const l=this.references.findDeclaration(o);if(!l)return;const c={onlyLocal:!1,includeDeclaration:!0};return this.references.findReferences(l,c).forEach(d=>{const f=Rr.replace(d.segment.range,n.newName),p=d.sourceUri.toString();i[p]?i[p].push(f):i[p]=[f]}),{changes:i}}prepareRename(e,n,r){return this.renameNodeRange(e,n.position)}renameNodeRange(e,n){const r=e.
parseResult.value.$cstNode,i=e.textDocument.offsetAt(n);if(r&&i){const s=Ga(r,i,this.grammarConfig.nameRegexp);if(!s)return;if(this.references.findDeclaration(s)||this.isNameNode(s))return s.range}}isNameNode(e){return e?.astNode&&zm(e.astNode)&&e===this.nameProvider.getNameNode(e.astNode)}}class HI{constructor(e){this.indexManager=e.workspace.IndexManager,this.nodeKindProvider=e.lsp.NodeKindProvider,this.fuzzyMatcher=e.lsp.FuzzyMatcher}async getSymbols(e,n=Mt.CancellationToken.None){const r=[],
i=e.query.toLowerCase();for(const s of this.indexManager.allElements())if(await mn(n),this.fuzzyMatcher.match(i,s.name)){const a=this.getWorkspaceSymbol(s);a&&r.push(a)}return r}getWorkspaceSymbol(e){const n=e.nameSegment;if(n)return{kind:this.nodeKindProvider.getSymbolKind(e),name:e.name,location:{range:n.range,uri:e.documentUri.toString()}}}}class VI{constructor(e){this._configuration=e,this._syncedDocuments=new Map,this._onDidChangeContent=new Pe.Emitter,this._onDidOpen=new Pe.Emitter,this._onDidClose=
new Pe.Emitter,this._onDidSave=new Pe.Emitter,this._onWillSave=new Pe.Emitter}get onDidOpen(){return this._onDidOpen.event}get onDidChangeContent(){return this._onDidChangeContent.event}get onWillSave(){return this._onWillSave.event}onWillSaveWaitUntil(e){this._willSaveWaitUntil=e}get onDidSave(){return this._onDidSave.event}get onDidClose(){return this._onDidClose.event}get(e){return this._syncedDocuments.get(tt.normalize(e))}set(e){const n=tt.normalize(e.uri);let r=!0;this._syncedDocuments.has(
n)&&(r=!1),this._syncedDocuments.set(n,e);const i=Object.freeze({document:e});return this._onDidOpen.fire(i),this._onDidChangeContent.fire(i),r}delete(e){const n=tt.normalize(typeof e=="object"&&"uri"in e?e.uri:e),r=this._syncedDocuments.get(n);r!==void 0&&(this._syncedDocuments.delete(n),this._onDidClose.fire(Object.freeze({document:r})))}all(){return Array.from(this._syncedDocuments.values())}keys(){return Array.from(this._syncedDocuments.keys())}listen(e){e.__textDocumentSync=Pe.TextDocumentSyncKind.
Incremental;const n=[];return n.push(e.onDidOpenTextDocument(r=>{const i=r.textDocument,s=tt.normalize(i.uri),a=this._configuration.create(s,i.languageId,i.version,i.text);this._syncedDocuments.set(s,a);const o=Object.freeze({document:a});this._onDidOpen.fire(o),this._onDidChangeContent.fire(o)})),n.push(e.onDidChangeTextDocument(r=>{const i=r.textDocument,s=r.contentChanges;if(s.length===0)return;const{version:a}=i;if(a==null)throw new Error(`Received document change event for ${i.uri} without \
valid version identifier`);const o=tt.normalize(i.uri);let l=this._syncedDocuments.get(o);l!==void 0&&(l=this._configuration.update(l,s,a),this._syncedDocuments.set(o,l),this._onDidChangeContent.fire(Object.freeze({document:l})))})),n.push(e.onDidCloseTextDocument(r=>{const i=tt.normalize(r.textDocument.uri),s=this._syncedDocuments.get(i);s!==void 0&&(this._syncedDocuments.delete(i),this._onDidClose.fire(Object.freeze({document:s})))})),n.push(e.onWillSaveTextDocument(r=>{const i=this._syncedDocuments.
get(tt.normalize(r.textDocument.uri));i!==void 0&&this._onWillSave.fire(Object.freeze({document:i,reason:r.reason}))})),n.push(e.onWillSaveTextDocumentWaitUntil((r,i)=>{const s=this._syncedDocuments.get(tt.normalize(r.textDocument.uri));return s!==void 0&&this._willSaveWaitUntil?this._willSaveWaitUntil(Object.freeze({document:s,reason:r.reason}),i):[]})),n.push(e.onDidSaveTextDocument(r=>{const i=this._syncedDocuments.get(tt.normalize(r.textDocument.uri));i!==void 0&&this._onDidSave.fire(Object.
freeze({document:i}))})),Pe.Disposable.create(()=>{n.forEach(r=>r.dispose())})}}class WZ{constructor(e){this.notebookDocuments=new Map,this.notebookCellMap=new Map,this._onDidOpen=new Pe.Emitter,this._onDidSave=new Pe.Emitter,this._onDidChange=new Pe.Emitter,this._onDidClose=new Pe.Emitter,"listen"in e?this._cellTextDocuments=e:this._cellTextDocuments=new VI(e)}get cellTextDocuments(){return this._cellTextDocuments}getCellTextDocument(e){return this._cellTextDocuments.get(e.document)}getNotebookDocument(e){
return this.notebookDocuments.get(tt.normalize(e))}getNotebookCell(e){const n=this.notebookCellMap.get(tt.normalize(e));return n&&n[0]}findNotebookDocumentForCell(e){const n=typeof e=="string"||"scheme"in e?e:e.document,r=this.notebookCellMap.get(tt.normalize(n));return r&&r[1]}get onDidOpen(){return this._onDidOpen.event}get onDidSave(){return this._onDidSave.event}get onDidChange(){return this._onDidChange.event}get onDidClose(){return this._onDidClose.event}listen(e){const n=new jc,r=[];return r.
push(this.cellTextDocuments.listen(n)),r.push(e.notebooks.synchronization.onDidOpenNotebookDocument(i=>{const s=tt.normalize(i.notebookDocument.uri);this.notebookDocuments.set(s,i.notebookDocument);for(const a of i.cellTextDocuments)n.openTextDocument({textDocument:a});this.updateCellMap(i.notebookDocument),this._onDidOpen.fire(i.notebookDocument)})),r.push(e.notebooks.synchronization.onDidChangeNotebookDocument(i=>{const s=tt.normalize(i.notebookDocument.uri),a=this.notebookDocuments.get(s);if(a===
void 0)return;a.version=i.notebookDocument.version;const o=a.metadata;let l=!1;const c=i.change;c.metadata!==void 0&&(l=!0,a.metadata=c.metadata);const u=[],d=[],f=[],p=[];if(c.cells!==void 0){const h=c.cells;if(h.structure!==void 0){const y=h.structure.array;if(a.cells.splice(y.start,y.deleteCount,...y.cells!==void 0?y.cells:[]),h.structure.didOpen!==void 0)for(const b of h.structure.didOpen)n.openTextDocument({textDocument:b}),u.push(b.uri);if(h.structure.didClose)for(const b of h.structure.didClose)
n.closeTextDocument({textDocument:b}),d.push(b.uri)}if(h.data!==void 0){const y=new Map(h.data.map(b=>[b.document,b]));for(let b=0;b<=a.cells.length;b++){const R=y.get(a.cells[b].document);if(R!==void 0){const T=a.cells.splice(b,1,R);if(f.push({old:T[0],new:R}),y.delete(R.document),y.size===0)break}}}if(h.textContent!==void 0)for(const y of h.textContent)n.changeTextDocument({textDocument:y.document,contentChanges:y.changes}),p.push(y.document.uri)}this.updateCellMap(a);const m={notebookDocument:a};
l&&(m.metadata={old:o,new:a.metadata});const w=[];for(const h of u)w.push(this.getNotebookCell(h));const v=[];for(const h of d)v.push(this.getNotebookCell(h));const g=[];for(const h of p)g.push(this.getNotebookCell(h));(w.length>0||v.length>0||f.length>0||g.length>0)&&(m.cells={added:w,removed:v,changed:{data:f,textContent:g}}),(m.metadata!==void 0||m.cells!==void 0)&&this._onDidChange.fire(m)})),r.push(e.notebooks.synchronization.onDidSaveNotebookDocument(i=>{const s=this.getNotebookDocument(i.
notebookDocument.uri);s!==void 0&&this._onDidSave.fire(s)})),r.push(e.notebooks.synchronization.onDidCloseNotebookDocument(i=>{const s=tt.normalize(i.notebookDocument.uri),a=this.notebookDocuments.get(s);if(a!==void 0){this._onDidClose.fire(a);for(const o of i.cellTextDocuments)n.closeTextDocument({textDocument:o});this.notebookDocuments.delete(s);for(const o of a.cells)this.notebookCellMap.delete(o.document)}})),Pe.Disposable.create(()=>{r.forEach(i=>i.dispose())})}updateCellMap(e){for(const n of e.
cells)this.notebookCellMap.set(n.document,[n,e])}}class jc{onDidOpenTextDocument(e){return this.openHandler=e,Pe.Disposable.create(()=>{this.openHandler=void 0})}openTextDocument(e){this.openHandler&&this.openHandler(e)}onDidChangeTextDocument(e){return this.changeHandler=e,Pe.Disposable.create(()=>{this.changeHandler=e})}changeTextDocument(e){this.changeHandler&&this.changeHandler(e)}onDidCloseTextDocument(e){return this.closeHandler=e,Pe.Disposable.create(()=>{this.closeHandler=void 0})}closeTextDocument(e){
this.closeHandler&&this.closeHandler(e)}onWillSaveTextDocument(){return jc.NULL_DISPOSE}onWillSaveTextDocumentWaitUntil(){return jc.NULL_DISPOSE}onDidSaveTextDocument(){return jc.NULL_DISPOSE}}jc.NULL_DISPOSE=Object.freeze({dispose:()=>{}});function GZ(t){return Hm.merge(lx(t),KZ(t))}function KZ(t){return{lsp:{CompletionProvider:e=>new LI(e),DocumentSymbolProvider:e=>new CZ(e),HoverProvider:e=>new OZ(e),FoldingRangeProvider:e=>new AZ(e),ReferencesProvider:e=>new VZ(e),DefinitionProvider:e=>new PZ(
e),DocumentHighlightProvider:e=>new MI(e),RenameProvider:e=>new BZ(e)},shared:()=>t.shared}}function ZZ(t){return Hm.merge(cx(t),JZ(t))}function JZ(t){return{lsp:{Connection:()=>t.connection,LanguageServer:e=>new UZ(e),DocumentUpdateHandler:e=>new xZ(e),WorkspaceSymbolProvider:e=>new HI(e),NodeKindProvider:()=>new HZ,FuzzyMatcher:()=>new IZ},workspace:{TextDocuments:()=>new VI(Fm),NotebookDocuments:e=>new WZ(e.workspace.TextDocuments)}}}class YZ{constructor(){this.collector=()=>{}}getNodeFormatter(e){
return new XZ(e,this.collector)}formatDocument(e,n){const r=e.parseResult;return r.lexerErrors.length===0&&r.parserErrors.length===0?this.doDocumentFormat(e,n.options):[]}isFormatRangeErrorFree(e,n){const r=e.parseResult;return r.lexerErrors.length||r.parserErrors.length?Math.min(...r.lexerErrors.map(s=>{var a;return(a=s.line)!==null&&a!==void 0?a:Number.MAX_VALUE}),...r.parserErrors.map(s=>{var a;return(a=s.token.startLine)!==null&&a!==void 0?a:Number.MAX_VALUE}))>n.end.line:!0}formatDocumentRange(e,n){
return this.isFormatRangeErrorFree(e,n.range)?this.doDocumentFormat(e,n.options,n.range):[]}formatDocumentOnType(e,n){const r={start:{character:0,line:n.position.line},end:n.position};return this.isFormatRangeErrorFree(e,r)?this.doDocumentFormat(e,n.options,r):[]}get formatOnTypeOptions(){}doDocumentFormat(e,n,r){const i=new Map,s=(o,l,c)=>{var u,d;const f=this.nodeModeToKey(o,l),p=i.get(f),m=(u=c.options.priority)!==null&&u!==void 0?u:0,w=(d=p?.options.priority)!==null&&d!==void 0?d:0;(!p||w<=m)&&
i.set(f,c)};this.collector=s,this.iterateAstFormatting(e,r);const a=this.iterateCstFormatting(e,i,n,r);return this.avoidOverlappingEdits(e.textDocument,a)}avoidOverlappingEdits(e,n){const r=[];for(const i of n){let s=r[r.length-1];for(;s;){const a=e.offsetAt(i.range.start),o=e.offsetAt(s.range.end);if(a<o)r.pop(),s=r[r.length-1];else break}r.push(i)}return r.filter(i=>this.isNecessary(i,e))}iterateAstFormatting(e,n){const r=e.parseResult.value;this.format(r);const i=hi(r).iterator();let s;do if(s=
i.next(),!s.done){const a=s.value;this.insideRange(a.$cstNode.range,n)?this.format(a):i.prune()}while(!s.done)}nodeModeToKey(e,n){return`${e.offset}:${e.end}:${n}`}insideRange(e,n){return!n||e.start.line<=n.start.line&&e.end.line>=n.end.line||e.start.line>=n.start.line&&e.end.line<=n.end.line||e.start.line<=n.end.line&&e.end.line>=n.end.line}isNecessary(e,n){return e.newText!==n.getText(e.range).replace(/\r/g,"")}iterateCstFormatting(e,n,r,i){const s={indentation:0,options:r,document:e.textDocument},
a=[],l=this.iterateCstTree(e,s).iterator();let c,u;do if(u=l.next(),!u.done){const d=u.value,f=Wa(d),p=this.nodeModeToKey(d,"prepend"),m=n.get(p);if(n.delete(p),m){const g=this.createTextEdit(c,d,m,s);for(const h of g)h&&this.insideRange(h.range,i)&&a.push(h)}const w=this.nodeModeToKey(d,"append"),v=n.get(w);if(n.delete(w),v){const g=HF(d);if(g){const h=this.createTextEdit(d,g,v,s);for(const y of h)y&&this.insideRange(y.range,i)&&a.push(y)}}if(!m&&d.hidden){const g=this.createHiddenTextEdits(c,d,
void 0,s);for(const h of g)h&&this.insideRange(h.range,i)&&a.push(h)}f&&(c=d)}while(!u.done);return a}createHiddenTextEdits(e,n,r,i){var s;const a=n.range.start.line;if(e&&e.range.end.line===a)return[];const o=[],l={start:{character:0,line:a},end:n.range.start},c=i.document.getText(l),u=this.findFittingMove(l,(s=r?.moves)!==null&&s!==void 0?s:[],i),d=this.getExistingIndentationCharacterCount(c,i),p=this.getIndentationCharacterCount(i,u)-d;if(p===0)return[];let m="";p>0&&(m=(i.options.insertSpaces?
" ":"	").repeat(p));const w=n.text.split(`
`);w[0]=c+w[0];for(let v=0;v<w.length;v++){const g=a+v,h={character:0,line:g};if(p>0)o.push({newText:m,range:{start:h,end:h}});else{const y=w[v];let b=0;for(;b<y.length;b++){const R=y.charAt(b);if(R!==" "&&R!=="	")break}o.push({newText:"",range:{start:h,end:{line:g,character:Math.min(b,Math.abs(p))}}})}}return o}getExistingIndentationCharacterCount(e,n){const r=" ".repeat(n.options.tabSize);return(n.options.insertSpaces?e.replaceAll("	",r):e.replaceAll(r,"	")).length}getIndentationCharacterCount(e,n){
let r=e.indentation;return n&&n.tabs&&(r+=n.tabs),(e.options.insertSpaces?e.options.tabSize:1)*r}createTextEdit(e,n,r,i){var s;if(n.hidden)return this.createHiddenTextEdits(e,n,r,i);if(e&&(e.range.end.line>n.range.start.line||e.range.end.line===n.range.start.line&&e.range.end.character>n.range.start.character))return[];const a={start:(s=e?.range.end)!==null&&s!==void 0?s:{character:0,line:0},end:n.range.start},o=this.findFittingMove(a,r.moves,i);if(!o)return[];const l=o.characters,c=o.lines,u=o.
tabs,d=i.indentation;i.indentation+=u??0;const f=[];return l!==void 0?e?.hidden||f.push(this.createSpaceTextEdit(a,l,r.options)):c!==void 0?f.push(this.createLineTextEdit(a,c,i,r.options)):u!==void 0&&f.push(this.createTabTextEdit(a,!!e,i)),Wa(n)&&(i.indentation=d),f}createSpaceTextEdit(e,n,r){if(e.start.line===e.end.line){const s=e.end.character-e.start.character;n=this.fitIntoOptions(n,s,r)}return{newText:" ".repeat(n),range:e}}createLineTextEdit(e,n,r,i){const s=e.end.line-e.start.line;n=this.
fitIntoOptions(n,s,i);const o=(r.options.insertSpaces?" ".repeat(r.options.tabSize):"	").repeat(r.indentation);return{newText:`${`
`.repeat(n)}${o}`,range:e}}createTabTextEdit(e,n,r){const s=(r.options.insertSpaces?" ".repeat(r.options.tabSize):"	").repeat(r.indentation),a=n?1:0,o=Math.max(e.end.line-e.start.line,a);return{newText:`${`
`.repeat(o)}${s}`,range:e}}fitIntoOptions(e,n,r){return r.allowMore?e=Math.max(n,e):r.allowLess&&(e=Math.min(n,e)),e}findFittingMove(e,n,r){if(n.length===0)return;if(n.length===1)return n[0];const i=e.end.line-e.start.line;for(const s of n){if(s.lines!==void 0&&i<=s.lines)return s;if(s.lines===void 0&&i===0)return s}return n[n.length-1]}iterateCstTree(e,n){const i=e.parseResult.value.$cstNode;return i?new vl(i,s=>this.iterateCst(s,n)):Bc}iterateCst(e,n){if(!na(e))return Bc;const r=n.indentation;
return new On(()=>({index:0}),i=>i.index<e.content.length?{done:!1,value:e.content[i.index++]}:(n.indentation=r,yr))}}class XZ{constructor(e,n){this.astNode=e,this.collector=n}node(e){return new Di(e.$cstNode?[e.$cstNode]:[],this.collector)}nodes(...e){const n=[];for(const r of e)r.$cstNode&&n.push(r.$cstNode);return new Di(n,this.collector)}property(e,n){const r=Yn(this.astNode.$cstNode,e,n);return new Di(r?[r]:[],this.collector)}properties(...e){const n=[];for(const r of e){const i=_l(this.astNode.
$cstNode,r);n.push(...i)}return new Di(n,this.collector)}keyword(e,n){const r=Eu(this.astNode.$cstNode,e,n);return new Di(r?[r]:[],this.collector)}keywords(...e){const n=[];for(const r of e){const i=tb(this.astNode.$cstNode,r);n.push(...i)}return new Di(n,this.collector)}cst(e){return new Di([...e],this.collector)}interior(e,n){const r=e.nodes,i=n.nodes;if(r.length!==1||i.length!==1)return new Di([],this.collector);let s=r[0],a=i[0];if(s.offset>a.offset){const o=s;s=a,a=o}return new Di(VF(s,a),this.
collector)}}class Di{constructor(e,n){this.nodes=e,this.collector=n}prepend(e){for(const n of this.nodes)this.collector(n,"prepend",e);return this}append(e){for(const n of this.nodes)this.collector(n,"append",e);return this}surround(e){for(const n of this.nodes)this.collector(n,"prepend",e),this.collector(n,"append",e);return this}slice(e,n){return new Di(this.nodes.slice(e,n),this.collector)}}var si;(function(t){function e(...u){return{options:{},moves:u.flatMap(d=>d.moves).sort(c)}}t.fit=e;function n(u){
return i(0,u)}t.noSpace=n;function r(u){return i(1,u)}t.oneSpace=r;function i(u,d){return{options:d??{},moves:[{characters:u}]}}t.spaces=i;function s(u){return a(1,u)}t.newLine=s;function a(u,d){return{options:d??{},moves:[{lines:u}]}}t.newLines=a;function o(u){return{options:u??{},moves:[{tabs:1,lines:1}]}}t.indent=o;function l(u){return{options:u??{},moves:[{tabs:0}]}}t.noIndent=l;function c(u,d){var f,p,m,w,v,g;const h=(f=u.lines)!==null&&f!==void 0?f:0,y=(p=d.lines)!==null&&p!==void 0?p:0,b=(m=
u.tabs)!==null&&m!==void 0?m:0,R=(w=d.tabs)!==null&&w!==void 0?w:0,T=(v=u.characters)!==null&&v!==void 0?v:0,N=(g=d.characters)!==null&&g!==void 0?g:0;return h<y?-1:h>y?1:b<R?-1:b>R?1:T<N?-1:T>N?1:0}})(si||(si={}));var u_,BI;function QZ(){return BI||(BI=1,u_=II()),u_}QZ();const WI={fileSystemWatcher:()=>new e8};class e8{watch(){}dispose(){return Promise.resolve()}}class t8{scanProjectFiles(){return Promise.resolve([])}scanDirectory(){return Promise.resolve([])}readFile(){throw new Error("No file\
 system is available.")}readDirectory(){return Promise.resolve([])}loadProjectConfig(){throw new Error("No file system is available.")}writeFile(){throw new Error("No file system is available.")}deleteFile(){throw new Error("No file system is available.")}}const GI={fileSystemProvider:()=>new t8,...WI},d_=Mr.getChild("config");async function n8(t){if(d_.debug`Loading config file: ${t.fsPath}`,Qq(t.fsPath))try{const e=await Kq.readFile(t.fsPath,"utf-8");return s0(e)}catch(e){throw d_.error(`Faile\
d to load json config file: ${t.fsPath}`,{err:e}),e}Ke(eF(t.fsPath),`Invalid config file: ${t.fsPath}`);try{const e=G$(t.fsPath),{mod:n}=await Gq({filepath:t.fsPath,cwd:e,esbuildOptions:{resolveExtensions:[".mjs",".js",".ts",".mts"],plugins:[{name:"likec4-config",setup(r){r.onResolve({filter:/^@?likec4\/config$/},i=>({path:i.path,namespace:"likec4-config"})),r.onLoad({filter:/.*/,namespace:"likec4-config"},i=>({contents:`
// Mock implementation to allow loading config files without bundling @likec4/config
function mock(x) { return x }
export {
  mock as defineConfig,
  mock as defineGenerators,
  mock as defineStyle,
  mock as defineTheme,
  mock as defineThemeColor,
}`,loader:"js"}))}}]}});return tF(n?.default??n)}catch(e){throw d_.error(`Failed to load config file: ${t.fsPath}`,{err:e}),e}}class r8{constructor(){this.encoding="utf-8"}readFile(e){return B$.promises.readFile(e.fsPath,this.encoding)}async readDirectory(e){return(await B$.promises.readdir(e.fsPath,{withFileTypes:!0})).map(r=>({dirent:r,isFile:r.isFile(),isDirectory:r.isDirectory(),uri:tt.joinPath(e,r.name)}))}}const rg="AnyProperty";function i8(t){return re.isInstance(t,rg)}const f_="ColorLite\
ral";function s8(t){return re.isInstance(t,f_)}const ig="DeploymentElement";function sg(t){return re.isInstance(t,ig)}const p_="DeploymentNodeOrElementKind",ag="DeploymentViewRule";function a8(t){return re.isInstance(t,ag)}const og="DynamicViewProperty",Cd="DynamicViewRule";function h_(t){return re.isInstance(t,Cd)}const m_="DynamicViewStep";function lg(t){return re.isInstance(t,m_)}const ma="ElementProperty";function o8(t){return re.isInstance(t,ma)}const g_="ExpressionV2";function l8(t){return re.
isInstance(t,g_)}const y_="ExtendElementProperty",v_="ExtendRelationProperty",cg="FqnExpr";function KI(t){return re.isInstance(t,cg)}const ug="FqnExprOrWhere";function ZI(t){return re.isInstance(t,ug)}const dg="FqnExprOrWith";function JI(t){return re.isInstance(t,dg)}const w_="FqnReferenceable",Eo="LikeC4View";function b_(t){return re.isInstance(t,Eo)}const fg="MetadataProperty";function Yi(t){return re.isInstance(t,fg)}const YI="MetadataValue",k_="ModelReferenceable",Hl="Referenceable",pg="Rela\
tionExpr";function hg(t){return re.isInstance(t,pg)}const mg="RelationExprOrWhere";function c8(t){return re.isInstance(t,mg)}const gg="RelationExprOrWith";function u8(t){return re.isInstance(t,gg)}const Vl="RelationProperty",yg="RelationshipStyleProperty";function XI(t){return re.isInstance(t,yg)}const __="SizeProperty";function d8(t){return re.isInstance(t,__)}const Po="StringProperty";function QI(t){return re.isInstance(t,Po)}const Bl="StyleProperty";function R_(t){return re.isInstance(t,Bl)}const xd="\
ViewProperty";function f8(t){return re.isInstance(t,xd)}const Ad="ViewRule";function p8(t){return re.isInstance(t,Ad)}const vg="ViewRuleStyleOrGlobalRef";function S_(t){return re.isInstance(t,vg)}const Id="WhereElement";function eN(t){return re.isInstance(t,Id)}const Nd="WhereElementExpression";function h8(t){return re.isInstance(t,Nd)}const tN="WhereExpression",wg="WhereKindEqual";function m8(t){return re.isInstance(t,wg)}const Dd="WhereRelation";function nN(t){return re.isInstance(t,Dd)}const Od="\
WhereRelationExpression";function g8(t){return re.isInstance(t,Od)}const bg="WhereTagEqual";function y8(t){return re.isInstance(t,bg)}const kg="AbstractDynamicStep",Ld="ArrowProperty";function Md(t){return re.isInstance(t,Ld)}const jd="BorderProperty";function _g(t){return re.isInstance(t,jd)}const qd="ColorProperty";function Co(t){return re.isInstance(t,qd)}const xo="CustomColor",Rg="CustomElementProperties";function v8(t){return re.isInstance(t,Rg)}const Sg="CustomRelationProperties";function w8(t){
return re.isInstance(t,Sg)}const Ls="DeployedInstance";function $r(t){return re.isInstance(t,Ls)}const $g="DeployedInstanceBody";function rN(t){return re.isInstance(t,$g)}const Ri="DeploymentNode";function ur(t){return re.isInstance(t,Ri)}const Tg="DeploymentNodeBody";function iN(t){return re.isInstance(t,Tg)}const Ms="DeploymentNodeKind";function b8(t){return re.isInstance(t,Ms)}const Eg="DeploymentRelation";function Si(t){return re.isInstance(t,Eg)}const Pg="DeploymentRelationBody";function k8(t){
return re.isInstance(t,Pg)}const Fd="DeploymentView";function sN(t){return re.isInstance(t,Fd)}const Cg="DeploymentViewBody";function $_(t){return re.isInstance(t,Cg)}const zd="DeploymentViewRulePredicate";function Wl(t){return re.isInstance(t,zd)}const Ud="DeploymentViewRuleStyle";function Hd(t){return re.isInstance(t,Ud)}const Vd="DirectedRelationExpr";function _8(t){return re.isInstance(t,Vd)}const Gl="DynamicView";function T_(t){return re.isInstance(t,Gl)}const xg="DynamicViewBody";function Ag(t){
return re.isInstance(t,xg)}const Bd="DynamicViewDisplayVariantProperty";function E_(t){return re.isInstance(t,Bd)}const Wd="DynamicViewGlobalPredicateRef";function aN(t){return re.isInstance(t,Wd)}const Gd="DynamicViewIncludePredicate";function oN(t){return re.isInstance(t,Gd)}const Ig="DynamicViewParallelSteps";function P_(t){return re.isInstance(t,Ig)}const C_="DynamicViewRef",Fr="Element";function Vn(t){return re.isInstance(t,Fr)}const Ng="ElementBody";function Dg(t){return re.isInstance(t,Ng)}
const js="ElementKind";function lN(t){return re.isInstance(t,js)}const Kd="ElementKindExpression";function cN(t){return re.isInstance(t,Kd)}const Og="ElementRef";function x_(t){return re.isInstance(t,Og)}const Zd="ElementStringProperty";function Jd(t){return re.isInstance(t,Zd)}const Yd="ElementStyleProperty";function Xd(t){return re.isInstance(t,Yd)}const Qd="ElementTagExpression";function uN(t){return re.isInstance(t,Qd)}const Kl="ElementView";function Lg(t){return re.isInstance(t,Kl)}const Mg="\
ElementViewBody";function A_(t){return re.isInstance(t,Mg)}const I_="ElementViewRef",jg="Expressions";function dN(t){return re.isInstance(t,jg)}const ef="ExtendDeployment";function ga(t){return re.isInstance(t,ef)}const qg="ExtendDeploymentBody";function N_(t){return re.isInstance(t,qg)}const Ao="ExtendElement";function Io(t){return re.isInstance(t,Ao)}const Fg="ExtendElementBody";function zg(t){return re.isInstance(t,Fg)}const Ug="ExtendRelation";function Zl(t){return re.isInstance(t,Ug)}const D_="\
ExtendRelationBody",Hg="FqnExpressions";function R8(t){return re.isInstance(t,Hg)}const tf="FqnExprWhere";function O_(t){return re.isInstance(t,tf)}const nf="FqnExprWith";function Vg(t){return re.isInstance(t,nf)}const Bg="FqnRef";function fN(t){return re.isInstance(t,Bg)}const rf="FqnRefExpr";function Wg(t){return re.isInstance(t,rf)}const Jl="GlobalDynamicPredicateGroup";function sf(t){return re.isInstance(t,Jl)}const Yl="GlobalPredicateGroup";function af(t){return re.isInstance(t,Yl)}const Xl="\
Globals";function L_(t){return re.isInstance(t,Xl)}const Gg="GlobalStyle";function Ql(t){return re.isInstance(t,Gg)}const Kg="GlobalStyleGroup";function No(t){return re.isInstance(t,Kg)}const of="GlobalStyleId",lf="HexColor";function S8(t){return re.isInstance(t,lf)}const cf="IconProperty";function Do(t){return re.isInstance(t,cf)}const ya="Imported";function Xi(t){return re.isInstance(t,ya)}const Zg="ImportsFromPoject";function ec(t){return re.isInstance(t,Zg)}const uf="IncomingRelationExpr";function $8(t){
return re.isInstance(t,uf)}const df="InOutRelationExpr";function pN(t){return re.isInstance(t,df)}const qs="LibIcon";function T8(t){return re.isInstance(t,qs)}const Jg="LikeC4Grammar";function hN(t){return re.isInstance(t,Jg)}const Yg="LikeC4Lib";function E8(t){return re.isInstance(t,Yg)}const ff="LineProperty";function pf(t){return re.isInstance(t,ff)}const hf="LinkProperty";function mf(t){return re.isInstance(t,hf)}const gf="MarkdownOrString";function Xg(t){return re.isInstance(t,gf)}const yf="\
MetadataArray";function P8(t){return re.isInstance(t,yf)}const vf="MetadataAttribute";function C8(t){return re.isInstance(t,vf)}const wf="MetadataBody";function x8(t){return re.isInstance(t,wf)}const tc="Model";function mN(t){return re.isInstance(t,tc)}const nc="ModelDeployments";function gN(t){return re.isInstance(t,nc)}const rc="ModelViews";function bf(t){return re.isInstance(t,rc)}const kf="MultipleProperty";function M_(t){return re.isInstance(t,kf)}const Qg="NavigateToProperty";function ey(t){
return re.isInstance(t,Qg)}const _f="NotationProperty";function ic(t){return re.isInstance(t,_f)}const Rf="NotesProperty";function j_(t){return re.isInstance(t,Rf)}const Sf="OpacityProperty";function ty(t){return re.isInstance(t,Sf)}const $f="OutgoingRelationExpr";function yN(t){return re.isInstance(t,$f)}const Tf="PaddingSizeProperty";function q_(t){return re.isInstance(t,Tf)}const ny="Relation";function Qi(t){return re.isInstance(t,ny)}const ry="RelationBody";function A8(t){return re.isInstance(
t,ry)}const Ef="RelationExprWhere";function F_(t){return re.isInstance(t,Ef)}const Pf="RelationExprWith";function z_(t){return re.isInstance(t,Pf)}const iy="RelationKindDotRef";function I8(t){return re.isInstance(t,iy)}const Cf="RelationNavigateToProperty";function xf(t){return re.isInstance(t,Cf)}const va="RelationshipKind";function vN(t){return re.isInstance(t,va)}const Af="RelationStringProperty";function If(t){return re.isInstance(t,Af)}const Nf="RelationStyleProperty";function sy(t){return re.
isInstance(t,Nf)}const Df="RGBAColor";function N8(t){return re.isInstance(t,Df)}const Of="ShapeProperty";function ay(t){return re.isInstance(t,Of)}const Lf="ShapeSizeProperty";function U_(t){return re.isInstance(t,Lf)}const oy="SpecificationColor";function ly(t){return re.isInstance(t,oy)}const sc="SpecificationDeploymentNodeKind";function ac(t){return re.isInstance(t,sc)}const oc="SpecificationElementKind";function lc(t){return re.isInstance(t,oc)}const Mf="SpecificationElementStringProperty";function wN(t){
return re.isInstance(t,Mf)}const cc="SpecificationRelationshipKind";function uc(t){return re.isInstance(t,cc)}const jf="SpecificationRelationshipStringProperty";function bN(t){return re.isInstance(t,jf)}const dc="SpecificationRule";function kN(t){return re.isInstance(t,dc)}const fc="SpecificationTag";function qf(t){return re.isInstance(t,fc)}const cy="StrictFqnElementRef";function H_(t){return re.isInstance(t,cy)}const uy="StrictFqnRef";function _N(t){return re.isInstance(t,uy)}const wa="Tag";function Ff(t){
return re.isInstance(t,wa)}const dy="TagRef";function RN(t){return re.isInstance(t,dy)}const fy="Tags";function SN(t){return re.isInstance(t,fy)}const zf="TextSizeProperty";function V_(t){return re.isInstance(t,zf)}const B_="ViewRef",Uf="ViewRuleAutoLayout";function Hf(t){return re.isInstance(t,Uf)}const Vf="ViewRuleGlobalPredicateRef";function W_(t){return re.isInstance(t,Vf)}const Bf="ViewRuleGlobalStyle";function G_(t){return re.isInstance(t,Bf)}const Wf="ViewRuleGroup";function Gf(t){return re.
isInstance(t,Wf)}const Kf="ViewRulePredicate";function Zf(t){return re.isInstance(t,Kf)}const Jf="ViewRuleRank";function D8(t){return re.isInstance(t,Jf)}const Yf="ViewRuleStyle";function pc(t){return re.isInstance(t,Yf)}const Xf="ViewStringProperty";function py(t){return re.isInstance(t,Xf)}const Qf="WhereBinaryExpression";function O8(t){return re.isInstance(t,Qf)}const ep="WhereElementKind";function L8(t){return re.isInstance(t,ep)}const tp="WhereElementNegation";function $N(t){return re.isInstance(
t,tp)}const np="WhereElementTag";function M8(t){return re.isInstance(t,np)}const rp="WhereRelationKind";function TN(t){return re.isInstance(t,rp)}const ip="WhereRelationNegation";function EN(t){return re.isInstance(t,ip)}const sp="WhereRelationParticipantKind";function PN(t){return re.isInstance(t,sp)}const ap="WhereRelationParticipantTag";function CN(t){return re.isInstance(t,ap)}const op="WhereRelationTag";function j8(t){return re.isInstance(t,op)}const lp="WildcardExpression";function xN(t){return re.
isInstance(t,lp)}const cp="DynamicStepChain";function K_(t){return re.isInstance(t,cp)}const up="DynamicStepSingle";function dp(t){return re.isInstance(t,up)}class AN extends b0{getAllTypes(){return[kg,rg,Ld,jd,f_,qd,xo,Rg,Sg,Ls,$g,ig,Ri,Tg,Ms,p_,Eg,Pg,Fd,Cg,ag,zd,Ud,Vd,cp,up,Gl,xg,Bd,Wd,Gd,Ig,og,C_,Cd,m_,Fr,Ng,js,Kd,ma,Og,Zd,Yd,Qd,Kl,Mg,I_,g_,jg,ef,qg,Ao,Fg,y_,Ug,D_,v_,cg,ug,dg,tf,nf,Hg,Bg,rf,w_,Jl,Yl,Gg,Kg,of,Xl,lf,cf,ya,Zg,df,uf,qs,Jg,Yg,Eo,ff,hf,gf,yf,vf,wf,fg,YI,tc,nc,k_,rc,kf,Qg,_f,Rf,Sf,$f,
Tf,Df,Hl,ny,ry,pg,mg,gg,Ef,Pf,iy,Cf,Vl,Af,Nf,va,yg,Of,Lf,__,oy,sc,oc,Mf,cc,jf,dc,fc,cy,uy,Po,Bl,wa,dy,fy,zf,xd,B_,Ad,Uf,Vf,Bf,Wf,Kf,Jf,Yf,vg,Xf,Qf,Id,Nd,ep,tp,np,tN,wg,Dd,Od,rp,ip,sp,ap,op,bg,lp]}computeIsSubtype(e,n){switch(e){case Ld:case ff:return this.isSubtype(yg,n);case jd:case kf:case Sf:case Of:return this.isSubtype(Bl,n);case qd:return this.isSubtype(yg,n)||this.isSubtype(Bl,n);case Ls:case Ri:return this.isSubtype(ig,n)||this.isSubtype(Hl,n);case Ms:case js:return this.isSubtype(p_,n);case Fd:case Gl:case Kl:
return this.isSubtype(Eo,n);case zd:case Ud:return this.isSubtype(ag,n);case Vd:case uf:case df:case $f:return this.isSubtype(pg,n);case cp:case up:return this.isSubtype(kg,n)||this.isSubtype(m_,n);case Bd:return this.isSubtype(og,n);case Wd:case Gd:return this.isSubtype(Cd,n);case og:case ma:case Vl:case Po:return this.isSubtype(rg,n);case Fr:return this.isSubtype(w_,n)||this.isSubtype(k_,n)||this.isSubtype(Hl,n);case Kd:case Qd:case rf:case lp:return this.isSubtype(cg,n);case Zd:return this.isSubtype(
ma,n)||this.isSubtype(Po,n);case Yd:return this.isSubtype(ma,n);case ef:case Ao:case Hl:return this.isSubtype(w_,n);case cg:case tf:return this.isSubtype(ug,n);case ug:case nf:return this.isSubtype(dg,n);case dg:case gg:return this.isSubtype(g_,n);case lf:case Df:return this.isSubtype(f_,n);case cf:return this.isSubtype(ma,n)||this.isSubtype(Bl,n);case ya:return this.isSubtype(k_,n)||this.isSubtype(Hl,n);case hf:return this.isSubtype(ma,n)||this.isSubtype(y_,n)||this.isSubtype(v_,n)||this.isSubtype(
Vl,n)||this.isSubtype(xd,n);case gf:case yf:return this.isSubtype(YI,n);case vf:case _f:case Rf:case Mf:case jf:return this.isSubtype(Po,n);case wf:return this.isSubtype(fg,n);case fg:return this.isSubtype(ma,n)||this.isSubtype(y_,n)||this.isSubtype(v_,n)||this.isSubtype(Vl,n);case Tf:case Lf:case zf:return this.isSubtype(__,n)||this.isSubtype(Bl,n);case pg:case Ef:return this.isSubtype(mg,n);case mg:case Pf:return this.isSubtype(gg,n);case Cf:case Nf:return this.isSubtype(Vl,n);case Af:return this.
isSubtype(Vl,n)||this.isSubtype(Po,n);case xd:return this.isSubtype(rg,n)||this.isSubtype(og,n);case Uf:return this.isSubtype(ag,n)||this.isSubtype(Cd,n)||this.isSubtype(Ad,n);case Vf:case Wf:case Kf:case Jf:return this.isSubtype(Ad,n);case Bf:case Yf:return this.isSubtype(vg,n);case vg:return this.isSubtype(Cd,n)||this.isSubtype(Ad,n);case Xf:return this.isSubtype(Po,n)||this.isSubtype(xd,n);case Qf:return this.isSubtype(Nd,n)||this.isSubtype(Od,n);case Id:case tp:return this.isSubtype(Nd,n);case Nd:case Od:
return this.isSubtype(tN,n);case ep:return this.isSubtype(Id,n)||this.isSubtype(wg,n);case np:return this.isSubtype(Id,n)||this.isSubtype(bg,n);case Dd:case ip:return this.isSubtype(Od,n);case rp:case sp:return this.isSubtype(wg,n)||this.isSubtype(Dd,n);case ap:case op:return this.isSubtype(Dd,n)||this.isSubtype(bg,n);default:return!1}}getReferenceType(e){const n=`${e.container.$type}:${e.property}`;switch(n){case"AbstractDynamicStep:kind":case"DeploymentRelation:kind":case"DynamicStepChain:kind":case"\
DynamicStepSingle:kind":case"ExtendRelation:kind":case"OutgoingRelationExpr:kind":case"Relation:kind":case"RelationKindDotRef:kind":case"WhereRelationKind:value":return va;case"ColorProperty:customColor":return xo;case"DeploymentNode:kind":return Ms;case"DynamicViewGlobalPredicateRef:predicate":return Jl;case"DynamicViewRef:view":return Gl;case"Element:kind":case"ElementKindExpression:kind":return js;case"ElementViewRef:view":return Kl;case"FqnRef:value":case"StrictFqnRef:value":return Hl;case"I\
conProperty:libicon":return qs;case"Imported:imported":case"StrictFqnElementRef:el":return Fr;case"TagRef:tag":return wa;case"ViewRef:view":return Eo;case"ViewRuleGlobalPredicateRef:predicate":return Yl;case"ViewRuleGlobalStyle:style":return of;case"WhereElementKind:value":case"WhereRelationParticipantKind:value":return p_;default:throw new Error(`${n} is not a valid reference id.`)}}getTypeMetaData(e){switch(e){case kg:return{name:kg,properties:[{name:"custom"},{name:"dotKind"},{name:"kind"},{name:"\
target"},{name:"title"}]};case Ld:return{name:Ld,properties:[{name:"key"},{name:"value"}]};case jd:return{name:jd,properties:[{name:"key"},{name:"value"}]};case qd:return{name:qd,properties:[{name:"customColor"},{name:"key"},{name:"themeColor"}]};case xo:return{name:xo,properties:[{name:"name"}]};case Rg:return{name:Rg,properties:[{name:"props",defaultValue:[]}]};case Sg:return{name:Sg,properties:[{name:"props",defaultValue:[]}]};case Ls:return{name:Ls,properties:[{name:"body"},{name:"name"},{name:"\
summary"},{name:"target"},{name:"title"}]};case $g:return{name:$g,properties:[{name:"elements",defaultValue:[]},{name:"props",defaultValue:[]},{name:"tags"}]};case Ri:return{name:Ri,properties:[{name:"body"},{name:"kind"},{name:"name"},{name:"summary"},{name:"title"}]};case Tg:return{name:Tg,properties:[{name:"elements",defaultValue:[]},{name:"props",defaultValue:[]},{name:"tags"}]};case Ms:return{name:Ms,properties:[{name:"name"}]};case Eg:return{name:Eg,properties:[{name:"body"},{name:"descrip\
tion"},{name:"dotKind"},{name:"kind"},{name:"source"},{name:"tags"},{name:"target"},{name:"technology"},{name:"title"}]};case Pg:return{name:Pg,properties:[{name:"props",defaultValue:[]},{name:"tags"}]};case Fd:return{name:Fd,properties:[{name:"body"},{name:"name"}]};case Cg:return{name:Cg,properties:[{name:"props",defaultValue:[]},{name:"rules",defaultValue:[]},{name:"tags"}]};case zd:return{name:zd,properties:[{name:"expr"},{name:"isInclude",defaultValue:!1}]};case Ud:return{name:Ud,properties:[
{name:"props",defaultValue:[]},{name:"targets"}]};case Vd:return{name:Vd,properties:[{name:"source"},{name:"target"}]};case Gl:return{name:Gl,properties:[{name:"body"},{name:"name"}]};case xg:return{name:xg,properties:[{name:"props",defaultValue:[]},{name:"rules",defaultValue:[]},{name:"steps",defaultValue:[]},{name:"tags"}]};case Bd:return{name:Bd,properties:[{name:"key"},{name:"value"}]};case Wd:return{name:Wd,properties:[{name:"predicate"}]};case Gd:return{name:Gd,properties:[{name:"exprs"}]};case Ig:
return{name:Ig,properties:[{name:"steps",defaultValue:[]}]};case C_:return{name:C_,properties:[{name:"view"}]};case Fr:return{name:Fr,properties:[{name:"body"},{name:"kind"},{name:"name"},{name:"props",defaultValue:[]}]};case Ng:return{name:Ng,properties:[{name:"elements",defaultValue:[]},{name:"props",defaultValue:[]},{name:"tags"}]};case js:return{name:js,properties:[{name:"name"}]};case Kd:return{name:Kd,properties:[{name:"isEqual",defaultValue:!1},{name:"kind"}]};case Og:return{name:Og,properties:[
{name:"modelElement"}]};case Zd:return{name:Zd,properties:[{name:"key"},{name:"value"}]};case Yd:return{name:Yd,properties:[{name:"key"},{name:"props",defaultValue:[]}]};case Qd:return{name:Qd,properties:[{name:"isEqual",defaultValue:!1},{name:"tag"}]};case Kl:return{name:Kl,properties:[{name:"body"},{name:"extends"},{name:"name"},{name:"viewOf"}]};case Mg:return{name:Mg,properties:[{name:"props",defaultValue:[]},{name:"rules",defaultValue:[]},{name:"tags"}]};case I_:return{name:I_,properties:[{
name:"view"}]};case jg:return{name:jg,properties:[{name:"prev"},{name:"value"}]};case ef:return{name:ef,properties:[{name:"body"},{name:"deploymentNode"}]};case qg:return{name:qg,properties:[{name:"elements",defaultValue:[]},{name:"props",defaultValue:[]},{name:"tags"}]};case Ao:return{name:Ao,properties:[{name:"body"},{name:"element"}]};case Fg:return{name:Fg,properties:[{name:"elements",defaultValue:[]},{name:"props",defaultValue:[]},{name:"tags"}]};case Ug:return{name:Ug,properties:[{name:"bo\
dy"},{name:"dotKind"},{name:"kind"},{name:"source"},{name:"target"},{name:"title"}]};case D_:return{name:D_,properties:[{name:"props",defaultValue:[]},{name:"tags"}]};case Hg:return{name:Hg,properties:[{name:"prev"},{name:"value"}]};case tf:return{name:tf,properties:[{name:"subject"},{name:"where"}]};case nf:return{name:nf,properties:[{name:"custom"},{name:"subject"}]};case Bg:return{name:Bg,properties:[{name:"parent"},{name:"value"}]};case rf:return{name:rf,properties:[{name:"ref"},{name:"selec\
tor"}]};case Jl:return{name:Jl,properties:[{name:"name"},{name:"predicates",defaultValue:[]}]};case Yl:return{name:Yl,properties:[{name:"name"},{name:"predicates",defaultValue:[]}]};case Xl:return{name:Xl,properties:[{name:"name"},{name:"predicates",defaultValue:[]},{name:"styles",defaultValue:[]}]};case Gg:return{name:Gg,properties:[{name:"id"},{name:"props",defaultValue:[]},{name:"targets"}]};case Kg:return{name:Kg,properties:[{name:"id"},{name:"styles",defaultValue:[]}]};case of:return{name:of,
properties:[{name:"name"}]};case lf:return{name:lf,properties:[{name:"hex"}]};case cf:return{name:cf,properties:[{name:"key"},{name:"libicon"},{name:"value"}]};case ya:return{name:ya,properties:[{name:"imported"},{name:"prev"}]};case Zg:return{name:Zg,properties:[{name:"imports"},{name:"project"}]};case uf:return{name:uf,properties:[{name:"to"}]};case df:return{name:df,properties:[{name:"inout"}]};case qs:return{name:qs,properties:[{name:"name"}]};case Jg:return{name:Jg,properties:[{name:"deploy\
ments",defaultValue:[]},{name:"globals",defaultValue:[]},{name:"imports",defaultValue:[]},{name:"likec4lib",defaultValue:[]},{name:"models",defaultValue:[]},{name:"specifications",defaultValue:[]},{name:"views",defaultValue:[]}]};case Yg:return{name:Yg,properties:[{name:"icons",defaultValue:[]}]};case ff:return{name:ff,properties:[{name:"key"},{name:"value"}]};case hf:return{name:hf,properties:[{name:"key"},{name:"title"},{name:"value"}]};case gf:return{name:gf,properties:[{name:"markdown"},{name:"\
text"}]};case yf:return{name:yf,properties:[{name:"values",defaultValue:[]}]};case vf:return{name:vf,properties:[{name:"key"},{name:"value"}]};case wf:return{name:wf,properties:[{name:"props",defaultValue:[]}]};case tc:return{name:tc,properties:[{name:"elements",defaultValue:[]},{name:"name"}]};case nc:return{name:nc,properties:[{name:"elements",defaultValue:[]},{name:"name"}]};case rc:return{name:rc,properties:[{name:"folder"},{name:"name"},{name:"styles",defaultValue:[]},{name:"views",defaultValue:[]}]};case kf:
return{name:kf,properties:[{name:"key"},{name:"value",defaultValue:!1}]};case Qg:return{name:Qg,properties:[{name:"key"},{name:"value"}]};case _f:return{name:_f,properties:[{name:"key"},{name:"value"}]};case Rf:return{name:Rf,properties:[{name:"key"},{name:"value"}]};case Sf:return{name:Sf,properties:[{name:"key"},{name:"value"}]};case $f:return{name:$f,properties:[{name:"dotKind"},{name:"from"},{name:"isBidirectional",defaultValue:!1},{name:"kind"}]};case Tf:return{name:Tf,properties:[{name:"ke\
y"},{name:"value"}]};case ny:return{name:ny,properties:[{name:"body"},{name:"description"},{name:"dotKind"},{name:"kind"},{name:"source"},{name:"tags"},{name:"target"},{name:"technology"},{name:"title"}]};case ry:return{name:ry,properties:[{name:"props",defaultValue:[]},{name:"tags"}]};case Ef:return{name:Ef,properties:[{name:"subject"},{name:"where"}]};case Pf:return{name:Pf,properties:[{name:"custom"},{name:"subject"}]};case iy:return{name:iy,properties:[{name:"kind"}]};case Cf:return{name:Cf,
properties:[{name:"key"},{name:"value"}]};case va:return{name:va,properties:[{name:"name"}]};case Af:return{name:Af,properties:[{name:"key"},{name:"value"}]};case Nf:return{name:Nf,properties:[{name:"key"},{name:"props",defaultValue:[]}]};case Df:return{name:Df,properties:[{name:"alpha"},{name:"blue"},{name:"green"},{name:"red"}]};case Of:return{name:Of,properties:[{name:"key"},{name:"value"}]};case Lf:return{name:Lf,properties:[{name:"key"},{name:"value"}]};case oy:return{name:oy,properties:[{name:"\
color"},{name:"name"}]};case sc:return{name:sc,properties:[{name:"kind"},{name:"props",defaultValue:[]},{name:"tags"}]};case oc:return{name:oc,properties:[{name:"kind"},{name:"props",defaultValue:[]},{name:"tags"}]};case Mf:return{name:Mf,properties:[{name:"key"},{name:"value"}]};case cc:return{name:cc,properties:[{name:"kind"},{name:"props",defaultValue:[]}]};case jf:return{name:jf,properties:[{name:"key"},{name:"value"}]};case dc:return{name:dc,properties:[{name:"colors",defaultValue:[]},{name:"\
deploymentNodes",defaultValue:[]},{name:"elements",defaultValue:[]},{name:"name"},{name:"relationships",defaultValue:[]},{name:"tags",defaultValue:[]}]};case fc:return{name:fc,properties:[{name:"color"},{name:"tag"}]};case cy:return{name:cy,properties:[{name:"el"},{name:"parent"}]};case uy:return{name:uy,properties:[{name:"parent"},{name:"value"}]};case wa:return{name:wa,properties:[{name:"name"}]};case dy:return{name:dy,properties:[{name:"tag"}]};case fy:return{name:fy,properties:[{name:"prev"},
{name:"values",defaultValue:[]}]};case zf:return{name:zf,properties:[{name:"key"},{name:"value"}]};case B_:return{name:B_,properties:[{name:"view"}]};case Uf:return{name:Uf,properties:[{name:"direction"},{name:"nodeSep"},{name:"rankSep"}]};case Vf:return{name:Vf,properties:[{name:"predicate"}]};case Bf:return{name:Bf,properties:[{name:"style"}]};case Wf:return{name:Wf,properties:[{name:"groupRules",defaultValue:[]},{name:"props",defaultValue:[]},{name:"title"}]};case Kf:return{name:Kf,properties:[
{name:"exprs"},{name:"isInclude",defaultValue:!1}]};case Jf:return{name:Jf,properties:[{name:"targets"},{name:"value"}]};case Yf:return{name:Yf,properties:[{name:"props",defaultValue:[]},{name:"targets"}]};case Xf:return{name:Xf,properties:[{name:"key"},{name:"value"}]};case Qf:return{name:Qf,properties:[{name:"left"},{name:"operator"},{name:"right"}]};case ep:return{name:ep,properties:[{name:"not",defaultValue:!1},{name:"operator"},{name:"value"}]};case tp:return{name:tp,properties:[{name:"valu\
e"}]};case np:return{name:np,properties:[{name:"not",defaultValue:!1},{name:"operator"},{name:"value"}]};case rp:return{name:rp,properties:[{name:"not",defaultValue:!1},{name:"operator"},{name:"value"}]};case ip:return{name:ip,properties:[{name:"value"}]};case sp:return{name:sp,properties:[{name:"not",defaultValue:!1},{name:"operator"},{name:"participant"},{name:"value"}]};case ap:return{name:ap,properties:[{name:"not",defaultValue:!1},{name:"operator"},{name:"participant"},{name:"value"}]};case op:
return{name:op,properties:[{name:"not",defaultValue:!1},{name:"operator"},{name:"value"}]};case lp:return{name:lp,properties:[{name:"isWildcard",defaultValue:!1}]};case cp:return{name:cp,properties:[{name:"custom"},{name:"dotKind"},{name:"kind"},{name:"source"},{name:"target"},{name:"title"}]};case up:return{name:up,properties:[{name:"custom"},{name:"dotKind"},{name:"isBackward",defaultValue:!1},{name:"kind"},{name:"source"},{name:"target"},{name:"title"}]};default:return{name:e,properties:[]}}}}
const re=new AN;let IN;const q8=()=>IN??(IN=d3(`{"$type":"Grammar","isDeclared":true,"name":"LikeC4","rules":[{"$type":"ParserRule","entry":true,"name":"LikeC4Grammar","definition":{"$type":"Alternatives","elements":[{"$type":"Assignment","feature":"imports","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@16"},"arguments":[]}},{"$type":"Assignment","feature":"specifications","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@8"},"arguments":[]}},{"$type\
":"Assignment","feature":"models","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@19"},"arguments":[]}},{"$type":"Assignment","feature":"views","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@44"},"arguments":[]}},{"$type":"Assignment","feature":"globals","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@122"},"arguments":[]}},{"$type":"Assignment","feature":"deployments","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$r\
ef":"#/rules@108"},"arguments":[]}},{"$type":"Assignment","feature":"likec4lib","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@1"},"arguments":[]}}],"cardinality":"*"},"definesHiddenTokens":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"LikeC4Lib","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"likec4lib"},{"$type":"Keyword","value":"{"},{"$type":"Keyword","value":"icons"},{"$type":"Keyword","\
value":"{"},{"$type":"Assignment","feature":"icons","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@2"},"arguments":[]},"cardinality":"+"},{"$type":"Keyword","value":"}"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"LibIcon","definition":{"$type":"Assignment","feature":"name","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@\
156"},"arguments":[]}},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ElementKind","definition":{"$type":"Assignment","feature":"name","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@160"},"arguments":[]}},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"Tag","definition":{"$type":"Assignmen\
t","feature":"name","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@160"},"arguments":[]}},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"RelationshipKind","definition":{"$type":"Assignment","feature":"name","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@160"},"arguments":[]}},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"param\
eters":[],"wildcard":false},{"$type":"ParserRule","name":"CustomColor","definition":{"$type":"Assignment","feature":"name","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@159"},"arguments":[]}},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"DeploymentNodeKind","definition":{"$type":"Assignment","feature":"name","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@1\
60"},"arguments":[]}},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"SpecificationRule","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"name","operator":"=","terminal":{"$type":"Keyword","value":"specification"}},{"$type":"Keyword","value":"{"},{"$type":"Alternatives","elements":[{"$type":"Assignment","feature":"elements","operator":"+=","terminal":{"$type":"RuleCall","rule":{\
"$ref":"#/rules@9"},"arguments":[]}},{"$type":"Assignment","feature":"tags","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@12"},"arguments":[]}},{"$type":"Assignment","feature":"relationships","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@14"},"arguments":[]}},{"$type":"Assignment","feature":"colors","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@13"},"arguments":[]}},{"$type":"Assignment","feature":"deploymentNodes","opera\
tor":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@11"},"arguments":[]}}],"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"SpecificationElementKind","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"element"},{"$type":"Assignment","feature":"kind","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@3"}\
,"arguments":[]}},{"$type":"Group","elements":[{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"tags","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@18"},"arguments":[]},"cardinality":"?"},{"$type":"Assignment","feature":"props","operator":"+=","terminal":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@10"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@128"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/\
rules@141"},"arguments":[]}]},"cardinality":"*"},{"$type":"Keyword","value":"}"}],"cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"SpecificationElementStringProperty","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"key","operator":"=","terminal":{"$type":"Alternatives","elements":[{"$type":"Keyword","value":"title"},{"$type":"Keyword","value":"description"},\
{"$type":"Keyword","value":"technology"},{"$type":"Keyword","value":"notation"},{"$type":"Keyword","value":"summary"}]}},{"$type":"Keyword","value":":","cardinality":"?"},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@158"},"arguments":[]}},{"$type":"Keyword","value":";","cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"Spe\
cificationDeploymentNodeKind","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"deploymentNode"},{"$type":"Assignment","feature":"kind","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@7"},"arguments":[]}},{"$type":"Group","elements":[{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"tags","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@18"},"arguments":[]},"cardinality":"?"},{"$type":"Assignment","feature":"props","op\
erator":"+=","terminal":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@10"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@128"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@141"},"arguments":[]}]},"cardinality":"*"},{"$type":"Keyword","value":"}"}],"cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"SpecificationTag","definiti\
on":{"$type":"Group","elements":[{"$type":"Keyword","value":"tag"},{"$type":"Assignment","feature":"tag","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@4"},"arguments":[]}},{"$type":"Group","elements":[{"$type":"Keyword","value":"{"},{"$type":"Group","elements":[{"$type":"Keyword","value":"color"},{"$type":"Assignment","feature":"color","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@153"},"arguments":[]}}],"cardinality":"?"},{"$type":"Keyword","value\
":"}"}],"cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"SpecificationColor","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"color"},{"$type":"Assignment","feature":"name","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@6"},"arguments":[]}},{"$type":"Assignment","feature":"color","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"\
#/rules@153"},"arguments":[]}}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"SpecificationRelationshipKind","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"relationship"},{"$type":"Assignment","feature":"kind","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@5"},"arguments":[]}},{"$type":"Group","elements":[{"$type":"Keyword","value":"{"},{"$type":"Assignmen\
t","feature":"props","operator":"+=","terminal":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@144"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@15"},"arguments":[]}]},"cardinality":"*"},{"$type":"Keyword","value":"}"}],"cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"SpecificationRelationshipStringProperty","definition":{"$type":"Group\
","elements":[{"$type":"Assignment","feature":"key","operator":"=","terminal":{"$type":"Alternatives","elements":[{"$type":"Keyword","value":"technology"},{"$type":"Keyword","value":"notation"}]}},{"$type":"Keyword","value":":","cardinality":"?"},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@158"},"arguments":[]}},{"$type":"Keyword","value":";","cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTo\
kens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ImportsFromPoject","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"import"},{"$type":"Alternatives","elements":[{"$type":"Group","elements":[{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"imports","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@17"},"arguments":[]}},{"$type":"Keyword","value":"}"}]},{"$type":"Assignment","feature":"imports","operator":"=","termin\
al":{"$type":"RuleCall","rule":{"$ref":"#/rules@17"},"arguments":[]}}]},{"$type":"Keyword","value":"from"},{"$type":"Assignment","feature":"project","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@181"},"arguments":[]}},{"$type":"Keyword","value":";","cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"Imported","definition":{"$type":"Group","elements":[{"$type":"Ass\
ignment","feature":"imported","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@20"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@160"},"arguments":[]},"deprecatedSyntax":false}},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"Imported"},"feature":"prev","operator":"="},{"$type":"Keyword","value":","},{"$type":"Assignment","feature":"imported","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/ru\
les@20"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@160"},"arguments":[]},"deprecatedSyntax":false}}],"cardinality":"*"},{"$type":"Keyword","value":";","cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"Tags","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"values","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@145"},"argumen\
ts":[]},"cardinality":"+"},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"Tags"},"feature":"prev","operator":"="},{"$type":"Keyword","value":","},{"$type":"Assignment","feature":"values","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@145"},"arguments":[]},"cardinality":"*"}],"cardinality":"*"},{"$type":"Keyword","value":";","cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"para\
meters":[],"wildcard":false},{"$type":"ParserRule","name":"Model","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"name","operator":"=","terminal":{"$type":"Keyword","value":"model"}},{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"elements","operator":"+=","terminal":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@24"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@27"},"arguments":[]},{"$type":"RuleCall","r\
ule":{"$ref":"#/rules@34"},"arguments":[{"$type":"NamedArgument","value":{"$type":"BooleanLiteral","true":true},"calledByName":false}]},{"$type":"RuleCall","rule":{"$ref":"#/rules@20"},"arguments":[]}]},"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"Element","definition":{"$type":"Group","elements":[{"$type":"Alternatives","elements":[{"$type":"Group"\
,"elements":[{"$type":"Assignment","feature":"kind","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@3"},"deprecatedSyntax":false}},{"$type":"Assignment","feature":"name","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@160"},"arguments":[]}}]},{"$type":"Group","elements":[{"$type":"Assignment","feature":"name","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@160"},"arguments":[]}},{"$type":"RuleCall","rule":{"$ref":"#/rules@17\
8"},"arguments":[]},{"$type":"Assignment","feature":"kind","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@3"},"deprecatedSyntax":false}}]}]},{"$type":"Group","elements":[{"$type":"Assignment","feature":"props","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@181"},"arguments":[]}},{"$type":"Group","elements":[{"$type":"Assignment","feature":"props","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@181"},"arguments":[]}},{"$t\
ype":"Group","elements":[{"$type":"Assignment","feature":"props","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@181"},"arguments":[]}},{"$type":"Assignment","feature":"props","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@181"},"arguments":[]},"cardinality":"?"}],"cardinality":"?"}],"cardinality":"?"}],"cardinality":"?"},{"$type":"Assignment","feature":"body","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@21"},"arguments":[]}\
,"cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ElementBody","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"tags","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@18"},"arguments":[]},"cardinality":"?"},{"$type":"Assignment","feature":"props","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref"\
:"#/rules@22"},"arguments":[]},"cardinality":"*"},{"$type":"Assignment","feature":"elements","operator":"+=","terminal":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@34"},"arguments":[{"$type":"NamedArgument","value":{"$type":"BooleanLiteral","true":false},"calledByName":false}]},{"$type":"RuleCall","rule":{"$ref":"#/rules@20"},"arguments":[]}]},"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hidde\
nTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ElementProperty","definition":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@23"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@141"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@128"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@132"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@39"},"arguments":[]}]},"definesHiddenTokens":false,\
"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ElementStringProperty","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"key","operator":"=","terminal":{"$type":"Alternatives","elements":[{"$type":"Keyword","value":"title"},{"$type":"Keyword","value":"description"},{"$type":"Keyword","value":"technology"},{"$type":"Keyword","value":"summary"}]}},{"$type":"Keyword","value":":","cardinality":"?"},{"$type":"As\
signment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@158"},"arguments":[]}},{"$type":"Keyword","value":";","cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ExtendElement","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"extend"},{"$type":"Assignment","feature":"element","operator":"=","terminal":{"$type":"RuleCall","rul\
e":{"$ref":"#/rules@31"},"arguments":[]}},{"$type":"Assignment","feature":"body","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@25"},"arguments":[]}}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ExtendElementBody","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"tags","operator":"=","terminal":{"$type":"RuleCall","rule"\
:{"$ref":"#/rules@18"},"arguments":[]},"cardinality":"?"},{"$type":"Assignment","feature":"props","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@26"},"arguments":[]},"cardinality":"*"},{"$type":"Assignment","feature":"elements","operator":"+=","terminal":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@34"},"arguments":[{"$type":"NamedArgument","value":{"$type":"BooleanLiteral","true":false},"calledByName":false}]},{"$type":"RuleCall","rule"\
:{"$ref":"#/rules@20"},"arguments":[]}]},"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ExtendElementProperty","definition":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@128"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@39"},"arguments":[]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"\
hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ExtendRelation","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"extend"},{"$type":"Assignment","feature":"source","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@32"},"arguments":[]}},{"$type":"Alternatives","elements":[{"$type":"Assignment","feature":"dotKind","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@146"},"arguments":[]}},{"$type":"Group","el\
ements":[{"$type":"Keyword","value":"-["},{"$type":"Assignment","feature":"kind","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@5"},"deprecatedSyntax":false}},{"$type":"Keyword","value":"]->"}]},{"$type":"Keyword","value":"->"}]},{"$type":"Assignment","feature":"target","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@32"},"arguments":[]}},{"$type":"Assignment","feature":"title","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rule\
s@181"},"arguments":[]},"cardinality":"?"},{"$type":"Assignment","feature":"body","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@28"},"arguments":[]}}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ExtendRelationBody","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"tags","operator":"=","terminal":{"$type":"RuleCall","rul\
e":{"$ref":"#/rules@18"},"arguments":[]},"cardinality":"?"},{"$type":"Assignment","feature":"props","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@29"},"arguments":[]},"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ExtendRelationProperty","definition":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rul\
es@128"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@39"},"arguments":[]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ElementRef","definition":{"$type":"Assignment","feature":"modelElement","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@32"},"arguments":[]}},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard"\
:false},{"$type":"ParserRule","name":"StrictFqnElementRef","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"el","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@20"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@160"},"arguments":[]},"deprecatedSyntax":false}},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"StrictFqnElementRef"},"feature":"parent","operator":"="},{"$type":"RuleCall","rule"\
:{"$ref":"#/rules@175"},"arguments":[]},{"$type":"Assignment","feature":"el","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@20"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@160"},"arguments":[]},"deprecatedSyntax":false}}],"cardinality":"*"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"FqnRef","definition":{"$type":"Group","elements":[{"$type":"Assignment","fe\
ature":"value","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/types@1"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@160"},"arguments":[]},"deprecatedSyntax":false}},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"FqnRef"},"feature":"parent","operator":"="},{"$type":"RuleCall","rule":{"$ref":"#/rules@175"},"arguments":[]},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"CrossReference","type\
":{"$ref":"#/types@1"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@160"},"arguments":[]},"deprecatedSyntax":false}}],"cardinality":"*"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"StrictFqnRef","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/types@1"},"terminal":{"$type":"RuleCall","ru\
le":{"$ref":"#/rules@160"},"arguments":[]},"deprecatedSyntax":false}},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"StrictFqnRef"},"feature":"parent","operator":"="},{"$type":"RuleCall","rule":{"$ref":"#/rules@175"},"arguments":[]},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/types@1"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@160"},"arguments":[]},"deprecatedSyntax":fals\
e}}],"cardinality":"*"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"Relation","parameters":[{"$type":"Parameter","name":"isExplicit"}],"definition":{"$type":"Group","elements":[{"$type":"Alternatives","elements":[{"$type":"Group","guardCondition":{"$type":"ParameterReference","parameter":{"$ref":"#/rules@34/parameters@0"}},"elements":[{"$type":"Assignment","feature":"source","operator":"=","termina\
l":{"$type":"RuleCall","rule":{"$ref":"#/rules@32"},"arguments":[]}}]},{"$type":"Group","guardCondition":{"$type":"Negation","value":{"$type":"ParameterReference","parameter":{"$ref":"#/rules@34/parameters@0"}}},"elements":[{"$type":"Assignment","feature":"source","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@32"},"arguments":[]},"cardinality":"?"}]}]},{"$type":"Alternatives","elements":[{"$type":"Assignment","feature":"dotKind","operator":"=","terminal":{"$type":"RuleCal\
l","rule":{"$ref":"#/rules@146"},"arguments":[]}},{"$type":"Group","elements":[{"$type":"Keyword","value":"-["},{"$type":"Assignment","feature":"kind","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@5"},"deprecatedSyntax":false}},{"$type":"Keyword","value":"]->"}]},{"$type":"Keyword","value":"->"}]},{"$type":"Assignment","feature":"target","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@32"},"arguments":[]}},{"$type":"Group","elements":[{"$type":\
"Assignment","feature":"title","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@181"},"arguments":[]}},{"$type":"Group","elements":[{"$type":"Assignment","feature":"description","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@181"},"arguments":[]}},{"$type":"Assignment","feature":"technology","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@181"},"arguments":[]},"cardinality":"?"}],"cardinality":"?"}],"cardinality":"?"},{"$type":"As\
signment","feature":"tags","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@18"},"arguments":[]},"cardinality":"?"},{"$type":"Assignment","feature":"body","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@35"},"arguments":[]},"cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"wildcard":false},{"$type":"ParserRule","name":"RelationBody","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"{"}\
,{"$type":"Assignment","feature":"tags","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@18"},"arguments":[]},"cardinality":"?"},{"$type":"Assignment","feature":"props","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@36"},"arguments":[]},"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"RelationProperty","defin\
ition":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@37"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@81"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@38"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@128"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@39"},"arguments":[]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRu\
le","name":"RelationStringProperty","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"key","operator":"=","terminal":{"$type":"Alternatives","elements":[{"$type":"Keyword","value":"title"},{"$type":"Keyword","value":"technology"},{"$type":"Keyword","value":"description"}]}},{"$type":"Keyword","value":":","cardinality":"?"},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@158"},"arguments":[]}},{"$type":"Keyword\
","value":";","cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"RelationStyleProperty","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"key","operator":"=","terminal":{"$type":"Keyword","value":"style"}},{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"props","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@144"},"argument\
s":[]},"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"MetadataProperty","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"metadata"},{"$type":"RuleCall","rule":{"$ref":"#/rules@40"},"arguments":[]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule",\
"name":"MetadataBody","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"props","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@41"},"arguments":[]},"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"MetadataAttribute","definition":{"$type":"Group","elements":[{"$type":"Assignm\
ent","feature":"key","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@184"},"arguments":[]}},{"$type":"Keyword","value":":","cardinality":"?"},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@42"},"arguments":[]}},{"$type":"Keyword","value":";","cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"MetadataVal\
ue","definition":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@158"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@43"},"arguments":[]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"MetadataArray","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"["},{"$type":"Assignment","feature":"values","operator":"+=","terminal":{"$type":"RuleCa\
ll","rule":{"$ref":"#/rules@158"},"arguments":[]}},{"$type":"Group","elements":[{"$type":"Keyword","value":","},{"$type":"Assignment","feature":"values","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@158"},"arguments":[]}}],"cardinality":"*"},{"$type":"Keyword","value":"]"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ModelViews","definition":{"$type":"Group","elements":[{"$t\
ype":"Assignment","feature":"name","operator":"=","terminal":{"$type":"Keyword","value":"views"}},{"$type":"Assignment","feature":"folder","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@181"},"arguments":[]},"cardinality":"?"},{"$type":"Keyword","value":"{"},{"$type":"Alternatives","elements":[{"$type":"Assignment","feature":"views","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@45"},"arguments":[]}},{"$type":"Assignment","feature":"styles","operato\
r":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@74"},"arguments":[]}}],"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"LikeC4ViewRule","returnType":{"$ref":"#/types@2"},"definition":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@46"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@47"},"argume\
nts":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@117"},"arguments":[]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ElementView","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"view"},{"$type":"Assignment","feature":"name","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@160"},"arguments":[]},"cardinality":"?"},{"$type":"Alternatives","elements":[{"$typ\
e":"Group","elements":[{"$type":"Keyword","value":"extends"},{"$type":"Assignment","feature":"extends","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@49"},"arguments":[]}}]},{"$type":"Group","elements":[{"$type":"Keyword","value":"of"},{"$type":"Assignment","feature":"viewOf","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@30"},"arguments":[]}}]}],"cardinality":"?"},{"$type":"Assignment","feature":"body","operator":"=","terminal":{"$type":"RuleCall","\
rule":{"$ref":"#/rules@51"},"arguments":[]},"cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"DynamicView","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"dynamic"},{"$type":"Keyword","value":"view"},{"$type":"Assignment","feature":"name","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@160"},"arguments":[]}},{"$type":"Assignment","feature":"b\
ody","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@52"},"arguments":[]},"cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ViewRef","definition":{"$type":"Assignment","feature":"view","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/types@2"},"deprecatedSyntax":false}},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":\
[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ElementViewRef","definition":{"$type":"Assignment","feature":"view","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@46"},"deprecatedSyntax":false}},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"DynamicViewRef","definition":{"$type":"Assignment","feature":"view","operator":"=","terminal":{"$type":"CrossReferen\
ce","type":{"$ref":"#/rules@47"},"deprecatedSyntax":false}},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ElementViewBody","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"tags","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@18"},"arguments":[]},"cardinality":"?"},{"$type":"Assignment","feature":"props","operator":"+=","te\
rminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@55"},"arguments":[]},"cardinality":"*"},{"$type":"Assignment","feature":"rules","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@58"},"arguments":[]},"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"DynamicViewBody","definition":{"$type":"Group","elements":[{"$type":"Keyword","val\
ue":"{"},{"$type":"Assignment","feature":"tags","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@18"},"arguments":[]},"cardinality":"?"},{"$type":"Assignment","feature":"props","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@53"},"arguments":[]},"cardinality":"*"},{"$type":"Alternatives","elements":[{"$type":"Assignment","feature":"steps","operator":"+=","terminal":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@63"},"ar\
guments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@65"},"arguments":[]}]}},{"$type":"Assignment","feature":"rules","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@62"},"arguments":[]}}],"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"DynamicViewProperty","definition":{"$type":"Alternatives","elements":[{"$type":"RuleCall","\
rule":{"$ref":"#/rules@54"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@55"},"arguments":[]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"DynamicViewDisplayVariantProperty","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"key","operator":"=","terminal":{"$type":"Keyword","value":"variant"}},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"\
$type":"RuleCall","rule":{"$ref":"#/rules@149"},"arguments":[]}}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ViewProperty","definition":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@56"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@128"},"arguments":[]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wi\
ldcard":false},{"$type":"ParserRule","name":"ViewStringProperty","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"key","operator":"=","terminal":{"$type":"Alternatives","elements":[{"$type":"Keyword","value":"title"},{"$type":"Keyword","value":"description"}]}},{"$type":"Keyword","value":":","cardinality":"?"},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@158"},"arguments":[]}},{"$type":"Keyword","value":";\
","cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ViewLayoutDirection","dataType":"string","definition":{"$type":"Alternatives","elements":[{"$type":"Keyword","value":"TopBottom"},{"$type":"Keyword","value":"LeftRight"},{"$type":"Keyword","value":"BottomTop"},{"$type":"Keyword","value":"RightLeft"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parame\
ters":[],"wildcard":false},{"$type":"ParserRule","name":"ViewRule","definition":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@68"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@69"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@61"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@74"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@75"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@59"},"arguments\
":[]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ViewRuleRank","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"rank"},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@60"},"arguments":[]},"cardinality":"?"},{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"targets","operator":"=","terminal":{"$type":"\
RuleCall","rule":{"$ref":"#/rules@95"},"arguments":[]}},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"RankValue","dataType":"string","definition":{"$type":"Alternatives","elements":[{"$type":"Keyword","value":"same"},{"$type":"Keyword","value":"min"},{"$type":"Keyword","value":"max"},{"$type":"Keyword","value":"source"},{"$type":"Keyword","value":"sink"}]},"definesHidd\
enTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ViewRuleGroup","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"group"},{"$type":"Assignment","feature":"title","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@181"},"arguments":[]},"cardinality":"?"},{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"props","operator":"+=","terminal":{"$type":"Alternatives","ele\
ments":[{"$type":"RuleCall","rule":{"$ref":"#/rules@129"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@135"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@130"},"arguments":[]}]},"cardinality":"*"},{"$type":"Assignment","feature":"groupRules","operator":"+=","terminal":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@68"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@61"},"arguments":[]}]},"cardinality":"*"},{"$type":"Keyw\
ord","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"DynamicViewRule","definition":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@70"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@71"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@74"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@75"},"arguments":[]}]},"definesHid\
denTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"DynamicViewParallelSteps","definition":{"$type":"Group","elements":[{"$type":"Alternatives","elements":[{"$type":"Keyword","value":"parallel"},{"$type":"Keyword","value":"par"}]},{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"steps","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@65"},"arguments":[]},"cardinality":"*"},{"$type"\
:"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","fragment":true,"name":"DynamicViewStepTarget","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"target","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@30"},"arguments":[]}},{"$type":"Assignment","feature":"title","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@181"},"ar\
guments":[]},"cardinality":"?"},{"$type":"Assignment","feature":"custom","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@79"},"arguments":[]},"cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"DynamicViewStep","returnType":{"$ref":"#/types@5"},"definition":{"$type":"RuleCall","rule":{"$ref":"#/rules@66"},"arguments":[]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hi\
ddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"DynamicStepChain","returnType":{"$ref":"#/interfaces@1"},"definition":{"$type":"Group","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@67"},"arguments":[]},{"$type":"Group","elements":[{"$type":"Action","type":{"$ref":"#/interfaces@2"},"feature":"source","operator":"="},{"$type":"Alternatives","elements":[{"$type":"Keyword","value":"->"},{"$type":"Group","elements":[{"$type":"Keyword","value":"-["},{"$type":"A\
ssignment","feature":"kind","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@5"},"deprecatedSyntax":false}},{"$type":"Keyword","value":"]->"}]},{"$type":"Assignment","feature":"dotKind","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@146"},"arguments":[]}}]},{"$type":"RuleCall","rule":{"$ref":"#/rules@64"},"arguments":[]}],"cardinality":"*"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":f\
alse},{"$type":"ParserRule","name":"DynamicStepSingle","returnType":{"$ref":"#/interfaces@1"},"definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"source","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@30"},"arguments":[]}},{"$type":"Alternatives","elements":[{"$type":"Assignment","feature":"isBackward","operator":"?=","terminal":{"$type":"Keyword","value":"<-"}},{"$type":"Keyword","value":"->"},{"$type":"Group","elements":[{"$type":"Keyword","value":\
"-["},{"$type":"Assignment","feature":"kind","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@5"},"deprecatedSyntax":false}},{"$type":"Keyword","value":"]->"}]},{"$type":"Assignment","feature":"dotKind","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@146"},"arguments":[]}}]},{"$type":"RuleCall","rule":{"$ref":"#/rules@64"},"arguments":[]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":fals\
e},{"$type":"ParserRule","name":"ViewRulePredicate","definition":{"$type":"Group","elements":[{"$type":"Alternatives","elements":[{"$type":"Assignment","feature":"isInclude","operator":"?=","terminal":{"$type":"Keyword","value":"include"}},{"$type":"Keyword","value":"exclude"}]},{"$type":"Assignment","feature":"exprs","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@82"},"arguments":[]}}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"paramete\
rs":[],"wildcard":false},{"$type":"ParserRule","name":"ViewRuleGlobalPredicateRef","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"global"},{"$type":"Keyword","value":"predicate"},{"$type":"Assignment","feature":"predicate","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@123"},"deprecatedSyntax":false}}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"Dy\
namicViewIncludePredicate","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"include"},{"$type":"Assignment","feature":"exprs","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@82"},"arguments":[]}}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"DynamicViewGlobalPredicateRef","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"global"},{"$type"\
:"Keyword","value":"predicate"},{"$type":"Assignment","feature":"predicate","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@124"},"deprecatedSyntax":false}}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ViewRuleStyle","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"style"},{"$type":"Assignment","feature":"targets","operator":"=","terminal":{"$type":"R\
uleCall","rule":{"$ref":"#/rules@95"},"arguments":[]}},{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"props","operator":"+=","terminal":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@140"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@76"},"arguments":[]}]},"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"Par\
serRule","name":"ViewRuleGlobalStyle","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"global"},{"$type":"Keyword","value":"style"},{"$type":"Assignment","feature":"style","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@125"},"deprecatedSyntax":false}}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ViewRuleStyleOrGlobalRef","definition":{"$type":"Altern\
atives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@72"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@73"},"arguments":[]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ViewRuleAutoLayout","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"autoLayout"},{"$type":"Assignment","feature":"direction","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref"\
:"#/rules@57"},"arguments":[]}},{"$type":"Group","elements":[{"$type":"Assignment","feature":"rankSep","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@183"},"arguments":[]}},{"$type":"Assignment","feature":"nodeSep","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@183"},"arguments":[]},"cardinality":"?"}],"cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRu\
le","name":"NotationProperty","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"key","operator":"=","terminal":{"$type":"Keyword","value":"notation"}},{"$type":"Keyword","value":":","cardinality":"?"},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@158"},"arguments":[]}},{"$type":"Keyword","value":";","cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters"\
:[],"wildcard":false},{"$type":"ParserRule","name":"NotesProperty","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"key","operator":"=","terminal":{"$type":"Keyword","value":"notes"}},{"$type":"Keyword","value":":","cardinality":"?"},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@158"},"arguments":[]}},{"$type":"Keyword","value":";","cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":fa\
lse,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"CustomElementProperties","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"props","operator":"+=","terminal":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@80"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@23"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@76"},"arguments":[]},{"$type":"RuleCal\
l","rule":{"$ref":"#/rules@140"},"arguments":[]}]},"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"CustomRelationProperties","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"props","operator":"+=","terminal":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@81"},"ar\
guments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@37"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@76"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@77"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@144"},"arguments":[]}]},"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"NavigateToProperty","definitio\
n":{"$type":"Group","elements":[{"$type":"Assignment","feature":"key","operator":"=","terminal":{"$type":"Keyword","value":"navigateTo"}},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@48"},"arguments":[]}}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"RelationNavigateToProperty","definition":{"$type":"Group","elements":[{"$type":"Assignm\
ent","feature":"key","operator":"=","terminal":{"$type":"Keyword","value":"navigateTo"}},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@50"},"arguments":[]}}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"Expressions","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleC\
all","rule":{"$ref":"#/rules@83"},"arguments":[]}},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"Expressions"},"feature":"prev","operator":"="},{"$type":"Keyword","value":","},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@83"},"arguments":[]},"cardinality":"?"}],"cardinality":"*"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":\
false},{"$type":"ParserRule","name":"ExpressionV2","definition":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@86"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@84"},"arguments":[]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"FqnExprOrWith","definition":{"$type":"Group","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@85"},"arguments":[]},{"$ty\
pe":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"FqnExprWith"},"feature":"subject","operator":"="},{"$type":"Keyword","value":"with"},{"$type":"Assignment","feature":"custom","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@78"},"arguments":[]},"cardinality":"?"}],"cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"FqnExprOrWhe\
re","definition":{"$type":"Group","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@88"},"arguments":[]},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"FqnExprWhere"},"feature":"subject","operator":"="},{"$type":"Keyword","value":"where"},{"$type":"Assignment","feature":"where","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@96"},"arguments":[]},"cardinality":"?"}],"cardinality":"?"}]},"definesHiddenTokens":false,"entry":\
false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"RelationExprOrWith","definition":{"$type":"Group","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@87"},"arguments":[]},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"RelationExprWith"},"feature":"subject","operator":"="},{"$type":"Keyword","value":"with"},{"$type":"Assignment","feature":"custom","operator":"=","terminal":{"$type":"RuleCal\
l","rule":{"$ref":"#/rules@79"},"arguments":[]},"cardinality":"?"}],"cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"RelationExprOrWhere","definition":{"$type":"Group","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@90"},"arguments":[]},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"RelationExprWhere"},"feature":"subject","operato\
r":"="},{"$type":"Keyword","value":"where"},{"$type":"Assignment","feature":"where","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@102"},"arguments":[]},"cardinality":"?"}],"cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"FqnExpr","definition":{"$type":"Alternatives","elements":[{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType\
","name":"WildcardExpression"}},{"$type":"Assignment","feature":"isWildcard","operator":"?=","terminal":{"$type":"Keyword","value":"*"}}]},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"ElementTagExpression"}},{"$type":"Keyword","value":"element.tag"},{"$type":"RuleCall","rule":{"$ref":"#/rules@162"},"arguments":[]},{"$type":"Assignment","feature":"tag","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@145"},"arguments":[]}}]},{"\
$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"ElementKindExpression"}},{"$type":"Keyword","value":"element.kind"},{"$type":"RuleCall","rule":{"$ref":"#/rules@162"},"arguments":[]},{"$type":"Assignment","feature":"kind","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@3"},"deprecatedSyntax":false}}]},{"$type":"RuleCall","rule":{"$ref":"#/rules@89"},"arguments":[]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,\
"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"FqnRefExpr","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"ref","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@32"},"arguments":[]}},{"$type":"Assignment","feature":"selector","operator":"=","terminal":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@172"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@173"},"arguments":[\
]}]},"cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"RelationExpr","definition":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@91"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@93"},"arguments":[]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name\
":"InOutRelationExpr","inferredType":{"$type":"InferredType","name":"RelationExpr"},"definition":{"$type":"Group","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@92"},"arguments":[]},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"InOutRelationExpr"},"feature":"inout","operator":"="},{"$type":"Keyword","value":"->"}],"cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":fa\
lse},{"$type":"ParserRule","name":"IncomingRelationExpr","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"->"},{"$type":"Assignment","feature":"to","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@88"},"arguments":[]}}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"DirectedRelationExpr","inferredType":{"$type":"InferredType","name":"RelationExpr"},"definition"\
:{"$type":"Group","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@94"},"arguments":[]},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"DirectedRelationExpr"},"feature":"source","operator":"="},{"$type":"Assignment","feature":"target","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@88"},"arguments":[]}}],"cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wild\
card":false},{"$type":"ParserRule","name":"OutgoingRelationExpr","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"from","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@88"},"arguments":[]}},{"$type":"Alternatives","elements":[{"$type":"Assignment","feature":"isBidirectional","operator":"?=","terminal":{"$type":"Keyword","value":"<->"}},{"$type":"Keyword","value":"->"},{"$type":"Group","elements":[{"$type":"Keyword","value":"-["},{"$type":"Assignmen\
t","feature":"kind","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@5"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@160"},"arguments":[]},"deprecatedSyntax":false}},{"$type":"Keyword","value":"]->"}]},{"$type":"Assignment","feature":"dotKind","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@146"},"arguments":[]}}]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"\
ParserRule","name":"FqnExpressions","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@88"},"arguments":[]}},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"FqnExpressions"},"feature":"prev","operator":"="},{"$type":"Keyword","value":","},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@88"}\
,"arguments":[]},"cardinality":"?"}],"cardinality":"*"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"WhereElementExpression","definition":{"$type":"RuleCall","rule":{"$ref":"#/rules@97"},"arguments":[]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"WhereElementOr","inferredType":{"$type":"InferredType","na\
me":"WhereElementExpression"},"definition":{"$type":"Group","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@98"},"arguments":[]},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"WhereBinaryExpression"},"feature":"left","operator":"="},{"$type":"Assignment","feature":"operator","operator":"=","terminal":{"$type":"Keyword","value":"or"}},{"$type":"Assignment","feature":"right","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules\
@98"},"arguments":[]}}],"cardinality":"*"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"WhereElementAnd","inferredType":{"$type":"InferredType","name":"WhereElementExpression"},"definition":{"$type":"Group","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@99"},"arguments":[]},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"WhereBinaryExpression"},\
"feature":"left","operator":"="},{"$type":"Assignment","feature":"operator","operator":"=","terminal":{"$type":"Keyword","value":"and"}},{"$type":"Assignment","feature":"right","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@99"},"arguments":[]}}],"cardinality":"*"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"WhereElementPrimary","inferredType":{"$type":"InferredType","name":"\
WhereElementExpression"},"definition":{"$type":"Alternatives","elements":[{"$type":"Group","elements":[{"$type":"Keyword","value":"("},{"$type":"RuleCall","rule":{"$ref":"#/rules@96"},"arguments":[]},{"$type":"Keyword","value":")"}]},{"$type":"RuleCall","rule":{"$ref":"#/rules@100"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@101"},"arguments":[]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule"\
,"name":"WhereElementNegation","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"not"},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@96"},"arguments":[]}}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"WhereElement","definition":{"$type":"Alternatives","elements":[{"$type":"Group","elements":[{"$type":"Action","inferre\
dType":{"$type":"InferredType","name":"WhereElementTag"}},{"$type":"Keyword","value":"tag"},{"$type":"RuleCall","rule":{"$ref":"#/rules@161"},"arguments":[]},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@145"},"arguments":[]}}]},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"WhereElementKind"}},{"$type":"Keyword","value":"kind"},{"$type":"RuleCall","rule":{"$ref":"#/rules@161"},"argumen\
ts":[]},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/types@6"},"deprecatedSyntax":false}}]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"WhereRelationExpression","definition":{"$type":"RuleCall","rule":{"$ref":"#/rules@103"},"arguments":[]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wi\
ldcard":false},{"$type":"ParserRule","name":"WhereRelationOr","inferredType":{"$type":"InferredType","name":"WhereRelationExpression"},"definition":{"$type":"Group","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@104"},"arguments":[]},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"WhereBinaryExpression"},"feature":"left","operator":"="},{"$type":"Assignment","feature":"operator","operator":"=","terminal":{"$type":"Keyword","value":"or"}},{"$\
type":"Assignment","feature":"right","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@104"},"arguments":[]}}],"cardinality":"*"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"WhereRelationAnd","inferredType":{"$type":"InferredType","name":"WhereRelationExpression"},"definition":{"$type":"Group","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@105"},"arguments":[]},{"$type"\
:"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"WhereBinaryExpression"},"feature":"left","operator":"="},{"$type":"Assignment","feature":"operator","operator":"=","terminal":{"$type":"Keyword","value":"and"}},{"$type":"Assignment","feature":"right","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@105"},"arguments":[]}}],"cardinality":"*"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wild\
card":false},{"$type":"ParserRule","name":"WhereRelationPrimary","inferredType":{"$type":"InferredType","name":"WhereRelationExpression"},"definition":{"$type":"Alternatives","elements":[{"$type":"Group","elements":[{"$type":"Keyword","value":"("},{"$type":"RuleCall","rule":{"$ref":"#/rules@102"},"arguments":[]},{"$type":"Keyword","value":")"}]},{"$type":"RuleCall","rule":{"$ref":"#/rules@106"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@107"},"arguments":[]}]},"definesHiddenToke\
ns":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"WhereRelationNegation","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"not"},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@102"},"arguments":[]}}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"Wh\
ereRelation","definition":{"$type":"Alternatives","elements":[{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"WhereRelationTag"}},{"$type":"Keyword","value":"tag"},{"$type":"RuleCall","rule":{"$ref":"#/rules@161"},"arguments":[]},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@145"},"arguments":[]}}]},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","na\
me":"WhereRelationKind"}},{"$type":"Keyword","value":"kind"},{"$type":"RuleCall","rule":{"$ref":"#/rules@161"},"arguments":[]},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@5"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@160"},"arguments":[]},"deprecatedSyntax":false}}]},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"WhereRelationParticipantTag"}},{"$type":"Assignment",\
"feature":"participant","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@152"},"arguments":[]}},{"$type":"RuleCall","rule":{"$ref":"#/rules@175"},"arguments":[]},{"$type":"Keyword","value":"tag"},{"$type":"RuleCall","rule":{"$ref":"#/rules@161"},"arguments":[]},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@145"},"arguments":[]}}]},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredTy\
pe","name":"WhereRelationParticipantKind"}},{"$type":"Assignment","feature":"participant","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@152"},"arguments":[]}},{"$type":"RuleCall","rule":{"$ref":"#/rules@175"},"arguments":[]},{"$type":"Keyword","value":"kind"},{"$type":"RuleCall","rule":{"$ref":"#/rules@161"},"arguments":[]},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/types@6"},"terminal":{"$type":"RuleCall"\
,"rule":{"$ref":"#/rules@160"},"arguments":[]},"deprecatedSyntax":false}}]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ModelDeployments","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"name","operator":"=","terminal":{"$type":"Keyword","value":"deployment"}},{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"elements","operator":"+=","terminal":{"$type":"Al\
ternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@109"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@115"},"arguments":[{"$type":"NamedArgument","value":{"$type":"BooleanLiteral","true":true},"calledByName":false}]},{"$type":"RuleCall","rule":{"$ref":"#/rules@113"},"arguments":[]}]},"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRul\
e","name":"DeploymentNode","definition":{"$type":"Group","elements":[{"$type":"Alternatives","elements":[{"$type":"Group","elements":[{"$type":"Assignment","feature":"kind","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@7"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@160"},"arguments":[]},"deprecatedSyntax":false}},{"$type":"Assignment","feature":"name","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@160"},"arguments":[]}}]},{"$type":\
"Group","elements":[{"$type":"Assignment","feature":"name","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@160"},"arguments":[]}},{"$type":"RuleCall","rule":{"$ref":"#/rules@178"},"arguments":[]},{"$type":"Assignment","feature":"kind","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@7"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@160"},"arguments":[]},"deprecatedSyntax":false}}]}]},{"$type":"Group","elements":[{"$type":"Assignment","fea\
ture":"title","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@181"},"arguments":[]}},{"$type":"Assignment","feature":"summary","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@181"},"arguments":[]},"cardinality":"?"}],"cardinality":"?"},{"$type":"Assignment","feature":"body","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@110"},"arguments":[]},"cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTo\
kens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"DeploymentNodeBody","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"tags","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@18"},"arguments":[]},"cardinality":"?"},{"$type":"Assignment","feature":"props","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@22"},"arguments":[]},"cardinality":"*"},{"$type":"Assignment","feature":"\
elements","operator":"+=","terminal":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@111"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@115"},"arguments":[{"$type":"NamedArgument","value":{"$type":"BooleanLiteral","true":false},"calledByName":false}]},{"$type":"RuleCall","rule":{"$ref":"#/rules@109"},"arguments":[]}]},"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"pa\
rameters":[],"wildcard":false},{"$type":"ParserRule","name":"DeployedInstance","definition":{"$type":"Group","elements":[{"$type":"Group","elements":[{"$type":"Assignment","feature":"name","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@160"},"arguments":[]}},{"$type":"RuleCall","rule":{"$ref":"#/rules@178"},"arguments":[]}],"cardinality":"?"},{"$type":"Keyword","value":"instanceOf"},{"$type":"Assignment","feature":"target","operator":"=","terminal":{"$type":"RuleCall","rul\
e":{"$ref":"#/rules@30"},"arguments":[]}},{"$type":"Group","elements":[{"$type":"Assignment","feature":"title","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@181"},"arguments":[]}},{"$type":"Assignment","feature":"summary","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@181"},"arguments":[]},"cardinality":"?"}],"cardinality":"?"},{"$type":"Assignment","feature":"body","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@112"},"argumen\
ts":[]},"cardinality":"?"},{"$type":"Keyword","value":";","cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"DeployedInstanceBody","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"tags","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@18"},"arguments":[]},"cardinality":"?"},{"$type":"Assignment","feature":"pr\
ops","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@22"},"arguments":[]},"cardinality":"*"},{"$type":"Assignment","feature":"elements","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@115"},"arguments":[{"$type":"NamedArgument","value":{"$type":"BooleanLiteral","true":false},"calledByName":false}]},"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcar\
d":false},{"$type":"ParserRule","name":"ExtendDeployment","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"extend"},{"$type":"Assignment","feature":"deploymentNode","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@33"},"arguments":[]}},{"$type":"Assignment","feature":"body","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@114"},"arguments":[]}}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters\
":[],"wildcard":false},{"$type":"ParserRule","name":"ExtendDeploymentBody","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"tags","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@18"},"arguments":[]},"cardinality":"?"},{"$type":"Assignment","feature":"props","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@26"},"arguments":[]},"cardinality":"*"},{"$type":"Assignment","feature":"elements","operato\
r":"+=","terminal":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@111"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@115"},"arguments":[{"$type":"NamedArgument","value":{"$type":"BooleanLiteral","true":true},"calledByName":false}]},{"$type":"RuleCall","rule":{"$ref":"#/rules@109"},"arguments":[]}]},"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildc\
ard":false},{"$type":"ParserRule","name":"DeploymentRelation","parameters":[{"$type":"Parameter","name":"isExplicit"}],"definition":{"$type":"Group","elements":[{"$type":"Alternatives","elements":[{"$type":"Group","guardCondition":{"$type":"ParameterReference","parameter":{"$ref":"#/rules@115/parameters@0"}},"elements":[{"$type":"Assignment","feature":"source","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@32"},"arguments":[]}}]},{"$type":"Group","guardCondition":{"$type":\
"Negation","value":{"$type":"ParameterReference","parameter":{"$ref":"#/rules@115/parameters@0"}}},"elements":[{"$type":"Assignment","feature":"source","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@32"},"arguments":[]},"cardinality":"?"}]}]},{"$type":"Alternatives","elements":[{"$type":"Assignment","feature":"dotKind","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@146"},"arguments":[]}},{"$type":"Group","elements":[{"$type":"Keyword","value":"-["},{\
"$type":"Assignment","feature":"kind","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@5"},"deprecatedSyntax":false}},{"$type":"Keyword","value":"]->"}]},{"$type":"Keyword","value":"->"}]},{"$type":"Assignment","feature":"target","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@32"},"arguments":[]}},{"$type":"Group","elements":[{"$type":"Assignment","feature":"title","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@181"},"argum\
ents":[]}},{"$type":"Group","elements":[{"$type":"Assignment","feature":"description","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@181"},"arguments":[]}},{"$type":"Assignment","feature":"technology","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@181"},"arguments":[]},"cardinality":"?"}],"cardinality":"?"}],"cardinality":"?"},{"$type":"Assignment","feature":"tags","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@18"},"arguments"\
:[]},"cardinality":"?"},{"$type":"Assignment","feature":"body","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@116"},"arguments":[]},"cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"wildcard":false},{"$type":"ParserRule","name":"DeploymentRelationBody","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"tags","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"\
#/rules@18"},"arguments":[]},"cardinality":"?"},{"$type":"Assignment","feature":"props","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@36"},"arguments":[]},"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"DeploymentView","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"deployment"},{"$type":"Keyword","value":\
"view"},{"$type":"Assignment","feature":"name","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@160"},"arguments":[]}},{"$type":"Assignment","feature":"body","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@118"},"arguments":[]},"cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"DeploymentViewBody","definition":{"$type":"Group","elements":[{"$ty\
pe":"Keyword","value":"{"},{"$type":"Assignment","feature":"tags","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@18"},"arguments":[]},"cardinality":"?"},{"$type":"Assignment","feature":"props","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@55"},"arguments":[]},"cardinality":"*"},{"$type":"Assignment","feature":"rules","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@119"},"arguments":[]},"cardinality":"*"},{"$type":"Keyword","v\
alue":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"DeploymentViewRule","definition":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@121"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@120"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@75"},"arguments":[]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"\
parameters":[],"wildcard":false},{"$type":"ParserRule","name":"DeploymentViewRuleStyle","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"style"},{"$type":"Assignment","feature":"targets","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@95"},"arguments":[]}},{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"props","operator":"+=","terminal":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@140"},"arguments":[]}\
,{"$type":"RuleCall","rule":{"$ref":"#/rules@76"},"arguments":[]}]},"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"DeploymentViewRulePredicate","definition":{"$type":"Group","elements":[{"$type":"Alternatives","elements":[{"$type":"Assignment","feature":"isInclude","operator":"?=","terminal":{"$type":"Keyword","value":"include"}},{"$type":"Keyword","v\
alue":"exclude"}]},{"$type":"Assignment","feature":"expr","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@82"},"arguments":[]}}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"Globals","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"name","operator":"=","terminal":{"$type":"Keyword","value":"global"}},{"$type":"Keyword","value":"{"},{"$type":"Group","ele\
ments":[{"$type":"Assignment","feature":"predicates","operator":"+=","terminal":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@123"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@124"},"arguments":[]}]},"cardinality":"*"},{"$type":"Assignment","feature":"styles","operator":"+=","terminal":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@126"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@127"},"arguments"\
:[]}]},"cardinality":"*"}],"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"GlobalPredicateGroup","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"predicateGroup"},{"$type":"Assignment","feature":"name","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@184"},"arguments":[]}},{"$type":"Keyword","value":"{"},{"$typ\
e":"Assignment","feature":"predicates","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@68"},"arguments":[]},"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"GlobalDynamicPredicateGroup","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"dynamicPredicateGroup"},{"$type":"Assignment","feature":"name","operator":"=\
","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@184"},"arguments":[]}},{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"predicates","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@70"},"arguments":[]},"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"GlobalStyleId","definition":{"$type":"Assignment","featur\
e":"name","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@184"},"arguments":[]}},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"GlobalStyle","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"style"},{"$type":"Assignment","feature":"id","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@125"},"arguments":[]}},{"$type":"Assignment","feature":"ta\
rgets","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@95"},"arguments":[]}},{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"props","operator":"+=","terminal":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@140"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@76"},"arguments":[]}]},"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"pa\
rameters":[],"wildcard":false},{"$type":"ParserRule","name":"GlobalStyleGroup","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"styleGroup"},{"$type":"Assignment","feature":"id","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@125"},"arguments":[]}},{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"styles","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@72"},"arguments":[]},"cardinality":"*"},{"$type":"Keyword","valu\
e":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"LinkProperty","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"key","operator":"=","terminal":{"$type":"Keyword","value":"link"}},{"$type":"Keyword","value":":","cardinality":"?"},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@157"},"arguments":[]}},{"$type":"\
Assignment","feature":"title","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@181"},"arguments":[]},"cardinality":"?"},{"$type":"Keyword","value":";","cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ColorProperty","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"key","operator":"=","terminal":{"$type":"Keyword","value":"color"}},{"$type"\
:"Keyword","value":":","cardinality":"?"},{"$type":"Alternatives","elements":[{"$type":"Assignment","feature":"themeColor","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@150"},"arguments":[]}},{"$type":"Assignment","feature":"customColor","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@6"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@159"},"arguments":[]},"deprecatedSyntax":false}}]},{"$type":"Keyword","value":";","cardinality":"?"}]},\
"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"OpacityProperty","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"key","operator":"=","terminal":{"$type":"Keyword","value":"opacity"}},{"$type":"Keyword","value":":","cardinality":"?"},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@179"},"arguments":[]}},{"$type":"Keyw\
ord","value":";","cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"MultipleProperty","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"key","operator":"=","terminal":{"$type":"Keyword","value":"multiple"}},{"$type":"Keyword","value":":","cardinality":"?"},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rul\
es@167"},"arguments":[]}},{"$type":"Keyword","value":";","cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"IconProperty","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"key","operator":"=","terminal":{"$type":"Keyword","value":"icon"}},{"$type":"Keyword","value":":","cardinality":"?"},{"$type":"Alternatives","elements":[{"$type":"Assignment","feature":"libico\
n","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@2"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@156"},"arguments":[]},"deprecatedSyntax":false}},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"Alternatives","elements":[{"$type":"Keyword","value":"none"},{"$type":"RuleCall","rule":{"$ref":"#/rules@157"},"arguments":[]}]}}]},{"$type":"Keyword","value":";","cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":\
false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ShapeProperty","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"key","operator":"=","terminal":{"$type":"Keyword","value":"shape"}},{"$type":"Keyword","value":":","cardinality":"?"},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@151"},"arguments":[]}},{"$type":"Keyword","value":";","cardinality":"?"}]},"definesHiddenToken\
s":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"BorderStyleValue","dataType":"string","definition":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@147"},"arguments":[]},{"$type":"Keyword","value":"none"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"BorderProperty","definition":{"$type":"Group","\
elements":[{"$type":"Assignment","feature":"key","operator":"=","terminal":{"$type":"Keyword","value":"border"}},{"$type":"Keyword","value":":","cardinality":"?"},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@134"},"arguments":[]}},{"$type":"Keyword","value":";","cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"SizeValue",\
"dataType":"string","definition":{"$type":"Alternatives","elements":[{"$type":"Keyword","value":"xs"},{"$type":"Keyword","value":"sm"},{"$type":"Keyword","value":"md"},{"$type":"Keyword","value":"lg"},{"$type":"Keyword","value":"xl"},{"$type":"Keyword","value":"xsmall"},{"$type":"Keyword","value":"small"},{"$type":"Keyword","value":"medium"},{"$type":"Keyword","value":"large"},{"$type":"Keyword","value":"xlarge"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"par\
ameters":[],"wildcard":false},{"$type":"ParserRule","name":"ShapeSizeProperty","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"key","operator":"=","terminal":{"$type":"Keyword","value":"size"}},{"$type":"Keyword","value":":","cardinality":"?"},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@136"},"arguments":[]}},{"$type":"Keyword","value":";","cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"f\
ragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"PaddingSizeProperty","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"key","operator":"=","terminal":{"$type":"Keyword","value":"padding"}},{"$type":"Keyword","value":":","cardinality":"?"},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@136"},"arguments":[]}},{"$type":"Keyword","value":";","cardinality":"?"}]},"d\
efinesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"TextSizeProperty","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"key","operator":"=","terminal":{"$type":"Keyword","value":"textSize"}},{"$type":"Keyword","value":":","cardinality":"?"},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@136"},"arguments":[]}},{"$type":"Keyw\
ord","value":";","cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"StyleProperty","definition":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@129"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@133"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@135"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@130"},"argument\
s":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@132"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@131"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@137"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@138"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@139"},"arguments":[]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ElementStyleProperty\
","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"key","operator":"=","terminal":{"$type":"Keyword","value":"style"}},{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"props","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@140"},"arguments":[]},"cardinality":"*"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","nam\
e":"LineProperty","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"key","operator":"=","terminal":{"$type":"Keyword","value":"line"}},{"$type":"Keyword","value":":","cardinality":"?"},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@147"},"arguments":[]}},{"$type":"Keyword","value":";","cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":f\
alse},{"$type":"ParserRule","name":"ArrowProperty","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"key","operator":"=","terminal":{"$type":"Alternatives","elements":[{"$type":"Keyword","value":"head"},{"$type":"Keyword","value":"tail"}]}},{"$type":"Keyword","value":":","cardinality":"?"},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@148"},"arguments":[]}},{"$type":"Keyword","value":";","cardinality":"?"}]}\
,"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"RelationshipStyleProperty","definition":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@129"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@142"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@143"},"arguments":[]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"para\
meters":[],"wildcard":false},{"$type":"ParserRule","name":"TagRef","definition":{"$type":"Group","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@174"},"arguments":[]},{"$type":"Assignment","feature":"tag","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@4"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@160"},"arguments":[]},"deprecatedSyntax":false}}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcar\
d":false},{"$type":"ParserRule","name":"RelationKindDotRef","definition":{"$type":"Group","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@176"},"arguments":[]},{"$type":"Assignment","feature":"kind","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@5"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@160"},"arguments":[]},"deprecatedSyntax":false}}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":fal\
se},{"$type":"ParserRule","name":"LineOptions","dataType":"string","definition":{"$type":"Alternatives","elements":[{"$type":"Keyword","value":"solid"},{"$type":"Keyword","value":"dashed"},{"$type":"Keyword","value":"dotted"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ArrowType","dataType":"string","definition":{"$type":"Alternatives","elements":[{"$type":"Keyword","value":"none"},{"$type":"Keywor\
d","value":"normal"},{"$type":"Keyword","value":"onormal"},{"$type":"Keyword","value":"dot"},{"$type":"Keyword","value":"odot"},{"$type":"Keyword","value":"diamond"},{"$type":"Keyword","value":"odiamond"},{"$type":"Keyword","value":"crow"},{"$type":"Keyword","value":"open"},{"$type":"Keyword","value":"vee"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"DynamicViewDisplayVariantValue","dataType":"stri\
ng","definition":{"$type":"Alternatives","elements":[{"$type":"Keyword","value":"diagram"},{"$type":"Keyword","value":"sequence"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ThemeColor","dataType":"string","definition":{"$type":"Alternatives","elements":[{"$type":"Keyword","value":"primary"},{"$type":"Keyword","value":"secondary"},{"$type":"Keyword","value":"muted"},{"$type":"Keyword","value":"slat\
e"},{"$type":"Keyword","value":"blue"},{"$type":"Keyword","value":"indigo"},{"$type":"Keyword","value":"sky"},{"$type":"Keyword","value":"red"},{"$type":"Keyword","value":"gray"},{"$type":"Keyword","value":"green"},{"$type":"Keyword","value":"amber"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ElementShape","dataType":"string","definition":{"$type":"Alternatives","elements":[{"$type":"Keyword","val\
ue":"rectangle"},{"$type":"Keyword","value":"person"},{"$type":"Keyword","value":"browser"},{"$type":"Keyword","value":"mobile"},{"$type":"Keyword","value":"cylinder"},{"$type":"Keyword","value":"storage"},{"$type":"Keyword","value":"queue"},{"$type":"Keyword","value":"bucket"},{"$type":"Keyword","value":"document"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"Participant","dataType":"string","defin\
ition":{"$type":"Alternatives","elements":[{"$type":"Keyword","value":"source"},{"$type":"Keyword","value":"target"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ColorLiteral","definition":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@154"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@155"},"arguments":[]}]},"definesHiddenTokens":false,"entry":false,"\
fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"RGBAColor","definition":{"$type":"Group","elements":[{"$type":"Alternatives","elements":[{"$type":"Keyword","value":"rgba"},{"$type":"Keyword","value":"rgb"}]},{"$type":"Keyword","value":"("},{"$type":"Assignment","feature":"red","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@183"},"arguments":[]}},{"$type":"Keyword","value":",","cardinality":"?"},{"$type":"Assignment","featur\
e":"green","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@183"},"arguments":[]}},{"$type":"Keyword","value":",","cardinality":"?"},{"$type":"Assignment","feature":"blue","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@183"},"arguments":[]}},{"$type":"Keyword","value":",","cardinality":"?"},{"$type":"Assignment","feature":"alpha","operator":"=","terminal":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@182"},"arguments":\
[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@183"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@179"},"arguments":[]}]},"cardinality":"?"},{"$type":"Keyword","value":")"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"HexColor","definition":{"$type":"Group","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@174"},"arguments":[]},{"$type":"Assignment","feature":"hex","operator":"\
=","terminal":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@185"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@183"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@184"},"arguments":[]}]}}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"IconId","dataType":"string","definition":{"$type":"RuleCall","rule":{"$ref":"#/rules@168"},"arguments":[]}\
,"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"Uri","dataType":"string","definition":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@169"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@170"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@171"},"arguments":[]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parame\
ters":[],"wildcard":false},{"$type":"ParserRule","name":"MarkdownOrString","definition":{"$type":"Alternatives","elements":[{"$type":"Assignment","feature":"markdown","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@180"},"arguments":[]}},{"$type":"Assignment","feature":"text","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@181"},"arguments":[]}}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":fa\
lse},{"$type":"ParserRule","name":"CustomColorId","dataType":"string","definition":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@184"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@151"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@148"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@147"},"arguments":[]},{"$type":"Keyword","value":"element"},{"$type":"Keyword","value":"model"}]},"definesHiddenTokens":false,"entry":false\
,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"Id","dataType":"string","definition":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@184"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@151"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@150"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@148"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@147"},"arguments":[\
]},{"$type":"RuleCall","rule":{"$ref":"#/rules@152"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@136"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@149"},"arguments":[]},{"$type":"Keyword","value":"element"},{"$type":"Keyword","value":"model"},{"$type":"Keyword","value":"group"},{"$type":"Keyword","value":"node"},{"$type":"Keyword","value":"deployment"},{"$type":"Keyword","value":"instance"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens\
":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","fragment":true,"name":"EqOperator","definition":{"$type":"Alternatives","elements":[{"$type":"Assignment","feature":"operator","operator":"=","terminal":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@178"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@177"},"arguments":[]}]}},{"$type":"Group","elements":[{"$type":"Assignment","feature":"operator","operator":"=","terminal":{"$type":"Keywor\
d","value":"is"}},{"$type":"Assignment","feature":"not","operator":"?=","terminal":{"$type":"Keyword","value":"not"},"cardinality":"?"}]}]},"definesHiddenTokens":false,"entry":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","fragment":true,"name":"IsEqual","definition":{"$type":"Alternatives","elements":[{"$type":"Assignment","feature":"isEqual","operator":"?=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@178"},"arguments":[]}},{"$type":"RuleCall","rule"\
:{"$ref":"#/rules@177"},"arguments":[]}]},"definesHiddenTokens":false,"entry":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"TerminalRule","hidden":true,"name":"BLOCK_COMMENT","definition":{"$type":"RegexToken","regex":"/\\\\/\\\\*[\\\\s\\\\S]*?\\\\*\\\\//"},"fragment":false},{"$type":"TerminalRule","hidden":true,"name":"LINE_COMMENT","definition":{"$type":"RegexToken","regex":"/\\\\/\\\\/[^\\\\n\\\\r]*/"},"fragment":false},{"$type":"TerminalRule","hidden":true,"name":"WS","definition":{"$type"\
:"RegexToken","regex":"/[\\\\t ]+/"},"fragment":false},{"$type":"TerminalRule","hidden":true,"name":"NL","definition":{"$type":"RegexToken","regex":"/[\\\\r\\\\n]+/"},"fragment":false},{"$type":"TerminalRule","name":"BOOLEAN","type":{"$type":"ReturnType","name":"boolean"},"definition":{"$type":"RegexToken","regex":"/\\\\b(true|false)\\\\b/"},"fragment":false,"hidden":false},{"$type":"TerminalRule","name":"LIB_ICON","definition":{"$type":"RegexToken","regex":"/(aws|azure|bootstrap|gcp|tech):[-\\\\w]*/"},"fra\
gment":false,"hidden":false},{"$type":"TerminalRule","name":"URI_WITH_SCHEMA","definition":{"$type":"RegexToken","regex":"/\\\\w+:\\\\/{2}\\\\S+/"},"fragment":false,"hidden":false},{"$type":"TerminalRule","name":"URI_RELATIVE","definition":{"$type":"RegexToken","regex":"/\\\\.{0,2}\\\\/[^\\\\/]\\\\S+/"},"fragment":false,"hidden":false},{"$type":"TerminalRule","name":"URI_ALIAS","definition":{"$type":"RegexToken","regex":"/@[a-zA-Z0-9_-]*\\\\/[^\\\\s]+/"},"fragment":false,"hidden":false},{"$type":"TerminalRule","n\
ame":"DotUnderscore","definition":{"$type":"RegexToken","regex":"/\\\\b\\\\._(?![_a-zA-Z])/"},"fragment":false,"hidden":false},{"$type":"TerminalRule","name":"DotWildcard","definition":{"$type":"RegexToken","regex":"/\\\\b\\\\.\\\\*{1,2}/"},"fragment":false,"hidden":false},{"$type":"TerminalRule","name":"Hash","definition":{"$type":"CharacterRange","left":{"$type":"Keyword","value":"#"}},"fragment":false,"hidden":false},{"$type":"TerminalRule","name":"StickyDot","definition":{"$type":"RegexToken","regex":\
"/\\\\b\\\\./"},"fragment":false,"hidden":false},{"$type":"TerminalRule","name":"Dot","definition":{"$type":"CharacterRange","left":{"$type":"Keyword","value":"."}},"fragment":false,"hidden":false},{"$type":"TerminalRule","name":"NotEqual","definition":{"$type":"RegexToken","regex":"/\\\\!\\\\={1,2}/"},"fragment":false,"hidden":false},{"$type":"TerminalRule","name":"Eq","definition":{"$type":"RegexToken","regex":"/\\\\={1,2}/"},"fragment":false,"hidden":false},{"$type":"TerminalRule","name":"Percent","def\
inition":{"$type":"RegexToken","regex":"/\\\\b\\\\d+%/"},"fragment":false,"hidden":false},{"$type":"TerminalRule","name":"MarkdownString","definition":{"$type":"TerminalAlternatives","elements":[{"$type":"TerminalGroup","elements":[{"$type":"CharacterRange","left":{"$type":"Keyword","value":"'''"}},{"$type":"UntilToken","terminal":{"$type":"CharacterRange","left":{"$type":"Keyword","value":"'''"}}}]},{"$type":"TerminalGroup","elements":[{"$type":"CharacterRange","left":{"$type":"Keyword","value":"\\"\
\\"\\""}},{"$type":"UntilToken","terminal":{"$type":"CharacterRange","left":{"$type":"Keyword","value":"\\"\\"\\""}}}]}]},"fragment":false,"hidden":false},{"$type":"TerminalRule","name":"String","definition":{"$type":"RegexToken","regex":"/\\"(?:[^\\"\\\\\\\\]|\\\\\\\\.)*\\"|'(?:[^'\\\\\\\\]|\\\\\\\\.)*'/"},"fragment":false,"hidden":false},{"$type":"TerminalRule","name":"Float","type":{"$type":"ReturnType","name":"number"},"definition":{"$type":"RegexToken","regex":"/\\\\b\\\\d+\\\\.\\\\d+\\\\b/"},"fragment":false,"hidden":false\
},{"$type":"TerminalRule","name":"Number","type":{"$type":"ReturnType","name":"number"},"definition":{"$type":"RegexToken","regex":"/\\\\b\\\\d+\\\\b/"},"fragment":false,"hidden":false},{"$type":"TerminalRule","name":"IdTerminal","definition":{"$type":"RegexToken","regex":"/[_]*[a-zA-Z][-\\\\w]*/"},"fragment":false,"hidden":false},{"$type":"TerminalRule","name":"Hex","definition":{"$type":"RegexToken","regex":"/[a-fA-F0-9]{3,}(?![-_g-zG-Z])/"},"fragment":false,"hidden":false}],"types":[{"$type":"Type","\
name":"ModelReferenceable","type":{"$type":"UnionType","types":[{"$type":"SimpleType","typeRef":{"$ref":"#/rules@20"}},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@17"}}]}},{"$type":"Type","name":"Referenceable","type":{"$type":"UnionType","types":[{"$type":"SimpleType","typeRef":{"$ref":"#/rules@109"}},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@111"}},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@20"}},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@17"}}]}},{"$type":"Type","name"\
:"LikeC4View","type":{"$type":"UnionType","types":[{"$type":"SimpleType","typeRef":{"$ref":"#/rules@46"}},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@47"}},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@117"}}]}},{"$type":"Type","name":"StringProperty","type":{"$type":"UnionType","types":[{"$type":"SimpleType","typeRef":{"$ref":"#/rules@23"}},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@56"}},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@37"}},{"$type":"SimpleType","typeRef":{"$ref\
":"#/rules@41"}},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@10"}},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@15"}},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@76"}},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@77"}}]}},{"$type":"Type","name":"AnyProperty","type":{"$type":"UnionType","types":[{"$type":"SimpleType","typeRef":{"$ref":"#/types@3"}},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@55"}},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@53"}},{"$type":"SimpleType",\
"typeRef":{"$ref":"#/rules@22"}},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@36"}}]}},{"$type":"Type","name":"DynamicViewStep","type":{"$type":"UnionType","types":[{"$type":"SimpleType","typeRef":{"$ref":"#/interfaces@1"}},{"$type":"SimpleType","typeRef":{"$ref":"#/interfaces@2"}}]}},{"$type":"Type","name":"DeploymentNodeOrElementKind","type":{"$type":"UnionType","types":[{"$type":"SimpleType","typeRef":{"$ref":"#/rules@3"}},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@7"}}]}},{"$type":\
"Type","name":"WhereTagEqual","type":{"$type":"UnionType","types":[{"$type":"SimpleType","typeRef":{"$ref":"#/rules@101/definition/elements@0/elements@0/inferredType"}},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@107/definition/elements@0/elements@0/inferredType"}},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@107/definition/elements@2/elements@0/inferredType"}}]}},{"$type":"Type","name":"WhereKindEqual","type":{"$type":"UnionType","types":[{"$type":"SimpleType","typeRef":{"$ref":"#/rule\
s@101/definition/elements@1/elements@0/inferredType"}},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@107/definition/elements@1/elements@0/inferredType"}},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@107/definition/elements@3/elements@0/inferredType"}}]}},{"$type":"Type","name":"WhereExpression","type":{"$type":"UnionType","types":[{"$type":"SimpleType","typeRef":{"$ref":"#/rules@96"}},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@102"}}]}},{"$type":"Type","name":"DeploymentElement","ty\
pe":{"$type":"UnionType","types":[{"$type":"SimpleType","typeRef":{"$ref":"#/rules@109"}},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@111"}}]}},{"$type":"Type","name":"FqnReferenceable","type":{"$type":"UnionType","types":[{"$type":"SimpleType","typeRef":{"$ref":"#/types@1"}},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@20"}},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@24"}},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@113"}}]}},{"$type":"Type","name":"SizeProperty","type":{"$t\
ype":"UnionType","types":[{"$type":"SimpleType","typeRef":{"$ref":"#/rules@137"}},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@138"}},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@139"}}]}}],"interfaces":[{"$type":"Interface","name":"AbstractDynamicStep","attributes":[{"$type":"TypeAttribute","name":"kind","isOptional":true,"type":{"$type":"ReferenceType","referenceType":{"$type":"SimpleType","typeRef":{"$ref":"#/rules@5"}}}},{"$type":"TypeAttribute","name":"dotKind","isOptional":true,"ty\
pe":{"$type":"SimpleType","typeRef":{"$ref":"#/rules@146"}}},{"$type":"TypeAttribute","name":"target","type":{"$type":"SimpleType","typeRef":{"$ref":"#/rules@30"}},"isOptional":false},{"$type":"TypeAttribute","name":"title","isOptional":true,"type":{"$type":"SimpleType","primitiveType":"string"}},{"$type":"TypeAttribute","name":"custom","isOptional":true,"type":{"$type":"SimpleType","typeRef":{"$ref":"#/rules@79"}}}],"superTypes":[]},{"$type":"Interface","name":"DynamicStepSingle","superTypes":[\
{"$ref":"#/interfaces@0"}],"attributes":[{"$type":"TypeAttribute","name":"source","type":{"$type":"SimpleType","typeRef":{"$ref":"#/rules@30"}},"isOptional":false},{"$type":"TypeAttribute","name":"isBackward","isOptional":true,"type":{"$type":"SimpleType","primitiveType":"boolean"}}]},{"$type":"Interface","name":"DynamicStepChain","superTypes":[{"$ref":"#/interfaces@0"}],"attributes":[{"$type":"TypeAttribute","name":"source","type":{"$type":"UnionType","types":[{"$type":"SimpleType","typeRef":{"\
$ref":"#/interfaces@1"}},{"$type":"SimpleType","typeRef":{"$ref":"#/interfaces@2"}}]},"isOptional":false}]}],"definesHiddenTokens":false,"hiddenTokens":[],"imports":[],"usedGrammars":[]}`)),fp={languageId:"likec4",fileExtensions:[".c4",".likec4",".like-c4"],caseInsensitive:!1,mode:"production"},F8={skipValidations:!0,recoveryEnabled:!0,nodeLocationTracking:"full"},z8={AstReflection:()=>new AN},U8={Grammar:()=>q8(),LanguageMetaData:()=>fp,parser:{ParserConfig:()=>F8}},H8=[...Object.entries({aws:[
"activate","alexa-for-business","amplify","apache-mxnet-on-aws","api-gateway","app-config","app-flow","app-mesh","app-runner","app-stream","app-sync","application-auto-scaling","application-composer","application-cost-profiler","application-discovery-service","application-migration-service","artifact","athena","audit-manager","augmented-ai-a2i","aurora","auto-scaling","backint-agent","backup","batch","billing-conductor","bottlerocket","braket","budgets","certificate-manager","chatbot","chime-sdk",
"chime-voice-connector","chime","clean-rooms","client-vpn","cloud-control-api","cloud-development-kit","cloud-directory","cloud-formation","cloud-front","cloud-hsm","cloud-map","cloud-search","cloud-shell","cloud-trail","cloud-wan","cloud-watch","cloud9","code-artifact","code-build","code-catalyst","code-commit","code-deploy","code-guru","code-pipeline","code-star","code-whisperer","cognito","command-line-interface","comprehend-medical","comprehend","compute-optimizer","config","connect","consol\
e-mobile-application","control-tower","corretto","cost-and-usage-report","cost-explorer","data-exchange","data-pipeline","data-sync","data-zone","database-migration-service","deep-composer","deep-learning-amis","deep-learning-containers","deep-lens","deep-racer","detective","dev-ops-guru","device-farm","direct-connect","directory-service","distro-for-open-telemetry","document-db","dynamo-db","ec2-auto-scaling","ec2-image-builder","ec2","ecs-anywhere","efs","eks-anywhere","eks-cloud","eks-distro",
"elasti-cache","elastic-beanstalk","elastic-block-store","elastic-container-registry","elastic-container-service","elastic-disaster-recovery","elastic-fabric-adapter","elastic-inference","elastic-kubernetes-service","elastic-load-balancing","elastic-transcoder","elemental-appliances-software","elemental-conductor","elemental-delta","elemental-link","elemental-live","elemental-media-connect","elemental-media-convert","elemental-media-live","elemental-media-package","elemental-media-store","elemen\
tal-media-tailor","elemental-server","emr","event-bridge","express-workflows","fargate","fault-injection-simulator","file-cache","fin-space","firewall-manager","forecast","fraud-detector","free-rtos","fsx-for-lustre","fsx-for-net-app-ontap","fsx-for-open-zfs","fsx-for-wfs","fsx","game-kit","game-lift","game-sparks","genomics-cli","global-accelerator","glue-data-brew","glue-elastic-views","glue","ground-station","guard-duty","health-lake","honeycode","iam-identity-center","identity-and-access-man\
agement","inspector","interactive-video-service","io-t-1-click","io-t-analytics","io-t-button","io-t-core","io-t-device-defender","io-t-device-management","io-t-edu-kit","io-t-events","io-t-express-link","io-t-fleet-wise","io-t-greengrass","io-t-robo-runner","io-t-site-wise","io-t-things-graph","io-t-twin-maker","iq","kendra","key-management-service","keyspaces","kinesis-data-analytics","kinesis-data-streams","kinesis-firehose","kinesis-video-streams","kinesis","lake-formation","lambda","launch-\
wizard","lex","license-manager","lightsail","local-zones","location-service","lookout-for-equipment","lookout-for-metrics","lookout-for-vision","lumberyard","macie","mainframe-modernization","managed-blockchain","managed-grafana","managed-service-for-prometheus","managed-services","managed-streaming-for-apache-kafka","managed-workflows-for-apache-airflow","management-console","marketplace-dark","marketplace-light","memory-db-for-redis","migration-evaluator","migration-hub","monitron","mq","neptu\
ne","network-firewall","neuron","nice-dcv","nice-engin-frame","nimble-studio","nitro-enclaves","omics","open-3d-engine","open-search-service","ops-works","organizations","outposts-family","outposts-rack","outposts-servers","panorama","parallel-cluster","personal-health-dashboard","personalize","pinpoint-apis","pinpoint","polly","private-5g","private-certificate-authority","private-link","professional-services","proton","quantum-ledger-database","quick-sight","rds-on-vmware","rds","re-post","red-\
hat-open-shift-service-on-aws","redshift","rekognition","reserved-instance-reporting","resilience-hub","resource-access-manager","resource-explorer","robo-maker","route-53","s3-on-outposts","sage-maker-ground-truth","sage-maker-studio-lab","sage-maker","savings-plans","secrets-manager","security-hub","security-lake","server-migration-service","serverless-application-repository","service-catalog","service-management-connector","shield","signer","sim-space-weaver","simple-email-service","simple-no\
tification-service","simple-queue-service","simple-storage-service-glacier","simple-storage-service","site-to-site-vpn","snowball-edge","snowball","snowcone","snowmobile","step-functions","storage-gateway","sumerian","supply-chain","support","systems-manager","tensor-flow-on-aws","textract","thinkbox-deadline","thinkbox-frost","thinkbox-krakatoa","thinkbox-sequoia","thinkbox-stoke","thinkbox-xmesh","timestream","tools-and-sdks","torch-serve","training-certification","transcribe","transfer-family",
"transit-gateway","translate","trusted-advisor","verified-access","verified-permissions","virtual-private-cloud","vmware-cloud-on-aws","vpc-lattice","waf","wavelength","well-architected-tool","wickr","work-docs-sdk","work-docs","work-link","work-mail","work-spaces-family","x-ray"],azure:["abs-member","active-directory-connect-health","activity-log","administrative-units","advisor","ai-at-edge","ai-studio","aks-automatic","aks-istio","alerts","all-resources","analysis-services","anomaly-detector",
"api-center","api-connections","api-management-services","api-proxy","app-compliance-automation","app-configuration","app-registrations","app-service-certificates","app-service-domains","app-service-environments","app-service-plans","app-services","app-space-component","app-space","applens","application-gateway-containers","application-gateways","application-group","application-insights","application-security-groups","aquila","arc-data-services","arc-kubernetes","arc-machines","arc-postgre-sql",
"arc-sql-managed-instance","arc-sql-server","atm-multistack","auto-scale","automanaged-vm","automation-accounts","availability-sets","avs-vm","azure-a","azure-ad-b2c","azure-api-for-fhir","azure-applied-ai-services","azure-arc","azure-attestation","azure-backup-center","azure-blockchain-service","azure-center-for-sap","azure-chaos-studio","azure-cloud-shell","azure-communication-services","azure-communications-gateway","azure-compute-galleries","azure-consumption-commitment","azure-cosmos-db","a\
zure-data-catalog","azure-data-explorer-clusters","azure-database-maria-db-server","azure-database-migration-services","azure-database-my-sql-server","azure-database-postgre-sql-server-group","azure-database-postgre-sql-server","azure-databox-gateway","azure-databricks","azure-deployment-environments","azure-dev-ops","azure-dev-tunnels","azure-edge-hardware-center","azure-experimentation-studio","azure-fileshares","azure-firewall-manager","azure-firewall-policy","azure-hcp-cache","azure-hpc-work\
benches","azure-hybrid-center","azure-information-protection","azure-io-t-operations","azure-lighthouse","azure-load-testing","azure-managed-grafana","azure-managed-redis","azure-maps-accounts","azure-media-service","azure-migrate","azure-monitor-dashboard","azure-monitor-pipeline","azure-monitors-for-sap-solutions","azure-net-app-files","azure-network-function-manager-functions","azure-network-function-manager","azure-object-understanding","azure-open-ai","azure-operator-5g-core","azure-operato\
r-insights","azure-operator-nexus","azure-operator-service-manager","azure-orbital","azure-programmable-connectivity","azure-purview-accounts","azure-quotas","azure-red-hat-open-shift","azure-sentinel","azure-service-bus","azure-sphere","azure-spring-apps","azure-sql-edge","azure-sql-server-stretch-databases","azure-sql-vm","azure-sql","azure-stack-edge","azure-stack-hci-sizer","azure-stack","azure-storage-mover","azure-support-center-blue","azure-sustainability","azure-synapse-analytics","azure\
-token-service","azure-video-indexer","azure-virtual-desktop","azure-vmware-solution","azure-workbooks","azurite","backlog","backup-vault","bare-metal-infrastructure","bastions","batch-accounts","batch-ai","biz-talk","blob-block","blob-page","blockchain-applications","blueprints","bonsai","bot-services","branch","breeze","browser","bug","builds","business-process-tracking","cache-redis","cache","capacity-reservation-groups","capacity","cdn-profiles","central-service-instance-for-sap","ceres","ch\
ange-analysis","client-apps","cloud-services-classic","cloud-services-extended-support","cloud-test","code-optimization","code","cognitive-search","cognitive-services-decisions","cognitive-services","collaborative-service","commit","community-images","compliance-center","compliance","compute-fleet","computer-vision","conditional-access","confidential-ledgers","connected-cache","connected-vehicle-platform","connections","consortium","container-apps-environments","container-instances","container-r\
egistries","container-services-deprecated","content-moderators","content-safety","controls-horizontal","controls","cost-alerts","cost-analysis","cost-budgets","cost-export","cost-management-and-billing","cost-management","counter","cubes","custom-ip-prefix","custom-vision","customer-lockbox-for-microsoft-azure","dashboard-hub","dashboard","data-box","data-collection-rules","data-factories","data-lake-analytics","data-lake-storage-gen1","data-lake-store-gen1","data-share-invitations","data-shares",
"data-virtualization","database-instance-for-sap","ddo-s-protection-plans","dedicated-hsm","defender-cm-local-manager","defender-dcs-controller","defender-distributer-control-system","defender-engineering-station","defender-external-management","defender-freezer-monitor","defender-historian","defender-hmi","defender-industrial-packaging-system","defender-industrial-printer","defender-industrial-robot","defender-industrial-scale-system","defender-marquee","defender-meter","defender-plc","defender\
-pneumatic-device","defender-programable-board","defender-relay","defender-robot-controller","defender-rtu","defender-sensor","defender-slot","defender-web-guiding-system","detonation","dev-console","dev-ops-starter","dev-test-labs","device-compliance","device-configuration","device-enrollment","device-provisioning-services","device-security-apple","device-security-google","device-security-windows","device-update-io-t-hub","devices","diagnostics-settings","digital-twins","disk-encryption-sets","\
disk-pool","disks-classic","disks-snapshots","disks","dns-multistack","dns-private-resolver","dns-security-policy","dns-zones","download","e-books","edge-actions","edge-management","edge-storage-accelerator","education","elastic-job-agents","elastic-san","endpoint-analytics","engage-center-connect","enterprise-applications","entra-connect-health","entra-connect-sync","entra-connect","entra-domain-services","entra-global-secure-access","entra-id-protection","entra-identity-custom-roles","entra-id\
entity-licenses","entra-identity-risky-signins","entra-identity-risky-users","entra-identity-roles-and-administrators","entra-internet-access","entra-managed-identities","entra-private-access","entra-privleged-identity-management","entra-verified-id","error","event-grid-domains","event-grid-subscriptions","event-grid-topics","event-hub-clusters","event-hubs","exchange-access","exchange-on-premises-access","express-route-circuits","express-route-direct","express-route-traffic-collector","extended\
-security-updates","extensions","external-id-modified","external-id","external-identities","face-apis","feature-previews","fhir-service","fiji","file","files","firewalls","folder-blank","folder-website","form-recognizers","frd-qa","free-services","front-door-and-cdn-profiles","ftp","function-apps","gear","genomics-accounts","genomics","globe-error","globe-success","globe-warning","groups","guide","hd-insight-clusters","hdi-aks-cluster","heart","help-and-support","host-groups","host-pools","hosts",
"hybrid-connectivity-hub","ic-m-troubleshooting","identity-governance","identity-multi-factor-authentication","identity-secure-score","image-definitions","image-templates","image-versions","image","images","immersive-readers","import-export-jobs","industrial-io-t","information","infrastructure-backup","input-output","instance-pools","integration-accounts","integration-environments","integration-service-environments","internet-analyzer-profiles","intune-app-protection","intune-for-education","int\
une-trends","intune","io-t-central-applications","io-t-edge","io-t-hub","ip-address-manager","ip-groups","journey-hub","key-vaults","keys","kubernetes-fleet-manager","kubernetes-services","lab-accounts","lab-services","landing-zone","language-understanding","language","launch-portal","learn","load-balancer-hub","load-balancers","load-test","load-testing","local-network-gateways","location","log-analytics-query-pack","log-analytics-workspaces","log-streaming","logic-apps-custom-connector","logic-\
apps-template","logic-apps","machine-learning-studio-classic-web-services","machine-learning-studio-web-service-plans","machine-learning-studio-workspaces","machine-learning","machines-azure-arc","maintenance-configuration","managed-applications-center","managed-database","managed-desktop","managed-dev-ops-pools","managed-file-shares","managed-identities","managed-instance-apache-cassandra","managed-service-fabric","management-groups","management-portal","marketplace-management","marketplace","m\
ed-tech-service","media-file","media","mesh-applications","metrics-advisor","metrics","microsoft-defender-easm","microsoft-defender-for-cloud","microsoft-defender-for-io-t","microsoft-dev-box","mindaro","mission-landing-zone","mobile-engagement","mobile-networks","mobile","modular-data-center","module","monitor-health-models","monitor","multi-tenancy","multifactor-authentication","my-customers","nat","network-foundation-hub","network-interfaces","network-managers","network-security-groups","netw\
ork-security-hub","network-security-perimeters","network-watcher","notification-hub-namespaces","notification-hubs","offers","on-premises-data-gateways","open-supply-chain-platform","operation-log-classic","oracle-database","os-images-classic","osconfig","outbound-connection","partner-namespace","partner-registration","partner-topic","peering-service","peerings","personalizers","planetary-computer-pro","plans","policy","power-bi-embedded","power-platform","power-up","power","powershell","preview\
-features","private-endpoints","private-link-service","private-link-services","private-link","process-explorer","production-ready-database","promethus","proximity-placement-groups","public-ip-addresses-classic","public-ip-addresses","public-ip-prefixes","qn-a-makers","quickstart-center","recent","recovery-services-vaults","region-management","relays","remote-rendering","reservations","reserved-capacity","reserved-ip-addresses-classic","resource-explorer","resource-graph-explorer","resource-group\
-list","resource-groups","resource-guard","resource-linked","resource-management-private-link","resource-mover","resources-provider","restore-points-collections","restore-points","route-filters","route-tables","rtos","savings-plans","scheduler-job-collections","scheduler","scvmm-management-servers","search-grid","search","security-baselines","security","send-grid-accounts","server-farm","serverless-search","service-catalog-mad","service-endpoint-policies","service-fabric-clusters","service-group\
-relationships","service-groups","service-health","service-providers","shared-image-galleries","signal-r","software-as-a-service","software-updates","solutions","sonic-dash","spatial-anchor-accounts","speech-services","spot-vm","spot-vmss","sql-data-warehouses","sql-database-fleet-manager","sql-database","sql-elastic-pools","sql-managed-instance","sql-server-registries","sql-server","ssd","ssh-keys","ssis-lift-and-shift-ir","stack-hci-premium","static-apps","stor-simple-data-managers","stor-simp\
le-device-managers","storage-accounts-classic","storage-accounts","storage-actions","storage-azure-files","storage-container","storage-explorer","storage-functions","storage-hubs","storage-queue","storage-sync-services","stream-analytics-jobs","subnet","subscriptions","system-topic","table","tag","tags","targets-management","template-specs","templates","tenant-properties","tenant-status","test-base","tfs-vc-repository","time-series-data-sets","time-series-insights-access-policies","time-series-i\
nsights-environments","time-series-insights-event-sources","toolbox","toolchain-orchestrator","traffic-manager-profiles","translator-text","troubleshoot","universal-print","update-management-center","updates","user-privacy","user-settings","user-subscriptions","users","verifiable-credentials","verification-as-a-service","versions","video-analyzers","virtual-clusters","virtual-enclaves","virtual-instance-for-sap","virtual-machine","virtual-machines-classic","virtual-network-gateways","virtual-net\
works-classic","virtual-networks","virtual-router","virtual-visits-builder","virtual-wan-hub","virtual-wans","vm-app-definitions","vm-app-versions","vm-image-version","vm-images-classic","vm-scale-sets","vpnclient-windows","wac-installer","wac","web-app-database","web-application-firewall-policies-waf","web-jobs","web-slots","web-test","website-power","website-staging","windows-notification-services","windows10-core-services","workbooks","worker-container-app","workflow","workload-orchestration",
"workspace-gateway","workspaces"],gcp:["access-context-manager","administration","advanced-agent-modeling","advanced-solutions-lab","agent-assist","ai-hub","ai-platform-unified","ai-platform","analytics-hub","anthos-config-management","anthos-service-mesh","anthos","api-analytics","api-monetization","api","apigee-api-platform","apigee-sense","app-engine","artifact-registry","asset-inventory","assured-workloads","auto-ml-natural-language","auto-ml-tables","auto-ml-translation","auto-ml-video-inte\
lligence","auto-ml-vision","auto-ml","bare-metal-solutions","batch","beyondcorp","big-query","bigtable","billing","binary-authorization","catalog","certificate-authority-service","certificate-manager","cloud-api-gateway","cloud-apis","cloud-armor","cloud-asset-inventory","cloud-audit-logs","cloud-build","cloud-cdn","cloud-code","cloud-composer","cloud-data-fusion","cloud-deploy","cloud-deployment-manager","cloud-dns","cloud-domains","cloud-ekm","cloud-endpoints","cloud-external-ip-addresses","cl\
oud-firewall-rules","cloud-for-marketing","cloud-functions","cloud-generic","cloud-gpu","cloud-healthcare-api","cloud-healthcare-marketplace","cloud-hsm","cloud-ids","cloud-inference-api","cloud-interconnect","cloud-jobs-api","cloud-load-balancing","cloud-logging","cloud-media-edge","cloud-monitoring","cloud-nat","cloud-natural-language-api","cloud-network","cloud-ops","cloud-optimization-ai-fleet-routing-api","cloud-optimization-ai","cloud-router","cloud-routes","cloud-run-for-anthos","cloud-ru\
n","cloud-scheduler","cloud-security-scanner","cloud-shell","cloud-spanner","cloud-sql","cloud-storage","cloud-tasks","cloud-test-lab","cloud-tpu","cloud-translation-api","cloud-vision-api","cloud-vpn","compute-engine","configuration-management","connectivity-test","connectors","contact-center-ai","container-optimized-os","container-registry","data-catalog","data-labeling","data-layers","data-loss-prevention-api","data-qn-a","data-studio","data-transfer","database-migration-service","dataflow","\
datalab","dataplex","datapol","dataprep","dataproc-metastore","dataproc","datashare","datastore","datastream","debugger","developer-portal","dialogflow-cx","dialogflow-insights","dialogflow","document-ai","early-access-center","error-reporting","eventarc","filestore","financial-services-marketplace","firestore","fleet-engine","free-trial","game-servers","gce-systems-management","genomics","gke-on-prem","google-cloud-marketplace","google-kubernetes-engine","google-maps-platform","healthcare-nlp-a\
pi","home","identity-and-access-management","identity-aware-proxy","identity-platform","iot-core","iot-edge","key-access-justifications","key-management-service","kuberun","launcher","local-ssd","looker","managed-service-for-microsoft-active-directory","media-translation-api","memorystore","migrate-for-anthos","migrate-for-compute-engine","my-cloud","network-connectivity-center","network-intelligence-center","network-security","network-tiers","network-topology","onboarding","os-configuration-man\
agement","os-inventory-management","os-patch-management","partner-interconnect","partner-portal","performance-dashboard","permissions","persistent-disk","phishing-protection","policy-analyzer","premium-network-tier","private-connectivity","private-service-connect","producer-portal","profiler","project","pub-sub","quantum-engine","quotas","real-world-insights","recommendations-ai","release-notes","retail-api","risk-manager","runtime-config","secret-manager","security-command-center","security-hea\
lth-advisor","security-key-enforcement","security","service-discovery","speech-to-text","stackdriver","standard-network-tier","stream-suite","support","tensorflow-enterprise","text-to-speech","tools-for-powershell","trace","traffic-director","transfer-appliance","transfer","user-preferences","vertex-ai","video-intelligence-api","virtual-private-cloud","visual-inspection","vmware-engine","web-risk","web-security-scanner","workflows","workload-identity-pool"],tech:["100tb","500px","aarch64","activ\
e-campaign-icon","active-campaign","adobe-after-effects","adobe-animate","adobe-dreamweaver","adobe-icon","adobe-illustrator","adobe-incopy","adobe-indesign","adobe-lightroom","adobe-photoshop","adobe-premiere-pro","adobe-premiere","adobe-xd","adobe","adonis-js","adonisjs-icon","adroll","adyen","aerogear","aerospike-icon","aerospike","after-effects","aha","airbnb-icon","airbnb","airbrake","airflow-icon","airflow","airtable","aix","akamai","akka","alfresco","algolia","alpinejs-icon","alpinejs","a\
ltair","amazon-chime","amazon-connect","amazon-web-services","amd","amex-digital","amex","amp-icon","amp","ampersand","amplication-icon","amplication","amplitude-icon","amplitude","anaconda","analog","android-icon","android-studio","android-vertical","android","angellist","angular-icon","angular-js","angular","ansible","ant-design","anthropic-icon","anthropic","apache-camel","apache-cloudstack","apache-flink-icon","apache-flink","apache-spark","apache-superset-icon","apache-superset","apache","a\
piary","apidog-icon","apidog","apl","apollostack","apostrophe","appbaseio-icon","appbaseio","appcelerator","appcenter-icon","appcenter","appcircle-icon","appcircle","appcode","appdynamics-icon","appdynamics","appium","apple-app-store","apple-pay","apple-safari","apple","applitools-icon","applitools","appsignal-icon","appsignal","apptentive","appveyor","appwrite-icon","appwrite","arangodb-icon","arangodb","arc","architect-icon","architect","archlinux","arduino","argo-icon","argo","argocd","arm","\
armory-icon","armory","asana-icon","asana","asciidoctor","assembla-icon","assembla","astro-icon","astro","astronomer","async-api-icon","async-api","atlassian","atom-icon","atom","atomic-icon","atomic","atomicojs-icon","atomicojs","aurelia","aurora","auth0-icon","auth0","authy","autodesk-maya","autodesk-shot-grid","autoit","autoprefixer","ava","awesome","awk","aws-amplify","aws-api-gateway","aws-app-mesh","aws-appflow","aws-appsync","aws-athena","aws-aurora","aws-backup","aws-batch","aws-certific\
ate-manager","aws-cloudformation","aws-cloudfront","aws-cloudsearch","aws-cloudtrail","aws-cloudwatch","aws-codebuild","aws-codecommit","aws-codedeploy","aws-codepipeline","aws-codestar","aws-cognito","aws-config","aws-documentdb","aws-dynamodb","aws-ec2","aws-ecs","aws-eks","aws-elastic-beanstalk","aws-elasticache","aws-elb","aws-eventbridge","aws-fargate","aws-glacier","aws-glue","aws-iam","aws-keyspaces","aws-kinesis","aws-kms","aws-lake-formation","aws-lambda","aws-lightsail","aws-mq","aws-m\
sk","aws-neptune","aws-open-search","aws-opsworks","aws-quicksight","aws-rds","aws-redshift","aws-route53","aws-s3","aws-secrets-manager","aws-ses","aws-shield","aws-sns","aws-sqs","aws-step-functions","aws-systems-manager","aws-timestream","aws-vpc","aws-waf","aws-xray","aws","axios","azios","azure-devops","azure-sql-database","azure","babel","backbone-icon","backbone-js","backbone","backerkit","baker-street","balena","ballerina","bamboo","basecamp-icon","basecamp","basekit","baseline","bash-ic\
on","bash","batch","beats","behance","bem-2","bem","bigpanda","bing","biomejs-icon","biomejs","bitbar","bitbucket","bitcoin","bitnami","bitrise-icon","bitrise","blender","blitzjs-icon","blitzjs","blocs","blogger","blossom","blueprint","bluesky","bluetooth","booqable-icon","booqable","bootstrap","bosun","botanalytics","bourbon","bower","box","brackets","brainjs","branch-icon","branch","brandfolder-icon","brandfolder","brave","braze-icon","braze","broadcom-icon","broadcom","broccoli","brotli","bro\
wserify-icon","browserify","browserling","browserslist","browserstack","browsersync","brunch","bubble-icon","bubble","buck","buddy","buffer","bugherd-icon","bugherd","bugsee","bugsnag","builder-io-icon","builder-io","buildkite-icon","buildkite","bulma","bun","bunny-net-icon","bunny-net","c","cachet","cairo-graphics","cake-php","cakephp-icon","calibre-icon","calibre","campaignmonitor-icon","campaignmonitor","canjs","canva","capacitor","capacitorjs-icon","capacitorjs","capistrano","carbide","carda\
no-icon","cardano","cassandra","cent-os","centos-icon","certbot","ceylon","chai","chalk","chargebee-icon","chargebee","chartjs","chef","chevereto","chroma","chromatic-icon","chromatic","chrome-web-store","chrome","cinder","circle-ci","cirrus-ci","cirrus","clarity","claude-icon","claude","clio-lang","clion","cljs","clojure-script","clojure","close","cloud9","cloudacademy-icon","cloudacademy","cloudcraft","cloudflare-icon","cloudflare-workers-icon","cloudflare-workers","cloudflare","cloudinary-ico\
n","cloudinary","cloudlinux","cmake","cobalt","cockpit","cocoapods","coda-icon","coda","codacy","code-igniter","code-pen","codeac","codebase","codebeat","codecademy","codeception","codeclimate-icon","codeclimate","codecov-icon","codecov","codefactor-icon","codefactor","codeigniter-icon","codepen-icon","codersrank-icon","codersrank","coderwall","codesandbox-icon","codesandbox","codesee-icon","codesee","codio","codium-icon","codium","coffee-script","commitizen","compass","componentkit","compose-mu\
ltiplatform","compose","composer","conan-io","concourse","concretecms-icon","concretecms","conda","confluence","consul","contao","contentful","convox-icon","convox","copyleft-pirate","copyleft","corda","cordova","cosmosdb","couchbase","couchdb-icon","couchdb","coursera","coveralls","cpanel","cplusplus","craftcms","crashlytics","crateio","create-react-app","createjs","crossplane-icon","crossplane","crucible","crystal","csharp","css3-official","css3","cssnext","cube-icon","cube","cucumber","curl",
"customerio-icon","customerio","cyclejs","cypress-icon","cypress","d3","d3js","dailydev-icon","dailydev","daisy-ui-icon","daisy-ui","danfo","dart","dashlane-icon","dashlane","data-grip","data-spell","data-station","database-labs","datadog-icon","datadog","datasette-icon","datasette","datocms-icon","datocms","dbeaver","dbt-icon","dbt","dcos-icon","dcos","debian","delighted-icon","delighted","deno","dependabot","deployhq-icon","deployhq","derby","descript-icon","descript","designernews","deviantar\
t-icon","deviantart","devicon","dgraph-icon","dgraph","dialogflow","digital-ocean-icon","digital-ocean","dimer","dinersclub","discord-icon","discord-js","discord","discourse-icon","discourse","discover","disqus","django-icon","django-rest","django","dockbit","docker-icon","docker","doctrine","docusaurus","dojo-icon","dojo-toolkit","dojo","dolt","dotnet","dovetail-icon","dovetail","dreamhost","dribbble-icon","dribbble","drift","drip","drizzle-icon","drizzle","drone-icon","drone","drools-icon","dr\
ools","dropbox","dropmark","dropwizard","dropzone","drupal-icon","drupal","duckduckgo","dynatrace-icon","dynatrace","dyndns","ebanx","eclipse-ceylon","eclipse-icon","eclipse-ide","eclipse-vert-x","eclipse","ecma","edgedb","edgio-icon","edgio","editorconfig","effect-icon","effect","effector","egghead","elasticbeats","elasticpath-icon","elasticpath","elasticsearch","electron","element","elemental-ui","elementary","eleventy-11ty","eleventy","elixir","ello","elm-classic","elm","elo","emacs-classic",
"emacs","embedded-c","embedly","ember-js","ember-tomster","ember","emmet","enact","engine-yard-icon","engine-yard","envato","envoy-icon","envoy","envoyer","eraser-icon","eraser","erlang","esbuild","esdoc","eslint-old","eslint","eta-icon","eta","etcd","ethereum-color","ethereum","ethers","ethnio","eventbrite-icon","eventbrite","eventsentry","evergreen-icon","evergreen","expo-icon","expo","express","fabric","facebook","faker","falcor","fast-api","fastapi-icon","fastify-icon","fastify","fastlane","\
fastly","fauna-icon","fauna","feathers","feathersjs","fedora","fetch","ffmpeg-icon","ffmpeg","figma","file-zilla","firebase-icon","firebase","firefox","flannel","flarum","flask","flat-ui","flattr-icon","flattr","fleep","flickr-icon","flickr","flight","floodio","flow","flowxo","floydhub","flutter","flux","fluxxor","fly-icon","fly","fogbugz-icon","fogbugz","fomo-icon","fomo","font-awesome","forestadmin-icon","forestadmin","forever","formkeep","fortran","foundation","foundationdb-icon","foundationd\
b","framer","framework7-icon","framework7","freebsd","freedcamp-icon","freedcamp","freedomdefined","fresh","frontapp","fsharp","fuchsia","galliumos","game-analytics-icon","game-analytics","ganache-icon","ganache","gatling","gatsby","gazebo","gcc","geekbot","geetest-icon","geetest","gentoo","getyourguide","ghost","giantswarm","gimp","gin","git-icon","git","gitboard","gitbook","github-actions","github-codespaces","github-copilot","github-icon","github-octocat","github","gitkraken","gitlab-icon","g\
itlab","gitpod","gitter","gitup","glamorous-icon","glamorous","gleam","glimmerjs","glint","glitch-icon","glitch","gnome-icon","gnome","gnu-emacs","gnu-net","gnu","gnupg-icon","gnupg","go-land","go","gocd","godot-engine","godot-icon","godot","gohorse","google-360suite","google-admob","google-ads","google-adsense","google-analytics","google-bard-icon","google-bard","google-calendar","google-cloud-functions","google-cloud-run","google-cloud","google-data-studio","google-developers","google-domains-\
icon","google-domains","google-drive","google-fit","google-gemini","google-gmail","google-home","google-icon","google-keep","google-maps","google-marketing-platform","google-meet","google-one","google-optimize","google-palm","google-pay","google-photos","google-play-console-icon","google-play-console","google-play-icon","google-play","google-search-console","google-tag-manager","google-workspace","google","gopher","gradio-icon","gradio","gradle","grafana","grails","grammarly-icon","grammarly","g\
raphene","graphql","grav","gravatar-icon","gravatar","graylog-icon","graylog","greensock-icon","greensock","gridsome-icon","gridsome","grommet","groovehq","groovy","grove","growth-book-icon","growth-book","grpc","grunt","gruntjs","gulp","gulpjs","gunicorn","gunjs","gusto","gwt","hack","hacker-one","hadoop","haiku-icon","haiku","haml","hanami","handlebars","hapi","hardhat-icon","hardhat","harness-icon","harness","harvester","hashicorp-icon","hashicorp-vault","hashicorp","hashnode-icon","hashnode",
"haskell-icon","haskell","hasura-icon","hasura","haxe","haxl","hbase","hcaptcha-icon","hcaptcha","headlessui-icon","headlessui","heap-icon","heap","helm","helpscout-icon","helpscout","hermes","heroku-icon","heroku-redis","heroku","hexo","hhvm","hibernate","highcharts","hipercard","homebrew","hono","hookstate","hootsuite-icon","hootsuite","hosted-graphite","hostgator-icon","hostgator","hotjar-icon","hotjar","houndci","html5-boilerplate","html5","htmx-icon","htmx","httpie-icon","httpie","hubspot",
"hugging-face-icon","hugging-face","huggy","hugo","humongous","hyper","hyperapp","ibm-spss-statistics","ibm","ie10","ieee","ietf","ifttt","imagemin","imba-icon","imba","immer-icon","immer","immutable","impala","importio-icon","importio","incident-icon","incident","infer","inferno","influxdb-icon","influxdb","ink","inkscape","insomnia","instagram-icon","instagram","intel","intellij-idea","intercom-icon","intercom","internet-computer-icon","internet-computer","internetexplorer","invision-icon","in\
vision","ionic-icon","ionic","ios","iron-icon","iron","itsalive-icon","itsalive","jade","jaeger","jamstack-icon","jamstack","jasmine","java","javascript","jcb","jeet","jekyll","jenkins","jest","jetbrains-icon","jetbrains-space-icon","jetbrains-space","jetbrains","jfrog","jhipster-icon","jhipster","jira-align","jira","joomla","jotai","jquery-mobile","jquery","jruby","jsbin","jsdelivr","jsdom","jsfiddle","json-ld","json-schema-icon","json-schema","json","jspm","jss","juju","jule","julia","junit","\
jupyter","jwt-icon","jwt","k3os","k3s","kafka-icon","kafka","kaggle","kaios","kallithea","karate","karma","katalon-icon","katalon","kde","keen","kemal","keras","keycdn-icon","keycdn","keydb-icon","keydb","keystonejs","khan-academy-icon","khan-academy","kibana","kickstarter-icon","kickstarter","kinto-icon","kinto","kirby-icon","kirby","knex-js","knex","knockout","koa","kong-icon","kong","kops","koreio","kotlin-icon","kotlin","kraken","krakenjs","ktor-icon","ktor","kubernetes","kustomer","labview",
"languagetool","laravel","lastfm","lateral-icon","lateral","latex","launchdarkly-icon","launchdarkly","launchrock","leaflet","leankit-icon","leankit","lerna","less-js","less","lets-cloud","letsencrypt","leveldb","lexical-icon","lexical","liftweb","lighthouse","lightstep-icon","lightstep","lighttpd","linear-icon","linear","linkedin-icon","linkedin","linkerd","linode","linux-mint","linux-tux","linux","liquibase","lit-icon","lit","litmus","livewire","llvm","loader","lodash","logentries","logstash",
"lookback","looker-icon","looker","loom-icon","loom","loopback-icon","loopback","losant","lua","lucene-net","lucene","lumen","mac-os","madge","maestro","mageia","magento","mailchimp-freddie","mailchimp","maildeveloper","mailgun-icon","mailgun","mailjet-icon","mailjet","malinajs","manjaro","mantine-icon","mantine","mapbox-icon","mapbox","maps-me","mapzen-icon","mapzen","mariadb-icon","mariadb","marionette","markdown","marko","marvel","mastercard","mastodon-icon","mastodon","material-ui","material\
ize","materializecss","matlab","matomo-icon","matomo","matplotlib-icon","matplotlib","matter-icon","matter","mattermost-icon","mattermost","mautic-icon","mautic","maven","mdn","mdx","medium-icon","medium","medusa-icon","medusa","meilisearch","memcached","memgraph","mention","mercurial","mesos","messenger","meta-icon","meta","metabase","metamask-icon","metamask","meteor-icon","meteor-js","meteor","micro-icon","micro-python","micro","microcosm","micron-icon","micron","microsoft-azure","microsoft-e\
dge","microsoft-icon","microsoft-onedrive","microsoft-power-bi","microsoft-sql-server","microsoft-teams","microsoft-windows-icon","microsoft-windows","microsoft","mida-icon","mida","middleman","midjourney","milligram","million-icon","million","milvus-icon","milvus","mindsdb-icon","mindsdb","minitab","mint-lang","mio","miro-icon","miro","mist","mistral-ai-icon","mistral-ai","mithril","mixmax","mixpanel","mlab","mob-x","mocha","mockflow-icon","mockflow","modernizr","modx-icon","modx","moleculer","\
momentjs","monday-icon","monday","monero","mongodb-icon","mongodb","mongoose-js","mono","moodle","moon","mootools","morpheus-icon","morpheus","mozilla","mparticle-icon","mparticle","mps-icon","mps","ms-dos","msw-icon","msw","multipass","mysql-icon","mysql","naiveui","namecheap","nano","nanonets","nasm","nativescript","nats-icon","nats","neat","neo4j","neon-icon","neon","neovim","nerog","nestjs","net-core","net","netbeans","netflix-icon","netflix","netlify-icon","netlify","network-x","neverinstal\
l-icon","neverinstall","new-relic-icon","new-relic","new4j","nextjs-icon","nextjs","nginx","ngrok","nhibernate","nhost-icon","nhost","nightwatch","nim-lang","nim","nimble","nix","nocodb","nodal","node-sass","nodebots","nodejs-icon-alt","nodejs-icon","nodejs","nodemon","nodeos","nodewebkit","nomad-icon","nomad","notion-icon","notion","noysi","npm-icon","npm","nuclide","nuget","num-py","nuxt-icon","nuxt-js","nuxt","nvidia","nvm","nx","oauth","objective-c","observablehq","obsidian-icon","obsidian",
"ocaml","octodns","octopus-deploy","oh-my-zsh","okta-icon","okta","olark","onesignal","open-al","open-api","open-cl","open-cv","open-gl","open-graph","open-stack","open-suse","open-telemetry","open-zeppelin-icon","open-zeppelin","openai-icon","openai","openapi-icon","opencart","opencollective","openframeworks","openjs-foundation-icon","openjs-foundation","openlayers","opensearch-icon","opensearch","openshift","opensource","openstack-icon","opentelemetry-icon","opera","opsgenie","optimizely-icon",
"optimizely","oracle","oreilly","origami","origin","oshw","osquery","overloop-icon","overloop","p5js","packer","pagekit","pagekite","pagerduty-icon","pagerduty","panda","pandacss-icon","pandacss","pandas-icon","pandas","parcel-icon","parcel","parse","parsehub","partytown-icon","partytown","passbolt-icon","passbolt","passport","patreon","payload","paypal","peer5","pepperoni","percona","percy-icon","percy","perf-rocks","perl","perplexity-icon","perplexity","pf-sense","phalcon","phoenix-framework",
"phoenix","photon-engine","php-alt","php-storm","php","pinecone-icon","pinecone","pinia","pinterest","pipedream","pipedrive","pipefy","pivotal-tracker","pixijs","pkg","planetscale","planless-icon","planless","plasmic","plastic-scm","platformio","play","playwright","playwrite","ploty","pluralsight-icon","pluralsight","pm2-icon","pm2","pnpm","pocket-base","podman","poeditor","polygon","polymer","portainer","postcss","postgraphile","postgresql","posthog-icon","posthog","postman-icon","postman","pou\
chdb","powershell","preact","precursor","prerender-icon","prerender","prestashop-icon","prestashop","presto-icon","presto","prettier","prisma","prismic-icon","prismic","processing","processwire-icon","processwire","productboard-icon","productboard","producthunt","progress","prometheus","promises","proofy","protoio","protonet","protractor","prott","pug","pulumi-icon","pulumi","pumpkindb","puppet-icon","puppet","puppeteer","purescript-icon","purescript","pushbullet","pusher-icon","pusher","putty",
"pwa","pycharm","pypi","pyscript","pytest","python-poetry","python","pytorch-icon","pytorch","pyup","q","qdrant-icon","qdrant","qlik","qodana","qt","qualcomm","quarkus-icon","quarkus","quasar","quay","quobyte","quora","qwik-icon","qwik","r-lang","r","rabbitmq-icon","rabbitmq","rackspace-icon","rackspace","rails","ramda","raml","rancher-icon","rancher","raphael","raspberry-pi","rax","reach","react-bootstrap","react-query-icon","react-query","react-router","react-spring","react-styleguidist","reac\
t","reactivex","realm","reapp","reasonml-icon","reasonml","recaptcha","recoil-icon","recoil","red-cube-s-epic-compiler-thingy-programming-re-ct","reddit-icon","reddit","redhat-icon","redhat","redis","redsmin","redux-observable","redux-saga","redux","redwoodjs","reindex","relay","release","remix-icon","remix","ren-py","renovatebot","replay-icon","replay","replit-icon","replit","require","rescript-icon","rescript","rest-li","rethinkdb","retool-icon","retool","riak","rider","riot","risingwave-icon",
"risingwave","robot-operating-system-ros","rocket-chat-icon","rocket-chat","rocksdb","rocky-linux-icon","rocky-linux","rollbar-icon","rollbar","rollupjs","rome-icon","rome","ros","rsa","rsmq","rspec","rstudio","rubocop","ruby-mine","ruby-on-rails","ruby","rubygems","rum","runscope","rush-icon","rush","rust","rxdb","safari","sagui","sails","salesforce","sameroom","samsung","sanity","sap","sass-doc","sass","saucelabs","scala","scaledrone","scalingo","scribd-icon","scribd","sdl","seaborn-icon","sea\
born","section-icon","section","segment-icon","segment","selenium","sema-software","semantic-release","semantic-ui","semaphoreci","sencha","sendgrid-icon","sendgrid","seneca","sensu-icon","sensu","sentry-icon","sentry","sequelize","serverless","sherlock-icon","sherlock","shields","shipit","shogun","shopify","shopware","shortcut-icon","shortcut","sidekiq-icon","sidekiq","signal","sigstore-icon","sigstore","sinatra","singlestore-icon","singlestore","sitepoint","sk-hynix","skaffolder","sketch","sky\
light","skype","slack-icon","slack","slides","slidev","slim","smartling","smashingmagazine","snap-svg","snaplet-icon","snaplet","snowflake-icon","snowflake","snowpack","snyk","socket-io","solarwinds","solid","solidity","solidjs-icon","solidjs","solr","sonarcloud-icon","sonarcloud","sonarlint-icon","sonarlint","sonarqube","soundcloud","sourcegraph","sourcetree","spark","sparkpost","speakerdeck","speedcurve","spidermonkey-icon","spidermonkey","spinnaker","splunk","spotify-icon","spotify","spree","\
spring-icon","spring","sql-developer","sqlalchemy","sqlite","square","squarespace","ssh","sst-icon","sst","stability-ai-icon","stability-ai","stackbit-icon","stackbit","stackblitz-icon","stackblitz","stackoverflow-icon","stackoverflow","stackshare","stata","stately-icon","stately","statuspage","stdlib-icon","stdlib","steam","stenciljs-icon","stenciljs","stetho","stickermule","stigg-icon","stigg","stimulus-icon","stimulus","stitch","stoplight","storyblocks-icon","storyblocks","storyblok-icon","st\
oryblok","storybook-icon","storybook","strapi-icon","strapi","streamlit","strider","stripe","struts","styleci","stylefmt","stylelint","stylis","stylus","stytch","sublimetext-icon","sublimetext","subversion","sugarss","supabase-icon","supabase","supertokens-icon","supertokens","surge","surrealdb-icon","surrealdb","survicate-icon","survicate","suse","susy","svelte-icon","svelte-kit","svelte","svg","svgator","swagger","swc","swift","swiftype","swimm","swr","symfony","sysdig-icon","sysdig","t3","tab\
leau-icon","tableau","taiga","tailwindcss-icon","tailwindcss","tapcart-icon","tapcart","taskade-icon","taskade","tastejs","tauri","tealium","teamcity","teamgrid","teamwork-icon","teamwork","telegram","tensorflow","terminal","terraform-icon","terraform","terser-icon","terser","testcafe","testing-library","testlodge","tex","the-algorithms","threejs","thymeleaf-icon","thymeleaf","tidal-icon","tidal","tiktok-icon","tiktok","titanium-sdk","tnw","todoist-icon","todoist","todomvc","tomcat","toml","tor-\
browser","tor","tortoise-git","tower","traackr","trac","traefik-mesh","traefik-proxy","travis-ci-monochrome","travis-ci","treasuredata-icon","treasuredata","treehouse-icon","treehouse","trello","trpc","truffle-icon","truffle","tsmc","tsnode","tsuru","tumblr-icon","tumblr","tunein","tuple","turbopack-icon","turbopack","turborepo-icon","turborepo","turret","twilio-icon","twilio","twitch","twitter","typeform-icon","typeform","typeorm","typescript-icon-round","typescript-icon","typescript","typesens\
e-icon","typesense","typo3-icon","typo3","ubuntu","udacity-icon","udacity","udemy-icon","udemy","uikit","uml","umu","unbounce-icon","unbounce","undertow","unionpay","unitjs","unito-icon","unito","unity","unix","unjs","unocss","unrealengine-icon","unrealengine","upcase","upstash-icon","upstash","upwork","user-testing-icon","user-testing","uservoice-icon","uservoice","uwsgi","v8-ignition","v8-turbofan","v8","vaadin","vaddy","vagrant-icon","vagrant","vala","vault-icon","vault","vector","vercel-icon",
"vercel","verdaccio-icon","verdaccio","vernemq","veutify","vim","vimeo-icon","vimeo","visa","visaelectron","visual-studio-code","visual-studio","vite","vitejs","vitess","vitest","vivaldi-icon","vivaldi","vlang","vmware","void","volar","vorejs","vscode","vsphere","vue-storefront","vue","vuetifyjs","vueuse","vulkan","vultr-icon","vultr","vwo","vyper","w3c","waffle-icon","waffle","wagtail","wakatime","walkme","watchman","waypoint-icon","waypoint","wayscript-icon","wayscript","wearos","weave","web-d\
ev-icon","web-dev","web3js","webassembly","webcomponents","webdriverio","webflow","webgpu","webhint-icon","webhint","webhooks","webix-icon","webix","webkit","weblate","webmin","webpack","webplatform","webrtc","websocket","webstorm","webtorrent","weebly","whalar-icon","whalar","whatsapp-icon","whatsapp-monochrome-icon","whatsapp","whatwg","wicket-icon","wicket","wifi","wildfly","windi-css","windows11","windows8","winglang-icon","winglang","wire","wix","wmr","woo-commerce","woocommerce-icon","woop\
ra","wordpress-icon-alt","wordpress-icon","wordpress","workboard","workos-icon","workos","workplace-icon","workplace","wpengine","wufoo","x","xamarin","xampp","xata-icon","xata","xcart","xcode","xero","xml","xray-for-jira","xstate","xtend","xwiki-icon","xwiki","yahoo","yaml","yammer","yandex-ru","yarn","ycombinator","yeoman","yii-framework","yii","youtrack","youtube-icon","youtube","yugabyte-icon","yugabyte","yuno-host","zabbix","zapier","zend-framework","zendesk-icon","zendesk","zenhub-icon","z\
enhub","zeplin","zeroheight-icon","zeroheight","zig","zod","zoho","zoom-icon","zoom","zorin-os","zsh","zube","zulip-icon","zulip","zwave"],bootstrap:["0-circle-fill","0-circle","0-square-fill","0-square","1-circle-fill","1-circle","1-square-fill","1-square","123","2-circle-fill","2-circle","2-square-fill","2-square","3-circle-fill","3-circle","3-square-fill","3-square","4-circle-fill","4-circle","4-square-fill","4-square","5-circle-fill","5-circle","5-square-fill","5-square","6-circle-fill","6-c\
ircle","6-square-fill","6-square","7-circle-fill","7-circle","7-square-fill","7-square","8-circle-fill","8-circle","8-square-fill","8-square","9-circle-fill","9-circle","9-square-fill","9-square","activity","airplane-engines-fill","airplane-engines","airplane-fill","airplane","alarm-fill","alarm","alexa","align-bottom","align-center","align-end","align-middle","align-start","align-top","alipay","alphabet-uppercase","alphabet","alt","amazon","amd","android","android2","app-indicator","app","apple",
"archive-fill","archive","arrow-90deg-down","arrow-90deg-left","arrow-90deg-right","arrow-90deg-up","arrow-bar-down","arrow-bar-left","arrow-bar-right","arrow-bar-up","arrow-clockwise","arrow-counterclockwise","arrow-down-circle-fill","arrow-down-circle","arrow-down-left-circle-fill","arrow-down-left-circle","arrow-down-left-square-fill","arrow-down-left-square","arrow-down-left","arrow-down-right-circle-fill","arrow-down-right-circle","arrow-down-right-square-fill","arrow-down-right-square","ar\
row-down-right","arrow-down-short","arrow-down-square-fill","arrow-down-square","arrow-down-up","arrow-down","arrow-left-circle-fill","arrow-left-circle","arrow-left-right","arrow-left-short","arrow-left-square-fill","arrow-left-square","arrow-left","arrow-repeat","arrow-return-left","arrow-return-right","arrow-right-circle-fill","arrow-right-circle","arrow-right-short","arrow-right-square-fill","arrow-right-square","arrow-right","arrow-through-heart-fill","arrow-through-heart","arrow-up-circle-\
fill","arrow-up-circle","arrow-up-left-circle-fill","arrow-up-left-circle","arrow-up-left-square-fill","arrow-up-left-square","arrow-up-left","arrow-up-right-circle-fill","arrow-up-right-circle","arrow-up-right-square-fill","arrow-up-right-square","arrow-up-right","arrow-up-short","arrow-up-square-fill","arrow-up-square","arrow-up","arrows-angle-contract","arrows-angle-expand","arrows-collapse-vertical","arrows-collapse","arrows-expand-vertical","arrows-expand","arrows-fullscreen","arrows-move",
"arrows-vertical","arrows","aspect-ratio-fill","aspect-ratio","asterisk","at","award-fill","award","back","backpack-fill","backpack","backpack2-fill","backpack2","backpack3-fill","backpack3","backpack4-fill","backpack4","backspace-fill","backspace-reverse-fill","backspace-reverse","backspace","badge-3d-fill","badge-3d","badge-4k-fill","badge-4k","badge-8k-fill","badge-8k","badge-ad-fill","badge-ad","badge-ar-fill","badge-ar","badge-cc-fill","badge-cc","badge-hd-fill","badge-hd","badge-sd-fill","\
badge-sd","badge-tm-fill","badge-tm","badge-vo-fill","badge-vo","badge-vr-fill","badge-vr","badge-wc-fill","badge-wc","bag-check-fill","bag-check","bag-dash-fill","bag-dash","bag-fill","bag-heart-fill","bag-heart","bag-plus-fill","bag-plus","bag-x-fill","bag-x","bag","balloon-fill","balloon-heart-fill","balloon-heart","balloon","ban-fill","ban","bandaid-fill","bandaid","bank","bank2","bar-chart-fill","bar-chart-line-fill","bar-chart-line","bar-chart-steps","bar-chart","basket-fill","basket","bas\
ket2-fill","basket2","basket3-fill","basket3","battery-charging","battery-full","battery-half","battery","behance","bell-fill","bell-slash-fill","bell-slash","bell","bezier","bezier2","bicycle","bing","binoculars-fill","binoculars","blockquote-left","blockquote-right","bluetooth","body-text","book-fill","book-half","book","bookmark-check-fill","bookmark-check","bookmark-dash-fill","bookmark-dash","bookmark-fill","bookmark-heart-fill","bookmark-heart","bookmark-plus-fill","bookmark-plus","bookmar\
k-star-fill","bookmark-star","bookmark-x-fill","bookmark-x","bookmark","bookmarks-fill","bookmarks","bookshelf","boombox-fill","boombox","bootstrap-fill","bootstrap-icons","bootstrap-reboot","bootstrap","border-all","border-bottom","border-center","border-inner","border-left","border-middle","border-outer","border-right","border-style","border-top","border-width","border","bounding-box-circles","bounding-box","box-arrow-down-left","box-arrow-down-right","box-arrow-down","box-arrow-in-down-left",
"box-arrow-in-down-right","box-arrow-in-down","box-arrow-in-left","box-arrow-in-right","box-arrow-in-up-left","box-arrow-in-up-right","box-arrow-in-up","box-arrow-left","box-arrow-right","box-arrow-up-left","box-arrow-up-right","box-arrow-up","box-fill","box-seam-fill","box-seam","box","box2-fill","box2-heart-fill","box2-heart","box2","boxes","braces-asterisk","braces","bricks","briefcase-fill","briefcase","brightness-alt-high-fill","brightness-alt-high","brightness-alt-low-fill","brightness-alt\
-low","brightness-high-fill","brightness-high","brightness-low-fill","brightness-low","brilliance","broadcast-pin","broadcast","browser-chrome","browser-edge","browser-firefox","browser-safari","brush-fill","brush","bucket-fill","bucket","bug-fill","bug","building-add","building-check","building-dash","building-down","building-exclamation","building-fill-add","building-fill-check","building-fill-dash","building-fill-down","building-fill-exclamation","building-fill-gear","building-fill-lock","bui\
lding-fill-slash","building-fill-up","building-fill-x","building-fill","building-gear","building-lock","building-slash","building-up","building-x","building","buildings-fill","buildings","bullseye","bus-front-fill","bus-front","c-circle-fill","c-circle","c-square-fill","c-square","cake-fill","cake","cake2-fill","cake2","calculator-fill","calculator","calendar-check-fill","calendar-check","calendar-date-fill","calendar-date","calendar-day-fill","calendar-day","calendar-event-fill","calendar-event",
"calendar-fill","calendar-heart-fill","calendar-heart","calendar-minus-fill","calendar-minus","calendar-month-fill","calendar-month","calendar-plus-fill","calendar-plus","calendar-range-fill","calendar-range","calendar-week-fill","calendar-week","calendar-x-fill","calendar-x","calendar","calendar2-check-fill","calendar2-check","calendar2-date-fill","calendar2-date","calendar2-day-fill","calendar2-day","calendar2-event-fill","calendar2-event","calendar2-fill","calendar2-heart-fill","calendar2-hea\
rt","calendar2-minus-fill","calendar2-minus","calendar2-month-fill","calendar2-month","calendar2-plus-fill","calendar2-plus","calendar2-range-fill","calendar2-range","calendar2-week-fill","calendar2-week","calendar2-x-fill","calendar2-x","calendar2","calendar3-event-fill","calendar3-event","calendar3-fill","calendar3-range-fill","calendar3-range","calendar3-week-fill","calendar3-week","calendar3","calendar4-event","calendar4-range","calendar4-week","calendar4","camera-fill","camera-reels-fill","\
camera-reels","camera-video-fill","camera-video-off-fill","camera-video-off","camera-video","camera","camera2","capslock-fill","capslock","capsule-pill","capsule","car-front-fill","car-front","card-checklist","card-heading","card-image","card-list","card-text","caret-down-fill","caret-down-square-fill","caret-down-square","caret-down","caret-left-fill","caret-left-square-fill","caret-left-square","caret-left","caret-right-fill","caret-right-square-fill","caret-right-square","caret-right","caret-\
up-fill","caret-up-square-fill","caret-up-square","caret-up","cart-check-fill","cart-check","cart-dash-fill","cart-dash","cart-fill","cart-plus-fill","cart-plus","cart-x-fill","cart-x","cart","cart2","cart3","cart4","cash-coin","cash-stack","cash","cassette-fill","cassette","cast","cc-circle-fill","cc-circle","cc-square-fill","cc-square","chat-dots-fill","chat-dots","chat-fill","chat-heart-fill","chat-heart","chat-left-dots-fill","chat-left-dots","chat-left-fill","chat-left-heart-fill","chat-lef\
t-heart","chat-left-quote-fill","chat-left-quote","chat-left-text-fill","chat-left-text","chat-left","chat-quote-fill","chat-quote","chat-right-dots-fill","chat-right-dots","chat-right-fill","chat-right-heart-fill","chat-right-heart","chat-right-quote-fill","chat-right-quote","chat-right-text-fill","chat-right-text","chat-right","chat-square-dots-fill","chat-square-dots","chat-square-fill","chat-square-heart-fill","chat-square-heart","chat-square-quote-fill","chat-square-quote","chat-square-text\
-fill","chat-square-text","chat-square","chat-text-fill","chat-text","chat","check-all","check-circle-fill","check-circle","check-lg","check-square-fill","check-square","check","check2-all","check2-circle","check2-square","check2","chevron-bar-contract","chevron-bar-down","chevron-bar-expand","chevron-bar-left","chevron-bar-right","chevron-bar-up","chevron-compact-down","chevron-compact-left","chevron-compact-right","chevron-compact-up","chevron-contract","chevron-double-down","chevron-double-le\
ft","chevron-double-right","chevron-double-up","chevron-down","chevron-expand","chevron-left","chevron-right","chevron-up","circle-fill","circle-half","circle-square","circle","clipboard-check-fill","clipboard-check","clipboard-data-fill","clipboard-data","clipboard-fill","clipboard-heart-fill","clipboard-heart","clipboard-minus-fill","clipboard-minus","clipboard-plus-fill","clipboard-plus","clipboard-pulse","clipboard-x-fill","clipboard-x","clipboard","clipboard2-check-fill","clipboard2-check",
"clipboard2-data-fill","clipboard2-data","clipboard2-fill","clipboard2-heart-fill","clipboard2-heart","clipboard2-minus-fill","clipboard2-minus","clipboard2-plus-fill","clipboard2-plus","clipboard2-pulse-fill","clipboard2-pulse","clipboard2-x-fill","clipboard2-x","clipboard2","clock-fill","clock-history","clock","cloud-arrow-down-fill","cloud-arrow-down","cloud-arrow-up-fill","cloud-arrow-up","cloud-check-fill","cloud-check","cloud-download-fill","cloud-download","cloud-drizzle-fill","cloud-driz\
zle","cloud-fill","cloud-fog-fill","cloud-fog","cloud-fog2-fill","cloud-fog2","cloud-hail-fill","cloud-hail","cloud-haze-fill","cloud-haze","cloud-haze2-fill","cloud-haze2","cloud-lightning-fill","cloud-lightning-rain-fill","cloud-lightning-rain","cloud-lightning","cloud-minus-fill","cloud-minus","cloud-moon-fill","cloud-moon","cloud-plus-fill","cloud-plus","cloud-rain-fill","cloud-rain-heavy-fill","cloud-rain-heavy","cloud-rain","cloud-slash-fill","cloud-slash","cloud-sleet-fill","cloud-sleet",
"cloud-snow-fill","cloud-snow","cloud-sun-fill","cloud-sun","cloud-upload-fill","cloud-upload","cloud","clouds-fill","clouds","cloudy-fill","cloudy","code-slash","code-square","code","coin","collection-fill","collection-play-fill","collection-play","collection","columns-gap","columns","command","compass-fill","compass","cone-striped","cone","controller","cookie","copy","cpu-fill","cpu","credit-card-2-back-fill","credit-card-2-back","credit-card-2-front-fill","credit-card-2-front","credit-card-fi\
ll","credit-card","crop","crosshair","crosshair2","cup-fill","cup-hot-fill","cup-hot","cup-straw","cup","currency-bitcoin","currency-dollar","currency-euro","currency-exchange","currency-pound","currency-rupee","currency-yen","cursor-fill","cursor-text","cursor","dash-circle-dotted","dash-circle-fill","dash-circle","dash-lg","dash-square-dotted","dash-square-fill","dash-square","dash","database-add","database-check","database-dash","database-down","database-exclamation","database-fill-add","data\
base-fill-check","database-fill-dash","database-fill-down","database-fill-exclamation","database-fill-gear","database-fill-lock","database-fill-slash","database-fill-up","database-fill-x","database-fill","database-gear","database-lock","database-slash","database-up","database-x","database","device-hdd-fill","device-hdd","device-ssd-fill","device-ssd","diagram-2-fill","diagram-2","diagram-3-fill","diagram-3","diamond-fill","diamond-half","diamond","dice-1-fill","dice-1","dice-2-fill","dice-2","di\
ce-3-fill","dice-3","dice-4-fill","dice-4","dice-5-fill","dice-5","dice-6-fill","dice-6","disc-fill","disc","discord","display-fill","display","displayport-fill","displayport","distribute-horizontal","distribute-vertical","door-closed-fill","door-closed","door-open-fill","door-open","dot","download","dpad-fill","dpad","dribbble","dropbox","droplet-fill","droplet-half","droplet","duffle-fill","duffle","ear-fill","ear","earbuds","easel-fill","easel","easel2-fill","easel2","easel3-fill","easel3","e\
gg-fill","egg-fried","egg","eject-fill","eject","emoji-angry-fill","emoji-angry","emoji-astonished-fill","emoji-astonished","emoji-dizzy-fill","emoji-dizzy","emoji-expressionless-fill","emoji-expressionless","emoji-frown-fill","emoji-frown","emoji-grimace-fill","emoji-grimace","emoji-grin-fill","emoji-grin","emoji-heart-eyes-fill","emoji-heart-eyes","emoji-kiss-fill","emoji-kiss","emoji-laughing-fill","emoji-laughing","emoji-neutral-fill","emoji-neutral","emoji-smile-fill","emoji-smile-upside-do\
wn-fill","emoji-smile-upside-down","emoji-smile","emoji-sunglasses-fill","emoji-sunglasses","emoji-surprise-fill","emoji-surprise","emoji-tear-fill","emoji-tear","emoji-wink-fill","emoji-wink","envelope-arrow-down-fill","envelope-arrow-down","envelope-arrow-up-fill","envelope-arrow-up","envelope-at-fill","envelope-at","envelope-check-fill","envelope-check","envelope-dash-fill","envelope-dash","envelope-exclamation-fill","envelope-exclamation","envelope-fill","envelope-heart-fill","envelope-heart",
"envelope-open-fill","envelope-open-heart-fill","envelope-open-heart","envelope-open","envelope-paper-fill","envelope-paper-heart-fill","envelope-paper-heart","envelope-paper","envelope-plus-fill","envelope-plus","envelope-slash-fill","envelope-slash","envelope-x-fill","envelope-x","envelope","eraser-fill","eraser","escape","ethernet","ev-front-fill","ev-front","ev-station-fill","ev-station","exclamation-circle-fill","exclamation-circle","exclamation-diamond-fill","exclamation-diamond","exclamat\
ion-lg","exclamation-octagon-fill","exclamation-octagon","exclamation-square-fill","exclamation-square","exclamation-triangle-fill","exclamation-triangle","exclamation","exclude","explicit-fill","explicit","exposure","eye-fill","eye-slash-fill","eye-slash","eye","eyedropper","eyeglasses","facebook","fan","fast-forward-btn-fill","fast-forward-btn","fast-forward-circle-fill","fast-forward-circle","fast-forward-fill","fast-forward","feather","feather2","file-arrow-down-fill","file-arrow-down","file\
-arrow-up-fill","file-arrow-up","file-bar-graph-fill","file-bar-graph","file-binary-fill","file-binary","file-break-fill","file-break","file-check-fill","file-check","file-code-fill","file-code","file-diff-fill","file-diff","file-earmark-arrow-down-fill","file-earmark-arrow-down","file-earmark-arrow-up-fill","file-earmark-arrow-up","file-earmark-bar-graph-fill","file-earmark-bar-graph","file-earmark-binary-fill","file-earmark-binary","file-earmark-break-fill","file-earmark-break","file-earmark-c\
heck-fill","file-earmark-check","file-earmark-code-fill","file-earmark-code","file-earmark-diff-fill","file-earmark-diff","file-earmark-easel-fill","file-earmark-easel","file-earmark-excel-fill","file-earmark-excel","file-earmark-fill","file-earmark-font-fill","file-earmark-font","file-earmark-image-fill","file-earmark-image","file-earmark-lock-fill","file-earmark-lock","file-earmark-lock2-fill","file-earmark-lock2","file-earmark-medical-fill","file-earmark-medical","file-earmark-minus-fill","fi\
le-earmark-minus","file-earmark-music-fill","file-earmark-music","file-earmark-pdf-fill","file-earmark-pdf","file-earmark-person-fill","file-earmark-person","file-earmark-play-fill","file-earmark-play","file-earmark-plus-fill","file-earmark-plus","file-earmark-post-fill","file-earmark-post","file-earmark-ppt-fill","file-earmark-ppt","file-earmark-richtext-fill","file-earmark-richtext","file-earmark-ruled-fill","file-earmark-ruled","file-earmark-slides-fill","file-earmark-slides","file-earmark-sp\
readsheet-fill","file-earmark-spreadsheet","file-earmark-text-fill","file-earmark-text","file-earmark-word-fill","file-earmark-word","file-earmark-x-fill","file-earmark-x","file-earmark-zip-fill","file-earmark-zip","file-earmark","file-easel-fill","file-easel","file-excel-fill","file-excel","file-fill","file-font-fill","file-font","file-image-fill","file-image","file-lock-fill","file-lock","file-lock2-fill","file-lock2","file-medical-fill","file-medical","file-minus-fill","file-minus","file-musi\
c-fill","file-music","file-pdf-fill","file-pdf","file-person-fill","file-person","file-play-fill","file-play","file-plus-fill","file-plus","file-post-fill","file-post","file-ppt-fill","file-ppt","file-richtext-fill","file-richtext","file-ruled-fill","file-ruled","file-slides-fill","file-slides","file-spreadsheet-fill","file-spreadsheet","file-text-fill","file-text","file-word-fill","file-word","file-x-fill","file-x","file-zip-fill","file-zip","file","files-alt","files","filetype-aac","filetype-a\
i","filetype-bmp","filetype-cs","filetype-css","filetype-csv","filetype-doc","filetype-docx","filetype-exe","filetype-gif","filetype-heic","filetype-html","filetype-java","filetype-jpg","filetype-js","filetype-json","filetype-jsx","filetype-key","filetype-m4p","filetype-md","filetype-mdx","filetype-mov","filetype-mp3","filetype-mp4","filetype-otf","filetype-pdf","filetype-php","filetype-png","filetype-ppt","filetype-pptx","filetype-psd","filetype-py","filetype-raw","filetype-rb","filetype-sass",
"filetype-scss","filetype-sh","filetype-sql","filetype-svg","filetype-tiff","filetype-tsx","filetype-ttf","filetype-txt","filetype-wav","filetype-woff","filetype-xls","filetype-xlsx","filetype-xml","filetype-yml","film","filter-circle-fill","filter-circle","filter-left","filter-right","filter-square-fill","filter-square","filter","fingerprint","fire","flag-fill","flag","floppy-fill","floppy","floppy2-fill","floppy2","flower1","flower2","flower3","folder-check","folder-fill","folder-minus","folde\
r-plus","folder-symlink-fill","folder-symlink","folder-x","folder","folder2-open","folder2","fonts","forward-fill","forward","front","fuel-pump-diesel-fill","fuel-pump-diesel","fuel-pump-fill","fuel-pump","fullscreen-exit","fullscreen","funnel-fill","funnel","gear-fill","gear-wide-connected","gear-wide","gear","gem","gender-ambiguous","gender-female","gender-male","gender-neuter","gender-trans","geo-alt-fill","geo-alt","geo-fill","geo","gift-fill","gift","git","github","gitlab","globe-americas",
"globe-asia-australia","globe-central-south-asia","globe-europe-africa","globe","globe2","google-play","google","gpu-card","graph-down-arrow","graph-down","graph-up-arrow","graph-up","grid-1x2-fill","grid-1x2","grid-3x2-gap-fill","grid-3x2-gap","grid-3x2","grid-3x3-gap-fill","grid-3x3-gap","grid-3x3","grid-fill","grid","grip-horizontal","grip-vertical","h-circle-fill","h-circle","h-square-fill","h-square","hammer","hand-index-fill","hand-index-thumb-fill","hand-index-thumb","hand-index","hand-th\
umbs-down-fill","hand-thumbs-down","hand-thumbs-up-fill","hand-thumbs-up","handbag-fill","handbag","hash","hdd-fill","hdd-network-fill","hdd-network","hdd-rack-fill","hdd-rack","hdd-stack-fill","hdd-stack","hdd","hdmi-fill","hdmi","headphones","headset-vr","headset","heart-arrow","heart-fill","heart-half","heart-pulse-fill","heart-pulse","heart","heartbreak-fill","heartbreak","hearts","heptagon-fill","heptagon-half","heptagon","hexagon-fill","hexagon-half","hexagon","highlighter","highlights","h\
ospital-fill","hospital","hourglass-bottom","hourglass-split","hourglass-top","hourglass","house-add-fill","house-add","house-check-fill","house-check","house-dash-fill","house-dash","house-door-fill","house-door","house-down-fill","house-down","house-exclamation-fill","house-exclamation","house-fill","house-gear-fill","house-gear","house-heart-fill","house-heart","house-lock-fill","house-lock","house-slash-fill","house-slash","house-up-fill","house-up","house-x-fill","house-x","house","houses-f\
ill","houses","hr","hurricane","hypnotize","image-alt","image-fill","image","images","inbox-fill","inbox","inboxes-fill","inboxes","incognito","indent","infinity","info-circle-fill","info-circle","info-lg","info-square-fill","info-square","info","input-cursor-text","input-cursor","instagram","intersect","journal-album","journal-arrow-down","journal-arrow-up","journal-bookmark-fill","journal-bookmark","journal-check","journal-code","journal-medical","journal-minus","journal-plus","journal-richtex\
t","journal-text","journal-x","journal","journals","joystick","justify-left","justify-right","justify","kanban-fill","kanban","key-fill","key","keyboard-fill","keyboard","ladder","lamp-fill","lamp","laptop-fill","laptop","layer-backward","layer-forward","layers-fill","layers-half","layers","layout-sidebar-inset-reverse","layout-sidebar-inset","layout-sidebar-reverse","layout-sidebar","layout-split","layout-text-sidebar-reverse","layout-text-sidebar","layout-text-window-reverse","layout-text-wind\
ow","layout-three-columns","layout-wtf","life-preserver","lightbulb-fill","lightbulb-off-fill","lightbulb-off","lightbulb","lightning-charge-fill","lightning-charge","lightning-fill","lightning","line","link-45deg","link","linkedin","list-check","list-columns-reverse","list-columns","list-nested","list-ol","list-stars","list-task","list-ul","list","lock-fill","lock","luggage-fill","luggage","lungs-fill","lungs","magic","magnet-fill","magnet","mailbox-flag","mailbox","mailbox2-flag","mailbox2","m\
ap-fill","map","markdown-fill","markdown","marker-tip","mask","mastodon","medium","megaphone-fill","megaphone","memory","menu-app-fill","menu-app","menu-button-fill","menu-button-wide-fill","menu-button-wide","menu-button","menu-down","menu-up","messenger","meta","mic-fill","mic-mute-fill","mic-mute","mic","microsoft-teams","microsoft","minecart-loaded","minecart","modem-fill","modem","moisture","moon-fill","moon-stars-fill","moon-stars","moon","mortarboard-fill","mortarboard","motherboard-fill",
"motherboard","mouse-fill","mouse","mouse2-fill","mouse2","mouse3-fill","mouse3","music-note-beamed","music-note-list","music-note","music-player-fill","music-player","newspaper","nintendo-switch","node-minus-fill","node-minus","node-plus-fill","node-plus","noise-reduction","nut-fill","nut","nvidia","nvme-fill","nvme","octagon-fill","octagon-half","octagon","opencollective","optical-audio-fill","optical-audio","option","outlet","p-circle-fill","p-circle","p-square-fill","p-square","paint-bucket",
"palette-fill","palette","palette2","paperclip","paragraph","pass-fill","pass","passport-fill","passport","patch-check-fill","patch-check","patch-exclamation-fill","patch-exclamation","patch-minus-fill","patch-minus","patch-plus-fill","patch-plus","patch-question-fill","patch-question","pause-btn-fill","pause-btn","pause-circle-fill","pause-circle","pause-fill","pause","paypal","pc-display-horizontal","pc-display","pc-horizontal","pc","pci-card-network","pci-card-sound","pci-card","peace-fill","\
peace","pen-fill","pen","pencil-fill","pencil-square","pencil","pentagon-fill","pentagon-half","pentagon","people-fill","people","percent","person-add","person-arms-up","person-badge-fill","person-badge","person-bounding-box","person-check-fill","person-check","person-circle","person-dash-fill","person-dash","person-down","person-exclamation","person-fill-add","person-fill-check","person-fill-dash","person-fill-down","person-fill-exclamation","person-fill-gear","person-fill-lock","person-fill-sl\
ash","person-fill-up","person-fill-x","person-fill","person-gear","person-heart","person-hearts","person-lines-fill","person-lock","person-plus-fill","person-plus","person-raised-hand","person-rolodex","person-slash","person-square","person-standing-dress","person-standing","person-up","person-vcard-fill","person-vcard","person-video","person-video2","person-video3","person-walking","person-wheelchair","person-workspace","person-x-fill","person-x","person","phone-fill","phone-flip","phone-landsc\
ape-fill","phone-landscape","phone-vibrate-fill","phone-vibrate","phone","pie-chart-fill","pie-chart","piggy-bank-fill","piggy-bank","pin-angle-fill","pin-angle","pin-fill","pin-map-fill","pin-map","pin","pinterest","pip-fill","pip","play-btn-fill","play-btn","play-circle-fill","play-circle","play-fill","play","playstation","plug-fill","plug","plugin","plus-circle-dotted","plus-circle-fill","plus-circle","plus-lg","plus-slash-minus","plus-square-dotted","plus-square-fill","plus-square","plus","p\
ostage-fill","postage-heart-fill","postage-heart","postage","postcard-fill","postcard-heart-fill","postcard-heart","postcard","power","prescription","prescription2","printer-fill","printer","projector-fill","projector","puzzle-fill","puzzle","qr-code-scan","qr-code","question-circle-fill","question-circle","question-diamond-fill","question-diamond","question-lg","question-octagon-fill","question-octagon","question-square-fill","question-square","question","quora","quote","r-circle-fill","r-circl\
e","r-square-fill","r-square","radar","radioactive","rainbow","receipt-cutoff","receipt","reception-0","reception-1","reception-2","reception-3","reception-4","record-btn-fill","record-btn","record-circle-fill","record-circle","record-fill","record","record2-fill","record2","recycle","reddit","regex","repeat-1","repeat","reply-all-fill","reply-all","reply-fill","reply","rewind-btn-fill","rewind-btn","rewind-circle-fill","rewind-circle","rewind-fill","rewind","robot","rocket-fill","rocket-takeoff\
-fill","rocket-takeoff","rocket","router-fill","router","rss-fill","rss","rulers","safe-fill","safe","safe2-fill","safe2","save-fill","save","save2-fill","save2","scissors","scooter","screwdriver","sd-card-fill","sd-card","search-heart-fill","search-heart","search","segmented-nav","send-arrow-down-fill","send-arrow-down","send-arrow-up-fill","send-arrow-up","send-check-fill","send-check","send-dash-fill","send-dash","send-exclamation-fill","send-exclamation","send-fill","send-plus-fill","send-pl\
us","send-slash-fill","send-slash","send-x-fill","send-x","send","server","shadows","share-fill","share","shield-check","shield-exclamation","shield-fill-check","shield-fill-exclamation","shield-fill-minus","shield-fill-plus","shield-fill-x","shield-fill","shield-lock-fill","shield-lock","shield-minus","shield-plus","shield-shaded","shield-slash-fill","shield-slash","shield-x","shield","shift-fill","shift","shop-window","shop","shuffle","sign-dead-end-fill","sign-dead-end","sign-do-not-enter-fil\
l","sign-do-not-enter","sign-intersection-fill","sign-intersection-side-fill","sign-intersection-side","sign-intersection-t-fill","sign-intersection-t","sign-intersection-y-fill","sign-intersection-y","sign-intersection","sign-merge-left-fill","sign-merge-left","sign-merge-right-fill","sign-merge-right","sign-no-left-turn-fill","sign-no-left-turn","sign-no-parking-fill","sign-no-parking","sign-no-right-turn-fill","sign-no-right-turn","sign-railroad-fill","sign-railroad","sign-stop-fill","sign-st\
op-lights-fill","sign-stop-lights","sign-stop","sign-turn-left-fill","sign-turn-left","sign-turn-right-fill","sign-turn-right","sign-turn-slight-left-fill","sign-turn-slight-left","sign-turn-slight-right-fill","sign-turn-slight-right","sign-yield-fill","sign-yield","signal","signpost-2-fill","signpost-2","signpost-fill","signpost-split-fill","signpost-split","signpost","sim-fill","sim-slash-fill","sim-slash","sim","sina-weibo","skip-backward-btn-fill","skip-backward-btn","skip-backward-circle-fi\
ll","skip-backward-circle","skip-backward-fill","skip-backward","skip-end-btn-fill","skip-end-btn","skip-end-circle-fill","skip-end-circle","skip-end-fill","skip-end","skip-forward-btn-fill","skip-forward-btn","skip-forward-circle-fill","skip-forward-circle","skip-forward-fill","skip-forward","skip-start-btn-fill","skip-start-btn","skip-start-circle-fill","skip-start-circle","skip-start-fill","skip-start","skype","slack","slash-circle-fill","slash-circle","slash-lg","slash-square-fill","slash-sq\
uare","slash","sliders","sliders2-vertical","sliders2","smartwatch","snapchat","snow","snow2","snow3","sort-alpha-down-alt","sort-alpha-down","sort-alpha-up-alt","sort-alpha-up","sort-down-alt","sort-down","sort-numeric-down-alt","sort-numeric-down","sort-numeric-up-alt","sort-numeric-up","sort-up-alt","sort-up","soundwave","sourceforge","speaker-fill","speaker","speedometer","speedometer2","spellcheck","spotify","square-fill","square-half","square","stack-overflow","stack","star-fill","star-hal\
f","star","stars","steam","stickies-fill","stickies","sticky-fill","sticky","stop-btn-fill","stop-btn","stop-circle-fill","stop-circle","stop-fill","stop","stoplights-fill","stoplights","stopwatch-fill","stopwatch","strava","stripe","subscript","substack","subtract","suit-club-fill","suit-club","suit-diamond-fill","suit-diamond","suit-heart-fill","suit-heart","suit-spade-fill","suit-spade","suitcase-fill","suitcase-lg-fill","suitcase-lg","suitcase","suitcase2-fill","suitcase2","sun-fill","sun","\
sunglasses","sunrise-fill","sunrise","sunset-fill","sunset","superscript","symmetry-horizontal","symmetry-vertical","table","tablet-fill","tablet-landscape-fill","tablet-landscape","tablet","tag-fill","tag","tags-fill","tags","taxi-front-fill","taxi-front","telegram","telephone-fill","telephone-forward-fill","telephone-forward","telephone-inbound-fill","telephone-inbound","telephone-minus-fill","telephone-minus","telephone-outbound-fill","telephone-outbound","telephone-plus-fill","telephone-plus",
"telephone-x-fill","telephone-x","telephone","tencent-qq","terminal-dash","terminal-fill","terminal-plus","terminal-split","terminal-x","terminal","text-center","text-indent-left","text-indent-right","text-left","text-paragraph","text-right","text-wrap","textarea-resize","textarea-t","textarea","thermometer-half","thermometer-high","thermometer-low","thermometer-snow","thermometer-sun","thermometer","threads-fill","threads","three-dots-vertical","three-dots","thunderbolt-fill","thunderbolt","tic\
ket-detailed-fill","ticket-detailed","ticket-fill","ticket-perforated-fill","ticket-perforated","ticket","tiktok","toggle-off","toggle-on","toggle2-off","toggle2-on","toggles","toggles2","tools","tornado","train-freight-front-fill","train-freight-front","train-front-fill","train-front","train-lightrail-front-fill","train-lightrail-front","translate","transparency","trash-fill","trash","trash2-fill","trash2","trash3-fill","trash3","tree-fill","tree","trello","triangle-fill","triangle-half","trian\
gle","trophy-fill","trophy","tropical-storm","truck-flatbed","truck-front-fill","truck-front","truck","tsunami","tv-fill","tv","twitch","twitter-x","twitter","type-bold","type-h1","type-h2","type-h3","type-h4","type-h5","type-h6","type-italic","type-strikethrough","type-underline","type","ubuntu","ui-checks-grid","ui-checks","ui-radios-grid","ui-radios","umbrella-fill","umbrella","unindent","union","unity","universal-access-circle","universal-access","unlock-fill","unlock","upc-scan","upc","uplo\
ad","usb-c-fill","usb-c","usb-drive-fill","usb-drive","usb-fill","usb-micro-fill","usb-micro","usb-mini-fill","usb-mini","usb-plug-fill","usb-plug","usb-symbol","usb","valentine","valentine2","vector-pen","view-list","view-stacked","vignette","vimeo","vinyl-fill","vinyl","virus","virus2","voicemail","volume-down-fill","volume-down","volume-mute-fill","volume-mute","volume-off-fill","volume-off","volume-up-fill","volume-up","vr","wallet-fill","wallet","wallet2","watch","water","webcam-fill","webc\
am","wechat","whatsapp","wifi-1","wifi-2","wifi-off","wifi","wikipedia","wind","window-dash","window-desktop","window-dock","window-fullscreen","window-plus","window-sidebar","window-split","window-stack","window-x","window","windows","wordpress","wrench-adjustable-circle-fill","wrench-adjustable-circle","wrench-adjustable","wrench","x-circle-fill","x-circle","x-diamond-fill","x-diamond","x-lg","x-octagon-fill","x-octagon","x-square-fill","x-square","x","xbox","yelp","yin-yang","youtube","zoom-i\
n","zoom-out"]})].flatMap(([t,e])=>e.map(n=>t+":"+n)),NN=["likec4lib {","  icons {",...H8.map(t=>"    "+t),"  }","}"].join(`
`),DN="likec4builtin",V8=`${DN}:///likec4/lib/icons.c4`;function Fs(t){return t.scheme===DN}const Be=Mr.getChild("server");function ct(t){Be.warn(rt(t))}const zr={FILE_TYPE:"files",DIR_TYPE:"directories",FILE_DIR_TYPE:"files_directories",EVERYTHING_TYPE:"all"},Z_={root:".",fileFilter:t=>!0,directoryFilter:t=>!0,type:zr.FILE_TYPE,lstat:!1,depth:2147483648,alwaysStat:!1,highWaterMark:4096};Object.freeze(Z_);const ON="READDIRP_RECURSIVE_ERROR",B8=new Set(["ENOENT","EPERM","EACCES","ELOOP",ON]),LN=[
zr.DIR_TYPE,zr.EVERYTHING_TYPE,zr.FILE_DIR_TYPE,zr.FILE_TYPE],W8=new Set([zr.DIR_TYPE,zr.EVERYTHING_TYPE,zr.FILE_DIR_TYPE]),G8=new Set([zr.EVERYTHING_TYPE,zr.FILE_DIR_TYPE,zr.FILE_TYPE]),K8=t=>B8.has(t.code),Z8=process.platform==="win32",MN=t=>!0,jN=t=>{if(t===void 0)return MN;if(typeof t=="function")return t;if(typeof t=="string"){const e=t.trim();return n=>n.basename===e}if(Array.isArray(t)){const e=t.map(n=>n.trim());return n=>e.some(r=>n.basename===r)}return MN};class J8 extends mF{parents;reading;parent;_stat;_maxDepth;_wantsDir;_wantsFile;_wantsEverything;_root;_isDirent;_statsProp;_rdOptions;_fileFilter;_directoryFilter;constructor(e={}){
super({objectMode:!0,autoDestroy:!0,highWaterMark:e.highWaterMark});const n={...Z_,...e},{root:r,type:i}=n;this._fileFilter=jN(n.fileFilter),this._directoryFilter=jN(n.directoryFilter);const s=n.lstat?$w:gl;Z8?this._stat=a=>s(a,{bigint:!0}):this._stat=s,this._maxDepth=n.depth!=null&&Number.isSafeInteger(n.depth)?n.depth:Z_.depth,this._wantsDir=i?W8.has(i):!1,this._wantsFile=i?G8.has(i):!1,this._wantsEverything=i===zr.EVERYTHING_TYPE,this._root=vw(r),this._isDirent=!n.alwaysStat,this._statsProp=this.
_isDirent?"dirent":"stats",this._rdOptions={encoding:"utf8",withFileTypes:this._isDirent},this.parents=[this._exploreDir(r,1)],this.reading=!1,this.parent=void 0}async _read(e){if(!this.reading){this.reading=!0;try{for(;!this.destroyed&&e>0;){const n=this.parent,r=n&&n.files;if(r&&r.length>0){const{path:i,depth:s}=n,a=r.splice(0,e).map(l=>this._formatEntry(l,i)),o=await Promise.all(a);for(const l of o){if(!l)continue;if(this.destroyed)return;const c=await this._getEntryType(l);c==="directory"&&this.
_directoryFilter(l)?(s<=this._maxDepth&&this.parents.push(this._exploreDir(l.fullPath,s+1)),this._wantsDir&&(this.push(l),e--)):(c==="file"||this._includeAsFile(l))&&this._fileFilter(l)&&this._wantsFile&&(this.push(l),e--)}}else{const i=this.parents.pop();if(!i){this.push(null);break}if(this.parent=await i,this.destroyed)return}}}catch(n){this.destroy(n)}finally{this.reading=!1}}}async _exploreDir(e,n){let r;try{r=await i0(e,this._rdOptions)}catch(i){this._onError(i)}return{files:r,depth:n,path:e}}async _formatEntry(e,n){
let r;const i=this._isDirent?e.name:e;try{const s=vw(gq(n,i));r={path:yq(this._root,s),fullPath:s,basename:i},r[this._statsProp]=this._isDirent?e:await this._stat(s)}catch(s){this._onError(s);return}return r}_onError(e){K8(e)&&!this.destroyed?this.emit("warn",e):this.destroy(e)}async _getEntryType(e){if(!e&&this._statsProp in e)return"";const n=e[this._statsProp];if(n.isFile())return"file";if(n.isDirectory())return"directory";if(n&&n.isSymbolicLink()){const r=e.fullPath;try{const i=await bh(r),s=await $w(
i);if(s.isFile())return"file";if(s.isDirectory()){const a=i.length;if(r.startsWith(i)&&r.substr(a,1)===vq){const o=new Error(`Circular symlink detected: "${r}" points to "${i}"`);return o.code=ON,this._onError(o)}return"directory"}}catch(i){return this._onError(i),""}}}_includeAsFile(e){const n=e&&e[this._statsProp];return n&&this._wantsEverything&&!n.isDirectory()}}function Y8(t,e={}){let n=e.entryType||e.type;if(n==="both"&&(n=zr.FILE_DIR_TYPE),n&&(e.type=n),t){if(typeof t!="string")throw new TypeError(
"readdirp: root argument must be a string. Usage: readdirp(root, options)");if(n&&!LN.includes(n))throw new Error(`readdirp: Invalid type passed. Use one of ${LN.join(", ")}`)}else throw new Error("readdirp: root argument is required. Usage: readdirp(root, options)");return e.root=t,new J8(e)}const X8="data",qN="end",Q8="close",J_=()=>{},hy=process.platform,FN=hy==="win32",e7=hy==="darwin",t7=hy==="linux",n7=hy==="freebsd",r7=yF()==="OS400",dn={ALL:"all",READY:"ready",ADD:"add",CHANGE:"change",ADD_DIR:"\
addDir",UNLINK:"unlink",UNLINK_DIR:"unlinkDir",RAW:"raw",ERROR:"error"},$i=dn,i7="watch",s7={lstat:$w,stat:gl},Oo="listeners",my="errHandlers",hc="rawEmitters",a7=[Oo,my,hc],o7=new Set(["3dm","3ds","3g2","3gp","7z","a","aac","adp","afdesign","afphoto","afpub","ai","aif","aiff","alz","ape","apk","appimage","ar","arj","asf","au","avi","bak","baml","bh","bin","bk","bmp","btif","bz2","bzip2","cab","caf","cgm","class","cmx","cpio","cr2","cur","dat","dcm","deb","dex","djvu","dll","dmg","dng","doc","do\
cm","docx","dot","dotm","dra","DS_Store","dsk","dts","dtshd","dvb","dwg","dxf","ecelp4800","ecelp7470","ecelp9600","egg","eol","eot","epub","exe","f4v","fbs","fh","fla","flac","flatpak","fli","flv","fpx","fst","fvt","g3","gh","gif","graffle","gz","gzip","h261","h263","h264","icns","ico","ief","img","ipa","iso","jar","jpeg","jpg","jpgv","jpm","jxr","key","ktx","lha","lib","lvp","lz","lzh","lzma","lzo","m3u","m4a","m4v","mar","mdi","mht","mid","midi","mj2","mka","mkv","mmr","mng","mobi","mov","mov\
ie","mp3","mp4","mp4a","mpeg","mpg","mpga","mxu","nef","npx","numbers","nupkg","o","odp","ods","odt","oga","ogg","ogv","otf","ott","pages","pbm","pcx","pdb","pdf","pea","pgm","pic","png","pnm","pot","potm","potx","ppa","ppam","ppm","pps","ppsm","ppsx","ppt","pptm","pptx","psd","pya","pyc","pyo","pyv","qt","rar","ras","raw","resources","rgb","rip","rlc","rmf","rmvb","rpm","rtf","rz","s3m","s7z","scpt","sgi","shar","snap","sil","sketch","slk","smv","snk","so","stl","suo","sub","swf","tar","tbz","t\
bz2","tga","tgz","thmx","tif","tiff","tlz","ttc","ttf","txz","udf","uvh","uvi","uvm","uvp","uvs","uvu","viv","vob","war","wav","wax","wbmp","wdp","weba","webm","webp","whl","wim","wm","wma","wmv","wmx","woff","woff2","wrm","wvx","xbm","xif","xla","xlam","xls","xlsb","xlsm","xlsx","xlt","xltm","xltx","xm","xmind","xpi","xpm","xwd","xz","z","zip","zipx"]),l7=t=>o7.has(Ue.extname(t).slice(1).toLowerCase()),Y_=(t,e)=>{t instanceof Set?t.forEach(e):e(t)},pp=(t,e,n)=>{let r=t[e];r instanceof Set||(t[e]=
r=new Set([r])),r.add(n)},c7=t=>e=>{const n=t[e];n instanceof Set?n.clear():delete t[e]},hp=(t,e,n)=>{const r=t[e];r instanceof Set?r.delete(n):r===n&&delete t[e]},zN=t=>t instanceof Set?t.size===0:!t,gy=new Map;function UN(t,e,n,r,i){const s=(a,o)=>{n(t),i(a,o,{watchedPath:t}),o&&t!==o&&yy(Ue.resolve(t,o),Oo,Ue.join(t,o))};try{return fq(t,{persistent:e.persistent},s)}catch(a){r(a);return}}const yy=(t,e,n,r,i)=>{const s=gy.get(t);s&&Y_(s[e],a=>{a(n,r,i)})},u7=(t,e,n,r)=>{const{listener:i,errHandler:s,
rawEmitter:a}=r;let o=gy.get(e),l;if(!n.persistent)return l=UN(t,n,i,s,a),l?l.close.bind(l):void 0;if(o)pp(o,Oo,i),pp(o,my,s),pp(o,hc,a);else{if(l=UN(t,n,yy.bind(null,e,Oo),s,yy.bind(null,e,hc)),!l)return;l.on($i.ERROR,async c=>{const u=yy.bind(null,e,my);if(o&&(o.watcherUnusable=!0),FN&&c.code==="EPERM")try{await(await Jq(t,"r")).close(),u(c)}catch{}else u(c)}),o={listeners:i,errHandlers:s,rawEmitters:a,watcher:l},gy.set(e,o)}return()=>{hp(o,Oo,i),hp(o,my,s),hp(o,hc,a),zN(o.listeners)&&(o.watcher.
close(),gy.delete(e),a7.forEach(c7(o)),o.watcher=void 0,Object.freeze(o))}},X_=new Map,d7=(t,e,n,r)=>{const{listener:i,rawEmitter:s}=r;let a=X_.get(e);const o=a&&a.options;return o&&(o.persistent<n.persistent||o.interval>n.interval)&&(W$(e),a=void 0),a?(pp(a,Oo,i),pp(a,hc,s)):(a={listeners:i,rawEmitters:s,options:n,watcher:dq(e,n,(l,c)=>{Y_(a.rawEmitters,d=>{d($i.CHANGE,e,{curr:l,prev:c})});const u=l.mtimeMs;(l.size!==c.size||u>c.mtimeMs||u===0)&&Y_(a.listeners,d=>d(t,l))})},X_.set(e,a)),()=>{hp(
a,Oo,i),hp(a,hc,s),zN(a.listeners)&&(X_.delete(e),W$(e),a.options=a.watcher=void 0,Object.freeze(a))}};class f7{fsw;_boundHandleError;constructor(e){this.fsw=e,this._boundHandleError=n=>e._handleError(n)}_watchWithNodeFs(e,n){const r=this.fsw.options,i=Ue.dirname(e),s=Ue.basename(e);this.fsw._getWatchedDir(i).add(s);const o=Ue.resolve(e),l={persistent:r.persistent};n||(n=J_);let c;if(r.usePolling){const u=r.interval!==r.binaryInterval;l.interval=u&&l7(s)?r.binaryInterval:r.interval,c=d7(e,o,l,{listener:n,
rawEmitter:this.fsw._emitRaw})}else c=u7(e,o,l,{listener:n,errHandler:this._boundHandleError,rawEmitter:this.fsw._emitRaw});return c}_handleFile(e,n,r){if(this.fsw.closed)return;const i=Ue.dirname(e),s=Ue.basename(e),a=this.fsw._getWatchedDir(i);let o=n;if(a.has(s))return;const l=async(u,d)=>{if(this.fsw._throttle(i7,e,5)){if(!d||d.mtimeMs===0)try{const f=await gl(e);if(this.fsw.closed)return;const p=f.atimeMs,m=f.mtimeMs;if((!p||p<=m||m!==o.mtimeMs)&&this.fsw._emit($i.CHANGE,e,f),(e7||t7||n7)&&
o.ino!==f.ino){this.fsw._closeFile(u),o=f;const w=this._watchWithNodeFs(e,l);w&&this.fsw._addPathCloser(u,w)}else o=f}catch{this.fsw._remove(i,s)}else if(a.has(s)){const f=d.atimeMs,p=d.mtimeMs;(!f||f<=p||p!==o.mtimeMs)&&this.fsw._emit($i.CHANGE,e,d),o=d}}},c=this._watchWithNodeFs(e,l);if(!(r&&this.fsw.options.ignoreInitial)&&this.fsw._isntIgnored(e)){if(!this.fsw._throttle($i.ADD,e,0))return;this.fsw._emit($i.ADD,e,n)}return c}async _handleSymlink(e,n,r,i){if(this.fsw.closed)return;const s=e.fullPath,
a=this.fsw._getWatchedDir(n);if(!this.fsw.options.followSymlinks){this.fsw._incrReadyCount();let o;try{o=await bh(r)}catch{return this.fsw._emitReady(),!0}return this.fsw.closed?void 0:(a.has(i)?this.fsw._symlinkPaths.get(s)!==o&&(this.fsw._symlinkPaths.set(s,o),this.fsw._emit($i.CHANGE,r,e.stats)):(a.add(i),this.fsw._symlinkPaths.set(s,o),this.fsw._emit($i.ADD,r,e.stats)),this.fsw._emitReady(),!0)}if(this.fsw._symlinkPaths.has(s))return!0;this.fsw._symlinkPaths.set(s,!0)}_handleRead(e,n,r,i,s,a,o){
e=Ue.join(e,"");const l=i?`${e}:${i}`:e;if(o=this.fsw._throttle("readdir",l,1e3),!o)return;const c=this.fsw._getWatchedDir(r.path),u=new Set;let d=this.fsw._readdirp(e,{fileFilter:f=>r.filterPath(f),directoryFilter:f=>r.filterDir(f)});if(d)return d.on(X8,async f=>{if(this.fsw.closed){d=void 0;return}const p=f.path;let m=Ue.join(e,p);if(u.add(p),!(f.stats.isSymbolicLink()&&await this._handleSymlink(f,e,m,p))){if(this.fsw.closed){d=void 0;return}(p===i||!i&&!c.has(p))&&(this.fsw._incrReadyCount(),
m=Ue.join(s,Ue.relative(s,m)),this._addToNodeFs(m,n,r,a+1))}}).on($i.ERROR,this._boundHandleError),new Promise((f,p)=>{if(!d)return p();d.once(qN,()=>{if(this.fsw.closed){d=void 0;return}const m=o?o.clear():!1;f(void 0),c.getChildren().filter(w=>w!==e&&!u.has(w)).forEach(w=>{this.fsw._remove(e,w)}),d=void 0,m&&this._handleRead(e,!1,r,i,s,a,o)})})}async _handleDir(e,n,r,i,s,a,o){const l=this.fsw._getWatchedDir(Ue.dirname(e)),c=l.has(Ue.basename(e));!(r&&this.fsw.options.ignoreInitial)&&!s&&!c&&this.
fsw._emit($i.ADD_DIR,e,n),l.add(Ue.basename(e)),this.fsw._getWatchedDir(e);let u,d;const f=this.fsw.options.depth;if((f==null||i<=f)&&!this.fsw._symlinkPaths.has(o)){if(!s&&(await this._handleRead(e,r,a,s,e,i,u),this.fsw.closed))return;d=this._watchWithNodeFs(e,(p,m)=>{m&&m.mtimeMs===0||this._handleRead(p,!1,a,s,e,i,u)})}return d}async _addToNodeFs(e,n,r,i,s){const a=this.fsw._emitReady;if(this.fsw._isIgnored(e)||this.fsw.closed)return a(),!1;const o=this.fsw._getWatchHelpers(e);r&&(o.filterPath=
l=>r.filterPath(l),o.filterDir=l=>r.filterDir(l));try{const l=await s7[o.statMethod](o.watchPath);if(this.fsw.closed)return;if(this.fsw._isIgnored(o.watchPath,l))return a(),!1;const c=this.fsw.options.followSymlinks;let u;if(l.isDirectory()){const d=Ue.resolve(e),f=c?await bh(e):e;if(this.fsw.closed||(u=await this._handleDir(o.watchPath,l,n,i,s,o,f),this.fsw.closed))return;d!==f&&f!==void 0&&this.fsw._symlinkPaths.set(d,f)}else if(l.isSymbolicLink()){const d=c?await bh(e):e;if(this.fsw.closed)return;
const f=Ue.dirname(o.watchPath);if(this.fsw._getWatchedDir(f).add(o.watchPath),this.fsw._emit($i.ADD,o.watchPath,l),u=await this._handleDir(f,l,n,i,e,o,d),this.fsw.closed)return;d!==void 0&&this.fsw._symlinkPaths.set(Ue.resolve(e),d)}else u=this._handleFile(o.watchPath,l,n);return a(),u&&this.fsw._addPathCloser(e,u),!1}catch(l){if(this.fsw._handleError(l))return a(),e}}}const Q_="/",p7="//",HN=".",h7="..",m7="string",g7=/\\/g,VN=/\/\//g,y7=/\..*\.(sw[px])$|~$|\.subl.*\.tmp/,v7=/^\.[/\\]/;function vy(t){
return Array.isArray(t)?t:[t]}const eR=t=>typeof t=="object"&&t!==null&&!(t instanceof RegExp);function w7(t){return typeof t=="function"?t:typeof t=="string"?e=>t===e:t instanceof RegExp?e=>t.test(e):typeof t=="object"&&t!==null?e=>{if(t.path===e)return!0;if(t.recursive){const n=Ue.relative(t.path,e);return n?!n.startsWith("..")&&!Ue.isAbsolute(n):!1}return!1}:()=>!1}function b7(t){if(typeof t!="string")throw new Error("string expected");t=Ue.normalize(t),t=t.replace(/\\/g,"/");let e=!1;return t.
startsWith("//")&&(e=!0),t=t.replace(VN,"/"),e&&(t="/"+t),t}function k7(t,e,n){const r=b7(e);for(let i=0;i<t.length;i++){const s=t[i];if(s(r,n))return!0}return!1}function _7(t,e){if(t==null)throw new TypeError("anymatch: specify first argument");const r=vy(t).map(i=>w7(i));return(i,s)=>k7(r,i,s)}const BN=t=>{const e=vy(t).flat();if(!e.every(n=>typeof n===m7))throw new TypeError(`Non-string provided as watch path: ${e}`);return e.map(GN)},WN=t=>{let e=t.replace(g7,Q_),n=!1;return e.startsWith(p7)&&
(n=!0),e=e.replace(VN,Q_),n&&(e=Q_+e),e},GN=t=>WN(Ue.normalize(WN(t))),KN=(t="")=>e=>typeof e=="string"?GN(Ue.isAbsolute(e)?e:Ue.join(t,e)):e,R7=(t,e)=>Ue.isAbsolute(t)?t:Ue.join(e,t),S7=Object.freeze(new Set);class $7{path;_removeWatcher;items;constructor(e,n){this.path=e,this._removeWatcher=n,this.items=new Set}add(e){const{items:n}=this;n&&e!==HN&&e!==h7&&n.add(e)}async remove(e){const{items:n}=this;if(!n||(n.delete(e),n.size>0))return;const r=this.path;try{await i0(r)}catch{this._removeWatcher&&
this._removeWatcher(Ue.dirname(r),Ue.basename(r))}}has(e){const{items:n}=this;if(n)return n.has(e)}getChildren(){const{items:e}=this;return e?[...e.values()]:[]}dispose(){this.items.clear(),this.path="",this._removeWatcher=J_,this.items=S7,Object.freeze(this)}}const T7="stat",E7="lstat";class P7{fsw;path;watchPath;fullWatchPath;dirParts;followSymlinks;statMethod;constructor(e,n,r){this.fsw=r;const i=e;this.path=e=e.replace(v7,""),this.watchPath=i,this.fullWatchPath=Ue.resolve(i),this.dirParts=[],
this.dirParts.forEach(s=>{s.length>1&&s.pop()}),this.followSymlinks=n,this.statMethod=n?T7:E7}entryPath(e){return Ue.join(this.watchPath,Ue.relative(this.watchPath,e.fullPath))}filterPath(e){const{stats:n}=e;if(n&&n.isSymbolicLink())return this.filterDir(e);const r=this.entryPath(e);return this.fsw._isntIgnored(r,n)&&this.fsw._hasReadPermissions(n)}filterDir(e){return this.fsw._isntIgnored(this.entryPath(e),e.stats)}}class ZN extends pF{closed;options;_closers;_ignoredPaths;_throttled;_streams;_symlinkPaths;_watched;_pendingWrites;_pendingUnlinks;_readyCount;_emitReady;_closePromise;_userIgnored;_readyEmitted;_emitRaw;_boundRemove;_nodeFsHandler;constructor(e={}){
super(),this.closed=!1,this._closers=new Map,this._ignoredPaths=new Set,this._throttled=new Map,this._streams=new Set,this._symlinkPaths=new Map,this._watched=new Map,this._pendingWrites=new Map,this._pendingUnlinks=new Map,this._readyCount=0,this._readyEmitted=!1;const n=e.awaitWriteFinish,r={stabilityThreshold:2e3,pollInterval:100},i={persistent:!0,ignoreInitial:!1,ignorePermissionErrors:!1,interval:100,binaryInterval:300,followSymlinks:!0,usePolling:!1,atomic:!0,...e,ignored:e.ignored?vy(e.ignored):
vy([]),awaitWriteFinish:n===!0?r:typeof n=="object"?{...r,...n}:!1};r7&&(i.usePolling=!0),i.atomic===void 0&&(i.atomic=!i.usePolling);const s=process.env.CHOKIDAR_USEPOLLING;if(s!==void 0){const l=s.toLowerCase();l==="false"||l==="0"?i.usePolling=!1:l==="true"||l==="1"?i.usePolling=!0:i.usePolling=!!l}const a=process.env.CHOKIDAR_INTERVAL;a&&(i.interval=Number.parseInt(a,10));let o=0;this._emitReady=()=>{o++,o>=this._readyCount&&(this._emitReady=J_,this._readyEmitted=!0,process.nextTick(()=>this.
emit(dn.READY)))},this._emitRaw=(...l)=>this.emit(dn.RAW,...l),this._boundRemove=this._remove.bind(this),this.options=i,this._nodeFsHandler=new f7(this),Object.freeze(i)}_addIgnoredPath(e){if(eR(e)){for(const n of this._ignoredPaths)if(eR(n)&&n.path===e.path&&n.recursive===e.recursive)return}this._ignoredPaths.add(e)}_removeIgnoredPath(e){if(this._ignoredPaths.delete(e),typeof e=="string")for(const n of this._ignoredPaths)eR(n)&&n.path===e&&this._ignoredPaths.delete(n)}add(e,n,r){const{cwd:i}=this.
options;this.closed=!1,this._closePromise=void 0;let s=BN(e);return i&&(s=s.map(a=>R7(a,i))),s.forEach(a=>{this._removeIgnoredPath(a)}),this._userIgnored=void 0,this._readyCount||(this._readyCount=0),this._readyCount+=s.length,Promise.all(s.map(async a=>{const o=await this._nodeFsHandler._addToNodeFs(a,!r,void 0,0,n);return o&&this._emitReady(),o})).then(a=>{this.closed||a.forEach(o=>{o&&this.add(Ue.dirname(o),Ue.basename(n||o))})}),this}unwatch(e){if(this.closed)return this;const n=BN(e),{cwd:r}=this.
options;return n.forEach(i=>{!Ue.isAbsolute(i)&&!this._closers.has(i)&&(r&&(i=Ue.join(r,i)),i=Ue.resolve(i)),this._closePath(i),this._addIgnoredPath(i),this._watched.has(i)&&this._addIgnoredPath({path:i,recursive:!0}),this._userIgnored=void 0}),this}close(){if(this._closePromise)return this._closePromise;this.closed=!0,this.removeAllListeners();const e=[];return this._closers.forEach(n=>n.forEach(r=>{const i=r();i instanceof Promise&&e.push(i)})),this._streams.forEach(n=>n.destroy()),this._userIgnored=
void 0,this._readyCount=0,this._readyEmitted=!1,this._watched.forEach(n=>n.dispose()),this._closers.clear(),this._watched.clear(),this._streams.clear(),this._symlinkPaths.clear(),this._throttled.clear(),this._closePromise=e.length?Promise.all(e).then(()=>{}):Promise.resolve(),this._closePromise}getWatched(){const e={};return this._watched.forEach((n,r)=>{const s=(this.options.cwd?Ue.relative(this.options.cwd,r):r)||HN;e[s]=n.getChildren().sort()}),e}emitWithAll(e,n){this.emit(e,...n),e!==dn.ERROR&&
this.emit(dn.ALL,e,...n)}async _emit(e,n,r){if(this.closed)return;const i=this.options;FN&&(n=Ue.normalize(n)),i.cwd&&(n=Ue.relative(i.cwd,n));const s=[n];r!=null&&s.push(r);const a=i.awaitWriteFinish;let o;if(a&&(o=this._pendingWrites.get(n)))return o.lastChange=new Date,this;if(i.atomic){if(e===dn.UNLINK)return this._pendingUnlinks.set(n,[e,...s]),setTimeout(()=>{this._pendingUnlinks.forEach((l,c)=>{this.emit(...l),this.emit(dn.ALL,...l),this._pendingUnlinks.delete(c)})},typeof i.atomic=="numb\
er"?i.atomic:100),this;e===dn.ADD&&this._pendingUnlinks.has(n)&&(e=dn.CHANGE,this._pendingUnlinks.delete(n))}if(a&&(e===dn.ADD||e===dn.CHANGE)&&this._readyEmitted){const l=(c,u)=>{c?(e=dn.ERROR,s[0]=c,this.emitWithAll(e,s)):u&&(s.length>1?s[1]=u:s.push(u),this.emitWithAll(e,s))};return this._awaitWriteFinish(n,a.stabilityThreshold,e,l),this}if(e===dn.CHANGE&&!this._throttle(dn.CHANGE,n,50))return this;if(i.alwaysStat&&r===void 0&&(e===dn.ADD||e===dn.ADD_DIR||e===dn.CHANGE)){const l=i.cwd?Ue.join(
i.cwd,n):n;let c;try{c=await gl(l)}catch{}if(!c||this.closed)return;s.push(c)}return this.emitWithAll(e,s),this}_handleError(e){const n=e&&e.code;return e&&n!=="ENOENT"&&n!=="ENOTDIR"&&(!this.options.ignorePermissionErrors||n!=="EPERM"&&n!=="EACCES")&&this.emit(dn.ERROR,e),e||this.closed}_throttle(e,n,r){this._throttled.has(e)||this._throttled.set(e,new Map);const i=this._throttled.get(e);if(!i)throw new Error("invalid throttle");const s=i.get(n);if(s)return s.count++,!1;let a;const o=()=>{const c=i.
get(n),u=c?c.count:0;return i.delete(n),clearTimeout(a),c&&clearTimeout(c.timeoutObject),u};a=setTimeout(o,r);const l={timeoutObject:a,clear:o,count:0};return i.set(n,l),l}_incrReadyCount(){return this._readyCount++}_awaitWriteFinish(e,n,r,i){const s=this.options.awaitWriteFinish;if(typeof s!="object")return;const a=s.pollInterval;let o,l=e;this.options.cwd&&!Ue.isAbsolute(e)&&(l=Ue.join(this.options.cwd,e));const c=new Date,u=this._pendingWrites;function d(f){pq(l,(p,m)=>{if(p||!u.has(e)){p&&p.
code!=="ENOENT"&&i(p);return}const w=Number(new Date);f&&m.size!==f.size&&(u.get(e).lastChange=w);const v=u.get(e);w-v.lastChange>=n?(u.delete(e),i(void 0,m)):o=setTimeout(d,a,m)})}u.has(e)||(u.set(e,{lastChange:c,cancelWait:()=>(u.delete(e),clearTimeout(o),r)}),o=setTimeout(d,a))}_isIgnored(e,n){if(this.options.atomic&&y7.test(e))return!0;if(!this._userIgnored){const{cwd:r}=this.options,s=(this.options.ignored||[]).map(KN(r)),o=[...[...this._ignoredPaths].map(KN(r)),...s];this._userIgnored=_7(o)}
return this._userIgnored(e,n)}_isntIgnored(e,n){return!this._isIgnored(e,n)}_getWatchHelpers(e){return new P7(e,this.options.followSymlinks,this)}_getWatchedDir(e){const n=Ue.resolve(e);return this._watched.has(n)||this._watched.set(n,new $7(n,this._boundRemove)),this._watched.get(n)}_hasReadPermissions(e){return this.options.ignorePermissionErrors?!0:!!(Number(e.mode)&256)}_remove(e,n,r){const i=Ue.join(e,n),s=Ue.resolve(i);if(r=r??(this._watched.has(i)||this._watched.has(s)),!this._throttle("r\
emove",i,100))return;!r&&this._watched.size===1&&this.add(e,n,!0),this._getWatchedDir(i).getChildren().forEach(f=>this._remove(i,f));const l=this._getWatchedDir(e),c=l.has(n);l.remove(n),this._symlinkPaths.has(s)&&this._symlinkPaths.delete(s);let u=i;if(this.options.cwd&&(u=Ue.relative(this.options.cwd,i)),this.options.awaitWriteFinish&&this._pendingWrites.has(u)&&this._pendingWrites.get(u).cancelWait()===dn.ADD)return;this._watched.delete(i),this._watched.delete(s);const d=r?dn.UNLINK_DIR:dn.UNLINK;
c&&!this._isIgnored(i)&&this._emit(d,i),this._closePath(i)}_closePath(e){this._closeFile(e);const n=Ue.dirname(e);this._getWatchedDir(n).remove(Ue.basename(e))}_closeFile(e){const n=this._closers.get(e);n&&(n.forEach(r=>r()),this._closers.delete(e))}_addPathCloser(e,n){if(!n)return;let r=this._closers.get(e);r||(r=[],this._closers.set(e,r)),r.push(n)}_readdirp(e,n){if(this.closed)return;const r={type:dn.ALL,alwaysStat:!0,lstat:!0,...n,depth:0};let i=Y8(e,r);return this._streams.add(i),i.once(Q8,
()=>{i=void 0}),i.once(qN,()=>{i&&(this._streams.delete(i),i=void 0)}),i}}function C7(t,e={}){const n=new ZN(e);return n.add(t),n}const x7={watch:C7,FSWatcher:ZN};var tR={exports:{}},JN;function A7(){return JN||(JN=1,(function(t){var e=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function i(l,c,u){this.fn=l,this.context=c,this.once=u||!1}function s(l,c,u,d,f){if(typeof u!="function")throw new TypeError("The listene\
r must be a function");var p=new i(u,d||l,f),m=n?n+c:c;return l._events[m]?l._events[m].fn?l._events[m]=[l._events[m],p]:l._events[m].push(p):(l._events[m]=p,l._eventsCount++),l}function a(l,c){--l._eventsCount===0?l._events=new r:delete l._events[c]}function o(){this._events=new r,this._eventsCount=0}o.prototype.eventNames=function(){var c=[],u,d;if(this._eventsCount===0)return c;for(d in u=this._events)e.call(u,d)&&c.push(n?d.slice(1):d);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(
u)):c},o.prototype.listeners=function(c){var u=n?n+c:c,d=this._events[u];if(!d)return[];if(d.fn)return[d.fn];for(var f=0,p=d.length,m=new Array(p);f<p;f++)m[f]=d[f].fn;return m},o.prototype.listenerCount=function(c){var u=n?n+c:c,d=this._events[u];return d?d.fn?1:d.length:0},o.prototype.emit=function(c,u,d,f,p,m){var w=n?n+c:c;if(!this._events[w])return!1;var v=this._events[w],g=arguments.length,h,y;if(v.fn){switch(v.once&&this.removeListener(c,v.fn,void 0,!0),g){case 1:return v.fn.call(v.context),
!0;case 2:return v.fn.call(v.context,u),!0;case 3:return v.fn.call(v.context,u,d),!0;case 4:return v.fn.call(v.context,u,d,f),!0;case 5:return v.fn.call(v.context,u,d,f,p),!0;case 6:return v.fn.call(v.context,u,d,f,p,m),!0}for(y=1,h=new Array(g-1);y<g;y++)h[y-1]=arguments[y];v.fn.apply(v.context,h)}else{var b=v.length,R;for(y=0;y<b;y++)switch(v[y].once&&this.removeListener(c,v[y].fn,void 0,!0),g){case 1:v[y].fn.call(v[y].context);break;case 2:v[y].fn.call(v[y].context,u);break;case 3:v[y].fn.call(
v[y].context,u,d);break;case 4:v[y].fn.call(v[y].context,u,d,f);break;default:if(!h)for(R=1,h=new Array(g-1);R<g;R++)h[R-1]=arguments[R];v[y].fn.apply(v[y].context,h)}}return!0},o.prototype.on=function(c,u,d){return s(this,c,u,d,!1)},o.prototype.once=function(c,u,d){return s(this,c,u,d,!0)},o.prototype.removeListener=function(c,u,d,f){var p=n?n+c:c;if(!this._events[p])return this;if(!u)return a(this,p),this;var m=this._events[p];if(m.fn)m.fn===u&&(!f||m.once)&&(!d||m.context===d)&&a(this,p);else{
for(var w=0,v=[],g=m.length;w<g;w++)(m[w].fn!==u||f&&!m[w].once||d&&m[w].context!==d)&&v.push(m[w]);v.length?this._events[p]=v.length===1?v[0]:v:a(this,p)}return this},o.prototype.removeAllListeners=function(c){var u;return c?(u=n?n+c:c,this._events[u]&&a(this,u)):(this._events=new r,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=n,o.EventEmitter=o,t.exports=o})(tR)),tR.exports}var I7=A7();const N7=oo(I7);class YN extends Error{constructor(e){
super(e),this.name="TimeoutError"}}class D7 extends Error{constructor(e){super(),this.name="AbortError",this.message=e}}const XN=t=>globalThis.DOMException===void 0?new D7(t):new DOMException(t),QN=t=>{const e=t.reason===void 0?XN("This operation was aborted."):t.reason;return e instanceof Error?e:XN(e)};function O7(t,e){const{milliseconds:n,fallback:r,message:i,customTimers:s={setTimeout,clearTimeout}}=e;let a,o;const c=new Promise((u,d)=>{if(typeof n!="number"||Math.sign(n)!==1)throw new TypeError(
`Expected \`milliseconds\` to be a positive number, got \`${n}\``);if(e.signal){const{signal:p}=e;p.aborted&&d(QN(p)),o=()=>{d(QN(p))},p.addEventListener("abort",o,{once:!0})}if(n===Number.POSITIVE_INFINITY){t.then(u,d);return}const f=new YN;a=s.setTimeout.call(void 0,()=>{if(r){try{u(r())}catch(p){d(p)}return}typeof t.cancel=="function"&&t.cancel(),i===!1?u():i instanceof Error?d(i):(f.message=i??`Promise timed out after ${n} milliseconds`,d(f))},n),(async()=>{try{u(await t)}catch(p){d(p)}})()}).
finally(()=>{c.clear(),o&&e.signal&&e.signal.removeEventListener("abort",o)});return c.clear=()=>{s.clearTimeout.call(void 0,a),a=void 0},c}function L7(t,e,n){let r=0,i=t.length;for(;i>0;){const s=Math.trunc(i/2);let a=r+s;n(t[a],e)<=0?(r=++a,i-=s+1):i=s}return r}class M7{#e=[];enqueue(e,n){n={priority:0,...n};const r={priority:n.priority,id:n.id,run:e};if(this.size===0||this.#e[this.size-1].priority>=n.priority){this.#e.push(r);return}const i=L7(this.#e,r,(s,a)=>a.priority-s.priority);this.#e.splice(
i,0,r)}setPriority(e,n){const r=this.#e.findIndex(s=>s.id===e);if(r===-1)throw new ReferenceError(`No promise function with the id "${e}" exists in the queue.`);const[i]=this.#e.splice(r,1);this.enqueue(i.run,{priority:n,id:e})}dequeue(){return this.#e.shift()?.run}filter(e){return this.#e.filter(n=>n.priority===e.priority).map(n=>n.run)}get size(){return this.#e.length}}class eD extends N7{#e;#t;#n=0;#r;#i;#s=0;#a;#u;#o;#d;#l=0;#f;#c;#g;#w=1n;timeout;constructor(e){if(super(),e={carryoverConcurrencyCount:!1,
intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:M7,...e},!(typeof e.intervalCap=="number"&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${e.intervalCap?.toString()??""}\` (${typeof e.intervalCap})`);if(e.interval===void 0||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${e.interval?.toString()??""}\` (${typeof e.
interval})`);this.#e=e.carryoverConcurrencyCount,this.#t=e.intervalCap===Number.POSITIVE_INFINITY||e.interval===0,this.#r=e.intervalCap,this.#i=e.interval,this.#o=new e.queueClass,this.#d=e.queueClass,this.concurrency=e.concurrency,this.timeout=e.timeout,this.#g=e.throwOnTimeout===!0,this.#c=e.autoStart===!1}get#b(){return this.#t||this.#n<this.#r}get#k(){return this.#l<this.#f}#_(){this.#l--,this.#p(),this.emit("next")}#R(){this.#v(),this.#y(),this.#u=void 0}get#S(){const e=Date.now();if(this.#a===
void 0){const n=this.#s-e;if(n<0)this.#n=this.#e?this.#l:0;else return this.#u===void 0&&(this.#u=setTimeout(()=>{this.#R()},n)),!0}return!1}#p(){if(this.#o.size===0)return this.#a&&clearInterval(this.#a),this.#a=void 0,this.emit("empty"),this.#l===0&&this.emit("idle"),!1;if(!this.#c){const e=!this.#S;if(this.#b&&this.#k){const n=this.#o.dequeue();return n?(this.emit("active"),n(),e&&this.#y(),!0):!1}}return!1}#y(){this.#t||this.#a!==void 0||(this.#a=setInterval(()=>{this.#v()},this.#i),this.#s=
Date.now()+this.#i)}#v(){this.#n===0&&this.#l===0&&this.#a&&(clearInterval(this.#a),this.#a=void 0),this.#n=this.#e?this.#l:0,this.#h()}#h(){for(;this.#p(););}get concurrency(){return this.#f}set concurrency(e){if(!(typeof e=="number"&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);this.#f=e,this.#h()}async#$(e){return new Promise((n,r)=>{e.addEventListener("abort",()=>{r(e.reason)},{once:!0})})}setPriority(e,n){this.#o.setPriority(
e,n)}async add(e,n={}){return n.id??=(this.#w++).toString(),n={timeout:this.timeout,throwOnTimeout:this.#g,...n},new Promise((r,i)=>{this.#o.enqueue(async()=>{this.#l++;try{n.signal?.throwIfAborted(),this.#n++;let s=e({signal:n.signal});n.timeout&&(s=O7(Promise.resolve(s),{milliseconds:n.timeout})),n.signal&&(s=Promise.race([s,this.#$(n.signal)]));const a=await s;r(a),this.emit("completed",a)}catch(s){if(s instanceof YN&&!n.throwOnTimeout){r();return}i(s),this.emit("error",s)}finally{this.#_()}},
n),this.emit("add"),this.#p()})}async addAll(e,n){return Promise.all(e.map(async r=>this.add(r,n)))}start(){return this.#c?(this.#c=!1,this.#h(),this):this}pause(){this.#c=!0}clear(){this.#o=new this.#d}async onEmpty(){this.#o.size!==0&&await this.#m("empty")}async onSizeLessThan(e){this.#o.size<e||await this.#m("next",()=>this.#o.size<e)}async onIdle(){this.#l===0&&this.#o.size===0||await this.#m("idle")}async#m(e,n){return new Promise(r=>{const i=()=>{n&&!n()||(this.off(e,i),r())};this.on(e,i)})}get size(){
return this.#o.size}sizeBy(e){return this.#o.filter(e).length}get pending(){return this.#l}get isPaused(){return this.#c}}const nR=Be.getChild("manual-layouts"),wy=t=>t.endsWith(".likec4.snap");function tD(t){return`${t}.likec4.snap`}function rR(t){return tt.resolvePath(t.folderUri,t.config.manualLayouts?.outDir??".likec4")}const j7={manualLayouts:t=>new q7(t)},iR="file://./";class q7{services;cache;constructor(e){this.services=e,this.cache=new jl(e.shared,Ve.Validated)}async read(e){return await this.
cache.get(e.id,async()=>{const n=nR.getChild(e.id),r=this.services.shared.workspace.FileSystemProvider,i=rR(e),s=[];try{const a=await r.scanDirectory(i,wy);if(a.length===0)return null;for(const o of a)if(o.isFile)try{const l=await r.readFile(o.uri),c=a0.parse(l),u=this.resolveIconPathsAfterRead(c,e.folderUri);s.push({...u,_layout:"manual"})}catch(l){n.warn(`Failed to read view snapshot ${o.uri.fsPath}`,{err:l})}s.length&&n.debug`read manual layouts for ${e.id}, found ${s.length}`}catch(a){n.warn(
`Failed to read manual layouts for ${e.folderUri.fsPath}`,{err:a})}return s.length===0?null:td(s,_i("id"))})}async write(e,n){const r=nR.getChild(e.id),i=rR(e),s=tt.joinPath(i,tD(n.id));if("manualLayout"in n){const{manualLayout:u,...d}=n;n=d}const a=a0.stringify(this.normalizeIconPathsForWrite(n,e.folderUri),{space:2,quote:"'"}),o={uri:s.toString(),range:ft.create(Rt.create(0,0),Rt.create(a.split(`
`).length-1,1))};r.debug`write snapshot of ${n.id} in project ${e.id} to ${s.fsPath}`;const l=this.services.shared.workspace.FileSystemProvider;try{await l.writeFile(s,a+`
`)}catch(u){r.warn(`Failed to write snapshot ${n.id} to ${s.fsPath}`,{err:u})}const c=this.cache.get(e.id);if(c){const u=await c;u?(r.debug`update snapshot cache of ${n.id} in project ${e.id}`,u[n.id]=n):(r.debug`clean cache of project ${e.id}`,this.cache.delete(e.id))}return this.services.likec4.ModelBuilder.clearCache(),o}async remove(e,n){const r=nR.getChild(e.id),i=rR(e),s=tt.joinPath(i,tD(n));r.debug`delete snapshot of ${n} in project ${e.id}. File: ${s.fsPath}`;const a={uri:s.toString(),range:ft.
create(0,0,0,0)};try{if(!await this.services.shared.workspace.FileSystemProvider.deleteFile(s))return r.warn`Snapshot ${n} did not exist at ${s.fsPath}`,null}catch(l){r.warn(`Failed to delete snapshot ${n} from ${s.fsPath}`,{err:l})}const o=this.cache.get(e.id);if(o){const l=await o;l?(r.debug`clean cached view ${n} in project ${e.id}`,delete l[n]):(r.debug`reset empty cache of project ${e.id}`,this.cache.delete(e.id))}return this.services.likec4.ModelBuilder.clearCache(),a}clearCaches(){this.cache.
clear()}normalizeIconPathsForWrite(e,n){const r=e.nodes.map(i=>{if(!i.icon||typeof i.icon!="string")return i;if(i.icon.startsWith("file://")){const s=ot.parse(i.icon),a=tt.relative(n,s);return a.startsWith("..")?i:{...i,icon:`${iR}${a}`}}return i});return{...e,nodes:r}}resolveIconPathsAfterRead(e,n){const r=e.nodes.map(i=>{if(!i.icon||typeof i.icon!="string")return i;if(i.icon.startsWith(iR)){const s=i.icon.substring(iR.length),a=tt.joinPath(n,s);return{...i,icon:a.toString()}}return i});return{
...e,nodes:r}}}const Ur=Be.getChild("chokidar"),F7={fileSystemWatcher:t=>new U7(t)},z7=t=>by(t)||Hc(t)||wy(t);class U7{services;watcher;queue=new eD({concurrency:1,timeout:5e3});constructor(e){this.services=e}watch(e){if(this.watcher){Ur.debug`add watching folder: ${e}`,this.watcher.add(e);return}this.watcher=this.createWatcher(e)}async dispose(){if(this.watcher){const e=this.watcher;this.watcher=void 0,await e.close()}}createWatcher(e){Ur.debug`create watcher for folder: ${e}`;let n=x7.watch(e,
{ignored:[s=>s.includes("node_modules")||s.includes(".git"),(s,a)=>!!a&&a.isFile()&&!z7(s)],followSymlinks:!0,ignoreInitial:!0});const r=(s,a)=>{a?.isDirectory()||this.enqueueFileOp("addOrChange: "+s,async()=>{await this.onAddOrChange(s)})},i=(s,a)=>{a?.isDirectory()||this.enqueueFileOp("remove: "+s,async()=>{await this.onRemove(s)})};return n.on("add",r).on("change",r).on("unlink",i).on("unlinkDir",s=>{this.enqueueFileOp("removeDir: "+s,async()=>{await this.onRemoveDir(s)})}),n}enqueueFileOp(e,n){
this.queue.add(async()=>{try{await n()}catch(r){Ur.warn(`Failed on ${e}`,{error:r})}}).catch(r=>{Ur.error(`Error on ${e}`,{error:r})})}async onAddOrChange(e){const n=this.services.workspace.ProjectsManager;if(Hc(e))Ur.debug`project file changed: ${e}`,await n.registerConfigFile(ot.file(e));else if(by(e))Ur.debug`file changed: ${e}`,await this.services.workspace.DocumentBuilder.update([ot.file(e)],[]);else if(wy(e)){Ur.debug`manual layout file changed: ${e}`;const r=n.belongsTo(ot.file(e));await n.
rebuidProject(r)}else Ur.warn`Unknown file change: ${e}`}async onRemove(e){const n=this.services.workspace.ProjectsManager;if(Hc(e))Ur.debug`project file removed: ${e}`,await n.reloadProjects();else if(by(e))Ur.debug`file removed: ${e}`,await this.services.workspace.DocumentBuilder.update([],[ot.file(e)]);else if(wy(e)){Ur.debug`manual layout file removed: ${e}`;const r=n.belongsTo(e);await n.rebuidProject(r)}else Ur.warn`Unknown file removal: ${e}`}async onRemoveDir(e){Ur.debug`directory removed: ${e}`;
const n=this.services.workspace.ProjectsManager;n.findAllProjectsByFolder(e).length>0&&await n.reloadProjects()}}const ba=Be.getChild("filesystem"),H7=(t=!0)=>({fileSystemProvider:()=>new W7,...t?F7:WI}),by=(t,e=!1)=>!e&&fp.fileExtensions.some(n=>t.endsWith(n)),V7=(t,e)=>!e&&Hc(t),nD=t=>["node_modules",".git",".svn",".yarn",".pnpm"].includes(t),B7=Tw("/"),rD=(t,e)=>B7(t.uri.path,e.uri.path);let W7=class extends r8{async readFile(e){if(Fs(e))return Promise.resolve(NN);try{return await super.readFile(
e)}catch(n){return ba.warn(`Failed to read file ${e.fsPath}`,{error:n}),""}}async readDirectory(e,n){const r=n?.recursive??!0,i=n?.maxDepth??1/0,s=[];try{let a=new p0().withSymlinks({resolvePaths:!1}).exclude(nD).filter(by).withFullPaths();r?i!==1/0&&(a=a.withMaxDepth(i)):a=a.withMaxDepth(1);const o=await a.crawl(e.fsPath).withPromise();for(const l of o)s.push({isFile:!0,isDirectory:!1,uri:ot.file(l)})}catch(a){ba.warn(`Failed to read directory ${e.fsPath}`,{error:a})}return s.sort(rD)}async scanProjectFiles(e){
return await this.scanDirectory(e,V7)}async scanDirectory(e,n){const r=[];try{const i=await new p0().withSymlinks({resolvePaths:!1}).withFullPaths().filter(n).exclude(nD).crawl(e.fsPath).withPromise();for(const s of i)r.push({isFile:!0,isDirectory:!1,uri:ot.file(s)})}catch(i){ba.warn(`Failed to scan directory ${e.fsPath}`,{error:i})}return r.sort(rD)}async loadProjectConfig(e){return await n8(e)}async writeFile(e,n){const r=G$(e.fsPath),i=await gl(r).catch(()=>null);if(i?.isFile())throw new Error(
`Cannot create directory ${r} because a file with the same name exists.`);return i||(ba.debug("creating directory {path}",{path:r}),hq(r,{recursive:!0})),ba.debug("writing file {path}",{path:e.fsPath}),await Yq(e.fsPath,n,{encoding:"utf-8"})}async deleteFile(e){try{const n=e.fsPath,r=await gl(n);if(r.isFile()||r.isSymbolicLink())return await Xq(n),ba.debug("deleted file {path}",{path:n}),!0;ba.warn("deleteFile failed: {path} does not exist, or is not a file",{path:n})}catch(n){ba.warn(`Failed to\
 delete file ${e.fsPath}`,{error:n})}return!1}};const nn=Be.getChild("mcp");function ka(t,e){const{name:n,description:r,...i}=t;return s=>[n,{description:r?.trim()??"",...i},G7(n,s,e)]}function G7(t,e,n){const r=n.bind(null,e);return(async function(i,s){nn.debug("Calling tool {name}, args: {args}",{name:t,args:i});try{const a=await r.call(null,i,s);return typeof a=="string"?{content:[{type:"text",text:a}]}:{content:[{type:"text",text:JSON.stringify(a)}],structuredContent:a}}catch(a){return nn.error(
`Tool ${t} failed`,{err:a}),{content:[{type:"text",text:rt(a)}],isError:!0}}})}function de(t,e,n){function r(o,l){var c;Object.defineProperty(o,"_zod",{value:o._zod??{},enumerable:!1}),(c=o._zod).traits??(c.traits=new Set),o._zod.traits.add(t),e(o,l);for(const u in a.prototype)u in o||Object.defineProperty(o,u,{value:a.prototype[u].bind(o)});o._zod.constr=a,o._zod.def=l}const i=n?.Parent??Object;class s extends i{}Object.defineProperty(s,"name",{value:t});function a(o){var l;const c=n?.Parent?new s:
this;r(c,o),(l=c._zod).deferred??(l.deferred=[]);for(const u of c._zod.deferred)u();return c}return Object.defineProperty(a,"init",{value:r}),Object.defineProperty(a,Symbol.hasInstance,{value:o=>n?.Parent&&o instanceof n.Parent?!0:o?._zod?.traits?.has(t)}),Object.defineProperty(a,"name",{value:t}),a}class mp extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}const iD={};function _a(t){return iD}function sD(t){const e=Object.values(t).filter(
r=>typeof r=="number");return Object.entries(t).filter(([r,i])=>e.indexOf(+r)===-1).map(([r,i])=>i)}function K7(t,e){return typeof e=="bigint"?e.toString():e}function sR(t){return{get value(){{const e=t();return Object.defineProperty(this,"value",{value:e}),e}}}}function aR(t){return t==null}function oR(t){const e=t.startsWith("^")?1:0,n=t.endsWith("$")?t.length-1:t.length;return t.slice(e,n)}function Z7(t,e){const n=(t.toString().split(".")[1]||"").length,r=(e.toString().split(".")[1]||"").length,
i=n>r?n:r,s=Number.parseInt(t.toFixed(i).replace(".","")),a=Number.parseInt(e.toFixed(i).replace(".",""));return s%a/10**i}function zt(t,e,n){Object.defineProperty(t,e,{get(){{const r=n();return t[e]=r,r}},set(r){Object.defineProperty(t,e,{value:r})},configurable:!0})}function gp(t,e,n){Object.defineProperty(t,e,{value:n,writable:!0,enumerable:!0,configurable:!0})}function yp(t){return JSON.stringify(t)}const aD=Error.captureStackTrace?Error.captureStackTrace:(...t)=>{};function ky(t){return typeof t==
"object"&&t!==null&&!Array.isArray(t)}const J7=sR(()=>{if(typeof navigator<"u"&&navigator?.userAgent?.includes("Cloudflare"))return!1;try{const t=Function;return new t(""),!0}catch{return!1}});function _y(t){if(ky(t)===!1)return!1;const e=t.constructor;if(e===void 0)return!0;const n=e.prototype;return!(ky(n)===!1||Object.prototype.hasOwnProperty.call(n,"isPrototypeOf")===!1)}const Y7=new Set(["string","number","symbol"]);function vp(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Ra(t,e,n){
const r=new t._zod.constr(e??t._zod.def);return(!e||n?.parent)&&(r._zod.parent=t),r}function Ae(t){const e=t;if(!e)return{};if(typeof e=="string")return{error:()=>e};if(e?.message!==void 0){if(e?.error!==void 0)throw new Error("Cannot specify both `message` and `error` params");e.error=e.message}return delete e.message,typeof e.error=="string"?{...e,error:()=>e.error}:e}function X7(t){return Object.keys(t).filter(e=>t[e]._zod.optin==="optional"&&t[e]._zod.optout==="optional")}const Q7={safeint:[
Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]};function eJ(t,e){const n={},r=t._zod.def;for(const i in e){if(!(i in r.shape))throw new Error(`Unrecognized key: "${i}"`);e[i]&&(n[i]=r.shape[i])}return Ra(t,{...t._zod.def,shape:n,checks:[]})}function tJ(t,e){const n={...t._zod.def.shape},r=t._zod.def;for(const i in e){if(!(i in r.shape))throw new Error(
`Unrecognized key: "${i}"`);e[i]&&delete n[i]}return Ra(t,{...t._zod.def,shape:n,checks:[]})}function nJ(t,e){if(!_y(e))throw new Error("Invalid input to extend: expected a plain object");const n={...t._zod.def,get shape(){const r={...t._zod.def.shape,...e};return gp(this,"shape",r),r},checks:[]};return Ra(t,n)}function rJ(t,e){return Ra(t,{...t._zod.def,get shape(){const n={...t._zod.def.shape,...e._zod.def.shape};return gp(this,"shape",n),n},catchall:e._zod.def.catchall,checks:[]})}function iJ(t,e,n){
const r=e._zod.def.shape,i={...r};if(n)for(const s in n){if(!(s in r))throw new Error(`Unrecognized key: "${s}"`);n[s]&&(i[s]=t?new t({type:"optional",innerType:r[s]}):r[s])}else for(const s in r)i[s]=t?new t({type:"optional",innerType:r[s]}):r[s];return Ra(e,{...e._zod.def,shape:i,checks:[]})}function sJ(t,e,n){const r=e._zod.def.shape,i={...r};if(n)for(const s in n){if(!(s in i))throw new Error(`Unrecognized key: "${s}"`);n[s]&&(i[s]=new t({type:"nonoptional",innerType:r[s]}))}else for(const s in r)
i[s]=new t({type:"nonoptional",innerType:r[s]});return Ra(e,{...e._zod.def,shape:i,checks:[]})}function wp(t,e=0){for(let n=e;n<t.issues.length;n++)if(t.issues[n]?.continue!==!0)return!0;return!1}function Lo(t,e){return e.map(n=>{var r;return(r=n).path??(r.path=[]),n.path.unshift(t),n})}function Ry(t){return typeof t=="string"?t:t?.message}function Sa(t,e,n){const r={...t,path:t.path??[]};if(!t.message){const i=Ry(t.inst?._zod.def?.error?.(t))??Ry(e?.error?.(t))??Ry(n.customError?.(t))??Ry(n.localeError?.(
t))??"Invalid input";r.message=i}return delete r.inst,delete r.continue,e?.reportInput||delete r.input,r}function lR(t){return Array.isArray(t)?"array":typeof t=="string"?"string":"unknown"}function bp(...t){const[e,n,r]=t;return typeof e=="string"?{message:e,code:"custom",input:n,inst:r}:{...e}}const oD=(t,e)=>{t.name="$ZodError",Object.defineProperty(t,"_zod",{value:t._zod,enumerable:!1}),Object.defineProperty(t,"issues",{value:e,enumerable:!1}),Object.defineProperty(t,"message",{get(){return JSON.
stringify(e,K7,2)},enumerable:!0}),Object.defineProperty(t,"toString",{value:()=>t.message,enumerable:!1})},lD=de("$ZodError",oD),Sy=de("$ZodError",oD,{Parent:Error});function aJ(t,e=n=>n.message){const n={},r=[];for(const i of t.issues)i.path.length>0?(n[i.path[0]]=n[i.path[0]]||[],n[i.path[0]].push(e(i))):r.push(e(i));return{formErrors:r,fieldErrors:n}}function oJ(t,e){const n=e||function(s){return s.message},r={_errors:[]},i=s=>{for(const a of s.issues)if(a.code==="invalid_union"&&a.errors.length)
a.errors.map(o=>i({issues:o}));else if(a.code==="invalid_key")i({issues:a.issues});else if(a.code==="invalid_element")i({issues:a.issues});else if(a.path.length===0)r._errors.push(n(a));else{let o=r,l=0;for(;l<a.path.length;){const c=a.path[l];l===a.path.length-1?(o[c]=o[c]||{_errors:[]},o[c]._errors.push(n(a))):o[c]=o[c]||{_errors:[]},o=o[c],l++}}};return i(t),r}const cD=t=>(e,n,r,i)=>{const s=r?Object.assign(r,{async:!1}):{async:!1},a=e._zod.run({value:n,issues:[]},s);if(a instanceof Promise)throw new mp;
if(a.issues.length){const o=new(i?.Err??t)(a.issues.map(l=>Sa(l,s,_a())));throw aD(o,i?.callee),o}return a.value},lJ=cD(Sy),uD=t=>async(e,n,r,i)=>{const s=r?Object.assign(r,{async:!0}):{async:!0};let a=e._zod.run({value:n,issues:[]},s);if(a instanceof Promise&&(a=await a),a.issues.length){const o=new(i?.Err??t)(a.issues.map(l=>Sa(l,s,_a())));throw aD(o,i?.callee),o}return a.value},cJ=uD(Sy),dD=t=>(e,n,r)=>{const i=r?{...r,async:!1}:{async:!1},s=e._zod.run({value:n,issues:[]},i);if(s instanceof Promise)
throw new mp;return s.issues.length?{success:!1,error:new(t??lD)(s.issues.map(a=>Sa(a,i,_a())))}:{success:!0,data:s.value}},cR=dD(Sy),fD=t=>async(e,n,r)=>{const i=r?Object.assign(r,{async:!0}):{async:!0};let s=e._zod.run({value:n,issues:[]},i);return s instanceof Promise&&(s=await s),s.issues.length?{success:!1,error:new t(s.issues.map(a=>Sa(a,i,_a())))}:{success:!0,data:s.value}},uR=fD(Sy),uJ=/^[cC][^\s-]{8,}$/,dJ=/^[0-9a-z]+$/,fJ=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,pJ=/^[0-9a-vA-V]{20}$/,hJ=/^[A-Za-z0-9]{27}$/,
mJ=/^[a-zA-Z0-9_-]{21}$/,gJ=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,yJ=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,pD=t=>t?new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${t}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000)$/,vJ=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/,
wJ="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";function bJ(){return new RegExp(wJ,"u")}const kJ=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,_J=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})$/,RJ=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,SJ=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,
$J=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,hD=/^[A-Za-z0-9_-]*$/,TJ=/^([a-zA-Z0-9-]+\.)*[a-zA-Z0-9-]+$/,EJ=/^\+(?:[0-9]){6,14}[0-9]$/,mD="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",PJ=new RegExp(`^${mD}$`);function gD(t){const e="(?:[01]\\d|2[0-3]):[0-5]\\d";return typeof t.precision=="numbe\
r"?t.precision===-1?`${e}`:t.precision===0?`${e}:[0-5]\\d`:`${e}:[0-5]\\d\\.\\d{${t.precision}}`:`${e}(?::[0-5]\\d(?:\\.\\d+)?)?`}function CJ(t){return new RegExp(`^${gD(t)}$`)}function xJ(t){const e=gD({precision:t.precision}),n=["Z"];t.local&&n.push(""),t.offset&&n.push("([+-]\\d{2}:\\d{2})");const r=`${e}(?:${n.join("|")})`;return new RegExp(`^${mD}T(?:${r})$`)}const AJ=t=>{const e=t?`[\\s\\S]{${t?.minimum??0},${t?.maximum??""}}`:"[\\s\\S]*";return new RegExp(`^${e}$`)},IJ=/^\d+$/,NJ=/^-?\d+(?:\.\d+)?/i,
DJ=/true|false/i,OJ=/null/i,LJ=/^[^A-Z]*$/,MJ=/^[^a-z]*$/,Tr=de("$ZodCheck",(t,e)=>{var n;t._zod??(t._zod={}),t._zod.def=e,(n=t._zod).onattach??(n.onattach=[])}),yD={number:"number",bigint:"bigint",object:"date"},vD=de("$ZodCheckLessThan",(t,e)=>{Tr.init(t,e);const n=yD[typeof e.value];t._zod.onattach.push(r=>{const i=r._zod.bag,s=(e.inclusive?i.maximum:i.exclusiveMaximum)??Number.POSITIVE_INFINITY;e.value<s&&(e.inclusive?i.maximum=e.value:i.exclusiveMaximum=e.value)}),t._zod.check=r=>{(e.inclusive?
r.value<=e.value:r.value<e.value)||r.issues.push({origin:n,code:"too_big",maximum:e.value,input:r.value,inclusive:e.inclusive,inst:t,continue:!e.abort})}}),wD=de("$ZodCheckGreaterThan",(t,e)=>{Tr.init(t,e);const n=yD[typeof e.value];t._zod.onattach.push(r=>{const i=r._zod.bag,s=(e.inclusive?i.minimum:i.exclusiveMinimum)??Number.NEGATIVE_INFINITY;e.value>s&&(e.inclusive?i.minimum=e.value:i.exclusiveMinimum=e.value)}),t._zod.check=r=>{(e.inclusive?r.value>=e.value:r.value>e.value)||r.issues.push({
origin:n,code:"too_small",minimum:e.value,input:r.value,inclusive:e.inclusive,inst:t,continue:!e.abort})}}),jJ=de("$ZodCheckMultipleOf",(t,e)=>{Tr.init(t,e),t._zod.onattach.push(n=>{var r;(r=n._zod.bag).multipleOf??(r.multipleOf=e.value)}),t._zod.check=n=>{if(typeof n.value!=typeof e.value)throw new Error("Cannot mix number and bigint in multiple_of check.");(typeof n.value=="bigint"?n.value%e.value===BigInt(0):Z7(n.value,e.value)===0)||n.issues.push({origin:typeof n.value,code:"not_multiple_of",
divisor:e.value,input:n.value,inst:t,continue:!e.abort})}}),qJ=de("$ZodCheckNumberFormat",(t,e)=>{Tr.init(t,e),e.format=e.format||"float64";const n=e.format?.includes("int"),r=n?"int":"number",[i,s]=Q7[e.format];t._zod.onattach.push(a=>{const o=a._zod.bag;o.format=e.format,o.minimum=i,o.maximum=s,n&&(o.pattern=IJ)}),t._zod.check=a=>{const o=a.value;if(n){if(!Number.isInteger(o)){a.issues.push({expected:r,format:e.format,code:"invalid_type",input:o,inst:t});return}if(!Number.isSafeInteger(o)){o>0?
a.issues.push({input:o,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:t,origin:r,continue:!e.abort}):a.issues.push({input:o,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:t,origin:r,continue:!e.abort});return}}o<i&&a.issues.push({origin:"number",input:o,code:"too_small",minimum:i,inclusive:!0,inst:t,continue:!e.abort}),o>s&&a.issues.push({origin:"number",input:o,code:"too_big",
maximum:s,inst:t})}}),FJ=de("$ZodCheckMaxLength",(t,e)=>{var n;Tr.init(t,e),(n=t._zod.def).when??(n.when=r=>{const i=r.value;return!aR(i)&&i.length!==void 0}),t._zod.onattach.push(r=>{const i=r._zod.bag.maximum??Number.POSITIVE_INFINITY;e.maximum<i&&(r._zod.bag.maximum=e.maximum)}),t._zod.check=r=>{const i=r.value;if(i.length<=e.maximum)return;const a=lR(i);r.issues.push({origin:a,code:"too_big",maximum:e.maximum,inclusive:!0,input:i,inst:t,continue:!e.abort})}}),zJ=de("$ZodCheckMinLength",(t,e)=>{
var n;Tr.init(t,e),(n=t._zod.def).when??(n.when=r=>{const i=r.value;return!aR(i)&&i.length!==void 0}),t._zod.onattach.push(r=>{const i=r._zod.bag.minimum??Number.NEGATIVE_INFINITY;e.minimum>i&&(r._zod.bag.minimum=e.minimum)}),t._zod.check=r=>{const i=r.value;if(i.length>=e.minimum)return;const a=lR(i);r.issues.push({origin:a,code:"too_small",minimum:e.minimum,inclusive:!0,input:i,inst:t,continue:!e.abort})}}),UJ=de("$ZodCheckLengthEquals",(t,e)=>{var n;Tr.init(t,e),(n=t._zod.def).when??(n.when=r=>{
const i=r.value;return!aR(i)&&i.length!==void 0}),t._zod.onattach.push(r=>{const i=r._zod.bag;i.minimum=e.length,i.maximum=e.length,i.length=e.length}),t._zod.check=r=>{const i=r.value,s=i.length;if(s===e.length)return;const a=lR(i),o=s>e.length;r.issues.push({origin:a,...o?{code:"too_big",maximum:e.length}:{code:"too_small",minimum:e.length},inclusive:!0,exact:!0,input:r.value,inst:t,continue:!e.abort})}}),$y=de("$ZodCheckStringFormat",(t,e)=>{var n,r;Tr.init(t,e),t._zod.onattach.push(i=>{const s=i.
_zod.bag;s.format=e.format,e.pattern&&(s.patterns??(s.patterns=new Set),s.patterns.add(e.pattern))}),e.pattern?(n=t._zod).check??(n.check=i=>{e.pattern.lastIndex=0,!e.pattern.test(i.value)&&i.issues.push({origin:"string",code:"invalid_format",format:e.format,input:i.value,...e.pattern?{pattern:e.pattern.toString()}:{},inst:t,continue:!e.abort})}):(r=t._zod).check??(r.check=()=>{})}),HJ=de("$ZodCheckRegex",(t,e)=>{$y.init(t,e),t._zod.check=n=>{e.pattern.lastIndex=0,!e.pattern.test(n.value)&&n.issues.
push({origin:"string",code:"invalid_format",format:"regex",input:n.value,pattern:e.pattern.toString(),inst:t,continue:!e.abort})}}),VJ=de("$ZodCheckLowerCase",(t,e)=>{e.pattern??(e.pattern=LJ),$y.init(t,e)}),BJ=de("$ZodCheckUpperCase",(t,e)=>{e.pattern??(e.pattern=MJ),$y.init(t,e)}),WJ=de("$ZodCheckIncludes",(t,e)=>{Tr.init(t,e);const n=vp(e.includes),r=new RegExp(typeof e.position=="number"?`^.{${e.position}}${n}`:n);e.pattern=r,t._zod.onattach.push(i=>{const s=i._zod.bag;s.patterns??(s.patterns=
new Set),s.patterns.add(r)}),t._zod.check=i=>{i.value.includes(e.includes,e.position)||i.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:e.includes,input:i.value,inst:t,continue:!e.abort})}}),GJ=de("$ZodCheckStartsWith",(t,e)=>{Tr.init(t,e);const n=new RegExp(`^${vp(e.prefix)}.*`);e.pattern??(e.pattern=n),t._zod.onattach.push(r=>{const i=r._zod.bag;i.patterns??(i.patterns=new Set),i.patterns.add(n)}),t._zod.check=r=>{r.value.startsWith(e.prefix)||r.issues.push({origin:"\
string",code:"invalid_format",format:"starts_with",prefix:e.prefix,input:r.value,inst:t,continue:!e.abort})}}),KJ=de("$ZodCheckEndsWith",(t,e)=>{Tr.init(t,e);const n=new RegExp(`.*${vp(e.suffix)}$`);e.pattern??(e.pattern=n),t._zod.onattach.push(r=>{const i=r._zod.bag;i.patterns??(i.patterns=new Set),i.patterns.add(n)}),t._zod.check=r=>{r.value.endsWith(e.suffix)||r.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:e.suffix,input:r.value,inst:t,continue:!e.abort})}}),ZJ=de(
"$ZodCheckOverwrite",(t,e)=>{Tr.init(t,e),t._zod.check=n=>{n.value=e.tx(n.value)}});class JJ{constructor(e=[]){this.content=[],this.indent=0,this&&(this.args=e)}indented(e){this.indent+=1,e(this),this.indent-=1}write(e){if(typeof e=="function"){e(this,{execution:"sync"}),e(this,{execution:"async"});return}const r=e.split(`
`).filter(a=>a),i=Math.min(...r.map(a=>a.length-a.trimStart().length)),s=r.map(a=>a.slice(i)).map(a=>" ".repeat(this.indent*2)+a);for(const a of s)this.content.push(a)}compile(){const e=Function,n=this?.args,i=[...(this?.content??[""]).map(s=>`  ${s}`)];return new e(...n,i.join(`
`))}}const YJ={major:4,minor:0,patch:0},Ut=de("$ZodType",(t,e)=>{var n;t??(t={}),t._zod.def=e,t._zod.bag=t._zod.bag||{},t._zod.version=YJ;const r=[...t._zod.def.checks??[]];t._zod.traits.has("$ZodCheck")&&r.unshift(t);for(const i of r)for(const s of i._zod.onattach)s(t);if(r.length===0)(n=t._zod).deferred??(n.deferred=[]),t._zod.deferred?.push(()=>{t._zod.run=t._zod.parse});else{const i=(s,a,o)=>{let l=wp(s),c;for(const u of a){if(u._zod.def.when){if(!u._zod.def.when(s))continue}else if(l)continue;
const d=s.issues.length,f=u._zod.check(s);if(f instanceof Promise&&o?.async===!1)throw new mp;if(c||f instanceof Promise)c=(c??Promise.resolve()).then(async()=>{await f,s.issues.length!==d&&(l||(l=wp(s,d)))});else{if(s.issues.length===d)continue;l||(l=wp(s,d))}}return c?c.then(()=>s):s};t._zod.run=(s,a)=>{const o=t._zod.parse(s,a);if(o instanceof Promise){if(a.async===!1)throw new mp;return o.then(l=>i(l,r,a))}return i(o,r,a)}}t["~standard"]={validate:i=>{try{const s=cR(t,i);return s.success?{value:s.
data}:{issues:s.error?.issues}}catch{return uR(t,i).then(a=>a.success?{value:a.data}:{issues:a.error?.issues})}},vendor:"zod",version:1}}),dR=de("$ZodString",(t,e)=>{Ut.init(t,e),t._zod.pattern=[...t?._zod.bag?.patterns??[]].pop()??AJ(t._zod.bag),t._zod.parse=(n,r)=>{if(e.coerce)try{n.value=String(n.value)}catch{}return typeof n.value=="string"||n.issues.push({expected:"string",code:"invalid_type",input:n.value,inst:t}),n}}),Jt=de("$ZodStringFormat",(t,e)=>{$y.init(t,e),dR.init(t,e)}),XJ=de("$Zo\
dGUID",(t,e)=>{e.pattern??(e.pattern=yJ),Jt.init(t,e)}),QJ=de("$ZodUUID",(t,e)=>{if(e.version){const r={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[e.version];if(r===void 0)throw new Error(`Invalid UUID version: "${e.version}"`);e.pattern??(e.pattern=pD(r))}else e.pattern??(e.pattern=pD());Jt.init(t,e)}),eY=de("$ZodEmail",(t,e)=>{e.pattern??(e.pattern=vJ),Jt.init(t,e)}),tY=de("$ZodURL",(t,e)=>{Jt.init(t,e),t._zod.check=n=>{try{const r=n.value,i=new URL(r),s=i.href;e.hostname&&(e.hostname.lastIndex=
0,e.hostname.test(i.hostname)||n.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:TJ.source,input:n.value,inst:t,continue:!e.abort})),e.protocol&&(e.protocol.lastIndex=0,e.protocol.test(i.protocol.endsWith(":")?i.protocol.slice(0,-1):i.protocol)||n.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:e.protocol.source,input:n.value,inst:t,continue:!e.abort})),!r.endsWith("/")&&s.endsWith("/")?n.value=s.slice(0,-1):n.value=s;return}catch{n.
issues.push({code:"invalid_format",format:"url",input:n.value,inst:t,continue:!e.abort})}}}),nY=de("$ZodEmoji",(t,e)=>{e.pattern??(e.pattern=bJ()),Jt.init(t,e)}),rY=de("$ZodNanoID",(t,e)=>{e.pattern??(e.pattern=mJ),Jt.init(t,e)}),iY=de("$ZodCUID",(t,e)=>{e.pattern??(e.pattern=uJ),Jt.init(t,e)}),sY=de("$ZodCUID2",(t,e)=>{e.pattern??(e.pattern=dJ),Jt.init(t,e)}),aY=de("$ZodULID",(t,e)=>{e.pattern??(e.pattern=fJ),Jt.init(t,e)}),oY=de("$ZodXID",(t,e)=>{e.pattern??(e.pattern=pJ),Jt.init(t,e)}),lY=de(
"$ZodKSUID",(t,e)=>{e.pattern??(e.pattern=hJ),Jt.init(t,e)}),cY=de("$ZodISODateTime",(t,e)=>{e.pattern??(e.pattern=xJ(e)),Jt.init(t,e)}),uY=de("$ZodISODate",(t,e)=>{e.pattern??(e.pattern=PJ),Jt.init(t,e)}),dY=de("$ZodISOTime",(t,e)=>{e.pattern??(e.pattern=CJ(e)),Jt.init(t,e)}),fY=de("$ZodISODuration",(t,e)=>{e.pattern??(e.pattern=gJ),Jt.init(t,e)}),pY=de("$ZodIPv4",(t,e)=>{e.pattern??(e.pattern=kJ),Jt.init(t,e),t._zod.onattach.push(n=>{const r=n._zod.bag;r.format="ipv4"})}),hY=de("$ZodIPv6",(t,e)=>{
e.pattern??(e.pattern=_J),Jt.init(t,e),t._zod.onattach.push(n=>{const r=n._zod.bag;r.format="ipv6"}),t._zod.check=n=>{try{new URL(`http://[${n.value}]`)}catch{n.issues.push({code:"invalid_format",format:"ipv6",input:n.value,inst:t,continue:!e.abort})}}}),mY=de("$ZodCIDRv4",(t,e)=>{e.pattern??(e.pattern=RJ),Jt.init(t,e)}),gY=de("$ZodCIDRv6",(t,e)=>{e.pattern??(e.pattern=SJ),Jt.init(t,e),t._zod.check=n=>{const[r,i]=n.value.split("/");try{if(!i)throw new Error;const s=Number(i);if(`${s}`!==i)throw new Error;
if(s<0||s>128)throw new Error;new URL(`http://[${r}]`)}catch{n.issues.push({code:"invalid_format",format:"cidrv6",input:n.value,inst:t,continue:!e.abort})}}});function bD(t){if(t==="")return!0;if(t.length%4!==0)return!1;try{return atob(t),!0}catch{return!1}}const yY=de("$ZodBase64",(t,e)=>{e.pattern??(e.pattern=$J),Jt.init(t,e),t._zod.onattach.push(n=>{n._zod.bag.contentEncoding="base64"}),t._zod.check=n=>{bD(n.value)||n.issues.push({code:"invalid_format",format:"base64",input:n.value,inst:t,continue:!e.
abort})}});function vY(t){if(!hD.test(t))return!1;const e=t.replace(/[-_]/g,r=>r==="-"?"+":"/"),n=e.padEnd(Math.ceil(e.length/4)*4,"=");return bD(n)}const wY=de("$ZodBase64URL",(t,e)=>{e.pattern??(e.pattern=hD),Jt.init(t,e),t._zod.onattach.push(n=>{n._zod.bag.contentEncoding="base64url"}),t._zod.check=n=>{vY(n.value)||n.issues.push({code:"invalid_format",format:"base64url",input:n.value,inst:t,continue:!e.abort})}}),bY=de("$ZodE164",(t,e)=>{e.pattern??(e.pattern=EJ),Jt.init(t,e)});function kY(t,e=null){
try{const n=t.split(".");if(n.length!==3)return!1;const[r]=n;if(!r)return!1;const i=JSON.parse(atob(r));return!("typ"in i&&i?.typ!=="JWT"||!i.alg||e&&(!("alg"in i)||i.alg!==e))}catch{return!1}}const _Y=de("$ZodJWT",(t,e)=>{Jt.init(t,e),t._zod.check=n=>{kY(n.value,e.alg)||n.issues.push({code:"invalid_format",format:"jwt",input:n.value,inst:t,continue:!e.abort})}}),kD=de("$ZodNumber",(t,e)=>{Ut.init(t,e),t._zod.pattern=t._zod.bag.pattern??NJ,t._zod.parse=(n,r)=>{if(e.coerce)try{n.value=Number(n.value)}catch{}
const i=n.value;if(typeof i=="number"&&!Number.isNaN(i)&&Number.isFinite(i))return n;const s=typeof i=="number"?Number.isNaN(i)?"NaN":Number.isFinite(i)?void 0:"Infinity":void 0;return n.issues.push({expected:"number",code:"invalid_type",input:i,inst:t,...s?{received:s}:{}}),n}}),RY=de("$ZodNumber",(t,e)=>{qJ.init(t,e),kD.init(t,e)}),SY=de("$ZodBoolean",(t,e)=>{Ut.init(t,e),t._zod.pattern=DJ,t._zod.parse=(n,r)=>{if(e.coerce)try{n.value=!!n.value}catch{}const i=n.value;return typeof i=="boolean"||
n.issues.push({expected:"boolean",code:"invalid_type",input:i,inst:t}),n}}),$Y=de("$ZodNull",(t,e)=>{Ut.init(t,e),t._zod.pattern=OJ,t._zod.values=new Set([null]),t._zod.parse=(n,r)=>{const i=n.value;return i===null||n.issues.push({expected:"null",code:"invalid_type",input:i,inst:t}),n}}),TY=de("$ZodUnknown",(t,e)=>{Ut.init(t,e),t._zod.parse=n=>n}),EY=de("$ZodNever",(t,e)=>{Ut.init(t,e),t._zod.parse=(n,r)=>(n.issues.push({expected:"never",code:"invalid_type",input:n.value,inst:t}),n)});function _D(t,e,n){
t.issues.length&&e.issues.push(...Lo(n,t.issues)),e.value[n]=t.value}const PY=de("$ZodArray",(t,e)=>{Ut.init(t,e),t._zod.parse=(n,r)=>{const i=n.value;if(!Array.isArray(i))return n.issues.push({expected:"array",code:"invalid_type",input:i,inst:t}),n;n.value=Array(i.length);const s=[];for(let a=0;a<i.length;a++){const o=i[a],l=e.element._zod.run({value:o,issues:[]},r);l instanceof Promise?s.push(l.then(c=>_D(c,n,a))):_D(l,n,a)}return s.length?Promise.all(s).then(()=>n):n}});function Ty(t,e,n){t.issues.
length&&e.issues.push(...Lo(n,t.issues)),e.value[n]=t.value}function RD(t,e,n,r){t.issues.length?r[n]===void 0?n in r?e.value[n]=void 0:e.value[n]=t.value:e.issues.push(...Lo(n,t.issues)):t.value===void 0?n in r&&(e.value[n]=void 0):e.value[n]=t.value}const SD=de("$ZodObject",(t,e)=>{Ut.init(t,e);const n=sR(()=>{const d=Object.keys(e.shape);for(const p of d)if(!(e.shape[p]instanceof Ut))throw new Error(`Invalid element at key "${p}": expected a Zod schema`);const f=X7(e.shape);return{shape:e.shape,
keys:d,keySet:new Set(d),numKeys:d.length,optionalKeys:new Set(f)}});zt(t._zod,"propValues",()=>{const d=e.shape,f={};for(const p in d){const m=d[p]._zod;if(m.values){f[p]??(f[p]=new Set);for(const w of m.values)f[p].add(w)}}return f});const r=d=>{const f=new JJ(["shape","payload","ctx"]),p=n.value,m=h=>{const y=yp(h);return`shape[${y}]._zod.run({ value: input[${y}], issues: [] }, ctx)`};f.write("const input = payload.value;");const w=Object.create(null);let v=0;for(const h of p.keys)w[h]=`key_${v++}`;
f.write("const newResult = {}");for(const h of p.keys)if(p.optionalKeys.has(h)){const y=w[h];f.write(`const ${y} = ${m(h)};`);const b=yp(h);f.write(`
        if (${y}.issues.length) {
          if (input[${b}] === undefined) {
            if (${b} in input) {
              newResult[${b}] = undefined;
            }
          } else {
            payload.issues = payload.issues.concat(
              ${y}.issues.map((iss) => ({
                ...iss,
                path: iss.path ? [${b}, ...iss.path] : [${b}],
              }))
            );
          }
        } else if (${y}.value === undefined) {
          if (${b} in input) newResult[${b}] = undefined;
        } else {
          newResult[${b}] = ${y}.value;
        }
        `)}else{const y=w[h];f.write(`const ${y} = ${m(h)};`),f.write(`
          if (${y}.issues.length) payload.issues = payload.issues.concat(${y}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${yp(h)}, ...iss.path] : [${yp(h)}]
          })));`),f.write(`newResult[${yp(h)}] = ${y}.value`)}f.write("payload.value = newResult;"),f.write("return payload;");const g=f.compile();return(h,y)=>g(d,h,y)};let i;const s=ky,a=!iD.jitless,l=a&&J7.value,c=e.catchall;let u;t._zod.parse=(d,f)=>{u??(u=n.value);const p=d.value;if(!s(p))return d.issues.push({expected:"object",code:"invalid_type",input:p,inst:t}),d;const m=[];if(a&&l&&f?.async===!1&&f.jitless!==!0)i||(i=r(e.shape)),d=i(d,f);else{d.value={};const y=u.shape;for(const b of u.
keys){const R=y[b],T=R._zod.run({value:p[b],issues:[]},f),N=R._zod.optin==="optional"&&R._zod.optout==="optional";T instanceof Promise?m.push(T.then(q=>N?RD(q,d,b,p):Ty(q,d,b))):N?RD(T,d,b,p):Ty(T,d,b)}}if(!c)return m.length?Promise.all(m).then(()=>d):d;const w=[],v=u.keySet,g=c._zod,h=g.def.type;for(const y of Object.keys(p)){if(v.has(y))continue;if(h==="never"){w.push(y);continue}const b=g.run({value:p[y],issues:[]},f);b instanceof Promise?m.push(b.then(R=>Ty(R,d,y))):Ty(b,d,y)}return w.length&&
d.issues.push({code:"unrecognized_keys",keys:w,input:p,inst:t}),m.length?Promise.all(m).then(()=>d):d}});function $D(t,e,n,r){for(const i of t)if(i.issues.length===0)return e.value=i.value,e;return e.issues.push({code:"invalid_union",input:e.value,inst:n,errors:t.map(i=>i.issues.map(s=>Sa(s,r,_a())))}),e}const TD=de("$ZodUnion",(t,e)=>{Ut.init(t,e),zt(t._zod,"optin",()=>e.options.some(n=>n._zod.optin==="optional")?"optional":void 0),zt(t._zod,"optout",()=>e.options.some(n=>n._zod.optout==="optio\
nal")?"optional":void 0),zt(t._zod,"values",()=>{if(e.options.every(n=>n._zod.values))return new Set(e.options.flatMap(n=>Array.from(n._zod.values)))}),zt(t._zod,"pattern",()=>{if(e.options.every(n=>n._zod.pattern)){const n=e.options.map(r=>r._zod.pattern);return new RegExp(`^(${n.map(r=>oR(r.source)).join("|")})$`)}}),t._zod.parse=(n,r)=>{let i=!1;const s=[];for(const a of e.options){const o=a._zod.run({value:n.value,issues:[]},r);if(o instanceof Promise)s.push(o),i=!0;else{if(o.issues.length===
0)return o;s.push(o)}}return i?Promise.all(s).then(a=>$D(a,n,t,r)):$D(s,n,t,r)}}),CY=de("$ZodDiscriminatedUnion",(t,e)=>{TD.init(t,e);const n=t._zod.parse;zt(t._zod,"propValues",()=>{const i={};for(const s of e.options){const a=s._zod.propValues;if(!a||Object.keys(a).length===0)throw new Error(`Invalid discriminated union option at index "${e.options.indexOf(s)}"`);for(const[o,l]of Object.entries(a)){i[o]||(i[o]=new Set);for(const c of l)i[o].add(c)}}return i});const r=sR(()=>{const i=e.options,
s=new Map;for(const a of i){const o=a._zod.propValues[e.discriminator];if(!o||o.size===0)throw new Error(`Invalid discriminated union option at index "${e.options.indexOf(a)}"`);for(const l of o){if(s.has(l))throw new Error(`Duplicate discriminator value "${String(l)}"`);s.set(l,a)}}return s});t._zod.parse=(i,s)=>{const a=i.value;if(!ky(a))return i.issues.push({code:"invalid_type",expected:"object",input:a,inst:t}),i;const o=r.value.get(a?.[e.discriminator]);return o?o._zod.run(i,s):e.unionFallback?
n(i,s):(i.issues.push({code:"invalid_union",errors:[],note:"No matching discriminator",input:a,path:[e.discriminator],inst:t}),i)}}),xY=de("$ZodIntersection",(t,e)=>{Ut.init(t,e),t._zod.parse=(n,r)=>{const i=n.value,s=e.left._zod.run({value:i,issues:[]},r),a=e.right._zod.run({value:i,issues:[]},r);return s instanceof Promise||a instanceof Promise?Promise.all([s,a]).then(([l,c])=>ED(n,l,c)):ED(n,s,a)}});function fR(t,e){if(t===e)return{valid:!0,data:t};if(t instanceof Date&&e instanceof Date&&+t==
+e)return{valid:!0,data:t};if(_y(t)&&_y(e)){const n=Object.keys(e),r=Object.keys(t).filter(s=>n.indexOf(s)!==-1),i={...t,...e};for(const s of r){const a=fR(t[s],e[s]);if(!a.valid)return{valid:!1,mergeErrorPath:[s,...a.mergeErrorPath]};i[s]=a.data}return{valid:!0,data:i}}if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return{valid:!1,mergeErrorPath:[]};const n=[];for(let r=0;r<t.length;r++){const i=t[r],s=e[r],a=fR(i,s);if(!a.valid)return{valid:!1,mergeErrorPath:[r,...a.mergeErrorPath]};
n.push(a.data)}return{valid:!0,data:n}}return{valid:!1,mergeErrorPath:[]}}function ED(t,e,n){if(e.issues.length&&t.issues.push(...e.issues),n.issues.length&&t.issues.push(...n.issues),wp(t))return t;const r=fR(e.value,n.value);if(!r.valid)throw new Error(`Unmergable intersection. Error path: ${JSON.stringify(r.mergeErrorPath)}`);return t.value=r.data,t}const AY=de("$ZodRecord",(t,e)=>{Ut.init(t,e),t._zod.parse=(n,r)=>{const i=n.value;if(!_y(i))return n.issues.push({expected:"record",code:"invali\
d_type",input:i,inst:t}),n;const s=[];if(e.keyType._zod.values){const a=e.keyType._zod.values;n.value={};for(const l of a)if(typeof l=="string"||typeof l=="number"||typeof l=="symbol"){const c=e.valueType._zod.run({value:i[l],issues:[]},r);c instanceof Promise?s.push(c.then(u=>{u.issues.length&&n.issues.push(...Lo(l,u.issues)),n.value[l]=u.value})):(c.issues.length&&n.issues.push(...Lo(l,c.issues)),n.value[l]=c.value)}let o;for(const l in i)a.has(l)||(o=o??[],o.push(l));o&&o.length>0&&n.issues.push(
{code:"unrecognized_keys",input:i,inst:t,keys:o})}else{n.value={};for(const a of Reflect.ownKeys(i)){if(a==="__proto__")continue;const o=e.keyType._zod.run({value:a,issues:[]},r);if(o instanceof Promise)throw new Error("Async schemas not supported in object keys currently");if(o.issues.length){n.issues.push({origin:"record",code:"invalid_key",issues:o.issues.map(c=>Sa(c,r,_a())),input:a,path:[a],inst:t}),n.value[o.value]=o.value;continue}const l=e.valueType._zod.run({value:i[a],issues:[]},r);l instanceof
Promise?s.push(l.then(c=>{c.issues.length&&n.issues.push(...Lo(a,c.issues)),n.value[o.value]=c.value})):(l.issues.length&&n.issues.push(...Lo(a,l.issues)),n.value[o.value]=l.value)}}return s.length?Promise.all(s).then(()=>n):n}}),IY=de("$ZodEnum",(t,e)=>{Ut.init(t,e);const n=sD(e.entries);t._zod.values=new Set(n),t._zod.pattern=new RegExp(`^(${n.filter(r=>Y7.has(typeof r)).map(r=>typeof r=="string"?vp(r):r.toString()).join("|")})$`),t._zod.parse=(r,i)=>{const s=r.value;return t._zod.values.has(s)||
r.issues.push({code:"invalid_value",values:n,input:s,inst:t}),r}}),NY=de("$ZodLiteral",(t,e)=>{Ut.init(t,e),t._zod.values=new Set(e.values),t._zod.pattern=new RegExp(`^(${e.values.map(n=>typeof n=="string"?vp(n):n?n.toString():String(n)).join("|")})$`),t._zod.parse=(n,r)=>{const i=n.value;return t._zod.values.has(i)||n.issues.push({code:"invalid_value",values:e.values,input:i,inst:t}),n}}),DY=de("$ZodTransform",(t,e)=>{Ut.init(t,e),t._zod.parse=(n,r)=>{const i=e.transform(n.value,n);if(r.async)return(i instanceof
Promise?i:Promise.resolve(i)).then(a=>(n.value=a,n));if(i instanceof Promise)throw new mp;return n.value=i,n}}),OY=de("$ZodOptional",(t,e)=>{Ut.init(t,e),t._zod.optin="optional",t._zod.optout="optional",zt(t._zod,"values",()=>e.innerType._zod.values?new Set([...e.innerType._zod.values,void 0]):void 0),zt(t._zod,"pattern",()=>{const n=e.innerType._zod.pattern;return n?new RegExp(`^(${oR(n.source)})?$`):void 0}),t._zod.parse=(n,r)=>e.innerType._zod.optin==="optional"?e.innerType._zod.run(n,r):n.value===
void 0?n:e.innerType._zod.run(n,r)}),LY=de("$ZodNullable",(t,e)=>{Ut.init(t,e),zt(t._zod,"optin",()=>e.innerType._zod.optin),zt(t._zod,"optout",()=>e.innerType._zod.optout),zt(t._zod,"pattern",()=>{const n=e.innerType._zod.pattern;return n?new RegExp(`^(${oR(n.source)}|null)$`):void 0}),zt(t._zod,"values",()=>e.innerType._zod.values?new Set([...e.innerType._zod.values,null]):void 0),t._zod.parse=(n,r)=>n.value===null?n:e.innerType._zod.run(n,r)}),MY=de("$ZodDefault",(t,e)=>{Ut.init(t,e),t._zod.optin=
"optional",zt(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(n,r)=>{if(n.value===void 0)return n.value=e.defaultValue,n;const i=e.innerType._zod.run(n,r);return i instanceof Promise?i.then(s=>PD(s,e)):PD(i,e)}});function PD(t,e){return t.value===void 0&&(t.value=e.defaultValue),t}const jY=de("$ZodPrefault",(t,e)=>{Ut.init(t,e),t._zod.optin="optional",zt(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(n,r)=>(n.value===void 0&&(n.value=e.defaultValue),e.innerType._zod.run(n,
r))}),qY=de("$ZodNonOptional",(t,e)=>{Ut.init(t,e),zt(t._zod,"values",()=>{const n=e.innerType._zod.values;return n?new Set([...n].filter(r=>r!==void 0)):void 0}),t._zod.parse=(n,r)=>{const i=e.innerType._zod.run(n,r);return i instanceof Promise?i.then(s=>CD(s,t)):CD(i,t)}});function CD(t,e){return!t.issues.length&&t.value===void 0&&t.issues.push({code:"invalid_type",expected:"nonoptional",input:t.value,inst:e}),t}const FY=de("$ZodCatch",(t,e)=>{Ut.init(t,e),t._zod.optin="optional",zt(t._zod,"op\
tout",()=>e.innerType._zod.optout),zt(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(n,r)=>{const i=e.innerType._zod.run(n,r);return i instanceof Promise?i.then(s=>(n.value=s.value,s.issues.length&&(n.value=e.catchValue({...n,error:{issues:s.issues.map(a=>Sa(a,r,_a()))},input:n.value}),n.issues=[]),n)):(n.value=i.value,i.issues.length&&(n.value=e.catchValue({...n,error:{issues:i.issues.map(s=>Sa(s,r,_a()))},input:n.value}),n.issues=[]),n)}}),zY=de("$ZodPipe",(t,e)=>{Ut.init(t,e),zt(t.
_zod,"values",()=>e.in._zod.values),zt(t._zod,"optin",()=>e.in._zod.optin),zt(t._zod,"optout",()=>e.out._zod.optout),t._zod.parse=(n,r)=>{const i=e.in._zod.run(n,r);return i instanceof Promise?i.then(s=>xD(s,e,r)):xD(i,e,r)}});function xD(t,e,n){return wp(t)?t:e.out._zod.run({value:t.value,issues:t.issues},n)}const UY=de("$ZodReadonly",(t,e)=>{Ut.init(t,e),zt(t._zod,"propValues",()=>e.innerType._zod.propValues),zt(t._zod,"values",()=>e.innerType._zod.values),zt(t._zod,"optin",()=>e.innerType._zod.
optin),zt(t._zod,"optout",()=>e.innerType._zod.optout),t._zod.parse=(n,r)=>{const i=e.innerType._zod.run(n,r);return i instanceof Promise?i.then(AD):AD(i)}});function AD(t){return t.value=Object.freeze(t.value),t}const HY=de("$ZodCustom",(t,e)=>{Tr.init(t,e),Ut.init(t,e),t._zod.parse=(n,r)=>n,t._zod.check=n=>{const r=n.value,i=e.fn(r);if(i instanceof Promise)return i.then(s=>ID(s,n,r,t));ID(i,n,r,t)}});function ID(t,e,n,r){if(!t){const i={code:"custom",input:n,inst:r,path:[...r._zod.def.path??[]],
continue:!r._zod.def.abort};r._zod.def.params&&(i.params=r._zod.def.params),e.issues.push(bp(i))}}class ND{constructor(){this._map=new Map,this._idmap=new Map}add(e,...n){const r=n[0];if(this._map.set(e,r),r&&typeof r=="object"&&"id"in r){if(this._idmap.has(r.id))throw new Error(`ID ${r.id} already exists in the registry`);this._idmap.set(r.id,e)}return this}clear(){return this._map=new Map,this._idmap=new Map,this}remove(e){const n=this._map.get(e);return n&&typeof n=="object"&&"id"in n&&this._idmap.
delete(n.id),this._map.delete(e),this}get(e){const n=e._zod.parent;if(n){const r={...this.get(n)??{}};return delete r.id,{...r,...this._map.get(e)}}return this._map.get(e)}has(e){return this._map.has(e)}}function VY(){return new ND}const kp=VY();function BY(t,e){return new t({type:"string",...Ae(e)})}function WY(t,e){return new t({type:"string",format:"email",check:"string_format",abort:!1,...Ae(e)})}function DD(t,e){return new t({type:"string",format:"guid",check:"string_format",abort:!1,...Ae(
e)})}function GY(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,...Ae(e)})}function KY(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...Ae(e)})}function ZY(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...Ae(e)})}function JY(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...Ae(e)})}function YY(t,e){return new t({type:"string",format:"\
url",check:"string_format",abort:!1,...Ae(e)})}function XY(t,e){return new t({type:"string",format:"emoji",check:"string_format",abort:!1,...Ae(e)})}function QY(t,e){return new t({type:"string",format:"nanoid",check:"string_format",abort:!1,...Ae(e)})}function eX(t,e){return new t({type:"string",format:"cuid",check:"string_format",abort:!1,...Ae(e)})}function tX(t,e){return new t({type:"string",format:"cuid2",check:"string_format",abort:!1,...Ae(e)})}function nX(t,e){return new t({type:"string",
format:"ulid",check:"string_format",abort:!1,...Ae(e)})}function rX(t,e){return new t({type:"string",format:"xid",check:"string_format",abort:!1,...Ae(e)})}function iX(t,e){return new t({type:"string",format:"ksuid",check:"string_format",abort:!1,...Ae(e)})}function sX(t,e){return new t({type:"string",format:"ipv4",check:"string_format",abort:!1,...Ae(e)})}function aX(t,e){return new t({type:"string",format:"ipv6",check:"string_format",abort:!1,...Ae(e)})}function oX(t,e){return new t({type:"str\
ing",format:"cidrv4",check:"string_format",abort:!1,...Ae(e)})}function lX(t,e){return new t({type:"string",format:"cidrv6",check:"string_format",abort:!1,...Ae(e)})}function cX(t,e){return new t({type:"string",format:"base64",check:"string_format",abort:!1,...Ae(e)})}function uX(t,e){return new t({type:"string",format:"base64url",check:"string_format",abort:!1,...Ae(e)})}function dX(t,e){return new t({type:"string",format:"e164",check:"string_format",abort:!1,...Ae(e)})}function fX(t,e){return new t(
{type:"string",format:"jwt",check:"string_format",abort:!1,...Ae(e)})}function pX(t,e){return new t({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...Ae(e)})}function hX(t,e){return new t({type:"string",format:"date",check:"string_format",...Ae(e)})}function mX(t,e){return new t({type:"string",format:"time",check:"string_format",precision:null,...Ae(e)})}function gX(t,e){return new t({type:"string",format:"duration",check:"string_format",...Ae(e)})}function yX(t,e){
return new t({type:"number",checks:[],...Ae(e)})}function vX(t,e){return new t({type:"number",check:"number_format",abort:!1,format:"safeint",...Ae(e)})}function wX(t,e){return new t({type:"boolean",...Ae(e)})}function bX(t,e){return new t({type:"null",...Ae(e)})}function kX(t){return new t({type:"unknown"})}function _X(t,e){return new t({type:"never",...Ae(e)})}function OD(t,e){return new vD({check:"less_than",...Ae(e),value:t,inclusive:!1})}function pR(t,e){return new vD({check:"less_than",...Ae(
e),value:t,inclusive:!0})}function LD(t,e){return new wD({check:"greater_than",...Ae(e),value:t,inclusive:!1})}function hR(t,e){return new wD({check:"greater_than",...Ae(e),value:t,inclusive:!0})}function MD(t,e){return new jJ({check:"multiple_of",...Ae(e),value:t})}function jD(t,e){return new FJ({check:"max_length",...Ae(e),maximum:t})}function Ey(t,e){return new zJ({check:"min_length",...Ae(e),minimum:t})}function qD(t,e){return new UJ({check:"length_equals",...Ae(e),length:t})}function RX(t,e){
return new HJ({check:"string_format",format:"regex",...Ae(e),pattern:t})}function SX(t){return new VJ({check:"string_format",format:"lowercase",...Ae(t)})}function $X(t){return new BJ({check:"string_format",format:"uppercase",...Ae(t)})}function TX(t,e){return new WJ({check:"string_format",format:"includes",...Ae(e),includes:t})}function EX(t,e){return new GJ({check:"string_format",format:"starts_with",...Ae(e),prefix:t})}function PX(t,e){return new KJ({check:"string_format",format:"ends_with",...Ae(
e),suffix:t})}function _p(t){return new ZJ({check:"overwrite",tx:t})}function CX(t){return _p(e=>e.normalize(t))}function xX(){return _p(t=>t.trim())}function AX(){return _p(t=>t.toLowerCase())}function IX(){return _p(t=>t.toUpperCase())}function NX(t,e,n){return new t({type:"array",element:e,...Ae(n)})}function DX(t,e,n){const r=Ae(n);return r.abort??(r.abort=!0),new t({type:"custom",check:"custom",fn:e,...r})}function OX(t,e,n){return new t({type:"custom",check:"custom",fn:e,...Ae(n)})}class FD{constructor(e){
this.counter=0,this.metadataRegistry=e?.metadata??kp,this.target=e?.target??"draft-2020-12",this.unrepresentable=e?.unrepresentable??"throw",this.override=e?.override??(()=>{}),this.io=e?.io??"output",this.seen=new Map}process(e,n={path:[],schemaPath:[]}){var r;const i=e._zod.def,s={guid:"uuid",url:"uri",datetime:"date-time",json_string:"json-string",regex:""},a=this.seen.get(e);if(a)return a.count++,n.schemaPath.includes(e)&&(a.cycle=n.path),a.schema;const o={schema:{},count:1,cycle:void 0,path:n.
path};this.seen.set(e,o);const l=e._zod.toJSONSchema?.();if(l)o.schema=l;else{const d={...n,schemaPath:[...n.schemaPath,e],path:n.path},f=e._zod.parent;if(f)o.ref=f,this.process(f,d),this.seen.get(f).isParent=!0;else{const p=o.schema;switch(i.type){case"string":{const m=p;m.type="string";const{minimum:w,maximum:v,format:g,patterns:h,contentEncoding:y}=e._zod.bag;if(typeof w=="number"&&(m.minLength=w),typeof v=="number"&&(m.maxLength=v),g&&(m.format=s[g]??g,m.format===""&&delete m.format),y&&(m.contentEncoding=
y),h&&h.size>0){const b=[...h];b.length===1?m.pattern=b[0].source:b.length>1&&(o.schema.allOf=[...b.map(R=>({...this.target==="draft-7"?{type:"string"}:{},pattern:R.source}))])}break}case"number":{const m=p,{minimum:w,maximum:v,format:g,multipleOf:h,exclusiveMaximum:y,exclusiveMinimum:b}=e._zod.bag;typeof g=="string"&&g.includes("int")?m.type="integer":m.type="number",typeof b=="number"&&(m.exclusiveMinimum=b),typeof w=="number"&&(m.minimum=w,typeof b=="number"&&(b>=w?delete m.minimum:delete m.exclusiveMinimum)),
typeof y=="number"&&(m.exclusiveMaximum=y),typeof v=="number"&&(m.maximum=v,typeof y=="number"&&(y<=v?delete m.maximum:delete m.exclusiveMaximum)),typeof h=="number"&&(m.multipleOf=h);break}case"boolean":{const m=p;m.type="boolean";break}case"bigint":{if(this.unrepresentable==="throw")throw new Error("BigInt cannot be represented in JSON Schema");break}case"symbol":{if(this.unrepresentable==="throw")throw new Error("Symbols cannot be represented in JSON Schema");break}case"null":{p.type="null";break}case"\
any":break;case"unknown":break;case"undefined":{if(this.unrepresentable==="throw")throw new Error("Undefined cannot be represented in JSON Schema");break}case"void":{if(this.unrepresentable==="throw")throw new Error("Void cannot be represented in JSON Schema");break}case"never":{p.not={};break}case"date":{if(this.unrepresentable==="throw")throw new Error("Date cannot be represented in JSON Schema");break}case"array":{const m=p,{minimum:w,maximum:v}=e._zod.bag;typeof w=="number"&&(m.minItems=w),typeof v==
"number"&&(m.maxItems=v),m.type="array",m.items=this.process(i.element,{...d,path:[...d.path,"items"]});break}case"object":{const m=p;m.type="object",m.properties={};const w=i.shape;for(const h in w)m.properties[h]=this.process(w[h],{...d,path:[...d.path,"properties",h]});const v=new Set(Object.keys(w)),g=new Set([...v].filter(h=>{const y=i.shape[h]._zod;return this.io==="input"?y.optin===void 0:y.optout===void 0}));g.size>0&&(m.required=Array.from(g)),i.catchall?._zod.def.type==="never"?m.additionalProperties=
!1:i.catchall?i.catchall&&(m.additionalProperties=this.process(i.catchall,{...d,path:[...d.path,"additionalProperties"]})):this.io==="output"&&(m.additionalProperties=!1);break}case"union":{const m=p;m.anyOf=i.options.map((w,v)=>this.process(w,{...d,path:[...d.path,"anyOf",v]}));break}case"intersection":{const m=p,w=this.process(i.left,{...d,path:[...d.path,"allOf",0]}),v=this.process(i.right,{...d,path:[...d.path,"allOf",1]}),g=y=>"allOf"in y&&Object.keys(y).length===1,h=[...g(w)?w.allOf:[w],...g(
v)?v.allOf:[v]];m.allOf=h;break}case"tuple":{const m=p;m.type="array";const w=i.items.map((h,y)=>this.process(h,{...d,path:[...d.path,"prefixItems",y]}));if(this.target==="draft-2020-12"?m.prefixItems=w:m.items=w,i.rest){const h=this.process(i.rest,{...d,path:[...d.path,"items"]});this.target==="draft-2020-12"?m.items=h:m.additionalItems=h}i.rest&&(m.items=this.process(i.rest,{...d,path:[...d.path,"items"]}));const{minimum:v,maximum:g}=e._zod.bag;typeof v=="number"&&(m.minItems=v),typeof g=="num\
ber"&&(m.maxItems=g);break}case"record":{const m=p;m.type="object",m.propertyNames=this.process(i.keyType,{...d,path:[...d.path,"propertyNames"]}),m.additionalProperties=this.process(i.valueType,{...d,path:[...d.path,"additionalProperties"]});break}case"map":{if(this.unrepresentable==="throw")throw new Error("Map cannot be represented in JSON Schema");break}case"set":{if(this.unrepresentable==="throw")throw new Error("Set cannot be represented in JSON Schema");break}case"enum":{const m=p,w=sD(i.
entries);w.every(v=>typeof v=="number")&&(m.type="number"),w.every(v=>typeof v=="string")&&(m.type="string"),m.enum=w;break}case"literal":{const m=p,w=[];for(const v of i.values)if(v===void 0){if(this.unrepresentable==="throw")throw new Error("Literal `undefined` cannot be represented in JSON Schema")}else if(typeof v=="bigint"){if(this.unrepresentable==="throw")throw new Error("BigInt literals cannot be represented in JSON Schema");w.push(Number(v))}else w.push(v);if(w.length!==0)if(w.length===
1){const v=w[0];m.type=v===null?"null":typeof v,m.const=v}else w.every(v=>typeof v=="number")&&(m.type="number"),w.every(v=>typeof v=="string")&&(m.type="string"),w.every(v=>typeof v=="boolean")&&(m.type="string"),w.every(v=>v===null)&&(m.type="null"),m.enum=w;break}case"file":{const m=p,w={type:"string",format:"binary",contentEncoding:"binary"},{minimum:v,maximum:g,mime:h}=e._zod.bag;v!==void 0&&(w.minLength=v),g!==void 0&&(w.maxLength=g),h?h.length===1?(w.contentMediaType=h[0],Object.assign(m,
w)):m.anyOf=h.map(y=>({...w,contentMediaType:y})):Object.assign(m,w);break}case"transform":{if(this.unrepresentable==="throw")throw new Error("Transforms cannot be represented in JSON Schema");break}case"nullable":{const m=this.process(i.innerType,d);p.anyOf=[m,{type:"null"}];break}case"nonoptional":{this.process(i.innerType,d),o.ref=i.innerType;break}case"success":{const m=p;m.type="boolean";break}case"default":{this.process(i.innerType,d),o.ref=i.innerType,p.default=JSON.parse(JSON.stringify(i.
defaultValue));break}case"prefault":{this.process(i.innerType,d),o.ref=i.innerType,this.io==="input"&&(p._prefault=JSON.parse(JSON.stringify(i.defaultValue)));break}case"catch":{this.process(i.innerType,d),o.ref=i.innerType;let m;try{m=i.catchValue(void 0)}catch{throw new Error("Dynamic catch values are not supported in JSON Schema")}p.default=m;break}case"nan":{if(this.unrepresentable==="throw")throw new Error("NaN cannot be represented in JSON Schema");break}case"template_literal":{const m=p,w=e.
_zod.pattern;if(!w)throw new Error("Pattern not found in template literal");m.type="string",m.pattern=w.source;break}case"pipe":{const m=this.io==="input"?i.in._zod.def.type==="transform"?i.out:i.in:i.out;this.process(m,d),o.ref=m;break}case"readonly":{this.process(i.innerType,d),o.ref=i.innerType,p.readOnly=!0;break}case"promise":{this.process(i.innerType,d),o.ref=i.innerType;break}case"optional":{this.process(i.innerType,d),o.ref=i.innerType;break}case"lazy":{const m=e._zod.innerType;this.process(
m,d),o.ref=m;break}case"custom":{if(this.unrepresentable==="throw")throw new Error("Custom types cannot be represented in JSON Schema");break}}}}const c=this.metadataRegistry.get(e);return c&&Object.assign(o.schema,c),this.io==="input"&&Tn(e)&&(delete o.schema.examples,delete o.schema.default),this.io==="input"&&o.schema._prefault&&((r=o.schema).default??(r.default=o.schema._prefault)),delete o.schema._prefault,this.seen.get(e).schema}emit(e,n){const r={cycles:n?.cycles??"ref",reused:n?.reused??
"inline",external:n?.external??void 0},i=this.seen.get(e);if(!i)throw new Error("Unprocessed schema. This is a bug in Zod.");const s=u=>{const d=this.target==="draft-2020-12"?"$defs":"definitions";if(r.external){const w=r.external.registry.get(u[0])?.id,v=r.external.uri??(h=>h);if(w)return{ref:v(w)};const g=u[1].defId??u[1].schema.id??`schema${this.counter++}`;return u[1].defId=g,{defId:g,ref:`${v("__shared")}#/${d}/${g}`}}if(u[1]===i)return{ref:"#"};const p=`#/${d}/`,m=u[1].schema.id??`__schema${this.
counter++}`;return{defId:m,ref:p+m}},a=u=>{if(u[1].schema.$ref)return;const d=u[1],{ref:f,defId:p}=s(u);d.def={...d.schema},p&&(d.defId=p);const m=d.schema;for(const w in m)delete m[w];m.$ref=f};if(r.cycles==="throw")for(const u of this.seen.entries()){const d=u[1];if(d.cycle)throw new Error(`Cycle detected: #/${d.cycle?.join("/")}/<root>

Set the \`cycles\` parameter to \`"ref"\` to resolve cyclical schemas with defs.`)}for(const u of this.seen.entries()){const d=u[1];if(e===u[0]){a(u);continue}if(r.external){const p=r.external.registry.get(u[0])?.id;if(e!==u[0]&&p){a(u);continue}}if(this.metadataRegistry.get(u[0])?.id){a(u);continue}if(d.cycle){a(u);continue}if(d.count>1&&r.reused==="ref"){a(u);continue}}const o=(u,d)=>{const f=this.seen.get(u),p=f.def??f.schema,m={...p};if(f.ref===null)return;const w=f.ref;if(f.ref=null,w){o(w,
d);const v=this.seen.get(w).schema;v.$ref&&d.target==="draft-7"?(p.allOf=p.allOf??[],p.allOf.push(v)):(Object.assign(p,v),Object.assign(p,m))}f.isParent||this.override({zodSchema:u,jsonSchema:p,path:f.path??[]})};for(const u of[...this.seen.entries()].reverse())o(u[0],{target:this.target});const l={};if(this.target==="draft-2020-12"?l.$schema="https://json-schema.org/draft/2020-12/schema":this.target==="draft-7"?l.$schema="http://json-schema.org/draft-07/schema#":console.warn(`Invalid target: ${this.
target}`),r.external?.uri){const u=r.external.registry.get(e)?.id;if(!u)throw new Error("Schema is missing an `id` property");l.$id=r.external.uri(u)}Object.assign(l,i.def);const c=r.external?.defs??{};for(const u of this.seen.entries()){const d=u[1];d.def&&d.defId&&(c[d.defId]=d.def)}r.external||Object.keys(c).length>0&&(this.target==="draft-2020-12"?l.$defs=c:l.definitions=c);try{return JSON.parse(JSON.stringify(l))}catch{throw new Error("Error converting schema to JSON.")}}}function LX(t,e){if(t instanceof
ND){const r=new FD(e),i={};for(const o of t._idmap.entries()){const[l,c]=o;r.process(c)}const s={},a={registry:t,uri:e?.uri,defs:i};for(const o of t._idmap.entries()){const[l,c]=o;s[l]=r.emit(c,{...e,external:a})}if(Object.keys(i).length>0){const o=r.target==="draft-2020-12"?"$defs":"definitions";s.__shared={[o]:i}}return{schemas:s}}const n=new FD(e);return n.process(t),n.emit(t,e)}function Tn(t,e){const n=e??{seen:new Set};if(n.seen.has(t))return!1;n.seen.add(t);const i=t._zod.def;switch(i.type){case"\
string":case"number":case"bigint":case"boolean":case"date":case"symbol":case"undefined":case"null":case"any":case"unknown":case"never":case"void":case"literal":case"enum":case"nan":case"file":case"template_literal":return!1;case"array":return Tn(i.element,n);case"object":{for(const s in i.shape)if(Tn(i.shape[s],n))return!0;return!1}case"union":{for(const s of i.options)if(Tn(s,n))return!0;return!1}case"intersection":return Tn(i.left,n)||Tn(i.right,n);case"tuple":{for(const s of i.items)if(Tn(s,n))
return!0;return!!(i.rest&&Tn(i.rest,n))}case"record":return Tn(i.keyType,n)||Tn(i.valueType,n);case"map":return Tn(i.keyType,n)||Tn(i.valueType,n);case"set":return Tn(i.valueType,n);case"promise":case"optional":case"nonoptional":case"nullable":case"readonly":return Tn(i.innerType,n);case"lazy":return Tn(i.getter(),n);case"default":return Tn(i.innerType,n);case"prefault":return Tn(i.innerType,n);case"custom":return!1;case"transform":return!0;case"pipe":return Tn(i.in,n)||Tn(i.out,n);case"success":
return!1;case"catch":return!1}throw new Error(`Unknown schema type: ${i.type}`)}const MX=de("ZodISODateTime",(t,e)=>{cY.init(t,e),sn.init(t,e)});function zD(t){return pX(MX,t)}const jX=de("ZodISODate",(t,e)=>{uY.init(t,e),sn.init(t,e)});function qX(t){return hX(jX,t)}const FX=de("ZodISOTime",(t,e)=>{dY.init(t,e),sn.init(t,e)});function zX(t){return mX(FX,t)}const UX=de("ZodISODuration",(t,e)=>{fY.init(t,e),sn.init(t,e)});function HX(t){return gX(UX,t)}const VX=(t,e)=>{lD.init(t,e),t.name="ZodErr\
or",Object.defineProperties(t,{format:{value:n=>oJ(t,n)},flatten:{value:n=>aJ(t,n)},addIssue:{value:n=>t.issues.push(n)},addIssues:{value:n=>t.issues.push(...n)},isEmpty:{get(){return t.issues.length===0}}})},Py=de("ZodError",VX,{Parent:Error}),BX=cD(Py),WX=uD(Py),GX=dD(Py),KX=fD(Py),rn=de("ZodType",(t,e)=>(Ut.init(t,e),t.def=e,Object.defineProperty(t,"_def",{value:e}),t.check=(...n)=>t.clone({...e,checks:[...e.checks??[],...n.map(r=>typeof r=="function"?{_zod:{check:r,def:{check:"custom"},onattach:[]}}:
r)]}),t.clone=(n,r)=>Ra(t,n,r),t.brand=()=>t,t.register=((n,r)=>(n.add(t,r),t)),t.parse=(n,r)=>BX(t,n,r,{callee:t.parse}),t.safeParse=(n,r)=>GX(t,n,r),t.parseAsync=async(n,r)=>WX(t,n,r,{callee:t.parseAsync}),t.safeParseAsync=async(n,r)=>KX(t,n,r),t.spa=t.safeParseAsync,t.refine=(n,r)=>t.check(jQ(n,r)),t.superRefine=n=>t.check(qQ(n)),t.overwrite=n=>t.check(_p(n)),t.optional=()=>fn(t),t.nullable=()=>XD(t),t.nullish=()=>fn(XD(t)),t.nonoptional=n=>xQ(t,n),t.array=()=>mt(t),t.or=n=>Kt([t,n]),t.and=n=>mR(
t,n),t.transform=n=>yR(t,JD(n)),t.default=n=>EQ(t,n),t.prefault=n=>CQ(t,n),t.catch=n=>IQ(t,n),t.pipe=n=>yR(t,n),t.readonly=()=>OQ(t),t.describe=n=>{const r=t.clone();return kp.add(r,{description:n}),r},Object.defineProperty(t,"description",{get(){return kp.get(t)?.description},configurable:!0}),t.meta=(...n)=>{if(n.length===0)return kp.get(t);const r=t.clone();return kp.add(r,n[0]),r},t.isOptional=()=>t.safeParse(void 0).success,t.isNullable=()=>t.safeParse(null).success,t)),UD=de("_ZodString",(t,e)=>{
dR.init(t,e),rn.init(t,e);const n=t._zod.bag;t.format=n.format??null,t.minLength=n.minimum??null,t.maxLength=n.maximum??null,t.regex=(...r)=>t.check(RX(...r)),t.includes=(...r)=>t.check(TX(...r)),t.startsWith=(...r)=>t.check(EX(...r)),t.endsWith=(...r)=>t.check(PX(...r)),t.min=(...r)=>t.check(Ey(...r)),t.max=(...r)=>t.check(jD(...r)),t.length=(...r)=>t.check(qD(...r)),t.nonempty=(...r)=>t.check(Ey(1,...r)),t.lowercase=r=>t.check(SX(r)),t.uppercase=r=>t.check($X(r)),t.trim=()=>t.check(xX()),t.normalize=
(...r)=>t.check(CX(...r)),t.toLowerCase=()=>t.check(AX()),t.toUpperCase=()=>t.check(IX())}),ZX=de("ZodString",(t,e)=>{dR.init(t,e),UD.init(t,e),t.email=n=>t.check(WY(JX,n)),t.url=n=>t.check(YY(YX,n)),t.jwt=n=>t.check(fX(fQ,n)),t.emoji=n=>t.check(XY(XX,n)),t.guid=n=>t.check(DD(HD,n)),t.uuid=n=>t.check(GY(Cy,n)),t.uuidv4=n=>t.check(KY(Cy,n)),t.uuidv6=n=>t.check(ZY(Cy,n)),t.uuidv7=n=>t.check(JY(Cy,n)),t.nanoid=n=>t.check(QY(QX,n)),t.guid=n=>t.check(DD(HD,n)),t.cuid=n=>t.check(eX(eQ,n)),t.cuid2=n=>t.
check(tX(tQ,n)),t.ulid=n=>t.check(nX(nQ,n)),t.base64=n=>t.check(cX(cQ,n)),t.base64url=n=>t.check(uX(uQ,n)),t.xid=n=>t.check(rX(rQ,n)),t.ksuid=n=>t.check(iX(iQ,n)),t.ipv4=n=>t.check(sX(sQ,n)),t.ipv6=n=>t.check(aX(aQ,n)),t.cidrv4=n=>t.check(oX(oQ,n)),t.cidrv6=n=>t.check(lX(lQ,n)),t.e164=n=>t.check(dX(dQ,n)),t.datetime=n=>t.check(zD(n)),t.date=n=>t.check(qX(n)),t.time=n=>t.check(zX(n)),t.duration=n=>t.check(HX(n))});function oe(t){return BY(ZX,t)}const sn=de("ZodStringFormat",(t,e)=>{Jt.init(t,e),UD.
init(t,e)}),JX=de("ZodEmail",(t,e)=>{eY.init(t,e),sn.init(t,e)}),HD=de("ZodGUID",(t,e)=>{XJ.init(t,e),sn.init(t,e)}),Cy=de("ZodUUID",(t,e)=>{QJ.init(t,e),sn.init(t,e)}),YX=de("ZodURL",(t,e)=>{tY.init(t,e),sn.init(t,e)}),XX=de("ZodEmoji",(t,e)=>{nY.init(t,e),sn.init(t,e)}),QX=de("ZodNanoID",(t,e)=>{rY.init(t,e),sn.init(t,e)}),eQ=de("ZodCUID",(t,e)=>{iY.init(t,e),sn.init(t,e)}),tQ=de("ZodCUID2",(t,e)=>{sY.init(t,e),sn.init(t,e)}),nQ=de("ZodULID",(t,e)=>{aY.init(t,e),sn.init(t,e)}),rQ=de("ZodXID",(t,e)=>{
oY.init(t,e),sn.init(t,e)}),iQ=de("ZodKSUID",(t,e)=>{lY.init(t,e),sn.init(t,e)}),sQ=de("ZodIPv4",(t,e)=>{pY.init(t,e),sn.init(t,e)}),aQ=de("ZodIPv6",(t,e)=>{hY.init(t,e),sn.init(t,e)}),oQ=de("ZodCIDRv4",(t,e)=>{mY.init(t,e),sn.init(t,e)}),lQ=de("ZodCIDRv6",(t,e)=>{gY.init(t,e),sn.init(t,e)}),cQ=de("ZodBase64",(t,e)=>{yY.init(t,e),sn.init(t,e)}),uQ=de("ZodBase64URL",(t,e)=>{wY.init(t,e),sn.init(t,e)}),dQ=de("ZodE164",(t,e)=>{bY.init(t,e),sn.init(t,e)}),fQ=de("ZodJWT",(t,e)=>{_Y.init(t,e),sn.init(
t,e)}),VD=de("ZodNumber",(t,e)=>{kD.init(t,e),rn.init(t,e),t.gt=(r,i)=>t.check(LD(r,i)),t.gte=(r,i)=>t.check(hR(r,i)),t.min=(r,i)=>t.check(hR(r,i)),t.lt=(r,i)=>t.check(OD(r,i)),t.lte=(r,i)=>t.check(pR(r,i)),t.max=(r,i)=>t.check(pR(r,i)),t.int=r=>t.check(BD(r)),t.safe=r=>t.check(BD(r)),t.positive=r=>t.check(LD(0,r)),t.nonnegative=r=>t.check(hR(0,r)),t.negative=r=>t.check(OD(0,r)),t.nonpositive=r=>t.check(pR(0,r)),t.multipleOf=(r,i)=>t.check(MD(r,i)),t.step=(r,i)=>t.check(MD(r,i)),t.finite=()=>t;const n=t.
_zod.bag;t.minValue=Math.max(n.minimum??Number.NEGATIVE_INFINITY,n.exclusiveMinimum??Number.NEGATIVE_INFINITY)??null,t.maxValue=Math.min(n.maximum??Number.POSITIVE_INFINITY,n.exclusiveMaximum??Number.POSITIVE_INFINITY)??null,t.isInt=(n.format??"").includes("int")||Number.isSafeInteger(n.multipleOf??.5),t.isFinite=!0,t.format=n.format??null});function Dt(t){return yX(VD,t)}const pQ=de("ZodNumberFormat",(t,e)=>{RY.init(t,e),VD.init(t,e)});function BD(t){return vX(pQ,t)}const hQ=de("ZodBoolean",(t,e)=>{
SY.init(t,e),rn.init(t,e)});function Bn(t){return wX(hQ,t)}const mQ=de("ZodNull",(t,e)=>{$Y.init(t,e),rn.init(t,e)});function WD(t){return bX(mQ,t)}const gQ=de("ZodUnknown",(t,e)=>{TY.init(t,e),rn.init(t,e)});function an(){return kX(gQ)}const yQ=de("ZodNever",(t,e)=>{EY.init(t,e),rn.init(t,e)});function vQ(t){return _X(yQ,t)}const wQ=de("ZodArray",(t,e)=>{PY.init(t,e),rn.init(t,e),t.element=e.element,t.min=(n,r)=>t.check(Ey(n,r)),t.nonempty=n=>t.check(Ey(1,n)),t.max=(n,r)=>t.check(jD(n,r)),t.length=
(n,r)=>t.check(qD(n,r)),t.unwrap=()=>t.element});function mt(t,e){return NX(wQ,t,e)}const GD=de("ZodObject",(t,e)=>{SD.init(t,e),rn.init(t,e),zt(t,"shape",()=>e.shape),t.keyof=()=>Hr(Object.keys(t._zod.def.shape)),t.catchall=n=>t.clone({...t._zod.def,catchall:n}),t.passthrough=()=>t.clone({...t._zod.def,catchall:an()}),t.loose=()=>t.clone({...t._zod.def,catchall:an()}),t.strict=()=>t.clone({...t._zod.def,catchall:vQ()}),t.strip=()=>t.clone({...t._zod.def,catchall:void 0}),t.extend=n=>nJ(t,n),t.merge=
n=>rJ(t,n),t.pick=n=>eJ(t,n),t.omit=n=>tJ(t,n),t.partial=(...n)=>iJ(YD,t,n[0]),t.required=(...n)=>sJ(QD,t,n[0])});function Ee(t,e){const n={type:"object",get shape(){return gp(this,"shape",{...t}),this.shape},...Ae(e)};return new GD(n)}function Er(t,e){return new GD({type:"object",get shape(){return gp(this,"shape",{...t}),this.shape},catchall:an(),...Ae(e)})}const KD=de("ZodUnion",(t,e)=>{TD.init(t,e),rn.init(t,e),t.options=e.options});function Kt(t,e){return new KD({type:"union",options:t,...Ae(
e)})}const bQ=de("ZodDiscriminatedUnion",(t,e)=>{KD.init(t,e),CY.init(t,e)});function ZD(t,e,n){return new bQ({type:"union",options:e,discriminator:t,...Ae(n)})}const kQ=de("ZodIntersection",(t,e)=>{xY.init(t,e),rn.init(t,e)});function mR(t,e){return new kQ({type:"intersection",left:t,right:e})}const _Q=de("ZodRecord",(t,e)=>{AY.init(t,e),rn.init(t,e),t.keyType=e.keyType,t.valueType=e.valueType});function on(t,e,n){return new _Q({type:"record",keyType:t,valueType:e,...Ae(n)})}const gR=de("ZodEnu\
m",(t,e)=>{IY.init(t,e),rn.init(t,e),t.enum=e.entries,t.options=Object.values(e.entries);const n=new Set(Object.keys(e.entries));t.extract=(r,i)=>{const s={};for(const a of r)if(n.has(a))s[a]=e.entries[a];else throw new Error(`Key ${a} not found in enum`);return new gR({...e,checks:[],...Ae(i),entries:s})},t.exclude=(r,i)=>{const s={...e.entries};for(const a of r)if(n.has(a))delete s[a];else throw new Error(`Key ${a} not found in enum`);return new gR({...e,checks:[],...Ae(i),entries:s})}});function Hr(t,e){
const n=Array.isArray(t)?Object.fromEntries(t.map(r=>[r,r])):t;return new gR({type:"enum",entries:n,...Ae(e)})}const RQ=de("ZodLiteral",(t,e)=>{NY.init(t,e),rn.init(t,e),t.values=new Set(e.values),Object.defineProperty(t,"value",{get(){if(e.values.length>1)throw new Error("This schema contains multiple valid literal values. Use `.values` instead.");return e.values[0]}})});function Oe(t,e){return new RQ({type:"literal",values:Array.isArray(t)?t:[t],...Ae(e)})}const SQ=de("ZodTransform",(t,e)=>{DY.
init(t,e),rn.init(t,e),t._zod.parse=(n,r)=>{n.addIssue=s=>{if(typeof s=="string")n.issues.push(bp(s,n.value,e));else{const a=s;a.fatal&&(a.continue=!1),a.code??(a.code="custom"),a.input??(a.input=n.value),a.inst??(a.inst=t),a.continue??(a.continue=!0),n.issues.push(bp(a))}};const i=e.transform(n.value,n);return i instanceof Promise?i.then(s=>(n.value=s,n)):(n.value=i,n)}});function JD(t){return new SQ({type:"transform",transform:t})}const YD=de("ZodOptional",(t,e)=>{OY.init(t,e),rn.init(t,e),t.unwrap=
()=>t._zod.def.innerType});function fn(t){return new YD({type:"optional",innerType:t})}const $Q=de("ZodNullable",(t,e)=>{LY.init(t,e),rn.init(t,e),t.unwrap=()=>t._zod.def.innerType});function XD(t){return new $Q({type:"nullable",innerType:t})}const TQ=de("ZodDefault",(t,e)=>{MY.init(t,e),rn.init(t,e),t.unwrap=()=>t._zod.def.innerType,t.removeDefault=t.unwrap});function EQ(t,e){return new TQ({type:"default",innerType:t,get defaultValue(){return typeof e=="function"?e():e}})}const PQ=de("ZodPrefau\
lt",(t,e)=>{jY.init(t,e),rn.init(t,e),t.unwrap=()=>t._zod.def.innerType});function CQ(t,e){return new PQ({type:"prefault",innerType:t,get defaultValue(){return typeof e=="function"?e():e}})}const QD=de("ZodNonOptional",(t,e)=>{qY.init(t,e),rn.init(t,e),t.unwrap=()=>t._zod.def.innerType});function xQ(t,e){return new QD({type:"nonoptional",innerType:t,...Ae(e)})}const AQ=de("ZodCatch",(t,e)=>{FY.init(t,e),rn.init(t,e),t.unwrap=()=>t._zod.def.innerType,t.removeCatch=t.unwrap});function IQ(t,e){return new AQ(
{type:"catch",innerType:t,catchValue:typeof e=="function"?e:()=>e})}const NQ=de("ZodPipe",(t,e)=>{zY.init(t,e),rn.init(t,e),t.in=e.in,t.out=e.out});function yR(t,e){return new NQ({type:"pipe",in:t,out:e})}const DQ=de("ZodReadonly",(t,e)=>{UY.init(t,e),rn.init(t,e)});function OQ(t){return new DQ({type:"readonly",innerType:t})}const eO=de("ZodCustom",(t,e)=>{HY.init(t,e),rn.init(t,e)});function LQ(t){const e=new Tr({check:"custom"});return e._zod.check=t,e}function MQ(t,e){return DX(eO,t??(()=>!0),
e)}function jQ(t,e={}){return OX(eO,t,e)}function qQ(t){const e=LQ(n=>(n.addIssue=r=>{if(typeof r=="string")n.issues.push(bp(r,n.value,e._zod.def));else{const i=r;i.fatal&&(i.continue=!1),i.code??(i.code="custom"),i.input??(i.input=n.value),i.inst??(i.inst=e),i.continue??(i.continue=!e._zod.def.abort),n.issues.push(bp(i))}},t(n.value,n)));return e}function tO(t,e){return yR(JD(t),e)}const nO="2025-11-25",FQ="2025-03-26",vR=[nO,"2025-06-18","2025-03-26","2024-11-05","2024-10-07"],Mo="io.modelcont\
extprotocol/related-task",xy="2.0",Wn=MQ(t=>t!==null&&(typeof t=="object"||typeof t=="function")),rO=Kt([oe(),Dt().int()]),iO=oe();Er({ttl:Kt([Dt(),WD()]).optional(),pollInterval:Dt().optional()});const zQ=Ee({ttl:Dt().optional()}),UQ=Ee({taskId:oe()}),wR=Er({progressToken:rO.optional(),[Mo]:UQ.optional()}),Vr=Ee({_meta:wR.optional()}),Rp=Vr.extend({task:zQ.optional()}),HQ=t=>Rp.safeParse(t).success,Gn=Ee({method:oe(),params:Vr.loose().optional()}),ai=Ee({_meta:wR.optional()}),oi=Ee({method:oe(),
params:ai.loose().optional()}),Kn=Er({_meta:wR.optional()}),Ay=Kt([oe(),Dt().int()]),sO=Ee({jsonrpc:Oe(xy),id:Ay,...Gn.shape}).strict(),mc=t=>sO.safeParse(t).success,aO=Ee({jsonrpc:Oe(xy),...oi.shape}).strict(),VQ=t=>aO.safeParse(t).success,bR=Ee({jsonrpc:Oe(xy),id:Ay,result:Kn}).strict(),jo=t=>bR.safeParse(t).success;var Fe;(function(t){t[t.ConnectionClosed=-32e3]="ConnectionClosed",t[t.RequestTimeout=-32001]="RequestTimeout",t[t.ParseError=-32700]="ParseError",t[t.InvalidRequest=-32600]="Inval\
idRequest",t[t.MethodNotFound=-32601]="MethodNotFound",t[t.InvalidParams=-32602]="InvalidParams",t[t.InternalError=-32603]="InternalError",t[t.UrlElicitationRequired=-32042]="UrlElicitationRequired"})(Fe||(Fe={}));const kR=Ee({jsonrpc:Oe(xy),id:Ay.optional(),error:Ee({code:Dt().int(),message:oe(),data:an().optional()})}).strict(),Iy=t=>kR.safeParse(t).success,_R=Kt([sO,aO,bR,kR]);Kt([bR,kR]);const RR=Kn.strict(),BQ=ai.extend({requestId:Ay.optional(),reason:oe().optional()}),SR=oi.extend({method:Oe(
"notifications/cancelled"),params:BQ}),WQ=Ee({src:oe(),mimeType:oe().optional(),sizes:mt(oe()).optional(),theme:Hr(["light","dark"]).optional()}),Sp=Ee({icons:mt(WQ).optional()}),gc=Ee({name:oe(),title:oe().optional()}),oO=gc.extend({...gc.shape,...Sp.shape,version:oe(),websiteUrl:oe().optional(),description:oe().optional()}),GQ=mR(Ee({applyDefaults:Bn().optional()}),on(oe(),an())),KQ=tO(t=>t&&typeof t=="object"&&!Array.isArray(t)&&Object.keys(t).length===0?{form:{}}:t,mR(Ee({form:GQ.optional(),
url:Wn.optional()}),on(oe(),an()).optional())),ZQ=Er({list:Wn.optional(),cancel:Wn.optional(),requests:Er({sampling:Er({createMessage:Wn.optional()}).optional(),elicitation:Er({create:Wn.optional()}).optional()}).optional()}),JQ=Er({list:Wn.optional(),cancel:Wn.optional(),requests:Er({tools:Er({call:Wn.optional()}).optional()}).optional()}),YQ=Ee({experimental:on(oe(),Wn).optional(),sampling:Ee({context:Wn.optional(),tools:Wn.optional()}).optional(),elicitation:KQ.optional(),roots:Ee({listChanged:Bn().
optional()}).optional(),tasks:ZQ.optional()}),XQ=Vr.extend({protocolVersion:oe(),capabilities:YQ,clientInfo:oO}),$R=Gn.extend({method:Oe("initialize"),params:XQ}),lO=t=>$R.safeParse(t).success,QQ=Ee({experimental:on(oe(),Wn).optional(),logging:Wn.optional(),completions:Wn.optional(),prompts:Ee({listChanged:Bn().optional()}).optional(),resources:Ee({subscribe:Bn().optional(),listChanged:Bn().optional()}).optional(),tools:Ee({listChanged:Bn().optional()}).optional(),tasks:JQ.optional()}),eee=Kn.extend(
{protocolVersion:oe(),capabilities:QQ,serverInfo:oO,instructions:oe().optional()}),cO=oi.extend({method:Oe("notifications/initialized"),params:ai.optional()}),TR=Gn.extend({method:Oe("ping"),params:Vr.optional()}),tee=Ee({progress:Dt(),total:fn(Dt()),message:fn(oe())}),nee=Ee({...ai.shape,...tee.shape,progressToken:rO}),ER=oi.extend({method:Oe("notifications/progress"),params:nee}),ree=Vr.extend({cursor:iO.optional()}),$p=Gn.extend({params:ree.optional()}),Tp=Kn.extend({nextCursor:iO.optional()}),
iee=Hr(["working","input_required","completed","failed","cancelled"]),Ep=Ee({taskId:oe(),status:iee,ttl:Kt([Dt(),WD()]),createdAt:oe(),lastUpdatedAt:oe(),pollInterval:fn(Dt()),statusMessage:fn(oe())}),Ny=Kn.extend({task:Ep}),see=ai.merge(Ep),Dy=oi.extend({method:Oe("notifications/tasks/status"),params:see}),PR=Gn.extend({method:Oe("tasks/get"),params:Vr.extend({taskId:oe()})}),CR=Kn.merge(Ep),xR=Gn.extend({method:Oe("tasks/result"),params:Vr.extend({taskId:oe()})});Kn.loose();const AR=$p.extend(
{method:Oe("tasks/list")}),IR=Tp.extend({tasks:mt(Ep)}),NR=Gn.extend({method:Oe("tasks/cancel"),params:Vr.extend({taskId:oe()})}),aee=Kn.merge(Ep),uO=Ee({uri:oe(),mimeType:fn(oe()),_meta:on(oe(),an()).optional()}),dO=uO.extend({text:oe()}),DR=oe().refine(t=>{try{return atob(t),!0}catch{return!1}},{message:"Invalid Base64 string"}),fO=uO.extend({blob:DR}),Pp=Hr(["user","assistant"]),yc=Ee({audience:mt(Pp).optional(),priority:Dt().min(0).max(1).optional(),lastModified:zD({offset:!0}).optional()}),
pO=Ee({...gc.shape,...Sp.shape,uri:oe(),description:fn(oe()),mimeType:fn(oe()),annotations:yc.optional(),_meta:fn(Er({}))}),oee=Ee({...gc.shape,...Sp.shape,uriTemplate:oe(),description:fn(oe()),mimeType:fn(oe()),annotations:yc.optional(),_meta:fn(Er({}))}),OR=$p.extend({method:Oe("resources/list")}),lee=Tp.extend({resources:mt(pO)}),LR=$p.extend({method:Oe("resources/templates/list")}),cee=Tp.extend({resourceTemplates:mt(oee)}),MR=Vr.extend({uri:oe()}),uee=MR,jR=Gn.extend({method:Oe("resources/r\
ead"),params:uee}),dee=Kn.extend({contents:mt(Kt([dO,fO]))}),fee=oi.extend({method:Oe("notifications/resources/list_changed"),params:ai.optional()}),pee=MR,hee=Gn.extend({method:Oe("resources/subscribe"),params:pee}),mee=MR,gee=Gn.extend({method:Oe("resources/unsubscribe"),params:mee}),yee=ai.extend({uri:oe()}),vee=oi.extend({method:Oe("notifications/resources/updated"),params:yee}),wee=Ee({name:oe(),description:fn(oe()),required:fn(Bn())}),bee=Ee({...gc.shape,...Sp.shape,description:fn(oe()),arguments:fn(
mt(wee)),_meta:fn(Er({}))}),qR=$p.extend({method:Oe("prompts/list")}),kee=Tp.extend({prompts:mt(bee)}),_ee=Vr.extend({name:oe(),arguments:on(oe(),oe()).optional()}),FR=Gn.extend({method:Oe("prompts/get"),params:_ee}),zR=Ee({type:Oe("text"),text:oe(),annotations:yc.optional(),_meta:on(oe(),an()).optional()}),UR=Ee({type:Oe("image"),data:DR,mimeType:oe(),annotations:yc.optional(),_meta:on(oe(),an()).optional()}),HR=Ee({type:Oe("audio"),data:DR,mimeType:oe(),annotations:yc.optional(),_meta:on(oe(),
an()).optional()}),Ree=Ee({type:Oe("tool_use"),name:oe(),id:oe(),input:on(oe(),an()),_meta:on(oe(),an()).optional()}),See=Ee({type:Oe("resource"),resource:Kt([dO,fO]),annotations:yc.optional(),_meta:on(oe(),an()).optional()}),$ee=pO.extend({type:Oe("resource_link")}),VR=Kt([zR,UR,HR,$ee,See]),Tee=Ee({role:Pp,content:VR}),Eee=Kn.extend({description:oe().optional(),messages:mt(Tee)}),Pee=oi.extend({method:Oe("notifications/prompts/list_changed"),params:ai.optional()}),Cee=Ee({title:oe().optional(),
readOnlyHint:Bn().optional(),destructiveHint:Bn().optional(),idempotentHint:Bn().optional(),openWorldHint:Bn().optional()}),xee=Ee({taskSupport:Hr(["required","optional","forbidden"]).optional()}),hO=Ee({...gc.shape,...Sp.shape,description:oe().optional(),inputSchema:Ee({type:Oe("object"),properties:on(oe(),Wn).optional(),required:mt(oe()).optional()}).catchall(an()),outputSchema:Ee({type:Oe("object"),properties:on(oe(),Wn).optional(),required:mt(oe()).optional()}).catchall(an()).optional(),annotations:Cee.
optional(),execution:xee.optional(),_meta:on(oe(),an()).optional()}),BR=$p.extend({method:Oe("tools/list")}),Aee=Tp.extend({tools:mt(hO)}),WR=Kn.extend({content:mt(VR).default([]),structuredContent:on(oe(),an()).optional(),isError:Bn().optional()});WR.or(Kn.extend({toolResult:an()}));const Iee=Rp.extend({name:oe(),arguments:on(oe(),an()).optional()}),Oy=Gn.extend({method:Oe("tools/call"),params:Iee}),Nee=oi.extend({method:Oe("notifications/tools/list_changed"),params:ai.optional()});Ee({autoRefresh:Bn().
default(!0),debounceMs:Dt().int().nonnegative().default(300)});const Ly=Hr(["debug","info","notice","warning","error","critical","alert","emergency"]),Dee=Vr.extend({level:Ly}),mO=Gn.extend({method:Oe("logging/setLevel"),params:Dee}),Oee=ai.extend({level:Ly,logger:oe().optional(),data:an()}),Lee=oi.extend({method:Oe("notifications/message"),params:Oee}),Mee=Ee({name:oe().optional()}),jee=Ee({hints:mt(Mee).optional(),costPriority:Dt().min(0).max(1).optional(),speedPriority:Dt().min(0).max(1).optional(),
intelligencePriority:Dt().min(0).max(1).optional()}),qee=Ee({mode:Hr(["auto","required","none"]).optional()}),Fee=Ee({type:Oe("tool_result"),toolUseId:oe().describe("The unique identifier for the corresponding tool call."),content:mt(VR).default([]),structuredContent:Ee({}).loose().optional(),isError:Bn().optional(),_meta:on(oe(),an()).optional()}),zee=ZD("type",[zR,UR,HR]),My=ZD("type",[zR,UR,HR,Ree,Fee]),Uee=Ee({role:Pp,content:Kt([My,mt(My)]),_meta:on(oe(),an()).optional()}),Hee=Rp.extend({messages:mt(
Uee),modelPreferences:jee.optional(),systemPrompt:oe().optional(),includeContext:Hr(["none","thisServer","allServers"]).optional(),temperature:Dt().optional(),maxTokens:Dt().int(),stopSequences:mt(oe()).optional(),metadata:Wn.optional(),tools:mt(hO).optional(),toolChoice:qee.optional()}),Vee=Gn.extend({method:Oe("sampling/createMessage"),params:Hee}),gO=Kn.extend({model:oe(),stopReason:fn(Hr(["endTurn","stopSequence","maxTokens"]).or(oe())),role:Pp,content:zee}),yO=Kn.extend({model:oe(),stopReason:fn(
Hr(["endTurn","stopSequence","maxTokens","toolUse"]).or(oe())),role:Pp,content:Kt([My,mt(My)])}),Bee=Ee({type:Oe("boolean"),title:oe().optional(),description:oe().optional(),default:Bn().optional()}),Wee=Ee({type:Oe("string"),title:oe().optional(),description:oe().optional(),minLength:Dt().optional(),maxLength:Dt().optional(),format:Hr(["email","uri","date","date-time"]).optional(),default:oe().optional()}),Gee=Ee({type:Hr(["number","integer"]),title:oe().optional(),description:oe().optional(),minimum:Dt().
optional(),maximum:Dt().optional(),default:Dt().optional()}),Kee=Ee({type:Oe("string"),title:oe().optional(),description:oe().optional(),enum:mt(oe()),default:oe().optional()}),Zee=Ee({type:Oe("string"),title:oe().optional(),description:oe().optional(),oneOf:mt(Ee({const:oe(),title:oe()})),default:oe().optional()}),Jee=Ee({type:Oe("string"),title:oe().optional(),description:oe().optional(),enum:mt(oe()),enumNames:mt(oe()).optional(),default:oe().optional()}),Yee=Kt([Kee,Zee]),Xee=Ee({type:Oe("ar\
ray"),title:oe().optional(),description:oe().optional(),minItems:Dt().optional(),maxItems:Dt().optional(),items:Ee({type:Oe("string"),enum:mt(oe())}),default:mt(oe()).optional()}),Qee=Ee({type:Oe("array"),title:oe().optional(),description:oe().optional(),minItems:Dt().optional(),maxItems:Dt().optional(),items:Ee({anyOf:mt(Ee({const:oe(),title:oe()}))}),default:mt(oe()).optional()}),ete=Kt([Xee,Qee]),tte=Kt([Jee,Yee,ete]),nte=Kt([tte,Bee,Wee,Gee]),rte=Rp.extend({mode:Oe("form").optional(),message:oe(),
requestedSchema:Ee({type:Oe("object"),properties:on(oe(),nte),required:mt(oe()).optional()})}),ite=Rp.extend({mode:Oe("url"),message:oe(),elicitationId:oe(),url:oe().url()}),ste=Kt([rte,ite]),ate=Gn.extend({method:Oe("elicitation/create"),params:ste}),ote=ai.extend({elicitationId:oe()}),lte=oi.extend({method:Oe("notifications/elicitation/complete"),params:ote}),GR=Kn.extend({action:Hr(["accept","decline","cancel"]),content:tO(t=>t===null?void 0:t,on(oe(),Kt([oe(),Dt(),Bn(),mt(oe())])).optional())}),
cte=Ee({type:Oe("ref/resource"),uri:oe()}),ute=Ee({type:Oe("ref/prompt"),name:oe()}),dte=Vr.extend({ref:Kt([ute,cte]),argument:Ee({name:oe(),value:oe()}),context:Ee({arguments:on(oe(),oe()).optional()}).optional()}),KR=Gn.extend({method:Oe("completion/complete"),params:dte});function fte(t){if(t.params.ref.type!=="ref/prompt")throw new TypeError(`Expected CompleteRequestPrompt, but got ${t.params.ref.type}`)}function pte(t){if(t.params.ref.type!=="ref/resource")throw new TypeError(`Expected Comp\
leteRequestResourceTemplate, but got ${t.params.ref.type}`)}const hte=Kn.extend({completion:Er({values:mt(oe()).max(100),total:fn(Dt().int()),hasMore:fn(Bn())})}),mte=Ee({uri:oe().startsWith("file://"),name:oe().optional(),_meta:on(oe(),an()).optional()}),gte=Gn.extend({method:Oe("roots/list"),params:Vr.optional()}),vO=Kn.extend({roots:mt(mte)}),yte=oi.extend({method:Oe("notifications/roots/list_changed"),params:ai.optional()});Kt([TR,$R,KR,mO,FR,qR,OR,LR,jR,hee,gee,Oy,BR,PR,xR,AR,NR]),Kt([SR,ER,
cO,yte,Dy]),Kt([RR,gO,yO,GR,vO,CR,IR,Ny]),Kt([TR,Vee,ate,gte,PR,xR,AR,NR]),Kt([SR,ER,Lee,vee,fee,Nee,Pee,Dy,lte]),Kt([RR,eee,hte,Eee,kee,lee,cee,dee,WR,Aee,CR,IR,Ny]);class Le extends Error{constructor(e,n,r){super(`MCP error ${e}: ${n}`),this.code=e,this.data=r,this.name="McpError"}static fromError(e,n,r){if(e===Fe.UrlElicitationRequired&&r){const i=r;if(i.elicitations)return new vte(i.elicitations,n)}return new Le(e,n,r)}}class vte extends Le{constructor(e,n=`URL elicitation${e.length>1?"s":""}\
 required`){super(Fe.UrlElicitationRequired,n,{elicitations:e})}get elicitations(){return this.data?.elicitations??[]}}class wte{append(e){this._buffer=this._buffer?Buffer.concat([this._buffer,e]):e}readMessage(){if(!this._buffer)return null;const e=this._buffer.indexOf(`
`);if(e===-1)return null;const n=this._buffer.toString("utf8",0,e).replace(/\r$/,"");return this._buffer=this._buffer.subarray(e+1),bte(n)}clear(){this._buffer=void 0}}function bte(t){return _R.parse(JSON.parse(t))}function kte(t){return JSON.stringify(t)+`
`}class _te{constructor(e=ji.stdin,n=ji.stdout){this._stdin=e,this._stdout=n,this._readBuffer=new wte,this._started=!1,this._ondata=r=>{this._readBuffer.append(r),this.processReadBuffer()},this._onerror=r=>{this.onerror?.(r)}}async start(){if(this._started)throw new Error("StdioServerTransport already started! If using Server class, note that connect() calls start() automatically.");this._started=!0,this._stdin.on("data",this._ondata),this._stdin.on("error",this._onerror)}processReadBuffer(){for(;;)
try{const e=this._readBuffer.readMessage();if(e===null)break;this.onmessage?.(e)}catch(e){this.onerror?.(e)}}async close(){this._stdin.off("data",this._ondata),this._stdin.off("error",this._onerror),this._stdin.listenerCount("data")===0&&this._stdin.pause(),this._readBuffer.clear(),this.onclose?.()}send(e){return new Promise(n=>{const r=kte(e);this._stdout.write(r)?n():this._stdout.once("drain",n)})}}class Rte{services;transport=void 0;_mcp=void 0;constructor(e){this.services=e}get mcp(){if(!this.
_mcp)throw new Error("MCP server is not started");return this._mcp}get isStarted(){return this.transport!==void 0}get port(){return NaN}async dispose(){await this.stop()}async start(){this.transport||(nn.info("Starting MCP stdio server"),this._mcp=this.services.mcp.ServerFactory.create(),this.transport=new _te,await this._mcp.connect(this.transport),nn.info("LikeC4 MCP Server running on stdio"))}async stop(){if(this.transport)try{nn.info("Stopping MCP stdio server"),await this.transport.close(),
this._mcp&&await this._mcp.close()}finally{this._mcp=void 0,this.transport=void 0}}}var qo=class extends Error{constructor(t,e){super(t,e),this.name="RequestError"}},Ste=t=>t instanceof qo?t:new qo(t.message,{cause:t}),$te=global.Request,Cp=class extends $te{constructor(e,n){typeof e=="object"&&vc in e&&(e=e[vc]()),typeof n?.body?.getReader<"u"&&(n.duplex??="half"),super(e,n)}},Tte=t=>{const e=[],n=t.rawHeaders;for(let r=0;r<n.length;r+=2){const{[r]:i,[r+1]:s}=n;i.charCodeAt(0)!==58&&e.push([i,s])}
return new Headers(e)},wO=Symbol("wrapBodyStream"),Ete=(t,e,n,r,i)=>{const s={method:t,headers:n,signal:i.signal};if(t==="TRACE"){s.method="GET";const a=new Cp(e,s);return Object.defineProperty(a,"method",{get(){return"TRACE"}}),a}if(!(t==="GET"||t==="HEAD"))if("rawBody"in r&&r.rawBody instanceof Buffer)s.body=new ReadableStream({start(a){a.enqueue(r.rawBody),a.close()}});else if(r[wO]){let a;s.body=new ReadableStream({async pull(o){try{a||=g0.toWeb(r).getReader();const{done:l,value:c}=await a.read();
l?o.close():o.enqueue(c)}catch(l){o.error(l)}}})}else s.body=g0.toWeb(r);return new Cp(e,s)},vc=Symbol("getRequestCache"),Pte=Symbol("requestCache"),jy=Symbol("incomingKey"),qy=Symbol("urlKey"),Cte=Symbol("headersKey"),wc=Symbol("abortControllerKey"),xte=Symbol("getAbortController"),Fy={get method(){return this[jy].method||"GET"},get url(){return this[qy]},get headers(){return this[Cte]||=Tte(this[jy])},[xte](){return this[vc](),this[wc]},[vc](){return this[wc]||=new AbortController,this[Pte]||=
Ete(this.method,this[qy],this.headers,this[jy],this[wc])}};["body","bodyUsed","cache","credentials","destination","integrity","mode","redirect","referrer","referrerPolicy","signal","keepalive"].forEach(t=>{Object.defineProperty(Fy,t,{get(){return this[vc]()[t]}})}),["arrayBuffer","blob","clone","formData","json","text"].forEach(t=>{Object.defineProperty(Fy,t,{value:function(){return this[vc]()[t]()}})}),Object.setPrototypeOf(Fy,Cp.prototype);var Ate=(t,e)=>{const n=Object.create(Fy);n[jy]=t;const r=t.
url||"";if(r[0]!=="/"&&(r.startsWith("http://")||r.startsWith("https://"))){if(t instanceof Rh)throw new qo("Absolute URL for :path is not allowed in HTTP/2");try{const o=new URL(r);n[qy]=o.href}catch(o){throw new qo("Invalid absolute URL",{cause:o})}return n}const i=(t instanceof Rh?t.authority:t.headers.host)||e;if(!i)throw new qo("Missing host header");let s;if(t instanceof Rh){if(s=t.scheme,!(s==="http"||s==="https"))throw new qo("Unsupported scheme")}else s=t.socket&&t.socket.encrypted?"htt\
ps":"http";const a=new URL(`${s}://${i}${r}`);if(a.hostname.length!==i.length&&a.hostname!==i.replace(/:\d+$/,""))throw new qo("Invalid host header");return n[qy]=a.href,n},bO=Symbol("responseCache"),bc=Symbol("getResponseCache"),Fo=Symbol("cache"),ZR=global.Response,xp=class oq{#e;#t;[bc](){return delete this[Fo],this[bO]||=new ZR(this.#e,this.#t)}constructor(e,n){let r;if(this.#e=e,n instanceof oq){const i=n[bO];if(i){this.#t=i,this[bc]();return}else this.#t=n.#t,r=new Headers(n.#t.headers)}else
this.#t=n;(typeof e=="string"||typeof e?.getReader<"u"||e instanceof Blob||e instanceof Uint8Array)&&(r||=n?.headers||{"content-type":"text/plain; charset=UTF-8"},this[Fo]=[n?.status||200,e,r])}get headers(){const e=this[Fo];return e?(e[2]instanceof Headers||(e[2]=new Headers(e[2])),e[2]):this[bc]().headers}get status(){return this[Fo]?.[0]??this[bc]().status}get ok(){const e=this.status;return e>=200&&e<300}};["body","bodyUsed","redirected","statusText","trailers","type","url"].forEach(t=>{Object.
defineProperty(xp.prototype,t,{get(){return this[bc]()[t]}})}),["arrayBuffer","blob","clone","formData","json","text"].forEach(t=>{Object.defineProperty(xp.prototype,t,{value:function(){return this[bc]()[t]()}})}),Object.setPrototypeOf(xp,ZR),Object.setPrototypeOf(xp.prototype,ZR.prototype);async function Ite(t){return Promise.race([t,Promise.resolve().then(()=>Promise.resolve(void 0))])}function kO(t,e,n){const r=o=>{t.cancel(o).catch(()=>{})};return e.on("close",r),e.on("error",r),(n??t.read()).
then(a,i),t.closed.finally(()=>{e.off("close",r),e.off("error",r)});function i(o){o&&e.destroy(o)}function s(){t.read().then(a,i)}function a({done:o,value:l}){try{if(o)e.end();else if(!e.write(l))e.once("drain",s);else return t.read().then(a,i)}catch(c){i(c)}}}function Nte(t,e){if(t.locked)throw new TypeError("ReadableStream is locked.");return e.destroyed?void 0:kO(t.getReader(),e)}var _O=t=>{const e={};t instanceof Headers||(t=new Headers(t??void 0));const n=[];for(const[r,i]of t)r==="set-cook\
ie"?n.push(i):e[r]=i;return n.length>0&&(e["set-cookie"]=n),e["content-type"]??="text/plain; charset=UTF-8",e},Dte="x-hono-already-sent",Ote=global.fetch;typeof global.crypto>"u"&&(global.crypto=Z$),global.fetch=(t,e)=>(e={compress:!1,...e},Ote(t,e));var JR=Symbol("outgoingEnded"),Lte=()=>new Response(null,{status:400}),RO=t=>new Response(null,{status:t instanceof Error&&(t.name==="TimeoutError"||t.constructor.name==="TimeoutError")?504:500}),YR=(t,e)=>{const n=t instanceof Error?t:new Error("un\
known error",{cause:t});n.code==="ERR_STREAM_PREMATURE_CLOSE"?console.info("The user aborted a request."):(console.error(t),e.headersSent||e.writeHead(500,{"Content-Type":"text/plain"}),e.end(`Error: ${n.message}`),e.destroy(n))},SO=t=>{"flushHeaders"in t&&t.writable&&t.flushHeaders()},$O=async(t,e)=>{let[n,r,i]=t[Fo];i instanceof Headers&&(i=_O(i)),typeof r=="string"?i["Content-Length"]=Buffer.byteLength(r):r instanceof Uint8Array?i["Content-Length"]=r.byteLength:r instanceof Blob&&(i["Content-\
Length"]=r.size),e.writeHead(n,i),typeof r=="string"||r instanceof Uint8Array?e.end(r):r instanceof Blob?e.end(new Uint8Array(await r.arrayBuffer())):(SO(e),await Nte(r,e)?.catch(s=>YR(s,e))),e[JR]?.()},Mte=t=>typeof t.then=="function",jte=async(t,e,n={})=>{if(Mte(t))if(n.errorHandler)try{t=await t}catch(i){const s=await n.errorHandler(i);if(!s)return;t=s}else t=await t.catch(RO);if(Fo in t)return $O(t,e);const r=_O(t.headers);if(t.body){const i=t.body.getReader(),s=[];let a=!1,o;if(r["transfer-\
encoding"]!=="chunked"){let l=2;for(let c=0;c<l;c++){o||=i.read();const u=await Ite(o).catch(d=>{console.error(d),a=!0});if(!u){if(c===1){await new Promise(d=>setTimeout(d)),l=3;continue}break}if(o=void 0,u.value&&s.push(u.value),u.done){a=!0;break}}a&&!("content-length"in r)&&(r["content-length"]=s.reduce((c,u)=>c+u.length,0))}e.writeHead(t.status,r),s.forEach(l=>{e.write(l)}),a?e.end():(s.length===0&&SO(e),await kO(i,e,o))}else r[Dte]||(e.writeHead(t.status,r),e.end());e[JR]?.()},qte=(t,e={})=>{
const n=e.autoCleanupIncoming??!0;return e.overrideGlobalObjects!==!1&&global.Request!==Cp&&(Object.defineProperty(global,"Request",{value:Cp}),Object.defineProperty(global,"Response",{value:xp})),async(r,i)=>{let s,a;try{a=Ate(r,e.hostname);let o=!n||r.method==="GET"||r.method==="HEAD";if(o||(r[wO]=!0,r.on("end",()=>{o=!0}),r instanceof Rh&&(i[JR]=()=>{o||setTimeout(()=>{o||setTimeout(()=>{r.destroy(),i.destroy()})})})),i.on("close",()=>{a[wc]&&(r.errored?a[wc].abort(r.errored.toString()):i.writableFinished||
a[wc].abort("Client connection prematurely closed.")),o||setTimeout(()=>{o||setTimeout(()=>{r.destroy()})})}),s=t(a,{incoming:r,outgoing:i}),Fo in s)return $O(s,i)}catch(o){if(s)return YR(o,i);if(e.errorHandler){if(s=await e.errorHandler(a?o:Ste(o)),!s)return}else a?s=RO(o):s=Lte()}try{return await jte(s,i,e)}catch(o){return YR(o,i)}}},Fte=t=>{const e=t.fetch,n=qte(e,{hostname:t.hostname,overrideGlobalObjects:t.overrideGlobalObjects,autoCleanupIncoming:t.autoCleanupIncoming});return(t.createServer||
vF)(t.serverOptions||{},n)},zte=(t,e)=>{const n=Fte(t);return n.listen(t?.port??3e3,t.hostname,()=>{n.address()}),n};class Ute{constructor(e={}){this._started=!1,this._streamMapping=new Map,this._requestToStreamMapping=new Map,this._requestResponseMap=new Map,this._initialized=!1,this._enableJsonResponse=!1,this._standaloneSseStreamId="_GET_stream",this.sessionIdGenerator=e.sessionIdGenerator,this._enableJsonResponse=e.enableJsonResponse??!1,this._eventStore=e.eventStore,this._onsessioninitialized=
e.onsessioninitialized,this._onsessionclosed=e.onsessionclosed,this._allowedHosts=e.allowedHosts,this._allowedOrigins=e.allowedOrigins,this._enableDnsRebindingProtection=e.enableDnsRebindingProtection??!1,this._retryInterval=e.retryInterval}async start(){if(this._started)throw new Error("Transport already started");this._started=!0}createJsonErrorResponse(e,n,r,i){const s={code:n,message:r};return i?.data!==void 0&&(s.data=i.data),new Response(JSON.stringify({jsonrpc:"2.0",error:s,id:null}),{status:e,
headers:{"Content-Type":"application/json",...i?.headers}})}validateRequestHeaders(e){if(this._enableDnsRebindingProtection){if(this._allowedHosts&&this._allowedHosts.length>0){const n=e.headers.get("host");if(!n||!this._allowedHosts.includes(n)){const r=`Invalid Host header: ${n}`;return this.onerror?.(new Error(r)),this.createJsonErrorResponse(403,-32e3,r)}}if(this._allowedOrigins&&this._allowedOrigins.length>0){const n=e.headers.get("origin");if(n&&!this._allowedOrigins.includes(n)){const r=`\
Invalid Origin header: ${n}`;return this.onerror?.(new Error(r)),this.createJsonErrorResponse(403,-32e3,r)}}}}async handleRequest(e,n){const r=this.validateRequestHeaders(e);if(r)return r;switch(e.method){case"POST":return this.handlePostRequest(e,n);case"GET":return this.handleGetRequest(e);case"DELETE":return this.handleDeleteRequest(e);default:return this.handleUnsupportedRequest()}}async writePrimingEvent(e,n,r,i){if(!this._eventStore||i<"2025-11-25")return;const s=await this._eventStore.storeEvent(
r,{});let a=`id: ${s}
data: 

`;this._retryInterval!==void 0&&(a=`id: ${s}
retry: ${this._retryInterval}
data: 

`),e.enqueue(n.encode(a))}async handleGetRequest(e){if(!e.headers.get("accept")?.includes("text/event-stream"))return this.createJsonErrorResponse(406,-32e3,"Not Acceptable: Client must accept text/event-stream");const r=this.validateSession(e);if(r)return r;const i=this.validateProtocolVersion(e);if(i)return i;if(this._eventStore){const c=e.headers.get("last-event-id");if(c)return this.replayEvents(c)}if(this._streamMapping.get(this._standaloneSseStreamId)!==void 0)return this.createJsonErrorResponse(
409,-32e3,"Conflict: Only one SSE stream is allowed per session");const s=new TextEncoder;let a;const o=new ReadableStream({start:c=>{a=c},cancel:()=>{this._streamMapping.delete(this._standaloneSseStreamId)}}),l={"Content-Type":"text/event-stream","Cache-Control":"no-cache, no-transform",Connection:"keep-alive"};return this.sessionId!==void 0&&(l["mcp-session-id"]=this.sessionId),this._streamMapping.set(this._standaloneSseStreamId,{controller:a,encoder:s,cleanup:()=>{this._streamMapping.delete(this.
_standaloneSseStreamId);try{a.close()}catch{}}}),new Response(o,{headers:l})}async replayEvents(e){if(!this._eventStore)return this.createJsonErrorResponse(400,-32e3,"Event store not configured");try{let n;if(this._eventStore.getStreamIdForEventId){if(n=await this._eventStore.getStreamIdForEventId(e),!n)return this.createJsonErrorResponse(400,-32e3,"Invalid event ID format");if(this._streamMapping.get(n)!==void 0)return this.createJsonErrorResponse(409,-32e3,"Conflict: Stream already has an acti\
ve connection")}const r={"Content-Type":"text/event-stream","Cache-Control":"no-cache, no-transform",Connection:"keep-alive"};this.sessionId!==void 0&&(r["mcp-session-id"]=this.sessionId);const i=new TextEncoder;let s;const a=new ReadableStream({start:l=>{s=l},cancel:()=>{}}),o=await this._eventStore.replayEventsAfter(e,{send:async(l,c)=>{if(!this.writeSSEEvent(s,i,c,l)){this.onerror?.(new Error("Failed replay events"));try{s.close()}catch{}}}});return this._streamMapping.set(o,{controller:s,encoder:i,
cleanup:()=>{this._streamMapping.delete(o);try{s.close()}catch{}}}),new Response(a,{headers:r})}catch(n){return this.onerror?.(n),this.createJsonErrorResponse(500,-32e3,"Error replaying events")}}writeSSEEvent(e,n,r,i){try{let s=`event: message
`;return i&&(s+=`id: ${i}
`),s+=`data: ${JSON.stringify(r)}

`,e.enqueue(n.encode(s)),!0}catch{return!1}}handleUnsupportedRequest(){return new Response(JSON.stringify({jsonrpc:"2.0",error:{code:-32e3,message:"Method not allowed."},id:null}),{status:405,headers:{Allow:"GET, POST, DELETE","Content-Type":"application/json"}})}async handlePostRequest(e,n){try{const r=e.headers.get("accept");if(!r?.includes("application/json")||!r.includes("text/event-stream"))return this.createJsonErrorResponse(406,-32e3,"Not Acceptable: Client must accept both application/js\
on and text/event-stream");const i=e.headers.get("content-type");if(!i||!i.includes("application/json"))return this.createJsonErrorResponse(415,-32e3,"Unsupported Media Type: Content-Type must be application/json");const s={headers:Object.fromEntries(e.headers.entries())};let a;if(n?.parsedBody!==void 0)a=n.parsedBody;else try{a=await e.json()}catch{return this.createJsonErrorResponse(400,-32700,"Parse error: Invalid JSON")}let o;try{Array.isArray(a)?o=a.map(g=>_R.parse(g)):o=[_R.parse(a)]}catch{
return this.createJsonErrorResponse(400,-32700,"Parse error: Invalid JSON-RPC message")}const l=o.some(lO);if(l){if(this._initialized&&this.sessionId!==void 0)return this.createJsonErrorResponse(400,-32600,"Invalid Request: Server already initialized");if(o.length>1)return this.createJsonErrorResponse(400,-32600,"Invalid Request: Only one initialization request is allowed");this.sessionId=this.sessionIdGenerator?.(),this._initialized=!0,this.sessionId&&this._onsessioninitialized&&await Promise.resolve(
this._onsessioninitialized(this.sessionId))}if(!l){const g=this.validateSession(e);if(g)return g;const h=this.validateProtocolVersion(e);if(h)return h}if(!o.some(mc)){for(const g of o)this.onmessage?.(g,{authInfo:n?.authInfo,requestInfo:s});return new Response(null,{status:202})}const u=crypto.randomUUID(),d=o.find(g=>lO(g)),f=d?d.params.protocolVersion:e.headers.get("mcp-protocol-version")??FQ;if(this._enableJsonResponse)return new Promise(g=>{this._streamMapping.set(u,{resolveJson:g,cleanup:()=>{
this._streamMapping.delete(u)}});for(const h of o)mc(h)&&this._requestToStreamMapping.set(h.id,u);for(const h of o)this.onmessage?.(h,{authInfo:n?.authInfo,requestInfo:s})});const p=new TextEncoder;let m;const w=new ReadableStream({start:g=>{m=g},cancel:()=>{this._streamMapping.delete(u)}}),v={"Content-Type":"text/event-stream","Cache-Control":"no-cache",Connection:"keep-alive"};this.sessionId!==void 0&&(v["mcp-session-id"]=this.sessionId);for(const g of o)mc(g)&&(this._streamMapping.set(u,{controller:m,
encoder:p,cleanup:()=>{this._streamMapping.delete(u);try{m.close()}catch{}}}),this._requestToStreamMapping.set(g.id,u));await this.writePrimingEvent(m,p,u,f);for(const g of o){let h,y;mc(g)&&this._eventStore&&f>="2025-11-25"&&(h=()=>{this.closeSSEStream(g.id)},y=()=>{this.closeStandaloneSSEStream()}),this.onmessage?.(g,{authInfo:n?.authInfo,requestInfo:s,closeSSEStream:h,closeStandaloneSSEStream:y})}return new Response(w,{status:200,headers:v})}catch(r){return this.onerror?.(r),this.createJsonErrorResponse(
400,-32700,"Parse error",{data:String(r)})}}async handleDeleteRequest(e){const n=this.validateSession(e);if(n)return n;const r=this.validateProtocolVersion(e);return r||(await Promise.resolve(this._onsessionclosed?.(this.sessionId)),await this.close(),new Response(null,{status:200}))}validateSession(e){if(this.sessionIdGenerator===void 0)return;if(!this._initialized)return this.createJsonErrorResponse(400,-32e3,"Bad Request: Server not initialized");const n=e.headers.get("mcp-session-id");if(!n)
return this.createJsonErrorResponse(400,-32e3,"Bad Request: Mcp-Session-Id header is required");if(n!==this.sessionId)return this.createJsonErrorResponse(404,-32001,"Session not found")}validateProtocolVersion(e){const n=e.headers.get("mcp-protocol-version");if(n!==null&&!vR.includes(n))return this.createJsonErrorResponse(400,-32e3,`Bad Request: Unsupported protocol version: ${n} (supported versions: ${vR.join(", ")})`)}async close(){this._streamMapping.forEach(({cleanup:e})=>{e()}),this._streamMapping.
clear(),this._requestResponseMap.clear(),this.onclose?.()}closeSSEStream(e){const n=this._requestToStreamMapping.get(e);if(!n)return;const r=this._streamMapping.get(n);r&&r.cleanup()}closeStandaloneSSEStream(){const e=this._streamMapping.get(this._standaloneSseStreamId);e&&e.cleanup()}async send(e,n){let r=n?.relatedRequestId;if((jo(e)||Iy(e))&&(r=e.id),r===void 0){if(jo(e)||Iy(e))throw new Error("Cannot send a response on a standalone SSE stream unless resuming a previous client request");let a;
this._eventStore&&(a=await this._eventStore.storeEvent(this._standaloneSseStreamId,e));const o=this._streamMapping.get(this._standaloneSseStreamId);if(o===void 0)return;o.controller&&o.encoder&&this.writeSSEEvent(o.controller,o.encoder,e,a);return}const i=this._requestToStreamMapping.get(r);if(!i)throw new Error(`No connection established for request ID: ${String(r)}`);const s=this._streamMapping.get(i);if(!this._enableJsonResponse&&s?.controller&&s?.encoder){let a;this._eventStore&&(a=await this.
_eventStore.storeEvent(i,e)),this.writeSSEEvent(s.controller,s.encoder,e,a)}if(jo(e)||Iy(e)){this._requestResponseMap.set(r,e);const a=Array.from(this._requestToStreamMapping.entries()).filter(([l,c])=>c===i).map(([l])=>l);if(a.every(l=>this._requestResponseMap.has(l))){if(!s)throw new Error(`No connection established for request ID: ${String(r)}`);if(this._enableJsonResponse&&s.resolveJson){const l={"Content-Type":"application/json"};this.sessionId!==void 0&&(l["mcp-session-id"]=this.sessionId);
const c=a.map(u=>this._requestResponseMap.get(u));c.length===1?s.resolveJson(new Response(JSON.stringify(c[0]),{status:200,headers:l})):s.resolveJson(new Response(JSON.stringify(c),{status:200,headers:l}))}else s.cleanup();for(const l of a)this._requestResponseMap.delete(l),this._requestToStreamMapping.delete(l)}}}}var TO=(t,e,n)=>(r,i)=>{let s=-1;return a(0);async function a(o){if(o<=s)throw new Error("next() called multiple times");s=o;let l,c=!1,u;if(t[o]?(u=t[o][0][0],r.req.routeIndex=o):u=o===
t.length&&i||void 0,u)try{l=await u(r,()=>a(o+1))}catch(d){if(d instanceof Error&&e)r.error=d,l=await e(d,r),c=!0;else throw d}else r.finalized===!1&&n&&(l=await n(r));return l&&(r.finalized===!1||c)&&(r.res=l),r}},Hte=Symbol(),Vte=async(t,e=Object.create(null))=>{const{all:n=!1,dot:r=!1}=e,s=(t instanceof NO?t.raw.headers:t.headers).get("Content-Type");return s?.startsWith("multipart/form-data")||s?.startsWith("application/x-www-form-urlencoded")?Bte(t,{all:n,dot:r}):{}};async function Bte(t,e){
const n=await t.formData();return n?Wte(n,e):{}}function Wte(t,e){const n=Object.create(null);return t.forEach((r,i)=>{e.all||i.endsWith("[]")?Gte(n,i,r):n[i]=r}),e.dot&&Object.entries(n).forEach(([r,i])=>{r.includes(".")&&(Kte(n,r,i),delete n[r])}),n}var Gte=(t,e,n)=>{t[e]!==void 0?Array.isArray(t[e])?t[e].push(n):t[e]=[t[e],n]:e.endsWith("[]")?t[e]=[n]:t[e]=n},Kte=(t,e,n)=>{let r=t;const i=e.split(".");i.forEach((s,a)=>{a===i.length-1?r[s]=n:((!r[s]||typeof r[s]!="object"||Array.isArray(r[s])||
r[s]instanceof File)&&(r[s]=Object.create(null)),r=r[s])})},EO=t=>{const e=t.split("/");return e[0]===""&&e.shift(),e},Zte=t=>{const{groups:e,path:n}=Jte(t),r=EO(n);return Yte(r,e)},Jte=t=>{const e=[];return t=t.replace(/\{[^}]+\}/g,(n,r)=>{const i=`@${r}`;return e.push([i,n]),i}),{groups:e,path:t}},Yte=(t,e)=>{for(let n=e.length-1;n>=0;n--){const[r]=e[n];for(let i=t.length-1;i>=0;i--)if(t[i].includes(r)){t[i]=t[i].replace(r,e[n][1]);break}}return t},zy={},Xte=(t,e)=>{if(t==="*")return"*";const n=t.
match(/^\:([^\{\}]+)(?:\{(.+)\})?$/);if(n){const r=`${t}#${e}`;return zy[r]||(n[2]?zy[r]=e&&e[0]!==":"&&e[0]!=="*"?[r,n[1],new RegExp(`^${n[2]}(?=/${e})`)]:[t,n[1],new RegExp(`^${n[2]}$`)]:zy[r]=[t,n[1],!0]),zy[r]}return null},XR=(t,e)=>{try{return e(t)}catch{return t.replace(/(?:%[0-9A-Fa-f]{2})+/g,n=>{try{return e(n)}catch{return n}})}},Qte=t=>XR(t,decodeURI),PO=t=>{const e=t.url,n=e.indexOf("/",e.indexOf(":")+4);let r=n;for(;r<e.length;r++){const i=e.charCodeAt(r);if(i===37){const s=e.indexOf(
"?",r),a=e.slice(n,s===-1?void 0:s);return Qte(a.includes("%25")?a.replace(/%25/g,"%2525"):a)}else if(i===63)break}return e.slice(n,r)},ene=t=>{const e=PO(t);return e.length>1&&e.at(-1)==="/"?e.slice(0,-1):e},kc=(t,e,...n)=>(n.length&&(e=kc(e,...n)),`${t?.[0]==="/"?"":"/"}${t}${e==="/"?"":`${t?.at(-1)==="/"?"":"/"}${e?.[0]==="/"?e.slice(1):e}`}`),CO=t=>{if(t.charCodeAt(t.length-1)!==63||!t.includes(":"))return null;const e=t.split("/"),n=[];let r="";return e.forEach(i=>{if(i!==""&&!/\:/.test(i))
r+="/"+i;else if(/\:/.test(i))if(/\?/.test(i)){n.length===0&&r===""?n.push("/"):n.push(r);const s=i.replace("?","");r+="/"+s,n.push(r)}else r+="/"+i}),n.filter((i,s,a)=>a.indexOf(i)===s)},QR=t=>/[%+]/.test(t)?(t.indexOf("+")!==-1&&(t=t.replace(/\+/g," ")),t.indexOf("%")!==-1?XR(t,AO):t):t,xO=(t,e,n)=>{let r;if(!n&&e&&!/[%+]/.test(e)){let a=t.indexOf("?",8);if(a===-1)return;for(t.startsWith(e,a+1)||(a=t.indexOf(`&${e}`,a+1));a!==-1;){const o=t.charCodeAt(a+e.length+1);if(o===61){const l=a+e.length+
2,c=t.indexOf("&",l);return QR(t.slice(l,c===-1?void 0:c))}else if(o==38||isNaN(o))return"";a=t.indexOf(`&${e}`,a+1)}if(r=/[%+]/.test(t),!r)return}const i={};r??=/[%+]/.test(t);let s=t.indexOf("?",8);for(;s!==-1;){const a=t.indexOf("&",s+1);let o=t.indexOf("=",s);o>a&&a!==-1&&(o=-1);let l=t.slice(s+1,o===-1?a===-1?void 0:a:o);if(r&&(l=QR(l)),s=a,l==="")continue;let c;o===-1?c="":(c=t.slice(o+1,a===-1?void 0:a),r&&(c=QR(c))),n?(i[l]&&Array.isArray(i[l])||(i[l]=[]),i[l].push(c)):i[l]??=c}return e?
i[e]:i},tne=xO,nne=(t,e)=>xO(t,e,!0),AO=decodeURIComponent,IO=t=>XR(t,AO),NO=class{raw;#e;#t;routeIndex=0;path;bodyCache={};constructor(t,e="/",n=[[]]){this.raw=t,this.path=e,this.#t=n,this.#e={}}param(t){return t?this.#n(t):this.#r()}#n(t){const e=this.#t[0][this.routeIndex][1][t],n=this.#i(e);return n&&/\%/.test(n)?IO(n):n}#r(){const t={},e=Object.keys(this.#t[0][this.routeIndex][1]);for(const n of e){const r=this.#i(this.#t[0][this.routeIndex][1][n]);r!==void 0&&(t[n]=/\%/.test(r)?IO(r):r)}return t}#i(t){
return this.#t[1]?this.#t[1][t]:t}query(t){return tne(this.url,t)}queries(t){return nne(this.url,t)}header(t){if(t)return this.raw.headers.get(t)??void 0;const e={};return this.raw.headers.forEach((n,r)=>{e[r]=n}),e}async parseBody(t){return this.bodyCache.parsedBody??=await Vte(this,t)}#s=t=>{const{bodyCache:e,raw:n}=this,r=e[t];if(r)return r;const i=Object.keys(e)[0];return i?e[i].then(s=>(i==="json"&&(s=JSON.stringify(s)),new Response(s)[t]())):e[t]=n[t]()};json(){return this.#s("text").then(
t=>JSON.parse(t))}text(){return this.#s("text")}arrayBuffer(){return this.#s("arrayBuffer")}blob(){return this.#s("blob")}formData(){return this.#s("formData")}addValidatedData(t,e){this.#e[t]=e}valid(t){return this.#e[t]}get url(){return this.raw.url}get method(){return this.raw.method}get[Hte](){return this.#t}get matchedRoutes(){return this.#t[0].map(([[,t]])=>t)}get routePath(){return this.#t[0].map(([[,t]])=>t)[this.routeIndex].path}},rne={Stringify:1},DO=async(t,e,n,r,i)=>{typeof t=="objec\
t"&&!(t instanceof String)&&(t instanceof Promise||(t=t.toString()),t instanceof Promise&&(t=await t));const s=t.callbacks;return s?.length?(i?i[0]+=t:i=[t],Promise.all(s.map(o=>o({phase:e,buffer:i,context:r}))).then(o=>Promise.all(o.filter(Boolean).map(l=>DO(l,e,!1,r,i))).then(()=>i[0]))):Promise.resolve(t)},ine="text/plain; charset=UTF-8",eS=(t,e)=>({"Content-Type":t,...e}),sne=class{#e;#t;env={};#n;finalized=!1;error;#r;#i;#s;#a;#u;#o;#d;#l;#f;constructor(t,e){this.#e=t,e&&(this.#i=e.executionCtx,
this.env=e.env,this.#o=e.notFoundHandler,this.#f=e.path,this.#l=e.matchResult)}get req(){return this.#t??=new NO(this.#e,this.#f,this.#l),this.#t}get event(){if(this.#i&&"respondWith"in this.#i)return this.#i;throw Error("This context has no FetchEvent")}get executionCtx(){if(this.#i)return this.#i;throw Error("This context has no ExecutionContext")}get res(){return this.#s||=new Response(null,{headers:this.#d??=new Headers})}set res(t){if(this.#s&&t){t=new Response(t.body,t);for(const[e,n]of this.#s.
headers.entries())if(e!=="content-type")if(e==="set-cookie"){const r=this.#s.headers.getSetCookie();t.headers.delete("set-cookie");for(const i of r)t.headers.append("set-cookie",i)}else t.headers.set(e,n)}this.#s=t,this.finalized=!0}render=(...t)=>(this.#u??=e=>this.html(e),this.#u(...t));setLayout=t=>this.#a=t;getLayout=()=>this.#a;setRenderer=t=>{this.#u=t};header=(t,e,n)=>{this.finalized&&(this.#s=new Response(this.#s.body,this.#s));const r=this.#s?this.#s.headers:this.#d??=new Headers;e===void 0?
r.delete(t):n?.append?r.append(t,e):r.set(t,e)};status=t=>{this.#r=t};set=(t,e)=>{this.#n??=new Map,this.#n.set(t,e)};get=t=>this.#n?this.#n.get(t):void 0;get var(){return this.#n?Object.fromEntries(this.#n):{}}#c(t,e,n){const r=this.#s?new Headers(this.#s.headers):this.#d??new Headers;if(typeof e=="object"&&"headers"in e){const s=e.headers instanceof Headers?e.headers:new Headers(e.headers);for(const[a,o]of s)a.toLowerCase()==="set-cookie"?r.append(a,o):r.set(a,o)}if(n)for(const[s,a]of Object.entries(
n))if(typeof a=="string")r.set(s,a);else{r.delete(s);for(const o of a)r.append(s,o)}const i=typeof e=="number"?e:e?.status??this.#r;return new Response(t,{status:i,headers:r})}newResponse=(...t)=>this.#c(...t);body=(t,e,n)=>this.#c(t,e,n);text=(t,e,n)=>!this.#d&&!this.#r&&!e&&!n&&!this.finalized?new Response(t):this.#c(t,e,eS(ine,n));json=(t,e,n)=>this.#c(JSON.stringify(t),e,eS("application/json",n));html=(t,e,n)=>{const r=i=>this.#c(i,e,eS("text/html; charset=UTF-8",n));return typeof t=="object"?
DO(t,rne.Stringify,!1,{}).then(r):r(t)};redirect=(t,e)=>{const n=String(t);return this.header("Location",/[^\x00-\xFF]/.test(n)?encodeURI(n):n),this.newResponse(null,e??302)};notFound=()=>(this.#o??=()=>new Response,this.#o(this))},En="ALL",ane="all",one=["get","post","put","delete","options","patch"],OO="Can not add a route since the matcher is already built.",LO=class extends Error{},lne="__COMPOSED_HANDLER",cne=t=>t.text("404 Not Found",404),MO=(t,e)=>{if("getResponse"in t){const n=t.getResponse();
return e.newResponse(n.body,n)}return console.error(t),e.text("Internal Server Error",500)},une=class lq{get;post;put;delete;options;patch;all;on;use;router;getPath;_basePath="/";#e="/";routes=[];constructor(e={}){[...one,ane].forEach(s=>{this[s]=(a,...o)=>(typeof a=="string"?this.#e=a:this.#r(s,this.#e,a),o.forEach(l=>{this.#r(s,this.#e,l)}),this)}),this.on=(s,a,...o)=>{for(const l of[a].flat()){this.#e=l;for(const c of[s].flat())o.map(u=>{this.#r(c.toUpperCase(),this.#e,u)})}return this},this.
use=(s,...a)=>(typeof s=="string"?this.#e=s:(this.#e="*",a.unshift(s)),a.forEach(o=>{this.#r(En,this.#e,o)}),this);const{strict:r,...i}=e;Object.assign(this,i),this.getPath=r??!0?e.getPath??PO:ene}#t(){const e=new lq({router:this.router,getPath:this.getPath});return e.errorHandler=this.errorHandler,e.#n=this.#n,e.routes=this.routes,e}#n=cne;errorHandler=MO;route(e,n){const r=this.basePath(e);return n.routes.map(i=>{let s;n.errorHandler===MO?s=i.handler:(s=async(a,o)=>(await TO([],n.errorHandler)(
a,()=>i.handler(a,o))).res,s[lne]=i.handler),r.#r(i.method,i.path,s)}),this}basePath(e){const n=this.#t();return n._basePath=kc(this._basePath,e),n}onError=e=>(this.errorHandler=e,this);notFound=e=>(this.#n=e,this);mount(e,n,r){let i,s;r&&(typeof r=="function"?s=r:(s=r.optionHandler,r.replaceRequest===!1?i=l=>l:i=r.replaceRequest));const a=s?l=>{const c=s(l);return Array.isArray(c)?c:[c]}:l=>{let c;try{c=l.executionCtx}catch{}return[l.env,c]};i||=(()=>{const l=kc(this._basePath,e),c=l==="/"?0:l.
length;return u=>{const d=new URL(u.url);return d.pathname=d.pathname.slice(c)||"/",new Request(d,u)}})();const o=async(l,c)=>{const u=await n(i(l.req.raw),...a(l));if(u)return u;await c()};return this.#r(En,kc(e,"*"),o),this}#r(e,n,r){e=e.toUpperCase(),n=kc(this._basePath,n);const i={basePath:this._basePath,path:n,method:e,handler:r};this.router.add(e,n,[r,i]),this.routes.push(i)}#i(e,n){if(e instanceof Error)return this.errorHandler(e,n);throw e}#s(e,n,r,i){if(i==="HEAD")return(async()=>new Response(
null,await this.#s(e,n,r,"GET")))();const s=this.getPath(e,{env:r}),a=this.router.match(i,s),o=new sne(e,{path:s,matchResult:a,env:r,executionCtx:n,notFoundHandler:this.#n});if(a[0].length===1){let c;try{c=a[0][0][0][0](o,async()=>{o.res=await this.#n(o)})}catch(u){return this.#i(u,o)}return c instanceof Promise?c.then(u=>u||(o.finalized?o.res:this.#n(o))).catch(u=>this.#i(u,o)):c??this.#n(o)}const l=TO(a[0],this.errorHandler,this.#n);return(async()=>{try{const c=await l(o);if(!c.finalized)throw new Error(
"Context is not finalized. Did you forget to return a Response object or `await next()`?");return c.res}catch(c){return this.#i(c,o)}})()}fetch=(e,...n)=>this.#s(e,n[1],n[0],e.method);request=(e,n,r,i)=>e instanceof Request?this.fetch(n?new Request(e,n):e,r,i):(e=e.toString(),this.fetch(new Request(/^https?:\/\//.test(e)?e:`http://localhost${kc("/",e)}`,n),r,i));fire=()=>{addEventListener("fetch",e=>{e.respondWith(this.#s(e.request,e,void 0,e.request.method))})}},jO=[];function dne(t,e){const n=this.
buildAllMatchers(),r=((i,s)=>{const a=n[i]||n[En],o=a[2][s];if(o)return o;const l=s.match(a[0]);if(!l)return[[],jO];const c=l.indexOf("",1);return[a[1][c],l]});return this.match=r,r(t,e)}var Uy="[^/]+",Ap=".*",Ip="(?:|/.*)",_c=Symbol(),fne=new Set(".\\+*[^]$()");function pne(t,e){return t.length===1?e.length===1?t<e?-1:1:-1:e.length===1||t===Ap||t===Ip?1:e===Ap||e===Ip?-1:t===Uy?1:e===Uy?-1:t.length===e.length?t<e?-1:1:e.length-t.length}var hne=class q${#e;#t;#n=Object.create(null);insert(e,n,r,i,s){
if(e.length===0){if(this.#e!==void 0)throw _c;if(s)return;this.#e=n;return}const[a,...o]=e,l=a==="*"?o.length===0?["","",Ap]:["","",Uy]:a==="/*"?["","",Ip]:a.match(/^\:([^\{\}]+)(?:\{(.+)\})?$/);let c;if(l){const u=l[1];let d=l[2]||Uy;if(u&&l[2]&&(d===".*"||(d=d.replace(/^\((?!\?:)(?=[^)]+\)$)/,"(?:"),/\((?!\?:)/.test(d))))throw _c;if(c=this.#n[d],!c){if(Object.keys(this.#n).some(f=>f!==Ap&&f!==Ip))throw _c;if(s)return;c=this.#n[d]=new q$,u!==""&&(c.#t=i.varIndex++)}!s&&u!==""&&r.push([u,c.#t])}else if(c=
this.#n[a],!c){if(Object.keys(this.#n).some(u=>u.length>1&&u!==Ap&&u!==Ip))throw _c;if(s)return;c=this.#n[a]=new q$}c.insert(o,n,r,i,s)}buildRegExpStr(){const n=Object.keys(this.#n).sort(pne).map(r=>{const i=this.#n[r];return(typeof i.#t=="number"?`(${r})@${i.#t}`:fne.has(r)?`\\${r}`:r)+i.buildRegExpStr()});return typeof this.#e=="number"&&n.unshift(`#${this.#e}`),n.length===0?"":n.length===1?n[0]:"(?:"+n.join("|")+")"}},mne=class{#e={varIndex:0};#t=new hne;insert(t,e,n){const r=[],i=[];for(let a=0;;){
let o=!1;if(t=t.replace(/\{[^}]+\}/g,l=>{const c=`@\\${a}`;return i[a]=[c,l],a++,o=!0,c}),!o)break}const s=t.match(/(?::[^\/]+)|(?:\/\*$)|./g)||[];for(let a=i.length-1;a>=0;a--){const[o]=i[a];for(let l=s.length-1;l>=0;l--)if(s[l].indexOf(o)!==-1){s[l]=s[l].replace(o,i[a][1]);break}}return this.#t.insert(s,e,r,this.#e,n),r}buildRegExp(){let t=this.#t.buildRegExpStr();if(t==="")return[/^$/,[],[]];let e=0;const n=[],r=[];return t=t.replace(/#(\d+)|@(\d+)|\.\*\$/g,(i,s,a)=>s!==void 0?(n[++e]=Number(
s),"$()"):(a!==void 0&&(r[Number(a)]=++e),"")),[new RegExp(`^${t}`),n,r]}},gne=[/^$/,[],Object.create(null)],qO=Object.create(null);function FO(t){return qO[t]??=new RegExp(t==="*"?"":`^${t.replace(/\/\*$|([.\\+*[^\]$()])/g,(e,n)=>n?`\\${n}`:"(?:|/.*)")}$`)}function yne(){qO=Object.create(null)}function vne(t){const e=new mne,n=[];if(t.length===0)return gne;const r=t.map(c=>[!/\*|\/:/.test(c[0]),...c]).sort(([c,u],[d,f])=>c?1:d?-1:u.length-f.length),i=Object.create(null);for(let c=0,u=-1,d=r.length;c<
d;c++){const[f,p,m]=r[c];f?i[p]=[m.map(([v])=>[v,Object.create(null)]),jO]:u++;let w;try{w=e.insert(p,u,f)}catch(v){throw v===_c?new LO(p):v}f||(n[u]=m.map(([v,g])=>{const h=Object.create(null);for(g-=1;g>=0;g--){const[y,b]=w[g];h[y]=b}return[v,h]}))}const[s,a,o]=e.buildRegExp();for(let c=0,u=n.length;c<u;c++)for(let d=0,f=n[c].length;d<f;d++){const p=n[c][d]?.[1];if(!p)continue;const m=Object.keys(p);for(let w=0,v=m.length;w<v;w++)p[m[w]]=o[p[m[w]]]}const l=[];for(const c in a)l[c]=n[a[c]];return[
s,l,i]}function Rc(t,e){if(t){for(const n of Object.keys(t).sort((r,i)=>i.length-r.length))if(FO(n).test(e))return[...t[n]]}}var wne=class{name="RegExpRouter";#e;#t;constructor(){this.#e={[En]:Object.create(null)},this.#t={[En]:Object.create(null)}}add(t,e,n){const r=this.#e,i=this.#t;if(!r||!i)throw new Error(OO);r[t]||[r,i].forEach(o=>{o[t]=Object.create(null),Object.keys(o[En]).forEach(l=>{o[t][l]=[...o[En][l]]})}),e==="/*"&&(e="*");const s=(e.match(/\/:/g)||[]).length;if(/\*$/.test(e)){const o=FO(
e);t===En?Object.keys(r).forEach(l=>{r[l][e]||=Rc(r[l],e)||Rc(r[En],e)||[]}):r[t][e]||=Rc(r[t],e)||Rc(r[En],e)||[],Object.keys(r).forEach(l=>{(t===En||t===l)&&Object.keys(r[l]).forEach(c=>{o.test(c)&&r[l][c].push([n,s])})}),Object.keys(i).forEach(l=>{(t===En||t===l)&&Object.keys(i[l]).forEach(c=>o.test(c)&&i[l][c].push([n,s]))});return}const a=CO(e)||[e];for(let o=0,l=a.length;o<l;o++){const c=a[o];Object.keys(i).forEach(u=>{(t===En||t===u)&&(i[u][c]||=[...Rc(r[u],c)||Rc(r[En],c)||[]],i[u][c].push(
[n,s-l+o+1]))})}}match=dne;buildAllMatchers(){const t=Object.create(null);return Object.keys(this.#t).concat(Object.keys(this.#e)).forEach(e=>{t[e]||=this.#n(e)}),this.#e=this.#t=void 0,yne(),t}#n(t){const e=[];let n=t===En;return[this.#e,this.#t].forEach(r=>{const i=r[t]?Object.keys(r[t]).map(s=>[s,r[t][s]]):[];i.length!==0?(n||=!0,e.push(...i)):t!==En&&e.push(...Object.keys(r[En]).map(s=>[s,r[En][s]]))}),n?vne(e):null}},bne=class{name="SmartRouter";#e=[];#t=[];constructor(t){this.#e=t.routers}add(t,e,n){
if(!this.#t)throw new Error(OO);this.#t.push([t,e,n])}match(t,e){if(!this.#t)throw new Error("Fatal error");const n=this.#e,r=this.#t,i=n.length;let s=0,a;for(;s<i;s++){const o=n[s];try{for(let l=0,c=r.length;l<c;l++)o.add(...r[l]);a=o.match(t,e)}catch(l){if(l instanceof LO)continue;throw l}this.match=o.match.bind(o),this.#e=[o],this.#t=void 0;break}if(s===i)throw new Error("Fatal error");return this.name=`SmartRouter + ${this.activeRouter.name}`,a}get activeRouter(){if(this.#t||this.#e.length!==
1)throw new Error("No active router has been determined yet.");return this.#e[0]}},Np=Object.create(null),kne=class cq{#e;#t;#n;#r=0;#i=Np;constructor(e,n,r){if(this.#t=r||Object.create(null),this.#e=[],e&&n){const i=Object.create(null);i[e]={handler:n,possibleKeys:[],score:0},this.#e=[i]}this.#n=[]}insert(e,n,r){this.#r=++this.#r;let i=this;const s=Zte(n),a=[];for(let o=0,l=s.length;o<l;o++){const c=s[o],u=s[o+1],d=Xte(c,u),f=Array.isArray(d)?d[0]:c;if(f in i.#t){i=i.#t[f],d&&a.push(d[1]);continue}
i.#t[f]=new cq,d&&(i.#n.push(d),a.push(d[1])),i=i.#t[f]}return i.#e.push({[e]:{handler:r,possibleKeys:a.filter((o,l,c)=>c.indexOf(o)===l),score:this.#r}}),i}#s(e,n,r,i){const s=[];for(let a=0,o=e.#e.length;a<o;a++){const l=e.#e[a],c=l[n]||l[En],u={};if(c!==void 0&&(c.params=Object.create(null),s.push(c),r!==Np||i&&i!==Np))for(let d=0,f=c.possibleKeys.length;d<f;d++){const p=c.possibleKeys[d],m=u[c.score];c.params[p]=i?.[p]&&!m?i[p]:r[p]??i?.[p],u[c.score]=!0}}return s}search(e,n){const r=[];this.#i=
Np;let s=[this];const a=EO(n),o=[];for(let l=0,c=a.length;l<c;l++){const u=a[l],d=l===c-1,f=[];for(let p=0,m=s.length;p<m;p++){const w=s[p],v=w.#t[u];v&&(v.#i=w.#i,d?(v.#t["*"]&&r.push(...this.#s(v.#t["*"],e,w.#i)),r.push(...this.#s(v,e,w.#i))):f.push(v));for(let g=0,h=w.#n.length;g<h;g++){const y=w.#n[g],b=w.#i===Np?{}:{...w.#i};if(y==="*"){const ie=w.#t["*"];ie&&(r.push(...this.#s(ie,e,w.#i)),ie.#i=b,f.push(ie));continue}const[R,T,N]=y;if(!u&&!(N instanceof RegExp))continue;const q=w.#t[R],B=a.
slice(l).join("/");if(N instanceof RegExp){const ie=N.exec(B);if(ie){if(b[T]=ie[0],r.push(...this.#s(q,e,w.#i,b)),Object.keys(q.#t).length){q.#i=b;const L=ie[0].match(/\//)?.length??0;(o[L]||=[]).push(q)}continue}}(N===!0||N.test(u))&&(b[T]=u,d?(r.push(...this.#s(q,e,b,w.#i)),q.#t["*"]&&r.push(...this.#s(q.#t["*"],e,b,w.#i))):(q.#i=b,f.push(q)))}}s=f.concat(o.shift()??[])}return r.length>1&&r.sort((l,c)=>l.score-c.score),[r.map(({handler:l,params:c})=>[l,c])]}},_ne=class{name="TrieRouter";#e;constructor(){
this.#e=new kne}add(t,e,n){const r=CO(e);if(r){for(let i=0,s=r.length;i<s;i++)this.#e.insert(t,r[i],n);return}this.#e.insert(t,e,n)}match(t,e){return this.#e.search(t,e)}},Rne=class extends une{constructor(t={}){super(t),this.router=t.router??new bne({routers:[new wne,new _ne]})}},Sne=t=>{const n={...{origin:"*",allowMethods:["GET","HEAD","PUT","POST","DELETE","PATCH"],allowHeaders:[],exposeHeaders:[]},...t},r=(s=>typeof s=="string"?s==="*"?()=>s:a=>s===a?a:null:typeof s=="function"?s:a=>s.includes(
a)?a:null)(n.origin),i=(s=>typeof s=="function"?s:Array.isArray(s)?()=>s:()=>[])(n.allowMethods);return async function(a,o){function l(u,d){a.res.headers.set(u,d)}const c=await r(a.req.header("origin")||"",a);if(c&&l("Access-Control-Allow-Origin",c),n.credentials&&l("Access-Control-Allow-Credentials","true"),n.exposeHeaders?.length&&l("Access-Control-Expose-Headers",n.exposeHeaders.join(",")),a.req.method==="OPTIONS"){n.origin!=="*"&&l("Vary","Origin"),n.maxAge!=null&&l("Access-Control-Max-Age",
n.maxAge.toString());const u=await i(a.req.header("origin")||"",a);u.length&&l("Access-Control-Allow-Methods",u.join(","));let d=n.allowHeaders;if(!d?.length){const f=a.req.header("Access-Control-Request-Headers");f&&(d=f.split(/\s*,\s*/))}return d?.length&&(l("Access-Control-Allow-Headers",d.join(",")),a.res.headers.append("Vary","Access-Control-Request-Headers")),a.res.headers.delete("Content-Length"),a.res.headers.delete("Content-Type"),new Response(null,{headers:a.res.headers,status:204,statusText:"\
No Content"})}await o(),n.origin!=="*"&&a.header("Vary","Origin",{append:!0})}};const $ne="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",Tne=128;let zo,Sc;function Ene(t){!zo||zo.length<t?(zo=Buffer.allocUnsafe(t*Tne),y0.getRandomValues(zo),Sc=0):Sc+t>zo.length&&(y0.getRandomValues(zo),Sc=0),Sc+=t}function Pne(t=21){Ene(t|=0);let e="";for(let n=Sc-t;n<Sc;n++)e+=$ne[zo[n]&63];return e}async function Cne(t){const e=t.create(),n=new Ute({sessionIdGenerator:()=>Pne()}),r=new Rne;
return r.use("*",Sne({origin:"*",allowHeaders:["Content-Type","mcp-session-id","Last-Event-ID","mcp-protocol-version"],exposeHeaders:["mcp-session-id","mcp-protocol-version"]})),r.get("/health",i=>i.json({status:"ok"})),r.all("/mcp",i=>n.handleRequest(i.req.raw)),r.notFound(i=>(nn.debug(`${i.req.method} ${i.req.url} not found`),i.json({jsonrpc:"2.0",error:{code:-32e3,message:"Method not found."},id:null},{status:404}))),r.onError((i,s)=>(nn.error(rt(i)),s.json({jsonrpc:"2.0",error:{code:-32603,message:"\
Internal server error"},id:null},{status:500}))),await e.connect(n),r}async function xne(t){const{factory:e,port:n}=t,r=await Cne(e);return new Promise((i,s)=>{const a=zte({fetch:r.fetch,hostname:"0.0.0.0",port:n}).prependOnceListener("error",s).prependOnceListener("listening",()=>{a.removeListener("error",s),i(a.unref())})})}class Ane{services;_port;server=void 0;constructor(e,n=33335){this.services=e,this._port=n}get mcp(){throw new Error("StreamableLikeC4MCPServer has access to McpServer only\
 during the request")}get isStarted(){return this.server?.listening===!0}get port(){return this._port}async dispose(){await this.stop()}async start(e=this._port){if(this.server){if(this.port===e)return;await this.stop()}nn.info("Starting MCP server on port {port}",{port:e}),this._port=e,this.server=await xne({factory:this.services.mcp.ServerFactory,port:e}),nn.info("MCP server ready at http://0.0.0.0:{port}/mcp",{port:e})}stop(){const e=this.server;return e?(nn.info("Stopping MCP server"),this.server=
void 0,new Promise(n=>{e.close(r=>{r?nn.error("Failed to stop MCP server",{err:r}):nn.info("MCP server stopped"),n()})})):(nn.info("MCP server is not running, nothing to stop"),Promise.resolve())}}const Ine=(t,e=33335)=>{nn.debug("Creating StreamableLikeC4MCPServer");const n=new Ane(t,e),r=t.LanguageMetaData.languageId,i=t.shared.lsp.Connection;return t.shared.workspace.ConfigurationProvider.onConfigurationSectionUpdate(s=>{if(s.section!==r){nn.warn("Unexpected configuration update: {update}",{update:s});
return}const{enabled:a=!1,port:o=e}=s.configuration.mcp;if(!a){n.stop();return}Promise.resolve().then(()=>n.start(o)).then(()=>{i?.telemetry?.logEvent({eventName:"mcp-server-started",mcpPort:o})}).catch(l=>{const c=rt(l);i?.telemetry?.logEvent({eventName:"mcp-server-start-failed",mcpPort:o,message:c}),nn.warn(`Failed to start LikeC4 MCP Server: 
${c}`),i&&i.window.showErrorMessage(`LikeC4: Failed to start MCP Server

${c}`)})}),n},Nne=t=>new Rte(t),Dne=(t="sse")=>({mcpServer:e=>{if(t==="stdio")return Nne(e);const n=typeof t=="object"?t.port:33335;return Ine(e,n)}}),{getOwnPropertyNames:One,getOwnPropertySymbols:Lne}=Object,{hasOwnProperty:Mne}=Object.prototype;function tS(t,e){return function(r,i,s){return t(r,i,s)&&e(r,i,s)}}function Hy(t){return function(n,r,i){if(!n||!r||typeof n!="object"||typeof r!="object")return t(n,r,i);const{cache:s}=i,a=s.get(n),o=s.get(r);if(a&&o)return a===r&&o===n;s.set(n,r),s.set(
r,n);const l=t(n,r,i);return s.delete(n),s.delete(r),l}}function zO(t){return One(t).concat(Lne(t))}const jne=Object.hasOwn||((t,e)=>Mne.call(t,e)),qne="__v",Fne="__o",zne="_owner",{getOwnPropertyDescriptor:UO,keys:HO}=Object,Uo=Object.is||function(e,n){return e===n?e!==0||1/e===1/n:e!==e&&n!==n};function Une(t,e){return t===e}function Hne(t,e){return t.byteLength===e.byteLength&&Vy(new Uint8Array(t),new Uint8Array(e))}function Vne(t,e,n){let r=t.length;if(e.length!==r)return!1;for(;r-- >0;)if(!n.
equals(t[r],e[r],r,r,t,e,n))return!1;return!0}function Bne(t,e){return t.byteLength===e.byteLength&&Vy(new Uint8Array(t.buffer,t.byteOffset,t.byteLength),new Uint8Array(e.buffer,e.byteOffset,e.byteLength))}function Wne(t,e){return Uo(t.getTime(),e.getTime())}function Gne(t,e){return t.name===e.name&&t.message===e.message&&t.cause===e.cause&&t.stack===e.stack}function VO(t,e,n){const r=t.size;if(r!==e.size)return!1;if(!r)return!0;const i=new Array(r),s=t.entries();let a,o,l=0;for(;(a=s.next())&&!a.
done;){const c=e.entries();let u=!1,d=0;for(;(o=c.next())&&!o.done;){if(i[d]){d++;continue}const f=a.value,p=o.value;if(n.equals(f[0],p[0],l,d,t,e,n)&&n.equals(f[1],p[1],f[0],p[0],t,e,n)){u=i[d]=!0;break}d++}if(!u)return!1;l++}return!0}function Kne(t,e,n){const r=HO(t);let i=r.length;if(HO(e).length!==i)return!1;for(;i-- >0;)if(!WO(t,e,n,r[i]))return!1;return!0}function Dp(t,e,n){const r=zO(t);let i=r.length;if(zO(e).length!==i)return!1;let s,a,o;for(;i-- >0;)if(s=r[i],!WO(t,e,n,s)||(a=UO(t,s),o=
UO(e,s),(a||o)&&(!a||!o||a.configurable!==o.configurable||a.enumerable!==o.enumerable||a.writable!==o.writable)))return!1;return!0}function Zne(t,e){return Uo(t.valueOf(),e.valueOf())}function Jne(t,e){return t.source===e.source&&t.flags===e.flags}function BO(t,e,n){const r=t.size;if(r!==e.size)return!1;if(!r)return!0;const i=new Array(r),s=t.values();let a,o;for(;(a=s.next())&&!a.done;){const l=e.values();let c=!1,u=0;for(;(o=l.next())&&!o.done;){if(!i[u]&&n.equals(a.value,o.value,a.value,o.value,
t,e,n)){c=i[u]=!0;break}u++}if(!c)return!1}return!0}function Vy(t,e){let n=t.byteLength;if(e.byteLength!==n||t.byteOffset!==e.byteOffset)return!1;for(;n-- >0;)if(t[n]!==e[n])return!1;return!0}function Yne(t,e){return t.hostname===e.hostname&&t.pathname===e.pathname&&t.protocol===e.protocol&&t.port===e.port&&t.hash===e.hash&&t.username===e.username&&t.password===e.password}function WO(t,e,n,r){return(r===zne||r===Fne||r===qne)&&(t.$$typeof||e.$$typeof)?!0:jne(e,r)&&n.equals(t[r],e[r],r,r,t,e,n)}const Xne=Object.
prototype.toString;function Qne(t){const e=rre(t),{areArraysEqual:n,areDatesEqual:r,areFunctionsEqual:i,areMapsEqual:s,areNumbersEqual:a,areObjectsEqual:o,areRegExpsEqual:l,areSetsEqual:c,getUnsupportedCustomComparator:u}=t;return function(f,p,m){if(f===p)return!0;if(f==null||p==null)return!1;const w=typeof f;if(w!==typeof p)return!1;if(w!=="object")return w==="number"||w==="bigint"?a(f,p,m):w==="function"?i(f,p,m):!1;const v=f.constructor;if(v!==p.constructor)return!1;if(v===Object)return o(f,p,
m);if(v===Array)return n(f,p,m);if(v===Date)return r(f,p,m);if(v===RegExp)return l(f,p,m);if(v===Map)return s(f,p,m);if(v===Set)return c(f,p,m);if(v===Promise)return!1;if(Array.isArray(f))return n(f,p,m);const g=Xne.call(f),h=e[g];if(h)return h(f,p,m);const y=u&&u(f,p,m,g);return y?y(f,p,m):!1}}function ere({circular:t,createCustomConfig:e,strict:n}){let r={areArrayBuffersEqual:Hne,areArraysEqual:n?Dp:Vne,areDataViewsEqual:Bne,areDatesEqual:Wne,areErrorsEqual:Gne,areFunctionsEqual:Une,areMapsEqual:n?
tS(VO,Dp):VO,areNumbersEqual:Uo,areObjectsEqual:n?Dp:Kne,arePrimitiveWrappersEqual:Zne,areRegExpsEqual:Jne,areSetsEqual:n?tS(BO,Dp):BO,areTypedArraysEqual:n?tS(Vy,Dp):Vy,areUrlsEqual:Yne,getUnsupportedCustomComparator:void 0};if(e&&(r=Object.assign({},r,e(r))),t){const i=Hy(r.areArraysEqual),s=Hy(r.areMapsEqual),a=Hy(r.areObjectsEqual),o=Hy(r.areSetsEqual);r=Object.assign({},r,{areArraysEqual:i,areMapsEqual:s,areObjectsEqual:a,areSetsEqual:o})}return r}function tre(t){return function(e,n,r,i,s,a,o){
return t(e,n,o)}}function nre({circular:t,comparator:e,createState:n,equals:r,strict:i}){if(n)return function(o,l){const{cache:c=t?new WeakMap:void 0,meta:u}=n();return e(o,l,{cache:c,equals:r,meta:u,strict:i})};if(t)return function(o,l){return e(o,l,{cache:new WeakMap,equals:r,meta:void 0,strict:i})};const s={cache:void 0,equals:r,meta:void 0,strict:i};return function(o,l){return e(o,l,s)}}function rre({areArrayBuffersEqual:t,areArraysEqual:e,areDataViewsEqual:n,areDatesEqual:r,areErrorsEqual:i,
areFunctionsEqual:s,areMapsEqual:a,areNumbersEqual:o,areObjectsEqual:l,arePrimitiveWrappersEqual:c,areRegExpsEqual:u,areSetsEqual:d,areTypedArraysEqual:f,areUrlsEqual:p}){return{"[object Arguments]":l,"[object Array]":e,"[object ArrayBuffer]":t,"[object AsyncGeneratorFunction]":s,"[object BigInt]":o,"[object BigInt64Array]":f,"[object BigUint64Array]":f,"[object Boolean]":c,"[object DataView]":n,"[object Date]":r,"[object Error]":i,"[object Float16Array]":f,"[object Float32Array]":f,"[object Flo\
at64Array]":f,"[object Function]":s,"[object GeneratorFunction]":s,"[object Int8Array]":f,"[object Int16Array]":f,"[object Int32Array]":f,"[object Map]":a,"[object Number]":c,"[object Object]":(m,w,v)=>typeof m.then!="function"&&typeof w.then!="function"&&l(m,w,v),"[object RegExp]":u,"[object Set]":d,"[object String]":c,"[object URL]":p,"[object Uint8Array]":f,"[object Uint8ClampedArray]":f,"[object Uint16Array]":f,"[object Uint32Array]":f}}const nS=$a();$a({strict:!0}),$a({circular:!0}),$a({circular:!0,
strict:!0}),$a({createInternalComparator:()=>Uo}),$a({strict:!0,createInternalComparator:()=>Uo}),$a({circular:!0,createInternalComparator:()=>Uo}),$a({circular:!0,createInternalComparator:()=>Uo,strict:!0});function $a(t={}){const{circular:e=!1,createInternalComparator:n,createState:r,strict:i=!1}=t,s=ere(t),a=Qne(s),o=n?n(a):tre(a);return nre({circular:e,comparator:a,createState:r,equals:o,strict:i})}const ire=100,GO=100,Ta={top:50,right:40,bottom:40,left:40};function KO(t,e){const n=t.nodes.map(
i=>{const s=e.nodes[i.id];if(!s)return i;const{x:a,y:o,width:l,height:c}=s;return{...i,width:l,height:c,x:a,y:o}}),r=t.edges.map(i=>{const s=e.edges[i.id];return s?{...i,...s}:i});return{...t,bounds:{x:e.x,y:e.y,width:e.width,height:e.height},nodes:n,edges:r}}function sre(t,e){const n=new Map(t.nodes.map(i=>[i.id,i]));if(t.hash===e.hash||ore(t,e))return JO(t.nodes.filter(i=>!i.parent),n,e),KO(t,e);t.hasLayoutDrift=!0;const r=Uc.merge(...t.nodes.map(i=>e.nodes[i.id]).filter(i=>!!i));return t.nodes.
filter(i=>i.parent==null).reduce((i,s)=>ZO(s,i,n,e),{x:r.x,y:r.y+r.height+GO}),t.edges.filter(i=>!e.edges[i.id]).forEach(i=>are(i,e)),KO(t,e)}function ZO(t,e,n,r){let i=r.nodes[t.id];const s=i?.isCompound??!1,a=!i,o=a?e:{x:i.x,y:i.y},l=t.children.map(d=>r.nodes[d]).filter(d=>!!d),c=l.length>0&&Uc.merge(...l),u=s&&c?{x:c.x,y:c.y+c.height+GO}:{x:o.x+Ta.left,y:o.y+Ta.top};return t.children.map(d=>n.get(d)).reduce((d,f)=>ZO(f,d,n,r),u),i=t.children.length>0?YO(t,r):r.nodes[t.id]??{isCompound:!1,width:t.
width,height:t.height,x:o.x,y:o.y},r.nodes[t.id]=i,a?{x:i.x+i.width+ire,y:i.y}:e}function are(t,e){const n=e.nodes[t.source],r=e.nodes[t.target],i=XO(Uc.center(n)),s=XO(Uc.center(r)),a=s.subtract(i),{x:o,y:l}=a.divide(2).add(i),c={...t?.labelBBox??{width:0,height:0},x:o,y:l},u=a.multiply(.7).add(i),d=a.multiply(.3).add(i);e.edges[t.id]={points:[[i.x,i.y],[d.x,d.y],[u.x,u.y],[s.x,s.y]],labelBBox:c,controlPoints:[u]}}function JO(t,e,n){t.filter(r=>r.children.length>0).forEach(r=>{JO(r.children.map(
i=>e.get(i)).filter(i=>!!i),e,n),n.nodes[r.id]=YO(r,n)})}function YO(t,e){const n=Uc.merge(...t.children.map(r=>e.nodes[r]));return{isCompound:!0,x:n.x-Ta.left,y:n.y-Ta.top,width:n.width+Ta.left+Ta.right,height:n.height+Ta.top+Ta.bottom}}function ore(t,e){const n=r=>r.children.length>0;return nS(t.autoLayout,e.autoLayout)&&t.nodes.every(r=>{const i=e.nodes[r.id];return!!i&&n(r)===i.isCompound})&&t.edges.every(r=>!!e.edges[r.id])}function XO({x:t,y:e}){return new wF(t,e)}function QO(t){return typeof t==
"object"&&t!==null&&typeof t.id=="string"}function rS(t){return typeof t=="object"&&t!==null&&t.$$type==="Node"&&typeof t.id=="string"}function eL(t){return rS(t)||QO(t)}function Op(t){return typeof t=="string"||eL(t)}function lre(t){return Array.isArray(t)&&t.every(Op)}function cre(t){return["n","ne","e","se","s","sw","w","nw","c"].includes(t)}function tL(t){if(eL(t))return t;const[e,n,r]=t.split(":");return cre(r)?{id:e,port:n,compass:r}:{id:e,port:n}}function ure(t){if(t.length<2&&(Op(t[0])&&
Op(t[1]))===!1)throw Error("EdgeTargets must have at least 2 elements.");return t.map(e=>tL(e))}const By=Object.seal({Graph:null,Digraph:null,Subgraph:null,Node:null,Edge:null});function dre(t){return Object.assign(Object.seal(Object.assign({},By)),t)}function fre(...t){const[e,...n]=t;return(...r)=>n.reduce((i,s)=>s(i),e(...r))}function li(t,...e){return fre(t,...e)}const pre=t=>(...e)=>n=>t(n,...e),hre=t=>({[Symbol.iterator]:t}),Ti=pre((t,e)=>Array.from(hre(function*(){for(const n of t)yield e(
n)})));class nL{options;getLocation(){return this.options?.locationFunction?.()??null}constructor(e){this.options=e}createElement(e,n,r=[]){return{location:this.getLocation(),...n,type:e,children:r}}}const St=nL.prototype.createElement.bind(new nL),mre=/\r?\n/;function Ei(t){return e=>e.join(t)}function gre(t){return e=>t+e+t}function Ea(t,e){return n=>t+n+e}function Wy(t){return e=>t+e}const rL=t=>t.replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/"/g,'\\"'),Gy=t=>t.split(mre),Lp=(t,e,n)=>li(
Gy,Ti(Wy(t==="space"?" ".repeat(e):`
`)),Ei(n)),Ho=t=>{switch(t){case"crlf":return`\r
`;case"lf":return`
`}},yre={match(t){return t.type==="AttributeList"},print(t,e){if(e.children.length===0)return`${e.kind.toLocaleLowerCase()} [];`;const n=Ho(t.endOfLine);return li(Ti(t.print),Ei(n),Lp(t.indentStyle,t.indentSize,n),Ea(`${e.kind.toLocaleLowerCase()} [${n}`,`${n}];`))(e.children)}},vre={match(t){return t.type==="Attribute"},print(t,e){return`${t.print(e.key)} = ${t.print(e.value)};`}},wre={match(t){return t.type==="Comment"},print(t,e){const n=Ho(t.endOfLine);switch(e.kind){case"Block":return li(Gy,
Ti(Wy(" * ")),Ei(n),Ea(`/**${n}`,`${n} */`))(e.value);case"Macro":return li(Gy,Ti(Wy("# ")),Ei(n))(e.value);default:return li(Gy,Ti(Wy("// ")),Ei(n))(e.value)}}},bre={match(t){return t.type==="Dot"},print(t,e){return e.children.map(t.print).join(Ho(t.endOfLine))}},kre={match(t){return t.type==="Edge"},print(t,e){const n=li(Ti(t.print),Ei(t.directed?" -> ":" -- "))(e.targets);if(e.children.length===0)return`${n};`;const r=Ho(t.endOfLine),i=li(Ti(t.print),Ei(r),Lp(t.indentStyle,t.indentSize,r),Ea(
`[${r}`,`${r}];`))(e.children);return`${n} ${i}`}},_re={match(t){return t.type==="Graph"},print(t,e){t.directed=e.directed;const n=[];if(e.strict&&n.push("strict"),n.push(e.directed?"digraph":"graph"),e.id&&n.push(t.print(e.id)),e.children.length===0)return`${n.join(" ")} {}`;const r=Ho(t.endOfLine),i=li(Ti(t.print),Ei(r),Lp(t.indentStyle,t.indentSize,r),Ea(`{${r}`,`${r}}`))(e.children);return`${n.join(" ")} ${i}`}},Rre=li(rL,gre('"')),Sre=Ea("<",">"),$re={match(t){return t.type==="Literal"},print(t,e){
switch(e.quoted){case"html":return Sre(e.value);case!0:return Rre(e.value);default:return rL(e.value)}}},Tre={match(t){return t.type==="Node"},print(t,e){const n=t.print(e.id);if(e.children.length===0)return`${n};`;const r=Ho(t.endOfLine),i=li(Ti(t.print),Ei(r),Lp(t.indentStyle,t.indentSize,r),Ea(`[${r}`,`${r}];`))(e.children);return`${n} ${i}`}},Ere={match(t){return t.type==="NodeRefGroup"},print(t,e){return li(Ti(t.print),Ei(" "),Ea("{","}"))(e.children)}},Pre={match(t){return t.type==="NodeRe\
f"},print(t,e){const n=[t.print(e.id)];return e.port&&n.push(t.print(e.port)),e.compass&&n.push(t.print(e.compass)),n.join(":")}},Cre={match(t){return t.type==="Subgraph"},print(t,e){const n=["subgraph"];if(e.id&&n.push(t.print(e.id)),e.children.length===0)return`${n.join(" ")} {}`;const r=Ho(t.endOfLine),i=li(Ti(t.print),Ei(r),Lp(t.indentStyle,t.indentSize,r),Ea(`{${r}`,`${r}}`))(e.children);return`${n.join(" ")} ${i}`}},xre=[yre,vre,wre,bre,kre,_re,$re,Tre,Ere,Pre,Cre];class Are{options;#e=[...xre];constructor(e={}){
this.options=e}print(e){const n=[...this.#e],{indentSize:r=2,indentStyle:i="space",endOfLine:s="lf"}=this.options,a={directed:!0,indentSize:r,indentStyle:i,endOfLine:s,print(o){for(const l of n)if(l.match(o))return l.print(a,o);throw Error()}};return a.print(e)}}function Ire(t,e){const n=new Are(e).print(t);if(!n)throw new Error;return n}function Ky(t,e){if(typeof e=="string"){const n=e.trim();return/^<.+>$/ms.test(n)?St("Attribute",{key:St("Literal",{value:t,quoted:!1},[]),value:St("Literal",{value:n.
slice(1,n.length-1),quoted:"html"},[])},[]):St("Attribute",{key:St("Literal",{value:t,quoted:!1},[]),value:St("Literal",{value:e,quoted:!0},[])},[])}return St("Attribute",{key:St("Literal",{value:t,quoted:!1},[]),value:St("Literal",{value:String(e),quoted:!1},[])},[])}function Vo(t,e){return St("Comment",{kind:e,value:t},[])}function iL(t,e){return Array.from((function*(){for(const[n,r]of e.values)yield Ky(n,r);for(const n of Object.values(e.attributes))n.size>0&&(n.comment&&(yield Vo(n.comment,
t.commentKind)),yield t.convert(n));for(const n of e.nodes)n.comment&&(yield Vo(n.comment,t.commentKind)),yield t.convert(n);for(const n of e.subgraphs)n.comment&&(yield Vo(n.comment,t.commentKind)),yield t.convert(n);for(const n of e.edges)n.comment&&(yield Vo(n.comment,t.commentKind)),yield t.convert(n)})())}const Nre={match(t){return t.$$type==="AttributeList"},convert(t,e){return St("AttributeList",{kind:e.$$kind},e.values.map(([n,r])=>Ky(n,r)))}},Dre={match(t){return t.$$type==="Edge"},convert(t,e){
return St("Edge",{targets:e.targets.map(n=>rS(n)?St("NodeRef",{id:St("Literal",{value:n.id,quoted:!0},[])},[]):QO(n)?St("NodeRef",{id:St("Literal",{value:n.id,quoted:!0},[]),port:n.port?St("Literal",{value:n.port,quoted:!0},[]):void 0,compass:n.compass?St("Literal",{value:n.compass,quoted:!0},[]):void 0},[]):St("NodeRefGroup",{},n.map(r=>rS(r)?St("NodeRef",{id:St("Literal",{value:r.id,quoted:!0},[])},[]):St("NodeRef",{id:St("Literal",{value:r.id,quoted:!0},[]),port:r.port?St("Literal",{value:r.port,
quoted:!0},[]):void 0,compass:r.compass?St("Literal",{value:r.compass,quoted:!0},[]):void 0},[]))))},[...e.attributes.comment?[Vo(e.attributes.comment,t.commentKind)]:[],...e.attributes.values.map(([n,r])=>Ky(n,r))])}},Ore={match(t){return t.$$type==="Graph"},convert(t,e){return St("Dot",{},[...e.comment?[Vo(e.comment,t.commentKind)]:[],St("Graph",{directed:e.directed,strict:e.strict,id:e.id?St("Literal",{value:e.id,quoted:!0},[]):void 0},iL(t,e))])}},Lre={match(t){return t.$$type==="Node"},convert(t,e){
return St("Node",{id:St("Literal",{value:e.id,quoted:!0},[])},[...e.attributes.comment?[Vo(e.attributes.comment,t.commentKind)]:[],...e.attributes.values.map(([n,r])=>Ky(n,r))])}},Mre={match(t){return t.$$type==="Subgraph"},convert(t,e){return St("Subgraph",{id:e.id?St("Literal",{value:e.id,quoted:!0},[]):void 0},iL(t,e))}},jre=[Nre,Dre,Lre,Ore,Mre];class qre{options;#e=[...jre];constructor(e={}){this.options=e}convert(e){const n=[...this.#e],{commentKind:r="Slash"}=this.options,i={commentKind:r,
convert(s){for(const a of n)if(a.match(s))return a.convert(i,s);throw Error()}};return i.convert(e)}}function Fre(t,e){return new qre(e).convert(t)}const Z=new Proxy(Object.freeze({}),{get:(t,e)=>e});class iS{}class sS extends iS{#e=new Map;constructor(e){super(),e!==void 0&&this.apply(e)}get values(){return Array.from(this.#e.entries())}get size(){return this.#e.size}get(e){return this.#e.get(e)}set(e,n){n!=null&&this.#e.set(e,n)}delete(e){this.#e.delete(e)}apply(e){const n=Array.isArray(e)?e:Object.
entries(e);for(const[r,i]of n)this.set(r,i)}clear(){this.#e.clear()}}class aS extends sS{$$kind;get $$type(){return"AttributeList"}comment;constructor(e,n){super(n),this.$$kind=e}}class sL extends sS{#e=By;id;comment;attributes=Object.freeze({graph:new aS("Graph"),edge:new aS("Edge"),node:new aS("Node")});get nodes(){return Array.from(this.#t.nodes.values())}get edges(){return Array.from(this.#t.edges.values())}get subgraphs(){return Array.from(this.#t.subgraphs.values())}#t={nodes:new Map,edges:new Set,
subgraphs:new Set};with(e){this.#e=dre(e)}addNode(e){this.#t.nodes.set(e.id,e)}addEdge(e){this.#t.edges.add(e)}addSubgraph(e){this.#t.subgraphs.add(e)}existNode(e){return this.#t.nodes.has(e)}existEdge(e){return this.#t.edges.has(e)}existSubgraph(e){return this.#t.subgraphs.has(e)}createSubgraph(...e){const n=new this.#e.Subgraph(...e);return n.with(this.#e),this.addSubgraph(n),n}removeNode(e){this.#t.nodes.delete(typeof e=="string"?e:e.id)}removeEdge(e){this.#t.edges.delete(e)}removeSubgraph(e){
this.#t.subgraphs.delete(e)}createNode(e,n){const r=new this.#e.Node(e,n);return this.addNode(r),r}getSubgraph(e){return Array.from(this.#t.subgraphs.values()).find(n=>n.id===e)}getNode(e){return this.#t.nodes.get(e)}createEdge(e,n){const r=e.map(s=>lre(s)?ure(s):tL(s)),i=new this.#e.Edge(r,n);return this.addEdge(i),i}subgraph(...e){const n=e.find(a=>typeof a=="string"),r=e.find(a=>typeof a=="object"&&a!==null),i=e.find(a=>typeof a=="function"),s=n?this.getSubgraph(n)??this.createSubgraph(n):this.
createSubgraph();return r!==void 0&&s.apply(r),i!==void 0&&i(s),s}node(e,...n){if(typeof e=="string"){const r=e,i=n.find(o=>typeof o=="object"&&o!==null),s=n.find(o=>typeof o=="function"),a=this.getNode(r)??this.createNode(r);return i!==void 0&&a.attributes.apply(i),s!==void 0&&s(a),a}typeof e=="object"&&e!==null&&this.attributes.node.apply(e)}edge(e,...n){if(Array.isArray(e)){const r=e,i=n.find(o=>typeof o=="object"),s=n.find(o=>typeof o=="function"),a=this.createEdge(r,i);return s!==void 0&&s(
a),a}typeof e=="object"&&e!==null&&this.attributes.edge.apply(e)}graph(e){this.attributes.graph.apply(e)}}class aL extends sL{get $$type(){return"Graph"}id;strict;constructor(...e){super(),this.id=e.find(r=>typeof r=="string"),this.strict=e.find(r=>typeof r=="boolean")??!1;const n=e.find(r=>typeof r=="object"&&r!==null);n!==void 0&&this.apply(n)}}class zre extends aL{get directed(){return!0}}class Ure extends aL{get directed(){return!1}}class Hre extends sL{get $$type(){return"Subgraph"}id;constructor(...e){
super(),this.id=e.find(r=>typeof r=="string");const n=e.find(r=>typeof r=="object"&&r!==null);n!==void 0&&this.apply(n)}isSubgraphCluster(){return typeof this.id=="string"?this.id.startsWith("cluster"):!1}}class oL extends sS{comment}let Vre=class extends iS{id;get $$type(){return"Node"}comment;attributes;constructor(e,n){super(),this.id=e,this.attributes=new oL(n)}port(e){return typeof e=="string"?{id:this.id,port:e}:{id:this.id,...e}}};class Bre extends iS{targets;get $$type(){return"Edge"}comment;attributes;constructor(e,n){
if(super(),this.targets=e,e.length<2&&(Op(e[0])&&Op(e[1]))===!1)throw Error("The element of Edge target is missing or not satisfied as Edge target.");this.attributes=new oL(n)}}Object.assign(By,{Graph:Ure,Digraph:zre,Subgraph:Hre,Node:Vre,Edge:Bre});function lL(t,e){return(...n)=>{const r=t?this.Digraph:this.Graph,i=n.find(l=>typeof l=="string"),s=n.find(l=>typeof l=="object"),a=n.find(l=>typeof l=="function"),o=new r(i,e,s);return o.with(this),typeof a=="function"&&a(o),o}}function cL(t,e=By){return Object.
freeze({digraph:lL.call(e,!0,t),graph:lL.call(e,!1,t)})}const uL=cL(!1),Wre=uL.digraph;uL.graph,cL(!0);function Gre(t,e){const n=Fre(t,e?.convert);return Ire(n,e?.print)}var oS,dL;function Kre(){if(dL)return oS;dL=1;function t(r){let i=r.length-1,s=r[i];for(;s===" "||s==="	";)s=r[--i];return r.substring(0,i+1)}function e(r){return r.split(`
`).map(a=>t(a)).join(`
`)}oS=function(r,i){if(i=i||{},r==null)return r;var s=i.width||50,a=typeof i.indent=="string"?i.indent:"  ",o=i.newline||`
`+a,l=typeof i.escape=="function"?i.escape:n,c=".{1,"+s+"}";i.cut!==!0&&(c+="([\\s\u200B]+|$)|[^\\s\u200B]+?([\\s\u200B]+|$)");var u=new RegExp(c,"g"),d=r.match(u)||[],f=a+d.map(function(p){return p.slice(-1)===`
`&&(p=p.slice(0,p.length-1)),l(p)}).join(o);return i.trim===!0&&(f=e(f)),f};function n(r){return r}return oS}var Zre=Kre();const Jre=oo(Zre),Zy={min:{r:0,g:0,b:0,s:0,l:0,a:0},max:{r:255,g:255,b:255,h:360,s:100,l:100,a:1},clamp:{r:t=>t>=255?255:t<0?0:t,g:t=>t>=255?255:t<0?0:t,b:t=>t>=255?255:t<0?0:t,h:t=>t%360,s:t=>t>=100?100:t<0?0:t,l:t=>t>=100?100:t<0?0:t,a:t=>t>=1?1:t<0?0:t},toLinear:t=>{const e=t/255;return t>.03928?Math.pow((e+.055)/1.055,2.4):e/12.92},hue2rgb:(t,e,n)=>(n<0&&(n+=1),n>1&&(n-=
1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t),hsl2rgb:({h:t,s:e,l:n},r)=>{if(!e)return n*2.55;t/=360,e/=100,n/=100;const i=n<.5?n*(1+e):n+e-n*e,s=2*n-i;switch(r){case"r":return Zy.hue2rgb(s,i,t+1/3)*255;case"g":return Zy.hue2rgb(s,i,t)*255;case"b":return Zy.hue2rgb(s,i,t-1/3)*255}},rgb2hsl:({r:t,g:e,b:n},r)=>{t/=255,e/=255,n/=255;const i=Math.max(t,e,n),s=Math.min(t,e,n),a=(i+s)/2;if(r==="l")return a*100;if(i===s)return 0;const o=i-s,l=a>.5?o/(2-i-s):o/(i+s);if(r==="s")return l*100;switch(i){case t:
return((e-n)/o+(e<n?6:0))*60;case e:return((n-t)/o+2)*60;case n:return((t-e)/o+4)*60;default:return-1}}},Yre={clamp:(t,e,n)=>e>n?Math.min(e,Math.max(n,t)):Math.min(n,Math.max(e,t)),round:t=>Math.round(t*1e10)/1e10},Xre={dec2hex:t=>{const e=Math.round(t).toString(16);return e.length>1?e:`0${e}`}},Qe={channel:Zy,lang:Yre,unit:Xre},Pa={};for(let t=0;t<=255;t++)Pa[t]=Qe.unit.dec2hex(t);const Xn={ALL:0,RGB:1,HSL:2};class Qre{constructor(){this.type=Xn.ALL}get(){return this.type}set(e){if(this.type&&this.
type!==e)throw new Error("Cannot change both RGB and HSL channels at the same time");this.type=e}reset(){this.type=Xn.ALL}is(e){return this.type===e}}class eie{constructor(e,n){this.color=n,this.changed=!1,this.data=e,this.type=new Qre}set(e,n){return this.color=n,this.changed=!1,this.data=e,this.type.type=Xn.ALL,this}_ensureHSL(){const e=this.data,{h:n,s:r,l:i}=e;n===void 0&&(e.h=Qe.channel.rgb2hsl(e,"h")),r===void 0&&(e.s=Qe.channel.rgb2hsl(e,"s")),i===void 0&&(e.l=Qe.channel.rgb2hsl(e,"l"))}_ensureRGB(){
const e=this.data,{r:n,g:r,b:i}=e;n===void 0&&(e.r=Qe.channel.hsl2rgb(e,"r")),r===void 0&&(e.g=Qe.channel.hsl2rgb(e,"g")),i===void 0&&(e.b=Qe.channel.hsl2rgb(e,"b"))}get r(){const e=this.data,n=e.r;return!this.type.is(Xn.HSL)&&n!==void 0?n:(this._ensureHSL(),Qe.channel.hsl2rgb(e,"r"))}get g(){const e=this.data,n=e.g;return!this.type.is(Xn.HSL)&&n!==void 0?n:(this._ensureHSL(),Qe.channel.hsl2rgb(e,"g"))}get b(){const e=this.data,n=e.b;return!this.type.is(Xn.HSL)&&n!==void 0?n:(this._ensureHSL(),Qe.
channel.hsl2rgb(e,"b"))}get h(){const e=this.data,n=e.h;return!this.type.is(Xn.RGB)&&n!==void 0?n:(this._ensureRGB(),Qe.channel.rgb2hsl(e,"h"))}get s(){const e=this.data,n=e.s;return!this.type.is(Xn.RGB)&&n!==void 0?n:(this._ensureRGB(),Qe.channel.rgb2hsl(e,"s"))}get l(){const e=this.data,n=e.l;return!this.type.is(Xn.RGB)&&n!==void 0?n:(this._ensureRGB(),Qe.channel.rgb2hsl(e,"l"))}get a(){return this.data.a}set r(e){this.type.set(Xn.RGB),this.changed=!0,this.data.r=e}set g(e){this.type.set(Xn.RGB),
this.changed=!0,this.data.g=e}set b(e){this.type.set(Xn.RGB),this.changed=!0,this.data.b=e}set h(e){this.type.set(Xn.HSL),this.changed=!0,this.data.h=e}set s(e){this.type.set(Xn.HSL),this.changed=!0,this.data.s=e}set l(e){this.type.set(Xn.HSL),this.changed=!0,this.data.l=e}set a(e){this.changed=!0,this.data.a=e}}const lS=new eie({r:0,g:0,b:0,a:0},"transparent"),$c={re:/^#((?:[a-f0-9]{2}){2,4}|[a-f0-9]{3})$/i,parse:t=>{if(t.charCodeAt(0)!==35)return;const e=t.match($c.re);if(!e)return;const n=e[1],
r=parseInt(n,16),i=n.length,s=i%4===0,a=i>4,o=a?1:17,l=a?8:4,c=s?0:-1,u=a?255:15;return lS.set({r:(r>>l*(c+3)&u)*o,g:(r>>l*(c+2)&u)*o,b:(r>>l*(c+1)&u)*o,a:s?(r&u)*o/255:1},t)},stringify:t=>{const{r:e,g:n,b:r,a:i}=t;return i<1?`#${Pa[Math.round(e)]}${Pa[Math.round(n)]}${Pa[Math.round(r)]}${Pa[Math.round(i*255)]}`:`#${Pa[Math.round(e)]}${Pa[Math.round(n)]}${Pa[Math.round(r)]}`}},Bo={re:/^hsla?\(\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e-?\d+)?(?:deg|grad|rad|turn)?)\s*?(?:,|\s)\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e-?\d+)?%)\s*?(?:,|\s)\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e-?\d+)?%)(?:\s*?(?:,|\/)\s*?\+?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e-?\d+)?(%)?))?\s*?\)$/i,
hueRe:/^(.+?)(deg|grad|rad|turn)$/i,_hue2deg:t=>{const e=t.match(Bo.hueRe);if(e){const[,n,r]=e;switch(r){case"grad":return Qe.channel.clamp.h(parseFloat(n)*.9);case"rad":return Qe.channel.clamp.h(parseFloat(n)*180/Math.PI);case"turn":return Qe.channel.clamp.h(parseFloat(n)*360)}}return Qe.channel.clamp.h(parseFloat(t))},parse:t=>{const e=t.charCodeAt(0);if(e!==104&&e!==72)return;const n=t.match(Bo.re);if(!n)return;const[,r,i,s,a,o]=n;return lS.set({h:Bo._hue2deg(r),s:Qe.channel.clamp.s(parseFloat(
i)),l:Qe.channel.clamp.l(parseFloat(s)),a:a?Qe.channel.clamp.a(o?parseFloat(a)/100:parseFloat(a)):1},t)},stringify:t=>{const{h:e,s:n,l:r,a:i}=t;return i<1?`hsla(${Qe.lang.round(e)}, ${Qe.lang.round(n)}%, ${Qe.lang.round(r)}%, ${i})`:`hsl(${Qe.lang.round(e)}, ${Qe.lang.round(n)}%, ${Qe.lang.round(r)}%)`}},Mp={colors:{aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",
blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyanaqua:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8f\
bc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c\
5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"\
#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"\
#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"\
#708090",snow:"#fffafa",springgreen:"#00ff7f",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",transparent:"#00000000",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},parse:t=>{t=t.toLowerCase();const e=Mp.colors[t];if(e)return $c.parse(e)},stringify:t=>{const e=$c.stringify(t);for(const n in Mp.colors)if(Mp.colors[n]===e)return n}},jp={re:/^rgba?\(\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e\d+)?(%?))\s*?(?:,|\s)\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e\d+)?(%?))\s*?(?:,|\s)\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e\d+)?(%?))(?:\s*?(?:,|\/)\s*?\+?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e\d+)?(%?)))?\s*?\)$/i,
parse:t=>{const e=t.charCodeAt(0);if(e!==114&&e!==82)return;const n=t.match(jp.re);if(!n)return;const[,r,i,s,a,o,l,c,u]=n;return lS.set({r:Qe.channel.clamp.r(i?parseFloat(r)*2.55:parseFloat(r)),g:Qe.channel.clamp.g(a?parseFloat(s)*2.55:parseFloat(s)),b:Qe.channel.clamp.b(l?parseFloat(o)*2.55:parseFloat(o)),a:c?Qe.channel.clamp.a(u?parseFloat(c)/100:parseFloat(c)):1},t)},stringify:t=>{const{r:e,g:n,b:r,a:i}=t;return i<1?`rgba(${Qe.lang.round(e)}, ${Qe.lang.round(n)}, ${Qe.lang.round(r)}, ${Qe.lang.
round(i)})`:`rgb(${Qe.lang.round(e)}, ${Qe.lang.round(n)}, ${Qe.lang.round(r)})`}},Ca={format:{keyword:Mp,hex:$c,rgb:jp,rgba:jp,hsl:Bo,hsla:Bo},parse:t=>{if(typeof t!="string")return t;const e=$c.parse(t)||jp.parse(t)||Bo.parse(t)||Mp.parse(t);if(e)return e;throw new Error(`Unsupported color format: "${t}"`)},stringify:t=>!t.changed&&t.color?t.color:t.type.is(Xn.HSL)||t.data.r===void 0?Bo.stringify(t):t.a<1||!Number.isInteger(t.r)||!Number.isInteger(t.g)||!Number.isInteger(t.b)?jp.stringify(t):$c.
stringify(t)},tie=(t,e)=>{const n=Ca.parse(t);for(const r in e)n[r]=Qe.channel.clamp[r](e[r]);return Ca.stringify(n)},fL=t=>Ca.format.hex.stringify(Ca.parse(t)),nie=(t,e,n)=>{const r=Ca.parse(t),i=r[e],s=Qe.channel.clamp[e](i+n);return i!==s&&(r[e]=s),Ca.stringify(r)},rie=(t,e)=>nie(t,"a",-.3),iie=(t,e)=>{const n=Ca.parse(t),r={};for(const i in e)e[i]&&(r[i]=n[i]+e[i]);return tie(t,r)},sie=(t,e)=>{const n=Ca.parse(t),r={},i=(s,a,o)=>a>0?(o-s)*a/100:s*a/100;for(const s in e)r[s]=i(n[s],e[s],Qe.channel.
max[s]);return iie(t,r)};function Br(t){return t.children.length>0}function Qn(t){return t==="open"?"vee":t}function es(t){return Array.isArray(t)?[es(t[0]),es(t[1])]:(An(isFinite(t),`Invalid not finite point value ${t}`),Math.round(t))}const pL=t=>(An(isFinite(t),`Invalid not finite inch value ${t}`),Math.floor(t*72)),Zt=t=>Math.ceil(t/72*1e3)/1e3,zs=t=>Math.ceil(t);zs(40).toString();function hL(t,e){return fL(sie(t,{l:-35-5*e,s:-15-5*e}))}function aie(t){return fL(rie(t))}function oie(t){return t.
trim().replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;")}function mL(t,{maxchars:e,maxLines:n,sanitize:r=O3()}){let i=Jre(t,{width:e,indent:"",escape:r}).split(`
`);return Un(n)&&n>0&&i.length>n&&(i=i.slice(0,n)),i}function Wo({text:t,maxchars:e,fontsize:n,maxLines:r,bold:i,color:s}){let a=mL(t,{maxchars:e,maxLines:r,sanitize:oie}).join("<BR/>");i&&(a=`<B>${a}</B>`);const o=s?` COLOR="${s}"`:"";return`<FONT POINT-SIZE="${zs(n)}"${o}>${a}</FONT>`}function lie(t){switch(t){case"xs":case"sm":return 30;case"md":return 40;case"lg":case"xl":return 55;default:ta(t)}}function cie(t,e){const{sizes:{size:n},values:r}=e.nodeSizes(t.style),i=e.colors(t.color).elements,
s=["sm","xs"].includes(n),a=ke(t.icon),o=[Wo({text:t.title,fontsize:r.textSize,maxchars:lie(n),maxLines:s?1:3})];if(n!=="xs"){ke(t.technology?.trim())&&o.push(Wo({text:t.technology,fontsize:Math.ceil(r.textSize*.65),maxchars:a?35:45,maxLines:1,color:i.loContrast}));const c=Nq.from(t.description).text;c&&o.push(Wo({text:c,fontsize:Math.ceil(r.textSize*.75),maxchars:a?35:45,maxLines:s?3:5,color:i.loContrast}))}if(o.length===1&&a===!1)return`<${o[0]}>`;const l=a?(c,u,d)=>{let f=`<TD ALIGN="TEXT" BA\
LIGN="LEFT">${c}</TD>`;if(u===0){const p=d.length>1?` ROWSPAN="${d.length}"`:"";let m=76;["xs","sm"].includes(n)&&(m=16),(t.shape==="queue"||t.shape==="mobile")&&(m+=20),f=`<TD${p} WIDTH="${m}"> </TD>${f}`,f=`${f}<TD${p} WIDTH="16"> </TD>`}return`<TR>${f}</TR>`}:c=>`<TR><TD>${c}</TD></TR>`;return`<<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="4">${o.map(l).join("")}</TABLE>>`}function uie(t,e){const n=Wo({text:t.title.toUpperCase(),maxchars:50,fontsize:11,maxLines:1,bold:!0,color:e});return n.includes(
"<BR/>")?`<<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0"><TR><TD ALIGN="TEXT" BALIGN="LEFT">${n}</TD></TR></TABLE>>`:`<${n}>`}const Jy=40,gL=5,cS=`BGCOLOR="${Iq.DEFAULT.relationshipColors.labelBg}A0"`;function uS({label:t,technology:e}){const n=[];if(ke(t?.trim())&&n.push(Wo({text:t,maxchars:Jy,fontsize:14,maxLines:gL,bold:t==="[...]"})),ke(e?.trim())&&n.push(Wo({text:`[ ${e} ]`,fontsize:12,maxLines:1,maxchars:Jy})),n.length===0)return null;const r=n.map(i=>`<TR><TD ALIGN="TEXT" BALIGN="LEFT\
">${i}</TD></TR>`).join("");return`<<TABLE BORDER="0" CELLPADDING="3" CELLSPACING="0" ${cS}>${r}</TABLE>>`}function die(t,e){const n=`<TABLE BORDER="0" CELLPADDING="6" ${cS}><TR><TD WIDTH="20" HEIGHT="20"><FONT POINT-SIZE="${zs(14)}"><B>${t}</B></FONT></TD></TR></TABLE>`;return ke(e?.trim())?`<${['<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3">',"<TR>",`<TD>${n}</TD>`,`<TD ${cS} CELLPADDING="3">`,Wo({text:e,maxchars:Jy,fontsize:14,maxLines:5}),"</TD>","</TR>","</TABLE>"].join("")}>`:`<${n}>`}
const Yy="dashed",dS="Arial",fie=cA("dot"),fS=50.1;class Xy{constructor(e,n){this.view=e,this.styles=n,this.compoundIds=new Set(e.nodes.filter(Br).map(i=>i.id)),this.edgesWithCompounds=new Set(this.compoundIds.size>0?e.edges.filter(i=>this.compoundIds.has(i.source)||this.compoundIds.has(i.target)).map(i=>i.id):[]);for(const i of e.nodes)this.graphology.addNode(i.id,{origin:i,level:i.level,depth:i.depth??0,modelRef:i.modelRef??null,deploymentRef:i.deploymentRef??null,maxConnectedHierarchyDistance:0});
for(const i of e.edges){let s=this.graphology.getNodeAttribute(i.source,"deploymentRef"),a=this.graphology.getNodeAttribute(i.target,"deploymentRef");(s===null||a===null)&&(s=this.graphology.getNodeAttribute(i.source,"modelRef"),a=this.graphology.getNodeAttribute(i.target,"modelRef"));let o=-1;s!==null&&a!==null&&(o=nF(s,a)),this.graphology.addEdgeWithKey(i.id,i.source,i.target,{origin:i,hierarchyDistance:o,weight:1}),o>this.graphology.getNodeAttribute(i.source,"maxConnectedHierarchyDistance")&&
this.graphology.mergeNodeAttributes(i.source,{maxConnectedHierarchyDistance:o}),o>this.graphology.getNodeAttribute(i.target,"maxConnectedHierarchyDistance")&&this.graphology.mergeNodeAttributes(i.target,{maxConnectedHierarchyDistance:o})}this.graphology.forEachEdge((i,{hierarchyDistance:s},a,o,l,c)=>{const u=Math.max(l.maxConnectedHierarchyDistance,c.maxConnectedHierarchyDistance);if(u>s)this.graphology.mergeEdgeAttributes(i,{weight:u-s+1});else{const d=this.graphology.directedDegree(a),f=this.graphology.
directedDegree(o);d===1&&f===1&&s>1&&this.graphology.mergeEdgeAttributes(i,{weight:s})}});const r=this.graphvizModel=this.createGraph();this.applyNodeAttributes(r.attributes.node),this.applyEdgeAttributes(r.attributes.edge),this.build(r),this.postBuild(r)}ids=new Set;subgraphs=new Map;nodes=new Map;edges=new Map;compoundIds;edgesWithCompounds;graphology=new bF({allowSelfLoops:!0,multi:!0,type:"directed"});graphvizModel;get $defaults(){return this.styles.defaults}get hasEdgesWithCompounds(){return this.
edgesWithCompounds.size>0}get defaultRelationshipColors(){const e=this.styles.relationshipColors;return{line:e.line,label:e.label,labelBg:e.labelBg}}postBuild(e){}build(e){const n=(i,s)=>{const a=this.generateGraphvizId(i),o=this.elementToSubgraph(i,s.subgraph(a));this.subgraphs.set(i.id,o);for(const l of i.children){const c=this.computedNode(l);if(Br(c))n(c,o);else{const u=mr(this.getGraphNode(c.id),`Graphviz Node not found for ${c.id}`);o.node(u.id)}}},r=[];for(const i of this.view.nodes)if(Br(
i))Gt(i.parent)&&r.push(i);else{const s=this.generateGraphvizId(i),a=this.elementToNode(i,e.node(s));this.nodes.set(i.id,a)}for(const i of r)n(i,e);for(const i of this.view.edges){const s=this.addEdge(i,e);s&&this.edges.set(i.id,s)}}print(){return Gre(this.graphvizModel,{print:{indentStyle:"space",indentSize:2}})}createGraph(){const e=this.view.autoLayout,n=Wre({[Z.likec4_viewId]:this.view.id,[Z.bgcolor]:"transparent",[Z.layout]:"dot",[Z.compound]:!0,[Z.rankdir]:e.direction,[Z.TBbalance]:"min",[Z.
splines]:"spline",[Z.outputorder]:"nodesfirst",[Z.nodesep]:Zt(e.nodeSep??110),[Z.ranksep]:Zt(e.rankSep??120),[Z.pad]:Zt(15),[Z.fontname]:dS});return n.attributes.graph.apply({[Z.fontsize]:zs(this.styles.fontSize()),[Z.labeljust]:e.direction==="RL"?"r":"l",[Z.labelloc]:e.direction==="BT"?"b":"t",[Z.margin]:fS}),n}applyNodeAttributes(e){const n=this.styles.elementColors;e.apply({[Z.fontname]:dS,[Z.shape]:"rect",[Z.fillcolor]:n.fill,[Z.fontcolor]:n.hiContrast,[Z.color]:n.stroke,[Z.style]:"filled",[Z.
penwidth]:0})}applyEdgeAttributes(e){const n=this.defaultRelationshipColors;e.apply({[Z.arrowsize]:.75,[Z.fontname]:dS,[Z.fontsize]:zs(14),[Z.penwidth]:zs(2),[Z.color]:n.line,[Z.fontcolor]:n.label})}checkNodeId(e,n=!1){return n?e="cluster_"+e:e.toLowerCase().startsWith("cluster")&&(e="nd_"+e),this.ids.has(e)?null:(this.ids.add(e),e)}generateGraphvizId(e){const n=Br(e);let r=kh(e.id).toLowerCase(),i=this.checkNodeId(r,n);if(i!==null)return i;r=kh(e.id).toLowerCase();let s=1;do i=this.checkNodeId(
r+"_"+s++,n);while(i===null);return i}elementToSubgraph(e,n){An(Br(e),"node should be compound"),An(Zi(e.depth),"node.depth should be defined");const r=this.styles.colors(e.color).elements,i=aie(r.loContrast);return n.apply({[Z.likec4_id]:e.id,[Z.likec4_level]:e.level,[Z.likec4_depth]:e.depth,[Z.fillcolor]:hL(r.fill,e.depth),[Z.color]:hL(r.stroke,e.depth),[Z.style]:"filled",[Z.margin]:zs(e.children.length>1?40:32)}),Nt(e.title.trim())||n.set(Z.label,uie(e,i)),n}elementToNode(e,n){An(!Br(e),"node\
 should not be compound");const r=ke(e.icon),i=this.styles.colors(e.color).elements,{values:{padding:s,sizes:{width:a,height:o}}}=this.styles.nodeSizes(e.style);switch(n.attributes.apply({[Z.likec4_id]:e.id,[Z.likec4_level]:e.level,[Z.label]:cie(e,this.styles),[Z.margin]:`${Zt(r?8:s)},${Zt(s)}`}),n.attributes.set(Z.width,Zt(a)),n.attributes.set(Z.height,Zt(o)),this.styles.isDefaultColor(e.color)||n.attributes.apply({[Z.fillcolor]:i.fill,[Z.fontcolor]:i.hiContrast,[Z.color]:i.stroke}),e.shape){case"\
cylinder":case"storage":{n.attributes.apply({[Z.margin]:`${Zt(r?8:s)},${Zt(0)}`,[Z.penwidth]:zs(2),[Z.shape]:"cylinder"});break}case"browser":{n.attributes.apply({[Z.margin]:`${Zt(r?8:s+4)},${Zt(s+6)}`});break}case"mobile":{n.attributes.apply({[Z.margin]:`${Zt(r?8:s+4)},${Zt(s)}`});break}case"queue":{n.attributes.apply({[Z.width]:Zt(a),[Z.height]:Zt(o-8),[Z.margin]:`${Zt(r?8:s+4)},${Zt(s)}`});break}}return n}leafElements(e){return e===null?this.view.nodes.filter(n=>!Br(n)):this.computedNode(e).children.
flatMap(n=>{const r=this.computedNode(n);return Br(r)?this.leafElements(r.id):r})}descendants(e){return e===null?this.view.nodes.slice():this.computedNode(e).children.flatMap(n=>{const r=this.computedNode(n);return[r,...this.descendants(r.id)]})}computedNode(e){return mr(this.view.nodes.find(n=>n.id===e),`Node ${e} not found`)}getGraphNode(e){return this.nodes.get(e)??null}getSubgraph(e){return this.subgraphs.get(e)??null}edgeEndpoint(e,n){let r=this.computedNode(e),i=this.getGraphNode(e),s;return i?
[r,i,void 0]:(An(Br(r),"endpoint node should be compound"),s=this.getSubgraph(e)?.id,An(s,`subgraph ${e} not found`),r=mr(n(this.leafElements(e)),`leaf element in ${e} not found`),i=mr(this.getGraphNode(r.id),`source graphviz node ${r.id} not found`),[r,i,s])}findInternalEdges(e){if(e===null)return this.view.edges.slice();const n=this.computedNode(e);return at(this.descendants(e),Rs(r=>mx(r.inEdges,r.outEdges)),Ss(),v3(mx(n.inEdges,n.outEdges)),It(r=>this.view.edges.find(i=>i.id===r)),nt(ke))}withoutCompoundEdges(e){
return this.edgesWithCompounds.size===0?e:{...e,inEdges:e.inEdges.filter(n=>!this.edgesWithCompounds.has(n)),outEdges:e.outEdges.filter(n=>!this.edgesWithCompounds.has(n))}}assignGroups(){const e=at(this.view.nodes,nt(Br),It(r=>r.id),Gm(rF),H3(),It(r=>{const i=this.findInternalEdges(r).filter(s=>s.source!==s.target&&!this.compoundIds.has(s.source)&&!this.compoundIds.has(s.target));return{id:r,edges:i}}),nt(({edges:r})=>r.length>1&&r.length<8),W3(4)),n=new Set;for(const r of e){const i=r.edges.filter(
s=>!n.has(s.source)&&!n.has(s.target));for(const s of i)try{const a=mr(this.getGraphNode(s.source),`Graphviz Node not found for ${s.source}`),o=mr(this.getGraphNode(s.target),`Graphviz Node not found for ${s.target}`);n.add(s.source),n.add(s.target),a.attributes.set(Z.group,r.id),o.attributes.set(Z.group,r.id)}catch(a){fie.error(`Failed to assign group to edge ${s.id}`,{error:a})}}}applyManualLayout({height:e,...n}){const r=n.x<0?-n.x:0;n.y<0&&-n.y;for(const{id:i,...s}of n.nodes){const a=this.getGraphNode(
i);if(!a)continue;const o=Zt(s.center.x)+r,l=Zt(e-s.center.y);s.fixedsize?a.attributes.apply({[Z.pos]:`${o},${l}!`,[Z.pin]:!0,[Z.width]:Zt(s.fixedsize.width),[Z.height]:Zt(s.fixedsize.height),[Z.fixedsize]:!0}):a.attributes.set(Z.pos,`${o},${l}`)}for(const[,i]of this.edges.entries())i.attributes.delete(Z.weight),i.attributes.delete(Z.minlen),i.attributes.delete(Z.constraint);return this.graphvizModel.apply({[Z.layout]:"fdp",[Z.overlap]:"vpsc",[Z.sep]:"+50,50",[Z.esep]:"+10,10",[Z.start]:"random2",
[Z.splines]:"compound",[Z.K]:10}),this.graphvizModel.delete(Z.compound),this.graphvizModel.delete(Z.rankdir),this.graphvizModel.delete(Z.nodesep),this.graphvizModel.delete(Z.ranksep),this.graphvizModel.delete(Z.pack),this.graphvizModel.delete(Z.pad),this.graphvizModel.delete(Z.packmode),this.graphvizModel.attributes.graph.delete(Z.margin),this}}class pie extends Xy{createGraph(){const e=super.createGraph(),n=this.view.autoLayout;return e.delete(Z.TBbalance),e.apply({[Z.nodesep]:Zt(n.nodeSep??130),
[Z.ranksep]:Zt(n.rankSep??130)}),e}postBuild(e){at(this.view.nodes,It(n=>({node:n,graphvizNode:this.getGraphNode(n.id)})),zc(({node:n,graphvizNode:r})=>{if(r!=null)return n.modelRef}),Fc(),It(n=>n),wx(n=>{n.length<2||e.subgraph({[Z.rank]:"same"},r=>{for(const{graphvizNode:i}of n)r.node(mr(i).id)})}),Z3(()=>{e.set(Z.newrank,!0),e.set(Z.clusterrank,"global"),e.delete(Z.pack),e.delete(Z.packmode)}))}elementToSubgraph(e,n){const r=super.elementToSubgraph(e,n);return e.children.length>1&&r.set(Z.margin,
zs(50)),r}addEdge(e,n){const[r,i]=[e.source,e.target],[s,a,o]=this.edgeEndpoint(r,g=>pl(g)),[l,c,u]=this.edgeEndpoint(i,ql),d=Ki(u)||Ki(o),f=n.edge([a,c],{[Z.likec4_id]:e.id,[Z.style]:e.line??Yy});u&&f.attributes.set(Z.lhead,u),o&&f.attributes.set(Z.ltail,o);const p=this.graphology.getEdgeAttribute(e.id,"weight");p>1&&!this.graphology.hasDirectedEdge(e.target,e.source)&&f.attributes.set(Z.weight,p);const m=uS(e);if(m&&f.attributes.set(d?Z.xlabel:Z.label,m),e.color&&e.color!==this.$defaults.relationship.
color){const g=this.styles.colors(e.color).relationships;f.attributes.apply({[Z.color]:g.line,[Z.fontcolor]:g.label})}let[w,v]=[e.head??this.$defaults.relationship.arrow,e.tail??"none"];return w==="none"&&v==="none"?(f.attributes.apply({[Z.arrowtail]:"none",[Z.arrowhead]:"none",[Z.dir]:"none"}),f):e.dir==="both"?(f.attributes.apply({[Z.arrowhead]:Qn(w),[Z.arrowtail]:Qn(e.tail??w),[Z.dir]:"both"}),!d&&s.modelRef!==l.modelRef&&f.attributes.set(Z.constraint,!1),f):(w&&f.attributes.set(Z.arrowhead,Qn(
w)),v!=="none"&&f.attributes.set(Z.arrowtail,Qn(v)),f)}}class hie extends Xy{postBuild(e){e.delete(Z.TBbalance),e.set(Z.ordering,"in")}addEdge(e,n){const{nodes:r}=this.view,[i,s]=e.dir==="back"?[e.target,e.source]:[e.source,e.target],[a,o,l]=this.edgeEndpoint(i,y=>pl(y)),[c,u,d]=this.edgeEndpoint(s,ql),f=n.edge([o,u],{[Z.likec4_id]:e.id,[Z.style]:e.line??Yy});if(d&&f.attributes.set(Z.lhead,d),l&&f.attributes.set(Z.ltail,l),e.color&&e.color!==this.$defaults.relationship.color){const y=this.styles.
colors(e.color).relationships;f.attributes.apply({[Z.color]:y.line,[Z.fontcolor]:y.label})}const p=[e.label?.trim(),e.technology?.trim()].filter(ke).join(`
`),m=Dq(e.id),w=die(m,p);f.attributes.set(Z.label,w);const v=r.findIndex(y=>y.id===i);r.findIndex(y=>y.id===s)<v&&e.dir!=="back"&&f.attributes.apply({[Z.minlen]:0});let[g,h]=[e.head??this.$defaults.relationship.arrow,e.tail??"none"];return e.dir==="back"?(f.attributes.apply({[Z.arrowtail]:Qn(g),[Z.dir]:"back"}),h!=="none"&&f.attributes.apply({[Z.arrowhead]:Qn(h),[Z.minlen]:0}),f):g==="none"&&h==="none"||g!=="none"&&h!=="none"?(f.attributes.apply({[Z.arrowhead]:Qn(g),[Z.arrowtail]:Qn(h),[Z.dir]:"\
both"}),f):g==="none"?(f.attributes.delete(Z.arrowhead),f.attributes.apply({[Z.arrowtail]:Qn(h),[Z.minlen]:0,[Z.dir]:"back"}),f):(f.attributes.set(Z.arrowhead,Qn(g)),f)}}const mie=cA("dot.rank");class gie extends Xy{postBuild(e){this.assignGroups();const n=new Set,r=this.view.nodes.reduce((a,o)=>(Br(o)&&(n.add(o.id),a.push(o)),a),[]);let i=!1;for(const a of r){const o=at(a.children,nt(d=>!this.compoundIds.has(d)),It(d=>this.computedNode(d)),nt(d=>d.inEdges.length===0&&d.outEdges.length===0));if(o.
length<=2)continue;let l=2;switch(!0){case o.length>11:l=4;break;case o.length>4:l=3;break}const c=mr(this.getSubgraph(a.id),`Subgraph not found for ${a.id}`);let u=null;h3(o,l).forEach(d=>{const f=d.length>1?c.createSubgraph({[Z.rank]:"same"}):null;d.forEach((p,m)=>{const w=this.getGraphNode(p.id);w&&(f?.node(w.id),m===0&&(u&&c.edge([u,w],{[Z.style]:"invis"}),u=w))}),i=i||!!f})}const s=this.applyExplicitRankBlocks(e);i&&(e.set(Z.newrank,!0),e.set(Z.clusterrank,"global")),s>0&&e.set("likec4_rank\
Blocks",s)}applyExplicitRankBlocks(e){const n=this.view.ranks??[];if(n.length===0)return 0;let r=0;for(const i of n){const s=[...new Set(i.nodes)].map(o=>this.getGraphNode(o)).filter(o=>!!o);if(s.length===0)continue;const a=e.createSubgraph({[Z.rank]:i.type});s.forEach(o=>a.node(o.id)),r+=1,mie.debug`rank ${i.type} => ${s.map(o=>o.id).join(", ")}`}return r}addEdge(e,n){const[r,i]=e.dir==="back"?[e.target,e.source]:[e.source,e.target],[s,a,o]=this.edgeEndpoint(r,y=>pl(y)),[l,c,u]=this.edgeEndpoint(
i,ql),d=e.parent,f=this.graphology.getEdgeAttributes(e.id),p=n.edge([a,c],{[Z.likec4_id]:e.id,[Z.style]:e.line??Yy});u&&p.attributes.set(Z.lhead,u),o&&p.attributes.set(Z.ltail,o);const m=Ki(u)||Ki(o);!this.graphology.hasDirectedEdge(e.target,e.source)&&f.weight>1&&p.attributes.set(Z.weight,f.weight);const w=uS(e);if(w&&p.attributes.set(m?Z.xlabel:Z.label,w),e.color&&e.color!==this.$defaults.relationship.color){const y=this.styles.colors(e.color).relationships;p.attributes.apply({[Z.color]:y.line,
[Z.fontcolor]:y.label})}let[v,g]=[e.head??this.$defaults.relationship.arrow,e.tail??"none"];if(e.dir==="back")return p.attributes.apply({[Z.arrowtail]:Qn(v),[Z.dir]:"back"}),g!=="none"&&p.attributes.apply({[Z.arrowhead]:Qn(g),[Z.dir]:"both",[Z.minlen]:0}),p;if(v==="none"&&g==="none")return p.attributes.apply({[Z.arrowtail]:"none",[Z.arrowhead]:"none",[Z.dir]:"none",[Z.minlen]:0,[Z.constraint]:!1}),p;if(v!=="none"&&g!=="none")return p.attributes.apply({[Z.arrowhead]:Qn(v),[Z.arrowtail]:Qn(g),[Z.dir]:"\
both"}),p;if(p.attributes.set(Z.arrowhead,Qn(v)),g!=="none"&&p.attributes.set(Z.arrowtail,Qn(g)),this.view.edges.length===1)return p;let h;return d===null&&s.parent==null&&l.parent==null?h=this.view.edges.filter(y=>{if(y.id===e.id||y.parent!==null||y.source===e.source&&y.target===e.target||y.source===e.target&&y.target===e.source)return!1;const b=this.computedNode(y.source),R=this.computedNode(y.target);return Br(b)||Br(R)?!1:b.parent==null&&R.parent==null}):h=this.findInternalEdges(d).filter(y=>!(y.
id===e.id||y.source===e.source&&y.target===e.target||y.source===e.target&&y.target===e.source)),h.length===0&&(d===null||this.leafElements(d).length<=3)&&p.attributes.set(Z.minlen,0),p}}function yL(t){const[e,n,r,i]=t?t.split(",").map(o=>es(+o)):[0,0,0,0],s=Math.round(r-e),a=Math.round(n-i);return{x:Math.round(e),y:Math.round(i),width:s,height:a}}function yie(t){try{const[e,n]=t.split(",");return{x:es(parseFloat(e)),y:es(parseFloat(n))}}catch(e){throw new Error(`Failed on parsing pos: ${t}`,{cause:e})}}
function vie(t){const{x:e,y:n}=yie(t.pos),r=pL(parseFloat(t.width)),i=pL(parseFloat(t.height));return{x:e-Math.round(r/2),y:n-Math.round(i/2),width:r,height:i}}function vL(t,[e,n]=[0,0]){if(!t||t.length===0)return null;let r=1/0,i=1/0,s=-1/0,a=-1/0,o=13;try{for(const c of t){if(c.op==="F"){o=es(c.size);continue}if(c.op==="T"){let u=es(c.pt[0])-e,d=es(c.width);switch(c.align){case"r":u-=d;break;case"c":u-=Math.round(d/2);break}r=Math.min(r,u),s=Math.max(s,u+d);let f=es(c.pt[1])-n;i=Math.min(i,Math.
round(f-o)),a=Math.max(a,f)}}}catch(c){return Mr.warn(`Failed on parsing label draw ops: 
{labelDrawOps}`,{e:c,labelDrawOps:t}),null}if(r===1/0)return null;const l=2;return{x:r-l,y:i-l,width:s-r+2*l,height:a-i+2*l}}function wie({_draw_:t,likec4_id:e="???"},n="<unknown view>"){try{const r=t.filter(s=>s.op.toLowerCase()==="b");An(xn(r,1),`view ${n} edge ${e} should have at least one bezier draw op`),r.length>1&&Mr.warn(`view ${n} edge ${e} has more than one bezier draw op, using the first one only`);const i=r[0].points.map(s=>es(s));return An(xn(i,2),`view ${n} edge ${e} should have at\
 least two points`),i}catch(r){throw new Error(`failed on parsing view ${n} edge ${e} _draw_:
${JSON.stringify(t,null,2)}`,{cause:r})}}function bie(t,{id:e,source:n,target:r,dir:i,label:s,description:a,...o},l){const c=vL(t._ldraw_??t._tldraw_??t._hldraw_),u=t.dir==="back"||i==="back";return s=s&&c?mL(s,{maxchars:Jy,maxLines:gL}).join(`
`):null,{id:e,source:n,target:r,label:s,...ke(a)&&{description:a},points:wie(t,l),labelBBox:c,...u?{dir:"back"}:{},...o}}function wL(t,e){const n=yL(t.bb),{nodes:r,edges:i,hasManualLayout:s,manualLayout:a,...o}=e,l=[],c=[];let u;if(o._type==="dynamic"?u={...o,sequenceLayout:{actors:[],compounds:[],parallelAreas:[],steps:[],bounds:n},[kw]:"layouted",bounds:n,nodes:l,edges:c}:u={...o,[kw]:"layouted",bounds:n,nodes:l,edges:c},s){const p=u;p[J$]="auto"}const d=t.objects??[];for(const p of r){const m=d.
find(w=>w.likec4_id===p.id);An(m,`View ${o.id} node ${p.id} not found in graphviz output`);try{const{x:w,y:v,width:g,height:h}="bb"in m?yL(m.bb):vie(m),y=[w,v];l.push({...p,x:w,y:v,width:g,height:h,labelBBox:vL(m._ldraw_,y)??{x:w,y:v,width:g,height:h}})}catch(w){throw new Error(`Failed on parsing node ${p.id}:
${JSON.stringify(m,null,2)}`,{cause:w})}}const f=t.edges??[];for(const p of i){const m=f.find(w=>w.likec4_id===p.id);if(!m){Mr.warn`View ${o.id} edge ${p.id} not found in graphviz output, skipping`;continue}c.push(bie(m,p,o.id))}return u}function kie(t,e){return wL(t,e)}class z$ extends Xy{static toDot(e){return new z$(e).print()}constructor(e){super(e,kF.DEFAULT)}createGraph(){const e=super.createGraph();return e.apply({[Z.nodesep]:Zt(100),[Z.ranksep]:Zt(100)}),e.delete(Z.TBbalance),e}elementToNode(e,n){
return n.attributes.apply({[Z.likec4_id]:e.id,[Z.likec4_project]:e.projectId}),super.elementToNode(e,n)}addEdge(e,n){const r=mr(this.getGraphNode(e.source),`Node not found for ${e.source}`),i=mr(this.getGraphNode(e.target),`Node not found for ${e.target}`),s=this.graphology.getEdgeAttributes(e.id),a=n.edge([r,i],{[Z.likec4_id]:e.id,[Z.likec4_project]:e.projectId,[Z.style]:e.line??Yy});!this.graphology.hasDirectedEdge(e.target,e.source)&&s.weight>1&&a.attributes.set(Z.weight,s.weight);const o=uS(
e);if(o&&a.attributes.set(Z.label,o),e.color&&e.color!==this.$defaults.relationship.color){const l=this.styles.colors(e.color).relationships;a.attributes.apply({[Z.color]:l.line,[Z.fontcolor]:l.label})}return a}}class _ie{value;next;constructor(e){this.value=e}}class Rie{#e;#t;#n;constructor(){this.clear()}enqueue(e){const n=new _ie(e);this.#e?(this.#t.next=n,this.#t=n):(this.#e=n,this.#t=n),this.#n++}dequeue(){const e=this.#e;if(e)return this.#e=this.#e.next,this.#n--,this.#e||(this.#t=void 0),
e.value}peek(){if(this.#e)return this.#e.value}clear(){this.#e=void 0,this.#t=void 0,this.#n=0}get size(){return this.#n}*[Symbol.iterator](){let e=this.#e;for(;e;)yield e.value,e=e.next}*drain(){for(;this.#e;)yield this.dequeue()}}function Sie(t){bL(t);const e=new Rie;let n=0;const r=()=>{n<t&&e.size>0&&(n++,e.dequeue()())},i=()=>{n--,r()},s=async(l,c,u)=>{const d=(async()=>l(...u))();c(d);try{await d}catch{}i()},a=(l,c,u)=>{new Promise(d=>{e.enqueue(d)}).then(s.bind(void 0,l,c,u)),n<t&&r()},o=(l,...c)=>new Promise(
u=>{a(l,u,c)});return Object.defineProperties(o,{activeCount:{get:()=>n},pendingCount:{get:()=>e.size},clearQueue:{value(){e.clear()}},concurrency:{get:()=>t,set(l){bL(l),t=l,queueMicrotask(()=>{for(;n<t&&e.size>0;)r()})}},map:{async value(l,c){const u=Array.from(l,(d,f)=>this(c,d,f));return Promise.all(u)}}}),o}function bL(t){if(!((Number.isInteger(t)||t===Number.POSITIVE_INFINITY)&&t>0))throw new TypeError("Expected `concurrency` to be a number from 1 and up")}const $ie=Sie(1),qp=Mr.getChild("\
graphviz-wasm");class Zr{static _graphviz=null;static opsCount=0;get concurrency(){return 1}dispose(){Vc.unload(),Zr._graphviz=null}[Symbol.dispose](){this.dispose()}graphviz(){return Promise.resolve().then(async()=>(Zr._graphviz||(qp.debug`loading wasm`,Zr.opsCount=0,Zr._graphviz=Vc.load()),await Zr._graphviz))}async attempt(e,n,r){return await $ie(async()=>{try{const i=await r();return++Zr.opsCount>=10&&(qp.debug`unloading wasm`,Vc.unload(),Zr._graphviz=null),i}catch(i){qp.error(`FAILED Graphv\
izWasm. ${e}`,{error:i}),qp.error(`FAILED DOT:
`+n),Vc.unload(),Zr._graphviz=null}qp.warn("Retrying..."),await iF(10,500);try{return await r()}finally{Vc.unload(),Zr._graphviz=null}})}async unflatten(e){return await this.attempt("unflatten",e,async()=>(await this.graphviz()).unflatten(e,1,!1,3).replaceAll(/\t\[/g," [").replaceAll(/\t/g,"    "))}async acyclic(e){return await this.attempt("acyclic",e,async()=>{const n=(await this.graphviz()).acyclic(e,!0);return n.acyclic&&n.outFile||e})}async layoutJson(e){return await this.attempt("layout",e,
async()=>(await this.graphviz()).layout(e,"json",void 0,{yInvert:!0}))}async svg(e){return await this.attempt("svg",e,async()=>(await this.graphviz()).layout(e,"svg"))}}const Tie=({view:t,styles:e})=>{switch(!0){case Y$(t):return new hie(t,e);case Oq(t):return new pie(t,e);case _w(t):return new gie(t,e);default:ta(t)}},ts=Mr.getChild(["layouter"]);class Eie{graphviz;constructor(e){this.graphviz=e??new Zr}dispose(){this.graphviz.dispose()}[Symbol.dispose](){this.dispose()}get graphvizPort(){return this.
graphviz}changePort(e){this.graphviz.dispose(),this.graphviz=e}async dotToJson(e){let n;try{n=await this.graphviz.layoutJson(e)}catch(r){throw ts.error(rt(r)),ts.error`Failed to convert DOT to JSON:\n${e}`,r}try{return JSON.parse(n)}catch(r){throw ts.error(rt(r)),ts.error`Failed to parse JSON:\n${n}\n. Generated from DOT:\n${e}`,r}}async layout(e){try{ts.debug`layouting view ${e.view.id}...`;let n=await this.dot(e);const{view:r}=e,i=await this.dotToJson(n);let s=wL(i,r);return r.manualLayout&&(s=
sre(s,r.manualLayout)),Y$(s)&&Object.assign(s,{sequenceLayout:Sq(s)}),n=n.split(`
`).filter(a=>!(a.includes("margin")&&a.includes(`${fS}`))).join(`
`),ts.debug`layouting view ${e.view.id} done`,{dot:n,diagram:s}}catch(n){throw new Error(`Error during layout: ${e.view.id}`,{cause:n})}}async svg(e){let n=await this.dot(e);return n=n.split(`
`).filter(r=>!(r.includes("margin")&&r.includes(`${fS}`))).join(`
`),{svg:await this.graphviz.svg(n),dot:n}}async dot(e){let n=Tie(e).print();if(!_w(e.view))return n;try{return await this.graphviz.unflatten(n)}catch(r){return ts.warn(`Error during unflatten: ${e.view.id}`,{error:r}),n}}async layoutProjectsView(e){ts.debug`layouting projects overview...`;let n=new z$(e).print();try{n=await this.graphviz.unflatten(n)}catch(i){ts.warn("Error during unflatten of projects view",{error:i})}const r=await this.dotToJson(n);return ts.debug`layouting projects overview done`,
kie(r,e)}}const Pr=Mr.getChild(["layouter","queue"]);class kL extends Eie{queue;isProcessingBatch=!1;constructor(e){super(e?.graphviz),this.queue=new eD({concurrency:e?.concurrency??this.graphvizPort.concurrency,timeout:e?.timeout??2e4,throwOnTimeout:e?.throwOnTimeout??!0})}async runInQueue(e){return this.isProcessingBatch?(Pr.debug`waiting for batch to finish`,await this.queue.onIdle(),await Ew(),await this.runInQueue(e)):(this.queue.size>this.queue.concurrency*2+1&&(Pr.debug`task limit reached: ${this.
queue.size} (pending: ${this.queue.pending}), waiting queue to shrink to ${this.queue.concurrency}`,await this.queue.onSizeLessThan(this.queue.concurrency+1)),Pr.debug`add task to queue`,await this.queue.add(e))}changePort(e){super.changePort(e),this.queue.concurrency!==e.concurrency&&(this.queue.concurrency=this.graphvizPort.concurrency,Pr.debug`set queue concurrency to ${this.graphvizPort.concurrency}`)}async layout(e){const n=await this.runInQueue(async()=>await super.layout(e));if(!n)throw new Error(
"QueueGraphvizLayoter: layout failed");return n}async layoutProjectsView(e){Pr.debug`adding layoutProjectsView task to queue`;const n=await this.runInQueue(async()=>(Pr.debug`layouting projects view`,await super.layoutProjectsView(e)));if(!n)throw new Error("QueueGraphvizLayoter: layoutProjectsView failed");return n}async batchLayout(e){if(this.isProcessingBatch)return Pr.debug`wait for previous layouts to finish`,await this.queue.onIdle(),await Ew(),await this.batchLayout(e);if(e.cancelToken?.isCancellationRequested)
return Pr.debug`cancellation requested`,[];const n=this.queue.concurrency;Pr.debug`starting batch layout, size: ${e.batch.length}, concurrency: ${n}`,this.isProcessingBatch=!0;const r=[];try{for(const i of e.batch)if(Pr.debug`add task for view ${i.view.id}`,this.queue.add(async()=>(n<=2&&await Ew(),await super.layout(i))).then(s=>{if(!s){e.onError?.(i,new Error(`Layout queue returned null for view ${i.view.id}`));return}r.push(s),e.onSuccess?.(i,s)}).catch(s=>{Pr.error(`Fail layout view ${i.view.
id}`,{err:s}),e.onError?.(i,s)}),this.queue.size>n+2&&(Pr.debug`task limit reached: ${this.queue.size}, waiting queue to shrink to ${n}`,await this.queue.onSizeLessThan(n+1)),e.cancelToken?.isCancellationRequested){Pr.debug`cancellation requested`;break}}finally{await this.queue.onIdle(),Pr.debug`batch layout done`,this.isProcessingBatch=!1}return r}dispose(){this.queue.clear(),super.dispose()}}const Fp=Symbol.for("idattr"),Qy={writeId(t,e){return t[Fp]=e,t},readId(t){return t[Fp]}},ev={writeId(t,e){
return Gt(e)?t[Fp]=void 0:t[Fp]=e,t},readId(t){return t[Fp]}};function ns(t){return t.textDocument.languageId===fp.languageId?(An(ke(t.likec4ProjectId),`LikeC4Document must have projectId defined: ${t.uri.fsPath}`),!0):!1}function Pie(t){return ns(t)&&t.state==Ve.Validated&&!!t.c4Specification&&!!t.c4Elements&&!!t.c4ExtendElements&&!!t.c4ExtendDeployments&&!!t.c4ExtendRelations&&!!t.c4Relations&&!!t.c4Views&&!!t.c4Deployments&&!!t.c4DeploymentRelations&&!!t.c4Imports}function rs(t){return t?.markdown||
t?.text}function _L(t){const e=parseFloat(t);return isNaN(e)?100:hx(e,{min:0,max:100})}function RL({value:t}){return _L(t)}function Tc({value:t}){switch(t){case"xs":case"sm":case"md":case"lg":case"xl":return t;case"xsmall":return"xs";case"small":return"sm";case"medium":return"md";case"large":return"lg";case"xlarge":return"xl";default:ta(t)}}function pS(t,e){const n={};if(!t||t.length===0)return n;for(const r of t)if(e(r))switch(!0){case Co(r):{const i=zp(r);ke(i)&&(n.color=i);break}case pf(r):{n.
line=r.value;break}case Md(r):{switch(r.key){case"head":{n.head=r.value;break}case"tail":{n.tail=r.value;break}default:ta(r)}break}default:ta(r)}return n}function zp(t){return t?.themeColor??t?.customColor?.$refText}function hS(t){const e=t.rankSep,n=t.nodeSep;let r;switch(t.direction){case"TopBottom":{r="TB";break}case"BottomTop":{r="BT";break}case"LeftRight":{r="LR";break}case"RightLeft":{r="RL";break}default:ta(t.direction)}return{direction:r,...n&&{nodeSep:n},...e&&{rankSep:e}}}function Cie(t){
switch(t){case"TB":return"TopBottom";case"BT":return"BottomTop";case"LR":return"LeftRight";case"RL":return"RightLeft";default:ta(t)}}function tv(t){return xr(t,e=>Zf(e)||Wl(e)||oN(e))}const mS=t=>mN(t)||Dg(t)||zg(t)||A_(t)||Ag(t)||x_(t),gS=t=>gN(t)||$_(t)||iN(t)||N_(t)||rN(t);function xie(t){for(;;){if(gS(t)||mS(t))return!1;if(L_(t)||bf(t))return!0;if(t.$container)t=t.$container;else return!1}}function Aie(t){for(;;){if(gS(t))return!1;if(mS(t))return!0;if(t.$container)t=t.$container;else return!1}}
function Iie(t){for(;;){if(mS(t))return!1;if(gS(t))return!0;if(t.$container)t=t.$container;else return!1}}class Nie{parser;locator;constructor(e){this.parser=e.likec4.ModelParser,this.locator=e.likec4.ModelLocator}getDocumentation(e){try{if(ur(e)){const n=$t(e),r=this.parser.forDocument(n).parseDeploymentNode(e),i=[r.id];return r.title!==e.name&&i.push(" ",`**${r.title}**`),i.join(`  
`)}if($r(e)){const n=$t(e),r=this.parser.forDocument(n).parseDeployedInstance(e),[i,s]=Vt.isImportRef(r.element)?[r.element.project,r.element.model]:[n.likec4ProjectId,r.element.model],a=i?this.locator.getParsedElement(s,i):this.locator.getParsedElement(s),o=[r.id,`_instance of_ ${s}`];return a&&o.push(" ",`**${a.title}**`),o.join(`  
`)}if(Vn(e)){const n=$t(e),r=this.parser.forDocument(n).parseElement(e);return r?[r.id," ",`**${r.title}**`].join(`  
`):void 0}}catch(n){ct(n)}}}function Die(t,e){return[t,e]=yS(t,e)>0?[e,t]:[t,e],Oie(t.range,e.range.start)}function yS(t,e){const n=t.range.start.line-e.range.start.line;return n!==0?n:t.range.start.character-e.range.start.character}function Oie(t,e){return!(e.line<t.start.line||e.line>t.end.line||e.line==t.start.line&&e.character<t.start.character||e.line==t.end.line&&e.character>t.end.character)}function Ec(t){return!!t&&t.range.start.line!=t.range.end.line}const he={newLine:si.newLine({allowMore:!0}),
oneSpace:si.oneSpace(),noSpace:si.noSpace(),indent:si.indent({allowMore:!0}),noIndent:si.noIndent()};class Lie extends YZ{options={quoteStyle:"auto"};extendedFormattingCommands=[];constructor(e){super(),e.shared.workspace.ConfigurationProvider.onConfigurationSectionUpdate(n=>this.onConfigurationUpdate(n.configuration.formatting))}doDocumentFormat(e,n,r){this.extendedFormattingCommands=[];const i=super.doDocumentFormat(e,n,r);return this.doExtendedFormatting(i),i}format(e){this.removeIndentFromTopLevelStatements(
e),this.indentContentInBraces(e),this.normalizeQuotes(e),this.formatImports(e),this.formatSpecificationRule(e),this.formatGlobals(e),this.formatElementDeclaration(e),this.formatExtendElement(e),this.formatRelation(e),this.formatMetadataProperty(e),this.formatDeploymentNodeDeclaration(e),this.formatDeployedInstance(e),this.formatDeploymentRelation(e),this.formatExtendDeployment(e),this.formatView(e),this.formatViewRuleGroup(e),this.formatViewRuleGlobalStyle(e),this.formatViewRuleGlobalPredicate(e),
this.formatIncludeExcludeExpressions(e),this.formatWhereExpression(e),this.formatWhereRelationExpression(e),this.formatWhereElementExpression(e),this.formatRelationExpression(e),this.formatAutolayoutProperty(e),this.formatWithPredicate(e),this.formatViewRuleStyle(e),this.formatLeafProperty(e),this.formatLinkProperty(e),this.formatNavigateToProperty(e),this.formatTags(e)}formatTags(e){this.on(e,SN,(n,r)=>{const i=_l(n.$cstNode,"values").filter(ke).slice(1);r.cst(i).prepend(he.oneSpace),r.keywords(
",").prepend(he.noSpace).append(he.oneSpace)})}formatDeploymentRelation(e){this.on(e,Si,(n,r)=>{const i=n?.source?.$cstNode?[n?.source?.$cstNode]:[];r.cst(i).append(he.oneSpace),r.keywords("]->").prepend(he.noSpace),r.keywords("-[").append(he.noSpace),r.nodes(...nt([n.target,n.tags],ke)).prepend(he.oneSpace),r.properties("title","description","technology").prepend(he.oneSpace)})}formatExtendDeployment(e){this.on(e,ga,(n,r)=>{r.keywords("extend").append(he.oneSpace)})}formatRelation(e){this.on(e,
n=>Qi(n)||Si(n),(n,r)=>{const i=n?.source?.$cstNode?[n?.source?.$cstNode]:[];r.cst(i).append(he.oneSpace),r.keywords("]->").prepend(he.noSpace),r.keywords("-[").append(he.noSpace),r.nodes(...nt([n.target,n.tags],ke)).prepend(he.oneSpace),r.properties("title","description","technology").prepend(he.oneSpace)}),this.on(e,lg,(n,r)=>{r.keywords("->","<-").surround(he.oneSpace),r.property("dotKind").prepend(he.oneSpace).append(he.oneSpace),r.keywords("]->").prepend(he.noSpace).append(he.oneSpace),r.keywords(
"-[").prepend(he.oneSpace).append(he.noSpace),r.properties("title").prepend(he.oneSpace),(K_(n)&&Ec(n.$cstNode)||dp(n)&&K_(n.$container)&&Ec(n.$container.$cstNode))&&(r.property("dotKind").prepend(si.indent({allowLess:!1,allowMore:!0,priority:2})),r.keywords("->","-[").prepend(si.indent({allowLess:!1,allowMore:!0,priority:2})),n.custom?.$cstNode&&Ec(n.custom.$cstNode)&&r.property("custom").prepend({options:{allowLess:!1,allowMore:!0,priority:2},moves:[{tabs:1}]}))})}removeIndentFromTopLevelStatements(e){
hN(e.$container)&&this.getNodeFormatter(e).keywords("specification","model","views","likec4lib","global","deployments","import").prepend(he.noIndent)}indentContentInBraces(e){if(E8(e)||kN(e)||lc(e)||uc(e)||ac(e)||L_(e)||Ql(e)||No(e)||af(e)||sf(e)||No(e)||mN(e)||Dg(e)||zg(e)||A8(e)||sy(e)||x8(e)||bf(e)||A_(e)||Ag(e)||$_(e)||pc(e)||Gf(e)||v8(e)||w8(e)||Xd(e)||P_(e)||gN(e)||iN(e)||k8(e)||rN(e)||N_(e)){const n=this.getNodeFormatter(e),r=n.keywords("{");r.prepend(he.noIndent).prepend(he.oneSpace);const i=Ec(
e.$cstNode),s=n.keywords("}"),a=n.interior(r,s);let o=null;for(const l of a.nodes){if(!i){n.cst([l]).surround(he.oneSpace);continue}(!o||!Die(o,l))&&n.cst([l]).prepend(si.newLine({allowMore:!0})).prepend(he.indent),o=l}i?s.prepend(he.noIndent).prepend(si.newLine({allowMore:!0})):s.prepend(si.oneSpace({allowLess:!0}))}}appendKeywordsWithSpace(e){this.on(e,lN)?.keywords("element").append(he.oneSpace)}formatView(e){this.on(e,Lg,(n,r)=>{(n.extends||n.viewOf||n.name)&&r.keywords("view").append(he.oneSpace),
r.keywords("of","extends").surround(he.oneSpace)}),this.on(e,T_)?.keywords("dynamic","view").append(he.oneSpace),this.on(e,sN)?.keywords("deployment","view").append(he.oneSpace)}formatLeafProperty(e){if(Jd(e)||If(e)||py(e)||ic(e)||j_(e)||wN(e)||bN(e)||Co(e)||pf(e)||Md(e)||Do(e)||ay(e)||_g(e)||ty(e)||M_(e)||U_(e)||q_(e)||V_(e)){const n=this.getNodeFormatter(e),r=n.keyword(":"),i=n.keywords("title","description","technology","summary","notation","notes","color","line","head","tail","icon","shape",
"border","opacity","multiple","size","padding","textSize");r.nodes.length===0?i.append(he.oneSpace):r.prepend(he.noSpace).append(he.oneSpace),n.keyword(";").prepend(he.noSpace).append(he.newLine)}}formatLinkProperty(e){this.on(e,mf,(n,r)=>{r.keyword("link").append(he.oneSpace),r.property("value").append(he.oneSpace),r.keyword(":").prepend(he.noSpace).append(he.oneSpace),r.keyword(";").prepend(he.noSpace).append(he.newLine)})}formatNavigateToProperty(e){this.on(e,ey)?.property("key").append(he.oneSpace)}formatAutolayoutProperty(e){
this.on(e,Hf,(n,r)=>{r.keyword("autoLayout").append(he.oneSpace),r.property("rankSep").prepend(he.oneSpace),r.property("nodeSep").prepend(he.oneSpace)})}formatMetadataProperty(e){this.on(e,C8,(n,r)=>{r.property("key").append(he.oneSpace),r.keyword(":").prepend(he.noSpace).append(he.oneSpace),r.keyword(";").prepend(he.noSpace).append(he.newLine)})}formatElementDeclaration(e){this.on(e,Vn,(n,r)=>{const i=Yn(n.$cstNode,"kind"),s=Yn(n.$cstNode,"name");s&&i&&(yS(s,i)>0?r.cst([i]).append(he.oneSpace):
(r.cst([s]).append(he.oneSpace),r.cst([i]).prepend(he.oneSpace))),r.properties("props").prepend(he.oneSpace)})}formatExtendElement(e){this.on(e,Io,(n,r)=>{r.keywords("extend").append(he.oneSpace)})}formatGlobals(e){this.on(e,Ql,(n,r)=>{r.keyword("style").append(he.oneSpace),r.property("id").append(he.oneSpace)}),this.on(e,No,(n,r)=>{r.keyword("styleGroup").append(he.oneSpace)}),this.on(e,af,(n,r)=>{r.keyword("predicateGroup").append(he.oneSpace)}),this.on(e,sf,(n,r)=>{r.keyword("dynamicPredicate\
Group").append(he.oneSpace)})}formatImports(e){this.on(e,ec,(n,r)=>{r.keyword("import").append(he.oneSpace),r.keywords("{","}","from").surround(he.oneSpace)}),this.on(e,Xi,(n,r)=>{r.keywords(",").prepend(he.noSpace).append(he.oneSpace)})}formatSpecificationRule(e){if((lc(e)||uc(e)||qf(e)||ac(e))&&this.getNodeFormatter(e).keywords("element","relationship","tag","deploymentNode").append(he.oneSpace),ly(e)){const n=this.getNodeFormatter(e);n.keyword("color").append(he.oneSpace),n.property("name").append(
he.oneSpace)}}formatWithPredicate(e){(Vg(e)||z_(e))&&this.getNodeFormatter(e).keyword("with").prepend(he.oneSpace)}formatDeploymentNodeDeclaration(e){this.on(e,ur,(n,r)=>{const i=Yn(n.$cstNode,"kind"),s=Yn(n.$cstNode,"name");s&&i&&(yS(s,i)>0?r.cst([i]).append(he.oneSpace):(r.cst([s]).append(he.oneSpace),r.cst([i]).prepend(he.oneSpace))),r.properties("title").prepend(he.oneSpace)})}formatDeployedInstance(e){this.on(e,$r,(n,r)=>{const i=n.$cstNode?.content.find(s=>s.text==="=");i&&r.cst([i]).surround(
he.oneSpace),r.keyword("instanceOf").append(he.oneSpace),r.property("title").prepend(he.oneSpace)})}formatViewRuleGlobalStyle(e){this.on(e,G_,(n,r)=>{r.keywords("global","style").append(he.oneSpace)})}formatViewRuleGlobalPredicate(e){const n=this.getNodeFormatter(e);(W_(e)||aN(e))&&n.keywords("global","predicate").append(he.oneSpace)}formatViewRuleGroup(e){this.on(e,Gf,(n,r)=>{r.keyword("group").append(he.oneSpace)})}formatViewRuleStyle(e){this.on(e,pc)?.keyword("style").append(he.oneSpace),this.
on(e,Hd)?.keyword("style").append(he.oneSpace),this.on(e,dN)?.keyword(",").prepend(he.noSpace).append(he.oneSpace),this.on(e,R8)?.keyword(",").prepend(he.noSpace).append(he.oneSpace)}formatWhereExpression(e){(F_(e)||O_(e))&&this.getNodeFormatter(e).keyword("where").append(he.oneSpace)}formatWhereRelationExpression(e){if(this.on(e,g8,(n,r)=>{r.property("operator").surround(he.oneSpace)}),this.on(e,EN,(n,r)=>{r.keyword("not").append(he.oneSpace)}),nN(e)||j8(e)||TN(e)){const n=this.getNodeFormatter(
e);n.property("operator").surround(he.oneSpace),n.property("not").surround(he.oneSpace)}}formatWhereElementExpression(e){if(this.on(e,h8,(n,r)=>{r.property("operator").surround(he.oneSpace)}),this.on(e,$N,(n,r)=>{r.keyword("not").append(he.oneSpace)}),eN(e)||M8(e)||L8(e)){const n=this.getNodeFormatter(e);n.property("operator").surround(he.oneSpace),n.property("not").surround(he.oneSpace)}}formatIncludeExcludeExpressions(e){if(h_(e)||Zf(e)||Wl(e)){const n=this.getNodeFormatter(e);(!e.$cstNode||!Ec(
e.$cstNode))&&n.keywords("include","exclude").append(he.oneSpace)}if(dN(e)){const n=this.getNodeFormatter(e),r=this.findPredicateExpressionRoot(e),i=r?.$cstNode&&Ec(r?.$cstNode);i&&n.property("value").prepend(he.indent),n.keyword(",").prepend(he.noSpace).append(i?he.newLine:he.oneSpace)}}formatRelationExpression(e){this.on(e,$8,(n,r)=>{r.keyword("->").append(he.oneSpace)}),this.on(e,pN,(n,r)=>{r.keyword("->").prepend(he.oneSpace)}),this.on(e,yN,(n,r)=>{r.keywords("->","<->").prepend(he.oneSpace),
r.keywords("-[").prepend(he.oneSpace).append(he.noSpace),r.keywords("]->").prepend(he.noSpace).append(he.oneSpace),r.property("dotKind").prepend(he.oneSpace).append(he.oneSpace)}),this.on(e,_8,(n,r)=>{r.property("target").prepend(he.oneSpace)})}findPredicateExpressionRoot(e){let n=e.$container;for(;;){if(!n||h_(n)||Zf(n)||Wl(n))return n;n=n.$container}}on(e,n,r){const i=n(e)?this.getNodeFormatter(e):void 0;return r&&i&&r(e,i),i}doExtendedFormatting(e){const n=this.quotesNormalizerFactory(this.extendedFormattingCommands);
for(let r of this.extendedFormattingCommands)r.type==="normalizeQuotes"?n(r,e):ht(r.type)}normalizeQuotes(e){if(this.options.quoteStyle==="ignore")return;let n=null;n=n??this.on(e,QI)?.property("value"),n=n??this.on(e,Vn)?.properties("props"),n=n??this.on(e,ec)?.properties("project"),n=n??this.on(e,Qi)?.properties("title","technology"),n=n??this.on(e,Gf)?.properties("title"),n=n??this.on(e,lg)?.properties("title"),n=n??this.on(e,ur)?.properties("title"),n=n??this.on(e,$r)?.properties("title"),n=
n??this.on(e,Si)?.properties("title","technology"),n=n??this.on(e,mf)?.properties("title"),n&&this.extendedFormattingCommands.push({type:"normalizeQuotes",region:n})}quotesNormalizerFactory(e){const n=this.options.quoteStyle!="auto"?this.options.quoteStyle:this.getAutoQuoteStyle(e);return(r,i)=>{const s=n==="single"?'"':"'",a=n==="single"?"'":'"',o=a.repeat(3),l=a,c=r.region.nodes.map(u=>{const d=u.text.startsWith('"""')||u.text.startsWith("'''")?o:l;return{range:u.range,newText:d+this.escapeQuotesInternalQuotes(
u.text.slice(d.length,-d.length),s,a)+d}});i.push(...c)}}escapeQuotesInternalQuotes(e,n,r){let i="",s=0;for(;s>=0;){let a=e.indexOf(r,s);if(a<0){i+=e.slice(s);break}i+=e.slice(s,a),s=a+1;let o=!1;for(;a>0&&e[a-1]=="\\";)o=!o,a--;i+=o?r:`\\${r}`}return i}getAutoQuoteStyle(e){const n=e.flatMap(r=>r.region.nodes);return n.filter(r=>r.text[0]=='"').length*2>=n.length?"double":"single"}onConfigurationUpdate(e){this.options={...this.options,...e??{quoteStyle:"auto"}}}}class Mie extends GC{services;constructor(e){
super(e),this.services=e}createDescription(e,n,r){r??=$t(e);const i=super.createDescription(e,n,r);return Fs(r.uri)||(r.likec4ProjectId??=this.services.shared.workspace.ProjectsManager.belongsTo(r),i.likec4ProjectId=r.likec4ProjectId),i}}class jie extends KC{services;constructor(e){super(e),this.services=e}async updateContent(e,n){const r=this.services.workspace.ProjectsManager;e.likec4ProjectId=r.belongsTo(e),await super.updateContent(e,n)}projectElements(e,n,r){const i=this.services.workspace.
ProjectsManager;return dt(this.symbolIndex.keys()).filter(s=>r&&!r.has(s)?!1:i.isIncluded(e,s)).flatMap(s=>this.getFileDescriptions(s,n))}}const qie=Tw("/",!0),Fie=(t,e)=>qie(t.uri.path,e.uri.path),SL=t=>t.textDocument.languageId!==fp.languageId||Fs(t.uri);class zie extends MC{services;constructor(e){super(e),this.services=e}addDocument(e){const n=e.uri.toString();if(this.documentMap.has(n))throw new Error(`A document with the URI '${n}' is already present.`);const r=[...this.documentMap.values(),
e].sort(Fie);this.documentMap.clear();for(const i of r)this.documentMap.set(i.uri.toString(),i)}getDocument(e){const n=super.getDocument(e);if(n&&!ns(n))throw new Error(`Document ${n.uri.path} is not a LikeC4 document`);return n&&!SL(n)&&(n.likec4ProjectId=this.services.workspace.ProjectsManager.belongsTo(n)),n}get allKnownDocuments(){return dt(this.documentMap.values())}get all(){return this.allKnownDocuments.filter(e=>e.textDocument.languageId===fp.languageId?(Fs(e.uri)||(e.likec4ProjectId=this.
services.workspace.ProjectsManager.belongsTo(e)),!0):!1)}get allExcludingBuiltin(){const e=this.services.workspace.ProjectsManager;return this.all.filter(n=>!(Fs(n.uri)||e.isExcluded(n)))}projectDocuments(e){const n=this.services.workspace.ProjectsManager;return this.all.filter(r=>Fs(r.uri)?!1:n.isIncluded(e,r.uri))}groupedByProject(){return this.services.workspace.ProjectsManager.all.reduce((e,n)=>{const r=this.projectDocuments(n).toArray();return xn(r,1)&&(e[n]=r),e},{})}resetProjectIds(){this.
allKnownDocuments.forEach(e=>{SL(e)||delete e.likec4ProjectId})}}var vS={},wS,$L;function nv(){if($L)return wS;$L=1;const t="\\\\/",e=`[^${t}]`,n="\\.",r="\\+",i="\\?",s="\\/",a="(?=.)",o="[^/]",l=`(?:${s}|$)`,c=`(?:^|${s})`,u=`${n}{1,2}${l}`,d=`(?!${n})`,f=`(?!${c}${u})`,p=`(?!${n}{0,1}${l})`,m=`(?!${u})`,w=`[^.${s}]`,v=`${o}*?`,h={DOT_LITERAL:n,PLUS_LITERAL:r,QMARK_LITERAL:i,SLASH_LITERAL:s,ONE_CHAR:a,QMARK:o,END_ANCHOR:l,DOTS_SLASH:u,NO_DOT:d,NO_DOTS:f,NO_DOT_SLASH:p,NO_DOTS_SLASH:m,QMARK_NO_DOT:w,
STAR:v,START_ANCHOR:c,SEP:"/"},y={...h,SLASH_LITERAL:`[${t}]`,QMARK:e,STAR:`${e}*?`,DOTS_SLASH:`${n}{1,2}(?:[${t}]|$)`,NO_DOT:`(?!${n})`,NO_DOTS:`(?!(?:^|[${t}])${n}{1,2}(?:[${t}]|$))`,NO_DOT_SLASH:`(?!${n}{0,1}(?:[${t}]|$))`,NO_DOTS_SLASH:`(?!${n}{1,2}(?:[${t}]|$))`,QMARK_NO_DOT:`[^.${t}]`,START_ANCHOR:`(?:^|[${t}])`,END_ANCHOR:`(?:[${t}]|$)`,SEP:"\\"},b={alnum:"a-zA-Z0-9",alpha:"a-zA-Z",ascii:"\\x00-\\x7F",blank:" \\t",cntrl:"\\x00-\\x1F\\x7F",digit:"0-9",graph:"\\x21-\\x7E",lower:"a-z",print:"\
\\x20-\\x7E ",punct:"\\-!\"#$%&'()\\*+,./:;<=>?@[\\]^_`{|}~",space:" \\t\\r\\n\\v\\f",upper:"A-Z",word:"A-Za-z0-9_",xdigit:"A-Fa-f0-9"};return wS={MAX_LENGTH:1024*64,POSIX_REGEX_SOURCE:b,REGEX_BACKSLASH:/\\(?![*+?^${}(|)[\]])/g,REGEX_NON_SPECIAL_CHARS:/^[^@![\].,$*+?^{}()|\\/]+/,REGEX_SPECIAL_CHARS:/[-*+?.^${}(|)[\]]/,REGEX_SPECIAL_CHARS_BACKREF:/(\\?)((\W)(\3*))/g,REGEX_SPECIAL_CHARS_GLOBAL:/([-*+?.^${}(|)[\]])/g,REGEX_REMOVE_BACKSLASH:/(?:\[.*?[^\\]\]|\\(?=.))/g,REPLACEMENTS:{__proto__:null,"*\
**":"*","**/**":"**","**/**/**":"**"},CHAR_0:48,CHAR_9:57,CHAR_UPPERCASE_A:65,CHAR_LOWERCASE_A:97,CHAR_UPPERCASE_Z:90,CHAR_LOWERCASE_Z:122,CHAR_LEFT_PARENTHESES:40,CHAR_RIGHT_PARENTHESES:41,CHAR_ASTERISK:42,CHAR_AMPERSAND:38,CHAR_AT:64,CHAR_BACKWARD_SLASH:92,CHAR_CARRIAGE_RETURN:13,CHAR_CIRCUMFLEX_ACCENT:94,CHAR_COLON:58,CHAR_COMMA:44,CHAR_DOT:46,CHAR_DOUBLE_QUOTE:34,CHAR_EQUAL:61,CHAR_EXCLAMATION_MARK:33,CHAR_FORM_FEED:12,CHAR_FORWARD_SLASH:47,CHAR_GRAVE_ACCENT:96,CHAR_HASH:35,CHAR_HYPHEN_MINUS:45,
CHAR_LEFT_ANGLE_BRACKET:60,CHAR_LEFT_CURLY_BRACE:123,CHAR_LEFT_SQUARE_BRACKET:91,CHAR_LINE_FEED:10,CHAR_NO_BREAK_SPACE:160,CHAR_PERCENT:37,CHAR_PLUS:43,CHAR_QUESTION_MARK:63,CHAR_RIGHT_ANGLE_BRACKET:62,CHAR_RIGHT_CURLY_BRACE:125,CHAR_RIGHT_SQUARE_BRACKET:93,CHAR_SEMICOLON:59,CHAR_SINGLE_QUOTE:39,CHAR_SPACE:32,CHAR_TAB:9,CHAR_UNDERSCORE:95,CHAR_VERTICAL_LINE:124,CHAR_ZERO_WIDTH_NOBREAK_SPACE:65279,extglobChars(R){return{"!":{type:"negate",open:"(?:(?!(?:",close:`))${R.STAR})`},"?":{type:"qmark",open:"\
(?:",close:")?"},"+":{type:"plus",open:"(?:",close:")+"},"*":{type:"star",open:"(?:",close:")*"},"@":{type:"at",open:"(?:",close:")"}}},globChars(R){return R===!0?y:h}},wS}var TL;function rv(){return TL||(TL=1,(function(t){const{REGEX_BACKSLASH:e,REGEX_REMOVE_BACKSLASH:n,REGEX_SPECIAL_CHARS:r,REGEX_SPECIAL_CHARS_GLOBAL:i}=nv();t.isObject=s=>s!==null&&typeof s=="object"&&!Array.isArray(s),t.hasRegexChars=s=>r.test(s),t.isRegexChar=s=>s.length===1&&t.hasRegexChars(s),t.escapeRegex=s=>s.replace(i,"\
\\$1"),t.toPosixSlashes=s=>s.replace(e,"/"),t.isWindows=()=>{if(typeof navigator<"u"&&navigator.platform){const s=navigator.platform.toLowerCase();return s==="win32"||s==="windows"}return typeof process<"u"&&process.platform?process.platform==="win32":!1},t.removeBackslashes=s=>s.replace(n,a=>a==="\\"?"":a),t.escapeLast=(s,a,o)=>{const l=s.lastIndexOf(a,o);return l===-1?s:s[l-1]==="\\"?t.escapeLast(s,a,l-1):`${s.slice(0,l)}\\${s.slice(l)}`},t.removePrefix=(s,a={})=>{let o=s;return o.startsWith("\
./")&&(o=o.slice(2),a.prefix="./"),o},t.wrapOutput=(s,a={},o={})=>{const l=o.contains?"":"^",c=o.contains?"":"$";let u=`${l}(?:${s})${c}`;return a.negated===!0&&(u=`(?:^(?!${u}).*$)`),u},t.basename=(s,{windows:a}={})=>{const o=s.split(a?/[\\/]/:"/"),l=o[o.length-1];return l===""?o[o.length-2]:l}})(vS)),vS}var bS,EL;function Uie(){if(EL)return bS;EL=1;const t=rv(),{CHAR_ASTERISK:e,CHAR_AT:n,CHAR_BACKWARD_SLASH:r,CHAR_COMMA:i,CHAR_DOT:s,CHAR_EXCLAMATION_MARK:a,CHAR_FORWARD_SLASH:o,CHAR_LEFT_CURLY_BRACE:l,
CHAR_LEFT_PARENTHESES:c,CHAR_LEFT_SQUARE_BRACKET:u,CHAR_PLUS:d,CHAR_QUESTION_MARK:f,CHAR_RIGHT_CURLY_BRACE:p,CHAR_RIGHT_PARENTHESES:m,CHAR_RIGHT_SQUARE_BRACKET:w}=nv(),v=y=>y===o||y===r,g=y=>{y.isPrefix!==!0&&(y.depth=y.isGlobstar?1/0:1)};return bS=(y,b)=>{const R=b||{},T=y.length-1,N=R.parts===!0||R.scanToEnd===!0,q=[],B=[],ie=[];let L=y,E=-1,$=0,z=0,j=!1,U=!1,W=!1,le=!1,ne=!1,P=!1,M=!1,J=!1,G=!1,_=!1,I=0,Y,se,fe={value:"",depth:0,isGlob:!1};const _e=()=>E>=T,pe=()=>L.charCodeAt(E+1),x=()=>(Y=se,
L.charCodeAt(++E));for(;E<T;){se=x();let Re;if(se===r){M=fe.backslashes=!0,se=x(),se===l&&(P=!0);continue}if(P===!0||se===l){for(I++;_e()!==!0&&(se=x());){if(se===r){M=fe.backslashes=!0,x();continue}if(se===l){I++;continue}if(P!==!0&&se===s&&(se=x())===s){if(j=fe.isBrace=!0,W=fe.isGlob=!0,_=!0,N===!0)continue;break}if(P!==!0&&se===i){if(j=fe.isBrace=!0,W=fe.isGlob=!0,_=!0,N===!0)continue;break}if(se===p&&(I--,I===0)){P=!1,j=fe.isBrace=!0,_=!0;break}}if(N===!0)continue;break}if(se===o){if(q.push(
E),B.push(fe),fe={value:"",depth:0,isGlob:!1},_===!0)continue;if(Y===s&&E===$+1){$+=2;continue}z=E+1;continue}if(R.noext!==!0&&(se===d||se===n||se===e||se===f||se===a)===!0&&pe()===c){if(W=fe.isGlob=!0,le=fe.isExtglob=!0,_=!0,se===a&&E===$&&(G=!0),N===!0){for(;_e()!==!0&&(se=x());){if(se===r){M=fe.backslashes=!0,se=x();continue}if(se===m){W=fe.isGlob=!0,_=!0;break}}continue}break}if(se===e){if(Y===e&&(ne=fe.isGlobstar=!0),W=fe.isGlob=!0,_=!0,N===!0)continue;break}if(se===f){if(W=fe.isGlob=!0,_=!0,
N===!0)continue;break}if(se===u){for(;_e()!==!0&&(Re=x());){if(Re===r){M=fe.backslashes=!0,x();continue}if(Re===w){U=fe.isBracket=!0,W=fe.isGlob=!0,_=!0;break}}if(N===!0)continue;break}if(R.nonegate!==!0&&se===a&&E===$){J=fe.negated=!0,$++;continue}if(R.noparen!==!0&&se===c){if(W=fe.isGlob=!0,N===!0){for(;_e()!==!0&&(se=x());){if(se===c){M=fe.backslashes=!0,se=x();continue}if(se===m){_=!0;break}}continue}break}if(W===!0){if(_=!0,N===!0)continue;break}}R.noext===!0&&(le=!1,W=!1);let O=L,K="",F="";
$>0&&(K=L.slice(0,$),L=L.slice($),z-=$),O&&W===!0&&z>0?(O=L.slice(0,z),F=L.slice(z)):W===!0?(O="",F=L):O=L,O&&O!==""&&O!=="/"&&O!==L&&v(O.charCodeAt(O.length-1))&&(O=O.slice(0,-1)),R.unescape===!0&&(F&&(F=t.removeBackslashes(F)),O&&M===!0&&(O=t.removeBackslashes(O)));const ae={prefix:K,input:y,start:$,base:O,glob:F,isBrace:j,isBracket:U,isGlob:W,isExtglob:le,isGlobstar:ne,negated:J,negatedExtglob:G};if(R.tokens===!0&&(ae.maxDepth=0,v(se)||B.push(fe),ae.tokens=B),R.parts===!0||R.tokens===!0){let Re;
for(let ze=0;ze<q.length;ze++){const ye=Re?Re+1:$,Me=q[ze],me=y.slice(ye,Me);R.tokens&&(ze===0&&$!==0?(B[ze].isPrefix=!0,B[ze].value=K):B[ze].value=me,g(B[ze]),ae.maxDepth+=B[ze].depth),(ze!==0||me!=="")&&ie.push(me),Re=Me}if(Re&&Re+1<y.length){const ze=y.slice(Re+1);ie.push(ze),R.tokens&&(B[B.length-1].value=ze,g(B[B.length-1]),ae.maxDepth+=B[B.length-1].depth)}ae.slashes=q,ae.parts=ie}return ae},bS}var kS,PL;function Hie(){if(PL)return kS;PL=1;const t=nv(),e=rv(),{MAX_LENGTH:n,POSIX_REGEX_SOURCE:r,
REGEX_NON_SPECIAL_CHARS:i,REGEX_SPECIAL_CHARS_BACKREF:s,REPLACEMENTS:a}=t,o=(u,d)=>{if(typeof d.expandRange=="function")return d.expandRange(...u,d);u.sort();const f=`[${u.join("-")}]`;try{new RegExp(f)}catch{return u.map(m=>e.escapeRegex(m)).join("..")}return f},l=(u,d)=>`Missing ${u}: "${d}" - use "\\\\${d}" to match literal characters`,c=(u,d)=>{if(typeof u!="string")throw new TypeError("Expected a string");u=a[u]||u;const f={...d},p=typeof f.maxLength=="number"?Math.min(n,f.maxLength):n;let m=u.
length;if(m>p)throw new SyntaxError(`Input length: ${m}, exceeds maximum allowed length: ${p}`);const w={type:"bos",value:"",output:f.prepend||""},v=[w],g=f.capture?"":"?:",h=t.globChars(f.windows),y=t.extglobChars(h),{DOT_LITERAL:b,PLUS_LITERAL:R,SLASH_LITERAL:T,ONE_CHAR:N,DOTS_SLASH:q,NO_DOT:B,NO_DOT_SLASH:ie,NO_DOTS_SLASH:L,QMARK:E,QMARK_NO_DOT:$,STAR:z,START_ANCHOR:j}=h,U=ye=>`(${g}(?:(?!${j}${ye.dot?q:b}).)*?)`,W=f.dot?"":B,le=f.dot?E:$;let ne=f.bash===!0?U(f):z;f.capture&&(ne=`(${ne})`),typeof f.
noext=="boolean"&&(f.noextglob=f.noext);const P={input:u,index:-1,start:0,dot:f.dot===!0,consumed:"",output:"",prefix:"",backtrack:!1,negated:!1,brackets:0,braces:0,parens:0,quotes:0,globstar:!1,tokens:v};u=e.removePrefix(u,P),m=u.length;const M=[],J=[],G=[];let _=w,I;const Y=()=>P.index===m-1,se=P.peek=(ye=1)=>u[P.index+ye],fe=P.advance=()=>u[++P.index]||"",_e=()=>u.slice(P.index+1),pe=(ye="",Me=0)=>{P.consumed+=ye,P.index+=Me},x=ye=>{P.output+=ye.output!=null?ye.output:ye.value,pe(ye.value)},O=()=>{
let ye=1;for(;se()==="!"&&(se(2)!=="("||se(3)==="?");)fe(),P.start++,ye++;return ye%2===0?!1:(P.negated=!0,P.start++,!0)},K=ye=>{P[ye]++,G.push(ye)},F=ye=>{P[ye]--,G.pop()},ae=ye=>{if(_.type==="globstar"){const Me=P.braces>0&&(ye.type==="comma"||ye.type==="brace"),me=ye.extglob===!0||M.length&&(ye.type==="pipe"||ye.type==="paren");ye.type!=="slash"&&ye.type!=="paren"&&!Me&&!me&&(P.output=P.output.slice(0,-_.output.length),_.type="star",_.value="*",_.output=ne,P.output+=_.output)}if(M.length&&ye.
type!=="paren"&&(M[M.length-1].inner+=ye.value),(ye.value||ye.output)&&x(ye),_&&_.type==="text"&&ye.type==="text"){_.output=(_.output||_.value)+ye.value,_.value+=ye.value;return}ye.prev=_,v.push(ye),_=ye},Re=(ye,Me)=>{const me={...y[Me],conditions:1,inner:""};me.prev=_,me.parens=P.parens,me.output=P.output;const $e=(f.capture?"(":"")+me.open;K("parens"),ae({type:ye,value:Me,output:P.output?"":N}),ae({type:"paren",extglob:!0,value:fe(),output:$e}),M.push(me)},ze=ye=>{let Me=ye.close+(f.capture?")":
""),me;if(ye.type==="negate"){let $e=ne;if(ye.inner&&ye.inner.length>1&&ye.inner.includes("/")&&($e=U(f)),($e!==ne||Y()||/^\)+$/.test(_e()))&&(Me=ye.close=`)$))${$e}`),ye.inner.includes("*")&&(me=_e())&&/^\.[^\\/.]+$/.test(me)){const Ge=c(me,{...d,fastpaths:!1}).output;Me=ye.close=`)${Ge})${$e})`}ye.prev.type==="bos"&&(P.negatedExtglob=!0)}ae({type:"paren",extglob:!0,value:I,output:Me}),F("parens")};if(f.fastpaths!==!1&&!/(^[*!]|[/()[\]{}"])/.test(u)){let ye=!1,Me=u.replace(s,(me,$e,Ge,st,ut,ln)=>st===
"\\"?(ye=!0,me):st==="?"?$e?$e+st+(ut?E.repeat(ut.length):""):ln===0?le+(ut?E.repeat(ut.length):""):E.repeat(Ge.length):st==="."?b.repeat(Ge.length):st==="*"?$e?$e+st+(ut?ne:""):ne:$e?me:`\\${me}`);return ye===!0&&(f.unescape===!0?Me=Me.replace(/\\/g,""):Me=Me.replace(/\\+/g,me=>me.length%2===0?"\\\\":me?"\\":"")),Me===u&&f.contains===!0?(P.output=u,P):(P.output=e.wrapOutput(Me,P,d),P)}for(;!Y();){if(I=fe(),I==="\0")continue;if(I==="\\"){const me=se();if(me==="/"&&f.bash!==!0||me==="."||me===";")
continue;if(!me){I+="\\",ae({type:"text",value:I});continue}const $e=/^\\+/.exec(_e());let Ge=0;if($e&&$e[0].length>2&&(Ge=$e[0].length,P.index+=Ge,Ge%2!==0&&(I+="\\")),f.unescape===!0?I=fe():I+=fe(),P.brackets===0){ae({type:"text",value:I});continue}}if(P.brackets>0&&(I!=="]"||_.value==="["||_.value==="[^")){if(f.posix!==!1&&I===":"){const me=_.value.slice(1);if(me.includes("[")&&(_.posix=!0,me.includes(":"))){const $e=_.value.lastIndexOf("["),Ge=_.value.slice(0,$e),st=_.value.slice($e+2),ut=r[st];
if(ut){_.value=Ge+ut,P.backtrack=!0,fe(),!w.output&&v.indexOf(_)===1&&(w.output=N);continue}}}(I==="["&&se()!==":"||I==="-"&&se()==="]")&&(I=`\\${I}`),I==="]"&&(_.value==="["||_.value==="[^")&&(I=`\\${I}`),f.posix===!0&&I==="!"&&_.value==="["&&(I="^"),_.value+=I,x({value:I});continue}if(P.quotes===1&&I!=='"'){I=e.escapeRegex(I),_.value+=I,x({value:I});continue}if(I==='"'){P.quotes=P.quotes===1?0:1,f.keepQuotes===!0&&ae({type:"text",value:I});continue}if(I==="("){K("parens"),ae({type:"paren",value:I});
continue}if(I===")"){if(P.parens===0&&f.strictBrackets===!0)throw new SyntaxError(l("opening","("));const me=M[M.length-1];if(me&&P.parens===me.parens+1){ze(M.pop());continue}ae({type:"paren",value:I,output:P.parens?")":"\\)"}),F("parens");continue}if(I==="["){if(f.nobracket===!0||!_e().includes("]")){if(f.nobracket!==!0&&f.strictBrackets===!0)throw new SyntaxError(l("closing","]"));I=`\\${I}`}else K("brackets");ae({type:"bracket",value:I});continue}if(I==="]"){if(f.nobracket===!0||_&&_.type==="\
bracket"&&_.value.length===1){ae({type:"text",value:I,output:`\\${I}`});continue}if(P.brackets===0){if(f.strictBrackets===!0)throw new SyntaxError(l("opening","["));ae({type:"text",value:I,output:`\\${I}`});continue}F("brackets");const me=_.value.slice(1);if(_.posix!==!0&&me[0]==="^"&&!me.includes("/")&&(I=`/${I}`),_.value+=I,x({value:I}),f.literalBrackets===!1||e.hasRegexChars(me))continue;const $e=e.escapeRegex(_.value);if(P.output=P.output.slice(0,-_.value.length),f.literalBrackets===!0){P.output+=
$e,_.value=$e;continue}_.value=`(${g}${$e}|${_.value})`,P.output+=_.value;continue}if(I==="{"&&f.nobrace!==!0){K("braces");const me={type:"brace",value:I,output:"(",outputIndex:P.output.length,tokensIndex:P.tokens.length};J.push(me),ae(me);continue}if(I==="}"){const me=J[J.length-1];if(f.nobrace===!0||!me){ae({type:"text",value:I,output:I});continue}let $e=")";if(me.dots===!0){const Ge=v.slice(),st=[];for(let ut=Ge.length-1;ut>=0&&(v.pop(),Ge[ut].type!=="brace");ut--)Ge[ut].type!=="dots"&&st.unshift(
Ge[ut].value);$e=o(st,f),P.backtrack=!0}if(me.comma!==!0&&me.dots!==!0){const Ge=P.output.slice(0,me.outputIndex),st=P.tokens.slice(me.tokensIndex);me.value=me.output="\\{",I=$e="\\}",P.output=Ge;for(const ut of st)P.output+=ut.output||ut.value}ae({type:"brace",value:I,output:$e}),F("braces"),J.pop();continue}if(I==="|"){M.length>0&&M[M.length-1].conditions++,ae({type:"text",value:I});continue}if(I===","){let me=I;const $e=J[J.length-1];$e&&G[G.length-1]==="braces"&&($e.comma=!0,me="|"),ae({type:"\
comma",value:I,output:me});continue}if(I==="/"){if(_.type==="dot"&&P.index===P.start+1){P.start=P.index+1,P.consumed="",P.output="",v.pop(),_=w;continue}ae({type:"slash",value:I,output:T});continue}if(I==="."){if(P.braces>0&&_.type==="dot"){_.value==="."&&(_.output=b);const me=J[J.length-1];_.type="dots",_.output+=I,_.value+=I,me.dots=!0;continue}if(P.braces+P.parens===0&&_.type!=="bos"&&_.type!=="slash"){ae({type:"text",value:I,output:b});continue}ae({type:"dot",value:I,output:b});continue}if(I===
"?"){if(!(_&&_.value==="(")&&f.noextglob!==!0&&se()==="("&&se(2)!=="?"){Re("qmark",I);continue}if(_&&_.type==="paren"){const $e=se();let Ge=I;(_.value==="("&&!/[!=<:]/.test($e)||$e==="<"&&!/<([!=]|\w+>)/.test(_e()))&&(Ge=`\\${I}`),ae({type:"text",value:I,output:Ge});continue}if(f.dot!==!0&&(_.type==="slash"||_.type==="bos")){ae({type:"qmark",value:I,output:$});continue}ae({type:"qmark",value:I,output:E});continue}if(I==="!"){if(f.noextglob!==!0&&se()==="("&&(se(2)!=="?"||!/[!=<:]/.test(se(3)))){
Re("negate",I);continue}if(f.nonegate!==!0&&P.index===0){O();continue}}if(I==="+"){if(f.noextglob!==!0&&se()==="("&&se(2)!=="?"){Re("plus",I);continue}if(_&&_.value==="("||f.regex===!1){ae({type:"plus",value:I,output:R});continue}if(_&&(_.type==="bracket"||_.type==="paren"||_.type==="brace")||P.parens>0){ae({type:"plus",value:I});continue}ae({type:"plus",value:R});continue}if(I==="@"){if(f.noextglob!==!0&&se()==="("&&se(2)!=="?"){ae({type:"at",extglob:!0,value:I,output:""});continue}ae({type:"te\
xt",value:I});continue}if(I!=="*"){(I==="$"||I==="^")&&(I=`\\${I}`);const me=i.exec(_e());me&&(I+=me[0],P.index+=me[0].length),ae({type:"text",value:I});continue}if(_&&(_.type==="globstar"||_.star===!0)){_.type="star",_.star=!0,_.value+=I,_.output=ne,P.backtrack=!0,P.globstar=!0,pe(I);continue}let ye=_e();if(f.noextglob!==!0&&/^\([^?]/.test(ye)){Re("star",I);continue}if(_.type==="star"){if(f.noglobstar===!0){pe(I);continue}const me=_.prev,$e=me.prev,Ge=me.type==="slash"||me.type==="bos",st=$e&&($e.
type==="star"||$e.type==="globstar");if(f.bash===!0&&(!Ge||ye[0]&&ye[0]!=="/")){ae({type:"star",value:I,output:""});continue}const ut=P.braces>0&&(me.type==="comma"||me.type==="brace"),ln=M.length&&(me.type==="pipe"||me.type==="paren");if(!Ge&&me.type!=="paren"&&!ut&&!ln){ae({type:"star",value:I,output:""});continue}for(;ye.slice(0,3)==="/**";){const Yt=u[P.index+4];if(Yt&&Yt!=="/")break;ye=ye.slice(3),pe("/**",3)}if(me.type==="bos"&&Y()){_.type="globstar",_.value+=I,_.output=U(f),P.output=_.output,
P.globstar=!0,pe(I);continue}if(me.type==="slash"&&me.prev.type!=="bos"&&!st&&Y()){P.output=P.output.slice(0,-(me.output+_.output).length),me.output=`(?:${me.output}`,_.type="globstar",_.output=U(f)+(f.strictSlashes?")":"|$)"),_.value+=I,P.globstar=!0,P.output+=me.output+_.output,pe(I);continue}if(me.type==="slash"&&me.prev.type!=="bos"&&ye[0]==="/"){const Yt=ye[1]!==void 0?"|$":"";P.output=P.output.slice(0,-(me.output+_.output).length),me.output=`(?:${me.output}`,_.type="globstar",_.output=`${U(
f)}${T}|${T}${Yt})`,_.value+=I,P.output+=me.output+_.output,P.globstar=!0,pe(I+fe()),ae({type:"slash",value:"/",output:""});continue}if(me.type==="bos"&&ye[0]==="/"){_.type="globstar",_.value+=I,_.output=`(?:^|${T}|${U(f)}${T})`,P.output=_.output,P.globstar=!0,pe(I+fe()),ae({type:"slash",value:"/",output:""});continue}P.output=P.output.slice(0,-_.output.length),_.type="globstar",_.output=U(f),_.value+=I,P.output+=_.output,P.globstar=!0,pe(I);continue}const Me={type:"star",value:I,output:ne};if(f.
bash===!0){Me.output=".*?",(_.type==="bos"||_.type==="slash")&&(Me.output=W+Me.output),ae(Me);continue}if(_&&(_.type==="bracket"||_.type==="paren")&&f.regex===!0){Me.output=I,ae(Me);continue}(P.index===P.start||_.type==="slash"||_.type==="dot")&&(_.type==="dot"?(P.output+=ie,_.output+=ie):f.dot===!0?(P.output+=L,_.output+=L):(P.output+=W,_.output+=W),se()!=="*"&&(P.output+=N,_.output+=N)),ae(Me)}for(;P.brackets>0;){if(f.strictBrackets===!0)throw new SyntaxError(l("closing","]"));P.output=e.escapeLast(
P.output,"["),F("brackets")}for(;P.parens>0;){if(f.strictBrackets===!0)throw new SyntaxError(l("closing",")"));P.output=e.escapeLast(P.output,"("),F("parens")}for(;P.braces>0;){if(f.strictBrackets===!0)throw new SyntaxError(l("closing","}"));P.output=e.escapeLast(P.output,"{"),F("braces")}if(f.strictSlashes!==!0&&(_.type==="star"||_.type==="bracket")&&ae({type:"maybe_slash",value:"",output:`${T}?`}),P.backtrack===!0){P.output="";for(const ye of P.tokens)P.output+=ye.output!=null?ye.output:ye.value,
ye.suffix&&(P.output+=ye.suffix)}return P};return c.fastpaths=(u,d)=>{const f={...d},p=typeof f.maxLength=="number"?Math.min(n,f.maxLength):n,m=u.length;if(m>p)throw new SyntaxError(`Input length: ${m}, exceeds maximum allowed length: ${p}`);u=a[u]||u;const{DOT_LITERAL:w,SLASH_LITERAL:v,ONE_CHAR:g,DOTS_SLASH:h,NO_DOT:y,NO_DOTS:b,NO_DOTS_SLASH:R,STAR:T,START_ANCHOR:N}=t.globChars(f.windows),q=f.dot?b:y,B=f.dot?R:y,ie=f.capture?"":"?:",L={negated:!1,prefix:""};let E=f.bash===!0?".*?":T;f.capture&&
(E=`(${E})`);const $=W=>W.noglobstar===!0?E:`(${ie}(?:(?!${N}${W.dot?h:w}).)*?)`,z=W=>{switch(W){case"*":return`${q}${g}${E}`;case".*":return`${w}${g}${E}`;case"*.*":return`${q}${E}${w}${g}${E}`;case"*/*":return`${q}${E}${v}${g}${B}${E}`;case"**":return q+$(f);case"**/*":return`(?:${q}${$(f)}${v})?${B}${g}${E}`;case"**/*.*":return`(?:${q}${$(f)}${v})?${B}${E}${w}${g}${E}`;case"**/.*":return`(?:${q}${$(f)}${v})?${w}${g}${E}`;default:{const le=/^(.*?)\.(\w+)$/.exec(W);if(!le)return;const ne=z(le[1]);
return ne?ne+w+le[2]:void 0}}},j=e.removePrefix(u,L);let U=z(j);return U&&f.strictSlashes!==!0&&(U+=`${v}?`),U},kS=c,kS}var _S,CL;function Vie(){if(CL)return _S;CL=1;const t=Uie(),e=Hie(),n=rv(),r=nv(),i=a=>a&&typeof a=="object"&&!Array.isArray(a),s=(a,o,l=!1)=>{if(Array.isArray(a)){const v=a.map(h=>s(h,o,l));return h=>{for(const y of v){const b=y(h);if(b)return b}return!1}}const c=i(a)&&a.tokens&&a.input;if(a===""||typeof a!="string"&&!c)throw new TypeError("Expected pattern to be a non-empty s\
tring");const u=o||{},d=u.windows,f=c?s.compileRe(a,o):s.makeRe(a,o,!1,!0),p=f.state;delete f.state;let m=()=>!1;if(u.ignore){const v={...o,ignore:null,onMatch:null,onResult:null};m=s(u.ignore,v,l)}const w=(v,g=!1)=>{const{isMatch:h,match:y,output:b}=s.test(v,f,o,{glob:a,posix:d}),R={glob:a,state:p,regex:f,posix:d,input:v,output:b,match:y,isMatch:h};return typeof u.onResult=="function"&&u.onResult(R),h===!1?(R.isMatch=!1,g?R:!1):m(v)?(typeof u.onIgnore=="function"&&u.onIgnore(R),R.isMatch=!1,g?R:
!1):(typeof u.onMatch=="function"&&u.onMatch(R),g?R:!0)};return l&&(w.state=p),w};return s.test=(a,o,l,{glob:c,posix:u}={})=>{if(typeof a!="string")throw new TypeError("Expected input to be a string");if(a==="")return{isMatch:!1,output:""};const d=l||{},f=d.format||(u?n.toPosixSlashes:null);let p=a===c,m=p&&f?f(a):a;return p===!1&&(m=f?f(a):a,p=m===c),(p===!1||d.capture===!0)&&(d.matchBase===!0||d.basename===!0?p=s.matchBase(a,o,l,u):p=o.exec(m)),{isMatch:!!p,match:p,output:m}},s.matchBase=(a,o,l)=>(o instanceof
RegExp?o:s.makeRe(o,l)).test(n.basename(a)),s.isMatch=(a,o,l)=>s(o,l)(a),s.parse=(a,o)=>Array.isArray(a)?a.map(l=>s.parse(l,o)):e(a,{...o,fastpaths:!1}),s.scan=(a,o)=>t(a,o),s.compileRe=(a,o,l=!1,c=!1)=>{if(l===!0)return a.output;const u=o||{},d=u.contains?"":"^",f=u.contains?"":"$";let p=`${d}(?:${a.output})${f}`;a&&a.negated===!0&&(p=`^(?!${p}).*$`);const m=s.toRegex(p,o);return c===!0&&(m.state=a),m},s.makeRe=(a,o={},l=!1,c=!1)=>{if(!a||typeof a!="string")throw new TypeError("Expected a non-e\
mpty string");let u={negated:!1,fastpaths:!0};return o.fastpaths!==!1&&(a[0]==="."||a[0]==="*")&&(u.output=e.fastpaths(a,o)),u.output||(u=e(a,o)),s.compileRe(u,o,l,c)},s.toRegex=(a,o)=>{try{const l=o||{};return new RegExp(a,l.flags||(l.nocase?"i":""))}catch(l){if(o&&o.debug===!0)throw l;return/$^/}},s.constants=r,_S=s,_S}var RS,xL;function Bie(){if(xL)return RS;xL=1;const t=Vie(),e=rv();function n(r,i,s=!1){return i&&(i.windows===null||i.windows===void 0)&&(i={...i,windows:e.isWindows()}),t(r,i,
s)}return Object.assign(n,t),RS=n,RS}var Wie=Bie();const SS=oo(Wie),Gie=/#/g,Kie=/&/g,Zie=/\//g,Jie=/=/g,$S=/\+/g,Yie=/%5e/gi,Xie=/%60/gi,Qie=/%7c/gi,ese=/%20/gi;function tse(t){return encodeURI(""+t).replace(Qie,"|")}function TS(t){return tse(typeof t=="string"?t:JSON.stringify(t)).replace($S,"%2B").replace(ese,"+").replace(Gie,"%23").replace(Kie,"%26").replace(Xie,"`").replace(Yie,"^").replace(Zie,"%2F")}function ES(t){return TS(t).replace(Jie,"%3D")}function AL(t=""){try{return decodeURIComponent(
""+t)}catch{return""+t}}function nse(t){return AL(t.replace($S," "))}function rse(t){return AL(t.replace($S," "))}function ise(t=""){const e=Object.create(null);t[0]==="?"&&(t=t.slice(1));for(const n of t.split("&")){const r=n.match(/([^=]+)=?(.*)/)||[];if(r.length<2)continue;const i=nse(r[1]);if(i==="__proto__"||i==="constructor")continue;const s=rse(r[2]||"");e[i]===void 0?e[i]=s:Array.isArray(e[i])?e[i].push(s):e[i]=[e[i],s]}return e}function sse(t,e){return(typeof e=="number"||typeof e=="boo\
lean")&&(e=String(e)),e?Array.isArray(e)?e.map(n=>`${ES(t)}=${TS(n)}`).join("&"):`${ES(t)}=${TS(e)}`:ES(t)}function ase(t){return Object.keys(t).filter(e=>t[e]!==void 0).map(e=>sse(e,t[e])).filter(Boolean).join("&")}const ose=/^[\s\w\0+.-]{2,}:([/\\]{1,2})/,IL=/^[\s\w\0+.-]{2,}:([/\\]{2})?/,lse=/^([/\\]\s*){2,}[^/\\]/,cse=/^\.?\//;function iv(t){return["./","../"].some(e=>t.startsWith(e))}function Pc(t,e={}){return typeof e=="boolean"&&(e={acceptRelative:e}),e.strict?ose.test(t):IL.test(t)||(e.acceptRelative?
lse.test(t):!1)}function use(t="",e){return t.endsWith("/")}function PS(t="",e){return(use(t)?t.slice(0,-1):t)||"/"}function sv(t="",e){return t.endsWith("/")?t:t+"/"}function Up(t=""){return t.startsWith("/")}function NL(t=""){return(Up(t)?t.slice(1):t)||"/"}function dse(t=""){return Up(t)?t:"/"+t}function fse(t=""){return t.split("://").map(e=>e.replace(/\/{2,}/g,"/")).join("://")}function pse(t,e){if(mse(e))return t;const n=PS(e);if(!t.startsWith(n))return t;const r=t.slice(n.length);return r[0]===
"/"?r:"/"+r}function hse(t,e){const n=OL(t),r={...ise(n.search),...e};return n.search=ase(r),wse(n)}function mse(t){return!t||t==="/"}function gse(t){return t&&t!=="/"}function Hp(t,...e){let n=t||"";for(const r of e.filter(i=>gse(i)))if(n){const i=r.replace(cse,"");n=sv(n)+i}else n=r;return n}function Go(...t){const e=/\/(?!\/)/,n=t.filter(Boolean),r=[];let i=0;for(const a of n)if(!(!a||a==="/")){for(const[o,l]of a.split(e).entries())if(!(!l||l===".")){if(l===".."){if(r.length===1&&Pc(r[0]))continue;
r.pop(),i--;continue}if(o===1&&r[r.length-1]?.endsWith(":/")){r[r.length-1]+="/"+l;continue}r.push(l),i++}}let s=r.join("/");return i>=0?n[0]?.startsWith("/")&&!s.startsWith("/")?s="/"+s:n[0]?.startsWith("./")&&!s.startsWith("./")&&(s="./"+s):s="../".repeat(-1*i)+s,n[n.length-1]?.endsWith("/")&&!s.endsWith("/")&&(s+="/"),s}function yse(t){return vse(t,"")}function vse(t,e){let n=t.match(IL);return n||(n=t.match(/^\/{2,}/)),n?e+t.slice(n[0].length):e+t}const DL=Symbol.for("ufo:protocolRelative");
function OL(t="",e){const n=t.match(/^[\s\0]*(blob:|data:|javascript:|vbscript:)(.*)/i);if(n){const[,d,f=""]=n;return{protocol:d.toLowerCase(),pathname:f,href:d+f,auth:"",host:"",search:"",hash:""}}if(!Pc(t,{acceptRelative:!0}))return LL(t);const[,r="",i,s=""]=t.replace(/\\/g,"/").match(/^[\s\0]*([\w+.-]{2,}:)?\/\/([^/@]+@)?(.*)/)||[];let[,a="",o=""]=s.match(/([^#/?]*)(.*)?/)||[];r==="file:"&&(o=o.replace(/\/(?=[A-Za-z]:)/,""));const{pathname:l,search:c,hash:u}=LL(o);return{protocol:r.toLowerCase(),
auth:i?i.slice(0,Math.max(0,i.length-1)):"",host:a,pathname:l,search:c,hash:u,[DL]:!r}}function LL(t=""){const[e="",n="",r=""]=(t.match(/([^#?]*)(\?[^#]*)?(#.*)?/)||[]).splice(1);return{pathname:e,search:n,hash:r}}function wse(t){const e=t.pathname||"",n=t.search?(t.search.startsWith("?")?"":"?")+t.search:"",r=t.hash||"",i=t.auth?t.auth+"@":"",s=t.host||"";return(t.protocol||t[DL]?(t.protocol||"")+"//":"")+i+s+e+n+r}const bse=/\/([^/]+)$/;function kse(t="",e){const{pathname:n}=OL(t),r=n.match(bse);
return r?r[1]:void 0}var Ko;const jt=Be.getChild("ProjectsManager");function Cc(t){return ot.isUri(t)?t.toString():typeof t=="string"?t.startsWith("file://")?t:ot.file(t).toString():t.uri.toString()}const _se=Tw("/",!0),ML=(t,e)=>_se(PS(t.path),PS(e.path));function CS(t){const e=Cc(t);return n=>e.startsWith(n.folder)}function av(t){return t=Cc(t),sv(t)}const is={id:"default",config:{name:"default",exclude:["**/node_modules/**"]},exclude:SS("**/node_modules/**",{dot:!0}),includeConfig:{paths:[],maxDepth:3,
fileThreshold:30}};class Zo{services;static DefaultProjectId=is.id;#e=void 0;#t=void 0;#n=new sF;#r=[];#i=new aF(e=>{if(e===Ko.DefaultProjectId){const n=av(this.getWorkspaceFolder());return{id:e,config:is.config,folder:n,folderUri:ot.parse(n),exclude:is.exclude,includeConfig:is.includeConfig}}return mr(this.#r.find(n=>n.id===e),`Project ${e} not found`)});#s=new WeakMap;constructor(e){this.services=e,jt.debug`created`}get defaultProjectId(){if(this.#e)return this.#e;if(!(this.#r.length>1))return this.#r[0]?.
id??Ko.DefaultProjectId}set defaultProjectId(e){if(e!==this.#e){if(this.#t=void 0,!e||e===Ko.DefaultProjectId){jt.debug`reset default project ID`,this.#e=void 0;return}An(this.#r.find(n=>n.id===e),`Project "${e}" not found`),jt.debug`set default project ID to ${e}`,this.#e=e}}get default(){if(!this.#t){const e=this.defaultProjectId??Ko.DefaultProjectId;this.#t=this.#i.get(e)}return this.#t}get all(){if(xn(this.#r,1)){const e=[...It(this.#r,_i("id")),is.id];if(this.#e){const n=e.findIndex(r=>r===
this.#e);if(n>0){const[r]=e.splice(n,1);return[r,...e]}}return e}return[is.id]}getProject(e){const n=typeof e=="string"?e:e.likec4ProjectId||this.belongsTo(e),r=this.#i.get(n);return{id:n,folderUri:r.folderUri,config:r.config,...r.includePaths&&{includePaths:It(r.includePaths,_i("uri"))}}}findAllProjectsByFolder(e){const n=av(e),r=i=>i.folder.startsWith(n)||n.startsWith(i.folder);return this.#r.filter(r)}ensureProjectId(e){return e===Ko.DefaultProjectId?this.defaultProjectId??Ko.DefaultProjectId:
e?(An(this.#n.has(e),`Project ID ${e} is not registered`),e):mr(this.defaultProjectId,()=>`Specify exact project, known: [${[...this.#n.keys()].join(", ")}]`)}ensureProject(e){return e=this.ensureProjectId(e),this.getProject(e)}hasMultipleProjects(){return this.#r.length>1}isExcluded(e){if(typeof e=="string"||ot.isUri(e)){let r=Cc(e);const i=this.findProjectForDocument(r);if(!i.exclude)return!1;const s=yse(r);return i.exclude(s)}let n=this.#s.get(e);return n===void 0&&(n=this.isExcluded(e.uri),this.#s.
set(e,n)),n}isIncluded(e,n){if(typeof n!="string"&&!ot.isUri(n))return this.isIncluded(e,n.uri);if(this.belongsTo(n)===e)return!this.isExcluded(n);let r=this.#i.get(e)?.includePaths;return r?r.some(CS(n)):!1}isConfigFile(e){const n=kse(e.toString())?.toLowerCase(),r=!!n&&Hc(n);return r&&is.exclude(e.path)?(jt.debug`exclude config file ${e.path}`,!1):r}async registerConfigFile(e,n){if(is.exclude(e.path))throw new Error(`Path to ${e.fsPath} is excluded by: ${is.config.exclude.join(", ")}`);if(!this.
isConfigFile(e))throw new Error(`${e.fsPath} is not a valid LikeC4 config filename.`);try{const r=await this.services.workspace.FileSystemProvider.loadProjectConfig(e),i=Go(e.path,".."),s=e.with({path:i});return await this.registerProject({config:r,folderUri:s},n)}catch(r){if(!da(r))throw this.services.lsp.Connection?.window.showErrorMessage(`LikeC4: Failed to register project at ${e.fsPath}`),oA(r,`Failed to register project config ${e.fsPath}:
`);return Promise.reject(r)}}async registerProject(e,n){const r=s0(e.config),i=av(e.folderUri);let s=this.#r.find(l=>l.folder===i);if(s&&nS(s.config,r))return s;let a=!1,o;if(s){a=!0,s.config.name!==r.name?(this.#n.delete(s.id),jt.info`unregister project ${s.id} folder: ${i}`,o=this.uniqueProjectId(r.name),s.id=o,jt.info`re-register project ${s.id} folder: ${i}`):(o=s.id,jt.info`update project ${s.id} on config change`),s.config=r;const l=o0(r.include);s.includeConfig=l}else{this.#n.has(r.name)&&
jt.warn`Project "${r.name}" already exists, generating unique ID`,o=this.uniqueProjectId(r.name);const l=o0(r.include);s={id:o,config:r,folder:i,folderUri:ot.parse(i),includeConfig:l},a=this.#r.some(c=>c.folder.startsWith(i)||i.startsWith(c.folder)),this.#r=at([...this.#r,s],Gm((c,u)=>ML(c.folderUri,u.folderUri))),jt.info`register project ${s.id} folder: ${i}`}if(Gt(r.exclude))s.exclude=is.exclude;else if(xn(r.exclude,1)){const l=It(r.exclude,c=>(!iv(c)&&!c.startsWith("**")&&(c=Hp("**",c)),fse(Go(
s.folderUri.path,c))));s.exclude=SS(l,{contains:!0,dot:!0})}if(s.includeConfig.paths&&xn(s.includeConfig.paths,1)){s.includePaths=It(s.includeConfig.paths,l=>{const c=Go(s.folderUri.path,l),u=s.folderUri.with({path:c});return{uri:u,folder:av(u)}}),jt.debug`project ${s.id} include paths: ${s.includePaths.map(l=>l.uri.fsPath).join(", ")}`;for(const l of s.includePaths)for(const c of this.#r)if(c.id!==s.id&&((l.folder.startsWith(c.folder)||c.folder.startsWith(l.folder))&&(a=!0,jt.warn('Project "{pr\
ojectId}" include path "{includePath}" overlaps with project "{otherProjectId}" folder. Files in overlapping areas will only belong to one project.',{projectId:s.id,includePath:l.folder,otherProjectId:c.id})),c.includePaths))for(const u of c.includePaths)(l.folder.startsWith(u.folder)||u.folder.startsWith(l.folder))&&(a=!0,jt.warn('Project "{projectId}" include path "{includePath}" overlaps with project "{otherProjectId}" include path "{otherIncludePath}". Files in overlapping areas will only be\
long to one project.',{projectId:s.id,includePath:l.folder,otherProjectId:c.id,otherIncludePath:u.folder}))}else delete s.includePaths;return this.#t=void 0,this.#n.set(s.id,i),this.#i.clear(),a&&!this.#a&&await this.rebuidProject(s.id,n).catch(l=>da(l)?Promise.reject(l):(jt.warn("Failed to rebuild project {projectId} after config change",{projectId:s.id,error:l}),Promise.resolve())),s}belongsTo(e){if(ot.isUri(e)||typeof e=="string"){const n=Cc(e);return this.findProjectForDocument(n).id}return this.
documentBelongsTo.get(e,()=>this.findProjectForDocument(Cc(e.uri))).id}#a=null;async reloadProjects(e){return this.#a?(jt.debug`reload projects is already in progress, waiting`,await this.#a.catch(()=>{})):(jt.debug`schedule reload projects`,this.#a=Promise.resolve().then(()=>this._reloadProjects(e)).catch(n=>(da(n)||jt.warn("Failed to reload projects",{error:n}),Promise.reject(n))).finally(()=>{this.#a=null}),await this.#a)}async _reloadProjects(e){const n=this.services.workspace.WorkspaceManager.
workspaceFolders;if(!n){jt.warn("No workspace folders found");return}jt.debug`start reload projects`;const r=[];for(const i of n)try{jt.debug`scan projects in folder ${i.uri}`;const s=await this.services.workspace.FileSystemProvider.scanProjectFiles(ot.parse(i.uri));for(const a of s)a.isFile&&this.isConfigFile(a.uri)&&(jt.debug`found config ${a.uri.fsPath}`,r.push(a.uri))}catch(s){jt.error("Failed to scanProjectFiles, {folder}",{folder:i.uri,error:s})}r.length===0&&this.#r.length!==0&&jt.warning(
"No config files found, but some projects were registered before"),r.sort(ML),this.#r=[],this.#n.clear(),this.#i.clear();for(const i of r){if(e?.isCancellationRequested)break;await this.registerConfigFile(i,e).catch(s=>{da(s)||jt.warn(rt(s))})}if(this.reset(),e?.isCancellationRequested)throw Xu;await this.services.workspace.WorkspaceManager.rebuildAll(e)}uniqueProjectId(e){let n=e,r=1;for(;this.#n.has(n);)n=`${e}-${r++}`;return n}reset(){jt.debug("reset"),this.#t=void 0,this.#e&&!this.#n.has(this.#e)&&
(this.#e=void 0),this.services.workspace.LangiumDocuments.resetProjectIds(),this.documentBelongsTo.clear(),this.mappingsToProject.clear(),this.#i.clear(),this.#s=new WeakMap}async rebuidProject(e,n){this.#t=void 0;const r=this.#r.find(c=>c.id===e)??this.default;r.id!==e&&jt.warn`Project ${e} not found, rebuilding default project ${r.id}`;const i=jt.getChild(r.id),s=r.folder,a=r.includePaths,o=this.services.workspace.LangiumDocuments.allKnownDocuments.filter(c=>!Fs(c.uri)).toArray();if(o.length===
0)return;const l=at(o,nt(c=>{if(r.exclude?.(c.uri.path))return!1;const u=Cc(c.uri);if(u.startsWith(s)||a&&a.some(CS(u)))return!0;const d=sv(Go(u,".."));return d.startsWith(s)||s.startsWith(d)}),It(c=>c.uri));if(l.length===0){i.debug("no documents in project, skipping rebuild");return}i.info("rebuild project documents: {docs}",{docs:l.length}),this.reset(),await this.services.workspace.DocumentBuilder.update(l,[],n).catch(c=>{i.warn("Failed to rebuild project",{error:c})})}findProjectForDocument(e){
return this.mappingsToProject.get(e,()=>{const n=CS(e);return this.#r.find(n)||(this.#r.find(({includePaths:i})=>!!i&&i.some(n))??this.default)})}get mappingsToProject(){return _h(this,"_mappingsToProject",()=>new jl(this.services))}get documentBelongsTo(){return _h(this,"_documentBelongsTo",()=>new jl(this.services))}getAllIncludePaths(){const e=[];for(const n of this.#r)if(n.includePaths)for(const r of n.includePaths)e.push({projectId:n.id,includePath:r.uri,includeConfig:n.includeConfig});return e}getWorkspaceFolder(){
try{return this.services.workspace.WorkspaceManager.workspaceUri}catch(e){return jt.warn("Failed to get workspace URI, using default folder",{error:e}),ot.file("/")}}}Ko=Zo;class Rse extends ZC{services;documentFactory;fileSystemProvider;initialBuildOptions={eagerLinking:!0,validation:!0};constructor(e){super(e),this.services=e,this.documentFactory=e.workspace.LangiumDocumentFactory,this.fileSystemProvider=e.workspace.FileSystemProvider}async performStartup(e){this.folders??=e;const n=[];for(const i of e)
try{const s=ot.parse(i.uri),a=await this.fileSystemProvider.scanProjectFiles(s);n.push(...a),this.services.workspace.FileSystemWatcher.watch(s.fsPath)}catch(s){ct(s)}const r=this.services.workspace.ProjectsManager;for(const i of n)try{await r.registerConfigFile(i.uri,Pe.CancellationToken.None)}catch(s){ct(s)}return await super.performStartup(e)}async loadAdditionalDocuments(e,n){n(this.documentFactory.fromString(NN,ot.parse(V8)));const r=this.services.workspace.ProjectsManager.getAllIncludePaths();
let i=0;for(const{projectId:s,includePath:a,includeConfig:o}of r)try{Be.debug`scanning include path ${a.fsPath} for project ${s}`;const l=await this.fileSystemProvider.readDirectory(a,{recursive:!0,maxDepth:o.maxDepth});let c=0;for(const u of l)if(u.isFile&&!this.services.workspace.ProjectsManager.isExcluded(u.uri)){const d=await this.documentFactory.fromUri(u.uri);n(d),c++,i++}Be.debug`loaded ${c} files from include path ${a.fsPath}`}catch(l){ct(l)}if(r.length>0&&i>0){const s=Math.min(...r.map(
a=>a.includeConfig.fileThreshold));i>s?Be.warn(`Loaded ${i} files from include paths (threshold: ${s}). Large include directories may slow workspace initialization. Consider adjusting "include.fileThreshold" or "include.maxDepth" in your project configuration.`):Be.info`loaded ${i} total files from ${r.length} include paths`}await super.loadAdditionalDocuments(e,n)}includeEntry(e,n,r){return this.services.workspace.ProjectsManager.isConfigFile(n.uri)?!1:n.isFile?!this.services.workspace.ProjectsManager.
isExcluded(n.uri):super.includeEntry(e,n,r)}workspace(){return this.folders&&xn(this.folders,1)?this.folders[0]:null}async rebuildAll(e){const n=this.services.workspace.LangiumDocuments.all.map(r=>r.uri).toArray();Be.info("invalidate and rebuild all {docs} documents",{docs:n.length}),this.services.workspace.Cache.clear(),await this.documentBuilder.update(n,[],e)}get workspaceUri(){const e=this.workspace();return Ke(e,"Workspace not initialized"),ot.parse(e.uri)}get workspaceURL(){const e=this.workspace();
return Ke(e,"Workspace not initialized"),new URL(e.uri)}}const ov=Be.getChild("LanguageServices");class Sse{services;builder;editor;projectsManager;constructor(e){this.services=e,this.builder=e.likec4.ModelBuilder,this.projectsManager=e.shared.workspace.ProjectsManager,this.editor=e.likec4.ModelChanges}get views(){return this.services.likec4.Views}get workspaceUri(){return this.services.shared.workspace.WorkspaceManager.workspaceUri}projects(){const e=this.services.shared.workspace.ProjectsManager,
n=at(this.services.shared.workspace.LangiumDocuments.groupedByProject(),Wm(),It(([a,o])=>{const l=a,{folderUri:c,config:u}=e.getProject(l);return{id:l,folder:c,title:u.title??u.name,documents:It(o,_i("uri")),config:u}}));if(xn(n,2)&&e.defaultProjectId){const a=n.findIndex(o=>o.id===e.defaultProjectId);if(a>0){const[o]=n.splice(a,1);return[o,...n]}return n}if(xn(n,1))return n;const{folderUri:r,config:i}=e.getProject(Zo.DefaultProjectId),s=It(this.services.shared.workspace.LangiumDocuments.projectDocuments(
Zo.DefaultProjectId).toArray(),_i("uri"));return[{id:Zo.DefaultProjectId,folder:r,title:i.title??i.name,documents:s,config:i}]}project(e){e=this.projectsManager.ensureProjectId(e);const n=this.services.shared.workspace.ProjectsManager,{folderUri:r,config:i}=n.getProject(e),s=It(this.services.shared.workspace.LangiumDocuments.projectDocuments(e).toArray(),_i("uri"));return{id:e,folder:r,title:i.title??i.name,documents:s,config:i}}async diagrams(e,n){const r=this.projectsManager.ensureProjectId(e);
return await this.views.diagrams(r,n)}async computedModel(e,n){const r=this.projectsManager.ensureProjectId(e);return await this.builder.computeModel(r,n)}async layoutedModel(e,n){const r=this.projectsManager.ensureProjectId(e),i=await this.builder.computeModel(r,n);if(!i)throw new Error("Failed to compute model, empty project?");const s=await this.views.layoutAllViews(r,n);return qi.create({...i.$data,_stage:"layouted",views:at(s,It(_i("diagram")),td(_i("id")))})}async projectsOverview(e){const n=this.
services.shared.workspace.ProjectsManager.all,r=[];for(const s of n){const a=await this.builder.computeModel(s,e);if(e?.isCancellationRequested)throw new Error("Operation cancelled");if(a===qi.EMPTY){ov.debug(`Project ${s} is empty, skipping`);continue}r.push(a)}if(!xn(r,1))throw new Error("No models found");const i=$F(r);return await this.views.layouter.layoutProjectsView(i)}getErrors(){return this.services.shared.workspace.LangiumDocuments.allExcludingBuiltin.toArray().flatMap(e=>(e.diagnostics??
[]).filter(n=>n.severity===so.Error).map(({message:n,range:r})=>({message:n,line:r.start.line,range:r,sourceFsPath:e.uri.fsPath})))}locate(e){switch(!0){case"element"in e:return this.services.likec4.ModelLocator.locateElement(e.element,e.projectId);case"relation"in e:return this.services.likec4.ModelLocator.locateRelation(e.relation,e.projectId);case"view"in e:return this.services.likec4.ModelLocator.locateView(e.view,e.projectId);case"deployment"in e:return this.services.likec4.ModelLocator.locateDeploymentElement(
e.deployment,e.projectId);default:ht(e)}}async dispose(){try{ov.debug("disposing LikeC4LanguageServices"),await this.services.shared.workspace.FileSystemWatcher.dispose(),this.services.mcp.Server.isStarted&&await this.services.mcp.Server.stop(),this.services.Rpc.dispose(),this.services.likec4.ModelBuilder.dispose()}catch(e){ov.error(rt(e))}finally{ov.debug("LikeC4LanguageServices disposed")}}}const jL=t=>Number.isFinite(t)?t:0;function $se(t){return{days:Math.trunc(t/864e5),hours:Math.trunc(t/36e5%
24),minutes:Math.trunc(t/6e4%60),seconds:Math.trunc(t/1e3%60),milliseconds:Math.trunc(t%1e3),microseconds:Math.trunc(jL(t*1e3)%1e3),nanoseconds:Math.trunc(jL(t*1e6)%1e3)}}function Tse(t){return{days:t/86400000n,hours:t/3600000n%24n,minutes:t/60000n%60n,seconds:t/1000n%60n,milliseconds:t%1000n,microseconds:0n,nanoseconds:0n}}function Ese(t){switch(typeof t){case"number":{if(Number.isFinite(t))return $se(t);break}case"bigint":return Tse(t)}throw new TypeError("Expected a finite number or bigint")}
const Pse=t=>t===0||t===0n,Cse=(t,e)=>e===1||e===1n?t:`${t}s`,xse=1e-7,Ase=24n*60n*60n*1000n;function qL(t,e){const n=typeof t=="bigint";if(!n&&!Number.isFinite(t))throw new TypeError("Expected a finite number or bigint");e={...e};const r=t<0?"-":"";t=t<0?-t:t,e.colonNotation&&(e.compact=!1,e.formatSubMilliseconds=!1,e.separateMilliseconds=!1,e.verbose=!1),e.compact&&(e.unitCount=1,e.secondsDecimalDigits=0,e.millisecondsDecimalDigits=0);let i=[];const s=(u,d)=>{const f=Math.floor(u*10**d+xse);return(Math.
round(f)/10**d).toFixed(d)},a=(u,d,f,p)=>{if(!((i.length===0||!e.colonNotation)&&Pse(u)&&!(e.colonNotation&&f==="m"))){if(p??=String(u),e.colonNotation){const m=p.includes(".")?p.split(".")[0].length:p.length,w=i.length>0?2:1;p="0".repeat(Math.max(0,w-m))+p}else p+=e.verbose?" "+Cse(d,u):f;i.push(p)}},o=Ese(t),l=BigInt(o.days);if(e.hideYearAndDays?a(BigInt(l)*24n+BigInt(o.hours),"hour","h"):(e.hideYear?a(l,"day","d"):(a(l/365n,"year","y"),a(l%365n,"day","d")),a(Number(o.hours),"hour","h")),a(Number(
o.minutes),"minute","m"),!e.hideSeconds)if(e.separateMilliseconds||e.formatSubMilliseconds||!e.colonNotation&&t<1e3&&!e.subSecondsAsDecimals){const u=Number(o.seconds),d=Number(o.milliseconds),f=Number(o.microseconds),p=Number(o.nanoseconds);if(a(u,"second","s"),e.formatSubMilliseconds)a(d,"millisecond","ms"),a(f,"microsecond","\xB5s"),a(p,"nanosecond","ns");else{const m=d+f/1e3+p/1e6,w=typeof e.millisecondsDecimalDigits=="number"?e.millisecondsDecimalDigits:0,v=m>=1?Math.round(m):Math.ceil(m),g=w?
m.toFixed(w):v;a(Number.parseFloat(g),"millisecond","ms",g)}}else{const u=(n?Number(t%Ase):t)/1e3%60,d=typeof e.secondsDecimalDigits=="number"?e.secondsDecimalDigits:1,f=s(u,d),p=e.keepDecimalsOnWholeSeconds?f:f.replace(/\.0+$/,"");a(Number.parseFloat(p),"second","s",p)}if(i.length===0)return r+"0"+(e.verbose?" milliseconds":"ms");const c=e.colonNotation?":":" ";return typeof e.unitCount=="number"&&(i=i.slice(0,Math.max(e.unitCount,1))),r+i.join(c)}class xS{toDispose=[];isDisposed=!1;onDispose(...e){
this.toDispose.push(...e)}dispose(){this.throwIfDisposed(),this.isDisposed=!0;let e;for(;e=this.toDispose.pop();)try{e.dispose()}catch(n){ct(n)}}throwIfDisposed(){if(this.isDisposed)throw new Error("This has already been disposed")}}function xa(t){try{let e=H_(t)?t.el.ref:t.modelElement.value.ref;return e?.$type==="Imported"&&(e=e.imported.ref),e?.$type==="Element"?e:void 0}catch{return}}function Jo(t){const e=[t.$type==="StrictFqnRef"?t.value.$refText:t.el.$refText];let n=t.parent;for(;n;)e.push(
n.$type==="StrictFqnRef"?n.value.$refText:n.el.$refText),n=n.parent;return e.length===1?e[0]:e.reverse().join(".")}function Ise(t){for(;t.parent;)t=t.parent;return t.value.ref??null}function Nse(t){let e;for(;e=t.value?.ref;){if(ur(e))return null;if($r(e))return e;if(Gt(t.parent))return null;t=t.parent}return null}function Dse(t){const e=Ise(t);return e?.$type==="Imported"?e:null}function Ose(t){let e;for(;e=t.value?.ref;){if(sg(e))return!0;if(Gt(t.parent))return!1;t=t.parent}return!1}function wn(t){
if(Xi(t)){for(;t.$type==="Imported"&&t.$container;)t=t.$container;Ke(ec(t))}if(ec(t))return t.project;const e=Xt(t)?$t(t):t;return di(e.likec4ProjectId,()=>`Invalid state, document ${e.uri} has no project ID assigned`)}function ss(...t){var e=t.length>1?t.join(":::"):t[0];return oF(e)}function Vp(t){try{return t()}catch(e){Be.debug("Safe call failed",{error:e});return}}function AS(){try{return performance.now()}catch{return Date.now()}}function lv(){const t=AS();return{get ms(){return AS()-t},get pretty(){
return qL(AS()-t)}}}class Lse{services;constructor(e){this.services=e}async provideCodeLens(e,n,r){return ns(e)?(e.state<Ve.Linked&&(Be.debug(`Waiting for document ${e.uri.path} to be Linked`),await this.services.shared.workspace.DocumentBuilder.waitUntil(Ve.Linked,e.uri,r),Be.debug("Document is linked")),e.parseResult.value.views.flatMap(i=>i.views).flatMap(i=>{const s=Qy.readId(i),a=i.$cstNode?.range;if(!a||!s)return[];const o=wn(i);return{range:{start:a.start,end:{line:a.start.line,character:a.
start.character+4}},command:{command:"likec4.open-preview",arguments:[s,o],title:"open preview"}}})):void 0}}const IS=["color","shape","icon","border","opacity","multiple","size","textSize"].join(",");function Mse(t,e){return zi(e.feature)&&e.property==="project"&&ec(t.node)}class jse extends LI{services;constructor(e){super(e),this.services=e}completionOptions={triggerCharacters:[".","#"]};completionFor(e,n,r){switch(!0){case Xr(n.feature):return this.completionForKeyword(e,n.feature,r);case(Za(
n.feature)&&!!e.node):return this.completionForCrossReference(e,n,r);case Mse(e,n):return this.completionForImportedProject(e,r)}}completionForKeyword(e,n,r){if(this.filterKeyword(e,n))switch(!0){case n.value==="import":r(e,{label:n.value,kind:Lt.Snippet,insertTextFormat:Dn.Snippet,insertText:`${n.value} { $0 } from '\${1|${this.services.shared.workspace.ProjectsManager.all.join(",")}|}'`});break;case(n.value==="deployment"&&pi(e.node,bf)):r(e,{label:n.value,detail:"Insert deployment view",kind:Lt.
Class,insertTextFormat:Dn.Snippet,insertText:["deployment view ${1:view_${TM_FILENAME_BASE}_${CURRENT_SECOND}} {","	title '${2:Untitled}'","	","	include $0","}"].join(`
`)});break;case["title","description","technology","link"].includes(n.value):r(e,{label:n.value,detail:`Insert ${n.value} property`,kind:Lt.Property,insertTextFormat:Dn.Snippet,insertText:`${n.value} '\${0}'`});break;case n.value==="color":r(e,{label:n.value,kind:Lt.Property,insertTextFormat:Dn.Snippet,insertText:`${n.value} \${1|${_F.join(",")}|}$0`});break;case n.value==="opacity":r(e,{label:n.value,kind:Lt.Property,insertTextFormat:Dn.Snippet,insertText:`${n.value} \${0:100}%`});break;case["v\
iews","specification","model","deployment","with"].includes(n.value):r(e,{label:n.value,detail:`Insert ${n.value} block`,kind:Lt.Module,insertTextFormat:Dn.Snippet,insertText:`${n.value} {
	$0
}`});break;case n.value==="group":r(e,{label:n.value,detail:"Insert group block",kind:Lt.Module,insertTextFormat:Dn.Snippet,insertText:["group '${1:Title}' {","	$0","}"].join(`
`)});break;case["par","parallel"].includes(n.value):r(e,{label:n.value,detail:"Insert block of parallel steps",kind:Lt.Module,insertTextFormat:Dn.Snippet,insertText:[`${n.value} {`,"	$0","}"].join(`
`)});break;case(n.value==="dynamic"&&pi(e.node,bf)):r(e,{label:n.value,detail:"Insert dynamic view",kind:Lt.Class,insertTextFormat:Dn.Snippet,insertText:["dynamic view ${1:view_${TM_FILENAME_BASE}_${CURRENT_SECOND}} {","	title '${2:Untitled}'","	","	$0","}"].join(`
`)});break;case(n.value==="style"&&e.node&&pi(e.node,Ql)):r(e,{label:n.value,detail:`Insert ${n.value} block`,kind:Lt.Module,insertTextFormat:Dn.Snippet,insertText:`${n.value} \${1:name} \${2:*} {
	\${3|${IS}|} $0
}`});break;case(n.value==="style"&&e.node&&pi(e.node,f3([bf,No]))):r(e,{label:n.value,detail:`Insert ${n.value} block`,kind:Lt.Module,insertTextFormat:Dn.Snippet,insertText:`${n.value} \${1:*} {
	\${2|${IS}|} $0
}`});break;case n.value==="style":r(e,{label:n.value,detail:`Insert ${n.value} block`,kind:Lt.Module,insertTextFormat:Dn.Snippet,insertText:`${n.value} {
	\${1|${IS}|} $0
}`});break;case n.value==="extend":r(e,{label:n.value,detail:"Extend another view",kind:Lt.Class,insertTextFormat:Dn.Snippet,insertText:`extend $1 {
	$0
}`});break;case n.value==="autoLayout":r(e,{label:n.value,kind:Lt.Property,insertTextFormat:Dn.Snippet,insertText:"autoLayout ${1|TopBottom,BottomTop,LeftRight,RightLeft|}$0"});break;case n.value==="mode":r(e,{label:n.value,kind:Lt.Property,insertTextFormat:Dn.Snippet,insertText:"mode ${1|sequence,diagram|}$0"});break;case["include","exclude"].includes(n.value):r(e,{label:n.value,kind:Lt.Operator,detail:`Insert ${n.value} predicate`,insertTextFormat:Dn.PlainText,insertText:`${n.value} `});break;default:
r(e,{label:n.value,kind:this.getKeywordCompletionItemKind(n),detail:"Keyword",sortText:"1"})}}completionForImportedProject(e,n){const r=this.services.shared.workspace.ProjectsManager,i=e.document.textDocument,s={start:i.positionAt(e.tokenOffset),end:i.positionAt(e.tokenEndOffset)},a=i.getText(s),o=Nt(a)?"'":a.substring(0,1);for(const l of r.all){const c=o+l+o;n(e,{label:l,kind:Lt.Folder,insertText:c,filterText:c,textEdit:Rr.replace(s,c),detail:"Project",sortText:"0_"+l})}}}class qse extends MI{createDocumentHighlight(e){
return Pe.DocumentHighlight.create(e.segment.range,Pe.DocumentHighlightKind.Read)}}class Fse{services;constructor(e){this.services=e}async getDocumentLinks(e,n,r){return!ns(e)||this.services.shared.workspace.ProjectsManager.isExcluded(e)?[]:hi(e.parseResult.value).filter(mf).map(i=>{try{const s=Yn(i.$cstNode,"value")?.range,a=s&&this.resolveLink(e,i.value);if(a&&Pc(a))return{range:s,target:a}}catch(s){ct(s)}return null}).nonNullable().toArray()}resolveLink(e,n){if(Pc(n)||Up(n))return n;if(iv(n))
return Go(e.uri.toString(),"../",n);const r=this.services.shared.workspace.ProjectsManager.getProject(e).folderUri;return Go(r.toString(),n)}relativeLink(e,n){if(Up(n))return NL(n);if(iv(n)){const r=this.services.shared.workspace.ProjectsManager.getProject(e).folderUri.toString(),i=new URL(e.uri.toString()),s=new URL(n,i).toString();return NL(pse(s,r))}return null}}const FL=Be.getChild("DocumentSymbolProvider");class zse{services;nodeKindProvider;nameProvider;parser;locator;constructor(e){this.services=
e,this.nodeKindProvider=e.shared.lsp.NodeKindProvider,this.parser=e.likec4.ModelParser,this.locator=e.likec4.ModelLocator,this.nameProvider=e.references.NameProvider}async getSymbols(e,n,r){if(!ns(e)||this.services.shared.workspace.ProjectsManager.isExcluded(e))return[];e.state<Ve.Linked&&(FL.debug(`Waiting for document ${e.uri.path} to be Linked`),await this.services.shared.workspace.DocumentBuilder.waitUntil(Ve.Linked,e.uri,r),FL.debug("document is Linked"));const{parseResult:{value:{specifications:i,
models:s,deployments:a,views:o,likec4lib:l}}}=e;return[...l.map(c=>()=>this.getLikec4LibSymbol(c)),...i.map(c=>()=>this.getSpecSymbol(c)),...s.map(c=>()=>this.getModelSymbol(c)),...a.map(c=>()=>this.getDeploymentModelSymbol(c)),...o.map(c=>()=>this.getModelViewsSymbol(c))].flatMap(c=>{try{return c()??[]}catch(u){return ct(u),[]}})}getLikec4LibSymbol(e){const n=e?.$cstNode;if(!n)return[];const r=e.icons.map(i=>this.getLibIconSymbol(i)).filter(ke);return r.length===0?[]:[{kind:bi.Namespace,name:"i\
cons",range:n.range,selectionRange:Eu(n,"icons")?.range??n.range,children:r}]}getSpecSymbol(e){const n=e?.$cstNode;if(!n)return[];const r=Yn(n,"name");if(!r)return[];const i=at([...e.elements,...e.tags,...e.relationships],It(s=>{try{if(lc(s)||uc(s)||ac(s))return this.getKindSymbol(s);if(qf(s))return this.getTagSymbol(s)}catch(a){return ct(a),null}ht(s)}),nt(ke));return i.length===0?[]:[{kind:bi.Namespace,name:e.name,range:n.range,selectionRange:r.range,children:i}]}getModelSymbol(e){const n=e.$cstNode;
if(!n)return[];const r=Yn(n,"name");return r?[{kind:this.symbolKind(e),name:e.name,range:n.range,selectionRange:r.range,children:e.elements.flatMap(i=>Zl(i)?[]:this.getElementsSymbol(i))}]:[]}getDeploymentModelSymbol(e){const n=e.$cstNode;if(!n)return[];const r=Yn(n,"name");return r?[{kind:this.symbolKind(e),name:e.name,range:n.range,selectionRange:r.range,children:e.elements.flatMap(i=>this.getDeploymentElementSymbol(i))}]:[]}getElementsSymbol(e){try{if(Io(e))return this.getExtendElementSymbol(
e);if(Vn(e))return this.getElementSymbol(e)}catch(n){ct(n)}return[]}getExtendElementSymbol(e){const n=e.$cstNode,r=e.element.$cstNode,i=e.body;return!n||!r?[]:[{kind:this.symbolKind(e),name:Jo(e.element),range:n.range,selectionRange:r.range,children:i.elements.flatMap(s=>this.getElementsSymbol(s))}]}getElementSymbol(e){const n=e.$cstNode,r=Yn(n,"name");if(!r||!n)return[];const i=e.name,s=e.kind.$refText;return[{kind:this.symbolKind(e),name:i,range:n.range,selectionRange:r.range,detail:s,children:e.
body?.elements.flatMap(a=>this.getElementsSymbol(a))??[]}]}getModelViewsSymbol(e){const n=e.$cstNode,r=Yn(n,"name");return!r||!n?[]:[{kind:this.symbolKind(e),name:e.name,range:n.range,selectionRange:r.range,children:e.views.flatMap(i=>this.getViewSymbol(i))}]}getKindSymbol(e){return!e.$cstNode||!e.kind.$cstNode||Nt(e.kind.name)?null:{kind:this.symbolKind(e),name:e.kind.name,range:e.$cstNode.range,selectionRange:e.kind.$cstNode.range}}getTagSymbol(e){return!e.$cstNode||!e.tag.$cstNode||Nt(e.tag.name)?
null:{kind:this.symbolKind(e),name:"#"+e.tag.name,range:e.$cstNode.range,selectionRange:e.tag.$cstNode.range}}getLibIconSymbol(e){return!e.$cstNode||Nt(e.name)?null:{kind:this.symbolKind(e),name:e.name,range:e.$cstNode.range,selectionRange:e.$cstNode.range}}getViewSymbol(e){const n=e?.$cstNode;if(!n)return[];const r=e.name?Yn(n,"name"):null;return r?[{kind:this.symbolKind(e),name:r.text,range:n.range,selectionRange:r.range,children:[]}]:[]}getDeploymentElementSymbol(e){try{if(ur(e))return this.getDeploymentNodeSymbol(
e);if($r(e))return this.getDeployedInstanceSymbol(e);if(ga(e))return[]}catch(n){ct(n)}return[]}getDeploymentNodeSymbol(e){const n=e.$cstNode,r=this.nameProvider.getNameNode(e);if(!r||!n)return[];const i=this.nameProvider.getNameStrict(e),s=e.kind.$refText;return[{kind:this.symbolKind(e),name:i,range:n.range,selectionRange:r.range,detail:s,children:e.body?.elements.flatMap(a=>this.getDeploymentElementSymbol(a))??[]}]}getDeployedInstanceSymbol(e){const n=e.$cstNode,r=this.nameProvider.getNameNode(
e);if(!r||!n)return[];const i=$t(e),s=this.parser.forDocument(i).parseDeployedInstance(e),a=this.nameProvider.getNameStrict(e),o="instance of "+s.element.model;return[{kind:this.symbolKind(e),name:a,range:n.range,selectionRange:r.range,detail:o,children:[]}]}symbolKind(e){return this.nodeKindProvider.getSymbolKind(e)}}class Use extends zI{parser;locator;constructor(e){super(e),this.parser=e.likec4.ModelParser,this.locator=e.likec4.ModelLocator}getAstNodeHoverContent(e){if(Ff(e))return{contents:{
kind:"markdown",value:"tag `"+e.name+"`"}};if(ur(e)){const n=$t(e),r=this.parser.forDocument(n).parseDeploymentNode(e),i=[r.id+"  "];r.title!==e.name&&i.push(`### ${r.title}`),i.push("deployment node `"+r.kind+"` ");const s=X$(r);return s&&i.push("",s.md??s.txt),{contents:{kind:"markdown",value:i.join(`
`)}}}if($r(e)){const n=$t(e),r=this.parser.forDocument(n).parseDeployedInstance(e),[i,s]=Vt.isImportRef(r.element)?[r.element.project,r.element.model]:[n.likec4ProjectId,r.element.model],a=i?this.locator.getParsedElement(s,i):this.locator.getParsedElement(s),o=[r.id+"  ",`instance of \`${Vt.flatten(r.element)}\``];return a&&o.push(`### ${a.title}`,"element kind `"+a.kind+"` "),{contents:{kind:"markdown",value:o.join(`
`)}}}if(lN(e))return{contents:{kind:"markdown",value:"element kind `"+e.name+"`"}};if(b8(e))return{contents:{kind:"markdown",value:"deployment node `"+e.name+"`"}};if(vN(e))return{contents:{kind:"markdown",value:"relationship kind `"+e.name+"`"}};if(Vn(e)){const n=this.locator.getParsedElement(e);if(!n)return;const r=[n.id,`### ${n.title}`,"element kind `"+n.kind+"` "],i=X$(n);return i&&r.push("",i.md??i.txt),{contents:{kind:"markdown",value:r.join(`
`)}}}}}class Hse{getCodeActions(e,n){const r=n.context.diagnostics,i=[];for(const s of r)s.code==="manual-layout-v1"&&i.push({title:"Migrate Manual Layouts",command:Ji.Command.create("Migrate Manual Layouts","likec4.migrate-manual-layouts"),edit:{changes:{[e.textDocument.uri]:[Ji.TextEdit.insert(n.range.start,"")]}},kind:"quickfix",isPreferred:!0,diagnostics:[s]});return i.length>0?i:void 0}}const NS=Be.getChild("SemanticTokenProvider"),zL={...Om},UL={...gk};function DS(t){const e=[],n=new Proxy(
{},{get(r,i){if(i==="modifier")return s=>(e.push(s),n);if(i in UL)return e.push(UL[i]),n;if(i in zL)return()=>t(zL[i],e);throw new Error(`Unknown semantic token type or modifier: ${i}`)}});return n}const HL="Stop Highlighting",Yo=()=>{throw HL};class Vse extends FZ{services;rules=[];constructor(e){super(e),this.services=e,this.initRules()}initRules(){this.rules=[];const e=(n,r)=>{const i={predicate:n,highlightFn:r};this.rules.push(i)};e(vN,n=>{n.property("name").function()}),e(fi(Qi,yN,Si),n=>{n.
property("kind").function()}),e(T8,n=>{n.property("name").definition.function(),Yo()}),e(fi(ey,xf),n=>{n.property("value").readonly.definition.interface(),Yo()}),e(xN,n=>{n.cst().readonly.definition.variable(),Yo()}),e(Wg,n=>{n.node.selector&&(n.node.ref.parent?n.property("selector").property():n.property("selector").readonly.definition.variable())}),e(RN,n=>{n.cst().type(),Yo()}),e(I8,n=>{n.cst().function(),Yo()}),e(TN,n=>{ke(n.node.value)&&n.property("value").function()}),e(fi(eN,nN),n=>{ke(n.
node.value)&&n.property("value").readonly.definition.type()}),e(fi(PN,CN),n=>{n.property("participant").keyword()}),e(cN,n=>{ke(n.node.kind)&&n.property("kind").definition.type()}),e(fi(No,Ql),n=>{n.property("id").readonly.definition.variable()}),e(G_,n=>{n.property("style").readonly.definition.variable()}),e(fi(af,sf),n=>{n.property("name").readonly.definition.variable()}),e(W_,n=>{n.property("predicate").readonly.definition.variable()}),e(uN,n=>{ke(n.node.tag)&&n.property("tag").definition.type()}),
e(fi(fN,_N),n=>{n.node.parent?n.property("value").property():(n.property("value").readonly.definition.variable(),Yo())}),e(H_,n=>{n.node.parent?n.property("el").property():(n.property("el").readonly.definition.variable(),Yo())}),e(ly,n=>{n.keyword("color").keyword(),n.property("name").readonly.declaration.type()}),e(qf,n=>{ke(n.node.color)&&n.keyword("color").property()}),e(fi(lc,uc,ac),n=>{n.property("kind").readonly.declaration.type()}),e(Ff,n=>{n.property("name").definition.type()}),e(ty,n=>{
n.property("value").number()}),e(Do,n=>{if(n.node.libicon||n.node.value==="none"){n.property(n.node.libicon?"libicon":"value").defaultLibrary.enum();return}n.property("value").string()}),e(mf,n=>{ke(n.node.value)&&n.property("value").string()}),e(Co,n=>{ke(n.node.customColor)&&n.property("customColor").enum(),ke(n.node.themeColor)&&n.property("themeColor").enum()}),e(fi(ay,Md,pf,_g,d8,E_),n=>{ke(n.node.value)&&n.property("value").enum()})}async semanticHighlight(e,n,r=Ji.CancellationToken.None){
return e.state<Ve.Linked&&await this.ensureState(e,r),await super.semanticHighlight(e,n,r)}async semanticHighlightRange(e,n,r=Ji.CancellationToken.None){return e.state<Ve.Linked&&await this.ensureState(e,r),await super.semanticHighlightRange(e,n,r)}async semanticHighlightDelta(e,n,r=Ji.CancellationToken.None){return e.state<Ve.Linked&&await this.ensureState(e,r),await super.semanticHighlightDelta(e,n,r)}async ensureState(e,n){e.state<Ve.Linked&&(NS.debug`waiting for document ${e.uri.path} to be ${"\
Linked"}`,await this.services.shared.workspace.DocumentBuilder.waitUntil(Ve.Linked,e.uri,n),NS.debug`document ${e.uri.path} is ${"Linked"}`)}highlightElement(e,n){if(fi(Vn,ur,$r)(e))return this.highlightNameAndKind(e);if(b_(e))return this.highlightView(e);i8(e)&&!fi(Yi,Xd,sy)(e)&&ke(e.key)&&n({node:e,property:"key",type:Om.property});let r;for(const{predicate:i,highlightFn:s}of this.rules)if(i(e))try{r??=this.mark(e),s(r)}catch(a){if(a===HL)return"prune";NS.warn(`Error highlighting node of type ${e.
_type}`,{error:a})}}highlightNameAndKind(e){if(this.mark(e).property("name").declaration.readonly.variable(),$r(e)||this.mark(e).property("kind").keyword(),Vn(e)){e.props.length>0&&this.mark(e).property("props").string();return}e.title&&this.mark(e).property("title").string()}highlightView(e){e.name&&this.mark(e).property("name").modifier("local").declaration.readonly.interface()}mark(e){return{node:e,cst:n=>DS((r,i)=>this.highlightToken({range:mr(n??e.$cstNode,"AST node has no CST node").range,
type:r,modifier:i})),keyword:n=>DS((r,i)=>this.highlightKeyword({node:e,keyword:n,type:r,modifier:i})),property:(n,r)=>DS((i,s)=>this.highlightProperty({node:e,property:n,type:i,modifier:s,...r!==void 0?{index:r}:{}}))}}}class Bse{get mcp(){throw new Error("NoopLikeC4MCPServer does not have a McpServer")}get isStarted(){return!1}get port(){return NaN}start(){return Promise.resolve()}stop(){return Promise.resolve()}}const VL={mcpServer:()=>new Bse};var wt;(function(t){t.assertEqual=i=>{};function e(i){}
t.assertIs=e;function n(i){throw new Error}t.assertNever=n,t.arrayToEnum=i=>{const s={};for(const a of i)s[a]=a;return s},t.getValidEnumValues=i=>{const s=t.objectKeys(i).filter(o=>typeof i[i[o]]!="number"),a={};for(const o of s)a[o]=i[o];return t.objectValues(a)},t.objectValues=i=>t.objectKeys(i).map(function(s){return i[s]}),t.objectKeys=typeof Object.keys=="function"?i=>Object.keys(i):i=>{const s=[];for(const a in i)Object.prototype.hasOwnProperty.call(i,a)&&s.push(a);return s},t.find=(i,s)=>{
for(const a of i)if(s(a))return a},t.isInteger=typeof Number.isInteger=="function"?i=>Number.isInteger(i):i=>typeof i=="number"&&Number.isFinite(i)&&Math.floor(i)===i;function r(i,s=" | "){return i.map(a=>typeof a=="string"?`'${a}'`:a).join(s)}t.joinValues=r,t.jsonStringifyReplacer=(i,s)=>typeof s=="bigint"?s.toString():s})(wt||(wt={}));var BL;(function(t){t.mergeShapes=(e,n)=>({...e,...n})})(BL||(BL={}));const Ce=wt.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint",
"symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Aa=t=>{switch(typeof t){case"undefined":return Ce.undefined;case"string":return Ce.string;case"number":return Number.isNaN(t)?Ce.nan:Ce.number;case"boolean":return Ce.boolean;case"function":return Ce.function;case"bigint":return Ce.bigint;case"symbol":return Ce.symbol;case"object":return Array.isArray(t)?Ce.array:t===null?Ce.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="fu\
nction"?Ce.promise:typeof Map<"u"&&t instanceof Map?Ce.map:typeof Set<"u"&&t instanceof Set?Ce.set:typeof Date<"u"&&t instanceof Date?Ce.date:Ce.object;default:return Ce.unknown}},ve=wt.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class Zs extends Error{get errors(){
return this.issues}constructor(e){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=e}format(e){const n=e||function(s){return s.message},r={_errors:[]},i=s=>{for(const a of s.issues)if(a.code==="invalid_union")a.unionErrors.map(i);else if(a.code==="invalid_return_type")i(a.returnTypeError);else if(a.
code==="invalid_arguments")i(a.argumentsError);else if(a.path.length===0)r._errors.push(n(a));else{let o=r,l=0;for(;l<a.path.length;){const c=a.path[l];l===a.path.length-1?(o[c]=o[c]||{_errors:[]},o[c]._errors.push(n(a))):o[c]=o[c]||{_errors:[]},o=o[c],l++}}};return i(this),r}static assert(e){if(!(e instanceof Zs))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,wt.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===
0}flatten(e=n=>n.message){const n={},r=[];for(const i of this.issues)if(i.path.length>0){const s=i.path[0];n[s]=n[s]||[],n[s].push(e(i))}else r.push(e(i));return{formErrors:r,fieldErrors:n}}get formErrors(){return this.flatten()}}Zs.create=t=>new Zs(t);const OS=(t,e)=>{let n;switch(t.code){case ve.invalid_type:t.received===Ce.undefined?n="Required":n=`Expected ${t.expected}, received ${t.received}`;break;case ve.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(t.expected,wt.jsonStringifyReplacer)}`;
break;case ve.unrecognized_keys:n=`Unrecognized key(s) in object: ${wt.joinValues(t.keys,", ")}`;break;case ve.invalid_union:n="Invalid input";break;case ve.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${wt.joinValues(t.options)}`;break;case ve.invalid_enum_value:n=`Invalid enum value. Expected ${wt.joinValues(t.options)}, received '${t.received}'`;break;case ve.invalid_arguments:n="Invalid function arguments";break;case ve.invalid_return_type:n="Invalid function return t\
ype";break;case ve.invalid_date:n="Invalid date";break;case ve.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(n=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?n=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?n=`Invalid input: must end with "${t.validation.endsWith}"`:wt.
assertNever(t.validation):t.validation!=="regex"?n=`Invalid ${t.validation}`:n="Invalid";break;case ve.too_small:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="bi\
gint"?n=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:n="Invalid input";break;case ve.too_big:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?
"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?n=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:n="Invalid input";break;case ve.custom:n="Invalid input";break;case ve.invalid_intersection_types:
n="Intersection results could not be merged";break;case ve.not_multiple_of:n=`Number must be a multiple of ${t.multipleOf}`;break;case ve.not_finite:n="Number must be finite";break;default:n=e.defaultError,wt.assertNever(t)}return{message:n}};let Wse=OS;function Gse(){return Wse}const Kse=t=>{const{data:e,path:n,errorMaps:r,issueData:i}=t,s=[...n,...i.path||[]],a={...i,path:s};if(i.message!==void 0)return{...i,path:s,message:i.message};let o="";const l=r.filter(c=>!!c).slice().reverse();for(const c of l)
o=c(a,{data:e,defaultError:o}).message;return{...i,path:s,message:o}};function Te(t,e){const n=Gse(),r=Kse({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,n,n===OS?void 0:OS].filter(i=>!!i)});t.common.issues.push(r)}class pr{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,n){const r=[];for(const i of n){if(i.status==="aborted")return We;i.status===
"dirty"&&e.dirty(),r.push(i.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,n){const r=[];for(const i of n){const s=await i.key,a=await i.value;r.push({key:s,value:a})}return pr.mergeObjectSync(e,r)}static mergeObjectSync(e,n){const r={};for(const i of n){const{key:s,value:a}=i;if(s.status==="aborted"||a.status==="aborted")return We;s.status==="dirty"&&e.dirty(),a.status==="dirty"&&e.dirty(),s.value!=="__proto__"&&(typeof a.value<"u"||i.alwaysSet)&&(r[s.value]=a.value)}return{
status:e.value,value:r}}}const We=Object.freeze({status:"aborted"}),Bp=t=>({status:"dirty",value:t}),ci=t=>({status:"valid",value:t}),WL=t=>t.status==="aborted",GL=t=>t.status==="dirty",xc=t=>t.status==="valid",cv=t=>typeof Promise<"u"&&t instanceof Promise;var Ie;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e?.message})(Ie||(Ie={}));class as{constructor(e,n,r,i){this._cachedPath=[],this.parent=e,this.data=n,this._path=r,this._key=i}get path(){
return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const KL=(t,e)=>{if(xc(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new Zs(t.common.issues);return this._error=n,this._error}}};function Je(t){if(!t)return{};const{errorMap:e,invalid_type_error:n,
required_error:r,description:i}=t;if(e&&(n||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:i}:{errorMap:(a,o)=>{const{message:l}=t;return a.code==="invalid_enum_value"?{message:l??o.defaultError}:typeof o.data>"u"?{message:l??r??o.defaultError}:a.code!=="invalid_type"?{message:o.defaultError}:{message:l??n??o.defaultError}},description:i}}class pt{get description(){return this._def.description}_getType(e){
return Aa(e.data)}_getOrReturnCtx(e,n){return n||{common:e.parent.common,data:e.data,parsedType:Aa(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new pr,ctx:{common:e.parent.common,data:e.data,parsedType:Aa(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const n=this._parse(e);if(cv(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(e){const n=this._parse(e);return Promise.
resolve(n)}parse(e,n){const r=this.safeParse(e,n);if(r.success)return r.data;throw r.error}safeParse(e,n){const r={common:{issues:[],async:n?.async??!1,contextualErrorMap:n?.errorMap},path:n?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Aa(e)},i=this._parseSync({data:e,path:r.path,parent:r});return KL(r,i)}"~validate"(e){const n={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Aa(e)};if(!this["\
~standard"].async)try{const r=this._parseSync({data:e,path:[],parent:n});return xc(r)?{value:r.value}:{issues:n.common.issues}}catch(r){r?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),n.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:n}).then(r=>xc(r)?{value:r.value}:{issues:n.common.issues})}async parseAsync(e,n){const r=await this.safeParseAsync(e,n);if(r.success)return r.data;throw r.error}async safeParseAsync(e,n){const r={common:{issues:[],
contextualErrorMap:n?.errorMap,async:!0},path:n?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Aa(e)},i=this._parse({data:e,path:r.path,parent:r}),s=await(cv(i)?i:Promise.resolve(i));return KL(r,s)}refine(e,n){const r=i=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(i):n;return this._refinement((i,s)=>{const a=e(i),o=()=>s.addIssue({code:ve.custom,...r(i)});return typeof Promise<"u"&&a instanceof Promise?a.then(l=>l?!0:(o(),!1)):a?!0:(o(),!1)})}refinement(e,n){
return this._refinement((r,i)=>e(r)?!0:(i.addIssue(typeof n=="function"?n(r,i):n),!1))}_refinement(e){return new Xo({schema:this,typeName:we.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=
this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.
describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:n=>this["~validate"](n)}}optional(){return os.create(this,this._def)}nullable(){return Qo.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return cs.create(this)}promise(){return pv.create(this,this._def)}or(e){return uv.create([this,
e],this._def)}and(e){return dv.create(this,e,this._def)}transform(e){return new Xo({...Je(this._def),schema:this,typeName:we.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const n=typeof e=="function"?e:()=>e;return new hv({...Je(this._def),innerType:this,defaultValue:n,typeName:we.ZodDefault})}brand(){return new sM({typeName:we.ZodBranded,type:this,...Je(this._def)})}catch(e){const n=typeof e=="function"?e:()=>e;return new mv({...Je(this._def),innerType:this,catchValue:n,typeName:we.
ZodCatch})}describe(e){const n=this.constructor;return new n({...this._def,description:e})}pipe(e){return H$.create(this,e)}readonly(){return gv.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const Zse=/^c[^\s-]{8,}$/i,Jse=/^[0-9a-z]+$/,Yse=/^[0-9A-HJKMNP-TV-Z]{26}$/i,Xse=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,Qse=/^[a-z0-9_-]{21}$/i,eae=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,
tae=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,nae=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,rae="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let LS;const iae=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,
sae=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,aae=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,
oae=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,
lae=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,cae=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,ZL="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",uae=new RegExp(`^${ZL}$`);function JL(t){let e="[0-5]\\d";t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`);const n=t.precision?
"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${n}`}function dae(t){return new RegExp(`^${JL(t)}$`)}function fae(t){let e=`${ZL}T${JL(t)}`;const n=[];return n.push(t.local?"Z?":"Z"),t.offset&&n.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${n.join("|")})`,new RegExp(`^${e}$`)}function pae(t,e){return!!((e==="v4"||!e)&&iae.test(t)||(e==="v6"||!e)&&aae.test(t))}function hae(t,e){if(!eae.test(t))return!1;try{const[n]=t.split(".");if(!n)return!1;const r=n.replace(/-/g,"+").replace(/_/g,"/").padEnd(n.length+
(4-n.length%4)%4,"="),i=JSON.parse(atob(r));return!(typeof i!="object"||i===null||"typ"in i&&i?.typ!=="JWT"||!i.alg||e&&i.alg!==e)}catch{return!1}}function mae(t,e){return!!((e==="v4"||!e)&&sae.test(t)||(e==="v6"||!e)&&oae.test(t))}class Js extends pt{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==Ce.string){const s=this._getOrReturnCtx(e);return Te(s,{code:ve.invalid_type,expected:Ce.string,received:s.parsedType}),We}const r=new pr;let i;for(const s of this._def.checks)
if(s.kind==="min")e.data.length<s.value&&(i=this._getOrReturnCtx(e,i),Te(i,{code:ve.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),r.dirty());else if(s.kind==="max")e.data.length>s.value&&(i=this._getOrReturnCtx(e,i),Te(i,{code:ve.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),r.dirty());else if(s.kind==="length"){const a=e.data.length>s.value,o=e.data.length<s.value;(a||o)&&(i=this._getOrReturnCtx(e,i),a?Te(i,{code:ve.too_big,maximum:s.
value,type:"string",inclusive:!0,exact:!0,message:s.message}):o&&Te(i,{code:ve.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}),r.dirty())}else if(s.kind==="email")nae.test(e.data)||(i=this._getOrReturnCtx(e,i),Te(i,{validation:"email",code:ve.invalid_string,message:s.message}),r.dirty());else if(s.kind==="emoji")LS||(LS=new RegExp(rae,"u")),LS.test(e.data)||(i=this._getOrReturnCtx(e,i),Te(i,{validation:"emoji",code:ve.invalid_string,message:s.message}),r.dirty());else if(s.
kind==="uuid")Xse.test(e.data)||(i=this._getOrReturnCtx(e,i),Te(i,{validation:"uuid",code:ve.invalid_string,message:s.message}),r.dirty());else if(s.kind==="nanoid")Qse.test(e.data)||(i=this._getOrReturnCtx(e,i),Te(i,{validation:"nanoid",code:ve.invalid_string,message:s.message}),r.dirty());else if(s.kind==="cuid")Zse.test(e.data)||(i=this._getOrReturnCtx(e,i),Te(i,{validation:"cuid",code:ve.invalid_string,message:s.message}),r.dirty());else if(s.kind==="cuid2")Jse.test(e.data)||(i=this._getOrReturnCtx(
e,i),Te(i,{validation:"cuid2",code:ve.invalid_string,message:s.message}),r.dirty());else if(s.kind==="ulid")Yse.test(e.data)||(i=this._getOrReturnCtx(e,i),Te(i,{validation:"ulid",code:ve.invalid_string,message:s.message}),r.dirty());else if(s.kind==="url")try{new URL(e.data)}catch{i=this._getOrReturnCtx(e,i),Te(i,{validation:"url",code:ve.invalid_string,message:s.message}),r.dirty()}else s.kind==="regex"?(s.regex.lastIndex=0,s.regex.test(e.data)||(i=this._getOrReturnCtx(e,i),Te(i,{validation:"re\
gex",code:ve.invalid_string,message:s.message}),r.dirty())):s.kind==="trim"?e.data=e.data.trim():s.kind==="includes"?e.data.includes(s.value,s.position)||(i=this._getOrReturnCtx(e,i),Te(i,{code:ve.invalid_string,validation:{includes:s.value,position:s.position},message:s.message}),r.dirty()):s.kind==="toLowerCase"?e.data=e.data.toLowerCase():s.kind==="toUpperCase"?e.data=e.data.toUpperCase():s.kind==="startsWith"?e.data.startsWith(s.value)||(i=this._getOrReturnCtx(e,i),Te(i,{code:ve.invalid_string,
validation:{startsWith:s.value},message:s.message}),r.dirty()):s.kind==="endsWith"?e.data.endsWith(s.value)||(i=this._getOrReturnCtx(e,i),Te(i,{code:ve.invalid_string,validation:{endsWith:s.value},message:s.message}),r.dirty()):s.kind==="datetime"?fae(s).test(e.data)||(i=this._getOrReturnCtx(e,i),Te(i,{code:ve.invalid_string,validation:"datetime",message:s.message}),r.dirty()):s.kind==="date"?uae.test(e.data)||(i=this._getOrReturnCtx(e,i),Te(i,{code:ve.invalid_string,validation:"date",message:s.
message}),r.dirty()):s.kind==="time"?dae(s).test(e.data)||(i=this._getOrReturnCtx(e,i),Te(i,{code:ve.invalid_string,validation:"time",message:s.message}),r.dirty()):s.kind==="duration"?tae.test(e.data)||(i=this._getOrReturnCtx(e,i),Te(i,{validation:"duration",code:ve.invalid_string,message:s.message}),r.dirty()):s.kind==="ip"?pae(e.data,s.version)||(i=this._getOrReturnCtx(e,i),Te(i,{validation:"ip",code:ve.invalid_string,message:s.message}),r.dirty()):s.kind==="jwt"?hae(e.data,s.alg)||(i=this._getOrReturnCtx(
e,i),Te(i,{validation:"jwt",code:ve.invalid_string,message:s.message}),r.dirty()):s.kind==="cidr"?mae(e.data,s.version)||(i=this._getOrReturnCtx(e,i),Te(i,{validation:"cidr",code:ve.invalid_string,message:s.message}),r.dirty()):s.kind==="base64"?lae.test(e.data)||(i=this._getOrReturnCtx(e,i),Te(i,{validation:"base64",code:ve.invalid_string,message:s.message}),r.dirty()):s.kind==="base64url"?cae.test(e.data)||(i=this._getOrReturnCtx(e,i),Te(i,{validation:"base64url",code:ve.invalid_string,message:s.
message}),r.dirty()):wt.assertNever(s);return{status:r.value,value:e.data}}_regex(e,n,r){return this.refinement(i=>e.test(i),{validation:n,code:ve.invalid_string,...Ie.errToObj(r)})}_addCheck(e){return new Js({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...Ie.errToObj(e)})}url(e){return this._addCheck({kind:"url",...Ie.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...Ie.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...Ie.errToObj(
e)})}nanoid(e){return this._addCheck({kind:"nanoid",...Ie.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...Ie.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...Ie.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...Ie.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...Ie.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...Ie.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...Ie.errToObj(e)})}ip(e){return this._addCheck({kind:"i\
p",...Ie.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...Ie.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:e?.offset??!1,local:e?.local??!1,...Ie.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this.
_addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...Ie.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...Ie.errToObj(e)})}regex(e,n){return this._addCheck({kind:"regex",regex:e,...Ie.errToObj(n)})}includes(e,n){return this._addCheck({kind:"includes",value:e,position:n?.position,...Ie.errToObj(n?.message)})}startsWith(e,n){return this._addCheck({kind:"startsWith",value:e,...Ie.errToObj(n)})}endsWith(e,n){return this._addCheck({kind:"endsWith",value:e,
...Ie.errToObj(n)})}min(e,n){return this._addCheck({kind:"min",value:e,...Ie.errToObj(n)})}max(e,n){return this._addCheck({kind:"max",value:e,...Ie.errToObj(n)})}length(e,n){return this._addCheck({kind:"length",value:e,...Ie.errToObj(n)})}nonempty(e){return this.min(1,Ie.errToObj(e))}trim(){return new Js({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Js({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Js({...this._def,
checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind===
"emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.
kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxLength(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}Js.create=t=>new Js({checks:[],typeName:we.ZodString,coerce:t?.coerce??!1,...Je(t)});function gae(t,e){const n=(t.toString().split(".")[1]||"").length,r=(e.toString().split(
".")[1]||"").length,i=n>r?n:r,s=Number.parseInt(t.toFixed(i).replace(".","")),a=Number.parseInt(e.toFixed(i).replace(".",""));return s%a/10**i}class qc extends pt{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==Ce.number){const s=this._getOrReturnCtx(e);return Te(s,{code:ve.invalid_type,expected:Ce.number,received:s.parsedType}),We}let r;const i=new pr;for(const s of this._def.
checks)s.kind==="int"?wt.isInteger(e.data)||(r=this._getOrReturnCtx(e,r),Te(r,{code:ve.invalid_type,expected:"integer",received:"float",message:s.message}),i.dirty()):s.kind==="min"?(s.inclusive?e.data<s.value:e.data<=s.value)&&(r=this._getOrReturnCtx(e,r),Te(r,{code:ve.too_small,minimum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),i.dirty()):s.kind==="max"?(s.inclusive?e.data>s.value:e.data>=s.value)&&(r=this._getOrReturnCtx(e,r),Te(r,{code:ve.too_big,maximum:s.value,
type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),i.dirty()):s.kind==="multipleOf"?gae(e.data,s.value)!==0&&(r=this._getOrReturnCtx(e,r),Te(r,{code:ve.not_multiple_of,multipleOf:s.value,message:s.message}),i.dirty()):s.kind==="finite"?Number.isFinite(e.data)||(r=this._getOrReturnCtx(e,r),Te(r,{code:ve.not_finite,message:s.message}),i.dirty()):wt.assertNever(s);return{status:i.value,value:e.data}}gte(e,n){return this.setLimit("min",e,!0,Ie.toString(n))}gt(e,n){return this.setLimit(
"min",e,!1,Ie.toString(n))}lte(e,n){return this.setLimit("max",e,!0,Ie.toString(n))}lt(e,n){return this.setLimit("max",e,!1,Ie.toString(n))}setLimit(e,n,r,i){return new qc({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:r,message:Ie.toString(i)}]})}_addCheck(e){return new qc({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:Ie.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:Ie.toString(e)})}negative(e){
return this._addCheck({kind:"max",value:0,inclusive:!1,message:Ie.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:Ie.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:Ie.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:Ie.toString(n)})}finite(e){return this._addCheck({kind:"finite",message:Ie.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.
MIN_SAFE_INTEGER,message:Ie.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:Ie.toString(e)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&wt.isInteger(e.value))}get isFinite(){let e=null,
n=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(n===null||r.value>n)&&(n=r.value):r.kind==="max"&&(e===null||r.value<e)&&(e=r.value)}return Number.isFinite(n)&&Number.isFinite(e)}}qc.create=t=>new qc({checks:[],typeName:we.ZodNumber,coerce:t?.coerce||!1,...Je(t)});class gh extends pt{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this.
_getInvalidInput(e)}if(this._getType(e)!==Ce.bigint)return this._getInvalidInput(e);let r;const i=new pr;for(const s of this._def.checks)s.kind==="min"?(s.inclusive?e.data<s.value:e.data<=s.value)&&(r=this._getOrReturnCtx(e,r),Te(r,{code:ve.too_small,type:"bigint",minimum:s.value,inclusive:s.inclusive,message:s.message}),i.dirty()):s.kind==="max"?(s.inclusive?e.data>s.value:e.data>=s.value)&&(r=this._getOrReturnCtx(e,r),Te(r,{code:ve.too_big,type:"bigint",maximum:s.value,inclusive:s.inclusive,message:s.
message}),i.dirty()):s.kind==="multipleOf"?e.data%s.value!==BigInt(0)&&(r=this._getOrReturnCtx(e,r),Te(r,{code:ve.not_multiple_of,multipleOf:s.value,message:s.message}),i.dirty()):wt.assertNever(s);return{status:i.value,value:e.data}}_getInvalidInput(e){const n=this._getOrReturnCtx(e);return Te(n,{code:ve.invalid_type,expected:Ce.bigint,received:n.parsedType}),We}gte(e,n){return this.setLimit("min",e,!0,Ie.toString(n))}gt(e,n){return this.setLimit("min",e,!1,Ie.toString(n))}lte(e,n){return this.
setLimit("max",e,!0,Ie.toString(n))}lt(e,n){return this.setLimit("max",e,!1,Ie.toString(n))}setLimit(e,n,r,i){return new gh({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:r,message:Ie.toString(i)}]})}_addCheck(e){return new gh({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:Ie.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:Ie.toString(e)})}nonpositive(e){
return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:Ie.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:Ie.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:Ie.toString(n)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.
value);return e}}gh.create=t=>new gh({checks:[],typeName:we.ZodBigInt,coerce:t?.coerce??!1,...Je(t)});class YL extends pt{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==Ce.boolean){const r=this._getOrReturnCtx(e);return Te(r,{code:ve.invalid_type,expected:Ce.boolean,received:r.parsedType}),We}return ci(e.data)}}YL.create=t=>new YL({typeName:we.ZodBoolean,coerce:t?.coerce||!1,...Je(t)});class gw extends pt{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(
e)!==Ce.date){const s=this._getOrReturnCtx(e);return Te(s,{code:ve.invalid_type,expected:Ce.date,received:s.parsedType}),We}if(Number.isNaN(e.data.getTime())){const s=this._getOrReturnCtx(e);return Te(s,{code:ve.invalid_date}),We}const r=new pr;let i;for(const s of this._def.checks)s.kind==="min"?e.data.getTime()<s.value&&(i=this._getOrReturnCtx(e,i),Te(i,{code:ve.too_small,message:s.message,inclusive:!0,exact:!1,minimum:s.value,type:"date"}),r.dirty()):s.kind==="max"?e.data.getTime()>s.value&&(i=
this._getOrReturnCtx(e,i),Te(i,{code:ve.too_big,message:s.message,inclusive:!0,exact:!1,maximum:s.value,type:"date"}),r.dirty()):wt.assertNever(s);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(e){return new gw({...this._def,checks:[...this._def.checks,e]})}min(e,n){return this._addCheck({kind:"min",value:e.getTime(),message:Ie.toString(n)})}max(e,n){return this._addCheck({kind:"max",value:e.getTime(),message:Ie.toString(n)})}get minDate(){let e=null;for(const n of this._def.checks)
n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e!=null?new Date(e):null}}gw.create=t=>new gw({checks:[],coerce:t?.coerce||!1,typeName:we.ZodDate,...Je(t)});class XL extends pt{_parse(e){if(this._getType(e)!==Ce.symbol){const r=this._getOrReturnCtx(e);return Te(r,{code:ve.invalid_type,expected:Ce.symbol,received:r.parsedType}),We}return ci(e.data)}}
XL.create=t=>new XL({typeName:we.ZodSymbol,...Je(t)});class MS extends pt{_parse(e){if(this._getType(e)!==Ce.undefined){const r=this._getOrReturnCtx(e);return Te(r,{code:ve.invalid_type,expected:Ce.undefined,received:r.parsedType}),We}return ci(e.data)}}MS.create=t=>new MS({typeName:we.ZodUndefined,...Je(t)});class jS extends pt{_parse(e){if(this._getType(e)!==Ce.null){const r=this._getOrReturnCtx(e);return Te(r,{code:ve.invalid_type,expected:Ce.null,received:r.parsedType}),We}return ci(e.data)}}
jS.create=t=>new jS({typeName:we.ZodNull,...Je(t)});class QL extends pt{constructor(){super(...arguments),this._any=!0}_parse(e){return ci(e.data)}}QL.create=t=>new QL({typeName:we.ZodAny,...Je(t)});class eM extends pt{constructor(){super(...arguments),this._unknown=!0}_parse(e){return ci(e.data)}}eM.create=t=>new eM({typeName:we.ZodUnknown,...Je(t)});class Ia extends pt{_parse(e){const n=this._getOrReturnCtx(e);return Te(n,{code:ve.invalid_type,expected:Ce.never,received:n.parsedType}),We}}Ia.create=
t=>new Ia({typeName:we.ZodNever,...Je(t)});class tM extends pt{_parse(e){if(this._getType(e)!==Ce.undefined){const r=this._getOrReturnCtx(e);return Te(r,{code:ve.invalid_type,expected:Ce.void,received:r.parsedType}),We}return ci(e.data)}}tM.create=t=>new tM({typeName:we.ZodVoid,...Je(t)});class cs extends pt{_parse(e){const{ctx:n,status:r}=this._processInputParams(e),i=this._def;if(n.parsedType!==Ce.array)return Te(n,{code:ve.invalid_type,expected:Ce.array,received:n.parsedType}),We;if(i.exactLength!==
null){const a=n.data.length>i.exactLength.value,o=n.data.length<i.exactLength.value;(a||o)&&(Te(n,{code:a?ve.too_big:ve.too_small,minimum:o?i.exactLength.value:void 0,maximum:a?i.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:i.exactLength.message}),r.dirty())}if(i.minLength!==null&&n.data.length<i.minLength.value&&(Te(n,{code:ve.too_small,minimum:i.minLength.value,type:"array",inclusive:!0,exact:!1,message:i.minLength.message}),r.dirty()),i.maxLength!==null&&n.data.length>i.
maxLength.value&&(Te(n,{code:ve.too_big,maximum:i.maxLength.value,type:"array",inclusive:!0,exact:!1,message:i.maxLength.message}),r.dirty()),n.common.async)return Promise.all([...n.data].map((a,o)=>i.type._parseAsync(new as(n,a,n.path,o)))).then(a=>pr.mergeArray(r,a));const s=[...n.data].map((a,o)=>i.type._parseSync(new as(n,a,n.path,o)));return pr.mergeArray(r,s)}get element(){return this._def.type}min(e,n){return new cs({...this._def,minLength:{value:e,message:Ie.toString(n)}})}max(e,n){return new cs(
{...this._def,maxLength:{value:e,message:Ie.toString(n)}})}length(e,n){return new cs({...this._def,exactLength:{value:e,message:Ie.toString(n)}})}nonempty(e){return this.min(1,e)}}cs.create=(t,e)=>new cs({type:t,minLength:null,maxLength:null,exactLength:null,typeName:we.ZodArray,...Je(e)});function Ac(t){if(t instanceof kn){const e={};for(const n in t.shape){const r=t.shape[n];e[n]=os.create(Ac(r))}return new kn({...t._def,shape:()=>e})}else return t instanceof cs?new cs({...t._def,type:Ac(t.element)}):
t instanceof os?os.create(Ac(t.unwrap())):t instanceof Qo?Qo.create(Ac(t.unwrap())):t instanceof ul?ul.create(t.items.map(e=>Ac(e))):t}class kn extends pt{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),n=wt.objectKeys(e);return this._cached={shape:e,keys:n},this._cached}_parse(e){if(this._getType(e)!==Ce.object){const c=this._getOrReturnCtx(e);return Te(
c,{code:ve.invalid_type,expected:Ce.object,received:c.parsedType}),We}const{status:r,ctx:i}=this._processInputParams(e),{shape:s,keys:a}=this._getCached(),o=[];if(!(this._def.catchall instanceof Ia&&this._def.unknownKeys==="strip"))for(const c in i.data)a.includes(c)||o.push(c);const l=[];for(const c of a){const u=s[c],d=i.data[c];l.push({key:{status:"valid",value:c},value:u._parse(new as(i,d,i.path,c)),alwaysSet:c in i.data})}if(this._def.catchall instanceof Ia){const c=this._def.unknownKeys;if(c===
"passthrough")for(const u of o)l.push({key:{status:"valid",value:u},value:{status:"valid",value:i.data[u]}});else if(c==="strict")o.length>0&&(Te(i,{code:ve.unrecognized_keys,keys:o}),r.dirty());else if(c!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const c=this._def.catchall;for(const u of o){const d=i.data[u];l.push({key:{status:"valid",value:u},value:c._parse(new as(i,d,i.path,u)),alwaysSet:u in i.data})}}return i.common.async?Promise.resolve().then(async()=>{
const c=[];for(const u of l){const d=await u.key,f=await u.value;c.push({key:d,value:f,alwaysSet:u.alwaysSet})}return c}).then(c=>pr.mergeObjectSync(r,c)):pr.mergeObjectSync(r,l)}get shape(){return this._def.shape()}strict(e){return Ie.errToObj,new kn({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(n,r)=>{const i=this._def.errorMap?.(n,r).message??r.defaultError;return n.code==="unrecognized_keys"?{message:Ie.errToObj(e).message??i}:{message:i}}}:{}})}strip(){return new kn({...this._def,
unknownKeys:"strip"})}passthrough(){return new kn({...this._def,unknownKeys:"passthrough"})}extend(e){return new kn({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new kn({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:we.ZodObject})}setKey(e,n){return this.augment({[e]:n})}catchall(e){return new kn({...this._def,catchall:e})}pick(e){const n={};for(const r of wt.objectKeys(e))e[r]&&this.shape[r]&&(n[r]=
this.shape[r]);return new kn({...this._def,shape:()=>n})}omit(e){const n={};for(const r of wt.objectKeys(this.shape))e[r]||(n[r]=this.shape[r]);return new kn({...this._def,shape:()=>n})}deepPartial(){return Ac(this)}partial(e){const n={};for(const r of wt.objectKeys(this.shape)){const i=this.shape[r];e&&!e[r]?n[r]=i:n[r]=i.optional()}return new kn({...this._def,shape:()=>n})}required(e){const n={};for(const r of wt.objectKeys(this.shape))if(e&&!e[r])n[r]=this.shape[r];else{let s=this.shape[r];for(;s instanceof
os;)s=s._def.innerType;n[r]=s}return new kn({...this._def,shape:()=>n})}keyof(){return rM(wt.objectKeys(this.shape))}}kn.create=(t,e)=>new kn({shape:()=>t,unknownKeys:"strip",catchall:Ia.create(),typeName:we.ZodObject,...Je(e)}),kn.strictCreate=(t,e)=>new kn({shape:()=>t,unknownKeys:"strict",catchall:Ia.create(),typeName:we.ZodObject,...Je(e)}),kn.lazycreate=(t,e)=>new kn({shape:t,unknownKeys:"strip",catchall:Ia.create(),typeName:we.ZodObject,...Je(e)});class uv extends pt{_parse(e){const{ctx:n}=this.
_processInputParams(e),r=this._def.options;function i(s){for(const o of s)if(o.result.status==="valid")return o.result;for(const o of s)if(o.result.status==="dirty")return n.common.issues.push(...o.ctx.common.issues),o.result;const a=s.map(o=>new Zs(o.ctx.common.issues));return Te(n,{code:ve.invalid_union,unionErrors:a}),We}if(n.common.async)return Promise.all(r.map(async s=>{const a={...n,common:{...n.common,issues:[]},parent:null};return{result:await s._parseAsync({data:n.data,path:n.path,parent:a}),
ctx:a}})).then(i);{let s;const a=[];for(const l of r){const c={...n,common:{...n.common,issues:[]},parent:null},u=l._parseSync({data:n.data,path:n.path,parent:c});if(u.status==="valid")return u;u.status==="dirty"&&!s&&(s={result:u,ctx:c}),c.common.issues.length&&a.push(c.common.issues)}if(s)return n.common.issues.push(...s.ctx.common.issues),s.result;const o=a.map(l=>new Zs(l));return Te(n,{code:ve.invalid_union,unionErrors:o}),We}}get options(){return this._def.options}}uv.create=(t,e)=>new uv(
{options:t,typeName:we.ZodUnion,...Je(e)});const Us=t=>t instanceof FS?Us(t.schema):t instanceof Xo?Us(t.innerType()):t instanceof fv?[t.value]:t instanceof dl?t.options:t instanceof zS?wt.objectValues(t.enum):t instanceof hv?Us(t._def.innerType):t instanceof MS?[void 0]:t instanceof jS?[null]:t instanceof os?[void 0,...Us(t.unwrap())]:t instanceof Qo?[null,...Us(t.unwrap())]:t instanceof sM||t instanceof gv?Us(t.unwrap()):t instanceof mv?Us(t._def.innerType):[];class U$ extends pt{_parse(e){const{
ctx:n}=this._processInputParams(e);if(n.parsedType!==Ce.object)return Te(n,{code:ve.invalid_type,expected:Ce.object,received:n.parsedType}),We;const r=this.discriminator,i=n.data[r],s=this.optionsMap.get(i);return s?n.common.async?s._parseAsync({data:n.data,path:n.path,parent:n}):s._parseSync({data:n.data,path:n.path,parent:n}):(Te(n,{code:ve.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),We)}get discriminator(){return this._def.discriminator}get options(){return this.
_def.options}get optionsMap(){return this._def.optionsMap}static create(e,n,r){const i=new Map;for(const s of n){const a=Us(s.shape[e]);if(!a.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const o of a){if(i.has(o))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(o)}`);i.set(o,s)}}return new U$({typeName:we.ZodDiscriminatedUnion,discriminator:e,options:n,optionsMap:i,...Je(r)})}}function qS(t,e){
const n=Aa(t),r=Aa(e);if(t===e)return{valid:!0,data:t};if(n===Ce.object&&r===Ce.object){const i=wt.objectKeys(e),s=wt.objectKeys(t).filter(o=>i.indexOf(o)!==-1),a={...t,...e};for(const o of s){const l=qS(t[o],e[o]);if(!l.valid)return{valid:!1};a[o]=l.data}return{valid:!0,data:a}}else if(n===Ce.array&&r===Ce.array){if(t.length!==e.length)return{valid:!1};const i=[];for(let s=0;s<t.length;s++){const a=t[s],o=e[s],l=qS(a,o);if(!l.valid)return{valid:!1};i.push(l.data)}return{valid:!0,data:i}}else return n===
Ce.date&&r===Ce.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}class dv extends pt{_parse(e){const{status:n,ctx:r}=this._processInputParams(e),i=(s,a)=>{if(WL(s)||WL(a))return We;const o=qS(s.value,a.value);return o.valid?((GL(s)||GL(a))&&n.dirty(),{status:n.value,value:o.data}):(Te(r,{code:ve.invalid_intersection_types}),We)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([s,a])=>i(
s,a)):i(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}dv.create=(t,e,n)=>new dv({left:t,right:e,typeName:we.ZodIntersection,...Je(n)});class ul extends pt{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==Ce.array)return Te(r,{code:ve.invalid_type,expected:Ce.array,received:r.parsedType}),We;if(r.data.length<this._def.items.length)return Te(r,{code:ve.too_small,minimum:this._def.items.length,
inclusive:!0,exact:!1,type:"array"}),We;!this._def.rest&&r.data.length>this._def.items.length&&(Te(r,{code:ve.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const s=[...r.data].map((a,o)=>{const l=this._def.items[o]||this._def.rest;return l?l._parse(new as(r,a,r.path,o)):null}).filter(a=>!!a);return r.common.async?Promise.all(s).then(a=>pr.mergeArray(n,a)):pr.mergeArray(n,s)}get items(){return this._def.items}rest(e){return new ul({...this._def,rest:e})}}ul.
create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new ul({items:t,typeName:we.ZodTuple,rest:null,...Je(e)})};class yw extends pt{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==Ce.object)return Te(r,{code:ve.invalid_type,expected:Ce.object,received:r.parsedType}),We;const i=[],s=this._def.keyType,a=this._def.valueType;
for(const o in r.data)i.push({key:s._parse(new as(r,o,r.path,o)),value:a._parse(new as(r,r.data[o],r.path,o)),alwaysSet:o in r.data});return r.common.async?pr.mergeObjectAsync(n,i):pr.mergeObjectSync(n,i)}get element(){return this._def.valueType}static create(e,n,r){return n instanceof pt?new yw({keyType:e,valueType:n,typeName:we.ZodRecord,...Je(r)}):new yw({keyType:Js.create(),valueType:e,typeName:we.ZodRecord,...Je(n)})}}class nM extends pt{get keySchema(){return this._def.keyType}get valueSchema(){
return this._def.valueType}_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==Ce.map)return Te(r,{code:ve.invalid_type,expected:Ce.map,received:r.parsedType}),We;const i=this._def.keyType,s=this._def.valueType,a=[...r.data.entries()].map(([o,l],c)=>({key:i._parse(new as(r,o,r.path,[c,"key"])),value:s._parse(new as(r,l,r.path,[c,"value"]))}));if(r.common.async){const o=new Map;return Promise.resolve().then(async()=>{for(const l of a){const c=await l.key,u=await l.value;
if(c.status==="aborted"||u.status==="aborted")return We;(c.status==="dirty"||u.status==="dirty")&&n.dirty(),o.set(c.value,u.value)}return{status:n.value,value:o}})}else{const o=new Map;for(const l of a){const c=l.key,u=l.value;if(c.status==="aborted"||u.status==="aborted")return We;(c.status==="dirty"||u.status==="dirty")&&n.dirty(),o.set(c.value,u.value)}return{status:n.value,value:o}}}}nM.create=(t,e,n)=>new nM({valueType:e,keyType:t,typeName:we.ZodMap,...Je(n)});class yh extends pt{_parse(e){
const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==Ce.set)return Te(r,{code:ve.invalid_type,expected:Ce.set,received:r.parsedType}),We;const i=this._def;i.minSize!==null&&r.data.size<i.minSize.value&&(Te(r,{code:ve.too_small,minimum:i.minSize.value,type:"set",inclusive:!0,exact:!1,message:i.minSize.message}),n.dirty()),i.maxSize!==null&&r.data.size>i.maxSize.value&&(Te(r,{code:ve.too_big,maximum:i.maxSize.value,type:"set",inclusive:!0,exact:!1,message:i.maxSize.message}),n.dirty());
const s=this._def.valueType;function a(l){const c=new Set;for(const u of l){if(u.status==="aborted")return We;u.status==="dirty"&&n.dirty(),c.add(u.value)}return{status:n.value,value:c}}const o=[...r.data.values()].map((l,c)=>s._parse(new as(r,l,r.path,c)));return r.common.async?Promise.all(o).then(l=>a(l)):a(o)}min(e,n){return new yh({...this._def,minSize:{value:e,message:Ie.toString(n)}})}max(e,n){return new yh({...this._def,maxSize:{value:e,message:Ie.toString(n)}})}size(e,n){return this.min(
e,n).max(e,n)}nonempty(e){return this.min(1,e)}}yh.create=(t,e)=>new yh({valueType:t,minSize:null,maxSize:null,typeName:we.ZodSet,...Je(e)});class FS extends pt{get schema(){return this._def.getter()}_parse(e){const{ctx:n}=this._processInputParams(e);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}FS.create=(t,e)=>new FS({getter:t,typeName:we.ZodLazy,...Je(e)});class fv extends pt{_parse(e){if(e.data!==this._def.value){const n=this._getOrReturnCtx(e);return Te(n,{received:n.
data,code:ve.invalid_literal,expected:this._def.value}),We}return{status:"valid",value:e.data}}get value(){return this._def.value}}fv.create=(t,e)=>new fv({value:t,typeName:we.ZodLiteral,...Je(e)});function rM(t,e){return new dl({values:t,typeName:we.ZodEnum,...Je(e)})}class dl extends pt{_parse(e){if(typeof e.data!="string"){const n=this._getOrReturnCtx(e),r=this._def.values;return Te(n,{expected:wt.joinValues(r),received:n.parsedType,code:ve.invalid_type}),We}if(this._cache||(this._cache=new Set(
this._def.values)),!this._cache.has(e.data)){const n=this._getOrReturnCtx(e),r=this._def.values;return Te(n,{received:n.data,code:ve.invalid_enum_value,options:r}),We}return ci(e.data)}get options(){return this._def.values}get enum(){const e={};for(const n of this._def.values)e[n]=n;return e}get Values(){const e={};for(const n of this._def.values)e[n]=n;return e}get Enum(){const e={};for(const n of this._def.values)e[n]=n;return e}extract(e,n=this._def){return dl.create(e,{...this._def,...n})}exclude(e,n=this.
_def){return dl.create(this.options.filter(r=>!e.includes(r)),{...this._def,...n})}}dl.create=rM;class zS extends pt{_parse(e){const n=wt.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==Ce.string&&r.parsedType!==Ce.number){const i=wt.objectValues(n);return Te(r,{expected:wt.joinValues(i),received:r.parsedType,code:ve.invalid_type}),We}if(this._cache||(this._cache=new Set(wt.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){const i=wt.objectValues(n);
return Te(r,{received:r.data,code:ve.invalid_enum_value,options:i}),We}return ci(e.data)}get enum(){return this._def.values}}zS.create=(t,e)=>new zS({values:t,typeName:we.ZodNativeEnum,...Je(e)});class pv extends pt{unwrap(){return this._def.type}_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==Ce.promise&&n.common.async===!1)return Te(n,{code:ve.invalid_type,expected:Ce.promise,received:n.parsedType}),We;const r=n.parsedType===Ce.promise?n.data:Promise.resolve(n.data);return ci(
r.then(i=>this._def.type.parseAsync(i,{path:n.path,errorMap:n.common.contextualErrorMap})))}}pv.create=(t,e)=>new pv({type:t,typeName:we.ZodPromise,...Je(e)});class Xo extends pt{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===we.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:n,ctx:r}=this._processInputParams(e),i=this._def.effect||null,s={addIssue:a=>{Te(r,a),a.fatal?n.abort():n.dirty()},get path(){return r.path}};if(s.addIssue=
s.addIssue.bind(s),i.type==="preprocess"){const a=i.transform(r.data,s);if(r.common.async)return Promise.resolve(a).then(async o=>{if(n.value==="aborted")return We;const l=await this._def.schema._parseAsync({data:o,path:r.path,parent:r});return l.status==="aborted"?We:l.status==="dirty"||n.value==="dirty"?Bp(l.value):l});{if(n.value==="aborted")return We;const o=this._def.schema._parseSync({data:a,path:r.path,parent:r});return o.status==="aborted"?We:o.status==="dirty"||n.value==="dirty"?Bp(o.value):
o}}if(i.type==="refinement"){const a=o=>{const l=i.refinement(o,s);if(r.common.async)return Promise.resolve(l);if(l instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return o};if(r.common.async===!1){const o=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return o.status==="aborted"?We:(o.status==="dirty"&&n.dirty(),a(o.value),{status:n.value,value:o.value})}else return this._def.schema._parseAsync({data:r.
data,path:r.path,parent:r}).then(o=>o.status==="aborted"?We:(o.status==="dirty"&&n.dirty(),a(o.value).then(()=>({status:n.value,value:o.value}))))}if(i.type==="transform")if(r.common.async===!1){const a=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!xc(a))return We;const o=i.transform(a.value,s);if(o instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:o}}else return this.
_def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(a=>xc(a)?Promise.resolve(i.transform(a.value,s)).then(o=>({status:n.value,value:o})):We);wt.assertNever(i)}}Xo.create=(t,e,n)=>new Xo({schema:t,typeName:we.ZodEffects,effect:e,...Je(n)}),Xo.createWithPreprocess=(t,e,n)=>new Xo({schema:e,effect:{type:"preprocess",transform:t},typeName:we.ZodEffects,...Je(n)});class os extends pt{_parse(e){return this._getType(e)===Ce.undefined?ci(void 0):this._def.innerType._parse(e)}unwrap(){return this.
_def.innerType}}os.create=(t,e)=>new os({innerType:t,typeName:we.ZodOptional,...Je(e)});class Qo extends pt{_parse(e){return this._getType(e)===Ce.null?ci(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Qo.create=(t,e)=>new Qo({innerType:t,typeName:we.ZodNullable,...Je(e)});class hv extends pt{_parse(e){const{ctx:n}=this._processInputParams(e);let r=n.data;return n.parsedType===Ce.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:n.path,parent:n})}removeDefault(){
return this._def.innerType}}hv.create=(t,e)=>new hv({innerType:t,typeName:we.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...Je(e)});class mv extends pt{_parse(e){const{ctx:n}=this._processInputParams(e),r={...n,common:{...n.common,issues:[]}},i=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return cv(i)?i.then(s=>({status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new Zs(r.common.issues)},input:r.data})})):
{status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new Zs(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}mv.create=(t,e)=>new mv({innerType:t,typeName:we.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...Je(e)});class iM extends pt{_parse(e){if(this._getType(e)!==Ce.nan){const r=this._getOrReturnCtx(e);return Te(r,{code:ve.invalid_type,expected:Ce.nan,received:r.parsedType}),We}return{status:"valid",value:e.data}}}
iM.create=t=>new iM({typeName:we.ZodNaN,...Je(t)});class sM extends pt{_parse(e){const{ctx:n}=this._processInputParams(e),r=n.data;return this._def.type._parse({data:r,path:n.path,parent:n})}unwrap(){return this._def.type}}class H$ extends pt{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{const s=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return s.status==="aborted"?We:s.status==="dirty"?(n.dirty(),Bp(s.value)):this._def.out.
_parseAsync({data:s.value,path:r.path,parent:r})})();{const i=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return i.status==="aborted"?We:i.status==="dirty"?(n.dirty(),{status:"dirty",value:i.value}):this._def.out._parseSync({data:i.value,path:r.path,parent:r})}}static create(e,n){return new H$({in:e,out:n,typeName:we.ZodPipeline})}}class gv extends pt{_parse(e){const n=this._def.innerType._parse(e),r=i=>(xc(i)&&(i.value=Object.freeze(i.value)),i);return cv(n)?n.then(i=>r(i)):r(n)}unwrap(){
return this._def.innerType}}gv.create=(t,e)=>new gv({innerType:t,typeName:we.ZodReadonly,...Je(e)});var we;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion=
"ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodRead\
only"})(we||(we={}));const Q=Js.create,Wp=qc.create;Ia.create;const Ze=cs.create,Pt=kn.create,yv=uv.create,US=U$.create;dv.create,ul.create;const vv=yw.create,el=fv.create,Gp=dl.create;pv.create,os.create,Qo.create;const yae=de("ZodMiniType",(t,e)=>{if(!t._zod)throw new Error("Uninitialized schema in ZodMiniType.");Ut.init(t,e),t.def=e,t.parse=(n,r)=>lJ(t,n,r,{callee:t.parse}),t.safeParse=(n,r)=>cR(t,n,r),t.parseAsync=async(n,r)=>cJ(t,n,r,{callee:t.parseAsync}),t.safeParseAsync=async(n,r)=>uR(t,
n,r),t.check=(...n)=>t.clone({...e,checks:[...e.checks??[],...n.map(r=>typeof r=="function"?{_zod:{check:r,def:{check:"custom"},onattach:[]}}:r)]}),t.clone=(n,r)=>Ra(t,n,r),t.brand=()=>t,t.register=((n,r)=>(n.add(t,r),t))}),vae=de("ZodMiniObject",(t,e)=>{SD.init(t,e),yae.init(t,e),zt(t,"shape",()=>e.shape)});function aM(t,e){const n={type:"object",get shape(){return gp(this,"shape",{...t}),this.shape},...Ae(e)};return new vae(n)}function ls(t){return!!t._zod}function Ic(t){const e=Object.values(
t);if(e.length===0)return aM({});const n=e.every(ls),r=e.every(i=>!ls(i));if(n)return aM(t);if(r)return Pt(t);throw new Error("Mixed Zod versions detected in object shape.")}function Kp(t,e){return ls(t)?cR(t,e):t.safeParse(e)}async function HS(t,e){return ls(t)?await uR(t,e):await t.safeParseAsync(e)}function Zp(t){if(!t)return;let e;if(ls(t)?e=t._zod?.def?.shape:e=t.shape,!!e){if(typeof e=="function")try{return e()}catch{return}return e}}function Jp(t){if(t){if(typeof t=="object"){const e=t,n=t;
if(!e._def&&!n._zod){const r=Object.values(t);if(r.length>0&&r.every(i=>typeof i=="object"&&i!==null&&(i._def!==void 0||i._zod!==void 0||typeof i.parse=="function")))return Ic(t)}}if(ls(t)){const n=t._zod?.def;if(n&&(n.type==="object"||n.shape!==void 0))return t}else if(t.shape!==void 0)return t}}function VS(t){if(t&&typeof t=="object"){if("message"in t&&typeof t.message=="string")return t.message;if("issues"in t&&Array.isArray(t.issues)&&t.issues.length>0){const e=t.issues[0];if(e&&typeof e=="o\
bject"&&"message"in e)return String(e.message)}try{return JSON.stringify(t)}catch{return String(t)}}return String(t)}function wae(t){return t.description}function bae(t){if(ls(t))return t._zod?.def?.type==="optional";const e=t;return typeof t.isOptional=="function"?t.isOptional():e._def?.typeName==="ZodOptional"}function oM(t){if(ls(t)){const s=t._zod?.def;if(s){if(s.value!==void 0)return s.value;if(Array.isArray(s.values)&&s.values.length>0)return s.values[0]}}const n=t._def;if(n){if(n.value!==
void 0)return n.value;if(Array.isArray(n.values)&&n.values.length>0)return n.values[0]}const r=t.value;if(r!==void 0)return r}function tl(t){return t==="completed"||t==="failed"||t==="cancelled"}const kae=Symbol("Let zodToJsonSchema decide on which parser to use"),lM={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",allowedAdditionalProperties:!0,rejectedAdditionalProperties:!1,
definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref",openAiAnyTypeName:"OpenAiAnyType"},_ae=t=>typeof t=="string"?{...lM,name:t}:{...lM,...t},Rae=t=>{const e=_ae(t),n=e.name!==void 0?[...e.basePath,e.definitionPath,e.name]:e.basePath;return{...e,flags:{hasReferencedOpenAiAnyType:!1},currentPath:n,propertyPath:void 0,
seen:new Map(Object.entries(e.definitions).map(([r,i])=>[i._def,{def:i._def,path:[...e.basePath,e.definitionPath,r],jsonSchema:void 0}]))}};function cM(t,e,n,r){r?.errorMessages&&n&&(t.errorMessage={...t.errorMessage,[e]:n})}function Ct(t,e,n,r,i){t[e]=n,cM(t,e,r,i)}const uM=(t,e)=>{let n=0;for(;n<t.length&&n<e.length&&t[n]===e[n];n++);return[(t.length-n).toString(),...e.slice(n)].join("/")};function Cr(t){if(t.target!=="openAi")return{};const e=[...t.basePath,t.definitionPath,t.openAiAnyTypeName];
return t.flags.hasReferencedOpenAiAnyType=!0,{$ref:t.$refStrategy==="relative"?uM(e,t.currentPath):e.join("/")}}function Sae(t,e){const n={type:"array"};return t.type?._def&&t.type?._def?.typeName!==we.ZodAny&&(n.items=Tt(t.type._def,{...e,currentPath:[...e.currentPath,"items"]})),t.minLength&&Ct(n,"minItems",t.minLength.value,t.minLength.message,e),t.maxLength&&Ct(n,"maxItems",t.maxLength.value,t.maxLength.message,e),t.exactLength&&(Ct(n,"minItems",t.exactLength.value,t.exactLength.message,e),Ct(
n,"maxItems",t.exactLength.value,t.exactLength.message,e)),n}function $ae(t,e){const n={type:"integer",format:"int64"};if(!t.checks)return n;for(const r of t.checks)switch(r.kind){case"min":e.target==="jsonSchema7"?r.inclusive?Ct(n,"minimum",r.value,r.message,e):Ct(n,"exclusiveMinimum",r.value,r.message,e):(r.inclusive||(n.exclusiveMinimum=!0),Ct(n,"minimum",r.value,r.message,e));break;case"max":e.target==="jsonSchema7"?r.inclusive?Ct(n,"maximum",r.value,r.message,e):Ct(n,"exclusiveMaximum",r.value,
r.message,e):(r.inclusive||(n.exclusiveMaximum=!0),Ct(n,"maximum",r.value,r.message,e));break;case"multipleOf":Ct(n,"multipleOf",r.value,r.message,e);break}return n}function Tae(){return{type:"boolean"}}function dM(t,e){return Tt(t.type._def,e)}const Eae=(t,e)=>Tt(t.innerType._def,e);function fM(t,e,n){const r=n??e.dateStrategy;if(Array.isArray(r))return{anyOf:r.map((i,s)=>fM(t,e,i))};switch(r){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{
type:"string",format:"date"};case"integer":return Pae(t,e)}}const Pae=(t,e)=>{const n={type:"integer",format:"unix-time"};if(e.target==="openApi3")return n;for(const r of t.checks)switch(r.kind){case"min":Ct(n,"minimum",r.value,r.message,e);break;case"max":Ct(n,"maximum",r.value,r.message,e);break}return n};function Cae(t,e){return{...Tt(t.innerType._def,e),default:t.defaultValue()}}function xae(t,e){return e.effectStrategy==="input"?Tt(t.schema._def,e):Cr(e)}function Aae(t){return{type:"string",
enum:Array.from(t.values)}}const Iae=t=>"type"in t&&t.type==="string"?!1:"allOf"in t;function Nae(t,e){const n=[Tt(t.left._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),Tt(t.right._def,{...e,currentPath:[...e.currentPath,"allOf","1"]})].filter(s=>!!s);let r=e.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const i=[];return n.forEach(s=>{if(Iae(s))i.push(...s.allOf),s.unevaluatedProperties===void 0&&(r=void 0);else{let a=s;if("additionalProperties"in s&&s.additionalProperties===
!1){const{additionalProperties:o,...l}=s;a=l}else r=void 0;i.push(a)}}),i.length?{allOf:i,...r}:void 0}function Dae(t,e){const n=typeof t.value;return n!=="bigint"&&n!=="number"&&n!=="boolean"&&n!=="string"?{type:Array.isArray(t.value)?"array":"object"}:e.target==="openApi3"?{type:n==="bigint"?"integer":n,enum:[t.value]}:{type:n==="bigint"?"integer":n,const:t.value}}let BS;const Pi={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,
emoji:()=>(BS===void 0&&(BS=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),BS),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv4Cidr:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,
ipv6Cidr:/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,
base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64url:/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/,jwt:/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/};function pM(t,e){const n={type:"string"};if(t.checks)for(const r of t.checks)switch(r.kind){case"min":Ct(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,r.value):r.value,r.message,e);break;case"max":Ct(n,"maxLength",typeof n.maxLength=="numbe\
r"?Math.min(n.maxLength,r.value):r.value,r.message,e);break;case"email":switch(e.emailStrategy){case"format:email":Ci(n,"email",r.message,e);break;case"format:idn-email":Ci(n,"idn-email",r.message,e);break;case"pattern:zod":dr(n,Pi.email,r.message,e);break}break;case"url":Ci(n,"uri",r.message,e);break;case"uuid":Ci(n,"uuid",r.message,e);break;case"regex":dr(n,r.regex,r.message,e);break;case"cuid":dr(n,Pi.cuid,r.message,e);break;case"cuid2":dr(n,Pi.cuid2,r.message,e);break;case"startsWith":dr(n,RegExp(
`^${WS(r.value,e)}`),r.message,e);break;case"endsWith":dr(n,RegExp(`${WS(r.value,e)}$`),r.message,e);break;case"datetime":Ci(n,"date-time",r.message,e);break;case"date":Ci(n,"date",r.message,e);break;case"time":Ci(n,"time",r.message,e);break;case"duration":Ci(n,"duration",r.message,e);break;case"length":Ct(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,r.value):r.value,r.message,e),Ct(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,r.value):r.value,r.message,e);break;case"\
includes":{dr(n,RegExp(WS(r.value,e)),r.message,e);break}case"ip":{r.version!=="v6"&&Ci(n,"ipv4",r.message,e),r.version!=="v4"&&Ci(n,"ipv6",r.message,e);break}case"base64url":dr(n,Pi.base64url,r.message,e);break;case"jwt":dr(n,Pi.jwt,r.message,e);break;case"cidr":{r.version!=="v6"&&dr(n,Pi.ipv4Cidr,r.message,e),r.version!=="v4"&&dr(n,Pi.ipv6Cidr,r.message,e);break}case"emoji":dr(n,Pi.emoji(),r.message,e);break;case"ulid":{dr(n,Pi.ulid,r.message,e);break}case"base64":{switch(e.base64Strategy){case"\
format:binary":{Ci(n,"binary",r.message,e);break}case"contentEncoding:base64":{Ct(n,"contentEncoding","base64",r.message,e);break}case"pattern:zod":{dr(n,Pi.base64,r.message,e);break}}break}case"nanoid":dr(n,Pi.nanoid,r.message,e)}return n}function WS(t,e){return e.patternStrategy==="escape"?Lae(t):t}const Oae=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function Lae(t){let e="";for(let n=0;n<t.length;n++)Oae.has(t[n])||(e+="\\"),e+=t[n];return e}function Ci(t,e,n,r){t.
format||t.anyOf?.some(i=>i.format)?(t.anyOf||(t.anyOf=[]),t.format&&(t.anyOf.push({format:t.format,...t.errorMessage&&r.errorMessages&&{errorMessage:{format:t.errorMessage.format}}}),delete t.format,t.errorMessage&&(delete t.errorMessage.format,Object.keys(t.errorMessage).length===0&&delete t.errorMessage)),t.anyOf.push({format:e,...n&&r.errorMessages&&{errorMessage:{format:n}}})):Ct(t,"format",e,n,r)}function dr(t,e,n,r){t.pattern||t.allOf?.some(i=>i.pattern)?(t.allOf||(t.allOf=[]),t.pattern&&(t.
allOf.push({pattern:t.pattern,...t.errorMessage&&r.errorMessages&&{errorMessage:{pattern:t.errorMessage.pattern}}}),delete t.pattern,t.errorMessage&&(delete t.errorMessage.pattern,Object.keys(t.errorMessage).length===0&&delete t.errorMessage)),t.allOf.push({pattern:hM(e,r),...n&&r.errorMessages&&{errorMessage:{pattern:n}}})):Ct(t,"pattern",hM(e,r),n,r)}function hM(t,e){if(!e.applyRegexFlags||!t.flags)return t.source;const n={i:t.flags.includes("i"),m:t.flags.includes("m"),s:t.flags.includes("s")},
r=n.i?t.source.toLowerCase():t.source;let i="",s=!1,a=!1,o=!1;for(let l=0;l<r.length;l++){if(s){i+=r[l],s=!1;continue}if(n.i){if(a){if(r[l].match(/[a-z]/)){o?(i+=r[l],i+=`${r[l-2]}-${r[l]}`.toUpperCase(),o=!1):r[l+1]==="-"&&r[l+2]?.match(/[a-z]/)?(i+=r[l],o=!0):i+=`${r[l]}${r[l].toUpperCase()}`;continue}}else if(r[l].match(/[a-z]/)){i+=`[${r[l]}${r[l].toUpperCase()}]`;continue}}if(n.m){if(r[l]==="^"){i+=`(^|(?<=[\r
]))`;continue}else if(r[l]==="$"){i+=`($|(?=[\r
]))`;continue}}if(n.s&&r[l]==="."){i+=a?`${r[l]}\r
`:`[${r[l]}\r
]`;continue}i+=r[l],r[l]==="\\"?s=!0:a&&r[l]==="]"?a=!1:!a&&r[l]==="["&&(a=!0)}try{new RegExp(i)}catch{return console.warn(`Could not convert regex pattern at ${e.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),t.source}return i}function mM(t,e){if(e.target==="openAi"&&console.warn("Warning: OpenAI may not support records in schemas! Try an array of key-value pairs instead."),e.target==="openApi3"&&t.keyType?._def.typeName===we.ZodEnum)return{type:"o\
bject",required:t.keyType._def.values,properties:t.keyType._def.values.reduce((r,i)=>({...r,[i]:Tt(t.valueType._def,{...e,currentPath:[...e.currentPath,"properties",i]})??Cr(e)}),{}),additionalProperties:e.rejectedAdditionalProperties};const n={type:"object",additionalProperties:Tt(t.valueType._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??e.allowedAdditionalProperties};if(e.target==="openApi3")return n;if(t.keyType?._def.typeName===we.ZodString&&t.keyType._def.checks?.length){
const{type:r,...i}=pM(t.keyType._def,e);return{...n,propertyNames:i}}else{if(t.keyType?._def.typeName===we.ZodEnum)return{...n,propertyNames:{enum:t.keyType._def.values}};if(t.keyType?._def.typeName===we.ZodBranded&&t.keyType._def.type._def.typeName===we.ZodString&&t.keyType._def.type._def.checks?.length){const{type:r,...i}=dM(t.keyType._def,e);return{...n,propertyNames:i}}}return n}function Mae(t,e){if(e.mapStrategy==="record")return mM(t,e);const n=Tt(t.keyType._def,{...e,currentPath:[...e.currentPath,
"items","items","0"]})||Cr(e),r=Tt(t.valueType._def,{...e,currentPath:[...e.currentPath,"items","items","1"]})||Cr(e);return{type:"array",maxItems:125,items:{type:"array",items:[n,r],minItems:2,maxItems:2}}}function jae(t){const e=t.values,r=Object.keys(t.values).filter(s=>typeof e[e[s]]!="number").map(s=>e[s]),i=Array.from(new Set(r.map(s=>typeof s)));return{type:i.length===1?i[0]==="string"?"string":"number":["string","number"],enum:r}}function qae(t){return t.target==="openAi"?void 0:{not:Cr(
{...t,currentPath:[...t.currentPath,"not"]})}}function Fae(t){return t.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}const wv={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function zae(t,e){if(e.target==="openApi3")return gM(t,e);const n=t.options instanceof Map?Array.from(t.options.values()):t.options;if(n.every(r=>r._def.typeName in wv&&(!r._def.checks||!r._def.checks.length))){const r=n.reduce((i,s)=>{const a=wv[s._def.typeName];
return a&&!i.includes(a)?[...i,a]:i},[]);return{type:r.length>1?r:r[0]}}else if(n.every(r=>r._def.typeName==="ZodLiteral"&&!r.description)){const r=n.reduce((i,s)=>{const a=typeof s._def.value;switch(a){case"string":case"number":case"boolean":return[...i,a];case"bigint":return[...i,"integer"];case"object":if(s._def.value===null)return[...i,"null"];default:return i}},[]);if(r.length===n.length){const i=r.filter((s,a,o)=>o.indexOf(s)===a);return{type:i.length>1?i:i[0],enum:n.reduce((s,a)=>s.includes(
a._def.value)?s:[...s,a._def.value],[])}}}else if(n.every(r=>r._def.typeName==="ZodEnum"))return{type:"string",enum:n.reduce((r,i)=>[...r,...i._def.values.filter(s=>!r.includes(s))],[])};return gM(t,e)}const gM=(t,e)=>{const n=(t.options instanceof Map?Array.from(t.options.values()):t.options).map((r,i)=>Tt(r._def,{...e,currentPath:[...e.currentPath,"anyOf",`${i}`]})).filter(r=>!!r&&(!e.strictUnions||typeof r=="object"&&Object.keys(r).length>0));return n.length?{anyOf:n}:void 0};function Uae(t,e){
if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(t.innerType._def.typeName)&&(!t.innerType._def.checks||!t.innerType._def.checks.length))return e.target==="openApi3"?{type:wv[t.innerType._def.typeName],nullable:!0}:{type:[wv[t.innerType._def.typeName],"null"]};if(e.target==="openApi3"){const r=Tt(t.innerType._def,{...e,currentPath:[...e.currentPath]});return r&&"$ref"in r?{allOf:[r],nullable:!0}:r&&{...r,nullable:!0}}const n=Tt(t.innerType._def,{...e,currentPath:[...e.currentPath,
"anyOf","0"]});return n&&{anyOf:[n,{type:"null"}]}}function Hae(t,e){const n={type:"number"};if(!t.checks)return n;for(const r of t.checks)switch(r.kind){case"int":n.type="integer",cM(n,"type",r.message,e);break;case"min":e.target==="jsonSchema7"?r.inclusive?Ct(n,"minimum",r.value,r.message,e):Ct(n,"exclusiveMinimum",r.value,r.message,e):(r.inclusive||(n.exclusiveMinimum=!0),Ct(n,"minimum",r.value,r.message,e));break;case"max":e.target==="jsonSchema7"?r.inclusive?Ct(n,"maximum",r.value,r.message,
e):Ct(n,"exclusiveMaximum",r.value,r.message,e):(r.inclusive||(n.exclusiveMaximum=!0),Ct(n,"maximum",r.value,r.message,e));break;case"multipleOf":Ct(n,"multipleOf",r.value,r.message,e);break}return n}function Vae(t,e){const n=e.target==="openAi",r={type:"object",properties:{}},i=[],s=t.shape();for(const o in s){let l=s[o];if(l===void 0||l._def===void 0)continue;let c=Wae(l);c&&n&&(l._def.typeName==="ZodOptional"&&(l=l._def.innerType),l.isNullable()||(l=l.nullable()),c=!1);const u=Tt(l._def,{...e,
currentPath:[...e.currentPath,"properties",o],propertyPath:[...e.currentPath,"properties",o]});u!==void 0&&(r.properties[o]=u,c||i.push(o))}i.length&&(r.required=i);const a=Bae(t,e);return a!==void 0&&(r.additionalProperties=a),r}function Bae(t,e){if(t.catchall._def.typeName!=="ZodNever")return Tt(t.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]});switch(t.unknownKeys){case"passthrough":return e.allowedAdditionalProperties;case"strict":return e.rejectedAdditionalProperties;case"\
strip":return e.removeAdditionalStrategy==="strict"?e.allowedAdditionalProperties:e.rejectedAdditionalProperties}}function Wae(t){try{return t.isOptional()}catch{return!0}}const Gae=(t,e)=>{if(e.currentPath.toString()===e.propertyPath?.toString())return Tt(t.innerType._def,e);const n=Tt(t.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","1"]});return n?{anyOf:[{not:Cr(e)},n]}:Cr(e)},Kae=(t,e)=>{if(e.pipeStrategy==="input")return Tt(t.in._def,e);if(e.pipeStrategy==="output")return Tt(t.
out._def,e);const n=Tt(t.in._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),r=Tt(t.out._def,{...e,currentPath:[...e.currentPath,"allOf",n?"1":"0"]});return{allOf:[n,r].filter(i=>i!==void 0)}};function Zae(t,e){return Tt(t.type._def,e)}function Jae(t,e){const r={type:"array",uniqueItems:!0,items:Tt(t.valueType._def,{...e,currentPath:[...e.currentPath,"items"]})};return t.minSize&&Ct(r,"minItems",t.minSize.value,t.minSize.message,e),t.maxSize&&Ct(r,"maxItems",t.maxSize.value,t.maxSize.message,
e),r}function Yae(t,e){return t.rest?{type:"array",minItems:t.items.length,items:t.items.map((n,r)=>Tt(n._def,{...e,currentPath:[...e.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[]),additionalItems:Tt(t.rest._def,{...e,currentPath:[...e.currentPath,"additionalItems"]})}:{type:"array",minItems:t.items.length,maxItems:t.items.length,items:t.items.map((n,r)=>Tt(n._def,{...e,currentPath:[...e.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[])}}function Xae(t){
return{not:Cr(t)}}function Qae(t){return Cr(t)}const eoe=(t,e)=>Tt(t.innerType._def,e),toe=(t,e,n)=>{switch(e){case we.ZodString:return pM(t,n);case we.ZodNumber:return Hae(t,n);case we.ZodObject:return Vae(t,n);case we.ZodBigInt:return $ae(t,n);case we.ZodBoolean:return Tae();case we.ZodDate:return fM(t,n);case we.ZodUndefined:return Xae(n);case we.ZodNull:return Fae(n);case we.ZodArray:return Sae(t,n);case we.ZodUnion:case we.ZodDiscriminatedUnion:return zae(t,n);case we.ZodIntersection:return Nae(
t,n);case we.ZodTuple:return Yae(t,n);case we.ZodRecord:return mM(t,n);case we.ZodLiteral:return Dae(t,n);case we.ZodEnum:return Aae(t);case we.ZodNativeEnum:return jae(t);case we.ZodNullable:return Uae(t,n);case we.ZodOptional:return Gae(t,n);case we.ZodMap:return Mae(t,n);case we.ZodSet:return Jae(t,n);case we.ZodLazy:return()=>t.getter()._def;case we.ZodPromise:return Zae(t,n);case we.ZodNaN:case we.ZodNever:return qae(n);case we.ZodEffects:return xae(t,n);case we.ZodAny:return Cr(n);case we.
ZodUnknown:return Qae(n);case we.ZodDefault:return Cae(t,n);case we.ZodBranded:return dM(t,n);case we.ZodReadonly:return eoe(t,n);case we.ZodCatch:return Eae(t,n);case we.ZodPipeline:return Kae(t,n);case we.ZodFunction:case we.ZodVoid:case we.ZodSymbol:return;default:return(r=>{})()}};function Tt(t,e,n=!1){const r=e.seen.get(t);if(e.override){const o=e.override?.(t,e,r,n);if(o!==kae)return o}if(r&&!n){const o=noe(r,e);if(o!==void 0)return o}const i={def:t,path:e.currentPath,jsonSchema:void 0};e.
seen.set(t,i);const s=toe(t,t.typeName,e),a=typeof s=="function"?Tt(s(),e):s;if(a&&roe(t,e,a),e.postProcess){const o=e.postProcess(a,t,e);return i.jsonSchema=a,o}return i.jsonSchema=a,a}const noe=(t,e)=>{switch(e.$refStrategy){case"root":return{$ref:t.path.join("/")};case"relative":return{$ref:uM(e.currentPath,t.path)};case"none":case"seen":return t.path.length<e.currentPath.length&&t.path.every((n,r)=>e.currentPath[r]===n)?(console.warn(`Recursive reference detected at ${e.currentPath.join("/")}\
! Defaulting to any`),Cr(e)):e.$refStrategy==="seen"?Cr(e):void 0}},roe=(t,e,n)=>(t.description&&(n.description=t.description,e.markdownDescription&&(n.markdownDescription=t.description)),n),ioe=(t,e)=>{const n=Rae(e);let r=typeof e=="object"&&e.definitions?Object.entries(e.definitions).reduce((l,[c,u])=>({...l,[c]:Tt(u._def,{...n,currentPath:[...n.basePath,n.definitionPath,c]},!0)??Cr(n)}),{}):void 0;const i=typeof e=="string"?e:e?.nameStrategy==="title"?void 0:e?.name,s=Tt(t._def,i===void 0?n:
{...n,currentPath:[...n.basePath,n.definitionPath,i]},!1)??Cr(n),a=typeof e=="object"&&e.name!==void 0&&e.nameStrategy==="title"?e.name:void 0;a!==void 0&&(s.title=a),n.flags.hasReferencedOpenAiAnyType&&(r||(r={}),r[n.openAiAnyTypeName]||(r[n.openAiAnyTypeName]={type:["string","number","integer","boolean","array","null"],items:{$ref:n.$refStrategy==="relative"?"1":[...n.basePath,n.definitionPath,n.openAiAnyTypeName].join("/")}}));const o=i===void 0?r?{...s,[n.definitionPath]:r}:s:{$ref:[...n.$refStrategy===
"relative"?[]:n.basePath,n.definitionPath,i].join("/"),[n.definitionPath]:{...r,[i]:s}};return n.target==="jsonSchema7"?o.$schema="http://json-schema.org/draft-07/schema#":(n.target==="jsonSchema2019-09"||n.target==="openAi")&&(o.$schema="https://json-schema.org/draft/2019-09/schema#"),n.target==="openAi"&&("anyOf"in o||"oneOf"in o||"allOf"in o||"type"in o&&Array.isArray(o.type))&&console.warn("Warning: OpenAI may not support schemas with unions as roots! Try wrapping it in an object property."),
o};function soe(t){return!t||t==="jsonSchema7"||t==="draft-7"?"draft-7":t==="jsonSchema2019-09"||t==="draft-2020-12"?"draft-2020-12":"draft-7"}function yM(t,e){return ls(t)?LX(t,{target:soe(e?.target),io:e?.pipeStrategy??"input"}):ioe(t,{strictUnions:e?.strictUnions??!0,pipeStrategy:e?.pipeStrategy??"input"})}function vM(t){const n=Zp(t)?.method;if(!n)throw new Error("Schema is missing a method literal");const r=oM(n);if(typeof r!="string")throw new Error("Schema method literal must be a string");
return r}function wM(t,e){const n=Kp(t,e);if(!n.success)throw n.error;return n.data}const aoe=6e4;class ooe{constructor(e){this._options=e,this._requestMessageId=0,this._requestHandlers=new Map,this._requestHandlerAbortControllers=new Map,this._notificationHandlers=new Map,this._responseHandlers=new Map,this._progressHandlers=new Map,this._timeoutInfo=new Map,this._pendingDebouncedNotifications=new Set,this._taskProgressTokens=new Map,this._requestResolvers=new Map,this.setNotificationHandler(SR,
n=>{this._oncancel(n)}),this.setNotificationHandler(ER,n=>{this._onprogress(n)}),this.setRequestHandler(TR,n=>({})),this._taskStore=e?.taskStore,this._taskMessageQueue=e?.taskMessageQueue,this._taskStore&&(this.setRequestHandler(PR,async(n,r)=>{const i=await this._taskStore.getTask(n.params.taskId,r.sessionId);if(!i)throw new Le(Fe.InvalidParams,"Failed to retrieve task: Task not found");return{...i}}),this.setRequestHandler(xR,async(n,r)=>{const i=async()=>{const s=n.params.taskId;if(this._taskMessageQueue){
let o;for(;o=await this._taskMessageQueue.dequeue(s,r.sessionId);){if(o.type==="response"||o.type==="error"){const l=o.message,c=l.id,u=this._requestResolvers.get(c);if(u)if(this._requestResolvers.delete(c),o.type==="response")u(l);else{const d=l,f=new Le(d.error.code,d.error.message,d.error.data);u(f)}else{const d=o.type==="response"?"Response":"Error";this._onerror(new Error(`${d} handler missing for request ${c}`))}continue}await this._transport?.send(o.message,{relatedRequestId:r.requestId})}}
const a=await this._taskStore.getTask(s,r.sessionId);if(!a)throw new Le(Fe.InvalidParams,`Task not found: ${s}`);if(!tl(a.status))return await this._waitForTaskUpdate(s,r.signal),await i();if(tl(a.status)){const o=await this._taskStore.getTaskResult(s,r.sessionId);return this._clearTaskQueue(s),{...o,_meta:{...o._meta,[Mo]:{taskId:s}}}}return await i()};return await i()}),this.setRequestHandler(AR,async(n,r)=>{try{const{tasks:i,nextCursor:s}=await this._taskStore.listTasks(n.params?.cursor,r.sessionId);
return{tasks:i,nextCursor:s,_meta:{}}}catch(i){throw new Le(Fe.InvalidParams,`Failed to list tasks: ${i instanceof Error?i.message:String(i)}`)}}),this.setRequestHandler(NR,async(n,r)=>{try{const i=await this._taskStore.getTask(n.params.taskId,r.sessionId);if(!i)throw new Le(Fe.InvalidParams,`Task not found: ${n.params.taskId}`);if(tl(i.status))throw new Le(Fe.InvalidParams,`Cannot cancel task in terminal status: ${i.status}`);await this._taskStore.updateTaskStatus(n.params.taskId,"cancelled","C\
lient cancelled task execution.",r.sessionId),this._clearTaskQueue(n.params.taskId);const s=await this._taskStore.getTask(n.params.taskId,r.sessionId);if(!s)throw new Le(Fe.InvalidParams,`Task not found after cancellation: ${n.params.taskId}`);return{_meta:{},...s}}catch(i){throw i instanceof Le?i:new Le(Fe.InvalidRequest,`Failed to cancel task: ${i instanceof Error?i.message:String(i)}`)}}))}async _oncancel(e){if(!e.params.requestId)return;this._requestHandlerAbortControllers.get(e.params.requestId)?.
abort(e.params.reason)}_setupTimeout(e,n,r,i,s=!1){this._timeoutInfo.set(e,{timeoutId:setTimeout(i,n),startTime:Date.now(),timeout:n,maxTotalTimeout:r,resetTimeoutOnProgress:s,onTimeout:i})}_resetTimeout(e){const n=this._timeoutInfo.get(e);if(!n)return!1;const r=Date.now()-n.startTime;if(n.maxTotalTimeout&&r>=n.maxTotalTimeout)throw this._timeoutInfo.delete(e),Le.fromError(Fe.RequestTimeout,"Maximum total timeout exceeded",{maxTotalTimeout:n.maxTotalTimeout,totalElapsed:r});return clearTimeout(n.
timeoutId),n.timeoutId=setTimeout(n.onTimeout,n.timeout),!0}_cleanupTimeout(e){const n=this._timeoutInfo.get(e);n&&(clearTimeout(n.timeoutId),this._timeoutInfo.delete(e))}async connect(e){this._transport=e;const n=this.transport?.onclose;this._transport.onclose=()=>{n?.(),this._onclose()};const r=this.transport?.onerror;this._transport.onerror=s=>{r?.(s),this._onerror(s)};const i=this._transport?.onmessage;this._transport.onmessage=(s,a)=>{i?.(s,a),jo(s)||Iy(s)?this._onresponse(s):mc(s)?this._onrequest(
s,a):VQ(s)?this._onnotification(s):this._onerror(new Error(`Unknown message type: ${JSON.stringify(s)}`))},await this._transport.start()}_onclose(){const e=this._responseHandlers;this._responseHandlers=new Map,this._progressHandlers.clear(),this._taskProgressTokens.clear(),this._pendingDebouncedNotifications.clear();const n=Le.fromError(Fe.ConnectionClosed,"Connection closed");this._transport=void 0,this.onclose?.();for(const r of e.values())r(n)}_onerror(e){this.onerror?.(e)}_onnotification(e){
const n=this._notificationHandlers.get(e.method)??this.fallbackNotificationHandler;n!==void 0&&Promise.resolve().then(()=>n(e)).catch(r=>this._onerror(new Error(`Uncaught error in notification handler: ${r}`)))}_onrequest(e,n){const r=this._requestHandlers.get(e.method)??this.fallbackRequestHandler,i=this._transport,s=e.params?._meta?.[Mo]?.taskId;if(r===void 0){const u={jsonrpc:"2.0",id:e.id,error:{code:Fe.MethodNotFound,message:"Method not found"}};s&&this._taskMessageQueue?this._enqueueTaskMessage(
s,{type:"error",message:u,timestamp:Date.now()},i?.sessionId).catch(d=>this._onerror(new Error(`Failed to enqueue error response: ${d}`))):i?.send(u).catch(d=>this._onerror(new Error(`Failed to send an error response: ${d}`)));return}const a=new AbortController;this._requestHandlerAbortControllers.set(e.id,a);const o=HQ(e.params)?e.params.task:void 0,l=this._taskStore?this.requestTaskStore(e,i?.sessionId):void 0,c={signal:a.signal,sessionId:i?.sessionId,_meta:e.params?._meta,sendNotification:async u=>{
const d={relatedRequestId:e.id};s&&(d.relatedTask={taskId:s}),await this.notification(u,d)},sendRequest:async(u,d,f)=>{const p={...f,relatedRequestId:e.id};s&&!p.relatedTask&&(p.relatedTask={taskId:s});const m=p.relatedTask?.taskId??s;return m&&l&&await l.updateTaskStatus(m,"input_required"),await this.request(u,d,p)},authInfo:n?.authInfo,requestId:e.id,requestInfo:n?.requestInfo,taskId:s,taskStore:l,taskRequestedTtl:o?.ttl,closeSSEStream:n?.closeSSEStream,closeStandaloneSSEStream:n?.closeStandaloneSSEStream};
Promise.resolve().then(()=>{o&&this.assertTaskHandlerCapability(e.method)}).then(()=>r(e,c)).then(async u=>{if(a.signal.aborted)return;const d={result:u,jsonrpc:"2.0",id:e.id};s&&this._taskMessageQueue?await this._enqueueTaskMessage(s,{type:"response",message:d,timestamp:Date.now()},i?.sessionId):await i?.send(d)},async u=>{if(a.signal.aborted)return;const d={jsonrpc:"2.0",id:e.id,error:{code:Number.isSafeInteger(u.code)?u.code:Fe.InternalError,message:u.message??"Internal error",...u.data!==void 0&&
{data:u.data}}};s&&this._taskMessageQueue?await this._enqueueTaskMessage(s,{type:"error",message:d,timestamp:Date.now()},i?.sessionId):await i?.send(d)}).catch(u=>this._onerror(new Error(`Failed to send response: ${u}`))).finally(()=>{this._requestHandlerAbortControllers.delete(e.id)})}_onprogress(e){const{progressToken:n,...r}=e.params,i=Number(n),s=this._progressHandlers.get(i);if(!s){this._onerror(new Error(`Received a progress notification for an unknown token: ${JSON.stringify(e)}`));return}
const a=this._responseHandlers.get(i),o=this._timeoutInfo.get(i);if(o&&a&&o.resetTimeoutOnProgress)try{this._resetTimeout(i)}catch(l){this._responseHandlers.delete(i),this._progressHandlers.delete(i),this._cleanupTimeout(i),a(l);return}s(r)}_onresponse(e){const n=Number(e.id),r=this._requestResolvers.get(n);if(r){if(this._requestResolvers.delete(n),jo(e))r(e);else{const a=new Le(e.error.code,e.error.message,e.error.data);r(a)}return}const i=this._responseHandlers.get(n);if(i===void 0){this._onerror(
new Error(`Received a response for an unknown message ID: ${JSON.stringify(e)}`));return}this._responseHandlers.delete(n),this._cleanupTimeout(n);let s=!1;if(jo(e)&&e.result&&typeof e.result=="object"){const a=e.result;if(a.task&&typeof a.task=="object"){const o=a.task;typeof o.taskId=="string"&&(s=!0,this._taskProgressTokens.set(o.taskId,n))}}if(s||this._progressHandlers.delete(n),jo(e))i(e);else{const a=Le.fromError(e.error.code,e.error.message,e.error.data);i(a)}}get transport(){return this._transport}async close(){
await this._transport?.close()}async*requestStream(e,n,r){const{task:i}=r??{};if(!i){try{yield{type:"result",result:await this.request(e,n,r)}}catch(a){yield{type:"error",error:a instanceof Le?a:new Le(Fe.InternalError,String(a))}}return}let s;try{const a=await this.request(e,Ny,r);if(a.task)s=a.task.taskId,yield{type:"taskCreated",task:a.task};else throw new Le(Fe.InternalError,"Task creation did not return a task");for(;;){const o=await this.getTask({taskId:s},r);if(yield{type:"taskStatus",task:o},
tl(o.status)){o.status==="completed"?yield{type:"result",result:await this.getTaskResult({taskId:s},n,r)}:o.status==="failed"?yield{type:"error",error:new Le(Fe.InternalError,`Task ${s} failed`)}:o.status==="cancelled"&&(yield{type:"error",error:new Le(Fe.InternalError,`Task ${s} was cancelled`)});return}if(o.status==="input_required"){yield{type:"result",result:await this.getTaskResult({taskId:s},n,r)};return}const l=o.pollInterval??this._options?.defaultTaskPollInterval??1e3;await new Promise(
c=>setTimeout(c,l)),r?.signal?.throwIfAborted()}}catch(a){yield{type:"error",error:a instanceof Le?a:new Le(Fe.InternalError,String(a))}}}request(e,n,r){const{relatedRequestId:i,resumptionToken:s,onresumptiontoken:a,task:o,relatedTask:l}=r??{};return new Promise((c,u)=>{const d=h=>{u(h)};if(!this._transport){d(new Error("Not connected"));return}if(this._options?.enforceStrictCapabilities===!0)try{this.assertCapabilityForMethod(e.method),o&&this.assertTaskCapability(e.method)}catch(h){d(h);return}
r?.signal?.throwIfAborted();const f=this._requestMessageId++,p={...e,jsonrpc:"2.0",id:f};r?.onprogress&&(this._progressHandlers.set(f,r.onprogress),p.params={...e.params,_meta:{...e.params?._meta||{},progressToken:f}}),o&&(p.params={...p.params,task:o}),l&&(p.params={...p.params,_meta:{...p.params?._meta||{},[Mo]:l}});const m=h=>{this._responseHandlers.delete(f),this._progressHandlers.delete(f),this._cleanupTimeout(f),this._transport?.send({jsonrpc:"2.0",method:"notifications/cancelled",params:{
requestId:f,reason:String(h)}},{relatedRequestId:i,resumptionToken:s,onresumptiontoken:a}).catch(b=>this._onerror(new Error(`Failed to send cancellation: ${b}`)));const y=h instanceof Le?h:new Le(Fe.RequestTimeout,String(h));u(y)};this._responseHandlers.set(f,h=>{if(!r?.signal?.aborted){if(h instanceof Error)return u(h);try{const y=Kp(n,h.result);y.success?c(y.data):u(y.error)}catch(y){u(y)}}}),r?.signal?.addEventListener("abort",()=>{m(r?.signal?.reason)});const w=r?.timeout??aoe,v=()=>m(Le.fromError(
Fe.RequestTimeout,"Request timed out",{timeout:w}));this._setupTimeout(f,w,r?.maxTotalTimeout,v,r?.resetTimeoutOnProgress??!1);const g=l?.taskId;if(g){const h=y=>{const b=this._responseHandlers.get(f);b?b(y):this._onerror(new Error(`Response handler missing for side-channeled request ${f}`))};this._requestResolvers.set(f,h),this._enqueueTaskMessage(g,{type:"request",message:p,timestamp:Date.now()}).catch(y=>{this._cleanupTimeout(f),u(y)})}else this._transport.send(p,{relatedRequestId:i,resumptionToken:s,
onresumptiontoken:a}).catch(h=>{this._cleanupTimeout(f),u(h)})})}async getTask(e,n){return this.request({method:"tasks/get",params:e},CR,n)}async getTaskResult(e,n,r){return this.request({method:"tasks/result",params:e},n,r)}async listTasks(e,n){return this.request({method:"tasks/list",params:e},IR,n)}async cancelTask(e,n){return this.request({method:"tasks/cancel",params:e},aee,n)}async notification(e,n){if(!this._transport)throw new Error("Not connected");this.assertNotificationCapability(e.method);
const r=n?.relatedTask?.taskId;if(r){const o={...e,jsonrpc:"2.0",params:{...e.params,_meta:{...e.params?._meta||{},[Mo]:n.relatedTask}}};await this._enqueueTaskMessage(r,{type:"notification",message:o,timestamp:Date.now()});return}if((this._options?.debouncedNotificationMethods??[]).includes(e.method)&&!e.params&&!n?.relatedRequestId&&!n?.relatedTask){if(this._pendingDebouncedNotifications.has(e.method))return;this._pendingDebouncedNotifications.add(e.method),Promise.resolve().then(()=>{if(this.
_pendingDebouncedNotifications.delete(e.method),!this._transport)return;let o={...e,jsonrpc:"2.0"};n?.relatedTask&&(o={...o,params:{...o.params,_meta:{...o.params?._meta||{},[Mo]:n.relatedTask}}}),this._transport?.send(o,n).catch(l=>this._onerror(l))});return}let a={...e,jsonrpc:"2.0"};n?.relatedTask&&(a={...a,params:{...a.params,_meta:{...a.params?._meta||{},[Mo]:n.relatedTask}}}),await this._transport.send(a,n)}setRequestHandler(e,n){const r=vM(e);this.assertRequestHandlerCapability(r),this._requestHandlers.
set(r,(i,s)=>{const a=wM(e,i);return Promise.resolve(n(a,s))})}removeRequestHandler(e){this._requestHandlers.delete(e)}assertCanSetRequestHandler(e){if(this._requestHandlers.has(e))throw new Error(`A request handler for ${e} already exists, which would be overridden`)}setNotificationHandler(e,n){const r=vM(e);this._notificationHandlers.set(r,i=>{const s=wM(e,i);return Promise.resolve(n(s))})}removeNotificationHandler(e){this._notificationHandlers.delete(e)}_cleanupTaskProgressHandler(e){const n=this.
_taskProgressTokens.get(e);n!==void 0&&(this._progressHandlers.delete(n),this._taskProgressTokens.delete(e))}async _enqueueTaskMessage(e,n,r){if(!this._taskStore||!this._taskMessageQueue)throw new Error("Cannot enqueue task message: taskStore and taskMessageQueue are not configured");const i=this._options?.maxTaskQueueSize;await this._taskMessageQueue.enqueue(e,n,r,i)}async _clearTaskQueue(e,n){if(this._taskMessageQueue){const r=await this._taskMessageQueue.dequeueAll(e,n);for(const i of r)if(i.
type==="request"&&mc(i.message)){const s=i.message.id,a=this._requestResolvers.get(s);a?(a(new Le(Fe.InternalError,"Task cancelled or completed")),this._requestResolvers.delete(s)):this._onerror(new Error(`Resolver missing for request ${s} during task ${e} cleanup`))}}}async _waitForTaskUpdate(e,n){let r=this._options?.defaultTaskPollInterval??1e3;try{const i=await this._taskStore?.getTask(e);i?.pollInterval&&(r=i.pollInterval)}catch{}return new Promise((i,s)=>{if(n.aborted){s(new Le(Fe.InvalidRequest,
"Request cancelled"));return}const a=setTimeout(i,r);n.addEventListener("abort",()=>{clearTimeout(a),s(new Le(Fe.InvalidRequest,"Request cancelled"))},{once:!0})})}requestTaskStore(e,n){const r=this._taskStore;if(!r)throw new Error("No task store configured");return{createTask:async i=>{if(!e)throw new Error("No request provided");return await r.createTask(i,e.id,{method:e.method,params:e.params},n)},getTask:async i=>{const s=await r.getTask(i,n);if(!s)throw new Le(Fe.InvalidParams,"Failed to re\
trieve task: Task not found");return s},storeTaskResult:async(i,s,a)=>{await r.storeTaskResult(i,s,a,n);const o=await r.getTask(i,n);if(o){const l=Dy.parse({method:"notifications/tasks/status",params:o});await this.notification(l),tl(o.status)&&this._cleanupTaskProgressHandler(i)}},getTaskResult:i=>r.getTaskResult(i,n),updateTaskStatus:async(i,s,a)=>{const o=await r.getTask(i,n);if(!o)throw new Le(Fe.InvalidParams,`Task "${i}" not found - it may have been cleaned up`);if(tl(o.status))throw new Le(
Fe.InvalidParams,`Cannot update task "${i}" from terminal status "${o.status}" to "${s}". Terminal states (completed, failed, cancelled) cannot transition to other states.`);await r.updateTaskStatus(i,s,a,n);const l=await r.getTask(i,n);if(l){const c=Dy.parse({method:"notifications/tasks/status",params:l});await this.notification(c),tl(l.status)&&this._cleanupTaskProgressHandler(i)}},listTasks:i=>r.listTasks(i,n)}}}function bM(t){return t!==null&&typeof t=="object"&&!Array.isArray(t)}function loe(t,e){
const n={...t};for(const r in e){const i=r,s=e[i];if(s===void 0)continue;const a=n[i];bM(a)&&bM(s)?n[i]={...a,...s}:n[i]=s}return n}var bv={exports:{}},GS={},Hs={},nl={},KS={},ZS={},JS={},kM;function kv(){return kM||(kM=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.regexpCode=t.getEsmExportName=t.getProperty=t.safeStringify=t.stringify=t.strConcat=t.addCodeArg=t.str=t._=t.nil=t._Code=t.Name=t.IDENTIFIER=t._CodeOrName=void 0;class e{}t._CodeOrName=e,t.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;
class n extends e{constructor(h){if(super(),!t.IDENTIFIER.test(h))throw new Error("CodeGen: name must be a valid identifier");this.str=h}toString(){return this.str}emptyStr(){return!1}get names(){return{[this.str]:1}}}t.Name=n;class r extends e{constructor(h){super(),this._items=typeof h=="string"?[h]:h}toString(){return this.str}emptyStr(){if(this._items.length>1)return!1;const h=this._items[0];return h===""||h==='""'}get str(){var h;return(h=this._str)!==null&&h!==void 0?h:this._str=this._items.
reduce((y,b)=>`${y}${b}`,"")}get names(){var h;return(h=this._names)!==null&&h!==void 0?h:this._names=this._items.reduce((y,b)=>(b instanceof n&&(y[b.str]=(y[b.str]||0)+1),y),{})}}t._Code=r,t.nil=new r("");function i(g,...h){const y=[g[0]];let b=0;for(;b<h.length;)o(y,h[b]),y.push(g[++b]);return new r(y)}t._=i;const s=new r("+");function a(g,...h){const y=[p(g[0])];let b=0;for(;b<h.length;)y.push(s),o(y,h[b]),y.push(s,p(g[++b]));return l(y),new r(y)}t.str=a;function o(g,h){h instanceof r?g.push(
...h._items):h instanceof n?g.push(h):g.push(d(h))}t.addCodeArg=o;function l(g){let h=1;for(;h<g.length-1;){if(g[h]===s){const y=c(g[h-1],g[h+1]);if(y!==void 0){g.splice(h-1,3,y);continue}g[h++]="+"}h++}}function c(g,h){if(h==='""')return g;if(g==='""')return h;if(typeof g=="string")return h instanceof n||g[g.length-1]!=='"'?void 0:typeof h!="string"?`${g.slice(0,-1)}${h}"`:h[0]==='"'?g.slice(0,-1)+h.slice(1):void 0;if(typeof h=="string"&&h[0]==='"'&&!(g instanceof n))return`"${g}${h.slice(1)}`}
function u(g,h){return h.emptyStr()?g:g.emptyStr()?h:a`${g}${h}`}t.strConcat=u;function d(g){return typeof g=="number"||typeof g=="boolean"||g===null?g:p(Array.isArray(g)?g.join(","):g)}function f(g){return new r(p(g))}t.stringify=f;function p(g){return JSON.stringify(g).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}t.safeStringify=p;function m(g){return typeof g=="string"&&t.IDENTIFIER.test(g)?new r(`.${g}`):i`[${g}]`}t.getProperty=m;function w(g){if(typeof g=="string"&&t.IDENTIFIER.
test(g))return new r(`${g}`);throw new Error(`CodeGen: invalid export name: ${g}, use explicit $id name mapping`)}t.getEsmExportName=w;function v(g){return new r(g.toString())}t.regexpCode=v})(JS)),JS}var YS={},_M;function RM(){return _M||(_M=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ValueScope=t.ValueScopeName=t.Scope=t.varKinds=t.UsedValueState=void 0;const e=kv();class n extends Error{constructor(c){super(`CodeGen: "code" for ${c} not defined`),this.value=c.value}}var r;
(function(l){l[l.Started=0]="Started",l[l.Completed=1]="Completed"})(r||(t.UsedValueState=r={})),t.varKinds={const:new e.Name("const"),let:new e.Name("let"),var:new e.Name("var")};class i{constructor({prefixes:c,parent:u}={}){this._names={},this._prefixes=c,this._parent=u}toName(c){return c instanceof e.Name?c:this.name(c)}name(c){return new e.Name(this._newName(c))}_newName(c){const u=this._names[c]||this._nameGroup(c);return`${c}${u.index++}`}_nameGroup(c){var u,d;if(!((d=(u=this._parent)===null||
u===void 0?void 0:u._prefixes)===null||d===void 0)&&d.has(c)||this._prefixes&&!this._prefixes.has(c))throw new Error(`CodeGen: prefix "${c}" is not allowed in this scope`);return this._names[c]={prefix:c,index:0}}}t.Scope=i;class s extends e.Name{constructor(c,u){super(u),this.prefix=c}setValue(c,{property:u,itemIndex:d}){this.value=c,this.scopePath=(0,e._)`.${new e.Name(u)}[${d}]`}}t.ValueScopeName=s;const a=(0,e._)`\n`;class o extends i{constructor(c){super(c),this._values={},this._scope=c.scope,
this.opts={...c,_n:c.lines?a:e.nil}}get(){return this._scope}name(c){return new s(c,this._newName(c))}value(c,u){var d;if(u.ref===void 0)throw new Error("CodeGen: ref must be passed in value");const f=this.toName(c),{prefix:p}=f,m=(d=u.key)!==null&&d!==void 0?d:u.ref;let w=this._values[p];if(w){const h=w.get(m);if(h)return h}else w=this._values[p]=new Map;w.set(m,f);const v=this._scope[p]||(this._scope[p]=[]),g=v.length;return v[g]=u.ref,f.setValue(u,{property:p,itemIndex:g}),f}getValue(c,u){const d=this.
_values[c];if(d)return d.get(u)}scopeRefs(c,u=this._values){return this._reduceValues(u,d=>{if(d.scopePath===void 0)throw new Error(`CodeGen: name "${d}" has no value`);return(0,e._)`${c}${d.scopePath}`})}scopeCode(c=this._values,u,d){return this._reduceValues(c,f=>{if(f.value===void 0)throw new Error(`CodeGen: name "${f}" has no value`);return f.value.code},u,d)}_reduceValues(c,u,d={},f){let p=e.nil;for(const m in c){const w=c[m];if(!w)continue;const v=d[m]=d[m]||new Map;w.forEach(g=>{if(v.has(
g))return;v.set(g,r.Started);let h=u(g);if(h){const y=this.opts.es5?t.varKinds.var:t.varKinds.const;p=(0,e._)`${p}${y} ${g} = ${h};${this.opts._n}`}else if(h=f?.(g))p=(0,e._)`${p}${h}${this.opts._n}`;else throw new n(g);v.set(g,r.Completed)})}return p}}t.ValueScope=o})(YS)),YS}var SM;function et(){return SM||(SM=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.or=t.and=t.not=t.CodeGen=t.operators=t.varKinds=t.ValueScopeName=t.ValueScope=t.Scope=t.Name=t.regexpCode=t.stringify=t.
getProperty=t.nil=t.strConcat=t.str=t._=void 0;const e=kv(),n=RM();var r=kv();Object.defineProperty(t,"_",{enumerable:!0,get:function(){return r._}}),Object.defineProperty(t,"str",{enumerable:!0,get:function(){return r.str}}),Object.defineProperty(t,"strConcat",{enumerable:!0,get:function(){return r.strConcat}}),Object.defineProperty(t,"nil",{enumerable:!0,get:function(){return r.nil}}),Object.defineProperty(t,"getProperty",{enumerable:!0,get:function(){return r.getProperty}}),Object.defineProperty(
t,"stringify",{enumerable:!0,get:function(){return r.stringify}}),Object.defineProperty(t,"regexpCode",{enumerable:!0,get:function(){return r.regexpCode}}),Object.defineProperty(t,"Name",{enumerable:!0,get:function(){return r.Name}});var i=RM();Object.defineProperty(t,"Scope",{enumerable:!0,get:function(){return i.Scope}}),Object.defineProperty(t,"ValueScope",{enumerable:!0,get:function(){return i.ValueScope}}),Object.defineProperty(t,"ValueScopeName",{enumerable:!0,get:function(){return i.ValueScopeName}}),
Object.defineProperty(t,"varKinds",{enumerable:!0,get:function(){return i.varKinds}}),t.operators={GT:new e._Code(">"),GTE:new e._Code(">="),LT:new e._Code("<"),LTE:new e._Code("<="),EQ:new e._Code("==="),NEQ:new e._Code("!=="),NOT:new e._Code("!"),OR:new e._Code("||"),AND:new e._Code("&&"),ADD:new e._Code("+")};class s{optimizeNodes(){return this}optimizeNames(_,I){return this}}class a extends s{constructor(_,I,Y){super(),this.varKind=_,this.name=I,this.rhs=Y}render({es5:_,_n:I}){const Y=_?n.varKinds.
var:this.varKind,se=this.rhs===void 0?"":` = ${this.rhs}`;return`${Y} ${this.name}${se};`+I}optimizeNames(_,I){if(_[this.name.str])return this.rhs&&(this.rhs=z(this.rhs,_,I)),this}get names(){return this.rhs instanceof e._CodeOrName?this.rhs.names:{}}}class o extends s{constructor(_,I,Y){super(),this.lhs=_,this.rhs=I,this.sideEffects=Y}render({_n:_}){return`${this.lhs} = ${this.rhs};`+_}optimizeNames(_,I){if(!(this.lhs instanceof e.Name&&!_[this.lhs.str]&&!this.sideEffects))return this.rhs=z(this.
rhs,_,I),this}get names(){const _=this.lhs instanceof e.Name?{}:{...this.lhs.names};return $(_,this.rhs)}}class l extends o{constructor(_,I,Y,se){super(_,Y,se),this.op=I}render({_n:_}){return`${this.lhs} ${this.op}= ${this.rhs};`+_}}class c extends s{constructor(_){super(),this.label=_,this.names={}}render({_n:_}){return`${this.label}:`+_}}class u extends s{constructor(_){super(),this.label=_,this.names={}}render({_n:_}){return`break${this.label?` ${this.label}`:""};`+_}}class d extends s{constructor(_){
super(),this.error=_}render({_n:_}){return`throw ${this.error};`+_}get names(){return this.error.names}}class f extends s{constructor(_){super(),this.code=_}render({_n:_}){return`${this.code};`+_}optimizeNodes(){return`${this.code}`?this:void 0}optimizeNames(_,I){return this.code=z(this.code,_,I),this}get names(){return this.code instanceof e._CodeOrName?this.code.names:{}}}class p extends s{constructor(_=[]){super(),this.nodes=_}render(_){return this.nodes.reduce((I,Y)=>I+Y.render(_),"")}optimizeNodes(){
const{nodes:_}=this;let I=_.length;for(;I--;){const Y=_[I].optimizeNodes();Array.isArray(Y)?_.splice(I,1,...Y):Y?_[I]=Y:_.splice(I,1)}return _.length>0?this:void 0}optimizeNames(_,I){const{nodes:Y}=this;let se=Y.length;for(;se--;){const fe=Y[se];fe.optimizeNames(_,I)||(j(_,fe.names),Y.splice(se,1))}return Y.length>0?this:void 0}get names(){return this.nodes.reduce((_,I)=>E(_,I.names),{})}}class m extends p{render(_){return"{"+_._n+super.render(_)+"}"+_._n}}class w extends p{}class v extends m{}v.
kind="else";class g extends m{constructor(_,I){super(I),this.condition=_}render(_){let I=`if(${this.condition})`+super.render(_);return this.else&&(I+="else "+this.else.render(_)),I}optimizeNodes(){super.optimizeNodes();const _=this.condition;if(_===!0)return this.nodes;let I=this.else;if(I){const Y=I.optimizeNodes();I=this.else=Array.isArray(Y)?new v(Y):Y}if(I)return _===!1?I instanceof g?I:I.nodes:this.nodes.length?this:new g(U(_),I instanceof g?[I]:I.nodes);if(!(_===!1||!this.nodes.length))return this}optimizeNames(_,I){
var Y;if(this.else=(Y=this.else)===null||Y===void 0?void 0:Y.optimizeNames(_,I),!!(super.optimizeNames(_,I)||this.else))return this.condition=z(this.condition,_,I),this}get names(){const _=super.names;return $(_,this.condition),this.else&&E(_,this.else.names),_}}g.kind="if";class h extends m{}h.kind="for";class y extends h{constructor(_){super(),this.iteration=_}render(_){return`for(${this.iteration})`+super.render(_)}optimizeNames(_,I){if(super.optimizeNames(_,I))return this.iteration=z(this.iteration,
_,I),this}get names(){return E(super.names,this.iteration.names)}}class b extends h{constructor(_,I,Y,se){super(),this.varKind=_,this.name=I,this.from=Y,this.to=se}render(_){const I=_.es5?n.varKinds.var:this.varKind,{name:Y,from:se,to:fe}=this;return`for(${I} ${Y}=${se}; ${Y}<${fe}; ${Y}++)`+super.render(_)}get names(){const _=$(super.names,this.from);return $(_,this.to)}}class R extends h{constructor(_,I,Y,se){super(),this.loop=_,this.varKind=I,this.name=Y,this.iterable=se}render(_){return`for(${this.
varKind} ${this.name} ${this.loop} ${this.iterable})`+super.render(_)}optimizeNames(_,I){if(super.optimizeNames(_,I))return this.iterable=z(this.iterable,_,I),this}get names(){return E(super.names,this.iterable.names)}}class T extends m{constructor(_,I,Y){super(),this.name=_,this.args=I,this.async=Y}render(_){return`${this.async?"async ":""}function ${this.name}(${this.args})`+super.render(_)}}T.kind="func";class N extends p{render(_){return"return "+super.render(_)}}N.kind="return";class q extends m{render(_){
let I="try"+super.render(_);return this.catch&&(I+=this.catch.render(_)),this.finally&&(I+=this.finally.render(_)),I}optimizeNodes(){var _,I;return super.optimizeNodes(),(_=this.catch)===null||_===void 0||_.optimizeNodes(),(I=this.finally)===null||I===void 0||I.optimizeNodes(),this}optimizeNames(_,I){var Y,se;return super.optimizeNames(_,I),(Y=this.catch)===null||Y===void 0||Y.optimizeNames(_,I),(se=this.finally)===null||se===void 0||se.optimizeNames(_,I),this}get names(){const _=super.names;return this.
catch&&E(_,this.catch.names),this.finally&&E(_,this.finally.names),_}}class B extends m{constructor(_){super(),this.error=_}render(_){return`catch(${this.error})`+super.render(_)}}B.kind="catch";class ie extends m{render(_){return"finally"+super.render(_)}}ie.kind="finally";class L{constructor(_,I={}){this._values={},this._blockStarts=[],this._constants={},this.opts={...I,_n:I.lines?`
`:""},this._extScope=_,this._scope=new n.Scope({parent:_}),this._nodes=[new w]}toString(){return this._root.render(this.opts)}name(_){return this._scope.name(_)}scopeName(_){return this._extScope.name(_)}scopeValue(_,I){const Y=this._extScope.value(_,I);return(this._values[Y.prefix]||(this._values[Y.prefix]=new Set)).add(Y),Y}getScopeValue(_,I){return this._extScope.getValue(_,I)}scopeRefs(_){return this._extScope.scopeRefs(_,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def(_,I,Y,se){
const fe=this._scope.toName(I);return Y!==void 0&&se&&(this._constants[fe.str]=Y),this._leafNode(new a(_,fe,Y)),fe}const(_,I,Y){return this._def(n.varKinds.const,_,I,Y)}let(_,I,Y){return this._def(n.varKinds.let,_,I,Y)}var(_,I,Y){return this._def(n.varKinds.var,_,I,Y)}assign(_,I,Y){return this._leafNode(new o(_,I,Y))}add(_,I){return this._leafNode(new l(_,t.operators.ADD,I))}code(_){return typeof _=="function"?_():_!==e.nil&&this._leafNode(new f(_)),this}object(..._){const I=["{"];for(const[Y,se]of _)
I.length>1&&I.push(","),I.push(Y),(Y!==se||this.opts.es5)&&(I.push(":"),(0,e.addCodeArg)(I,se));return I.push("}"),new e._Code(I)}if(_,I,Y){if(this._blockNode(new g(_)),I&&Y)this.code(I).else().code(Y).endIf();else if(I)this.code(I).endIf();else if(Y)throw new Error('CodeGen: "else" body without "then" body');return this}elseIf(_){return this._elseNode(new g(_))}else(){return this._elseNode(new v)}endIf(){return this._endBlockNode(g,v)}_for(_,I){return this._blockNode(_),I&&this.code(I).endFor(),
this}for(_,I){return this._for(new y(_),I)}forRange(_,I,Y,se,fe=this.opts.es5?n.varKinds.var:n.varKinds.let){const _e=this._scope.toName(_);return this._for(new b(fe,_e,I,Y),()=>se(_e))}forOf(_,I,Y,se=n.varKinds.const){const fe=this._scope.toName(_);if(this.opts.es5){const _e=I instanceof e.Name?I:this.var("_arr",I);return this.forRange("_i",0,(0,e._)`${_e}.length`,pe=>{this.var(fe,(0,e._)`${_e}[${pe}]`),Y(fe)})}return this._for(new R("of",se,fe,I),()=>Y(fe))}forIn(_,I,Y,se=this.opts.es5?n.varKinds.
var:n.varKinds.const){if(this.opts.ownProperties)return this.forOf(_,(0,e._)`Object.keys(${I})`,Y);const fe=this._scope.toName(_);return this._for(new R("in",se,fe,I),()=>Y(fe))}endFor(){return this._endBlockNode(h)}label(_){return this._leafNode(new c(_))}break(_){return this._leafNode(new u(_))}return(_){const I=new N;if(this._blockNode(I),this.code(_),I.nodes.length!==1)throw new Error('CodeGen: "return" should have one node');return this._endBlockNode(N)}try(_,I,Y){if(!I&&!Y)throw new Error(
'CodeGen: "try" without "catch" and "finally"');const se=new q;if(this._blockNode(se),this.code(_),I){const fe=this.name("e");this._currNode=se.catch=new B(fe),I(fe)}return Y&&(this._currNode=se.finally=new ie,this.code(Y)),this._endBlockNode(B,ie)}throw(_){return this._leafNode(new d(_))}block(_,I){return this._blockStarts.push(this._nodes.length),_&&this.code(_).endBlock(I),this}endBlock(_){const I=this._blockStarts.pop();if(I===void 0)throw new Error("CodeGen: not in self-balancing block");const Y=this.
_nodes.length-I;if(Y<0||_!==void 0&&Y!==_)throw new Error(`CodeGen: wrong number of nodes: ${Y} vs ${_} expected`);return this._nodes.length=I,this}func(_,I=e.nil,Y,se){return this._blockNode(new T(_,I,Y)),se&&this.code(se).endFunc(),this}endFunc(){return this._endBlockNode(T)}optimize(_=1){for(;_-- >0;)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants)}_leafNode(_){return this._currNode.nodes.push(_),this}_blockNode(_){this._currNode.nodes.push(_),this._nodes.
push(_)}_endBlockNode(_,I){const Y=this._currNode;if(Y instanceof _||I&&Y instanceof I)return this._nodes.pop(),this;throw new Error(`CodeGen: not in block "${I?`${_.kind}/${I.kind}`:_.kind}"`)}_elseNode(_){const I=this._currNode;if(!(I instanceof g))throw new Error('CodeGen: "else" without "if"');return this._currNode=I.else=_,this}get _root(){return this._nodes[0]}get _currNode(){const _=this._nodes;return _[_.length-1]}set _currNode(_){const I=this._nodes;I[I.length-1]=_}}t.CodeGen=L;function E(G,_){
for(const I in _)G[I]=(G[I]||0)+(_[I]||0);return G}function $(G,_){return _ instanceof e._CodeOrName?E(G,_.names):G}function z(G,_,I){if(G instanceof e.Name)return Y(G);if(!se(G))return G;return new e._Code(G._items.reduce((fe,_e)=>(_e instanceof e.Name&&(_e=Y(_e)),_e instanceof e._Code?fe.push(..._e._items):fe.push(_e),fe),[]));function Y(fe){const _e=I[fe.str];return _e===void 0||_[fe.str]!==1?fe:(delete _[fe.str],_e)}function se(fe){return fe instanceof e._Code&&fe._items.some(_e=>_e instanceof
e.Name&&_[_e.str]===1&&I[_e.str]!==void 0)}}function j(G,_){for(const I in _)G[I]=(G[I]||0)-(_[I]||0)}function U(G){return typeof G=="boolean"||typeof G=="number"||G===null?!G:(0,e._)`!${J(G)}`}t.not=U;const W=M(t.operators.AND);function le(...G){return G.reduce(W)}t.and=le;const ne=M(t.operators.OR);function P(...G){return G.reduce(ne)}t.or=P;function M(G){return(_,I)=>_===e.nil?I:I===e.nil?_:(0,e._)`${J(_)} ${G} ${J(I)}`}function J(G){return G instanceof e.Name?G:(0,e._)`(${G})`}})(ZS)),ZS}var it={},
$M;function bt(){if($M)return it;$M=1,Object.defineProperty(it,"__esModule",{value:!0}),it.checkStrictMode=it.getErrorPath=it.Type=it.useFunc=it.setEvaluated=it.evaluatedPropsToName=it.mergeEvaluated=it.eachItem=it.unescapeJsonPointer=it.escapeJsonPointer=it.escapeFragment=it.unescapeFragment=it.schemaRefOrVal=it.schemaHasRulesButRef=it.schemaHasRules=it.checkUnknownRules=it.alwaysValidSchema=it.toHash=void 0;const t=et(),e=kv();function n(R){const T={};for(const N of R)T[N]=!0;return T}it.toHash=
n;function r(R,T){return typeof T=="boolean"?T:Object.keys(T).length===0?!0:(i(R,T),!s(T,R.self.RULES.all))}it.alwaysValidSchema=r;function i(R,T=R.schema){const{opts:N,self:q}=R;if(!N.strictSchema||typeof T=="boolean")return;const B=q.RULES.keywords;for(const ie in T)B[ie]||b(R,`unknown keyword: "${ie}"`)}it.checkUnknownRules=i;function s(R,T){if(typeof R=="boolean")return!R;for(const N in R)if(T[N])return!0;return!1}it.schemaHasRules=s;function a(R,T){if(typeof R=="boolean")return!R;for(const N in R)
if(N!=="$ref"&&T.all[N])return!0;return!1}it.schemaHasRulesButRef=a;function o({topSchemaRef:R,schemaPath:T},N,q,B){if(!B){if(typeof N=="number"||typeof N=="boolean")return N;if(typeof N=="string")return(0,t._)`${N}`}return(0,t._)`${R}${T}${(0,t.getProperty)(q)}`}it.schemaRefOrVal=o;function l(R){return d(decodeURIComponent(R))}it.unescapeFragment=l;function c(R){return encodeURIComponent(u(R))}it.escapeFragment=c;function u(R){return typeof R=="number"?`${R}`:R.replace(/~/g,"~0").replace(/\//g,
"~1")}it.escapeJsonPointer=u;function d(R){return R.replace(/~1/g,"/").replace(/~0/g,"~")}it.unescapeJsonPointer=d;function f(R,T){if(Array.isArray(R))for(const N of R)T(N);else T(R)}it.eachItem=f;function p({mergeNames:R,mergeToName:T,mergeValues:N,resultToName:q}){return(B,ie,L,E)=>{const $=L===void 0?ie:L instanceof t.Name?(ie instanceof t.Name?R(B,ie,L):T(B,ie,L),L):ie instanceof t.Name?(T(B,L,ie),ie):N(ie,L);return E===t.Name&&!($ instanceof t.Name)?q(B,$):$}}it.mergeEvaluated={props:p({mergeNames:(R,T,N)=>R.
if((0,t._)`${N} !== true && ${T} !== undefined`,()=>{R.if((0,t._)`${T} === true`,()=>R.assign(N,!0),()=>R.assign(N,(0,t._)`${N} || {}`).code((0,t._)`Object.assign(${N}, ${T})`))}),mergeToName:(R,T,N)=>R.if((0,t._)`${N} !== true`,()=>{T===!0?R.assign(N,!0):(R.assign(N,(0,t._)`${N} || {}`),w(R,N,T))}),mergeValues:(R,T)=>R===!0?!0:{...R,...T},resultToName:m}),items:p({mergeNames:(R,T,N)=>R.if((0,t._)`${N} !== true && ${T} !== undefined`,()=>R.assign(N,(0,t._)`${T} === true ? true : ${N} > ${T} ? ${N} : ${T}`)),
mergeToName:(R,T,N)=>R.if((0,t._)`${N} !== true`,()=>R.assign(N,T===!0?!0:(0,t._)`${N} > ${T} ? ${N} : ${T}`)),mergeValues:(R,T)=>R===!0?!0:Math.max(R,T),resultToName:(R,T)=>R.var("items",T)})};function m(R,T){if(T===!0)return R.var("props",!0);const N=R.var("props",(0,t._)`{}`);return T!==void 0&&w(R,N,T),N}it.evaluatedPropsToName=m;function w(R,T,N){Object.keys(N).forEach(q=>R.assign((0,t._)`${T}${(0,t.getProperty)(q)}`,!0))}it.setEvaluated=w;const v={};function g(R,T){return R.scopeValue("fun\
c",{ref:T,code:v[T.code]||(v[T.code]=new e._Code(T.code))})}it.useFunc=g;var h;(function(R){R[R.Num=0]="Num",R[R.Str=1]="Str"})(h||(it.Type=h={}));function y(R,T,N){if(R instanceof t.Name){const q=T===h.Num;return N?q?(0,t._)`"[" + ${R} + "]"`:(0,t._)`"['" + ${R} + "']"`:q?(0,t._)`"/" + ${R}`:(0,t._)`"/" + ${R}.replace(/~/g, "~0").replace(/\\//g, "~1")`}return N?(0,t.getProperty)(R).toString():"/"+u(R)}it.getErrorPath=y;function b(R,T,N=R.opts.strictSchema){if(N){if(T=`strict mode: ${T}`,N===!0)
throw new Error(T);R.self.logger.warn(T)}}return it.checkStrictMode=b,it}var _v={},TM;function Vs(){if(TM)return _v;TM=1,Object.defineProperty(_v,"__esModule",{value:!0});const t=et(),e={data:new t.Name("data"),valCxt:new t.Name("valCxt"),instancePath:new t.Name("instancePath"),parentData:new t.Name("parentData"),parentDataProperty:new t.Name("parentDataProperty"),rootData:new t.Name("rootData"),dynamicAnchors:new t.Name("dynamicAnchors"),vErrors:new t.Name("vErrors"),errors:new t.Name("errors"),
this:new t.Name("this"),self:new t.Name("self"),scope:new t.Name("scope"),json:new t.Name("json"),jsonPos:new t.Name("jsonPos"),jsonLen:new t.Name("jsonLen"),jsonPart:new t.Name("jsonPart")};return _v.default=e,_v}var EM;function Rv(){return EM||(EM=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.extendErrors=t.resetErrorsCount=t.reportExtraError=t.reportError=t.keyword$DataError=t.keywordError=void 0;const e=et(),n=bt(),r=Vs();t.keywordError={message:({keyword:v})=>(0,e.str)`must pass "${v}" keyword validation`},
t.keyword$DataError={message:({keyword:v,schemaType:g})=>g?(0,e.str)`"${v}" keyword must be ${g} ($data)`:(0,e.str)`"${v}" keyword is invalid ($data)`};function i(v,g=t.keywordError,h,y){const{it:b}=v,{gen:R,compositeRule:T,allErrors:N}=b,q=d(v,g,h);y??(T||N)?l(R,q):c(b,(0,e._)`[${q}]`)}t.reportError=i;function s(v,g=t.keywordError,h){const{it:y}=v,{gen:b,compositeRule:R,allErrors:T}=y,N=d(v,g,h);l(b,N),R||T||c(y,r.default.vErrors)}t.reportExtraError=s;function a(v,g){v.assign(r.default.errors,g),
v.if((0,e._)`${r.default.vErrors} !== null`,()=>v.if(g,()=>v.assign((0,e._)`${r.default.vErrors}.length`,g),()=>v.assign(r.default.vErrors,null)))}t.resetErrorsCount=a;function o({gen:v,keyword:g,schemaValue:h,data:y,errsCount:b,it:R}){if(b===void 0)throw new Error("ajv implementation error");const T=v.name("err");v.forRange("i",b,r.default.errors,N=>{v.const(T,(0,e._)`${r.default.vErrors}[${N}]`),v.if((0,e._)`${T}.instancePath === undefined`,()=>v.assign((0,e._)`${T}.instancePath`,(0,e.strConcat)(
r.default.instancePath,R.errorPath))),v.assign((0,e._)`${T}.schemaPath`,(0,e.str)`${R.errSchemaPath}/${g}`),R.opts.verbose&&(v.assign((0,e._)`${T}.schema`,h),v.assign((0,e._)`${T}.data`,y))})}t.extendErrors=o;function l(v,g){const h=v.const("err",g);v.if((0,e._)`${r.default.vErrors} === null`,()=>v.assign(r.default.vErrors,(0,e._)`[${h}]`),(0,e._)`${r.default.vErrors}.push(${h})`),v.code((0,e._)`${r.default.errors}++`)}function c(v,g){const{gen:h,validateName:y,schemaEnv:b}=v;b.$async?h.throw((0,e.
_)`new ${v.ValidationError}(${g})`):(h.assign((0,e._)`${y}.errors`,g),h.return(!1))}const u={keyword:new e.Name("keyword"),schemaPath:new e.Name("schemaPath"),params:new e.Name("params"),propertyName:new e.Name("propertyName"),message:new e.Name("message"),schema:new e.Name("schema"),parentSchema:new e.Name("parentSchema")};function d(v,g,h){const{createErrors:y}=v.it;return y===!1?(0,e._)`{}`:f(v,g,h)}function f(v,g,h={}){const{gen:y,it:b}=v,R=[p(b,h),m(v,h)];return w(v,g,R),y.object(...R)}function p({
errorPath:v},{instancePath:g}){const h=g?(0,e.str)`${v}${(0,n.getErrorPath)(g,n.Type.Str)}`:v;return[r.default.instancePath,(0,e.strConcat)(r.default.instancePath,h)]}function m({keyword:v,it:{errSchemaPath:g}},{schemaPath:h,parentSchema:y}){let b=y?g:(0,e.str)`${g}/${v}`;return h&&(b=(0,e.str)`${b}${(0,n.getErrorPath)(h,n.Type.Str)}`),[u.schemaPath,b]}function w(v,{params:g,message:h},y){const{keyword:b,data:R,schemaValue:T,it:N}=v,{opts:q,propertyName:B,topSchemaRef:ie,schemaPath:L}=N;y.push([
u.keyword,b],[u.params,typeof g=="function"?g(v):g||(0,e._)`{}`]),q.messages&&y.push([u.message,typeof h=="function"?h(v):h]),q.verbose&&y.push([u.schema,T],[u.parentSchema,(0,e._)`${ie}${L}`],[r.default.data,R]),B&&y.push([u.propertyName,B])}})(KS)),KS}var PM;function coe(){if(PM)return nl;PM=1,Object.defineProperty(nl,"__esModule",{value:!0}),nl.boolOrEmptySchema=nl.topBoolOrEmptySchema=void 0;const t=Rv(),e=et(),n=Vs(),r={message:"boolean schema is false"};function i(o){const{gen:l,schema:c,validateName:u}=o;
c===!1?a(o,!1):typeof c=="object"&&c.$async===!0?l.return(n.default.data):(l.assign((0,e._)`${u}.errors`,null),l.return(!0))}nl.topBoolOrEmptySchema=i;function s(o,l){const{gen:c,schema:u}=o;u===!1?(c.var(l,!1),a(o)):c.var(l,!0)}nl.boolOrEmptySchema=s;function a(o,l){const{gen:c,data:u}=o,d={gen:c,keyword:"false schema",data:u,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:o};(0,t.reportError)(d,r,void 0,l)}return nl}var Zn={},rl={},CM;function xM(){if(CM)return rl;CM=1,Object.defineProperty(
rl,"__esModule",{value:!0}),rl.getRules=rl.isJSONType=void 0;const t=["string","number","integer","boolean","null","object","array"],e=new Set(t);function n(i){return typeof i=="string"&&e.has(i)}rl.isJSONType=n;function r(){const i={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:{...i,integer:!0,boolean:!0,null:!0},rules:[{rules:[]},i.number,i.string,i.array,i.object],post:{rules:[]},all:{},keywords:{}}}
return rl.getRules=r,rl}var Bs={},AM;function IM(){if(AM)return Bs;AM=1,Object.defineProperty(Bs,"__esModule",{value:!0}),Bs.shouldUseRule=Bs.shouldUseGroup=Bs.schemaHasRulesForType=void 0;function t({schema:r,self:i},s){const a=i.RULES.types[s];return a&&a!==!0&&e(r,a)}Bs.schemaHasRulesForType=t;function e(r,i){return i.rules.some(s=>n(r,s))}Bs.shouldUseGroup=e;function n(r,i){var s;return r[i.keyword]!==void 0||((s=i.definition.implements)===null||s===void 0?void 0:s.some(a=>r[a]!==void 0))}return Bs.
shouldUseRule=n,Bs}var NM;function Sv(){if(NM)return Zn;NM=1,Object.defineProperty(Zn,"__esModule",{value:!0}),Zn.reportTypeError=Zn.checkDataTypes=Zn.checkDataType=Zn.coerceAndCheckDataType=Zn.getJSONTypes=Zn.getSchemaTypes=Zn.DataType=void 0;const t=xM(),e=IM(),n=Rv(),r=et(),i=bt();var s;(function(h){h[h.Correct=0]="Correct",h[h.Wrong=1]="Wrong"})(s||(Zn.DataType=s={}));function a(h){const y=o(h.type);if(y.includes("null")){if(h.nullable===!1)throw new Error("type: null contradicts nullable: f\
alse")}else{if(!y.length&&h.nullable!==void 0)throw new Error('"nullable" cannot be used without "type"');h.nullable===!0&&y.push("null")}return y}Zn.getSchemaTypes=a;function o(h){const y=Array.isArray(h)?h:h?[h]:[];if(y.every(t.isJSONType))return y;throw new Error("type must be JSONType or JSONType[]: "+y.join(","))}Zn.getJSONTypes=o;function l(h,y){const{gen:b,data:R,opts:T}=h,N=u(y,T.coerceTypes),q=y.length>0&&!(N.length===0&&y.length===1&&(0,e.schemaHasRulesForType)(h,y[0]));if(q){const B=m(
y,R,T.strictNumbers,s.Wrong);b.if(B,()=>{N.length?d(h,y,N):v(h)})}return q}Zn.coerceAndCheckDataType=l;const c=new Set(["string","number","integer","boolean","null"]);function u(h,y){return y?h.filter(b=>c.has(b)||y==="array"&&b==="array"):[]}function d(h,y,b){const{gen:R,data:T,opts:N}=h,q=R.let("dataType",(0,r._)`typeof ${T}`),B=R.let("coerced",(0,r._)`undefined`);N.coerceTypes==="array"&&R.if((0,r._)`${q} == 'object' && Array.isArray(${T}) && ${T}.length == 1`,()=>R.assign(T,(0,r._)`${T}[0]`).
assign(q,(0,r._)`typeof ${T}`).if(m(y,T,N.strictNumbers),()=>R.assign(B,T))),R.if((0,r._)`${B} !== undefined`);for(const L of b)(c.has(L)||L==="array"&&N.coerceTypes==="array")&&ie(L);R.else(),v(h),R.endIf(),R.if((0,r._)`${B} !== undefined`,()=>{R.assign(T,B),f(h,B)});function ie(L){switch(L){case"string":R.elseIf((0,r._)`${q} == "number" || ${q} == "boolean"`).assign(B,(0,r._)`"" + ${T}`).elseIf((0,r._)`${T} === null`).assign(B,(0,r._)`""`);return;case"number":R.elseIf((0,r._)`${q} == "boolean" || ${T} === null
              || (${q} == "string" && ${T} && ${T} == +${T})`).assign(B,(0,r._)`+${T}`);return;case"integer":R.elseIf((0,r._)`${q} === "boolean" || ${T} === null
              || (${q} === "string" && ${T} && ${T} == +${T} && !(${T} % 1))`).assign(B,(0,r._)`+${T}`);return;case"boolean":R.elseIf((0,r._)`${T} === "false" || ${T} === 0 || ${T} === null`).assign(B,!1).elseIf((0,r._)`${T} === "true" || ${T} === 1`).assign(B,!0);return;case"null":R.elseIf((0,r._)`${T} === "" || ${T} === 0 || ${T} === false`),R.assign(B,null);return;case"array":R.elseIf((0,r._)`${q} === "string" || ${q} === "number"
              || ${q} === "boolean" || ${T} === null`).assign(B,(0,r._)`[${T}]`)}}}function f({gen:h,parentData:y,parentDataProperty:b},R){h.if((0,r._)`${y} !== undefined`,()=>h.assign((0,r._)`${y}[${b}]`,R))}function p(h,y,b,R=s.Correct){const T=R===s.Correct?r.operators.EQ:r.operators.NEQ;let N;switch(h){case"null":return(0,r._)`${y} ${T} null`;case"array":N=(0,r._)`Array.isArray(${y})`;break;case"object":N=(0,r._)`${y} && typeof ${y} == "object" && !Array.isArray(${y})`;break;case"integer":N=
q((0,r._)`!(${y} % 1) && !isNaN(${y})`);break;case"number":N=q();break;default:return(0,r._)`typeof ${y} ${T} ${h}`}return R===s.Correct?N:(0,r.not)(N);function q(B=r.nil){return(0,r.and)((0,r._)`typeof ${y} == "number"`,B,b?(0,r._)`isFinite(${y})`:r.nil)}}Zn.checkDataType=p;function m(h,y,b,R){if(h.length===1)return p(h[0],y,b,R);let T;const N=(0,i.toHash)(h);if(N.array&&N.object){const q=(0,r._)`typeof ${y} != "object"`;T=N.null?q:(0,r._)`!${y} || ${q}`,delete N.null,delete N.array,delete N.object}else
T=r.nil;N.number&&delete N.integer;for(const q in N)T=(0,r.and)(T,p(q,y,b,R));return T}Zn.checkDataTypes=m;const w={message:({schema:h})=>`must be ${h}`,params:({schema:h,schemaValue:y})=>typeof h=="string"?(0,r._)`{type: ${h}}`:(0,r._)`{type: ${y}}`};function v(h){const y=g(h);(0,n.reportError)(y,w)}Zn.reportTypeError=v;function g(h){const{gen:y,data:b,schema:R}=h,T=(0,i.schemaRefOrVal)(h,R,"type");return{gen:y,keyword:"type",data:b,schema:R.type,schemaCode:T,schemaValue:T,parentSchema:R,params:{},
it:h}}return Zn}var Yp={},DM;function uoe(){if(DM)return Yp;DM=1,Object.defineProperty(Yp,"__esModule",{value:!0}),Yp.assignDefaults=void 0;const t=et(),e=bt();function n(i,s){const{properties:a,items:o}=i.schema;if(s==="object"&&a)for(const l in a)r(i,l,a[l].default);else s==="array"&&Array.isArray(o)&&o.forEach((l,c)=>r(i,c,l.default))}Yp.assignDefaults=n;function r(i,s,a){const{gen:o,compositeRule:l,data:c,opts:u}=i;if(a===void 0)return;const d=(0,t._)`${c}${(0,t.getProperty)(s)}`;if(l){(0,e.
checkStrictMode)(i,`default is ignored for: ${d}`);return}let f=(0,t._)`${d} === undefined`;u.useDefaults==="empty"&&(f=(0,t._)`${f} || ${d} === null || ${d} === ""`),o.if(f,(0,t._)`${d} = ${(0,t.stringify)(a)}`)}return Yp}var xi={},xt={},OM;function Ai(){if(OM)return xt;OM=1,Object.defineProperty(xt,"__esModule",{value:!0}),xt.validateUnion=xt.validateArray=xt.usePattern=xt.callValidateCode=xt.schemaProperties=xt.allSchemaProperties=xt.noPropertyInData=xt.propertyInData=xt.isOwnProperty=xt.hasPropFunc=
xt.reportMissingProp=xt.checkMissingProp=xt.checkReportMissingProp=void 0;const t=et(),e=bt(),n=Vs(),r=bt();function i(h,y){const{gen:b,data:R,it:T}=h;b.if(u(b,R,y,T.opts.ownProperties),()=>{h.setParams({missingProperty:(0,t._)`${y}`},!0),h.error()})}xt.checkReportMissingProp=i;function s({gen:h,data:y,it:{opts:b}},R,T){return(0,t.or)(...R.map(N=>(0,t.and)(u(h,y,N,b.ownProperties),(0,t._)`${T} = ${N}`)))}xt.checkMissingProp=s;function a(h,y){h.setParams({missingProperty:y},!0),h.error()}xt.reportMissingProp=
a;function o(h){return h.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:(0,t._)`Object.prototype.hasOwnProperty`})}xt.hasPropFunc=o;function l(h,y,b){return(0,t._)`${o(h)}.call(${y}, ${b})`}xt.isOwnProperty=l;function c(h,y,b,R){const T=(0,t._)`${y}${(0,t.getProperty)(b)} !== undefined`;return R?(0,t._)`${T} && ${l(h,y,b)}`:T}xt.propertyInData=c;function u(h,y,b,R){const T=(0,t._)`${y}${(0,t.getProperty)(b)} === undefined`;return R?(0,t.or)(T,(0,t.not)(l(h,y,b))):T}xt.noPropertyInData=
u;function d(h){return h?Object.keys(h).filter(y=>y!=="__proto__"):[]}xt.allSchemaProperties=d;function f(h,y){return d(y).filter(b=>!(0,e.alwaysValidSchema)(h,y[b]))}xt.schemaProperties=f;function p({schemaCode:h,data:y,it:{gen:b,topSchemaRef:R,schemaPath:T,errorPath:N},it:q},B,ie,L){const E=L?(0,t._)`${h}, ${y}, ${R}${T}`:y,$=[[n.default.instancePath,(0,t.strConcat)(n.default.instancePath,N)],[n.default.parentData,q.parentData],[n.default.parentDataProperty,q.parentDataProperty],[n.default.rootData,
n.default.rootData]];q.opts.dynamicRef&&$.push([n.default.dynamicAnchors,n.default.dynamicAnchors]);const z=(0,t._)`${E}, ${b.object(...$)}`;return ie!==t.nil?(0,t._)`${B}.call(${ie}, ${z})`:(0,t._)`${B}(${z})`}xt.callValidateCode=p;const m=(0,t._)`new RegExp`;function w({gen:h,it:{opts:y}},b){const R=y.unicodeRegExp?"u":"",{regExp:T}=y.code,N=T(b,R);return h.scopeValue("pattern",{key:N.toString(),ref:N,code:(0,t._)`${T.code==="new RegExp"?m:(0,r.useFunc)(h,T)}(${b}, ${R})`})}xt.usePattern=w;function v(h){
const{gen:y,data:b,keyword:R,it:T}=h,N=y.name("valid");if(T.allErrors){const B=y.let("valid",!0);return q(()=>y.assign(B,!1)),B}return y.var(N,!0),q(()=>y.break()),N;function q(B){const ie=y.const("len",(0,t._)`${b}.length`);y.forRange("i",0,ie,L=>{h.subschema({keyword:R,dataProp:L,dataPropType:e.Type.Num},N),y.if((0,t.not)(N),B)})}}xt.validateArray=v;function g(h){const{gen:y,schema:b,keyword:R,it:T}=h;if(!Array.isArray(b))throw new Error("ajv implementation error");if(b.some(ie=>(0,e.alwaysValidSchema)(
T,ie))&&!T.opts.unevaluated)return;const q=y.let("valid",!1),B=y.name("_valid");y.block(()=>b.forEach((ie,L)=>{const E=h.subschema({keyword:R,schemaProp:L,compositeRule:!0},B);y.assign(q,(0,t._)`${q} || ${B}`),h.mergeValidEvaluated(E,B)||y.if((0,t.not)(q))})),h.result(q,()=>h.reset(),()=>h.error(!0))}return xt.validateUnion=g,xt}var LM;function doe(){if(LM)return xi;LM=1,Object.defineProperty(xi,"__esModule",{value:!0}),xi.validateKeywordUsage=xi.validSchemaType=xi.funcKeywordCode=xi.macroKeywordCode=
void 0;const t=et(),e=Vs(),n=Ai(),r=Rv();function i(f,p){const{gen:m,keyword:w,schema:v,parentSchema:g,it:h}=f,y=p.macro.call(h.self,v,g,h),b=c(m,w,y);h.opts.validateSchema!==!1&&h.self.validateSchema(y,!0);const R=m.name("valid");f.subschema({schema:y,schemaPath:t.nil,errSchemaPath:`${h.errSchemaPath}/${w}`,topSchemaRef:b,compositeRule:!0},R),f.pass(R,()=>f.error(!0))}xi.macroKeywordCode=i;function s(f,p){var m;const{gen:w,keyword:v,schema:g,parentSchema:h,$data:y,it:b}=f;l(b,p);const R=!y&&p.compile?
p.compile.call(b.self,g,h,b):p.validate,T=c(w,v,R),N=w.let("valid");f.block$data(N,q),f.ok((m=p.valid)!==null&&m!==void 0?m:N);function q(){if(p.errors===!1)L(),p.modifying&&a(f),E(()=>f.error());else{const $=p.async?B():ie();p.modifying&&a(f),E(()=>o(f,$))}}function B(){const $=w.let("ruleErrs",null);return w.try(()=>L((0,t._)`await `),z=>w.assign(N,!1).if((0,t._)`${z} instanceof ${b.ValidationError}`,()=>w.assign($,(0,t._)`${z}.errors`),()=>w.throw(z))),$}function ie(){const $=(0,t._)`${T}.errors`;
return w.assign($,null),L(t.nil),$}function L($=p.async?(0,t._)`await `:t.nil){const z=b.opts.passContext?e.default.this:e.default.self,j=!("compile"in p&&!y||p.schema===!1);w.assign(N,(0,t._)`${$}${(0,n.callValidateCode)(f,T,z,j)}`,p.modifying)}function E($){var z;w.if((0,t.not)((z=p.valid)!==null&&z!==void 0?z:N),$)}}xi.funcKeywordCode=s;function a(f){const{gen:p,data:m,it:w}=f;p.if(w.parentData,()=>p.assign(m,(0,t._)`${w.parentData}[${w.parentDataProperty}]`))}function o(f,p){const{gen:m}=f;m.
if((0,t._)`Array.isArray(${p})`,()=>{m.assign(e.default.vErrors,(0,t._)`${e.default.vErrors} === null ? ${p} : ${e.default.vErrors}.concat(${p})`).assign(e.default.errors,(0,t._)`${e.default.vErrors}.length`),(0,r.extendErrors)(f)},()=>f.error())}function l({schemaEnv:f},p){if(p.async&&!f.$async)throw new Error("async keyword in sync schema")}function c(f,p,m){if(m===void 0)throw new Error(`keyword "${p}" failed to compile`);return f.scopeValue("keyword",typeof m=="function"?{ref:m}:{ref:m,code:(0,t.
stringify)(m)})}function u(f,p,m=!1){return!p.length||p.some(w=>w==="array"?Array.isArray(f):w==="object"?f&&typeof f=="object"&&!Array.isArray(f):typeof f==w||m&&typeof f>"u")}xi.validSchemaType=u;function d({schema:f,opts:p,self:m,errSchemaPath:w},v,g){if(Array.isArray(v.keyword)?!v.keyword.includes(g):v.keyword!==g)throw new Error("ajv implementation error");const h=v.dependencies;if(h?.some(y=>!Object.prototype.hasOwnProperty.call(f,y)))throw new Error(`parent schema must have dependencies o\
f ${g}: ${h.join(",")}`);if(v.validateSchema&&!v.validateSchema(f[g])){const b=`keyword "${g}" value is invalid at path "${w}": `+m.errorsText(v.validateSchema.errors);if(p.validateSchema==="log")m.logger.error(b);else throw new Error(b)}}return xi.validateKeywordUsage=d,xi}var Ws={},MM;function foe(){if(MM)return Ws;MM=1,Object.defineProperty(Ws,"__esModule",{value:!0}),Ws.extendSubschemaMode=Ws.extendSubschemaData=Ws.getSubschema=void 0;const t=et(),e=bt();function n(s,{keyword:a,schemaProp:o,
schema:l,schemaPath:c,errSchemaPath:u,topSchemaRef:d}){if(a!==void 0&&l!==void 0)throw new Error('both "keyword" and "schema" passed, only one allowed');if(a!==void 0){const f=s.schema[a];return o===void 0?{schema:f,schemaPath:(0,t._)`${s.schemaPath}${(0,t.getProperty)(a)}`,errSchemaPath:`${s.errSchemaPath}/${a}`}:{schema:f[o],schemaPath:(0,t._)`${s.schemaPath}${(0,t.getProperty)(a)}${(0,t.getProperty)(o)}`,errSchemaPath:`${s.errSchemaPath}/${a}/${(0,e.escapeFragment)(o)}`}}if(l!==void 0){if(c===
void 0||u===void 0||d===void 0)throw new Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:l,schemaPath:c,topSchemaRef:d,errSchemaPath:u}}throw new Error('either "keyword" or "schema" must be passed')}Ws.getSubschema=n;function r(s,a,{dataProp:o,dataPropType:l,data:c,dataTypes:u,propertyName:d}){if(c!==void 0&&o!==void 0)throw new Error('both "data" and "dataProp" passed, only one allowed');const{gen:f}=a;if(o!==void 0){const{errorPath:m,dataPathArr:w,
opts:v}=a,g=f.let("data",(0,t._)`${a.data}${(0,t.getProperty)(o)}`,!0);p(g),s.errorPath=(0,t.str)`${m}${(0,e.getErrorPath)(o,l,v.jsPropertySyntax)}`,s.parentDataProperty=(0,t._)`${o}`,s.dataPathArr=[...w,s.parentDataProperty]}if(c!==void 0){const m=c instanceof t.Name?c:f.let("data",c,!0);p(m),d!==void 0&&(s.propertyName=d)}u&&(s.dataTypes=u);function p(m){s.data=m,s.dataLevel=a.dataLevel+1,s.dataTypes=[],a.definedProperties=new Set,s.parentData=a.data,s.dataNames=[...a.dataNames,m]}}Ws.extendSubschemaData=
r;function i(s,{jtdDiscriminator:a,jtdMetadata:o,compositeRule:l,createErrors:c,allErrors:u}){l!==void 0&&(s.compositeRule=l),c!==void 0&&(s.createErrors=c),u!==void 0&&(s.allErrors=u),s.jtdDiscriminator=a,s.jtdMetadata=o}return Ws.extendSubschemaMode=i,Ws}var fr={},XS,jM;function qM(){return jM||(jM=1,XS=function t(e,n){if(e===n)return!0;if(e&&n&&typeof e=="object"&&typeof n=="object"){if(e.constructor!==n.constructor)return!1;var r,i,s;if(Array.isArray(e)){if(r=e.length,r!=n.length)return!1;for(i=
r;i--!==0;)if(!t(e[i],n[i]))return!1;return!0}if(e.constructor===RegExp)return e.source===n.source&&e.flags===n.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===n.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===n.toString();if(s=Object.keys(e),r=s.length,r!==Object.keys(n).length)return!1;for(i=r;i--!==0;)if(!Object.prototype.hasOwnProperty.call(n,s[i]))return!1;for(i=r;i--!==0;){var a=s[i];if(!t(e[a],n[a]))return!1}return!0}return e!==e&&n!==n}),XS}var QS={
exports:{}},FM;function poe(){if(FM)return QS.exports;FM=1;var t=QS.exports=function(r,i,s){typeof i=="function"&&(s=i,i={}),s=i.cb||s;var a=typeof s=="function"?s:s.pre||function(){},o=s.post||function(){};e(i,a,o,r,"",r)};t.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0},t.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0},t.propsKeywords={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependencies:!0},t.skipKeywords=
{default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0};function e(r,i,s,a,o,l,c,u,d,f){if(a&&typeof a=="object"&&!Array.isArray(a)){i(a,o,l,c,u,d,f);for(var p in a){var m=a[p];if(Array.isArray(m)){if(p in t.arrayKeywords)for(var w=0;w<m.length;w++)e(r,i,s,m[w],o+"/"+p+"/"+w,l,o,p,a,w)}else if(p in t.propsKeywords){if(m&&
typeof m=="object")for(var v in m)e(r,i,s,m[v],o+"/"+p+"/"+n(v),l,o,p,a,v)}else(p in t.keywords||r.allKeys&&!(p in t.skipKeywords))&&e(r,i,s,m,o+"/"+p,l,o,p,a)}s(a,o,l,c,u,d,f)}}function n(r){return r.replace(/~/g,"~0").replace(/\//g,"~1")}return QS.exports}var zM;function $v(){if(zM)return fr;zM=1,Object.defineProperty(fr,"__esModule",{value:!0}),fr.getSchemaRefs=fr.resolveUrl=fr.normalizeId=fr._getFullPath=fr.getFullPath=fr.inlineRef=void 0;const t=bt(),e=qM(),n=poe(),r=new Set(["type","format",
"pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);function i(w,v=!0){return typeof w=="boolean"?!0:v===!0?!a(w):v?o(w)<=v:!1}fr.inlineRef=i;const s=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function a(w){for(const v in w){if(s.has(v))return!0;const g=w[v];if(Array.isArray(g)&&g.some(a)||typeof g=="object"&&a(g))return!0}return!1}function o(w){
let v=0;for(const g in w){if(g==="$ref")return 1/0;if(v++,!r.has(g)&&(typeof w[g]=="object"&&(0,t.eachItem)(w[g],h=>v+=o(h)),v===1/0))return 1/0}return v}function l(w,v="",g){g!==!1&&(v=d(v));const h=w.parse(v);return c(w,h)}fr.getFullPath=l;function c(w,v){return w.serialize(v).split("#")[0]+"#"}fr._getFullPath=c;const u=/#\/?$/;function d(w){return w?w.replace(u,""):""}fr.normalizeId=d;function f(w,v,g){return g=d(g),w.resolve(v,g)}fr.resolveUrl=f;const p=/^[a-z_][-a-z0-9._]*$/i;function m(w,v){
if(typeof w=="boolean")return{};const{schemaId:g,uriResolver:h}=this.opts,y=d(w[g]||v),b={"":y},R=l(h,y,!1),T={},N=new Set;return n(w,{allKeys:!0},(ie,L,E,$)=>{if($===void 0)return;const z=R+L;let j=b[$];typeof ie[g]=="string"&&(j=U.call(this,ie[g])),W.call(this,ie.$anchor),W.call(this,ie.$dynamicAnchor),b[L]=j;function U(le){const ne=this.opts.uriResolver.resolve;if(le=d(j?ne(j,le):le),N.has(le))throw B(le);N.add(le);let P=this.refs[le];return typeof P=="string"&&(P=this.refs[P]),typeof P=="obj\
ect"?q(ie,P.schema,le):le!==d(z)&&(le[0]==="#"?(q(ie,T[le],le),T[le]=ie):this.refs[le]=z),le}function W(le){if(typeof le=="string"){if(!p.test(le))throw new Error(`invalid anchor "${le}"`);U.call(this,`#${le}`)}}}),T;function q(ie,L,E){if(L!==void 0&&!e(ie,L))throw B(E)}function B(ie){return new Error(`reference "${ie}" resolves to more than one schema`)}}return fr.getSchemaRefs=m,fr}var UM;function Xp(){if(UM)return Hs;UM=1,Object.defineProperty(Hs,"__esModule",{value:!0}),Hs.getData=Hs.KeywordCxt=
Hs.validateFunctionCode=void 0;const t=coe(),e=Sv(),n=IM(),r=Sv(),i=uoe(),s=doe(),a=foe(),o=et(),l=Vs(),c=$v(),u=bt(),d=Rv();function f(x){if(R(x)&&(N(x),b(x))){v(x);return}p(x,()=>(0,t.topBoolOrEmptySchema)(x))}Hs.validateFunctionCode=f;function p({gen:x,validateName:O,schema:K,schemaEnv:F,opts:ae},Re){ae.code.es5?x.func(O,(0,o._)`${l.default.data}, ${l.default.valCxt}`,F.$async,()=>{x.code((0,o._)`"use strict"; ${h(K,ae)}`),w(x,ae),x.code(Re)}):x.func(O,(0,o._)`${l.default.data}, ${m(ae)}`,F.$async,
()=>x.code(h(K,ae)).code(Re))}function m(x){return(0,o._)`{${l.default.instancePath}="", ${l.default.parentData}, ${l.default.parentDataProperty}, ${l.default.rootData}=${l.default.data}${x.dynamicRef?(0,o._)`, ${l.default.dynamicAnchors}={}`:o.nil}}={}`}function w(x,O){x.if(l.default.valCxt,()=>{x.var(l.default.instancePath,(0,o._)`${l.default.valCxt}.${l.default.instancePath}`),x.var(l.default.parentData,(0,o._)`${l.default.valCxt}.${l.default.parentData}`),x.var(l.default.parentDataProperty,(0,o.
_)`${l.default.valCxt}.${l.default.parentDataProperty}`),x.var(l.default.rootData,(0,o._)`${l.default.valCxt}.${l.default.rootData}`),O.dynamicRef&&x.var(l.default.dynamicAnchors,(0,o._)`${l.default.valCxt}.${l.default.dynamicAnchors}`)},()=>{x.var(l.default.instancePath,(0,o._)`""`),x.var(l.default.parentData,(0,o._)`undefined`),x.var(l.default.parentDataProperty,(0,o._)`undefined`),x.var(l.default.rootData,l.default.data),O.dynamicRef&&x.var(l.default.dynamicAnchors,(0,o._)`{}`)})}function v(x){
const{schema:O,opts:K,gen:F}=x;p(x,()=>{K.$comment&&O.$comment&&$(x),ie(x),F.let(l.default.vErrors,null),F.let(l.default.errors,0),K.unevaluated&&g(x),q(x),z(x)})}function g(x){const{gen:O,validateName:K}=x;x.evaluated=O.const("evaluated",(0,o._)`${K}.evaluated`),O.if((0,o._)`${x.evaluated}.dynamicProps`,()=>O.assign((0,o._)`${x.evaluated}.props`,(0,o._)`undefined`)),O.if((0,o._)`${x.evaluated}.dynamicItems`,()=>O.assign((0,o._)`${x.evaluated}.items`,(0,o._)`undefined`))}function h(x,O){const K=typeof x==
"object"&&x[O.schemaId];return K&&(O.code.source||O.code.process)?(0,o._)`/*# sourceURL=${K} */`:o.nil}function y(x,O){if(R(x)&&(N(x),b(x))){T(x,O);return}(0,t.boolOrEmptySchema)(x,O)}function b({schema:x,self:O}){if(typeof x=="boolean")return!x;for(const K in x)if(O.RULES.all[K])return!0;return!1}function R(x){return typeof x.schema!="boolean"}function T(x,O){const{schema:K,gen:F,opts:ae}=x;ae.$comment&&K.$comment&&$(x),L(x),E(x);const Re=F.const("_errs",l.default.errors);q(x,Re),F.var(O,(0,o._)`${Re} === ${l.
default.errors}`)}function N(x){(0,u.checkUnknownRules)(x),B(x)}function q(x,O){if(x.opts.jtd)return U(x,[],!1,O);const K=(0,e.getSchemaTypes)(x.schema),F=(0,e.coerceAndCheckDataType)(x,K);U(x,K,!F,O)}function B(x){const{schema:O,errSchemaPath:K,opts:F,self:ae}=x;O.$ref&&F.ignoreKeywordsWithRef&&(0,u.schemaHasRulesButRef)(O,ae.RULES)&&ae.logger.warn(`$ref: keywords ignored in schema at path "${K}"`)}function ie(x){const{schema:O,opts:K}=x;O.default!==void 0&&K.useDefaults&&K.strictSchema&&(0,u.checkStrictMode)(
x,"default is ignored in the schema root")}function L(x){const O=x.schema[x.opts.schemaId];O&&(x.baseId=(0,c.resolveUrl)(x.opts.uriResolver,x.baseId,O))}function E(x){if(x.schema.$async&&!x.schemaEnv.$async)throw new Error("async schema in sync schema")}function $({gen:x,schemaEnv:O,schema:K,errSchemaPath:F,opts:ae}){const Re=K.$comment;if(ae.$comment===!0)x.code((0,o._)`${l.default.self}.logger.log(${Re})`);else if(typeof ae.$comment=="function"){const ze=(0,o.str)`${F}/$comment`,ye=x.scopeValue(
"root",{ref:O.root});x.code((0,o._)`${l.default.self}.opts.$comment(${Re}, ${ze}, ${ye}.schema)`)}}function z(x){const{gen:O,schemaEnv:K,validateName:F,ValidationError:ae,opts:Re}=x;K.$async?O.if((0,o._)`${l.default.errors} === 0`,()=>O.return(l.default.data),()=>O.throw((0,o._)`new ${ae}(${l.default.vErrors})`)):(O.assign((0,o._)`${F}.errors`,l.default.vErrors),Re.unevaluated&&j(x),O.return((0,o._)`${l.default.errors} === 0`))}function j({gen:x,evaluated:O,props:K,items:F}){K instanceof o.Name&&
x.assign((0,o._)`${O}.props`,K),F instanceof o.Name&&x.assign((0,o._)`${O}.items`,F)}function U(x,O,K,F){const{gen:ae,schema:Re,data:ze,allErrors:ye,opts:Me,self:me}=x,{RULES:$e}=me;if(Re.$ref&&(Me.ignoreKeywordsWithRef||!(0,u.schemaHasRulesButRef)(Re,$e))){ae.block(()=>se(x,"$ref",$e.all.$ref.definition));return}Me.jtd||le(x,O),ae.block(()=>{for(const st of $e.rules)Ge(st);Ge($e.post)});function Ge(st){(0,n.shouldUseGroup)(Re,st)&&(st.type?(ae.if((0,r.checkDataType)(st.type,ze,Me.strictNumbers)),
W(x,st),O.length===1&&O[0]===st.type&&K&&(ae.else(),(0,r.reportTypeError)(x)),ae.endIf()):W(x,st),ye||ae.if((0,o._)`${l.default.errors} === ${F||0}`))}}function W(x,O){const{gen:K,schema:F,opts:{useDefaults:ae}}=x;ae&&(0,i.assignDefaults)(x,O.type),K.block(()=>{for(const Re of O.rules)(0,n.shouldUseRule)(F,Re)&&se(x,Re.keyword,Re.definition,O.type)})}function le(x,O){x.schemaEnv.meta||!x.opts.strictTypes||(ne(x,O),x.opts.allowUnionTypes||P(x,O),M(x,x.dataTypes))}function ne(x,O){if(O.length){if(!x.
dataTypes.length){x.dataTypes=O;return}O.forEach(K=>{G(x.dataTypes,K)||I(x,`type "${K}" not allowed by context "${x.dataTypes.join(",")}"`)}),_(x,O)}}function P(x,O){O.length>1&&!(O.length===2&&O.includes("null"))&&I(x,"use allowUnionTypes to allow union type keyword")}function M(x,O){const K=x.self.RULES.all;for(const F in K){const ae=K[F];if(typeof ae=="object"&&(0,n.shouldUseRule)(x.schema,ae)){const{type:Re}=ae.definition;Re.length&&!Re.some(ze=>J(O,ze))&&I(x,`missing type "${Re.join(",")}" \
for keyword "${F}"`)}}}function J(x,O){return x.includes(O)||O==="number"&&x.includes("integer")}function G(x,O){return x.includes(O)||O==="integer"&&x.includes("number")}function _(x,O){const K=[];for(const F of x.dataTypes)G(O,F)?K.push(F):O.includes("integer")&&F==="number"&&K.push("integer");x.dataTypes=K}function I(x,O){const K=x.schemaEnv.baseId+x.errSchemaPath;O+=` at "${K}" (strictTypes)`,(0,u.checkStrictMode)(x,O,x.opts.strictTypes)}class Y{constructor(O,K,F){if((0,s.validateKeywordUsage)(
O,K,F),this.gen=O.gen,this.allErrors=O.allErrors,this.keyword=F,this.data=O.data,this.schema=O.schema[F],this.$data=K.$data&&O.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=(0,u.schemaRefOrVal)(O,this.schema,F,this.$data),this.schemaType=K.schemaType,this.parentSchema=O.schema,this.params={},this.it=O,this.def=K,this.$data)this.schemaCode=O.gen.const("vSchema",pe(this.$data,O));else if(this.schemaCode=this.schemaValue,!(0,s.validSchemaType)(this.schema,K.schemaType,K.allowUndefined))
throw new Error(`${F} value must be ${JSON.stringify(K.schemaType)}`);("code"in K?K.trackErrors:K.errors!==!1)&&(this.errsCount=O.gen.const("_errs",l.default.errors))}result(O,K,F){this.failResult((0,o.not)(O),K,F)}failResult(O,K,F){this.gen.if(O),F?F():this.error(),K?(this.gen.else(),K(),this.allErrors&&this.gen.endIf()):this.allErrors?this.gen.endIf():this.gen.else()}pass(O,K){this.failResult((0,o.not)(O),void 0,K)}fail(O){if(O===void 0){this.error(),this.allErrors||this.gen.if(!1);return}this.
gen.if(O),this.error(),this.allErrors?this.gen.endIf():this.gen.else()}fail$data(O){if(!this.$data)return this.fail(O);const{schemaCode:K}=this;this.fail((0,o._)`${K} !== undefined && (${(0,o.or)(this.invalid$data(),O)})`)}error(O,K,F){if(K){this.setParams(K),this._error(O,F),this.setParams({});return}this._error(O,F)}_error(O,K){(O?d.reportExtraError:d.reportError)(this,this.def.error,K)}$dataError(){(0,d.reportError)(this,this.def.$dataError||d.keyword$DataError)}reset(){if(this.errsCount===void 0)
throw new Error('add "trackErrors" to keyword definition');(0,d.resetErrorsCount)(this.gen,this.errsCount)}ok(O){this.allErrors||this.gen.if(O)}setParams(O,K){K?Object.assign(this.params,O):this.params=O}block$data(O,K,F=o.nil){this.gen.block(()=>{this.check$data(O,F),K()})}check$data(O=o.nil,K=o.nil){if(!this.$data)return;const{gen:F,schemaCode:ae,schemaType:Re,def:ze}=this;F.if((0,o.or)((0,o._)`${ae} === undefined`,K)),O!==o.nil&&F.assign(O,!0),(Re.length||ze.validateSchema)&&(F.elseIf(this.invalid$data()),
this.$dataError(),O!==o.nil&&F.assign(O,!1)),F.else()}invalid$data(){const{gen:O,schemaCode:K,schemaType:F,def:ae,it:Re}=this;return(0,o.or)(ze(),ye());function ze(){if(F.length){if(!(K instanceof o.Name))throw new Error("ajv implementation error");const Me=Array.isArray(F)?F:[F];return(0,o._)`${(0,r.checkDataTypes)(Me,K,Re.opts.strictNumbers,r.DataType.Wrong)}`}return o.nil}function ye(){if(ae.validateSchema){const Me=O.scopeValue("validate$data",{ref:ae.validateSchema});return(0,o._)`!${Me}(${K})`}
return o.nil}}subschema(O,K){const F=(0,a.getSubschema)(this.it,O);(0,a.extendSubschemaData)(F,this.it,O),(0,a.extendSubschemaMode)(F,O);const ae={...this.it,...F,items:void 0,props:void 0};return y(ae,K),ae}mergeEvaluated(O,K){const{it:F,gen:ae}=this;F.opts.unevaluated&&(F.props!==!0&&O.props!==void 0&&(F.props=u.mergeEvaluated.props(ae,O.props,F.props,K)),F.items!==!0&&O.items!==void 0&&(F.items=u.mergeEvaluated.items(ae,O.items,F.items,K)))}mergeValidEvaluated(O,K){const{it:F,gen:ae}=this;if(F.
opts.unevaluated&&(F.props!==!0||F.items!==!0))return ae.if(K,()=>this.mergeEvaluated(O,o.Name)),!0}}Hs.KeywordCxt=Y;function se(x,O,K,F){const ae=new Y(x,K,O);"code"in K?K.code(ae,F):ae.$data&&K.validate?(0,s.funcKeywordCode)(ae,K):"macro"in K?(0,s.macroKeywordCode)(ae,K):(K.compile||K.validate)&&(0,s.funcKeywordCode)(ae,K)}const fe=/^\/(?:[^~]|~0|~1)*$/,_e=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function pe(x,{dataLevel:O,dataNames:K,dataPathArr:F}){let ae,Re;if(x==="")return l.default.rootData;if(x[0]===
"/"){if(!fe.test(x))throw new Error(`Invalid JSON-pointer: ${x}`);ae=x,Re=l.default.rootData}else{const me=_e.exec(x);if(!me)throw new Error(`Invalid JSON-pointer: ${x}`);const $e=+me[1];if(ae=me[2],ae==="#"){if($e>=O)throw new Error(Me("property/index",$e));return F[O-$e]}if($e>O)throw new Error(Me("data",$e));if(Re=K[O-$e],!ae)return Re}let ze=Re;const ye=ae.split("/");for(const me of ye)me&&(Re=(0,o._)`${Re}${(0,o.getProperty)((0,u.unescapeJsonPointer)(me))}`,ze=(0,o._)`${ze} && ${Re}`);return ze;
function Me(me,$e){return`Cannot access ${me} ${$e} levels up, current level is ${O}`}}return Hs.getData=pe,Hs}var Tv={},HM;function Ev(){if(HM)return Tv;HM=1,Object.defineProperty(Tv,"__esModule",{value:!0});class t extends Error{constructor(n){super("validation failed"),this.errors=n,this.ajv=this.validation=!0}}return Tv.default=t,Tv}var Pv={},VM;function Qp(){if(VM)return Pv;VM=1,Object.defineProperty(Pv,"__esModule",{value:!0});const t=$v();class e extends Error{constructor(r,i,s,a){super(a||
`can't resolve reference ${s} from id ${i}`),this.missingRef=(0,t.resolveUrl)(r,i,s),this.missingSchema=(0,t.normalizeId)((0,t.getFullPath)(r,this.missingRef))}}return Pv.default=e,Pv}var Wr={},BM;function Cv(){if(BM)return Wr;BM=1,Object.defineProperty(Wr,"__esModule",{value:!0}),Wr.resolveSchema=Wr.getCompilingSchema=Wr.resolveRef=Wr.compileSchema=Wr.SchemaEnv=void 0;const t=et(),e=Ev(),n=Vs(),r=$v(),i=bt(),s=Xp();class a{constructor(g){var h;this.refs={},this.dynamicAnchors={};let y;typeof g.
schema=="object"&&(y=g.schema),this.schema=g.schema,this.schemaId=g.schemaId,this.root=g.root||this,this.baseId=(h=g.baseId)!==null&&h!==void 0?h:(0,r.normalizeId)(y?.[g.schemaId||"$id"]),this.schemaPath=g.schemaPath,this.localRefs=g.localRefs,this.meta=g.meta,this.$async=y?.$async,this.refs={}}}Wr.SchemaEnv=a;function o(v){const g=u.call(this,v);if(g)return g;const h=(0,r.getFullPath)(this.opts.uriResolver,v.root.baseId),{es5:y,lines:b}=this.opts.code,{ownProperties:R}=this.opts,T=new t.CodeGen(
this.scope,{es5:y,lines:b,ownProperties:R});let N;v.$async&&(N=T.scopeValue("Error",{ref:e.default,code:(0,t._)`require("ajv/dist/runtime/validation_error").default`}));const q=T.scopeName("validate");v.validateName=q;const B={gen:T,allErrors:this.opts.allErrors,data:n.default.data,parentData:n.default.parentData,parentDataProperty:n.default.parentDataProperty,dataNames:[n.default.data],dataPathArr:[t.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:T.scopeValue("schema",this.
opts.code.source===!0?{ref:v.schema,code:(0,t.stringify)(v.schema)}:{ref:v.schema}),validateName:q,ValidationError:N,schema:v.schema,schemaEnv:v,rootId:h,baseId:v.baseId||h,schemaPath:t.nil,errSchemaPath:v.schemaPath||(this.opts.jtd?"":"#"),errorPath:(0,t._)`""`,opts:this.opts,self:this};let ie;try{this._compilations.add(v),(0,s.validateFunctionCode)(B),T.optimize(this.opts.code.optimize);const L=T.toString();ie=`${T.scopeRefs(n.default.scope)}return ${L}`,this.opts.code.process&&(ie=this.opts.code.
process(ie,v));const $=new Function(`${n.default.self}`,`${n.default.scope}`,ie)(this,this.scope.get());if(this.scope.value(q,{ref:$}),$.errors=null,$.schema=v.schema,$.schemaEnv=v,v.$async&&($.$async=!0),this.opts.code.source===!0&&($.source={validateName:q,validateCode:L,scopeValues:T._values}),this.opts.unevaluated){const{props:z,items:j}=B;$.evaluated={props:z instanceof t.Name?void 0:z,items:j instanceof t.Name?void 0:j,dynamicProps:z instanceof t.Name,dynamicItems:j instanceof t.Name},$.source&&
($.source.evaluated=(0,t.stringify)($.evaluated))}return v.validate=$,v}catch(L){throw delete v.validate,delete v.validateName,ie&&this.logger.error("Error compiling schema, function code:",ie),L}finally{this._compilations.delete(v)}}Wr.compileSchema=o;function l(v,g,h){var y;h=(0,r.resolveUrl)(this.opts.uriResolver,g,h);const b=v.refs[h];if(b)return b;let R=f.call(this,v,h);if(R===void 0){const T=(y=v.localRefs)===null||y===void 0?void 0:y[h],{schemaId:N}=this.opts;T&&(R=new a({schema:T,schemaId:N,
root:v,baseId:g}))}if(R!==void 0)return v.refs[h]=c.call(this,R)}Wr.resolveRef=l;function c(v){return(0,r.inlineRef)(v.schema,this.opts.inlineRefs)?v.schema:v.validate?v:o.call(this,v)}function u(v){for(const g of this._compilations)if(d(g,v))return g}Wr.getCompilingSchema=u;function d(v,g){return v.schema===g.schema&&v.root===g.root&&v.baseId===g.baseId}function f(v,g){let h;for(;typeof(h=this.refs[g])=="string";)g=h;return h||this.schemas[g]||p.call(this,v,g)}function p(v,g){const h=this.opts.
uriResolver.parse(g),y=(0,r._getFullPath)(this.opts.uriResolver,h);let b=(0,r.getFullPath)(this.opts.uriResolver,v.baseId,void 0);if(Object.keys(v.schema).length>0&&y===b)return w.call(this,h,v);const R=(0,r.normalizeId)(y),T=this.refs[R]||this.schemas[R];if(typeof T=="string"){const N=p.call(this,v,T);return typeof N?.schema!="object"?void 0:w.call(this,h,N)}if(typeof T?.schema=="object"){if(T.validate||o.call(this,T),R===(0,r.normalizeId)(g)){const{schema:N}=T,{schemaId:q}=this.opts,B=N[q];return B&&
(b=(0,r.resolveUrl)(this.opts.uriResolver,b,B)),new a({schema:N,schemaId:q,root:v,baseId:b})}return w.call(this,h,T)}}Wr.resolveSchema=p;const m=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function w(v,{baseId:g,schema:h,root:y}){var b;if(((b=v.fragment)===null||b===void 0?void 0:b[0])!=="/")return;for(const N of v.fragment.slice(1).split("/")){if(typeof h=="boolean")return;const q=h[(0,i.unescapeFragment)(N)];if(q===void 0)return;h=q;const B=typeof h=="object"&&
h[this.opts.schemaId];!m.has(N)&&B&&(g=(0,r.resolveUrl)(this.opts.uriResolver,g,B))}let R;if(typeof h!="boolean"&&h.$ref&&!(0,i.schemaHasRulesButRef)(h,this.RULES)){const N=(0,r.resolveUrl)(this.opts.uriResolver,g,h.$ref);R=p.call(this,y,N)}const{schemaId:T}=this.opts;if(R=R||new a({schema:h,schemaId:T,root:y,baseId:g}),R.schema!==R.root.schema)return R}return Wr}const WM="https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",GM="Meta-schema for $data reference (JSON An\
ySchema extension proposal)",KM="object",ZM=["$data"],JM={$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},YM=!1,hoe={$id:WM,description:GM,type:KM,required:ZM,properties:JM,additionalProperties:YM},moe={__proto__:null,$id:WM,additionalProperties:YM,default:hoe,description:GM,properties:JM,required:ZM,type:KM},goe=Sk(moe);var xv={},eh={exports:{}},e$,XM;function yoe(){return XM||(XM=1,e$={HEX:{0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,a:10,A:10,b:11,B:11,c:12,
C:12,d:13,D:13,e:14,E:14,f:15,F:15}}),e$}var t$,QM;function voe(){if(QM)return t$;QM=1;const{HEX:t}=yoe(),e=/^(?:(?:25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d)$/u;function n(w){if(o(w,".")<3)return{host:w,isIPV4:!1};const v=w.match(e)||[],[g]=v;return g?{host:a(g,"."),isIPV4:!0}:{host:w,isIPV4:!1}}function r(w,v=!1){let g="",h=!0;for(const y of w){if(t[y]===void 0)return;y!=="0"&&h===!0&&(h=!1),h||(g+=y)}return v&&g.length===0&&(g="0"),g}function i(w){let v=0;
const g={error:!1,address:"",zone:""},h=[],y=[];let b=!1,R=!1,T=!1;function N(){if(y.length){if(b===!1){const q=r(y);if(q!==void 0)h.push(q);else return g.error=!0,!1}y.length=0}return!0}for(let q=0;q<w.length;q++){const B=w[q];if(!(B==="["||B==="]"))if(B===":"){if(R===!0&&(T=!0),!N())break;if(v++,h.push(":"),v>7){g.error=!0;break}q-1>=0&&w[q-1]===":"&&(R=!0);continue}else if(B==="%"){if(!N())break;b=!0}else{y.push(B);continue}}return y.length&&(b?g.zone=y.join(""):T?h.push(y.join("")):h.push(r(
y))),g.address=h.join(""),g}function s(w){if(o(w,":")<2)return{host:w,isIPV6:!1};const v=i(w);if(v.error)return{host:w,isIPV6:!1};{let g=v.address,h=v.address;return v.zone&&(g+="%"+v.zone,h+="%25"+v.zone),{host:g,escapedHost:h,isIPV6:!0}}}function a(w,v){let g="",h=!0;const y=w.length;for(let b=0;b<y;b++){const R=w[b];R==="0"&&h?(b+1<=y&&w[b+1]===v||b+1===y)&&(g+=R,h=!1):(R===v?h=!0:h=!1,g+=R)}return g}function o(w,v){let g=0;for(let h=0;h<w.length;h++)w[h]===v&&g++;return g}const l=/^\.\.?\//u,
c=/^\/\.(?:\/|$)/u,u=/^\/\.\.(?:\/|$)/u,d=/^\/?(?:.|\n)*?(?=\/|$)/u;function f(w){const v=[];for(;w.length;)if(w.match(l))w=w.replace(l,"");else if(w.match(c))w=w.replace(c,"/");else if(w.match(u))w=w.replace(u,"/"),v.pop();else if(w==="."||w==="..")w="";else{const g=w.match(d);if(g){const h=g[0];w=w.slice(h.length),v.push(h)}else throw new Error("Unexpected dot segment condition")}return v.join("")}function p(w,v){const g=v!==!0?escape:unescape;return w.scheme!==void 0&&(w.scheme=g(w.scheme)),w.
userinfo!==void 0&&(w.userinfo=g(w.userinfo)),w.host!==void 0&&(w.host=g(w.host)),w.path!==void 0&&(w.path=g(w.path)),w.query!==void 0&&(w.query=g(w.query)),w.fragment!==void 0&&(w.fragment=g(w.fragment)),w}function m(w){const v=[];if(w.userinfo!==void 0&&(v.push(w.userinfo),v.push("@")),w.host!==void 0){let g=unescape(w.host);const h=n(g);if(h.isIPV4)g=h.host;else{const y=s(h.host);y.isIPV6===!0?g=`[${y.escapedHost}]`:g=w.host}v.push(g)}return(typeof w.port=="number"||typeof w.port=="string")&&
(v.push(":"),v.push(String(w.port))),v.length?v.join(""):void 0}return t$={recomposeAuthority:m,normalizeComponentEncoding:p,removeDotSegments:f,normalizeIPv4:n,normalizeIPv6:s,stringArrayToHexStripped:r},t$}var n$,e1;function woe(){if(e1)return n$;e1=1;const t=/^[\da-f]{8}-[\da-f]{4}-[\da-f]{4}-[\da-f]{4}-[\da-f]{12}$/iu,e=/([\da-z][\d\-a-z]{0,31}):((?:[\w!$'()*+,\-.:;=@]|%[\da-f]{2})+)/iu;function n(h){return typeof h.secure=="boolean"?h.secure:String(h.scheme).toLowerCase()==="wss"}function r(h){
return h.host||(h.error=h.error||"HTTP URIs must have a host."),h}function i(h){const y=String(h.scheme).toLowerCase()==="https";return(h.port===(y?443:80)||h.port==="")&&(h.port=void 0),h.path||(h.path="/"),h}function s(h){return h.secure=n(h),h.resourceName=(h.path||"/")+(h.query?"?"+h.query:""),h.path=void 0,h.query=void 0,h}function a(h){if((h.port===(n(h)?443:80)||h.port==="")&&(h.port=void 0),typeof h.secure=="boolean"&&(h.scheme=h.secure?"wss":"ws",h.secure=void 0),h.resourceName){const[y,
b]=h.resourceName.split("?");h.path=y&&y!=="/"?y:void 0,h.query=b,h.resourceName=void 0}return h.fragment=void 0,h}function o(h,y){if(!h.path)return h.error="URN can not be parsed",h;const b=h.path.match(e);if(b){const R=y.scheme||h.scheme||"urn";h.nid=b[1].toLowerCase(),h.nss=b[2];const T=`${R}:${y.nid||h.nid}`,N=g[T];h.path=void 0,N&&(h=N.parse(h,y))}else h.error=h.error||"URN can not be parsed.";return h}function l(h,y){const b=y.scheme||h.scheme||"urn",R=h.nid.toLowerCase(),T=`${b}:${y.nid||
R}`,N=g[T];N&&(h=N.serialize(h,y));const q=h,B=h.nss;return q.path=`${R||y.nid}:${B}`,y.skipEscape=!0,q}function c(h,y){const b=h;return b.uuid=b.nss,b.nss=void 0,!y.tolerant&&(!b.uuid||!t.test(b.uuid))&&(b.error=b.error||"UUID is not valid."),b}function u(h){const y=h;return y.nss=(h.uuid||"").toLowerCase(),y}const d={scheme:"http",domainHost:!0,parse:r,serialize:i},f={scheme:"https",domainHost:d.domainHost,parse:r,serialize:i},p={scheme:"ws",domainHost:!0,parse:s,serialize:a},m={scheme:"wss",domainHost:p.
domainHost,parse:p.parse,serialize:p.serialize},g={http:d,https:f,ws:p,wss:m,urn:{scheme:"urn",parse:o,serialize:l,skipNormalize:!0},"urn:uuid":{scheme:"urn:uuid",parse:c,serialize:u,skipNormalize:!0}};return n$=g,n$}var t1;function boe(){if(t1)return eh.exports;t1=1;const{normalizeIPv6:t,normalizeIPv4:e,removeDotSegments:n,recomposeAuthority:r,normalizeComponentEncoding:i}=voe(),s=woe();function a(v,g){return typeof v=="string"?v=u(m(v,g),g):typeof v=="object"&&(v=m(u(v,g),g)),v}function o(v,g,h){
const y=Object.assign({scheme:"null"},h),b=l(m(v,y),m(g,y),y,!0);return u(b,{...y,skipEscape:!0})}function l(v,g,h,y){const b={};return y||(v=m(u(v,h),h),g=m(u(g,h),h)),h=h||{},!h.tolerant&&g.scheme?(b.scheme=g.scheme,b.userinfo=g.userinfo,b.host=g.host,b.port=g.port,b.path=n(g.path||""),b.query=g.query):(g.userinfo!==void 0||g.host!==void 0||g.port!==void 0?(b.userinfo=g.userinfo,b.host=g.host,b.port=g.port,b.path=n(g.path||""),b.query=g.query):(g.path?(g.path.charAt(0)==="/"?b.path=n(g.path):((v.
userinfo!==void 0||v.host!==void 0||v.port!==void 0)&&!v.path?b.path="/"+g.path:v.path?b.path=v.path.slice(0,v.path.lastIndexOf("/")+1)+g.path:b.path=g.path,b.path=n(b.path)),b.query=g.query):(b.path=v.path,g.query!==void 0?b.query=g.query:b.query=v.query),b.userinfo=v.userinfo,b.host=v.host,b.port=v.port),b.scheme=v.scheme),b.fragment=g.fragment,b}function c(v,g,h){return typeof v=="string"?(v=unescape(v),v=u(i(m(v,h),!0),{...h,skipEscape:!0})):typeof v=="object"&&(v=u(i(v,!0),{...h,skipEscape:!0})),
typeof g=="string"?(g=unescape(g),g=u(i(m(g,h),!0),{...h,skipEscape:!0})):typeof g=="object"&&(g=u(i(g,!0),{...h,skipEscape:!0})),v.toLowerCase()===g.toLowerCase()}function u(v,g){const h={host:v.host,scheme:v.scheme,userinfo:v.userinfo,port:v.port,path:v.path,query:v.query,nid:v.nid,nss:v.nss,uuid:v.uuid,fragment:v.fragment,reference:v.reference,resourceName:v.resourceName,secure:v.secure,error:""},y=Object.assign({},g),b=[],R=s[(y.scheme||h.scheme||"").toLowerCase()];R&&R.serialize&&R.serialize(
h,y),h.path!==void 0&&(y.skipEscape?h.path=unescape(h.path):(h.path=escape(h.path),h.scheme!==void 0&&(h.path=h.path.split("%3A").join(":")))),y.reference!=="suffix"&&h.scheme&&b.push(h.scheme,":");const T=r(h);if(T!==void 0&&(y.reference!=="suffix"&&b.push("//"),b.push(T),h.path&&h.path.charAt(0)!=="/"&&b.push("/")),h.path!==void 0){let N=h.path;!y.absolutePath&&(!R||!R.absolutePath)&&(N=n(N)),T===void 0&&(N=N.replace(/^\/\//u,"/%2F")),b.push(N)}return h.query!==void 0&&b.push("?",h.query),h.fragment!==
void 0&&b.push("#",h.fragment),b.join("")}const d=Array.from({length:127},(v,g)=>/[^!"$&'()*+,\-.;=_`a-z{}~]/u.test(String.fromCharCode(g)));function f(v){let g=0;for(let h=0,y=v.length;h<y;++h)if(g=v.charCodeAt(h),g>126||d[g])return!0;return!1}const p=/^(?:([^#/:?]+):)?(?:\/\/((?:([^#/?@]*)@)?(\[[^#/?\]]+\]|[^#/:?]*)(?::(\d*))?))?([^#?]*)(?:\?([^#]*))?(?:#((?:.|[\n\r])*))?/u;function m(v,g){const h=Object.assign({},g),y={scheme:void 0,userinfo:void 0,host:"",port:void 0,path:"",query:void 0,fragment:void 0},
b=v.indexOf("%")!==-1;let R=!1;h.reference==="suffix"&&(v=(h.scheme?h.scheme+":":"")+"//"+v);const T=v.match(p);if(T){if(y.scheme=T[1],y.userinfo=T[3],y.host=T[4],y.port=parseInt(T[5],10),y.path=T[6]||"",y.query=T[7],y.fragment=T[8],isNaN(y.port)&&(y.port=T[5]),y.host){const q=e(y.host);if(q.isIPV4===!1){const B=t(q.host);y.host=B.host.toLowerCase(),R=B.isIPV6}else y.host=q.host,R=!0}y.scheme===void 0&&y.userinfo===void 0&&y.host===void 0&&y.port===void 0&&y.query===void 0&&!y.path?y.reference="\
same-document":y.scheme===void 0?y.reference="relative":y.fragment===void 0?y.reference="absolute":y.reference="uri",h.reference&&h.reference!=="suffix"&&h.reference!==y.reference&&(y.error=y.error||"URI is not a "+h.reference+" reference.");const N=s[(h.scheme||y.scheme||"").toLowerCase()];if(!h.unicodeSupport&&(!N||!N.unicodeSupport)&&y.host&&(h.domainHost||N&&N.domainHost)&&R===!1&&f(y.host))try{y.host=URL.domainToASCII(y.host.toLowerCase())}catch(q){y.error=y.error||"Host's domain name can n\
ot be converted to ASCII: "+q}(!N||N&&!N.skipNormalize)&&(b&&y.scheme!==void 0&&(y.scheme=unescape(y.scheme)),b&&y.host!==void 0&&(y.host=unescape(y.host)),y.path&&(y.path=escape(unescape(y.path))),y.fragment&&(y.fragment=encodeURI(decodeURIComponent(y.fragment)))),N&&N.parse&&N.parse(y,h)}else y.error=y.error||"URI can not be parsed.";return y}const w={SCHEMES:s,normalize:a,resolve:o,resolveComponents:l,equal:c,serialize:u,parse:m};return eh.exports=w,eh.exports.default=w,eh.exports.fastUri=w,eh.
exports}var n1;function koe(){if(n1)return xv;n1=1,Object.defineProperty(xv,"__esModule",{value:!0});const t=boe();return t.code='require("ajv/dist/runtime/uri").default',xv.default=t,xv}var r1;function i1(){return r1||(r1=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.CodeGen=t.Name=t.nil=t.stringify=t.str=t._=t.KeywordCxt=void 0;var e=Xp();Object.defineProperty(t,"KeywordCxt",{enumerable:!0,get:function(){return e.KeywordCxt}});var n=et();Object.defineProperty(t,"_",{enumerable:!0,
get:function(){return n._}}),Object.defineProperty(t,"str",{enumerable:!0,get:function(){return n.str}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return n.stringify}}),Object.defineProperty(t,"nil",{enumerable:!0,get:function(){return n.nil}}),Object.defineProperty(t,"Name",{enumerable:!0,get:function(){return n.Name}}),Object.defineProperty(t,"CodeGen",{enumerable:!0,get:function(){return n.CodeGen}});const r=Ev(),i=Qp(),s=xM(),a=Cv(),o=et(),l=$v(),c=Sv(),u=bt(),d=goe,f=koe(),
p=(P,M)=>new RegExp(P,M);p.code="new RegExp";const m=["removeAdditional","useDefaults","coerceTypes"],w=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),v={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",
missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cach\
e, schema object as key.",serialize:"Map is used as cache, schema object as key.",ajvErrors:"It is default now."},g={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'},h=200;function y(P){var M,J,G,_,I,Y,se,fe,_e,pe,x,O,K,F,ae,Re,ze,ye,Me,me,$e,Ge,st,ut,ln;const Yt=P.strict,_n=(M=P.code)===null||M===void 0?void 0:M.optimize,ce=_n===!0||_n===void 0?1:_n||0,ue=(G=(J=P.code)===null||J===void 0?void 0:J.regExp)!==null&&G!==void 0?
G:p,Se=(_=P.uriResolver)!==null&&_!==void 0?_:f.default;return{strictSchema:(Y=(I=P.strictSchema)!==null&&I!==void 0?I:Yt)!==null&&Y!==void 0?Y:!0,strictNumbers:(fe=(se=P.strictNumbers)!==null&&se!==void 0?se:Yt)!==null&&fe!==void 0?fe:!0,strictTypes:(pe=(_e=P.strictTypes)!==null&&_e!==void 0?_e:Yt)!==null&&pe!==void 0?pe:"log",strictTuples:(O=(x=P.strictTuples)!==null&&x!==void 0?x:Yt)!==null&&O!==void 0?O:"log",strictRequired:(F=(K=P.strictRequired)!==null&&K!==void 0?K:Yt)!==null&&F!==void 0?
F:!1,code:P.code?{...P.code,optimize:ce,regExp:ue}:{optimize:ce,regExp:ue},loopRequired:(ae=P.loopRequired)!==null&&ae!==void 0?ae:h,loopEnum:(Re=P.loopEnum)!==null&&Re!==void 0?Re:h,meta:(ze=P.meta)!==null&&ze!==void 0?ze:!0,messages:(ye=P.messages)!==null&&ye!==void 0?ye:!0,inlineRefs:(Me=P.inlineRefs)!==null&&Me!==void 0?Me:!0,schemaId:(me=P.schemaId)!==null&&me!==void 0?me:"$id",addUsedSchema:($e=P.addUsedSchema)!==null&&$e!==void 0?$e:!0,validateSchema:(Ge=P.validateSchema)!==null&&Ge!==void 0?
Ge:!0,validateFormats:(st=P.validateFormats)!==null&&st!==void 0?st:!0,unicodeRegExp:(ut=P.unicodeRegExp)!==null&&ut!==void 0?ut:!0,int32range:(ln=P.int32range)!==null&&ln!==void 0?ln:!0,uriResolver:Se}}class b{constructor(M={}){this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,M=this.opts={...M,...y(M)};const{es5:J,lines:G}=this.opts.code;this.scope=new o.ValueScope({scope:{},prefixes:w,es5:J,lines:G}),this.logger=E(M.logger);const _=M.
validateFormats;M.validateFormats=!1,this.RULES=(0,s.getRules)(),R.call(this,v,M,"NOT SUPPORTED"),R.call(this,g,M,"DEPRECATED","warn"),this._metaOpts=ie.call(this),M.formats&&q.call(this),this._addVocabularies(),this._addDefaultMetaSchema(),M.keywords&&B.call(this,M.keywords),typeof M.meta=="object"&&this.addMetaSchema(M.meta),N.call(this),M.validateFormats=_}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){const{$data:M,meta:J,schemaId:G}=this.opts;let _=d;G==="id"&&(_={...d},
_.id=_.$id,delete _.$id),J&&M&&this.addMetaSchema(_,_[G],!1)}defaultMeta(){const{meta:M,schemaId:J}=this.opts;return this.opts.defaultMeta=typeof M=="object"?M[J]||M:void 0}validate(M,J){let G;if(typeof M=="string"){if(G=this.getSchema(M),!G)throw new Error(`no schema with key or ref "${M}"`)}else G=this.compile(M);const _=G(J);return"$async"in G||(this.errors=G.errors),_}compile(M,J){const G=this._addSchema(M,J);return G.validate||this._compileSchemaEnv(G)}compileAsync(M,J){if(typeof this.opts.
loadSchema!="function")throw new Error("options.loadSchema should be a function");const{loadSchema:G}=this.opts;return _.call(this,M,J);async function _(pe,x){await I.call(this,pe.$schema);const O=this._addSchema(pe,x);return O.validate||Y.call(this,O)}async function I(pe){pe&&!this.getSchema(pe)&&await _.call(this,{$ref:pe},!0)}async function Y(pe){try{return this._compileSchemaEnv(pe)}catch(x){if(!(x instanceof i.default))throw x;return se.call(this,x),await fe.call(this,x.missingSchema),Y.call(
this,pe)}}function se({missingSchema:pe,missingRef:x}){if(this.refs[pe])throw new Error(`AnySchema ${pe} is loaded but ${x} cannot be resolved`)}async function fe(pe){const x=await _e.call(this,pe);this.refs[pe]||await I.call(this,x.$schema),this.refs[pe]||this.addSchema(x,pe,J)}async function _e(pe){const x=this._loading[pe];if(x)return x;try{return await(this._loading[pe]=G(pe))}finally{delete this._loading[pe]}}}addSchema(M,J,G,_=this.opts.validateSchema){if(Array.isArray(M)){for(const Y of M)
this.addSchema(Y,void 0,G,_);return this}let I;if(typeof M=="object"){const{schemaId:Y}=this.opts;if(I=M[Y],I!==void 0&&typeof I!="string")throw new Error(`schema ${Y} must be string`)}return J=(0,l.normalizeId)(J||I),this._checkUnique(J),this.schemas[J]=this._addSchema(M,G,J,_,!0),this}addMetaSchema(M,J,G=this.opts.validateSchema){return this.addSchema(M,J,!0,G),this}validateSchema(M,J){if(typeof M=="boolean")return!0;let G;if(G=M.$schema,G!==void 0&&typeof G!="string")throw new Error("$schema \
must be a string");if(G=G||this.opts.defaultMeta||this.defaultMeta(),!G)return this.logger.warn("meta-schema not available"),this.errors=null,!0;const _=this.validate(G,M);if(!_&&J){const I="schema is invalid: "+this.errorsText();if(this.opts.validateSchema==="log")this.logger.error(I);else throw new Error(I)}return _}getSchema(M){let J;for(;typeof(J=T.call(this,M))=="string";)M=J;if(J===void 0){const{schemaId:G}=this.opts,_=new a.SchemaEnv({schema:{},schemaId:G});if(J=a.resolveSchema.call(this,
_,M),!J)return;this.refs[M]=J}return J.validate||this._compileSchemaEnv(J)}removeSchema(M){if(M instanceof RegExp)return this._removeAllSchemas(this.schemas,M),this._removeAllSchemas(this.refs,M),this;switch(typeof M){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":{const J=T.call(this,M);return typeof J=="object"&&this._cache.delete(J.schema),delete this.schemas[M],delete this.refs[M],this}case"object":{const J=M;
this._cache.delete(J);let G=M[this.opts.schemaId];return G&&(G=(0,l.normalizeId)(G),delete this.schemas[G],delete this.refs[G]),this}default:throw new Error("ajv.removeSchema: invalid parameter")}}addVocabulary(M){for(const J of M)this.addKeyword(J);return this}addKeyword(M,J){let G;if(typeof M=="string")G=M,typeof J=="object"&&(this.logger.warn("these parameters are deprecated, see docs for addKeyword"),J.keyword=G);else if(typeof M=="object"&&J===void 0){if(J=M,G=J.keyword,Array.isArray(G)&&!G.
length)throw new Error("addKeywords: keyword must be string or non-empty array")}else throw new Error("invalid addKeywords parameters");if(z.call(this,G,J),!J)return(0,u.eachItem)(G,I=>j.call(this,I)),this;W.call(this,J);const _={...J,type:(0,c.getJSONTypes)(J.type),schemaType:(0,c.getJSONTypes)(J.schemaType)};return(0,u.eachItem)(G,_.type.length===0?I=>j.call(this,I,_):I=>_.type.forEach(Y=>j.call(this,I,_,Y))),this}getKeyword(M){const J=this.RULES.all[M];return typeof J=="object"?J.definition:!!J}removeKeyword(M){
const{RULES:J}=this;delete J.keywords[M],delete J.all[M];for(const G of J.rules){const _=G.rules.findIndex(I=>I.keyword===M);_>=0&&G.rules.splice(_,1)}return this}addFormat(M,J){return typeof J=="string"&&(J=new RegExp(J)),this.formats[M]=J,this}errorsText(M=this.errors,{separator:J=", ",dataVar:G="data"}={}){return!M||M.length===0?"No errors":M.map(_=>`${G}${_.instancePath} ${_.message}`).reduce((_,I)=>_+J+I)}$dataMetaSchema(M,J){const G=this.RULES.all;M=JSON.parse(JSON.stringify(M));for(const _ of J){
const I=_.split("/").slice(1);let Y=M;for(const se of I)Y=Y[se];for(const se in G){const fe=G[se];if(typeof fe!="object")continue;const{$data:_e}=fe.definition,pe=Y[se];_e&&pe&&(Y[se]=ne(pe))}}return M}_removeAllSchemas(M,J){for(const G in M){const _=M[G];(!J||J.test(G))&&(typeof _=="string"?delete M[G]:_&&!_.meta&&(this._cache.delete(_.schema),delete M[G]))}}_addSchema(M,J,G,_=this.opts.validateSchema,I=this.opts.addUsedSchema){let Y;const{schemaId:se}=this.opts;if(typeof M=="object")Y=M[se];else{
if(this.opts.jtd)throw new Error("schema must be object");if(typeof M!="boolean")throw new Error("schema must be object or boolean")}let fe=this._cache.get(M);if(fe!==void 0)return fe;G=(0,l.normalizeId)(Y||G);const _e=l.getSchemaRefs.call(this,M,G);return fe=new a.SchemaEnv({schema:M,schemaId:se,meta:J,baseId:G,localRefs:_e}),this._cache.set(fe.schema,fe),I&&!G.startsWith("#")&&(G&&this._checkUnique(G),this.refs[G]=fe),_&&this.validateSchema(M,!0),fe}_checkUnique(M){if(this.schemas[M]||this.refs[M])
throw new Error(`schema with key or id "${M}" already exists`)}_compileSchemaEnv(M){if(M.meta?this._compileMetaSchema(M):a.compileSchema.call(this,M),!M.validate)throw new Error("ajv implementation error");return M.validate}_compileMetaSchema(M){const J=this.opts;this.opts=this._metaOpts;try{a.compileSchema.call(this,M)}finally{this.opts=J}}}b.ValidationError=r.default,b.MissingRefError=i.default,t.default=b;function R(P,M,J,G="error"){for(const _ in P){const I=_;I in M&&this.logger[G](`${J}: op\
tion ${_}. ${P[I]}`)}}function T(P){return P=(0,l.normalizeId)(P),this.schemas[P]||this.refs[P]}function N(){const P=this.opts.schemas;if(P)if(Array.isArray(P))this.addSchema(P);else for(const M in P)this.addSchema(P[M],M)}function q(){for(const P in this.opts.formats){const M=this.opts.formats[P];M&&this.addFormat(P,M)}}function B(P){if(Array.isArray(P)){this.addVocabulary(P);return}this.logger.warn("keywords option as map is deprecated, pass array");for(const M in P){const J=P[M];J.keyword||(J.
keyword=M),this.addKeyword(J)}}function ie(){const P={...this.opts};for(const M of m)delete P[M];return P}const L={log(){},warn(){},error(){}};function E(P){if(P===!1)return L;if(P===void 0)return console;if(P.log&&P.warn&&P.error)return P;throw new Error("logger must implement log, warn and error methods")}const $=/^[a-z_$][a-z0-9_$:-]*$/i;function z(P,M){const{RULES:J}=this;if((0,u.eachItem)(P,G=>{if(J.keywords[G])throw new Error(`Keyword ${G} is already defined`);if(!$.test(G))throw new Error(
`Keyword ${G} has invalid name`)}),!!M&&M.$data&&!("code"in M||"validate"in M))throw new Error('$data keyword must have "code" or "validate" function')}function j(P,M,J){var G;const _=M?.post;if(J&&_)throw new Error('keyword with "post" flag cannot have "type"');const{RULES:I}=this;let Y=_?I.post:I.rules.find(({type:fe})=>fe===J);if(Y||(Y={type:J,rules:[]},I.rules.push(Y)),I.keywords[P]=!0,!M)return;const se={keyword:P,definition:{...M,type:(0,c.getJSONTypes)(M.type),schemaType:(0,c.getJSONTypes)(
M.schemaType)}};M.before?U.call(this,Y,se,M.before):Y.rules.push(se),I.all[P]=se,(G=M.implements)===null||G===void 0||G.forEach(fe=>this.addKeyword(fe))}function U(P,M,J){const G=P.rules.findIndex(_=>_.keyword===J);G>=0?P.rules.splice(G,0,M):(P.rules.push(M),this.logger.warn(`rule ${J} is not defined`))}function W(P){let{metaSchema:M}=P;M!==void 0&&(P.$data&&this.opts.$data&&(M=ne(M)),P.validateSchema=this.compile(M,!0))}const le={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/\
lib/refs/data.json#"};function ne(P){return{anyOf:[P,le]}}})(GS)),GS}var Av={},Iv={},Nv={},s1;function _oe(){if(s1)return Nv;s1=1,Object.defineProperty(Nv,"__esModule",{value:!0});const t={keyword:"id",code(){throw new Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}};return Nv.default=t,Nv}var Na={},a1;function o1(){if(a1)return Na;a1=1,Object.defineProperty(Na,"__esModule",{value:!0}),Na.callRef=Na.getValidate=void 0;const t=Qp(),e=Ai(),n=et(),r=Vs(),i=Cv(),s=bt(),a={keyword:"$re\
f",schemaType:"string",code(c){const{gen:u,schema:d,it:f}=c,{baseId:p,schemaEnv:m,validateName:w,opts:v,self:g}=f,{root:h}=m;if((d==="#"||d==="#/")&&p===h.baseId)return b();const y=i.resolveRef.call(g,h,p,d);if(y===void 0)throw new t.default(f.opts.uriResolver,p,d);if(y instanceof i.SchemaEnv)return R(y);return T(y);function b(){if(m===h)return l(c,w,m,m.$async);const N=u.scopeValue("root",{ref:h});return l(c,(0,n._)`${N}.validate`,h,h.$async)}function R(N){const q=o(c,N);l(c,q,N,N.$async)}function T(N){
const q=u.scopeValue("schema",v.code.source===!0?{ref:N,code:(0,n.stringify)(N)}:{ref:N}),B=u.name("valid"),ie=c.subschema({schema:N,dataTypes:[],schemaPath:n.nil,topSchemaRef:q,errSchemaPath:d},B);c.mergeEvaluated(ie),c.ok(B)}}};function o(c,u){const{gen:d}=c;return u.validate?d.scopeValue("validate",{ref:u.validate}):(0,n._)`${d.scopeValue("wrapper",{ref:u})}.validate`}Na.getValidate=o;function l(c,u,d,f){const{gen:p,it:m}=c,{allErrors:w,schemaEnv:v,opts:g}=m,h=g.passContext?r.default.this:n.nil;
f?y():b();function y(){if(!v.$async)throw new Error("async schema referenced by sync schema");const N=p.let("valid");p.try(()=>{p.code((0,n._)`await ${(0,e.callValidateCode)(c,u,h)}`),T(u),w||p.assign(N,!0)},q=>{p.if((0,n._)`!(${q} instanceof ${m.ValidationError})`,()=>p.throw(q)),R(q),w||p.assign(N,!1)}),c.ok(N)}function b(){c.result((0,e.callValidateCode)(c,u,h),()=>T(u),()=>R(u))}function R(N){const q=(0,n._)`${N}.errors`;p.assign(r.default.vErrors,(0,n._)`${r.default.vErrors} === null ? ${q} : ${r.
default.vErrors}.concat(${q})`),p.assign(r.default.errors,(0,n._)`${r.default.vErrors}.length`)}function T(N){var q;if(!m.opts.unevaluated)return;const B=(q=d?.validate)===null||q===void 0?void 0:q.evaluated;if(m.props!==!0)if(B&&!B.dynamicProps)B.props!==void 0&&(m.props=s.mergeEvaluated.props(p,B.props,m.props));else{const ie=p.var("props",(0,n._)`${N}.evaluated.props`);m.props=s.mergeEvaluated.props(p,ie,m.props,n.Name)}if(m.items!==!0)if(B&&!B.dynamicItems)B.items!==void 0&&(m.items=s.mergeEvaluated.
items(p,B.items,m.items));else{const ie=p.var("items",(0,n._)`${N}.evaluated.items`);m.items=s.mergeEvaluated.items(p,ie,m.items,n.Name)}}}return Na.callRef=l,Na.default=a,Na}var l1;function c1(){if(l1)return Iv;l1=1,Object.defineProperty(Iv,"__esModule",{value:!0});const t=_oe(),e=o1(),n=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",t.default,e.default];return Iv.default=n,Iv}var Dv={},Ov={},u1;function Roe(){if(u1)return Ov;u1=1,Object.defineProperty(Ov,"__esModule",
{value:!0});const t=et(),e=t.operators,n={maximum:{okStr:"<=",ok:e.LTE,fail:e.GT},minimum:{okStr:">=",ok:e.GTE,fail:e.LT},exclusiveMaximum:{okStr:"<",ok:e.LT,fail:e.GTE},exclusiveMinimum:{okStr:">",ok:e.GT,fail:e.LTE}},r={message:({keyword:s,schemaCode:a})=>(0,t.str)`must be ${n[s].okStr} ${a}`,params:({keyword:s,schemaCode:a})=>(0,t._)`{comparison: ${n[s].okStr}, limit: ${a}}`},i={keyword:Object.keys(n),type:"number",schemaType:"number",$data:!0,error:r,code(s){const{keyword:a,data:o,schemaCode:l}=s;
s.fail$data((0,t._)`${o} ${n[a].fail} ${l} || isNaN(${o})`)}};return Ov.default=i,Ov}var Lv={},d1;function Soe(){if(d1)return Lv;d1=1,Object.defineProperty(Lv,"__esModule",{value:!0});const t=et(),n={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:{message:({schemaCode:r})=>(0,t.str)`must be multiple of ${r}`,params:({schemaCode:r})=>(0,t._)`{multipleOf: ${r}}`},code(r){const{gen:i,data:s,schemaCode:a,it:o}=r,l=o.opts.multipleOfPrecision,c=i.let("res"),u=l?(0,t._)`Math.abs(Math.round(${c}) - ${c}) > 1e-${l}`:
(0,t._)`${c} !== parseInt(${c})`;r.fail$data((0,t._)`(${a} === 0 || (${c} = ${s}/${a}, ${u}))`)}};return Lv.default=n,Lv}var Mv={},jv={},f1;function $oe(){if(f1)return jv;f1=1,Object.defineProperty(jv,"__esModule",{value:!0});function t(e){const n=e.length;let r=0,i=0,s;for(;i<n;)r++,s=e.charCodeAt(i++),s>=55296&&s<=56319&&i<n&&(s=e.charCodeAt(i),(s&64512)===56320&&i++);return r}return jv.default=t,t.code='require("ajv/dist/runtime/ucs2length").default',jv}var p1;function Toe(){if(p1)return Mv;p1=
1,Object.defineProperty(Mv,"__esModule",{value:!0});const t=et(),e=bt(),n=$oe(),i={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:{message({keyword:s,schemaCode:a}){const o=s==="maxLength"?"more":"fewer";return(0,t.str)`must NOT have ${o} than ${a} characters`},params:({schemaCode:s})=>(0,t._)`{limit: ${s}}`},code(s){const{keyword:a,data:o,schemaCode:l,it:c}=s,u=a==="maxLength"?t.operators.GT:t.operators.LT,d=c.opts.unicode===!1?(0,t._)`${o}.length`:(0,t._)`${(0,e.
useFunc)(s.gen,n.default)}(${o})`;s.fail$data((0,t._)`${d} ${u} ${l}`)}};return Mv.default=i,Mv}var qv={},h1;function Eoe(){if(h1)return qv;h1=1,Object.defineProperty(qv,"__esModule",{value:!0});const t=Ai(),e=et(),r={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:{message:({schemaCode:i})=>(0,e.str)`must match pattern "${i}"`,params:({schemaCode:i})=>(0,e._)`{pattern: ${i}}`},code(i){const{data:s,$data:a,schema:o,schemaCode:l,it:c}=i,u=c.opts.unicodeRegExp?"u":"",d=a?(0,e._)`(new RegExp(${l}, ${u}))`:
(0,t.usePattern)(i,o);i.fail$data((0,e._)`!${d}.test(${s})`)}};return qv.default=r,qv}var Fv={},m1;function Poe(){if(m1)return Fv;m1=1,Object.defineProperty(Fv,"__esModule",{value:!0});const t=et(),n={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:{message({keyword:r,schemaCode:i}){const s=r==="maxProperties"?"more":"fewer";return(0,t.str)`must NOT have ${s} than ${i} properties`},params:({schemaCode:r})=>(0,t._)`{limit: ${r}}`},code(r){const{keyword:i,
data:s,schemaCode:a}=r,o=i==="maxProperties"?t.operators.GT:t.operators.LT;r.fail$data((0,t._)`Object.keys(${s}).length ${o} ${a}`)}};return Fv.default=n,Fv}var zv={},g1;function Coe(){if(g1)return zv;g1=1,Object.defineProperty(zv,"__esModule",{value:!0});const t=Ai(),e=et(),n=bt(),i={keyword:"required",type:"object",schemaType:"array",$data:!0,error:{message:({params:{missingProperty:s}})=>(0,e.str)`must have required property '${s}'`,params:({params:{missingProperty:s}})=>(0,e._)`{missingProperty: ${s}}`},
code(s){const{gen:a,schema:o,schemaCode:l,data:c,$data:u,it:d}=s,{opts:f}=d;if(!u&&o.length===0)return;const p=o.length>=f.loopRequired;if(d.allErrors?m():w(),f.strictRequired){const h=s.parentSchema.properties,{definedProperties:y}=s.it;for(const b of o)if(h?.[b]===void 0&&!y.has(b)){const R=d.schemaEnv.baseId+d.errSchemaPath,T=`required property "${b}" is not defined at "${R}" (strictRequired)`;(0,n.checkStrictMode)(d,T,d.opts.strictRequired)}}function m(){if(p||u)s.block$data(e.nil,v);else for(const h of o)
(0,t.checkReportMissingProp)(s,h)}function w(){const h=a.let("missing");if(p||u){const y=a.let("valid",!0);s.block$data(y,()=>g(h,y)),s.ok(y)}else a.if((0,t.checkMissingProp)(s,o,h)),(0,t.reportMissingProp)(s,h),a.else()}function v(){a.forOf("prop",l,h=>{s.setParams({missingProperty:h}),a.if((0,t.noPropertyInData)(a,c,h,f.ownProperties),()=>s.error())})}function g(h,y){s.setParams({missingProperty:h}),a.forOf(h,l,()=>{a.assign(y,(0,t.propertyInData)(a,c,h,f.ownProperties)),a.if((0,e.not)(y),()=>{
s.error(),a.break()})},e.nil)}}};return zv.default=i,zv}var Uv={},y1;function xoe(){if(y1)return Uv;y1=1,Object.defineProperty(Uv,"__esModule",{value:!0});const t=et(),n={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:{message({keyword:r,schemaCode:i}){const s=r==="maxItems"?"more":"fewer";return(0,t.str)`must NOT have ${s} than ${i} items`},params:({schemaCode:r})=>(0,t._)`{limit: ${r}}`},code(r){const{keyword:i,data:s,schemaCode:a}=r,o=i==="maxItems"?t.operators.
GT:t.operators.LT;r.fail$data((0,t._)`${s}.length ${o} ${a}`)}};return Uv.default=n,Uv}var Hv={},Vv={},v1;function r$(){if(v1)return Vv;v1=1,Object.defineProperty(Vv,"__esModule",{value:!0});const t=qM();return t.code='require("ajv/dist/runtime/equal").default',Vv.default=t,Vv}var w1;function Aoe(){if(w1)return Hv;w1=1,Object.defineProperty(Hv,"__esModule",{value:!0});const t=Sv(),e=et(),n=bt(),r=r$(),s={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:{message:({params:{i:a,
j:o}})=>(0,e.str)`must NOT have duplicate items (items ## ${o} and ${a} are identical)`,params:({params:{i:a,j:o}})=>(0,e._)`{i: ${a}, j: ${o}}`},code(a){const{gen:o,data:l,$data:c,schema:u,parentSchema:d,schemaCode:f,it:p}=a;if(!c&&!u)return;const m=o.let("valid"),w=d.items?(0,t.getSchemaTypes)(d.items):[];a.block$data(m,v,(0,e._)`${f} === false`),a.ok(m);function v(){const b=o.let("i",(0,e._)`${l}.length`),R=o.let("j");a.setParams({i:b,j:R}),o.assign(m,!0),o.if((0,e._)`${b} > 1`,()=>(g()?h:y)(
b,R))}function g(){return w.length>0&&!w.some(b=>b==="object"||b==="array")}function h(b,R){const T=o.name("item"),N=(0,t.checkDataTypes)(w,T,p.opts.strictNumbers,t.DataType.Wrong),q=o.const("indices",(0,e._)`{}`);o.for((0,e._)`;${b}--;`,()=>{o.let(T,(0,e._)`${l}[${b}]`),o.if(N,(0,e._)`continue`),w.length>1&&o.if((0,e._)`typeof ${T} == "string"`,(0,e._)`${T} += "_"`),o.if((0,e._)`typeof ${q}[${T}] == "number"`,()=>{o.assign(R,(0,e._)`${q}[${T}]`),a.error(),o.assign(m,!1).break()}).code((0,e._)`${q}[${T}] = ${b}`)})}
function y(b,R){const T=(0,n.useFunc)(o,r.default),N=o.name("outer");o.label(N).for((0,e._)`;${b}--;`,()=>o.for((0,e._)`${R} = ${b}; ${R}--;`,()=>o.if((0,e._)`${T}(${l}[${b}], ${l}[${R}])`,()=>{a.error(),o.assign(m,!1).break(N)})))}}};return Hv.default=s,Hv}var Bv={},b1;function Ioe(){if(b1)return Bv;b1=1,Object.defineProperty(Bv,"__esModule",{value:!0});const t=et(),e=bt(),n=r$(),i={keyword:"const",$data:!0,error:{message:"must be equal to constant",params:({schemaCode:s})=>(0,t._)`{allowedValue: ${s}}`},
code(s){const{gen:a,data:o,$data:l,schemaCode:c,schema:u}=s;l||u&&typeof u=="object"?s.fail$data((0,t._)`!${(0,e.useFunc)(a,n.default)}(${o}, ${c})`):s.fail((0,t._)`${u} !== ${o}`)}};return Bv.default=i,Bv}var Wv={},k1;function Noe(){if(k1)return Wv;k1=1,Object.defineProperty(Wv,"__esModule",{value:!0});const t=et(),e=bt(),n=r$(),i={keyword:"enum",schemaType:"array",$data:!0,error:{message:"must be equal to one of the allowed values",params:({schemaCode:s})=>(0,t._)`{allowedValues: ${s}}`},code(s){
const{gen:a,data:o,$data:l,schema:c,schemaCode:u,it:d}=s;if(!l&&c.length===0)throw new Error("enum must have non-empty array");const f=c.length>=d.opts.loopEnum;let p;const m=()=>p??(p=(0,e.useFunc)(a,n.default));let w;if(f||l)w=a.let("valid"),s.block$data(w,v);else{if(!Array.isArray(c))throw new Error("ajv implementation error");const h=a.const("vSchema",u);w=(0,t.or)(...c.map((y,b)=>g(h,b)))}s.pass(w);function v(){a.assign(w,!1),a.forOf("v",u,h=>a.if((0,t._)`${m()}(${o}, ${h})`,()=>a.assign(w,
!0).break()))}function g(h,y){const b=c[y];return typeof b=="object"&&b!==null?(0,t._)`${m()}(${o}, ${h}[${y}])`:(0,t._)`${o} === ${b}`}}};return Wv.default=i,Wv}var _1;function R1(){if(_1)return Dv;_1=1,Object.defineProperty(Dv,"__esModule",{value:!0});const t=Roe(),e=Soe(),n=Toe(),r=Eoe(),i=Poe(),s=Coe(),a=xoe(),o=Aoe(),l=Ioe(),c=Noe(),u=[t.default,e.default,n.default,r.default,i.default,s.default,a.default,o.default,{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"\
boolean"},l.default,c.default];return Dv.default=u,Dv}var Gv={},Nc={},S1;function $1(){if(S1)return Nc;S1=1,Object.defineProperty(Nc,"__esModule",{value:!0}),Nc.validateAdditionalItems=void 0;const t=et(),e=bt(),r={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:{message:({params:{len:s}})=>(0,t.str)`must NOT have more than ${s} items`,params:({params:{len:s}})=>(0,t._)`{limit: ${s}}`},code(s){const{parentSchema:a,it:o}=s,{items:l}=a;if(!Array.isArray(
l)){(0,e.checkStrictMode)(o,'"additionalItems" is ignored when "items" is not an array of schemas');return}i(s,l)}};function i(s,a){const{gen:o,schema:l,data:c,keyword:u,it:d}=s;d.items=!0;const f=o.const("len",(0,t._)`${c}.length`);if(l===!1)s.setParams({len:a.length}),s.pass((0,t._)`${f} <= ${a.length}`);else if(typeof l=="object"&&!(0,e.alwaysValidSchema)(d,l)){const m=o.var("valid",(0,t._)`${f} <= ${a.length}`);o.if((0,t.not)(m),()=>p(m)),s.ok(m)}function p(m){o.forRange("i",a.length,f,w=>{s.
subschema({keyword:u,dataProp:w,dataPropType:e.Type.Num},m),d.allErrors||o.if((0,t.not)(m),()=>o.break())})}}return Nc.validateAdditionalItems=i,Nc.default=r,Nc}var Kv={},Dc={},T1;function E1(){if(T1)return Dc;T1=1,Object.defineProperty(Dc,"__esModule",{value:!0}),Dc.validateTuple=void 0;const t=et(),e=bt(),n=Ai(),r={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(s){const{schema:a,it:o}=s;if(Array.isArray(a))return i(s,"additionalItems",a);o.items=
!0,!(0,e.alwaysValidSchema)(o,a)&&s.ok((0,n.validateArray)(s))}};function i(s,a,o=s.schema){const{gen:l,parentSchema:c,data:u,keyword:d,it:f}=s;w(c),f.opts.unevaluated&&o.length&&f.items!==!0&&(f.items=e.mergeEvaluated.items(l,o.length,f.items));const p=l.name("valid"),m=l.const("len",(0,t._)`${u}.length`);o.forEach((v,g)=>{(0,e.alwaysValidSchema)(f,v)||(l.if((0,t._)`${m} > ${g}`,()=>s.subschema({keyword:d,schemaProp:g,dataProp:g},p)),s.ok(p))});function w(v){const{opts:g,errSchemaPath:h}=f,y=o.
length,b=y===v.minItems&&(y===v.maxItems||v[a]===!1);if(g.strictTuples&&!b){const R=`"${d}" is ${y}-tuple, but minItems or maxItems/${a} are not specified or different at path "${h}"`;(0,e.checkStrictMode)(f,R,g.strictTuples)}}}return Dc.validateTuple=i,Dc.default=r,Dc}var P1;function Doe(){if(P1)return Kv;P1=1,Object.defineProperty(Kv,"__esModule",{value:!0});const t=E1(),e={keyword:"prefixItems",type:"array",schemaType:["array"],before:"uniqueItems",code:n=>(0,t.validateTuple)(n,"items")};return Kv.
default=e,Kv}var Zv={},C1;function Ooe(){if(C1)return Zv;C1=1,Object.defineProperty(Zv,"__esModule",{value:!0});const t=et(),e=bt(),n=Ai(),r=$1(),s={keyword:"items",type:"array",schemaType:["object","boolean"],before:"uniqueItems",error:{message:({params:{len:a}})=>(0,t.str)`must NOT have more than ${a} items`,params:({params:{len:a}})=>(0,t._)`{limit: ${a}}`},code(a){const{schema:o,parentSchema:l,it:c}=a,{prefixItems:u}=l;c.items=!0,!(0,e.alwaysValidSchema)(c,o)&&(u?(0,r.validateAdditionalItems)(
a,u):a.ok((0,n.validateArray)(a)))}};return Zv.default=s,Zv}var Jv={},x1;function Loe(){if(x1)return Jv;x1=1,Object.defineProperty(Jv,"__esModule",{value:!0});const t=et(),e=bt(),r={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:{message:({params:{min:i,max:s}})=>s===void 0?(0,t.str)`must contain at least ${i} valid item(s)`:(0,t.str)`must contain at least ${i} and no more than ${s} valid item(s)`,params:({params:{min:i,max:s}})=>s===void 0?
(0,t._)`{minContains: ${i}}`:(0,t._)`{minContains: ${i}, maxContains: ${s}}`},code(i){const{gen:s,schema:a,parentSchema:o,data:l,it:c}=i;let u,d;const{minContains:f,maxContains:p}=o;c.opts.next?(u=f===void 0?1:f,d=p):u=1;const m=s.const("len",(0,t._)`${l}.length`);if(i.setParams({min:u,max:d}),d===void 0&&u===0){(0,e.checkStrictMode)(c,'"minContains" == 0 without "maxContains": "contains" keyword ignored');return}if(d!==void 0&&u>d){(0,e.checkStrictMode)(c,'"minContains" > "maxContains" is alway\
s invalid'),i.fail();return}if((0,e.alwaysValidSchema)(c,a)){let y=(0,t._)`${m} >= ${u}`;d!==void 0&&(y=(0,t._)`${y} && ${m} <= ${d}`),i.pass(y);return}c.items=!0;const w=s.name("valid");d===void 0&&u===1?g(w,()=>s.if(w,()=>s.break())):u===0?(s.let(w,!0),d!==void 0&&s.if((0,t._)`${l}.length > 0`,v)):(s.let(w,!1),v()),i.result(w,()=>i.reset());function v(){const y=s.name("_valid"),b=s.let("count",0);g(y,()=>s.if(y,()=>h(b)))}function g(y,b){s.forRange("i",0,m,R=>{i.subschema({keyword:"contains",dataProp:R,
dataPropType:e.Type.Num,compositeRule:!0},y),b()})}function h(y){s.code((0,t._)`${y}++`),d===void 0?s.if((0,t._)`${y} >= ${u}`,()=>s.assign(w,!0).break()):(s.if((0,t._)`${y} > ${d}`,()=>s.assign(w,!1).break()),u===1?s.assign(w,!0):s.if((0,t._)`${y} >= ${u}`,()=>s.assign(w,!0)))}}};return Jv.default=r,Jv}var i$={},A1;function I1(){return A1||(A1=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.validateSchemaDeps=t.validatePropertyDeps=t.error=void 0;const e=et(),n=bt(),r=Ai();t.error=
{message:({params:{property:l,depsCount:c,deps:u}})=>{const d=c===1?"property":"properties";return(0,e.str)`must have ${d} ${u} when property ${l} is present`},params:({params:{property:l,depsCount:c,deps:u,missingProperty:d}})=>(0,e._)`{property: ${l},
    missingProperty: ${d},
    depsCount: ${c},
    deps: ${u}}`};const i={keyword:"dependencies",type:"object",schemaType:"object",error:t.error,code(l){const[c,u]=s(l);a(l,c),o(l,u)}};function s({schema:l}){const c={},u={};for(const d in l){if(d==="__proto__")continue;const f=Array.isArray(l[d])?c:u;f[d]=l[d]}return[c,u]}function a(l,c=l.schema){const{gen:u,data:d,it:f}=l;if(Object.keys(c).length===0)return;const p=u.let("missing");for(const m in c){const w=c[m];if(w.length===0)continue;const v=(0,r.propertyInData)(u,d,m,f.opts.ownProperties);
l.setParams({property:m,depsCount:w.length,deps:w.join(", ")}),f.allErrors?u.if(v,()=>{for(const g of w)(0,r.checkReportMissingProp)(l,g)}):(u.if((0,e._)`${v} && (${(0,r.checkMissingProp)(l,w,p)})`),(0,r.reportMissingProp)(l,p),u.else())}}t.validatePropertyDeps=a;function o(l,c=l.schema){const{gen:u,data:d,keyword:f,it:p}=l,m=u.name("valid");for(const w in c)(0,n.alwaysValidSchema)(p,c[w])||(u.if((0,r.propertyInData)(u,d,w,p.opts.ownProperties),()=>{const v=l.subschema({keyword:f,schemaProp:w},m);
l.mergeValidEvaluated(v,m)},()=>u.var(m,!0)),l.ok(m))}t.validateSchemaDeps=o,t.default=i})(i$)),i$}var Yv={},N1;function Moe(){if(N1)return Yv;N1=1,Object.defineProperty(Yv,"__esModule",{value:!0});const t=et(),e=bt(),r={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:{message:"property name must be valid",params:({params:i})=>(0,t._)`{propertyName: ${i.propertyName}}`},code(i){const{gen:s,schema:a,data:o,it:l}=i;if((0,e.alwaysValidSchema)(l,a))return;const c=s.name("\
valid");s.forIn("key",o,u=>{i.setParams({propertyName:u}),i.subschema({keyword:"propertyNames",data:u,dataTypes:["string"],propertyName:u,compositeRule:!0},c),s.if((0,t.not)(c),()=>{i.error(!0),l.allErrors||s.break()})}),i.ok(c)}};return Yv.default=r,Yv}var Xv={},D1;function O1(){if(D1)return Xv;D1=1,Object.defineProperty(Xv,"__esModule",{value:!0});const t=Ai(),e=et(),n=Vs(),r=bt(),s={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,
error:{message:"must NOT have additional properties",params:({params:a})=>(0,e._)`{additionalProperty: ${a.additionalProperty}}`},code(a){const{gen:o,schema:l,parentSchema:c,data:u,errsCount:d,it:f}=a;if(!d)throw new Error("ajv implementation error");const{allErrors:p,opts:m}=f;if(f.props=!0,m.removeAdditional!=="all"&&(0,r.alwaysValidSchema)(f,l))return;const w=(0,t.allSchemaProperties)(c.properties),v=(0,t.allSchemaProperties)(c.patternProperties);g(),a.ok((0,e._)`${d} === ${n.default.errors}`);
function g(){o.forIn("key",u,T=>{!w.length&&!v.length?b(T):o.if(h(T),()=>b(T))})}function h(T){let N;if(w.length>8){const q=(0,r.schemaRefOrVal)(f,c.properties,"properties");N=(0,t.isOwnProperty)(o,q,T)}else w.length?N=(0,e.or)(...w.map(q=>(0,e._)`${T} === ${q}`)):N=e.nil;return v.length&&(N=(0,e.or)(N,...v.map(q=>(0,e._)`${(0,t.usePattern)(a,q)}.test(${T})`))),(0,e.not)(N)}function y(T){o.code((0,e._)`delete ${u}[${T}]`)}function b(T){if(m.removeAdditional==="all"||m.removeAdditional&&l===!1){y(
T);return}if(l===!1){a.setParams({additionalProperty:T}),a.error(),p||o.break();return}if(typeof l=="object"&&!(0,r.alwaysValidSchema)(f,l)){const N=o.name("valid");m.removeAdditional==="failing"?(R(T,N,!1),o.if((0,e.not)(N),()=>{a.reset(),y(T)})):(R(T,N),p||o.if((0,e.not)(N),()=>o.break()))}}function R(T,N,q){const B={keyword:"additionalProperties",dataProp:T,dataPropType:r.Type.Str};q===!1&&Object.assign(B,{compositeRule:!0,createErrors:!1,allErrors:!1}),a.subschema(B,N)}}};return Xv.default=s,
Xv}var Qv={},L1;function joe(){if(L1)return Qv;L1=1,Object.defineProperty(Qv,"__esModule",{value:!0});const t=Xp(),e=Ai(),n=bt(),r=O1(),i={keyword:"properties",type:"object",schemaType:"object",code(s){const{gen:a,schema:o,parentSchema:l,data:c,it:u}=s;u.opts.removeAdditional==="all"&&l.additionalProperties===void 0&&r.default.code(new t.KeywordCxt(u,r.default,"additionalProperties"));const d=(0,e.allSchemaProperties)(o);for(const v of d)u.definedProperties.add(v);u.opts.unevaluated&&d.length&&u.
props!==!0&&(u.props=n.mergeEvaluated.props(a,(0,n.toHash)(d),u.props));const f=d.filter(v=>!(0,n.alwaysValidSchema)(u,o[v]));if(f.length===0)return;const p=a.name("valid");for(const v of f)m(v)?w(v):(a.if((0,e.propertyInData)(a,c,v,u.opts.ownProperties)),w(v),u.allErrors||a.else().var(p,!0),a.endIf()),s.it.definedProperties.add(v),s.ok(p);function m(v){return u.opts.useDefaults&&!u.compositeRule&&o[v].default!==void 0}function w(v){s.subschema({keyword:"properties",schemaProp:v,dataProp:v},p)}}};
return Qv.default=i,Qv}var ew={},M1;function qoe(){if(M1)return ew;M1=1,Object.defineProperty(ew,"__esModule",{value:!0});const t=Ai(),e=et(),n=bt(),r=bt(),i={keyword:"patternProperties",type:"object",schemaType:"object",code(s){const{gen:a,schema:o,data:l,parentSchema:c,it:u}=s,{opts:d}=u,f=(0,t.allSchemaProperties)(o),p=f.filter(b=>(0,n.alwaysValidSchema)(u,o[b]));if(f.length===0||p.length===f.length&&(!u.opts.unevaluated||u.props===!0))return;const m=d.strictSchema&&!d.allowMatchingProperties&&
c.properties,w=a.name("valid");u.props!==!0&&!(u.props instanceof e.Name)&&(u.props=(0,r.evaluatedPropsToName)(a,u.props));const{props:v}=u;g();function g(){for(const b of f)m&&h(b),u.allErrors?y(b):(a.var(w,!0),y(b),a.if(w))}function h(b){for(const R in m)new RegExp(b).test(R)&&(0,n.checkStrictMode)(u,`property ${R} matches pattern ${b} (use allowMatchingProperties)`)}function y(b){a.forIn("key",l,R=>{a.if((0,e._)`${(0,t.usePattern)(s,b)}.test(${R})`,()=>{const T=p.includes(b);T||s.subschema({keyword:"\
patternProperties",schemaProp:b,dataProp:R,dataPropType:r.Type.Str},w),u.opts.unevaluated&&v!==!0?a.assign((0,e._)`${v}[${R}]`,!0):!T&&!u.allErrors&&a.if((0,e.not)(w),()=>a.break())})})}}};return ew.default=i,ew}var tw={},j1;function Foe(){if(j1)return tw;j1=1,Object.defineProperty(tw,"__esModule",{value:!0});const t=bt(),e={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code(n){const{gen:r,schema:i,it:s}=n;if((0,t.alwaysValidSchema)(s,i)){n.fail();return}const a=r.name("valid");n.
subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},a),n.failResult(a,()=>n.reset(),()=>n.error())},error:{message:"must NOT be valid"}};return tw.default=e,tw}var nw={},q1;function zoe(){if(q1)return nw;q1=1,Object.defineProperty(nw,"__esModule",{value:!0});const e={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:Ai().validateUnion,error:{message:"must match a schema in anyOf"}};return nw.default=e,nw}var rw={},F1;function Uoe(){if(F1)return rw;F1=1,Object.defineProperty(
rw,"__esModule",{value:!0});const t=et(),e=bt(),r={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:{message:"must match exactly one schema in oneOf",params:({params:i})=>(0,t._)`{passingSchemas: ${i.passing}}`},code(i){const{gen:s,schema:a,parentSchema:o,it:l}=i;if(!Array.isArray(a))throw new Error("ajv implementation error");if(l.opts.discriminator&&o.discriminator)return;const c=a,u=s.let("valid",!1),d=s.let("passing",null),f=s.name("_valid");i.setParams({passing:d}),s.block(p),i.result(
u,()=>i.reset(),()=>i.error(!0));function p(){c.forEach((m,w)=>{let v;(0,e.alwaysValidSchema)(l,m)?s.var(f,!0):v=i.subschema({keyword:"oneOf",schemaProp:w,compositeRule:!0},f),w>0&&s.if((0,t._)`${f} && ${u}`).assign(u,!1).assign(d,(0,t._)`[${d}, ${w}]`).else(),s.if(f,()=>{s.assign(u,!0),s.assign(d,w),v&&i.mergeEvaluated(v,t.Name)})})}}};return rw.default=r,rw}var iw={},z1;function Hoe(){if(z1)return iw;z1=1,Object.defineProperty(iw,"__esModule",{value:!0});const t=bt(),e={keyword:"allOf",schemaType:"\
array",code(n){const{gen:r,schema:i,it:s}=n;if(!Array.isArray(i))throw new Error("ajv implementation error");const a=r.name("valid");i.forEach((o,l)=>{if((0,t.alwaysValidSchema)(s,o))return;const c=n.subschema({keyword:"allOf",schemaProp:l},a);n.ok(a),n.mergeEvaluated(c)})}};return iw.default=e,iw}var sw={},U1;function Voe(){if(U1)return sw;U1=1,Object.defineProperty(sw,"__esModule",{value:!0});const t=et(),e=bt(),r={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:{message:({params:s})=>(0,t.
str)`must match "${s.ifClause}" schema`,params:({params:s})=>(0,t._)`{failingKeyword: ${s.ifClause}}`},code(s){const{gen:a,parentSchema:o,it:l}=s;o.then===void 0&&o.else===void 0&&(0,e.checkStrictMode)(l,'"if" without "then" and "else" is ignored');const c=i(l,"then"),u=i(l,"else");if(!c&&!u)return;const d=a.let("valid",!0),f=a.name("_valid");if(p(),s.reset(),c&&u){const w=a.let("ifClause");s.setParams({ifClause:w}),a.if(f,m("then",w),m("else",w))}else c?a.if(f,m("then")):a.if((0,t.not)(f),m("el\
se"));s.pass(d,()=>s.error(!0));function p(){const w=s.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},f);s.mergeEvaluated(w)}function m(w,v){return()=>{const g=s.subschema({keyword:w},f);a.assign(d,f),s.mergeValidEvaluated(g,d),v?a.assign(v,(0,t._)`${w}`):s.setParams({ifClause:w})}}}};function i(s,a){const o=s.schema[a];return o!==void 0&&!(0,e.alwaysValidSchema)(s,o)}return sw.default=r,sw}var aw={},H1;function Boe(){if(H1)return aw;H1=1,Object.defineProperty(aw,"__esMod\
ule",{value:!0});const t=bt(),e={keyword:["then","else"],schemaType:["object","boolean"],code({keyword:n,parentSchema:r,it:i}){r.if===void 0&&(0,t.checkStrictMode)(i,`"${n}" without "if" is ignored`)}};return aw.default=e,aw}var V1;function B1(){if(V1)return Gv;V1=1,Object.defineProperty(Gv,"__esModule",{value:!0});const t=$1(),e=Doe(),n=E1(),r=Ooe(),i=Loe(),s=I1(),a=Moe(),o=O1(),l=joe(),c=qoe(),u=Foe(),d=zoe(),f=Uoe(),p=Hoe(),m=Voe(),w=Boe();function v(g=!1){const h=[u.default,d.default,f.default,
p.default,m.default,w.default,a.default,o.default,s.default,l.default,c.default];return g?h.push(e.default,r.default):h.push(t.default,n.default),h.push(i.default),h}return Gv.default=v,Gv}var ow={},lw={},W1;function Woe(){if(W1)return lw;W1=1,Object.defineProperty(lw,"__esModule",{value:!0});const t=et(),n={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:{message:({schemaCode:r})=>(0,t.str)`must match format "${r}"`,params:({schemaCode:r})=>(0,t._)`{format: ${r}}`},
code(r,i){const{gen:s,data:a,$data:o,schema:l,schemaCode:c,it:u}=r,{opts:d,errSchemaPath:f,schemaEnv:p,self:m}=u;if(!d.validateFormats)return;o?w():v();function w(){const g=s.scopeValue("formats",{ref:m.formats,code:d.code.formats}),h=s.const("fDef",(0,t._)`${g}[${c}]`),y=s.let("fType"),b=s.let("format");s.if((0,t._)`typeof ${h} == "object" && !(${h} instanceof RegExp)`,()=>s.assign(y,(0,t._)`${h}.type || "string"`).assign(b,(0,t._)`${h}.validate`),()=>s.assign(y,(0,t._)`"string"`).assign(b,h)),
r.fail$data((0,t.or)(R(),T()));function R(){return d.strictSchema===!1?t.nil:(0,t._)`${c} && !${b}`}function T(){const N=p.$async?(0,t._)`(${h}.async ? await ${b}(${a}) : ${b}(${a}))`:(0,t._)`${b}(${a})`,q=(0,t._)`(typeof ${b} == "function" ? ${N} : ${b}.test(${a}))`;return(0,t._)`${b} && ${b} !== true && ${y} === ${i} && !${q}`}}function v(){const g=m.formats[l];if(!g){R();return}if(g===!0)return;const[h,y,b]=T(g);h===i&&r.pass(N());function R(){if(d.strictSchema===!1){m.logger.warn(q());return}
throw new Error(q());function q(){return`unknown format "${l}" ignored in schema at path "${f}"`}}function T(q){const B=q instanceof RegExp?(0,t.regexpCode)(q):d.code.formats?(0,t._)`${d.code.formats}${(0,t.getProperty)(l)}`:void 0,ie=s.scopeValue("formats",{key:l,ref:q,code:B});return typeof q=="object"&&!(q instanceof RegExp)?[q.type||"string",q.validate,(0,t._)`${ie}.validate`]:["string",q,ie]}function N(){if(typeof g=="object"&&!(g instanceof RegExp)&&g.async){if(!p.$async)throw new Error("a\
sync format in sync schema");return(0,t._)`await ${b}(${a})`}return typeof y=="function"?(0,t._)`${b}(${a})`:(0,t._)`${b}.test(${a})`}}}};return lw.default=n,lw}var G1;function K1(){if(G1)return ow;G1=1,Object.defineProperty(ow,"__esModule",{value:!0});const e=[Woe().default];return ow.default=e,ow}var il={},Z1;function J1(){return Z1||(Z1=1,Object.defineProperty(il,"__esModule",{value:!0}),il.contentVocabulary=il.metadataVocabulary=void 0,il.metadataVocabulary=["title","description","default","\
deprecated","readOnly","writeOnly","examples"],il.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"]),il}var Y1;function Goe(){if(Y1)return Av;Y1=1,Object.defineProperty(Av,"__esModule",{value:!0});const t=c1(),e=R1(),n=B1(),r=K1(),i=J1(),s=[t.default,e.default,(0,n.default)(),r.default,i.metadataVocabulary,i.contentVocabulary];return Av.default=s,Av}var cw={},th={},X1;function Koe(){if(X1)return th;X1=1,Object.defineProperty(th,"__esModule",{value:!0}),th.DiscrError=void 0;
var t;return(function(e){e.Tag="tag",e.Mapping="mapping"})(t||(th.DiscrError=t={})),th}var Q1;function ej(){if(Q1)return cw;Q1=1,Object.defineProperty(cw,"__esModule",{value:!0});const t=et(),e=Koe(),n=Cv(),r=Qp(),i=bt(),a={keyword:"discriminator",type:"object",schemaType:"object",error:{message:({params:{discrError:o,tagName:l}})=>o===e.DiscrError.Tag?`tag "${l}" must be string`:`value of tag "${l}" must be in oneOf`,params:({params:{discrError:o,tag:l,tagName:c}})=>(0,t._)`{error: ${o}, tag: ${c}, tagValue: ${l}}`},
code(o){const{gen:l,data:c,schema:u,parentSchema:d,it:f}=o,{oneOf:p}=d;if(!f.opts.discriminator)throw new Error("discriminator: requires discriminator option");const m=u.propertyName;if(typeof m!="string")throw new Error("discriminator: requires propertyName");if(u.mapping)throw new Error("discriminator: mapping is not supported");if(!p)throw new Error("discriminator: requires oneOf keyword");const w=l.let("valid",!1),v=l.const("tag",(0,t._)`${c}${(0,t.getProperty)(m)}`);l.if((0,t._)`typeof ${v} == "string"`,
()=>g(),()=>o.error(!1,{discrError:e.DiscrError.Tag,tag:v,tagName:m})),o.ok(w);function g(){const b=y();l.if(!1);for(const R in b)l.elseIf((0,t._)`${v} === ${R}`),l.assign(w,h(b[R]));l.else(),o.error(!1,{discrError:e.DiscrError.Mapping,tag:v,tagName:m}),l.endIf()}function h(b){const R=l.name("valid"),T=o.subschema({keyword:"oneOf",schemaProp:b},R);return o.mergeEvaluated(T,t.Name),R}function y(){var b;const R={},T=q(d);let N=!0;for(let L=0;L<p.length;L++){let E=p[L];if(E?.$ref&&!(0,i.schemaHasRulesButRef)(
E,f.self.RULES)){const z=E.$ref;if(E=n.resolveRef.call(f.self,f.schemaEnv.root,f.baseId,z),E instanceof n.SchemaEnv&&(E=E.schema),E===void 0)throw new r.default(f.opts.uriResolver,f.baseId,z)}const $=(b=E?.properties)===null||b===void 0?void 0:b[m];if(typeof $!="object")throw new Error(`discriminator: oneOf subschemas (or referenced schemas) must have "properties/${m}"`);N=N&&(T||q(E)),B($,L)}if(!N)throw new Error(`discriminator: "${m}" must be required`);return R;function q({required:L}){return Array.
isArray(L)&&L.includes(m)}function B(L,E){if(L.const)ie(L.const,E);else if(L.enum)for(const $ of L.enum)ie($,E);else throw new Error(`discriminator: "properties/${m}" must have "const" or "enum"`)}function ie(L,E){if(typeof L!="string"||L in R)throw new Error(`discriminator: "${m}" values must be unique strings`);R[L]=E}}}};return cw.default=a,cw}const tj="http://json-schema.org/draft-07/schema#",nj="http://json-schema.org/draft-07/schema#",rj="Core schema meta-schema",ij={schemaArray:{type:"arr\
ay",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},sj=["object","boolean"],aj={$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"str\
ing"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},
{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"\
object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"\
string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},Zoe={$schema:tj,$id:nj,title:rj,definitions:ij,type:sj,properties:aj,default:!0},Joe={__proto__:null,$id:nj,$schema:tj,default:Zoe,definitions:ij,properties:aj,title:rj,type:sj},Yoe=Sk(Joe);var oj;function lj(){return oj||(oj=1,(function(t,e){
Object.defineProperty(e,"__esModule",{value:!0}),e.MissingRefError=e.ValidationError=e.CodeGen=e.Name=e.nil=e.stringify=e.str=e._=e.KeywordCxt=e.Ajv=void 0;const n=i1(),r=Goe(),i=ej(),s=Yoe,a=["/properties"],o="http://json-schema.org/draft-07/schema";class l extends n.default{_addVocabularies(){super._addVocabularies(),r.default.forEach(m=>this.addVocabulary(m)),this.opts.discriminator&&this.addKeyword(i.default)}_addDefaultMetaSchema(){if(super._addDefaultMetaSchema(),!this.opts.meta)return;const m=this.
opts.$data?this.$dataMetaSchema(s,a):s;this.addMetaSchema(m,o,!1),this.refs["http://json-schema.org/schema"]=o}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(o)?o:void 0)}}e.Ajv=l,t.exports=e=l,t.exports.Ajv=l,Object.defineProperty(e,"__esModule",{value:!0}),e.default=l;var c=Xp();Object.defineProperty(e,"KeywordCxt",{enumerable:!0,get:function(){return c.KeywordCxt}});var u=et();Object.defineProperty(e,"_",{enumerable:!0,get:function(){return u._}}),Object.defineProperty(
e,"str",{enumerable:!0,get:function(){return u.str}}),Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return u.stringify}}),Object.defineProperty(e,"nil",{enumerable:!0,get:function(){return u.nil}}),Object.defineProperty(e,"Name",{enumerable:!0,get:function(){return u.Name}}),Object.defineProperty(e,"CodeGen",{enumerable:!0,get:function(){return u.CodeGen}});var d=Ev();Object.defineProperty(e,"ValidationError",{enumerable:!0,get:function(){return d.default}});var f=Qp();Object.
defineProperty(e,"MissingRefError",{enumerable:!0,get:function(){return f.default}})})(bv,bv.exports)),bv.exports}var Xoe=lj();const Qoe=oo(Xoe);var uw={exports:{}},s$={},cj;function ele(){return cj||(cj=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.formatNames=t.fastFormats=t.fullFormats=void 0;function e(L,E){return{validate:L,compare:E}}t.fullFormats={date:e(s,a),time:e(l(!0),c),"date-time":e(f(!0),p),"iso-time":e(l(),u),"iso-date-time":e(f(),m),duration:/^P(?!$)((\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+S)?)?|(\d+W)?)$/,
uri:g,"uri-reference":/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,
"uri-template":/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,url:/^(?:https?|ftp):\/\/(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)(?:\.(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)*(?:\.(?:[a-z\u{00a1}-\u{ffff}]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/iu,
email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)$/,ipv6:/^((([0-9a-f]{1,4}:){7}([0-9a-f]{1,4}|:))|(([0-9a-f]{1,4}:){6}(:[0-9a-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){5}(((:[0-9a-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){4}(((:[0-9a-f]{1,4}){1,3})|((:[0-9a-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){3}(((:[0-9a-f]{1,4}){1,4})|((:[0-9a-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){2}(((:[0-9a-f]{1,4}){1,5})|((:[0-9a-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){1}(((:[0-9a-f]{1,4}){1,6})|((:[0-9a-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9a-f]{1,4}){1,7})|((:[0-9a-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))$/i,
regex:ie,uuid:/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,"json-pointer":/^(?:\/(?:[^~/]|~0|~1)*)*$/,"json-pointer-uri-fragment":/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,"relative-json-pointer":/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/,byte:y,int32:{type:"number",validate:T},int64:{type:"number",validate:N},float:{type:"number",validate:q},double:{type:"number",validate:q},password:!0,binary:!0},t.fastFormats={...t.fullFormats,date:e(/^\d\d\d\d-[0-1]\d-[0-3]\d$/,
a),time:e(/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,c),"date-time":e(/^\d\d\d\d-[0-1]\d-[0-3]\dt(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,p),"iso-time":e(/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,u),"iso-date-time":e(/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,m),uri:/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/)?[^\s]*$/i,"uri-reference":/^(?:(?:[a-z][a-z0-9+\-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,
email:/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i},t.formatNames=Object.keys(t.fullFormats);function n(L){return L%4===0&&(L%100!==0||L%400===0)}const r=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,i=[0,31,28,31,30,31,30,31,31,30,31,30,31];function s(L){const E=r.exec(L);if(!E)return!1;const $=+E[1],z=+E[2],j=+E[3];return z>=1&&z<=12&&j>=1&&j<=(z===2&&n($)?29:i[z])}function a(L,E){if(L&&E)return L>E?1:L<E?-1:0}const o=/^(\d\d):(\d\d):(\d\d(?:\.\d+)?)(z|([+-])(\d\d)(?::?(\d\d))?)?$/i;
function l(L){return function($){const z=o.exec($);if(!z)return!1;const j=+z[1],U=+z[2],W=+z[3],le=z[4],ne=z[5]==="-"?-1:1,P=+(z[6]||0),M=+(z[7]||0);if(P>23||M>59||L&&!le)return!1;if(j<=23&&U<=59&&W<60)return!0;const J=U-M*ne,G=j-P*ne-(J<0?1:0);return(G===23||G===-1)&&(J===59||J===-1)&&W<61}}function c(L,E){if(!(L&&E))return;const $=new Date("2020-01-01T"+L).valueOf(),z=new Date("2020-01-01T"+E).valueOf();if($&&z)return $-z}function u(L,E){if(!(L&&E))return;const $=o.exec(L),z=o.exec(E);if($&&z)
return L=$[1]+$[2]+$[3],E=z[1]+z[2]+z[3],L>E?1:L<E?-1:0}const d=/t|\s/i;function f(L){const E=l(L);return function(z){const j=z.split(d);return j.length===2&&s(j[0])&&E(j[1])}}function p(L,E){if(!(L&&E))return;const $=new Date(L).valueOf(),z=new Date(E).valueOf();if($&&z)return $-z}function m(L,E){if(!(L&&E))return;const[$,z]=L.split(d),[j,U]=E.split(d),W=a($,j);if(W!==void 0)return W||c(z,U)}const w=/\/|:/,v=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i;
function g(L){return w.test(L)&&v.test(L)}const h=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/gm;function y(L){return h.lastIndex=0,h.test(L)}const b=-2147483648,R=2**31-1;function T(L){return Number.isInteger(L)&&L<=R&&L>=b}function N(L){return Number.isInteger(L)}function q(){return!0}const B=/[^\\]\\Z/;function ie(L){if(B.test(L))return!1;try{return new RegExp(L),!0}catch{return!1}}})(s$)),s$}var a$={},uj;function tle(){return uj||(uj=1,(function(t){Object.defineProperty(
t,"__esModule",{value:!0}),t.formatLimitDefinition=void 0;const e=lj(),n=et(),r=n.operators,i={formatMaximum:{okStr:"<=",ok:r.LTE,fail:r.GT},formatMinimum:{okStr:">=",ok:r.GTE,fail:r.LT},formatExclusiveMaximum:{okStr:"<",ok:r.LT,fail:r.GTE},formatExclusiveMinimum:{okStr:">",ok:r.GT,fail:r.LTE}},s={message:({keyword:o,schemaCode:l})=>(0,n.str)`should be ${i[o].okStr} ${l}`,params:({keyword:o,schemaCode:l})=>(0,n._)`{comparison: ${i[o].okStr}, limit: ${l}}`};t.formatLimitDefinition={keyword:Object.
keys(i),type:"string",schemaType:"string",$data:!0,error:s,code(o){const{gen:l,data:c,schemaCode:u,keyword:d,it:f}=o,{opts:p,self:m}=f;if(!p.validateFormats)return;const w=new e.KeywordCxt(f,m.RULES.all.format.definition,"format");w.$data?v():g();function v(){const y=l.scopeValue("formats",{ref:m.formats,code:p.code.formats}),b=l.const("fmt",(0,n._)`${y}[${w.schemaCode}]`);o.fail$data((0,n.or)((0,n._)`typeof ${b} != "object"`,(0,n._)`${b} instanceof RegExp`,(0,n._)`typeof ${b}.compare != "function"`,
h(b)))}function g(){const y=w.schema,b=m.formats[y];if(!b||b===!0)return;if(typeof b!="object"||b instanceof RegExp||typeof b.compare!="function")throw new Error(`"${d}": format "${y}" does not define "compare" function`);const R=l.scopeValue("formats",{key:y,ref:b,code:p.code.formats?(0,n._)`${p.code.formats}${(0,n.getProperty)(y)}`:void 0});o.fail$data(h(R))}function h(y){return(0,n._)`${y}.compare(${c}, ${u}) ${i[d].fail} 0`}},dependencies:["format"]};const a=o=>(o.addKeyword(t.formatLimitDefinition),
o);t.default=a})(a$)),a$}var dj;function nle(){return dj||(dj=1,(function(t,e){Object.defineProperty(e,"__esModule",{value:!0});const n=ele(),r=tle(),i=et(),s=new i.Name("fullFormats"),a=new i.Name("fastFormats"),o=(c,u={keywords:!0})=>{if(Array.isArray(u))return l(c,u,n.fullFormats,s),c;const[d,f]=u.mode==="fast"?[n.fastFormats,a]:[n.fullFormats,s],p=u.formats||n.formatNames;return l(c,p,d,f),u.keywords&&(0,r.default)(c),c};o.get=(c,u="full")=>{const f=(u==="fast"?n.fastFormats:n.fullFormats)[c];
if(!f)throw new Error(`Unknown format "${c}"`);return f};function l(c,u,d,f){var p,m;(p=(m=c.opts.code).formats)!==null&&p!==void 0||(m.formats=(0,i._)`require("ajv-formats/dist/formats").${f}`);for(const w of u)c.addFormat(w,d[w])}t.exports=e=o,Object.defineProperty(e,"__esModule",{value:!0}),e.default=o})(uw,uw.exports)),uw.exports}var rle=nle();const fj=oo(rle);function ile(){const t=new Qoe({strict:!1,validateFormats:!0,validateSchema:!1,allErrors:!0});return fj(t),t}class sle{constructor(e){
this._ajv=e??ile()}getValidator(e){const n="$id"in e&&typeof e.$id=="string"?this._ajv.getSchema(e.$id)??this._ajv.compile(e):this._ajv.compile(e);return r=>n(r)?{valid:!0,data:r,errorMessage:void 0}:{valid:!1,data:void 0,errorMessage:this._ajv.errorsText(n.errors)}}}class ale{constructor(e){this._server=e}requestStream(e,n,r){return this._server.requestStream(e,n,r)}async getTask(e,n){return this._server.getTask({taskId:e},n)}async getTaskResult(e,n,r){return this._server.getTaskResult({taskId:e},
n,r)}async listTasks(e,n){return this._server.listTasks(e?{cursor:e}:void 0,n)}async cancelTask(e,n){return this._server.cancelTask({taskId:e},n)}}function ole(t,e,n){if(!t)throw new Error(`${n} does not support task creation (required for ${e})`);switch(e){case"tools/call":if(!t.tools?.call)throw new Error(`${n} does not support task creation for tools/call (required for ${e})`);break}}function lle(t,e,n){if(!t)throw new Error(`${n} does not support task creation (required for ${e})`);switch(e){case"\
sampling/createMessage":if(!t.sampling?.createMessage)throw new Error(`${n} does not support task creation for sampling/createMessage (required for ${e})`);break;case"elicitation/create":if(!t.elicitation?.create)throw new Error(`${n} does not support task creation for elicitation/create (required for ${e})`);break}}class cle extends ooe{constructor(e,n){super(n),this._serverInfo=e,this._loggingLevels=new Map,this.LOG_LEVEL_SEVERITY=new Map(Ly.options.map((r,i)=>[r,i])),this.isMessageIgnored=(r,i)=>{
const s=this._loggingLevels.get(i);return s?this.LOG_LEVEL_SEVERITY.get(r)<this.LOG_LEVEL_SEVERITY.get(s):!1},this._capabilities=n?.capabilities??{},this._instructions=n?.instructions,this._jsonSchemaValidator=n?.jsonSchemaValidator??new sle,this.setRequestHandler($R,r=>this._oninitialize(r)),this.setNotificationHandler(cO,()=>this.oninitialized?.()),this._capabilities.logging&&this.setRequestHandler(mO,async(r,i)=>{const s=i.sessionId||i.requestInfo?.headers["mcp-session-id"]||void 0,{level:a}=r.
params,o=Ly.safeParse(a);return o.success&&this._loggingLevels.set(s,o.data),{}})}get experimental(){return this._experimental||(this._experimental={tasks:new ale(this)}),this._experimental}registerCapabilities(e){if(this.transport)throw new Error("Cannot register capabilities after connecting to transport");this._capabilities=loe(this._capabilities,e)}setRequestHandler(e,n){const i=Zp(e)?.method;if(!i)throw new Error("Schema is missing a method literal");let s;if(ls(i)){const o=i;s=o._zod?.def?.
value??o.value}else{const o=i;s=o._def?.value??o.value}if(typeof s!="string")throw new Error("Schema method literal must be a string");if(s==="tools/call"){const o=async(l,c)=>{const u=Kp(Oy,l);if(!u.success){const m=u.error instanceof Error?u.error.message:String(u.error);throw new Le(Fe.InvalidParams,`Invalid tools/call request: ${m}`)}const{params:d}=u.data,f=await Promise.resolve(n(l,c));if(d.task){const m=Kp(Ny,f);if(!m.success){const w=m.error instanceof Error?m.error.message:String(m.error);
throw new Le(Fe.InvalidParams,`Invalid task creation result: ${w}`)}return m.data}const p=Kp(WR,f);if(!p.success){const m=p.error instanceof Error?p.error.message:String(p.error);throw new Le(Fe.InvalidParams,`Invalid tools/call result: ${m}`)}return p.data};return super.setRequestHandler(e,o)}return super.setRequestHandler(e,n)}assertCapabilityForMethod(e){switch(e){case"sampling/createMessage":if(!this._clientCapabilities?.sampling)throw new Error(`Client does not support sampling (required fo\
r ${e})`);break;case"elicitation/create":if(!this._clientCapabilities?.elicitation)throw new Error(`Client does not support elicitation (required for ${e})`);break;case"roots/list":if(!this._clientCapabilities?.roots)throw new Error(`Client does not support listing roots (required for ${e})`);break}}assertNotificationCapability(e){switch(e){case"notifications/message":if(!this._capabilities.logging)throw new Error(`Server does not support logging (required for ${e})`);break;case"notifications/re\
sources/updated":case"notifications/resources/list_changed":if(!this._capabilities.resources)throw new Error(`Server does not support notifying about resources (required for ${e})`);break;case"notifications/tools/list_changed":if(!this._capabilities.tools)throw new Error(`Server does not support notifying of tool list changes (required for ${e})`);break;case"notifications/prompts/list_changed":if(!this._capabilities.prompts)throw new Error(`Server does not support notifying of prompt list change\
s (required for ${e})`);break;case"notifications/elicitation/complete":if(!this._clientCapabilities?.elicitation?.url)throw new Error(`Client does not support URL elicitation (required for ${e})`);break}}assertRequestHandlerCapability(e){if(this._capabilities)switch(e){case"completion/complete":if(!this._capabilities.completions)throw new Error(`Server does not support completions (required for ${e})`);break;case"logging/setLevel":if(!this._capabilities.logging)throw new Error(`Server does not s\
upport logging (required for ${e})`);break;case"prompts/get":case"prompts/list":if(!this._capabilities.prompts)throw new Error(`Server does not support prompts (required for ${e})`);break;case"resources/list":case"resources/templates/list":case"resources/read":if(!this._capabilities.resources)throw new Error(`Server does not support resources (required for ${e})`);break;case"tools/call":case"tools/list":if(!this._capabilities.tools)throw new Error(`Server does not support tools (required for ${e}\
)`);break;case"tasks/get":case"tasks/list":case"tasks/result":case"tasks/cancel":if(!this._capabilities.tasks)throw new Error(`Server does not support tasks capability (required for ${e})`);break}}assertTaskCapability(e){lle(this._clientCapabilities?.tasks?.requests,e,"Client")}assertTaskHandlerCapability(e){this._capabilities&&ole(this._capabilities.tasks?.requests,e,"Server")}async _oninitialize(e){const n=e.params.protocolVersion;return this._clientCapabilities=e.params.capabilities,this._clientVersion=
e.params.clientInfo,{protocolVersion:vR.includes(n)?n:nO,capabilities:this.getCapabilities(),serverInfo:this._serverInfo,...this._instructions&&{instructions:this._instructions}}}getClientCapabilities(){return this._clientCapabilities}getClientVersion(){return this._clientVersion}getCapabilities(){return this._capabilities}async ping(){return this.request({method:"ping"},RR)}async createMessage(e,n){if((e.tools||e.toolChoice)&&!this._clientCapabilities?.sampling?.tools)throw new Error("Client do\
es not support sampling tools capability.");if(e.messages.length>0){const r=e.messages[e.messages.length-1],i=Array.isArray(r.content)?r.content:[r.content],s=i.some(c=>c.type==="tool_result"),a=e.messages.length>1?e.messages[e.messages.length-2]:void 0,o=a?Array.isArray(a.content)?a.content:[a.content]:[],l=o.some(c=>c.type==="tool_use");if(s){if(i.some(c=>c.type!=="tool_result"))throw new Error("The last message must contain only tool_result content if any is present");if(!l)throw new Error("t\
ool_result blocks are not matching any tool_use from the previous message")}if(l){const c=new Set(o.filter(d=>d.type==="tool_use").map(d=>d.id)),u=new Set(i.filter(d=>d.type==="tool_result").map(d=>d.toolUseId));if(c.size!==u.size||![...c].every(d=>u.has(d)))throw new Error("ids of tool_result blocks and tool_use blocks from previous message do not match")}}return e.tools?this.request({method:"sampling/createMessage",params:e},yO,n):this.request({method:"sampling/createMessage",params:e},gO,n)}async elicitInput(e,n){
switch(e.mode??"form"){case"url":{if(!this._clientCapabilities?.elicitation?.url)throw new Error("Client does not support url elicitation.");const i=e;return this.request({method:"elicitation/create",params:i},GR,n)}case"form":{if(!this._clientCapabilities?.elicitation?.form)throw new Error("Client does not support form elicitation.");const i=e.mode==="form"?e:{...e,mode:"form"},s=await this.request({method:"elicitation/create",params:i},GR,n);if(s.action==="accept"&&s.content&&i.requestedSchema)
try{const o=this._jsonSchemaValidator.getValidator(i.requestedSchema)(s.content);if(!o.valid)throw new Le(Fe.InvalidParams,`Elicitation response content does not match requested schema: ${o.errorMessage}`)}catch(a){throw a instanceof Le?a:new Le(Fe.InternalError,`Error validating elicitation response: ${a instanceof Error?a.message:String(a)}`)}return s}}}createElicitationCompletionNotifier(e,n){if(!this._clientCapabilities?.elicitation?.url)throw new Error("Client does not support URL elicitati\
on (required for notifications/elicitation/complete)");return()=>this.notification({method:"notifications/elicitation/complete",params:{elicitationId:e}},n)}async listRoots(e,n){return this.request({method:"roots/list",params:e},vO,n)}async sendLoggingMessage(e,n){if(this._capabilities.logging&&!this.isMessageIgnored(e.level,n))return this.notification({method:"notifications/message",params:e})}async sendResourceUpdated(e){return this.notification({method:"notifications/resources/updated",params:e})}async sendResourceListChanged(){
return this.notification({method:"notifications/resources/list_changed"})}async sendToolListChanged(){return this.notification({method:"notifications/tools/list_changed"})}async sendPromptListChanged(){return this.notification({method:"notifications/prompts/list_changed"})}}const pj=Symbol.for("mcp.completable");function hj(t){return!!t&&typeof t=="object"&&pj in t}function ule(t){return t[pj]?.complete}var mj;(function(t){t.Completable="McpCompletable"})(mj||(mj={}));const dle=/^[A-Za-z0-9._-]{1,128}$/;
function fle(t){const e=[];if(t.length===0)return{isValid:!1,warnings:["Tool name cannot be empty"]};if(t.length>128)return{isValid:!1,warnings:[`Tool name exceeds maximum length of 128 characters (current: ${t.length})`]};if(t.includes(" ")&&e.push("Tool name contains spaces, which may cause parsing issues"),t.includes(",")&&e.push("Tool name contains commas, which may cause parsing issues"),(t.startsWith("-")||t.endsWith("-"))&&e.push("Tool name starts or ends with a dash, which may cause pars\
ing issues in some contexts"),(t.startsWith(".")||t.endsWith("."))&&e.push("Tool name starts or ends with a dot, which may cause parsing issues in some contexts"),!dle.test(t)){const n=t.split("").filter(r=>!/[A-Za-z0-9._-]/.test(r)).filter((r,i,s)=>s.indexOf(r)===i);return e.push(`Tool name contains invalid characters: ${n.map(r=>`"${r}"`).join(", ")}`,"Allowed characters are: A-Z, a-z, 0-9, underscore (_), dash (-), and dot (.)"),{isValid:!1,warnings:e}}return{isValid:!0,warnings:e}}function ple(t,e){
if(e.length>0){console.warn(`Tool name validation warning for "${t}":`);for(const n of e)console.warn(`  - ${n}`);console.warn("Tool registration will proceed, but this may cause compatibility issues."),console.warn("Consider updating the tool name to conform to the MCP tool naming standard."),console.warn("See SEP: Specify Format for Tool Names (https://github.com/modelcontextprotocol/modelcontextprotocol/issues/986) for more details.")}}function gj(t){const e=fle(t);return ple(t,e.warnings),e.
isValid}class hle{constructor(e){this._mcpServer=e}registerToolTask(e,n,r){const i={taskSupport:"required",...n.execution};if(i.taskSupport==="forbidden")throw new Error(`Cannot register task-based tool '${e}' with taskSupport 'forbidden'. Use registerTool() instead.`);return this._mcpServer._createRegisteredTool(e,n.title,n.description,n.inputSchema,n.outputSchema,n.annotations,i,n._meta,r)}}class mle{constructor(e,n){this._registeredResources={},this._registeredResourceTemplates={},this._registeredTools=
{},this._registeredPrompts={},this._toolHandlersInitialized=!1,this._completionHandlerInitialized=!1,this._resourceHandlersInitialized=!1,this._promptHandlersInitialized=!1,this.server=new cle(e,n)}get experimental(){return this._experimental||(this._experimental={tasks:new hle(this)}),this._experimental}async connect(e){return await this.server.connect(e)}async close(){await this.server.close()}setToolRequestHandlers(){this._toolHandlersInitialized||(this.server.assertCanSetRequestHandler(Da(BR)),
this.server.assertCanSetRequestHandler(Da(Oy)),this.server.registerCapabilities({tools:{listChanged:!0}}),this.server.setRequestHandler(BR,()=>({tools:Object.entries(this._registeredTools).filter(([,e])=>e.enabled).map(([e,n])=>{const r={name:e,title:n.title,description:n.description,inputSchema:(()=>{const i=Jp(n.inputSchema);return i?yM(i,{strictUnions:!0,pipeStrategy:"input"}):gle})(),annotations:n.annotations,execution:n.execution,_meta:n._meta};if(n.outputSchema){const i=Jp(n.outputSchema);
i&&(r.outputSchema=yM(i,{strictUnions:!0,pipeStrategy:"output"}))}return r})})),this.server.setRequestHandler(Oy,async(e,n)=>{try{const r=this._registeredTools[e.params.name];if(!r)throw new Le(Fe.InvalidParams,`Tool ${e.params.name} not found`);if(!r.enabled)throw new Le(Fe.InvalidParams,`Tool ${e.params.name} disabled`);const i=!!e.params.task,s=r.execution?.taskSupport,a="createTask"in r.handler;if((s==="required"||s==="optional")&&!a)throw new Le(Fe.InternalError,`Tool ${e.params.name} has t\
askSupport '${s}' but was not registered with registerToolTask`);if(s==="required"&&!i)throw new Le(Fe.MethodNotFound,`Tool ${e.params.name} requires task augmentation (taskSupport: 'required')`);if(s==="optional"&&!i&&a)return await this.handleAutomaticTaskPolling(r,e,n);const o=await this.validateToolInput(r,e.params.arguments,e.params.name),l=await this.executeToolHandler(r,o,n);return i||await this.validateToolOutput(r,l,e.params.name),l}catch(r){if(r instanceof Le&&r.code===Fe.UrlElicitationRequired)
throw r;return this.createToolError(r instanceof Error?r.message:String(r))}}),this._toolHandlersInitialized=!0)}createToolError(e){return{content:[{type:"text",text:e}],isError:!0}}async validateToolInput(e,n,r){if(!e.inputSchema)return;const s=Jp(e.inputSchema)??e.inputSchema,a=await HS(s,n);if(!a.success){const o="error"in a?a.error:"Unknown error",l=VS(o);throw new Le(Fe.InvalidParams,`Input validation error: Invalid arguments for tool ${r}: ${l}`)}return a.data}async validateToolOutput(e,n,r){
if(!e.outputSchema||!("content"in n)||n.isError)return;if(!n.structuredContent)throw new Le(Fe.InvalidParams,`Output validation error: Tool ${r} has an output schema but no structured content was provided`);const i=Jp(e.outputSchema),s=await HS(i,n.structuredContent);if(!s.success){const a="error"in s?s.error:"Unknown error",o=VS(a);throw new Le(Fe.InvalidParams,`Output validation error: Invalid structured content for tool ${r}: ${o}`)}}async executeToolHandler(e,n,r){const i=e.handler;if("creat\
eTask"in i){if(!r.taskStore)throw new Error("No task store provided.");const a={...r,taskStore:r.taskStore};if(e.inputSchema){const o=i;return await Promise.resolve(o.createTask(n,a))}else{const o=i;return await Promise.resolve(o.createTask(a))}}if(e.inputSchema){const a=i;return await Promise.resolve(a(n,r))}else{const a=i;return await Promise.resolve(a(r))}}async handleAutomaticTaskPolling(e,n,r){if(!r.taskStore)throw new Error("No task store provided for task-capable tool.");const i=await this.
validateToolInput(e,n.params.arguments,n.params.name),s=e.handler,a={...r,taskStore:r.taskStore},o=i?await Promise.resolve(s.createTask(i,a)):await Promise.resolve(s.createTask(a)),l=o.task.taskId;let c=o.task;const u=c.pollInterval??5e3;for(;c.status!=="completed"&&c.status!=="failed"&&c.status!=="cancelled";){await new Promise(f=>setTimeout(f,u));const d=await r.taskStore.getTask(l);if(!d)throw new Le(Fe.InternalError,`Task ${l} not found during polling`);c=d}return await r.taskStore.getTaskResult(
l)}setCompletionRequestHandler(){this._completionHandlerInitialized||(this.server.assertCanSetRequestHandler(Da(KR)),this.server.registerCapabilities({completions:{}}),this.server.setRequestHandler(KR,async e=>{switch(e.params.ref.type){case"ref/prompt":return fte(e),this.handlePromptCompletion(e,e.params.ref);case"ref/resource":return pte(e),this.handleResourceCompletion(e,e.params.ref);default:throw new Le(Fe.InvalidParams,`Invalid completion reference: ${e.params.ref}`)}}),this._completionHandlerInitialized=
!0)}async handlePromptCompletion(e,n){const r=this._registeredPrompts[n.name];if(!r)throw new Le(Fe.InvalidParams,`Prompt ${n.name} not found`);if(!r.enabled)throw new Le(Fe.InvalidParams,`Prompt ${n.name} disabled`);if(!r.argsSchema)return nh;const s=Zp(r.argsSchema)?.[e.params.argument.name];if(!hj(s))return nh;const a=ule(s);if(!a)return nh;const o=await a(e.params.argument.value,e.params.context);return wj(o)}async handleResourceCompletion(e,n){const r=Object.values(this._registeredResourceTemplates).
find(a=>a.resourceTemplate.uriTemplate.toString()===n.uri);if(!r){if(this._registeredResources[n.uri])return nh;throw new Le(Fe.InvalidParams,`Resource template ${e.params.ref.uri} not found`)}const i=r.resourceTemplate.completeCallback(e.params.argument.name);if(!i)return nh;const s=await i(e.params.argument.value,e.params.context);return wj(s)}setResourceRequestHandlers(){this._resourceHandlersInitialized||(this.server.assertCanSetRequestHandler(Da(OR)),this.server.assertCanSetRequestHandler(Da(
LR)),this.server.assertCanSetRequestHandler(Da(jR)),this.server.registerCapabilities({resources:{listChanged:!0}}),this.server.setRequestHandler(OR,async(e,n)=>{const r=Object.entries(this._registeredResources).filter(([s,a])=>a.enabled).map(([s,a])=>({uri:s,name:a.name,...a.metadata})),i=[];for(const s of Object.values(this._registeredResourceTemplates)){if(!s.resourceTemplate.listCallback)continue;const a=await s.resourceTemplate.listCallback(n);for(const o of a.resources)i.push({...s.metadata,
...o})}return{resources:[...r,...i]}}),this.server.setRequestHandler(LR,async()=>({resourceTemplates:Object.entries(this._registeredResourceTemplates).map(([n,r])=>({name:n,uriTemplate:r.resourceTemplate.uriTemplate.toString(),...r.metadata}))})),this.server.setRequestHandler(jR,async(e,n)=>{const r=new URL(e.params.uri),i=this._registeredResources[r.toString()];if(i){if(!i.enabled)throw new Le(Fe.InvalidParams,`Resource ${r} disabled`);return i.readCallback(r,n)}for(const s of Object.values(this.
_registeredResourceTemplates)){const a=s.resourceTemplate.uriTemplate.match(r.toString());if(a)return s.readCallback(r,a,n)}throw new Le(Fe.InvalidParams,`Resource ${r} not found`)}),this._resourceHandlersInitialized=!0)}setPromptRequestHandlers(){this._promptHandlersInitialized||(this.server.assertCanSetRequestHandler(Da(qR)),this.server.assertCanSetRequestHandler(Da(FR)),this.server.registerCapabilities({prompts:{listChanged:!0}}),this.server.setRequestHandler(qR,()=>({prompts:Object.entries(this.
_registeredPrompts).filter(([,e])=>e.enabled).map(([e,n])=>({name:e,title:n.title,description:n.description,arguments:n.argsSchema?vle(n.argsSchema):void 0}))})),this.server.setRequestHandler(FR,async(e,n)=>{const r=this._registeredPrompts[e.params.name];if(!r)throw new Le(Fe.InvalidParams,`Prompt ${e.params.name} not found`);if(!r.enabled)throw new Le(Fe.InvalidParams,`Prompt ${e.params.name} disabled`);if(r.argsSchema){const i=Jp(r.argsSchema),s=await HS(i,e.params.arguments);if(!s.success){const l="\
error"in s?s.error:"Unknown error",c=VS(l);throw new Le(Fe.InvalidParams,`Invalid arguments for prompt ${e.params.name}: ${c}`)}const a=s.data,o=r.callback;return await Promise.resolve(o(a,n))}else{const i=r.callback;return await Promise.resolve(i(n))}}),this._promptHandlersInitialized=!0)}resource(e,n,...r){let i;typeof r[0]=="object"&&(i=r.shift());const s=r[0];if(typeof n=="string"){if(this._registeredResources[n])throw new Error(`Resource ${n} is already registered`);const a=this._createRegisteredResource(
e,void 0,n,i,s);return this.setResourceRequestHandlers(),this.sendResourceListChanged(),a}else{if(this._registeredResourceTemplates[e])throw new Error(`Resource template ${e} is already registered`);const a=this._createRegisteredResourceTemplate(e,void 0,n,i,s);return this.setResourceRequestHandlers(),this.sendResourceListChanged(),a}}registerResource(e,n,r,i){if(typeof n=="string"){if(this._registeredResources[n])throw new Error(`Resource ${n} is already registered`);const s=this._createRegisteredResource(
e,r.title,n,r,i);return this.setResourceRequestHandlers(),this.sendResourceListChanged(),s}else{if(this._registeredResourceTemplates[e])throw new Error(`Resource template ${e} is already registered`);const s=this._createRegisteredResourceTemplate(e,r.title,n,r,i);return this.setResourceRequestHandlers(),this.sendResourceListChanged(),s}}_createRegisteredResource(e,n,r,i,s){const a={name:e,title:n,metadata:i,readCallback:s,enabled:!0,disable:()=>a.update({enabled:!1}),enable:()=>a.update({enabled:!0}),
remove:()=>a.update({uri:null}),update:o=>{typeof o.uri<"u"&&o.uri!==r&&(delete this._registeredResources[r],o.uri&&(this._registeredResources[o.uri]=a)),typeof o.name<"u"&&(a.name=o.name),typeof o.title<"u"&&(a.title=o.title),typeof o.metadata<"u"&&(a.metadata=o.metadata),typeof o.callback<"u"&&(a.readCallback=o.callback),typeof o.enabled<"u"&&(a.enabled=o.enabled),this.sendResourceListChanged()}};return this._registeredResources[r]=a,a}_createRegisteredResourceTemplate(e,n,r,i,s){const a={resourceTemplate:r,
title:n,metadata:i,readCallback:s,enabled:!0,disable:()=>a.update({enabled:!1}),enable:()=>a.update({enabled:!0}),remove:()=>a.update({name:null}),update:c=>{typeof c.name<"u"&&c.name!==e&&(delete this._registeredResourceTemplates[e],c.name&&(this._registeredResourceTemplates[c.name]=a)),typeof c.title<"u"&&(a.title=c.title),typeof c.template<"u"&&(a.resourceTemplate=c.template),typeof c.metadata<"u"&&(a.metadata=c.metadata),typeof c.callback<"u"&&(a.readCallback=c.callback),typeof c.enabled<"u"&&
(a.enabled=c.enabled),this.sendResourceListChanged()}};this._registeredResourceTemplates[e]=a;const o=r.uriTemplate.variableNames;return Array.isArray(o)&&o.some(c=>!!r.completeCallback(c))&&this.setCompletionRequestHandler(),a}_createRegisteredPrompt(e,n,r,i,s){const a={title:n,description:r,argsSchema:i===void 0?void 0:Ic(i),callback:s,enabled:!0,disable:()=>a.update({enabled:!1}),enable:()=>a.update({enabled:!0}),remove:()=>a.update({name:null}),update:o=>{typeof o.name<"u"&&o.name!==e&&(delete this.
_registeredPrompts[e],o.name&&(this._registeredPrompts[o.name]=a)),typeof o.title<"u"&&(a.title=o.title),typeof o.description<"u"&&(a.description=o.description),typeof o.argsSchema<"u"&&(a.argsSchema=Ic(o.argsSchema)),typeof o.callback<"u"&&(a.callback=o.callback),typeof o.enabled<"u"&&(a.enabled=o.enabled),this.sendPromptListChanged()}};return this._registeredPrompts[e]=a,i&&Object.values(i).some(l=>{const c=l instanceof os?l._def?.innerType:l;return hj(c)})&&this.setCompletionRequestHandler(),
a}_createRegisteredTool(e,n,r,i,s,a,o,l,c){gj(e);const u={title:n,description:r,inputSchema:vj(i),outputSchema:vj(s),annotations:a,execution:o,_meta:l,handler:c,enabled:!0,disable:()=>u.update({enabled:!1}),enable:()=>u.update({enabled:!0}),remove:()=>u.update({name:null}),update:d=>{typeof d.name<"u"&&d.name!==e&&(typeof d.name=="string"&&gj(d.name),delete this._registeredTools[e],d.name&&(this._registeredTools[d.name]=u)),typeof d.title<"u"&&(u.title=d.title),typeof d.description<"u"&&(u.description=
d.description),typeof d.paramsSchema<"u"&&(u.inputSchema=Ic(d.paramsSchema)),typeof d.outputSchema<"u"&&(u.outputSchema=Ic(d.outputSchema)),typeof d.callback<"u"&&(u.handler=d.callback),typeof d.annotations<"u"&&(u.annotations=d.annotations),typeof d._meta<"u"&&(u._meta=d._meta),typeof d.enabled<"u"&&(u.enabled=d.enabled),this.sendToolListChanged()}};return this._registeredTools[e]=u,this.setToolRequestHandlers(),this.sendToolListChanged(),u}tool(e,...n){if(this._registeredTools[e])throw new Error(
`Tool ${e} is already registered`);let r,i,s,a;if(typeof n[0]=="string"&&(r=n.shift()),n.length>1){const l=n[0];o$(l)?(i=n.shift(),n.length>1&&typeof n[0]=="object"&&n[0]!==null&&!o$(n[0])&&(a=n.shift())):typeof l=="object"&&l!==null&&(a=n.shift())}const o=n[0];return this._createRegisteredTool(e,void 0,r,i,s,a,{taskSupport:"forbidden"},void 0,o)}registerTool(e,n,r){if(this._registeredTools[e])throw new Error(`Tool ${e} is already registered`);const{title:i,description:s,inputSchema:a,outputSchema:o,
annotations:l,_meta:c}=n;return this._createRegisteredTool(e,i,s,a,o,l,{taskSupport:"forbidden"},c,r)}prompt(e,...n){if(this._registeredPrompts[e])throw new Error(`Prompt ${e} is already registered`);let r;typeof n[0]=="string"&&(r=n.shift());let i;n.length>1&&(i=n.shift());const s=n[0],a=this._createRegisteredPrompt(e,void 0,r,i,s);return this.setPromptRequestHandlers(),this.sendPromptListChanged(),a}registerPrompt(e,n,r){if(this._registeredPrompts[e])throw new Error(`Prompt ${e} is already reg\
istered`);const{title:i,description:s,argsSchema:a}=n,o=this._createRegisteredPrompt(e,i,s,a,r);return this.setPromptRequestHandlers(),this.sendPromptListChanged(),o}isConnected(){return this.server.transport!==void 0}async sendLoggingMessage(e,n){return this.server.sendLoggingMessage(e,n)}sendResourceListChanged(){this.isConnected()&&this.server.sendResourceListChanged()}sendToolListChanged(){this.isConnected()&&this.server.sendToolListChanged()}sendPromptListChanged(){this.isConnected()&&this.
server.sendPromptListChanged()}}const gle={type:"object",properties:{}};function yj(t){return t!==null&&typeof t=="object"&&"parse"in t&&typeof t.parse=="function"&&"safeParse"in t&&typeof t.safeParse=="function"}function yle(t){return"_def"in t||"_zod"in t||yj(t)}function o$(t){return typeof t!="object"||t===null||yle(t)?!1:Object.keys(t).length===0?!0:Object.values(t).some(yj)}function vj(t){if(t)return o$(t)?Ic(t):t}function vle(t){const e=Zp(t);return e?Object.entries(e).map(([n,r])=>{const i=wae(
r),s=bae(r);return{name:n,description:i,required:!s}}):[]}function Da(t){const n=Zp(t)?.method;if(!n)throw new Error("Schema is missing a method literal");const r=oM(n);if(typeof r=="string")return r;throw new Error("Schema method literal must be a string")}function wj(t){return{completion:{values:t.slice(0,100),total:t.length,hasMore:t.length>100}}}const nh={completion:{values:[],hasMore:!1}},wle="1.47.0",ble={version:wle},rh=Pt({path:Q().describe("Path to the file"),range:Pt({start:Pt({line:Wp(),
character:Wp()}),end:Pt({line:Wp(),character:Wp()})}).describe("Range in the file")}).nullable(),Oc=Q().refine(t=>!0).optional().default(Zo.DefaultProjectId).describe('Project id (optional, will use "default" if not specified)'),ih=Ze(Pt({id:Q().describe("View id"),title:Q().describe("View title"),type:Gp(["element","deployment","dynamic"]).describe("View type")})),sh=t=>[...t].map(e=>({id:e.id,title:e.titleOrId,type:e.$view._type})),ah=(t,e)=>n=>{try{const r=t.locate({projectId:e,...n});return r?
{path:ot.parse(r.uri).fsPath,range:r.range}:null}catch(r){return nn.debug("Failed to locate {params}",{error:r,params:n}),null}},bj=Pt({id:Q(),title:Q(),kind:Q()}),kle=Pt({type:Gp(["direct","indirect"]).describe('Type of relationship, "direct" for direct relationships, "indirect" for relationships through nested elements'),source:bj,target:bj,kind:Q().nullable().describe("Relationship kind"),title:Q().nullable().describe("Relationship title"),description:Q().nullable().describe("Relationship des\
cription"),technology:Q().nullable().describe("Relationship technology"),tags:Ze(Q()).describe("Relationship tags"),includedInViews:ih.describe("Views that include this relationship"),sourceLocation:rh}),_le=ka({name:"find-relationships",annotations:{readOnlyHint:!0,idempotentHint:!0,title:"Find relationships between two elements"},description:`
Find relationships between two LikeC4 elements within a project.

What it does:
- Finds both direct relationships (element1 \u2194 element2) and indirect ones that arise via containment (e.g. via nested elements).
- Returns rich metadata for each relationship and where it appears in views.

Inputs:
- element1: string \u2014 Element ID (FQN)
- element2: string \u2014 Element ID (FQN)
- project: string (optional, defaults to "default") \u2014 Project id

Output:
- found: Relationship[]

Relationship (object) fields:
- type: "direct" | "indirect" \u2014 direct is between the specified endpoints; indirect is via nested elements
- source: Endpoint
- target: Endpoint
- kind: string|null \u2014 relationship kind from the model
- title: string|null \u2014 relationship title if provided
- description: string|null \u2014 relationship description text
- technology: string|null \u2014 relationship technology
- tags: string[] \u2014 relationship tags
- includedInViews: View[] \u2014 views where this relationship appears
- sourceLocation: { path: string, range: { start: { line: number, character: number }, end: { line: number, character: number } } } | null

Endpoint (object) fields:
- id: string \u2014 Element ID (FQN)
- title: string \u2014 element title
- kind: string \u2014 element kind

View (object) fields:
- id: string \u2014 view identifier
- title: string \u2014 view title
- type: "element" | "deployment" | "dynamic"

Notes:
- Read-only, idempotent; does not mutate the model. May trigger UI navigation in supporting clients.
- The order of results is not guaranteed.

Example:
Request:
{
  "element1": "shop.frontend",
  "element2": "shop.backend",
  "project": "default"
}

Response:
{
  "found": [
    {
      "type": "direct",
      "source": { "id": "shop.frontend", "title": "Frontend", "kind": "component" },
      "target": { "id": "shop.backend", "title": "Backend", "kind": "component" },
      "kind": "sync",
      "title": "Calls",
      "description": "Frontend calls Backend",
      "technology": "HTTP",
      "tags": ["public"],
      "includedInViews": [
        { "id": "system-overview", "title": "System Overview", "type": "element" }
      ],
      "sourceLocation": {
        "path": "/abs/path/project/model.c4",
        "range": { "start": { "line": 12, "character": 0 }, "end": { "line": 14, "character": 0 } }
      }
    }
  ]
}
`,inputSchema:{element1:Q().describe("Element ID (FQN)"),element2:Q().describe("Element ID (FQN)"),project:Oc},outputSchema:{found:Ze(kle)}},async(t,e)=>{const n=t.projectsManager.ensureProjectId(e.project);if(lF(e.element1,e.element2))throw new Error("No relationships possible between parent-child");const r=[],i=await t.computedModel(n),s=i.findElement(e.element1);An(s,`Element "${e.element1}" not found in project "${n}"`);const a=i.findElement(e.element2);An(a,`Element "${e.element2}" not foun\
d in project "${n}"`);const o=ah(t,n),l=PF.findConnection(s,a,"both").flatMap(c=>[...c.relations]);for(const c of l){const u=c.source===s&&c.target===a||c.source===a&&c.target===s;r.push({type:u?"direct":"indirect",source:{id:c.source.id,title:c.source.title,kind:c.source.kind},target:{id:c.target.id,title:c.target.title,kind:c.target.kind},kind:c.kind,title:c.title,description:c.description.text,technology:c.technology,tags:[...c.tags],includedInViews:sh(c.views()),sourceLocation:o({relation:c.
id})})}return{found:r}}),Rle=ka({name:"list-projects",description:`
List LikeC4 projects discoverable in the current workspace.

Request:
- No input parameters.

Response (JSON object):
- projects: Project[]

Project (object) fields:
- id: string \u2014 stable project identifier
- title: string \u2014 human-readable project title
- folder: string \u2014 absolute path to the project root
- sources: string[] \u2014 absolute file paths of related documents

Notes:
- Read-only, idempotent, no side effects.
- Safe to call repeatedly.

Example response:
{
  "projects": [
    {
      "id": "docs",
      "title": "Documentation",
      "folder": "/abs/path/to/workspace/docs",
      "sources": [
        "/abs/path/to/workspace/docs/model/contexts.likec4",
        "/abs/path/to/workspace/docs/model/relations.likec4"
      ]
    }
  ]
}
`,annotations:{readOnlyHint:!0,idempotentHint:!0,title:"List projects"},outputSchema:{projects:Ze(Pt({id:Q(),title:Q(),folder:Q(),sources:Ze(Q())}))}},async t=>({projects:t.projects().map(e=>({id:e.id,title:e.title,folder:e.folder.fsPath,sources:e.documents.map(n=>n.fsPath)}))})),Sle=ka({name:"open-view",description:`
Open a LikeC4 view in the editor's preview panel.

Request:
- viewId: string \u2014 view id (name)
- project: string (optional) \u2014 project id. Defaults to "default" if omitted.

Response (JSON object):
- location: { path: string, range: { start: { line: number, character: number }, end: { line: number, character: number } } } | null \u2014 source location of the view if available

Notes:
- Read-only and idempotent with respect to the project model. Triggers a UI action in the editor.
- Only one preview panel can be open at a time.

Example response:
{
  "location": {
    "path": "/abs/path/project/model.c4",
    "range": { "start": { "line": 10, "character": 0 }, "end": { "line": 30, "character": 0 } }
  }
}
`,annotations:{readOnlyHint:!0,idempotentHint:!0,title:"Open view in preview panel"},inputSchema:{viewId:Q().describe("View id (name)"),project:Oc},outputSchema:{location:rh}},async(t,e)=>{const n=t.projectsManager.ensureProjectId(e.project),r=(await t.computedModel(n)).findView(e.viewId);if(!r)throw new Error(`View with ID '${e.viewId}' not found in project ${n}`);return await t.views.openView(r.id,n),{location:ah(t,n)({view:r.id})}}),$le=ka({name:"read-deployment",description:`
Read details about a deployment node or a deployed instance in a LikeC4 project.

What it does:
- Returns metadata about a deployment entity (node or instance), including kind, tags, color/shape, children, which views include it, and its source location.

Inputs:
- id: string \u2014 Deployment id (FQN)
- project: string (optional, defaults to "default") \u2014 Project id

Output fields:
- type: "deployment-node" | "deployed-instance"
- id: string \u2014 Deployment id (FQN)
- kind: string \u2014 Deployment node kind, or element kind for deployed instances
- name: string \u2014 Name of the deployment entity
- title: string \u2014 Title of the deployment entity
- description: string|null \u2014 Description text
- technology: string|null \u2014 Technology info, if any
- tags: string[] \u2014 Tags assigned to this entity
- project: string \u2014 Project id
- metadata: Record<string, string>
- links: Array<{ title: string|null, url: string, relative: string|null }> \u2014 external links associated with this deployment entity
- shape: string \u2014 Rendered shape
- color: string \u2014 Rendered color
- children: string[] \u2014 Child deployment ids (empty for instances)
- includedInViews: View[] \u2014 Views that include this entity
- instanceof: { id: string, title: string, kind: string } | null \u2014 If type is "deployed-instance", the referenced element
- sourceLocation: { path: string, range: { start: { line: number, character: number }, end: { line: number, character: number } } } | null

View (object) fields:
- id: string \u2014 view identifier
- title: string \u2014 view title
- type: "element" | "deployment" | "dynamic"

Notes:
- Read-only, idempotent; does not mutate the model.

Example request:
{ "id": "k8s.cluster.frontend", "project": "default" }

Example response (deployed instance):
{
  "type": "deployed-instance",
  "id": "k8s.cluster.frontend",
  "kind": "k8s.pod",
  "name": "frontend",
  "title": "Frontend Pod",
  "description": null,
  "technology": "Kubernetes",
  "tags": ["prod"],
  "project": "default",
  "metadata": {},
  "links": [],
  "shape": "rectangle",
  "color": "#2F80ED",
  "children": [],
  "includedInViews": [
    { "id": "runtime-overview", "title": "Runtime Overview", "type": "deployment" }
  ],
  "instanceof": { "id": "shop.frontend", "title": "Frontend", "kind": "component" },
  "sourceLocation": {
    "path": "/abs/path/project/model.c4",
    "range": { "start": { "line": 10, "character": 0 }, "end": { "line": 25, "character": 0 } }
  }
}
`,annotations:{readOnlyHint:!0,idempotentHint:!0,title:"Read deployment entity"},inputSchema:{id:Q().describe("Deployment id (FQN)"),project:Oc},outputSchema:{type:Gp(["deployment-node","deployed-instance"]),id:Q().describe("Deployment id (FQN)"),kind:Q().describe("Deployment node kind, or element kind for deployed instances"),name:Q(),title:Q(),description:Q().nullable(),technology:Q().nullable(),tags:Ze(Q()),project:Q(),metadata:vv(yv([Q(),Ze(Q())])),links:Ze(Pt({title:Q().nullable().describe(
"Optional link title"),url:Q().describe("Link URL"),relative:Q().nullable().describe("Relative path (if URL is relative to workspace root)")})).describe("External links associated with this deployment entity"),shape:Q(),color:Q(),children:Ze(Q()).describe("Children of this deployment node (Array of Deployment ids)"),includedInViews:ih.describe("Views that include this deployment node"),instanceof:Pt({id:Q().describe("Element ID (FQN)"),title:Q(),kind:Q()}).nullable().describe('If type is "deploy\
ed-instance", the referenced element'),sourceLocation:rh}},async(t,e)=>{const n=t.projectsManager.ensureProjectId(e.project),r=(await t.computedModel(n)).deployment.findElement(e.id);Ke(r,`Deployment entity "${e.id}" not found in project "${n}"`);const i=ah(t,n);return{type:r.isInstance()?"deployed-instance":"deployment-node",id:r.id,name:r.name,kind:r.kind,title:r.title,description:r.description.text,technology:r.technology,tags:[...r.tags],project:n,metadata:r.getMetadata(),links:(r.links??[]).
map(s=>({title:s.title??null,url:s.url,relative:s.relative??null})),shape:r.shape,color:r.color,children:r.isInstance()?[]:[...r.children()].map(s=>s.id),includedInViews:sh(r.views()),instanceof:r.isInstance()?{id:r.element.id,title:r.element.title,kind:r.element.kind}:null,sourceLocation:i({deployment:r.id})}}),Tle=ka({name:"read-element",description:`
Read detailed information about a LikeC4 element.

Request:
- id: string \u2014 element id (FQN)
- project: string (optional) \u2014 project id. Defaults to "default" if omitted.

Response (JSON object):
- id: string \u2014 element id (FQN)
- name: string \u2014 element name
- kind: string \u2014 element kind
- title: string \u2014 human-readable title
- description: string|null \u2014 optional description
- technology: string|null \u2014 optional technology
- tags: string[] \u2014 assigned tags
- project: string \u2014 project id this element belongs to
- metadata: Record<string, string> \u2014 element metadata
- links: Array<{ title: string|null, url: string, relative: string|null }> \u2014 external links associated with this element
- shape: string \u2014 rendered shape
- color: string \u2014 rendered color
- children: string[] \u2014 ids (FQNs) of direct child elements
- defaultView: string|null \u2014 default view name if set
- includedInViews: View[] \u2014 views that include this element
- relationships: object \u2014 relationships of this element (direct and indirect)
  - incoming: Array<{ source: { id: string, title: string, kind: string }, kind: string|null, target: string, title: string|null, description: string|null, technology: string|null, tags: string[] }>
  - outgoing: Array<{ source: string, target: { id: string, title: string, kind: string }, kind: string|null, title: string|null, description: string|null, technology: string|null, tags: string[] }>
- deployedInstances: string[] \u2014 deployed instance ids (Deployment FQNs)
- sourceLocation: { path: string, range: { start: { line: number, character: number }, end: { line: number, character: number } } } | null \u2014 source location if available

View (object) fields:
- id: string \u2014 view identifier
- title: string \u2014 view title
- type: "element" | "deployment" | "dynamic"

Notes:
- Read-only, idempotent, no side effects.
- Safe to call repeatedly.

Example response:
{
  "id": "shop.frontend",
  "name": "frontend",
  "kind": "container",
  "title": "Frontend",
  "description": "User-facing web app",
  "technology": "React",
  "tags": ["public"],
  "project": "default",
  "metadata": { "owner": "web" },
  "links": [
    {
      "title": "Documentation",
      "url": "https://docs.example.com/frontend",
      "relative": null
    }
  ],
  "shape": "rounded-rectangle",
  "color": "#2F80ED",
  "children": ["shop.frontend.auth"],
  "defaultView": "frontend-overview",
  "includedInViews": [
    {
      "id": "frontend-overview",
      "title": "Frontend Overview",
      "type": "element"
    }
  ],
  "relationships": {
    "incoming": [
      {
        "source": { "id": "shop.api", "title": "API", "kind": "container" },
        "kind": "uses",
        "target": "shop.frontend",
        "title": "Calls",
        "description": null,
        "technology": "HTTPS",
        "tags": []
      }
    ],
    "outgoing": []
  },
  "deployedInstances": ["k8s.cluster.frontend"],
  "sourceLocation": {
    "path": "/abs/path/project/model.c4",
    "range": { "start": { "line": 10, "character": 0 }, "end": { "line": 25, "character": 0 } }
  }
}
`,annotations:{readOnlyHint:!0,idempotentHint:!0,title:"Read element"},inputSchema:{id:Q().describe("Element id (FQN)"),project:Oc},outputSchema:{id:Q().describe("Element id (FQN)"),kind:Q().describe("Element kind"),name:Q().describe("Element name"),title:Q(),description:Q().nullable(),technology:Q().nullable(),tags:Ze(Q()),project:Q(),metadata:vv(yv([Q(),Ze(Q())])),links:Ze(Pt({title:Q().nullable().describe("Optional link title"),url:Q().describe("Link URL"),relative:Q().nullable().describe("Re\
lative path (if URL is relative to workspace root)")})).describe("External links associated with this element"),shape:Q(),color:Q(),children:Ze(Q()).describe("Children of this element (Array of FQNs)"),defaultView:Q().nullable().describe("Name of the default view of this element"),includedInViews:ih.describe("Views that include this element"),relationships:Pt({incoming:Ze(Pt({source:Pt({id:Q(),title:Q(),kind:Q()}).describe("Source element of this relationship"),kind:Q().nullable().describe("Rela\
tionship kind"),target:Q().describe("Target element id (FQN), either this element or nested element, if relationship is indirect"),title:Q().nullable().describe("Relationship title"),description:Q().nullable().describe("Relationship description"),technology:Q().nullable().describe("Relationship technology"),tags:Ze(Q()).describe("Relationship tags")})).describe("Incoming relationships of this element (direct and indirect, incoming to nested elements)"),outgoing:Ze(Pt({source:Q().describe("Source\
 element id (FQN), either this element or nested element, if relationship is indirect"),target:Pt({id:Q(),title:Q(),kind:Q()}).describe("Target element of this relationship"),kind:Q().nullable().describe("Relationship kind"),title:Q().nullable().describe("Relationship title"),description:Q().nullable().describe("Relationship description"),technology:Q().nullable().describe("Relationship technology"),tags:Ze(Q()).describe("Relationship tags")})).describe("Outgoing relationships of this element (d\
irect and indirect, outgoing from nested elements)")}).describe("Relationships of this element"),deployedInstances:Ze(Q()).describe("Deployed instances of this element (Array of Deployment FQNs)"),sourceLocation:rh}},async(t,e)=>{const n=t.projectsManager.ensureProjectId(e.project),r=(await t.computedModel(n)).findElement(e.id);Ke(r,`Element "${e.id}" not found in project "${n}"`);const i=ah(t,n);return{id:r.id,name:r.name,kind:r.kind,title:r.title,description:r.description.text,technology:r.technology,
tags:[...r.tags],project:n,metadata:r.getMetadata(),links:(r.links??[]).map(s=>({title:s.title??null,url:s.url,relative:s.relative??null})),shape:r.shape,color:r.color,children:[...r.children()].map(s=>s.id),defaultView:r.defaultView?.id||null,includedInViews:sh(r.views()),relationships:{incoming:[...r.incoming()].map(s=>({source:{id:s.source.id,title:s.source.title,kind:s.source.kind},kind:s.kind,target:s.target.id,title:s.title,description:s.description.text,technology:s.technology,tags:[...s.
tags]})),outgoing:[...r.outgoing()].map(s=>({source:s.source.id,target:{id:s.target.id,title:s.target.title,kind:s.target.kind},kind:s.kind,title:s.title,description:s.description.text,technology:s.technology,tags:[...s.tags]}))},deployedInstances:[...r.deployments()].map(s=>s.id),sourceLocation:i({element:r.id})}}),Ele=ka({name:"read-project-summary",annotations:{readOnlyHint:!0,idempotentHint:!0,title:"Read project summary"},description:`
Request:
- project: string (optional) \u2014 project id. Defaults to "default" if omitted.

Response (JSON object):
- title: string \u2014 human-readable project title
- folder: string \u2014 absolute path to the project root
- sources: string[] \u2014 absolute file paths of model documents
- specification: object
  - elementKinds: string[] \u2014 all element kinds
  - relationshipKinds: string[] \u2014 all relationship kinds
  - deploymentKinds: string[] \u2014 all deployment kinds
  - tags: string[] \u2014 all tags
  - metadataKeys: string[] \u2014 used metadata keys
- elements: Element[] \u2014 list of elements
- deployments: Deployment[] \u2014 list of deployment entities
- views: View[] \u2014 list of views defined in the model

Element (object) fields:
- id: string \u2014 element id (FQN)
- kind: string \u2014 element kind
- title: string \u2014 element title
- tags: string[] \u2014 element tags

Deployment (object) fields:
- type = "deployment-node": { id: string, kind: string, title: string, tags: string[] }
- type = "deployed-instance": { id: string, title: string, tags: string[], referencedElementId: string }

View (object) fields:
- id: string \u2014 view identifier
- title: string \u2014 view title
- type: "element" | "deployment" | "dynamic"

Notes:
- Read-only, idempotent, no side effects.
- Safe to call repeatedly.

Example response:
{
  "title": "Cloud Boutique",
  "folder": "/abs/path/to/workspace/examples/cloud-system",
  "sources": [
    "/abs/path/to/workspace/examples/cloud-system/model.c4"
  ],
  "specification": {
    "elementKinds": ["system", "container", "component"],
    "relationshipKinds": ["uses", "depends-on"],
    "deploymentKinds": ["node", "cluster"],
    "tags": ["public", "internal"],
    "metadataKeys": ["owner", "tier"]
  },
  "elements": [
    {
      "id": "shop.frontend",
      "kind": "component",
      "title": "Frontend",
      "tags": ["public"]
    }
  ],
  "deployments": [
    {
      "type": "deployment-node",
      "id": "k8s.shop.frontend",
      "kind": "cluster",
      "title": "Frontend",
      "tags": []
    }
  ],
  "views": [
    {
      "name": "system-overview",
      "title": "System Overview",
      "type": "element"
    }
  ]
}
  `,inputSchema:{project:Oc},outputSchema:{title:Q(),folder:Q(),sources:Ze(Q()),specification:Pt({elementKinds:Ze(Q()),relationshipKinds:Ze(Q()),deploymentKinds:Ze(Q()),tags:Ze(Q()),metadataKeys:Ze(Q())}),elements:Ze(Pt({id:Q(),kind:Q(),title:Q(),tags:Ze(Q())})).describe("List of elements in the project"),deployments:Ze(US("type",[Pt({type:el("deployment-node"),id:Q().describe("Node ID"),kind:Q().describe("Deployment node kind"),title:Q().describe("Node title"),tags:Ze(Q())}),Pt({type:el("deploy\
ed-instance"),id:Q().describe("Node ID"),title:Q().describe("Node title"),tags:Ze(Q()),referencedElementId:Q().describe("Element ID (FQN)")})])).describe("List of deployment nodes and deployed instances in the project"),views:Ze(Pt({id:Q(),title:Q(),type:Gp(["element","deployment","dynamic"])}))}},async(t,e)=>{const n=t.projectsManager.ensureProjectId(e.project),r=t.project(n),i=await t.computedModel(n);return{title:r.title,folder:r.folder.fsPath,specification:{elementKinds:Lr(i.specification.elements),
relationshipKinds:Lr(i.specification.relationships),deploymentKinds:Lr(i.specification.deployments),tags:[...i.tags],metadataKeys:i.specification.metadataKeys??[]},elements:[...i.elements()].filter(s=>!s.imported).map(s=>({id:s.id,kind:s.kind,title:s.title,tags:[...s.tags]})),deployments:[...i.deployment.elements()].map(s=>s.isInstance()?{type:"deployed-instance",id:s.id,title:s.title,tags:[...s.tags],referencedElementId:s.element.id}:{type:"deployment-node",id:s.id,kind:s.kind,title:s.title,tags:[
...s.tags]}),views:[...i.views()].map(s=>({id:s.id,title:s.titleOrId,type:s.$view._type})),sources:r.documents?.map(s=>s.fsPath)??[]}}),Ple=t=>t.hasElement()?t.element.id:t.hasDeployment()?t.deployment.id:null,Cle=US("type",[Pt({type:el("element"),id:Q().describe("Node ID"),elementId:Q().describe("Element ID (FQN)"),kind:Q().describe("Element kind"),title:Q().describe("Node title"),description:Q().nullable(),technology:Q().nullable(),children:Ze(Q()).describe("Children nodes, array of node IDs"),
shape:Q().describe("Rendered shape"),color:Q().describe("Rendered color"),tags:Ze(Q())}),Pt({type:el("deployment-node"),id:Q().describe("Node ID"),deploymentId:Q().describe("Deployment entity ID (FQN)"),kind:Q().describe("Deployment kind"),title:Q().describe("Node title"),description:Q().nullable(),technology:Q().nullable(),children:Ze(Q()).describe("Children nodes, array of node IDs"),shape:Q().describe("Rendered shape"),color:Q().describe("Rendered color"),tags:Ze(Q())}),Pt({type:el("deployed-\
instance"),id:Q().describe("Node ID"),deploymentId:Q().describe("Deployment entity ID (FQN)"),title:Q().describe("Node title"),description:Q().nullable(),technology:Q().nullable(),referencedElement:Pt({id:Q().describe("Element ID (FQN)"),kind:Q().describe("Element kind"),title:Q().describe("Element title")}),shape:Q().describe("Rendered shape"),color:Q().describe("Rendered color"),tags:Ze(Q())})]),xle=ka({name:"read-view",description:`
Read detailed information about a LikeC4 view.

Request:
- viewId: string \u2014 view id (name)
- project: string (optional) \u2014 project id. Defaults to "default" if omitted.

Response (JSON object):
- id: string \u2014 view id
- type: "element" | "deployment" | "dynamic" \u2014 view type
- title: string \u2014 view title (falls back to id if not set)
- description: string|null \u2014 optional description
- tags: string[] \u2014 view tags
- project: string \u2014 project id this view belongs to
- nodes: Node[] \u2014 nodes included in the view
- edges: Edge[] \u2014 relationships between nodes
- sourceLocation: { path: string, range: { start: { line: number, character: number }, end: { line: number, character: number } } } | null \u2014 source location if available

Node (discriminated union by "type"):
- type = "element": { id: string, elementId: string, kind: string, title: string, description: string|null, technology: string|null, children: string[], shape: string, color: string, tags: string[] }
- type = "deployment-node": { id: string, deploymentId: string, kind: string, title: string, description: string|null, technology: string|null, children: string[], shape: string, color: string, tags: string[] }
- type = "deployed-instance": { id: string, deploymentId: string, title: string, description: string|null, technology: string|null, referencedElement: { id: string, kind: string, title: string }, shape: string, color: string, tags: string[] }

Edge object:
- { source: string, target: string, label: string|null, description: string|null, technology: string|null, tags: string[] }

Notes:
- Read-only, idempotent, no side effects.

Example response:
{
  "id": "system-overview",
  "type": "element",
  "title": "System Overview",
  "description": null,
  "tags": [],
  "project": "default",
  "nodes": [
    { "type": "logical", "id": "n1", "elementId": "shop.frontend", "kind": "container", "title": "Frontend", "description": null, "technology": "React", "children": [], "shape": "rounded-rectangle", "color": "#2F80ED", "tags": [] }
  ],
  "edges": [
    { "source": "n1", "target": "n2", "label": "calls", "description": null, "technology": "HTTPS", "tags": [] }
  ],
  "sourceLocation": {
    "path": "/abs/path/project/model.c4",
    "range": { "start": { "line": 10, "character": 0 }, "end": { "line": 30, "character": 0 } }
  }
}
`,annotations:{readOnlyHint:!0,idempotentHint:!0,title:"Read view"},inputSchema:{viewId:Q().describe("View id (name)"),project:Oc},outputSchema:{id:Q(),type:Gp(["element","deployment","dynamic"]).describe("View type"),title:Q(),description:Q().nullable(),tags:Ze(Q()),project:Q(),nodes:Ze(Cle),edges:Ze(Pt({source:Q().describe("Source node"),target:Q().describe("Target node"),label:Q().nullable(),description:Q().nullable(),technology:Q().nullable(),tags:Ze(Q())})).describe("Edge represents relatio\
nship between nodes"),sourceLocation:rh}},async(t,e)=>{const n=t.projectsManager.ensureProjectId(e.project),r=t.project(n),i=(await t.computedModel(n)).findView(e.viewId);if(!i)throw new Error(`View with ID '${e.viewId}' not found in project ${r.id}`);const s=ah(t,r.id);return{id:i.id,type:i.$view._type,title:i.title??i.id,description:i.description.text,tags:[...i.tags],project:r.id,nodes:[...i.nodes()].flatMap(a=>{const o={id:a.id,title:a.title,description:a.description.text,technology:a.technology,
shape:a.shape,color:a.color,tags:[...a.tags]};return a.hasDeployedInstance()?{...o,type:"deployed-instance",deploymentId:a.deployment.id,referencedElement:{id:a.deployment.element.id,kind:a.deployment.element.kind,title:a.deployment.element.title}}:a.hasDeployment()?{...o,type:"deployment-node",kind:a.deployment.kind,deploymentId:a.deployment.id,children:[...a.children()].map(l=>l.id)}:a.hasElement()?{...o,type:"element",elementId:a.element.id,kind:a.element.kind,children:[...a.children()].flatMap(
l=>Ple(l)??[])}:[]}),edges:[...i.edges()].map(a=>({source:a.source.id,target:a.target.id,label:a.label,description:a.description.text,technology:a.technology,tags:[...a.tags]})),sourceLocation:s({view:i.id})}}),Ale=Ze(US("type",[Pt({type:el("element"),project:Q().describe("Project ID"),id:Q().describe("Element ID (FQN)"),name:Q().describe("Element name"),kind:Q(),title:Q(),technology:Q().nullable(),shape:Q(),includedInViews:ih,metadata:vv(yv([Q(),Ze(Q())])),tags:Ze(Q())}),Pt({type:el("deployment\
-node"),project:Q().describe("Project ID"),id:Q().describe("Deployment ID (FQN)"),name:Q().describe("Deployment name"),kind:Q(),title:Q(),technology:Q().nullable(),shape:Q(),includedInViews:ih,metadata:vv(yv([Q(),Ze(Q())])),tags:Ze(Q())})])),Ile=ka({name:"search-element",annotations:{readOnlyHint:!0,idempotentHint:!0,title:"Search elements"},description:`
Search LikeC4 elements and deployment nodes across all projects.

Query syntax (case-insensitive):
- kind:<value>  filters by kind
- shape:<value> filters by shape
- meta:<key>    filters by having metadata with the given key
- #<value>      matches assigned tags
- <value>       matches id (FQN) or title

Request:
- search: string \u2014 at least 2 characters

Response (JSON object):
- total: number - total number of results
- found: Result[] - returns top 20 results

Result (discriminated union by "type"):
- type = "element": { id: string, name: string, kind: string, title: string, technology: string|null, shape: string, project: string, includedInViews: View[], tags: string[], metadata: Record<string, string> }
- type = "deployment-node": { id: string, name: string, kind: string, title: string, technology: string|null, shape: string, project: string, includedInViews: View[], tags: string[], metadata: Record<string, string> }

View (object) fields:
- id: string \u2014 view identifier
- title: string \u2014 view title
- type: "element" | "deployment" | "dynamic"

Notes:
- Read-only, idempotent.
- Use results as input to other tools (e.g., read-element, read-view).

Example response:
{
  "total": 1,
  "found": [
    {
      "type": "logical",
      "project": "default",
      "id": "shop.frontend",
      "name": "frontend",
      "kind": "container",
      "title": "Frontend",
      "technology": "React",
      "shape": "rectangle",      
      "includedInViews": [
        {
          "id": "system-overview",
          "title": "System Overview",
          "type": "element"
        }
      ],
      "tags": ["public"],
      "metadata": {}
    }
  ]
}
`,inputSchema:{search:Q().min(2,"Search must be at least 2 characters long")},outputSchema:{total:Wp(),found:Ale}},async(t,e)=>{const n=t.projects(),r=[];let i=e.search.toLowerCase(),s;i.startsWith("kind:")?(i=i.slice(5),nn.debug("search by kind: {search}",{search:i}),s=a=>a.kind.toLowerCase()===i):i.startsWith("shape:")?(i=i.slice(6),nn.debug("search by shape: {search}",{search:i}),s=a=>a.shape.toLowerCase()===i):i.startsWith("meta:")?(i=i.slice(5),nn.debug("search by metadata: {search}",{search:i}),
s=a=>!!a.getMetadata(i)):i.startsWith("#")?(i=i.slice(1),nn.debug("search by tag: {search}",{search:i}),s=a=>a.tags.some(o=>o.toLowerCase().includes(i))):(nn.debug("search by id/title: {search}",{search:i}),s=a=>a.id.toLowerCase().includes(i)||a.title.toLowerCase().includes(i));for(const a of n)try{const o=await t.computedModel(a.id);for(const l of Pw(o.elements(),c=>!c.imported&&s(c)))r.push({type:"element",project:a.id,id:l.id,name:l.name,kind:l.kind,title:l.title,technology:l.technology,shape:l.
shape,tags:[...l.tags],metadata:l.getMetadata(),includedInViews:sh(l.views())});for(const l of Pw(o.deployment.nodes(),s))r.push({type:"deployment-node",project:a.id,id:l.id,name:l.name,kind:l.kind,title:l.title,technology:l.technology,shape:l.shape,tags:[...l.tags],metadata:l.getMetadata(),includedInViews:sh(l.views())})}catch(o){nn.error(`Error searching in project ${a.id}:`,{error:o})}return{total:r.length,found:r.slice(0,20)}});class Nle{services;constructor(e){this.services=e}create(e){const n=this.
services.shared.lsp.Connection!==void 0,r=new mle({name:"LikeC4",version:ble.version},{instructions:`LikeC4 MCP \u2013 query and navigate LikeC4 models.

Conventions:
- All tools are read-only and idempotent.
- "project" is optional and defaults to "default".

Available tools:
- list-projects \u2014 List all LikeC4 projects in the workspace.
- read-project-summary \u2014 Project specification (element kinds, deployment node kinds, tags, metadata keys), all elements, deployment nodes and views. Input: { project? }.
- search-element \u2014 Search elements and deployment nodes across all projects by id/title/kind/shape/tags/metadata. Input: { search }.
- read-element \u2014 Full element details including relationships, includedInViews, deployedInstances, metadata and sourceLocation. Input: { id, project? }.
- read-deployment \u2014 Details of a deployment node or deployed instance. Input: { id, project? }.
- read-view \u2014 Full view details (nodes/edges) and sourceLocation. Input: { viewId, project? }.
- find-relationships \u2014 Direct and indirect relationships between two elements in a project. Input: { element1, element2, project? }.
${n?"- open-view \u2014 Opens the LikeC4 view panel in the editor. Triggers UI; at most one preview panel at a time. Input: { viewId, project? }.":""}

Instructions:
- Identify the project first  
  - Use "search-element" to find elements by id/title/kind/shape/tags/metadata and select the project
  - Use "read-project-summary" to find all elements and deployment nodes inside the project, what kinds, tags, metadata keys are available
  - Use "list-projects" to list all available projects
- If response returns "sourceLocation", provide link to this location in the editor

Full documentation: https://likec4.dev/llms-full.txt
`,enforceStrictCapabilities:!0,...e,capabilities:{tools:{},...e?.capabilities}});return r.registerTool(...Rle(this.services.likec4.LanguageServices)),r.registerTool(...Ele(this.services.likec4.LanguageServices)),r.registerTool(...Tle(this.services.likec4.LanguageServices)),r.registerTool(...$le(this.services.likec4.LanguageServices)),r.registerTool(...xle(this.services.likec4.LanguageServices)),r.registerTool(...Ile(this.services.likec4.LanguageServices)),r.registerTool(..._le(this.services.likec4.
LanguageServices)),n&&r.registerTool(...Sle(this.services.likec4.LanguageServices)),r.server.onerror=i=>{Be.error(rt(i))},r}}class kj extends xS{services;projects;langiumDocuments;documentCache;workspaceCache;constructor(e){super(),this.services=e,this.langiumDocuments=e.shared.workspace.LangiumDocuments,this.projects=e.shared.workspace.ProjectsManager,this.documentCache=new l0(n=>this.createDocumentIndex(n)),this.workspaceCache=new jl(e.shared,Ve.IndexedContent),this.onDispose(e.shared.workspace.
DocumentBuilder.onDocumentPhase(Ve.IndexedContent,n=>{ns(n)&&this.documentCache.delete(n)}))}documents(e){return this.langiumDocuments.projectDocuments(e).filter(n=>ns(n)&&n.state>=Ve.IndexedContent)}get(e){return e.state<Ve.IndexedContent&&ct(`Document ${e.uri.path} is not indexed`),this.documentCache.get(e)}resolve(e){return e.$type==="Imported"?this.getFqn(e.imported.ref):e.$type==="Element"?this.getFqn(e):this.services.likec4.DeploymentsIndex.getFqn(e)}getFqn(e){Ke(Vn(e)||sg(e));let n=ev.readId(
e);if(ke(n))return n;const r=$t(e);return Ke(ns(r)),this.get(r),di(ev.readId(e),"Element fqn must be set, invalid state")}byFqn(e,n){return dt(this.workspaceCache.get(`${e}:fqn:${n}`,()=>this.documents(e).flatMap(r=>this.get(r).byFqn(n)).toArray()))}rootElements(e){return dt(this.workspaceCache.get(`${e}:rootElements`,()=>{const n=this.documents(e).reduce((r,i)=>(this.get(i).rootElements().forEach(s=>{r.set(s.name,s)}),r),new nr);return l$(n)}))}directChildrenOf(e,n){return dt(this.workspaceCache.
get(`${e}:directChildrenOf:${n}`,()=>{const r=this.documents(e).reduce((i,s)=>(this.get(s).children(n).forEach(a=>{i.set(a.name,a)}),i),new nr);return l$(r)}))}uniqueDescedants(e,n){return dt(this.workspaceCache.get(`${e}:uniqueDescedants:${n}`,()=>{const{children:r,descendants:i}=this.documents(e).reduce((o,l)=>{const c=this.get(l);return c.children(n).forEach(u=>{o.children.set(u.name,u)}),c.descendants(n).forEach(u=>{o.descendants.set(u.name,u)}),o},{children:new nr,descendants:new nr}),s=l$(
r),a=[...i.associations()].flatMap(([o,l])=>l.length===1&&!r.has(o)?l:[]);return[...s,...cF(a)]}))}createDocumentIndex(e){const n=e.parseResult.value.models.flatMap(d=>d.elements);if(n.length===0)return Mc.EMPTY;const r=e.likec4ProjectId??this.projects.belongsTo(e),i=new Array,s=new nr,a=new nr,o=new nr,l=this.services.workspace.AstNodeDescriptionProvider,c=(d,f,p)=>{const m=Object.assign(l.createDescription(d,f,e),{id:p,likec4ProjectId:r});return ev.writeId(d,p),o.set(p,m),m},u=(d,f)=>{let p;if(Vn(
d)){p=xF(d.name,f);const w=c(d,d.name,p);f?s.set(f,w):i.push(w)}else p=Jo(d.element);let m=[];if(Un(d.body)&&!Nt(d.body.elements)){for(const w of d.body.elements)if(!Qi(w)&&!Zl(w))try{m.push(...u(w,p))}catch(v){ct(v)}}m=[...s.get(p)??[],...m];for(const w of m)a.set(p,w);if(Io(d))for(const w of uF(p))for(const v of m)a.set(w,v);return a.get(p)??[]};for(const d of n)try{if(Qi(d)||Zl(d))continue;u(d,null)}catch(f){ct(f)}return new Mc(i,s,a,o,r)}}function l$(t){return[...t.associations()].flatMap(([
e,n])=>n.length===1?n:[]).sort((e,n)=>c0(e.name,n.name))}class Mc{_rootElements;_children;_descendants;_byfqn;projectId;static EMPTY=new Mc([],new nr,new nr,new nr,Zo.DefaultProjectId);constructor(e,n,r,i,s){this._rootElements=e,this._children=n,this._descendants=r,this._byfqn=i,this.projectId=s}rootElements(){return this._rootElements}byFqn(e){return this._byfqn.get(e)??[]}children(e){return this._children.get(e)??[]}descendants(e){return this._descendants.get(e)??[]}}class Dle extends kj{services;Names;constructor(e){
super(e),this.services=e,this.Names=e.references.NameProvider}createDocumentIndex(e){const n=e.parseResult.value.deployments.flatMap(f=>f.elements);if(n.length===0)return Mc.EMPTY;const r=this.projects.belongsTo(e),i=new Array,s=new nr,a=new nr,o=new nr,l=this.Names,c=this.services.workspace.AstNodeDescriptionProvider,u=(f,p,m)=>{const w={...c.createDescription(f,p,e),id:m,likec4ProjectId:r};return ev.writeId(f,m),o.set(m,w),w},d=(f,p)=>{let m;if(ga(f))m=Jo(f.deploymentNode);else{const v=l.getName(
f);if(!ke(v))return[];m=Lq(v,p);const g=u(f,v,m);if(p?s.set(p,g):i.push(g),$r(f))return[]}let w=[];if(Un(f.body)){for(const v of f.body.elements)if(!Si(v))try{w.push(...d(v,m))}catch(g){ct(g)}}w=[...s.get(m)??[],...w];for(const v of w)a.set(m,v);if(ga(f))for(const v of Mq(m))for(const g of w)a.set(v,g);return a.get(m)??[]};for(const f of n)try{if(Si(f))continue;d(f,null)}catch(p){ct(p)}return new Mc(i,s,a,o,r)}}function Ole(t){const e=new Map;for(const n of t)if(_w(n)&&n.viewOf&&Gt(n.extends)){const r=e.
get(n.viewOf)??[];r.push(n.id),e.set(n.viewOf,r)}for(const{id:n,nodes:r}of t)for(const i of r){const s=i.modelRef;if(i.navigateTo||!s)continue;const a=Ok(e.get(s)??[],o=>o!==n);a&&(i.navigateTo=a)}return t}new TextEncoder;const Lle=4096;function _j(t,e,n){let r=e;const i=r+n,s=[];let a="";for(;r<i;){const o=t[r++];if((o&128)===0)s.push(o);else if((o&224)===192){const l=t[r++]&63;s.push((o&31)<<6|l)}else if((o&240)===224){const l=t[r++]&63,c=t[r++]&63;s.push((o&31)<<12|l<<6|c)}else if((o&248)===240){
const l=t[r++]&63,c=t[r++]&63,u=t[r++]&63;let d=(o&7)<<18|l<<12|c<<6|u;d>65535&&(d-=65536,s.push(d>>>10&1023|55296),d=56320|d&1023),s.push(d)}else s.push(o);s.length>=Lle&&(a+=String.fromCharCode(...s),s.length=0)}return s.length>0&&(a+=String.fromCharCode(...s)),a}const Mle=new TextDecoder,jle=200;function qle(t,e,n){const r=t.subarray(e,e+n);return Mle.decode(r)}function Fle(t,e,n){return n>jle?qle(t,e,n):_j(t,e,n)}class dw{constructor(e,n){this.type=e,this.data=n}}class Kr extends Error{constructor(e){
super(e);const n=Object.create(Kr.prototype);Object.setPrototypeOf(this,n),Object.defineProperty(this,"name",{configurable:!0,enumerable:!1,value:Kr.name})}}const oh=4294967295;function zle(t,e,n){const r=Math.floor(n/4294967296),i=n;t.setUint32(e,r),t.setUint32(e+4,i)}function Rj(t,e){const n=t.getInt32(e),r=t.getUint32(e+4);return n*4294967296+r}function Ule(t,e){const n=t.getUint32(e),r=t.getUint32(e+4);return n*4294967296+r}const Hle=-1,Vle=4294967296-1,Ble=17179869184-1;function Wle({sec:t,
nsec:e}){if(t>=0&&e>=0&&t<=Ble)if(e===0&&t<=Vle){const n=new Uint8Array(4);return new DataView(n.buffer).setUint32(0,t),n}else{const n=t/4294967296,r=t&4294967295,i=new Uint8Array(8),s=new DataView(i.buffer);return s.setUint32(0,e<<2|n&3),s.setUint32(4,r),i}else{const n=new Uint8Array(12),r=new DataView(n.buffer);return r.setUint32(0,e),zle(r,4,t),n}}function Gle(t){const e=t.getTime(),n=Math.floor(e/1e3),r=(e-n*1e3)*1e6,i=Math.floor(r/1e9);return{sec:n+i,nsec:r-i*1e9}}function Kle(t){if(t instanceof
Date){const e=Gle(t);return Wle(e)}else return null}function Zle(t){const e=new DataView(t.buffer,t.byteOffset,t.byteLength);switch(t.byteLength){case 4:return{sec:e.getUint32(0),nsec:0};case 8:{const n=e.getUint32(0),r=e.getUint32(4),i=(n&3)*4294967296+r,s=n>>>2;return{sec:i,nsec:s}}case 12:{const n=Rj(e,4),r=e.getUint32(0);return{sec:n,nsec:r}}default:throw new Kr(`Unrecognized data size for timestamp (expected 4, 8, or 12): ${t.length}`)}}function Jle(t){const e=Zle(t);return new Date(e.sec*1e3+
e.nsec/1e6)}const Yle={type:Hle,encode:Kle,decode:Jle};class c${constructor(){this.builtInEncoders=[],this.builtInDecoders=[],this.encoders=[],this.decoders=[],this.register(Yle)}register({type:e,encode:n,decode:r}){if(e>=0)this.encoders[e]=n,this.decoders[e]=r;else{const i=-1-e;this.builtInEncoders[i]=n,this.builtInDecoders[i]=r}}tryToEncode(e,n){for(let r=0;r<this.builtInEncoders.length;r++){const i=this.builtInEncoders[r];if(i!=null){const s=i(e,n);if(s!=null){const a=-1-r;return new dw(a,s)}}}
for(let r=0;r<this.encoders.length;r++){const i=this.encoders[r];if(i!=null){const s=i(e,n);if(s!=null){const a=r;return new dw(a,s)}}}return e instanceof dw?e:null}decode(e,n,r){const i=n<0?this.builtInDecoders[-1-n]:this.decoders[n];return i?i(e,n,r):new dw(n,e)}}c$.defaultCodec=new c$;function Xle(t){return t instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer}function Sj(t){return t instanceof Uint8Array?t:ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,
t.byteLength):Xle(t)?new Uint8Array(t):Uint8Array.from(t)}function u$(t){return`${t<0?"-":""}0x${Math.abs(t).toString(16).padStart(2,"0")}`}const Qle=16,ece=16;class tce{constructor(e=Qle,n=ece){this.hit=0,this.miss=0,this.maxKeyLength=e,this.maxLengthPerKey=n,this.caches=[];for(let r=0;r<this.maxKeyLength;r++)this.caches.push([])}canBeCached(e){return e>0&&e<=this.maxKeyLength}find(e,n,r){const i=this.caches[r-1];e:for(const s of i){const a=s.bytes;for(let o=0;o<r;o++)if(a[o]!==e[n+o])continue e;
return s.str}return null}store(e,n){const r=this.caches[e.length-1],i={bytes:e,str:n};r.length>=this.maxLengthPerKey?r[Math.random()*r.length|0]=i:r.push(i)}decode(e,n,r){const i=this.find(e,n,r);if(i!=null)return this.hit++,i;this.miss++;const s=_j(e,n,r),a=Uint8Array.prototype.slice.call(e,n,n+r);return this.store(a,s),s}}const d$="array",lh="map_key",$j="map_value",nce=t=>{if(typeof t=="string"||typeof t=="number")return t;throw new Kr("The type of key must be string or number but "+typeof t)};
class rce{constructor(){this.stack=[],this.stackHeadPosition=-1}get length(){return this.stackHeadPosition+1}top(){return this.stack[this.stackHeadPosition]}pushArrayState(e){const n=this.getUninitializedStateFromPool();n.type=d$,n.position=0,n.size=e,n.array=new Array(e)}pushMapState(e){const n=this.getUninitializedStateFromPool();n.type=lh,n.readCount=0,n.size=e,n.map={}}getUninitializedStateFromPool(){if(this.stackHeadPosition++,this.stackHeadPosition===this.stack.length){const e={type:void 0,
size:0,array:void 0,position:0,readCount:0,map:void 0,key:null};this.stack.push(e)}return this.stack[this.stackHeadPosition]}release(e){if(this.stack[this.stackHeadPosition]!==e)throw new Error("Invalid stack state. Released state is not on top of the stack.");if(e.type===d$){const r=e;r.size=0,r.array=void 0,r.position=0,r.type=void 0}if(e.type===lh||e.type===$j){const r=e;r.size=0,r.map=void 0,r.readCount=0,r.type=void 0}this.stackHeadPosition--}reset(){this.stack.length=0,this.stackHeadPosition=
-1}}const ch=-1,f$=new DataView(new ArrayBuffer(0)),ice=new Uint8Array(f$.buffer);try{f$.getInt8(0)}catch(t){if(!(t instanceof RangeError))throw new Error("This module is not supported in the current JavaScript engine because DataView does not throw RangeError on out-of-bounds access")}const Tj=new RangeError("Insufficient data"),sce=new tce;class V${constructor(e){this.totalPos=0,this.pos=0,this.view=f$,this.bytes=ice,this.headByte=ch,this.stack=new rce,this.entered=!1,this.extensionCodec=e?.extensionCodec??
c$.defaultCodec,this.context=e?.context,this.useBigInt64=e?.useBigInt64??!1,this.rawStrings=e?.rawStrings??!1,this.maxStrLength=e?.maxStrLength??oh,this.maxBinLength=e?.maxBinLength??oh,this.maxArrayLength=e?.maxArrayLength??oh,this.maxMapLength=e?.maxMapLength??oh,this.maxExtLength=e?.maxExtLength??oh,this.keyDecoder=e?.keyDecoder!==void 0?e.keyDecoder:sce,this.mapKeyConverter=e?.mapKeyConverter??nce}clone(){return new V$({extensionCodec:this.extensionCodec,context:this.context,useBigInt64:this.
useBigInt64,rawStrings:this.rawStrings,maxStrLength:this.maxStrLength,maxBinLength:this.maxBinLength,maxArrayLength:this.maxArrayLength,maxMapLength:this.maxMapLength,maxExtLength:this.maxExtLength,keyDecoder:this.keyDecoder})}reinitializeState(){this.totalPos=0,this.headByte=ch,this.stack.reset()}setBuffer(e){const n=Sj(e);this.bytes=n,this.view=new DataView(n.buffer,n.byteOffset,n.byteLength),this.pos=0}appendBuffer(e){if(this.headByte===ch&&!this.hasRemaining(1))this.setBuffer(e);else{const n=this.
bytes.subarray(this.pos),r=Sj(e),i=new Uint8Array(n.length+r.length);i.set(n),i.set(r,n.length),this.setBuffer(i)}}hasRemaining(e){return this.view.byteLength-this.pos>=e}createExtraByteError(e){const{view:n,pos:r}=this;return new RangeError(`Extra ${n.byteLength-r} of ${n.byteLength} byte(s) found at buffer[${e}]`)}decode(e){if(this.entered)return this.clone().decode(e);try{this.entered=!0,this.reinitializeState(),this.setBuffer(e);const n=this.doDecodeSync();if(this.hasRemaining(1))throw this.
createExtraByteError(this.pos);return n}finally{this.entered=!1}}*decodeMulti(e){if(this.entered){yield*this.clone().decodeMulti(e);return}try{for(this.entered=!0,this.reinitializeState(),this.setBuffer(e);this.hasRemaining(1);)yield this.doDecodeSync()}finally{this.entered=!1}}async decodeAsync(e){if(this.entered)return this.clone().decodeAsync(e);try{this.entered=!0;let n=!1,r;for await(const o of e){if(n)throw this.entered=!1,this.createExtraByteError(this.totalPos);this.appendBuffer(o);try{r=
this.doDecodeSync(),n=!0}catch(l){if(!(l instanceof RangeError))throw l}this.totalPos+=this.pos}if(n){if(this.hasRemaining(1))throw this.createExtraByteError(this.totalPos);return r}const{headByte:i,pos:s,totalPos:a}=this;throw new RangeError(`Insufficient data in parsing ${u$(i)} at ${a} (${s} in the current buffer)`)}finally{this.entered=!1}}decodeArrayStream(e){return this.decodeMultiAsync(e,!0)}decodeStream(e){return this.decodeMultiAsync(e,!1)}async*decodeMultiAsync(e,n){if(this.entered){yield*this.
clone().decodeMultiAsync(e,n);return}try{this.entered=!0;let r=n,i=-1;for await(const s of e){if(n&&i===0)throw this.createExtraByteError(this.totalPos);this.appendBuffer(s),r&&(i=this.readArraySize(),r=!1,this.complete());try{for(;yield this.doDecodeSync(),--i!==0;);}catch(a){if(!(a instanceof RangeError))throw a}this.totalPos+=this.pos}}finally{this.entered=!1}}doDecodeSync(){e:for(;;){const e=this.readHeadByte();let n;if(e>=224)n=e-256;else if(e<192)if(e<128)n=e;else if(e<144){const i=e-128;if(i!==
0){this.pushMapState(i),this.complete();continue e}else n={}}else if(e<160){const i=e-144;if(i!==0){this.pushArrayState(i),this.complete();continue e}else n=[]}else{const i=e-160;n=this.decodeString(i,0)}else if(e===192)n=null;else if(e===194)n=!1;else if(e===195)n=!0;else if(e===202)n=this.readF32();else if(e===203)n=this.readF64();else if(e===204)n=this.readU8();else if(e===205)n=this.readU16();else if(e===206)n=this.readU32();else if(e===207)this.useBigInt64?n=this.readU64AsBigInt():n=this.readU64();else if(e===
208)n=this.readI8();else if(e===209)n=this.readI16();else if(e===210)n=this.readI32();else if(e===211)this.useBigInt64?n=this.readI64AsBigInt():n=this.readI64();else if(e===217){const i=this.lookU8();n=this.decodeString(i,1)}else if(e===218){const i=this.lookU16();n=this.decodeString(i,2)}else if(e===219){const i=this.lookU32();n=this.decodeString(i,4)}else if(e===220){const i=this.readU16();if(i!==0){this.pushArrayState(i),this.complete();continue e}else n=[]}else if(e===221){const i=this.readU32();
if(i!==0){this.pushArrayState(i),this.complete();continue e}else n=[]}else if(e===222){const i=this.readU16();if(i!==0){this.pushMapState(i),this.complete();continue e}else n={}}else if(e===223){const i=this.readU32();if(i!==0){this.pushMapState(i),this.complete();continue e}else n={}}else if(e===196){const i=this.lookU8();n=this.decodeBinary(i,1)}else if(e===197){const i=this.lookU16();n=this.decodeBinary(i,2)}else if(e===198){const i=this.lookU32();n=this.decodeBinary(i,4)}else if(e===212)n=this.
decodeExtension(1,0);else if(e===213)n=this.decodeExtension(2,0);else if(e===214)n=this.decodeExtension(4,0);else if(e===215)n=this.decodeExtension(8,0);else if(e===216)n=this.decodeExtension(16,0);else if(e===199){const i=this.lookU8();n=this.decodeExtension(i,1)}else if(e===200){const i=this.lookU16();n=this.decodeExtension(i,2)}else if(e===201){const i=this.lookU32();n=this.decodeExtension(i,4)}else throw new Kr(`Unrecognized type byte: ${u$(e)}`);this.complete();const r=this.stack;for(;r.length>
0;){const i=r.top();if(i.type===d$)if(i.array[i.position]=n,i.position++,i.position===i.size)n=i.array,r.release(i);else continue e;else if(i.type===lh){if(n==="__proto__")throw new Kr("The key __proto__ is not allowed");i.key=this.mapKeyConverter(n),i.type=$j;continue e}else if(i.map[i.key]=n,i.readCount++,i.readCount===i.size)n=i.map,r.release(i);else{i.key=null,i.type=lh;continue e}}return n}}readHeadByte(){return this.headByte===ch&&(this.headByte=this.readU8()),this.headByte}complete(){this.
headByte=ch}readArraySize(){const e=this.readHeadByte();switch(e){case 220:return this.readU16();case 221:return this.readU32();default:{if(e<160)return e-144;throw new Kr(`Unrecognized array type byte: ${u$(e)}`)}}}pushMapState(e){if(e>this.maxMapLength)throw new Kr(`Max length exceeded: map length (${e}) > maxMapLengthLength (${this.maxMapLength})`);this.stack.pushMapState(e)}pushArrayState(e){if(e>this.maxArrayLength)throw new Kr(`Max length exceeded: array length (${e}) > maxArrayLength (${this.
maxArrayLength})`);this.stack.pushArrayState(e)}decodeString(e,n){return!this.rawStrings||this.stateIsMapKey()?this.decodeUtf8String(e,n):this.decodeBinary(e,n)}decodeUtf8String(e,n){if(e>this.maxStrLength)throw new Kr(`Max length exceeded: UTF-8 byte length (${e}) > maxStrLength (${this.maxStrLength})`);if(this.bytes.byteLength<this.pos+n+e)throw Tj;const r=this.pos+n;let i;return this.stateIsMapKey()&&this.keyDecoder?.canBeCached(e)?i=this.keyDecoder.decode(this.bytes,r,e):i=Fle(this.bytes,r,e),
this.pos+=n+e,i}stateIsMapKey(){return this.stack.length>0?this.stack.top().type===lh:!1}decodeBinary(e,n){if(e>this.maxBinLength)throw new Kr(`Max length exceeded: bin length (${e}) > maxBinLength (${this.maxBinLength})`);if(!this.hasRemaining(e+n))throw Tj;const r=this.pos+n,i=this.bytes.subarray(r,r+e);return this.pos+=n+e,i}decodeExtension(e,n){if(e>this.maxExtLength)throw new Kr(`Max length exceeded: ext length (${e}) > maxExtLength (${this.maxExtLength})`);const r=this.view.getInt8(this.pos+
n),i=this.decodeBinary(e,n+1);return this.extensionCodec.decode(i,r,this.context)}lookU8(){return this.view.getUint8(this.pos)}lookU16(){return this.view.getUint16(this.pos)}lookU32(){return this.view.getUint32(this.pos)}readU8(){const e=this.view.getUint8(this.pos);return this.pos++,e}readI8(){const e=this.view.getInt8(this.pos);return this.pos++,e}readU16(){const e=this.view.getUint16(this.pos);return this.pos+=2,e}readI16(){const e=this.view.getInt16(this.pos);return this.pos+=2,e}readU32(){const e=this.
view.getUint32(this.pos);return this.pos+=4,e}readI32(){const e=this.view.getInt32(this.pos);return this.pos+=4,e}readU64(){const e=Ule(this.view,this.pos);return this.pos+=8,e}readI64(){const e=Rj(this.view,this.pos);return this.pos+=8,e}readU64AsBigInt(){const e=this.view.getBigUint64(this.pos);return this.pos+=8,e}readI64AsBigInt(){const e=this.view.getBigInt64(this.pos);return this.pos+=8,e}readF32(){const e=this.view.getFloat32(this.pos);return this.pos+=4,e}readF64(){const e=this.view.getFloat64(
this.pos);return this.pos+=8,e}}function ace(t,e){return new V$(e).decode(t)}const oce=(t,e)=>{if(typeof t!="string")throw new TypeError(`The "input" argument must be of type string. Received type ${typeof t} (${t})`);return CF.from(t,e)},lce=/^[A-Za-z0-9+/]*={0,2}$/,cce=t=>{if(t.length*3%4!==0)throw new TypeError("Incorrect padding on base64 string.");if(!lce.exec(t))throw new TypeError("Invalid base64 string.");const e=oce(t,"base64");return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)},
{getDocument:uce}=bl;function dce({nodes:t,edges:e,autoLayout:n,...r}){return{...r,autoLayout:jq(n)?{direction:n}:n,nodes:yl(t,({b:i,c:s,...a})=>({x:i[0],y:i[1],width:i[2],height:i[3],isCompound:s,...a})),edges:yl(e,({p:i,cp:s,l:a,...o})=>({...!!s&&{controlPoints:s},...!!a&&{labelBBox:a},...o,points:i}))}}function fw(t){return t.includes("@likec4-generated")}function fce(t){if(!fw(t))throw new Error(`Not a likec4-generated comment: ${t}`);const e=t.trim().split(`
`).filter(r=>!r.includes("**")&&!r.includes("@likec4-")&&!r.includes("*/")).map(r=>r.replaceAll("*","").trim()).join(""),n=cce(e);return dce(ace(n))}function p$(t){const e=Wc(t.$cstNode,["BLOCK_COMMENT"]);if(!(!e||!fw(e.text)))try{return fce(e.text)}catch(n){const r=uce(t);ct(n),Be.warn(`Ignoring manual layout of "${t.name??"unnamed"}" at ${r.uri.fsPath}:${1+(e.range.start.line||0)}`);return}}class Ej{mergedData=new Map;mergeMetadata(e,n){const r={...e};for(const[i,s]of Object.entries(n)){const a=r[i];
if(a===void 0){r[i]=s;continue}const o=Array.isArray(a)?a:[a],l=Array.isArray(s)?s:[s],c=Ss([...o,...l]);r[i]=c.length===1?c[0]:c}return r}merge(e){for(const n of e){const{id:r,links:i,tags:s,metadata:a}=n,o=this.mergedData.get(r)??{links:[],tags:[],metadata:{}};i&&o.links.push(...i),s&&(o.tags=Ss([...o.tags,...s])),a&&(o.metadata=this.mergeMetadata(o.metadata,a)),this.mergedData.set(r,o)}}applyExtended(e){const n=this.mergedData.get(e.id);if(!n)return e;let r=n.links;e.links&&e.links.length>0&&
(r=[...e.links,...r]);let i=n.tags;e.tags&&e.tags.length>0&&(i=Ss([...e.tags,...i]));let s=n.metadata;return e.metadata&&(s=this.mergeMetadata(e.metadata,n.metadata)),{...e,tags:xn(i,1)?i:null,links:xn(r,1)?r:null,...!Nt(s)&&{metadata:s}}}}class Pj{specs={elements:{},deployments:{},relationships:{},colors:{}};tags;globals={predicates:{},dynamicPredicates:{},styles:{}};imports=new nr(Set);constructor(e){const n={};for(const r of e){const{c4Specification:i,c4Globals:s,c4Imports:a}=r;Object.assign(
n,i.tags),Object.assign(this.specs.elements,i.elements),Object.assign(this.specs.relationships,i.relationships),Object.assign(this.specs.colors,i.colors),Object.assign(this.specs.deployments,i.deployments),Object.assign(this.globals.predicates,s.predicates),Object.assign(this.globals.dynamicPredicates,s.dynamicPredicates),Object.assign(this.globals.styles,s.styles);for(const[o,l]of a)this.imports.set(o,l)}this.tags=RF(n)}toModelElement=({tags:e,links:n,style:r,id:i,kind:s,title:a,description:o,technology:l,
summary:c,metadata:u})=>{try{const d=this.specs.elements[s];return d?(l??=d.technology,o??=d.description,c??=d.summary,n??=d.links,a=a===kh(i)&&d.title?d.title:a,d.tags&&dF(d.tags)&&(e=e?Ss([...d.tags,...e]):d.tags),ds({metadata:u&&!Nt(u)?u:void 0,notation:d.notation,style:ds({...d.style,...r}),links:n,tags:e,summary:c,technology:l,description:o,title:a,kind:s,id:i})):(Be.warn`No kind '${s}' found for ${i}`,null)}catch(d){ct(d)}return null};toModelRelation=({astPath:e,source:n,target:r,kind:i,links:s,
id:a,...o})=>Ki(i)&&this.specs.relationships[i]?{...this.specs.relationships[i],...o,...s&&{links:s},source:n,target:r,kind:i,id:a}:{...s&&{links:s},...o,source:n,target:r,id:a};toDeploymentElement=e=>{if("element"in e&&!("kind"in e))return{...e,element:Jn.flatten(e.element)};if("element"in e)return Be.warn`Invalid ParsedAstDeployment ${e.id}, has both element and kind properties`,null;try{const n=this.specs.deployments[e.kind];if(!n)return Be.warn`No kind ${e.kind} found for ${e.id}`,null;let{id:r,
style:i,title:s,...a}=e;return s=s===kh(e.id)&&n.title?n.title:s,ds({...n,...a,title:s,style:ds({...n.style,...i}),id:r})}catch(n){ct(n)}return null};toDeploymentRelation=({astPath:e,source:n,target:r,kind:i,links:s,id:a,...o})=>Ki(i)&&this.specs.relationships[i]?{...this.specs.relationships[i],...o,...s&&{links:s},source:n,target:r,kind:i,id:a}:{...s&&{links:s},...o,source:n,target:r,id:a}}function pce(t,e){const n=new Pj(e),r=yl(n.specs.colors,g=>SF(g.color)),i=new Set,s=new Ej,a=new Ej,o=e.flatMap(
g=>g.c4ExtendRelations),l=new Set,c=g=>{g?.metadata&&Lr(g.metadata).forEach(h=>i.add(h))},u=at(e,Rs(g=>(s.merge(g.c4ExtendElements),It(g.c4Elements,n.toModelElement))),nt(ke),u0,Lk((g,h)=>{const y=d0(h.id);return y&&Gt(g[y])?(Be.debug`No parent found for ${h.id}`,g):(g[h.id]=s.applyExtended(h),c(g[h.id]),g)},{})),d=at(e,Rs(g=>It(g.c4Relations,n.toModelRelation)),nt(g=>{if(!g)return!1;const h=Jn.flatten(g.source),y=Jn.flatten(g.target);return Gt(u[h])&&!Q$(h)||Gt(u[y])&&!Q$(y)?(Be.debug`Invalid relation ${g.
id}
  source: ${h} resolved: ${!!u[h]}
  target: ${y} resolved: ${!!u[y]}\n`,!1):!0}),It(g=>{const h=ss("extend-relation",Jn.flatten(g.source),Jn.flatten(g.target),g.kind??"default",g.title??""),y=o.filter(B=>B.id===h);if(y.length===0)return g;y.forEach(B=>l.add(B.astPath));const b=g.tags?[...g.tags]:[],R=g.links?[...g.links]:[];let T=g.metadata?{...g.metadata}:{};for(const B of y){if(B.tags&&b.push(...B.tags),B.links)for(const ie of B.links)R.some(L=>L.url===ie.url&&(L.title||"")===(ie.title||""))||R.push(ie);if(B.metadata)for(const[
ie,L]of Object.entries(B.metadata)){const E=T[ie];if(E===void 0)T[ie]=L;else{const $=Array.isArray(E)?E:[E],z=Array.isArray(L)?L:[L],j=Ss([...$,...z]);T[ie]=j.length===1?j[0]:j}}}const N=Ss(b),q=R;return{...g,...xn(N,1)&&{tags:N},...xn(q,1)&&{links:q},...!Nt(T)&&{metadata:T}}}),wx(c),td(_i("id"))),f=at(e,Rs(g=>(a.merge(g.c4ExtendDeployments),It(g.c4Deployments,n.toDeploymentElement))),nt(ke),u0,Lk((g,h)=>{const y=d0(h.id);return y&&Gt(g[y])?(Be.debug`No parent found for deployment element ${h.id}`,
g):(g[h.id]=qq(h)?a.applyExtended(h):h,c(g[h.id]),g)},{})),p=at(e,Rs(g=>It(g.c4DeploymentRelations,n.toDeploymentRelation)),nt(g=>g?Gt(f[g.source.deployment])||Gt(f[g.target.deployment])?(Be.debug`Invalid deployment relation ${g.id}
  source: ${g.source.deployment} resolved: ${!!f[g.source.deployment]}
  target: ${g.target.deployment} resolved: ${!!f[g.target.deployment]}\n`,!1):!0:!1),Lk((g,h)=>Un(g[h.id])?(Be.debug`Duplicate deployment relation ${h.id}`,g):(c(h),g[h.id]=h,g),{}));function m(g){const h=g.uri.toString();return y=>{let{id:b,title:R,description:T,astPath:N,...q}=y;return y[v0]==="element"&&Gt(R)&&"viewOf"in y&&(R=u[y.viewOf]?.title??null),Gt(R)&&b==="index"&&(R="Landscape view"),{...Rx(q,B=>B===void 0),[Cw]:"parsed",sourcePath:tt.relative(t.folderUri,h),docUri:h,description:T,title:R,
id:b}}}const w=e.flatMap(g=>It(g.c4Views,m(g)));w.some(g=>g.id==="index")||w.unshift({[Cw]:"parsed",[v0]:"element",id:"index",title:"Landscape view",description:null,rules:[{include:[{wildcard:!0}]}]});let v=at(w,td(_i("id")));w.some(AF)&&(v=TF(v));for(const g of o)l.has(g.astPath)||Be.warn(`Relation extend at ${g.astPath} does not match any relation in the model`);return{data:{[Cw]:"parsed",projectId:t.id,project:ds({id:t.id,title:t.config.title??t.config.name,styles:t.config.styles,manualLayouts:t.
config.manualLayouts}),specification:{tags:n.tags,elements:n.specs.elements,relationships:yl(n.specs.relationships,({notation:g,technology:h,...y})=>({...g&&{notation:g},...h&&{technology:h},style:y})),deployments:n.specs.deployments,...i.size>0&&{metadataKeys:[...i].sort(c0)},customColors:r},elements:u,relations:d,globals:n.globals,views:v,deployments:{elements:f,relations:p},imports:{}},imports:n.imports}}const hce=t=>`parsed-without-imports-${t}`,mce=t=>`parsed-model-${t}`,gce=t=>`computed-mo\
del-${t}`,Gs=Be.getChild("model-builder");class yce extends xS{projects;parser;listeners=[];cache;DocumentBuilder;manualLayouts;mutex;constructor(e){super(),this.projects=e.shared.workspace.ProjectsManager,this.parser=e.likec4.ModelParser,this.cache=e.shared.workspace.Cache,this.DocumentBuilder=e.shared.workspace.DocumentBuilder,this.mutex=e.shared.workspace.WorkspaceLock,this.manualLayouts=e.likec4.ManualLayouts,this.onDispose(this.DocumentBuilder.onUpdate((n,r)=>{r.length>0&&this.notifyListeners(
r)})),this.onDispose(this.DocumentBuilder.onBuildPhase(Ve.Validated,(n,r)=>{const i=n.flatMap(s=>Fs(s.uri)||this.projects.isExcluded(s)?[]:s.uri);i.length>0&&this.notifyListeners(i)})),Gs.debug`created`}unsafeSyncParseModelData(e){const n=this.cache,r=hce(e);return n.get(r,()=>{const i=Gs.getChild(e);try{const s=this.projects.getProject(e),a=this.documents(e);return a.length===0?(i.debug`unsafeSyncParseModelData: skipped due to no documents`,null):(i.debug`unsafeSyncParseModelData: completed`,pce(
s,a))}catch(s){return Gs.warn(`unsafeSyncParseModelData failed for project ${e}`,{err:s}),null}})}unsafeSyncJoinedModelData(e){const n=Gs.getChild(e),r=this.unsafeSyncParseModelData(e);if(!r)return null;if(r.imports.size===0)return r.data;n.debug`processing imports of ${e}`;const i=[...r.imports.associations()].reduce((s,[a,o])=>{if(o.size===0)return s;const l=this.unsafeSyncParseModelData(a);if(l){const c=[...o].flatMap(u=>l.data.elements[u]??[]);xn(c,1)&&(s[a]=structuredClone(c))}return s},{});
return{...r.data,imports:i}}async parseModel(e,n){e=this.projects.ensureProjectId(e);const r=Gs.getChild(e),i=this.cache,s=lv();return await this.mutex.read(async()=>{n?.isCancellationRequested&&await mn(n);const a=mce(e);return i.has(a)&&r.debug`parseModel from cache`,i.get(a,()=>{const o=this.unsafeSyncJoinedModelData(e);return o?(r.debug`parseModel in ${s.pretty}`,qi.create(o)):(r.debug`parseModel: returning EMPTY`,qi.EMPTY.asParsed)})})}previousViews={};unsafeSyncComputeModel(e,n){const r=this.
cache,i=!!n&&!Nt(n),s=gce(e)+(i?"+manualLayouts":"");return r.get(s,()=>{const a=Gs.getChild(e),o=this.unsafeSyncJoinedModelData(e);if(!o)return a.debug`unsafeSyncComputeModel: returning EMPTY`,qi.EMPTY.asComputed;const l=qi.create(o),c=[];for(const f of Fc(o.views)){const p=EF(f,l);if(!p.isSuccess){a.warn(rt(p.error));continue}n?.[f.id]&&Object.assign(p.view,{hasManualLayout:!0}),c.push(p.view)}Ole(c);const u=ii(c,f=>{const p=vce(e,f.id),m=this.previousViews[p],w=m&&nS(f,m)?m:f;return this.previousViews[p]=
w,[f.id,w]}),d={...o,[kw]:"computed",views:u};return i&&(d.manualLayouts=n),a.debug(`unsafeSyncComputeModel${i?" with manual layouts":""}: completed`),qi.create(d)})}async computeModel(e,n){e=this.projects.ensureProjectId(e);const r=Gs.getChild(e),i=lv();return await this.mutex.read(async()=>{n?.isCancellationRequested&&await mn(n);const s=this.projects.getProject(e),a=await this.manualLayouts.read(s),o=this.unsafeSyncComputeModel(e,a);return o===qi.EMPTY?r.debug("computeModel returned EMPTY"):i.
ms>10&&r.debug(`computeModel completed in ${i.pretty}`),o})}onModelParsed(e){return this.listeners.push(e),ho.create(()=>{const n=this.listeners.indexOf(e);n>=0&&this.listeners.splice(n,1)})}clearCache(){Gs.debug("clearCache"),this.cache.clear(),this.previousViews={}}documents(e){return this.parser.documents(e).toArray()}notifyListeners(e){for(const n of this.listeners)try{n(e)}catch(r){Gs.warn(rt(r))}}}function vce(t,e){return`computed-view-${t}-${e}`}const{findNodeForKeyword:pw,findNodeForProperty:Ks}=ob,
{getDocument:wce,streamAllContents:bce}=bl,Oa=Be.getChild("ModelLocator");class kce{services;fqnIndex;deploymentsIndex;langiumDocuments;parser;projects;constructor(e){this.services=e,this.fqnIndex=e.likec4.FqnIndex,this.deploymentsIndex=e.likec4.DeploymentsIndex,this.langiumDocuments=e.shared.workspace.LangiumDocuments,this.parser=e.likec4.ModelParser,this.projects=e.shared.workspace.ProjectsManager}documents(e){return this.parser.documents(e)}getParsedElement(...e){let n,r;if(e.length===2?(n=e[0],
r=e[1]):(n=e[0],r=fa(n)?this.projects.ensureProjectId():wn(n)),fa(n)){const s=n,a=this.fqnIndex.byFqn(r,s).head();if(!a)return null;const o=this.langiumDocuments.getDocument(a.documentUri);return o?this.parser.parse(o).c4Elements.find(l=>l.id===s)??null:null}const i=this.fqnIndex.getFqn(n);return this.parser.parse(wce(n)).c4Elements.find(s=>s.id===i)??null}locateElement(e,n){let[r,i]=Fq(e);r??=this.projects.ensureProjectId(n);const s=this.fqnIndex.byFqn(r,i).head(),a=s?.nameSegment??s?.selectionSegment;
return!s||!a?null:{uri:s.documentUri.toString(),range:a.range}}locateDeploymentElement(e,n){const r=this.projects.ensureProjectId(n),i=e,s=this.deploymentsIndex.byFqn(r,i).head(),a=s?.nameSegment??s?.selectionSegment;return!s||!a?null:{uri:s.documentUri.toString(),range:a.range}}locateRelation(e,n){const r=this.projects.ensureProjectId(n);for(const i of this.documents(r)){const s=i.c4Relations.find(l=>l.id===e)??i.c4DeploymentRelations.find(l=>l.id===e);if(!s)continue;const a=this.services.workspace.
AstNodeLocator.getAstNode(i.parseResult.value,s.astPath);if(!Qi(a)&&!Si(a))continue;let o=a.kind?Ks(a.$cstNode,"kind"):void 0;if(o??=a.dotKind?Ks(a.$cstNode,"dotKind"):void 0,o??=pw(a.$cstNode,"->"),o??=Ks(a.$cstNode,"title"),o??=Ks(a.$cstNode,"target"),o??=a.$cstNode,!!o)return{uri:i.uri.toString(),range:{start:o.range.start,end:o.range.start}}}return null}locateViewAst(e,n){const r=this.projects.ensureProjectId(n);for(const i of this.documents(r)){const s=i.c4Views.find(o=>o.id===e);if(!s)continue;
const a=this.services.workspace.AstNodeLocator.getAstNode(i.parseResult.value,s.astPath);if(b_(a))return{doc:i,view:s,viewAst:a}}return null}locateView(e,n){const r=this.locateViewAst(e,n);if(!r)return null;const i=r.viewAst;let s=i.name?Ks(i.$cstNode,"name"):void 0;return s??=pw(i.$cstNode,"view"),s??=i.$cstNode,s?{uri:r.doc.uri.toString(),range:{start:s.range.start,end:s.range.start}}:null}async locateDocumentTags(e,n){const r=this.langiumDocuments.getDocument(e);if(!r||!ns(r))return[];r.state<
Ve.Validated&&(Oa.debug(`Waiting for document ${r.uri.path} to be Validated`),await this.services.shared.workspace.DocumentBuilder.waitUntil(Ve.Validated,r.uri,n));const i=wn(r);Oa.debug(`locate document tags for ${r.uri.path} in project ${i}`);try{const s=new Pj(this.documents(i).toArray()).tags;Oa.debug("Assigned colors to tags",{tagSpecs:s});const a=at(bce(r.parseResult.value),Pw(o=>Ff(o)||RN(o)),fF(),Rs(o=>{let l,c;try{Ff(o)?(l=o.name,c=o.$cstNode):(l=o.tag.$refText,c=o.tag.$refNode);const u=s[l];
return An(u,`Tag ${l} not found in merged specification`),An(c,`Tag ${l} does not have a $cstNode`),{name:l,color:u.color,range:c.range,isSpecification:Ff(o)}}catch(u){return Oa.warn(`Fail on tag ${l}`,{err:u}),[]}}));return Oa.debug(`Found ${a.length} tags in document ${r.uri.path}`),a}catch(s){return Oa.warn(rt(s)),[]}}locateDynamicViewStep(e){const{doc:n,viewAst:r}=this.locateViewAst(e.view,e.projectId)??{};if(!n||!r)return null;if(!T_(r)||!r.body)return Oa.warn(`View ${e.view} is not a dynam\
ic view`),null;const i=this.services.workspace.AstNodeLocator.getAstNodePath(r.body)+e.astPath,s=this.services.workspace.AstNodeLocator.getAstNode(n.parseResult.value,i);if(!s||!lg(s))return Oa.warn(`Failed to locate dynamic view step ${i} in view ${e.view}`),null;let a=s.kind?Ks(s.$cstNode,"kind"):void 0;return a??=s.dotKind?Ks(s.$cstNode,"dotKind"):void 0,a??=pw(s.$cstNode,"->"),a??=pw(s.$cstNode,"<-"),a??=Ks(s.$cstNode,"title"),a??=Ks(s.$cstNode,"target"),a??=s.$cstNode,a?{uri:n.uri.toString(),
range:{start:a.range.start,end:a.range.start}}:null}}function Cj(t){const e=t.match(/^[ \t]*(?=\S)/gm);if(!e)return t;let n=Number.POSITIVE_INFINITY;for(const r of e)n=Math.min(n,r.length);return n===0||n===Number.POSITIVE_INFINITY?t:t.replace(new RegExp(`^[ \\t]{${n}}`,"gm"),"")}function h$(t){const e=t.replace(/^(?:[ \t]*\r?\n)+|(?:\r?\n[ \t]*)+$/g,"");return Cj(e)}const sl=["this","it","self","super","likec4lib","global"];function Et(t){return async function(e,n,r){try{const i=t(e,n,r);q3(i)&&
await i;return}catch(i){const s=i instanceof Error?i.message:String(i);n("error",`Validation failed: ${s}`,{node:e}),Be.debug(`Validation failed: ${s}`,{error:i})}}}const{getDocument:_ce}=bl,Rce=t=>{const e=t.likec4.DeploymentsIndex,n=t.references.NameProvider;return Et((r,i)=>{const s=n.getName(r);if(!s){i("error","DeploymentNode must be named",{node:r});return}const a=di(n.getNameNode(r),"name CstNode not found").range;sl.includes(s)&&i("error",`Reserved word: ${s}`,{node:r,range:a});const o=wn(
r),l=e.getFqn(r);e.byFqn(o,l).limit(2).toArray().length>1&&i("error",`Duplicate node name "${l}"`,{node:r,range:a})})},Sce=t=>{const e=t.likec4.DeploymentsIndex,n=t.references.NameProvider;return Et((r,i)=>{const s=n.getName(r);if(!s){i("error","Deployed instance must be named, unique inside node",{node:r});return}const a=di(n.getNameNode(r),"name CstNode not found").range;sl.includes(s)&&i("error",`Reserved word: ${s}`,{node:r,range:a});const o=wn(r),l=e.getFqn(r);e.byFqn(o,l).limit(2).toArray().
length>1&&i("error",`Duplicate instance name "${l}"`,{node:r,range:a})})},$ce=t=>{const e=t.likec4.ModelParser;return Et((n,r)=>{if(!n.target?.value?.ref){let l=n.target?.$cstNode?.text??"";r("error",`DeploymentRelation target '${l}' not resolved`,{node:n,property:"target"});return}const i=_ce(n),s=e.forDocument(i);let a;try{a=s._resolveDeploymentRelationSource(n)}catch(l){Be.warn(rt(l)),r("error","DeploymentRelation source not resolved",{node:n,property:"source"});return}if(Vt.isImportRef(a)){r(
"error","DeploymentRelation cannot refer imported model (not implemented yet)",{node:n,property:"source"});return}if(Vt.isModelRef(a)){r("error","DeploymentRelation must refer deployment element",{node:n,property:"source"});return}const o=s.parseFqnRef(n.target);if(Vt.isImportRef(o)){r("error","DeploymentRelation cannot refer imported model (not implemented yet)",{node:n,property:"target"});return}if(Vt.isModelRef(o)){r("error","DeploymentRelation must refer deployment element",{node:n,property:"\
target"});return}e0(a.deployment,o.deployment)&&r("error","Invalid parent-child relationship",{node:n})})},Tce=t=>Et((e,n)=>{const r=e.deploymentNode.value.ref;(!r||!ur(r))&&n("error","ExtendDeployment allows only DeploymentNode",{node:e,property:"deploymentNode"})}),Ece=t=>{const e=t.likec4.FqnIndex;return Et((n,r)=>{const i=xa(n.source),s=i&&e.getFqn(i);s||r("error","Source not found (not parsed/indexed yet)",{node:n,property:"source"});const a=xa(n.target),o=a&&e.getFqn(a);o||r("error","Targe\
t not found (not parsed/indexed yet)",{node:n,property:"target"}),s&&o&&(Rw(s,o)||Rw(o,s))&&r("error","Invalid parent-child relationship",{node:n})})},Pce=t=>{const e=t.likec4.FqnIndex;return Et((n,r)=>{const i=n.source;dp(i)&&i.isBackward&&r("error","Invalid chain after backward step",{node:n});const s=xa(n.target);s&&e.getFqn(s)||r("error","Target not found (not parsed/indexed yet)",{node:n,property:"target"})})},Cce=t=>Et((e,n)=>{if(Nt(e.value)||e.value!=="diagram"&&e.value!=="sequence"){n("e\
rror",'Invalid display variant: "diagram" or "sequence" are allowed',{node:e,property:"value"});return}pi(e,Ag)||n("error","Display mode can be defined only inside dynamic view",{node:e})}),{getDocument:xce}=bl,Ace=t=>{const e=t.likec4.FqnIndex,n=t.workspace.AstNodeLocator;return Et((r,i)=>{const s=e.getFqn(r);if(!s){i("error","Not indexed element",{node:r,property:"name"});return}sl.includes(r.name)&&i("error",`Reserved word: ${r.name}`,{node:r,property:"name"});const a=xce(r),o=a.uri,l=n.getAstNodePath(
r),c=e.byFqn(wn(a),s).filter(u=>u.documentUri!==o||u.path!==l).head();if(c){const u=c.documentUri!==o;i("error",`Duplicate element name ${r.name!==s?r.name+" ("+s+")":r.name}`,{node:r,property:"name",...u&&{relatedInformation:[{location:{range:c.nameSegment?.range??c.selectionSegment?.range,uri:c.documentUri.toString()},message:"conflicting element"}]}})}})},Ice=t=>Et((e,n)=>{Ose(e.modelElement)&&n("error","Only model elements allowed here",{node:e,property:"modelElement"})}),{getDocument:Nce}=bl,
Dce=t=>{const e=t.shared.workspace.ProjectsManager;return Et((n,r)=>{const i=Nce(n),s=wn(i);if(n.project===s){r("error","Imported project cannot be the same as the current project",{node:n,property:"project"});return}if(!e.all.includes(n.project)){r("error","Imported project not found",{node:n,property:"project"});return}})},Oce=t=>Et((e,n)=>{const r=parseFloat(e.value);(isNaN(r)||r<0||r>100)&&n("warning","Value ignored, must be between 0% and 100%",{node:e,property:"value"})}),Lce=t=>(e,n)=>{const r=e.
$container;r.props.some(i=>Do(i)&&i!==e)&&n("error","Icon must be defined once",{node:e}),Xd(r)&&Dg(r.$container)&&r.$container.props.some(i=>Do(i))&&n("warning","Redundant as icon defined on element",{node:e}),e.value?.startsWith("file://")&&n("error","Icon URI must not start with file://",{node:e,property:"value"})},Mce=t=>(e,n)=>{pi(e,lg)||n("error","Notes can be defined only inside dynamic view",{node:e})},jce=t=>(e,n)=>{if(e.$type==="HexColor"){if(e.hex===void 0||fa(e.hex)&&!e.hex.match(/^[a-fA-F0-9]+$/)){
n("error","Invalid HEX",{node:e,property:"hex"});return}const r=Zi(e.hex)?e.hex.toString().length:e.hex.length;r!==6&&r!==3&&r!==8&&n("error",`Invalid value "${e.$cstNode?.text}", must be 3, 6 or 8 characters long`,{node:e,property:"hex"});return}if(e.$type==="RGBAColor"){if((!Zi(e.red)||e.red<0||e.red>255)&&n("error","Invalid value, must be between 0 and 255",{node:e,property:"red"}),(!Zi(e.green)||e.green<0||e.green>255)&&n("error","Invalid value, must be between 0 and 255",{node:e,property:"g\
reen"}),(!Zi(e.blue)||e.blue<0||e.blue>255)&&n("error","Invalid value, must be between 0 and 255",{node:e,property:"blue"}),Zi(e.alpha)&&(e.alpha<0||e.alpha>1)&&n("error","Invalid value, must be between 0 and 1",{node:e,property:"alpha"}),fa(e.alpha)){const r=parseFloat(e.alpha);(r<0||r>100)&&n("error","Invalid value, must be between 0% and 100%",{node:e,property:"alpha"})}return}ht(e)};let xj=null,Aj=null;const qce=t=>t.map(e=>{const n=(e.c4Relations??[]).map(r=>ss("extend-relation",Vt.flatten(
r.source),Vt.flatten(r.target),r.kind??"default",r.title??"")).sort().join(",");return`${e.uri.toString()}:${n}`}).join("|"),Fce=t=>{const e=t.likec4.ModelParser;return Et((n,r)=>{const i=e.forDocument($t(n)),s=Vp(()=>i._resolveRelationSource(n));if(!s){r("error","Source not resolved",{node:n,property:"source"});return}const a=Vp(()=>i.parseFqnRef(n.target));if(!a){r("error","Target not resolved",{node:n,property:"target"});return}Vt.isImportRef(s)&&(Vt.isImportRef(a)?r("warning","Relationship b\
etween imported elements may not be visible in origin projects",{node:n}):r("warning","Relationship from imported element to local element may not be visible in origin project",{node:n,property:"source"})),e0(Vt.flatten(s),Vt.flatten(a))&&r("error","Invalid parent-child relationship",{node:n})})},zce=t=>Et((e,n)=>{e.$container.tags?.values&&e.tags?.values&&n("error","Relation cannot have tags in both header and body",{node:e.tags})}),Uce=t=>{const e=t.likec4.ModelParser;return Et((n,r)=>{const i=e.
forDocument($t(n)),s=Vp(()=>i.parseFqnRef(n.source));if(!s){r("error","Source not resolved",{node:n,property:"source"});return}const a=Vp(()=>i.parseFqnRef(n.target));if(!a){r("error","Target not resolved",{node:n,property:"target"});return}if(!Vt.isModelRef(s)&&!Vt.isImportRef(s)){r("error","Source must reference a model element",{node:n,property:"source"});return}if(!Vt.isModelRef(a)&&!Vt.isImportRef(a)){r("error","Target must reference a model element",{node:n,property:"target"});return}const o=(n.
kind??n.dotKind?.kind)?.ref?.name??"default",{title:l=""}=i.parseBaseProps({},{title:n.title}),c=ss("extend-relation",Vt.flatten(s),Vt.flatten(a),o,l),u=t.shared.workspace.LangiumDocuments.all.toArray().filter(Pie),d=qce(u);if(d!==Aj){const f=new Set;for(const p of u)for(const m of p.c4Relations??[]){const w=ss("extend-relation",Vt.flatten(m.source),Vt.flatten(m.target),m.kind??"default",m.title??"");f.add(w)}xj=f,Aj=d}(xj?.has(c)??!1)||r("warning","This extend does not match any relation (by so\
urce, kind, target, title)",{node:n})})},Hce=t=>Et((e,n)=>{e.$containerIndex&&e.$containerIndex>0&&n("warning","Prefer one specification per document",{node:e,property:"name"})}),Vce=t=>Et((e,n)=>{e.$containerIndex&&e.$containerIndex>0&&n("warning","Prefer one model per document",{node:e,property:"name"})}),Bce=t=>Et((e,n)=>{e.$containerIndex&&e.$containerIndex>0&&n("warning","Prefer one global block per document",{node:e,property:"name"})}),Wce=t=>{const e=t.shared.workspace.IndexManager;return Et(
(n,r)=>{sl.includes(n.name)&&r("error",`Reserved word: ${n.name}`,{node:n,property:"name"});const i=wn(n),s=e.projectElements(i,js).filter(a=>a.name===n.name&&a.node!==n).head();if(s){const a=s.documentUri!==$t(n).uri;r("error",`Duplicate element kind '${n.name}'`,{node:n,property:"name",...a&&{relatedInformation:[{location:{range:s.nameSegment.range,uri:s.documentUri.toString()},message:"conflicting definition"}]}})}})},Gce=t=>{const e=t.shared.workspace.IndexManager;return Et((n,r)=>{sl.includes(
n.name)&&r("error",`Reserved word: ${n.name}`,{node:n,property:"name"});const i=wn(n),s=e.projectElements(i,Ms).filter(a=>a.name===n.name&&a.node!==n).head();if(s){const a=s.documentUri!==$t(n).uri;r("error",`Duplicate deploymentNode kind '${n.name}'`,{node:n,property:"name",...a&&{relatedInformation:[{location:{range:s.nameSegment.range,uri:s.documentUri.toString()},message:"conflicting definition"}]}})}})},Kce=t=>{const e=t.shared.workspace.IndexManager;return Et((n,r)=>{const i=n.name,s=wn(n),
a=e.projectElements(s,wa).filter(o=>o.name===i&&o.node!==n).head();if(a){const o=a.documentUri!==$t(n).uri;r("error",`Duplicate tag '${n.name}'`,{node:n,property:"name",...o&&{relatedInformation:[{location:{range:a.nameSegment.range,uri:a.documentUri.toString()},message:"conflicting definition"}]}})}})},Zce=t=>{const e=t.shared.workspace.IndexManager;return Et((n,r)=>{sl.includes(n.name)&&r("error",`Reserved word: ${n.name}`,{node:n,property:"name"});const i=wn(n);e.projectElements(i,va).filter(
s=>s.name===n.name).limit(2).count()>1&&r("error",`Duplicate RelationshipKind '${n.name}'`,{node:n,property:"name"})})},Ij=t=>{const e=t.shared.workspace.IndexManager;return Et((n,r)=>{const i=wn(n),s=e.projectElements(i,Yl),a=e.projectElements(i,Jl);s.concat(a).filter(o=>o.name===n.name).limit(2).count()>1&&r("error",`Duplicate GlobalPredicateGroup or GlobalDynamicPredicateGroup name '${n.name}'`,{node:n,property:"name"})})},Jce=t=>{const e=t.shared.workspace.IndexManager;return Et((n,r)=>{const i=wn(
n);e.projectElements(i,of).filter(s=>s.name===n.name).limit(2).count()>1&&r("error",`Duplicate GlobalStyleId name '${n.name}'`,{node:n,property:"name"})})},Yce=t=>{const e=t.shared.workspace.IndexManager;return Et((n,r)=>{const i=Wc(n.$cstNode,["BLOCK_COMMENT"]);if(i&&fw(i.text)&&r("warning","Migrate to the new manual layout snapshots (run LikeC4: Migrate manual layouts)",{node:n,range:i.range,code:"manual-layout-v1"}),!n.name)return;sl.includes(n.name)&&r("error",`Reserved word: ${n.name}`,{node:n,
property:"name"});const s=wn(n);e.projectElements(s,Eo).filter(a=>a.name===n.name).limit(2).count()>1&&r("error",`Duplicate view '${n.name}'`,{node:n,property:"name"})})};function Xce(t){const e=[];let n=t;for(;n;)n.value&&e.push(n.value),n=n.prev;return e.reverse()}const Qce=t=>Et((e,n)=>{const r=Xce(e.targets);r.length<2&&e.value==="same"&&n("warning","Rank rule should have at least 2 targets",{node:e,property:"targets"});const i=r.filter(Wg),s=i[0]?.ref?.parent;for(let a=1;a<i.length;a++){const o=i[a];
e.value==="same"&&!Nj(s,o?.ref?.parent)&&n("error","All targets must have the same parent rank same",{node:e,property:"targets"})}});function Nj(t,e){return!t&&!e?!0:!t||!e||t.value.ref!==e.value.ref?!1:Nj(t.parent,e.parent)}const eue=t=>{const e=t.likec4.ModelParser;return Et((n,r)=>{const i=tv(n);if(i?.$type!=="DynamicViewIncludePredicate"&&i?.isInclude!==!0){r("error",'Invalid usage inside "exclude"',{node:n});return}const s=i.$type==="DynamicViewIncludePredicate",a=e.forDocument($t(i));let o=gr.
unwrap(a.parseFqnExprWith(n).custom.expr);switch(!0){case(gr.isWildcard(o)&&s):case(gr.isElementKindExpr(o)&&s):case(gr.isElementTagExpr(o)&&s):{r("warning","Predicate is ignored, as not supported in dynamic views",{node:n});return}case gr.isWildcard(o):case gr.isModelRef(o):case gr.isDeploymentRef(o):return;case gr.isElementKindExpr(o):case gr.isElementTagExpr(o):r("error","Invalid target (expect reference to specific element)",{node:n,property:"subject"});return;default:ta(o)}})},tue=t=>{const e=t.
likec4.ModelParser;return Et((n,r)=>{const i=e.forDocument($t(n)).parseFqnRefExpr(n),s=tv(n),a=Iie(n)&&!pi(n,o=>Hd(o)||pc(o));if(s?.$type==="DeploymentViewRulePredicate"||a){if(!pi(n,hg)){if(gr.isModelRef(i)){r("error","Deployment view predicate must reference deployment model",{node:n});return}if(gr.isDeploymentRef(i)&&Jn.isInsideInstanceRef(i.ref)){r("error","Must reference deployment nodes or instances, but not internals",{node:n});return}}ke(n.selector)&&!ur(n.ref.value?.ref)&&r("warning",`S\
elector '${n.selector}' applies to deployment nodes only, ignored here`,{node:n,property:"selector"});return}if(s?.$type==="DynamicViewIncludePredicate")switch(!0){case gr.isElementKindExpr(i):case gr.isElementTagExpr(i):case gr.isWildcard(i):{r("warning","Predicate is ignored, as not supported in dynamic views",{node:n});return}}})},nue=t=>Et((e,n)=>{if(e.to.$type==="WildcardExpression"&&!pN(e.$container)){const r=xr(e,Lg);Gt(r?.viewOf)&&n("warning","Predicate is ignored as it concerns all rela\
tionships",{node:e})}}),rue=t=>Et((e,n)=>{if(tv(e)?.$type==="ViewRulePredicate"&&e.$container.$type!=="DirectedRelationExpr"&&e.from.$type==="WildcardExpression"){const r=xr(e,Lg);r&&Gt(r.viewOf)&&n("warning","Predicate is ignored as it concerns all relationships",{node:e})}}),iue=t=>{const e=t.likec4.ModelParser;return Et((n,r)=>{const i=xr(n,Wl);if(!i||i.isInclude!==!0)return;const s=$t(n),a=e.forDocument(s);let o=wh.unwrap(a.parseRelationExpr(n));const l="Model reference is allowed in exclude\
 predicate only";if(wh.isDirect(o)){(Sw.isModelRef(o.source)||Sw.isModelRef(o.target))&&r("error",l,{node:n});return}let c;if(wh.isIncoming(o)?c=o.incoming:wh.isOutgoing(o)?c=o.outgoing:c=o.inout,Sw.isModelRef(c)){r("error",l,{node:n});return}})},sue=t=>Et((e,n)=>{const r=tv(e);if(!(!r||r.$type=="DynamicViewIncludePredicate")&&!r.isInclude){n("error",'Invalid usage inside "exclude"',{node:e});return}});class aue extends WC{services;constructor(e){super(e),this.services=e}async validateDocument(e,n,r){
return this.services.shared.workspace.ProjectsManager.isExcluded(e)?[]:await super.validateDocument(e,n,r)}}function oue(t){return e=>t.some(n=>n(e))}const lue=oue([ec,Xi,L_,af,sf,Ql,No,Vg,z_,KI,hg,P_,K_,dp,a8,Wl,l8,hg,Wg,f8,R_,SN,p8,h_,b_,S_,$r,ur,Si,XI,E_,Yi,Qi,o8,QI,ey,Vn,x_,Io,ga,Zl,lc,uc,ac,qf,ly,kN,s8]),cue=t=>{let e=t;for(;e&&!hN(e);){if(lue(e))return e;e=e.$container}};function uue(t){const e=t.state>=Ve.Validated?t.diagnostics?.filter(r=>r.severity===so.Error)??[]:[],n=new WeakSet;for(const{
node:r}of e){if(Gt(r)||n.has(r))continue;n.add(r);const i=cue(r);i&&n.add(i)}return{isValid:r=>!n.has(r),invalidNodes:n}}function due(t){Be.debug("registerValidationChecks"),t.validation.ValidationRegistry.register({DeployedInstance:Sce(t),DeploymentNodeKind:Gce(t),DeploymentNode:Rce(t),DeploymentRelation:$ce(t),ExtendDeployment:Tce(),ExtendRelation:Uce(t),FqnRefExpr:tue(t),RelationExpr:iue(t),NotesProperty:Mce(),OpacityProperty:Oce(),IconProperty:Lce(),SpecificationRule:Hce(),Model:Vce(),Globals:Bce(),
GlobalPredicateGroup:Ij(t),GlobalDynamicPredicateGroup:Ij(t),GlobalStyleId:Jce(t),DynamicStepSingle:Ece(t),DynamicStepChain:Pce(t),LikeC4View:Yce(t),Element:Ace(t),ElementRef:Ice(),ElementKind:Wce(t),Relation:Fce(t),RelationBody:zce(),Tag:Kce(t),FqnExprWith:eue(t),RelationExprWith:sue(),RelationshipKind:Zce(t),IncomingRelationExpr:nue(),OutgoingRelationExpr:rue(),ImportsFromPoject:Dce(t),ColorLiteral:jce(),DynamicViewDisplayVariantProperty:Cce(),ViewRuleRank:Qce()});const e=t.shared.lsp.Connection;
e&&f0(()=>{t.shared.workspace.DocumentBuilder.onUpdate((n,r)=>{for(const i of r)Be.debug(`clear diagnostics for deleted ${i.path}`),e.sendDiagnostics({uri:i.toString(),diagnostics:[]}).catch(s=>Be.error(rt(s)))})})}const Lc=Be.getChild("BaseParser");function al(t){if(t==null)return;const e=Pn(t);return fa(e)?e.split(`
`).join(" "):"md"in e?{md:e.md.split(`
`).join("  ")}:{txt:e.txt.split(`
`).join(" ")}}function Pn(t){if(t!=null)switch(!0){case fa(t):return h$(t).trim();case(Xg(t)&&ke(t.markdown)):return{md:h$(t.markdown).trim()};case(Xg(t)&&ke(t.text)):return{txt:h$(t.text).trim()};default:return}}class fue{services;doc;isValid;constructor(e,n){this.services=e,this.doc=n,this.isValid=uue(n).isValid}get project(){return zq(this,"project",()=>this.services.shared.workspace.ProjectsManager.getProject(this.doc))}resolveFqn(e){if(Xi(e)){const n=wn(e),r=this.resolveFqn(di(e.imported.ref,
`FqnRef is empty of imported: ${e.$cstNode?.text}`));return this.doc.c4Imports.set(n,r),Uq(n,r)}return Io(e)?Jo(e.element):ga(e)?Jo(e.deploymentNode):sg(e)?this.services.likec4.DeploymentsIndex.getFqn(e):this.services.likec4.FqnIndex.getFqn(e)}getAstNodePath(e){return this.services.workspace.AstNodeLocator.getAstNodePath(e)}getMetadata(e){if(!e||!this.isValid(e)||Nt(e.props))return;const n=a=>{if(Xg(a)){const o=Pn(a);if(!o)return[];if(typeof o=="string")return ke(o)?[o]:[];{const l=o.md||o.txt;return ke(
l)?[l]:[]}}else if(P8(a))return a.values.map(o=>Pn(o)).map(o=>typeof o=="string"?o:o.md||o.txt).filter(ke);return[]},r=at(e.props,Rs(a=>n(a.value).map(o=>[a.key,o])),nt(([a,o])=>ke(o)));if(Nt(r))return;const i=at(r,zc(([a])=>a),yl(a=>a.map(([o,l])=>l))),s={};for(const[a,o]of Object.entries(i))o&&o.length>0&&(s[a]=o.length===1?o[0]:o);return Nt(s)?void 0:s}parseMarkdownOrString(e){if(Xg(e))return Pn(e)}convertTags(e){return this.parseTags(e)}parseTags(e){let n=e?.tags;if(!n)return null;let r=[];for(;n;){
try{if(this.isValid(n)){const i=n.values.map(s=>s.tag.ref?.name).filter(ke);i.length>0&&r.push(...i)}}catch{}n=n.prev}return Mn(r)?Ss(r):null}convertLinks(e){return this.parseLinks(e)}parseLinks(e){if(!(!e?.props||e.props.length===0))return at(e.props,nt(mf),Rs(n=>{if(!this.isValid(n))return[];const r=n.value;if(ke(r)){const i=ke(n.title)?al(n.title):void 0,s=this.services.lsp.DocumentLinkProvider.relativeLink(this.doc,r);return{url:r,...i&&{title:i},...s&&s!==r&&{relative:s}}}return[]}))}parseIconProperty(e){
if(!e||!this.isValid(e))return;const{libicon:n,value:r}=e;switch(!0){case!!n:{const i=n.ref?.name;if(!i){Lc.warn(`Library icon ${n.$refText} is not a valid library icon`);return}return i}case(r&&r==="none"):return r;case(r&&Pc(r)):{if(r.startsWith("file:")){Lc.warn(`Icon property '${r}' used the 'file' protocol which is not supported`);return}return r}case(r&&r.startsWith("@")):return this.parseImageAlias(r);case(r&&iv(r)):return Go(this.doc.uri.toString(),"../",r);case(r&&Up(r)):return Hp(this.
project.folderUri.toString(),r);default:{Lc.warn(`Icon property '${r}' is not a valid URL, library icon, image alias or 'none'`);return}}}parseImageAlias(e){const n=e.indexOf("/"),r=n>0?e.substring(0,n):e,i=n>0?e.substring(n+1):"",s={"@":"./images",...this.project.config.imageAliases}[r];if(!s){Lc.warn(`Image alias "${r}" not found in project configuration`);return}const a=i?Hp(s,i):s;return Hp(this.project.folderUri.toString(),a)}parseColorLiteral(e){if(this.isValid(e)){if(S8(e))return`#${e.hex}`;
if(N8(e)){let n=Zi(e.alpha)?e.alpha:void 0;return fa(e.alpha)&&(n=_L(e.alpha)/100),n!==void 0?`rgba(${e.red},${e.green},${e.blue},${n})`:`rgb(${e.red},${e.green},${e.blue})`}ht(e)}}parseElementStyle(e){if(!e)return{};if(j3(e)){const n=this.parseStyleProps(e.find(Xd)?.props);try{const r=this.parseIconProperty(e.find(Do));r&&(n.icon=r)}catch(r){Lc.warn("Failed to parse icon property on element",{err:r})}return n}return this.parseStyleProps(e.props)}parseStyleProps(e){const n={};if(!e||e.length===0)
return n;for(const r of e)if(this.isValid(r))try{switch(!0){case _g(r):{ke(r.value)&&(n.border=r.value);break}case Co(r):{const i=zp(r);ke(i)&&(n.color=i);break}case ay(r):{ke(r.value)&&(n.shape=r.value);break}case Do(r):{const i=this.parseIconProperty(r);ke(i)&&(n.icon=i);break}case ty(r):{n.opacity=RL(r);break}case M_(r):{n.multiple=_x(r.value)?r.value:!1;break}case U_(r):{ke(r.value)&&(n.size=Tc(r));break}case q_(r):{ke(r.value)&&(n.padding=Tc(r));break}case V_(r):{ke(r.value)&&(n.textSize=Tc(
r));break}default:ht(r)}}catch(i){Lc.warn("Failed to parse style property",{err:i})}return ml(n)}parseBaseProps(e,n){const r=Pn(n?.title??rs(e.title)),i=n?.description?{txt:Pn(n.description)}:this.parseMarkdownOrString(e.description),s=n?.summary?{txt:Pn(n.summary)}:this.parseMarkdownOrString(e.summary),a=al(n?.technology)??Pn(rs(e.technology));return ml({title:r,summary:s,description:i,technology:a})}}const pue=Be.getChild("DeploymentModelParser");function*hue(t){const e=t0.from(t.parseResult.value.
deployments.flatMap(i=>i.elements)),n=[];let r;for(;r=e.shift();){if(Si(r)){n.push(r);continue}if(r.body&&r.body.elements.length>0)for(const i of r.body.elements)e.push(i);yield r}yield*n}function mue(t){return class extends t{parseDeployment(){const e=this.doc;for(const n of hue(e))try{switch(!0){case Si(n):{this.isValid(n)&&e.c4DeploymentRelations.push(this.parseDeploymentRelation(n));break}case $r(n):e.c4Deployments.push(this.parseDeployedInstance(n));break;case ur(n):{e.c4Deployments.push(this.
parseDeploymentNode(n));break}case ga(n):{const r=this.parseExtendDeployment(n);r&&e.c4ExtendDeployments.push(r);break}default:ht(n)}}catch(r){pue.warn(rt(r))}}parseDeploymentNode(e){const n=this.isValid,r=this.resolveFqn(e),i=di(e.kind.ref,"DeploymentKind not resolved").name,s=this.convertTags(e.body),a=this.parseElementStyle(e.body?.props),o=this.getMetadata(e.body?.props.find(Yi)),l=at(e.body?.props??[],nt(n),nt(Jd),ii(f=>[f.key,f.value])),{title:c,...u}=this.parseBaseProps(l,{title:e.title,summary:e.
summary}),d=this.convertLinks(e.body);return ml({id:r,kind:i,title:c??Hq(r),...u,tags:s??void 0,...d&&Mn(d)&&{links:d},style:a,metadata:o})}parseDeployedInstance(e){const n=this.isValid,r=this.resolveFqn(e),i=this.parseFqnRef(e.target.modelElement);Ke(Vt.isModelRef(i)||Vt.isImportRef(i),"Target must be a model reference");const s=this.convertTags(e.body),a=this.parseElementStyle(e.body?.props),o=this.getMetadata(e.body?.props.find(Yi)),l=at(e.body?.props??[],nt(n),nt(Jd),ii(d=>[d.key,d.value])),
c=this.parseBaseProps(l,{title:e.title,summary:e.summary}),u=this.convertLinks(e.body);return ml({id:r,element:i,tags:s??void 0,...u&&Mn(u)&&{links:u},...c,style:a,metadata:o})}parseExtendDeployment(e){if(!this.isValid(e))return null;const n=this.resolveFqn(e),r=this.parseTags(e.body),i=this.getMetadata(e.body?.props.find(Yi)),s=this.getAstNodePath(e),a=this.parseLinks(e.body)??[];return!r&&Nt(i??{})&&Nt(a)?null:{id:n,astPath:s,...i&&{metadata:i},tags:r,links:Mn(a)?a:null}}_resolveDeploymentRelationSource(e){
if(Un(e.source))return this.parseFqnRef(e.source);if(e.$container.$type==="DeploymentNodeBody"||e.$container.$type==="DeployedInstanceBody")return{deployment:this.resolveFqn(e.$container.$container)};throw new Error("RelationRefError: Invalid container for sourceless relation")}parseDeploymentRelation(e){const n=this.isValid,r=this.getAstNodePath(e),i=this._resolveDeploymentRelationSource(e);Ke(Vt.isDeploymentRef(i),"Invalid source for deployment relation");const s=this.parseFqnRef(e.target);Ke(
Vt.isDeploymentRef(s),"Invalid target for deployment relation");const a=this.convertTags(e)??this.convertTags(e.body),o=this.convertLinks(e.body),l=(e.kind??e.dotKind?.kind)?.ref?.name,c=this.getMetadata(e.body?.props.find(Yi)),u=at(e.body?.props??[],nt(If),nt(w=>ke(w.value)),ii(w=>[w.key,w.value])),d=at(e.body?.props??[],nt(xf),ql())?.value.view.ref?.name,f=this.parseBaseProps(u,{title:e.title}),p=e.body?.props.find(sy),m=ss("deployment",r,i.deployment,s.deployment);return ml({id:m,source:i,target:s,
...f,metadata:c,kind:l,tags:a??void 0,...Mn(o)&&{links:o},...pS(p?.props,n),navigateTo:d,astPath:r})}}}function gue(t){return class extends t{parseDeploymentView(e){const n=e.body;Ke(n,"DynamicElementView body is not defined");const r=n.props.filter(this.isValid),i=this.getAstNodePath(e);let s=e.name;s||(s="deployment_"+ss(this.doc.uri.toString(),i));const{title:a=null,description:o=null}=this.parseBaseProps(at(r,nt(py),ii(d=>[d.key,d.value]))),l=this.convertTags(n),c=this.convertLinks(n);Qy.writeId(
e,s);const u=p$(e);return{[hl._type]:"deployment",id:s,astPath:i,title:al(a)??null,description:o,tags:l,links:Mn(c)?c:null,rules:n.rules.flatMap(d=>{try{return this.isValid(d)?this.parseDeploymentViewRule(d):[]}catch(f){return ct(f),[]}}),...u&&{manualLayout:u}}}parseDeploymentViewRule(e){if(Wl(e))return this.parseDeploymentViewRulePredicate(e);if(Hf(e))return hS(e);if(Hd(e))return this.parseDeploymentViewRuleStyle(e);ht(e)}parseDeploymentViewRulePredicate(e){const n=[];let r=e.expr;for(;r;){try{
const i=r.value;Ki(i)&&this.isValid(i)&&n.unshift(this.parseExpressionV2(i))}catch(i){ct(i)}r=r.prev}return e.isInclude?{include:n}:{exclude:n}}parseDeploymentViewRuleStyle(e){const n=this.parseStyleProps(e.props.filter(R_)),r=Pn(rs(e.props.find(ic)?.value));return{targets:this.parseFqnExpressions(e.targets),style:n,...r&&{notation:r}}}}}const Dj=({operator:t,not:e},n)=>t.startsWith("!=")?{neq:n}:t.startsWith("=")?{eq:n}:e?{neq:n}:{eq:n};function Oj(t){return!PN(t)&&!CN(t)?null:t.participant}function uh(t){
switch(!0){case y8(t):{const e=t.value.tag.ref?.name,n=Oj(t);Ke(e,"Expected tag name");const r={tag:Dj(t,e)};return n?{participant:n,operator:r}:r}case m8(t):{const e=t.value?.ref?.name,n=Oj(t);Ke(e,"Expected kind name");const r={kind:Dj(t,e)};return n?{participant:n,operator:r}:r}case($N(t)||EN(t)):return{not:uh(t.value)};case O8(t):{const e=uh(t.left),n=uh(t.right),r=t.operator.toLowerCase();return Lj(r,e,n)}default:ht(t)}}function Lj(t,e,n){if(n===null)return e;switch(t){case"and":{const r=[r0(
e)?e.and:e,r0(n)?n.and:n].flat();return Ke(Mn(r),"Expected non-empty array"),{and:r}}case"or":{const r=[n0(e)?e.or:e,n0(n)?n.or:n].flat();return Ke(Mn(r),"Expected non-empty array"),{or:r}}default:ht(t)}}const yue=Be.getChild("ExpressionV2Parser"),vue=t=>{const e=t.$cstNode,n=e?`:${e.range.start.line+1}:${e.range.start.character+1}`:"";return`${$t(t).uri.fsPath}${n}`};function wue(t){return class extends t{parseFqnRef(e){const n=di(e.value?.ref,()=>`FqnRef "${e.$cstNode?.text}" is empty at ${vue(
e)}`);if(Xi(n)){const r={project:wn(n),model:this.resolveFqn(di(n.imported.ref,`FqnRef is empty of imported: ${n.$cstNode?.text}`))};return this.doc.c4Imports.set(r.project,r.model),r}if(Vn(n)){const r=Dse(e);if(r){const o={project:wn(r),model:this.resolveFqn(n)};return this.doc.c4Imports.set(o.project,o.model),o}const i=Nse(e);if(!i)return{model:this.resolveFqn(n)};const s=this.resolveFqn(i),a=this.resolveFqn(n);return{deployment:s,element:a}}if(sg(n))return{deployment:this.resolveFqn(n)};ht(n)}parseExpressionV2(e){
if(JI(e))return this.parseFqnExprOrWith(e);if(u8(e))return this.parseRelationExprOrWith(e);ht(e)}parseFqnExprOrWith(e){if(Vg(e))return this.parseFqnExprWith(e);if(ZI(e))return this.parseFqnExprOrWhere(e);ht(e)}parseFqnExprWith(e){const n=this.parseFqnExprOrWhere(e.subject);return(e.custom?.props??[]).reduce((r,i)=>{if(!this.isValid(i))return r;if(ey(i)){const s=i.value.view.$refText;return ke(s)&&(r.custom.navigateTo=s),r}if(Jd(i)){if(Un(i.value)&&i.key!=="summary")if(i.key==="description"){const s=this.
parseMarkdownOrString(i.value);s&&(r.custom.description=s)}else r.custom[i.key]=Pn(rs(i.value))||"";return r}if(Do(i)){const s=this.parseIconProperty(i);return Un(s)&&(r.custom[i.key]=s),r}if(Co(i)){const s=zp(i);return Un(s)&&(r.custom[i.key]=s),r}if(ay(i)||_g(i))return Un(i.value)&&(r.custom[i.key]=i.value),r;if(ty(i))return Un(i.value)&&(r.custom[i.key]=RL(i)),r;if(ic(i)){const s=ke(i.value)?Pn(rs(i.value)):void 0;return s&&(r.custom[i.key]=s),r}if(M_(i))return _x(i.value)&&(r.custom[i.key]=i.
value),r;if(U_(i)||V_(i)||q_(i))return ke(i.value)&&(r.custom[i.key]=Tc(i)),r;ht(i)},{custom:{expr:n}})}parseFqnExprOrWhere(e){if(O_(e))return this.parseFqnExprWhere(e);if(KI(e))return this.parseFqnExpr(e);ht(e)}parseFqnExprWhere(e){return Ke(!O_(e.subject),"FqnExprWhere is not allowed as subject of FqnExprWhere"),{where:{expr:this.parseFqnExpr(e.subject),condition:e.where?uh(e.where):{kind:{neq:"--always-true--"}}}}}parseFqnExpr(e){if(xN(e))return{wildcard:!0};if(cN(e))return Ke(e.kind?.ref,"El\
ementKindExpr kind is not resolved: "+e.$cstNode?.text),{elementKind:e.kind.ref.name,isEqual:e.isEqual};if(uN(e))return Ke(e.tag.tag.ref,"ElementTagExpr tag is not resolved: "+e.$cstNode?.text),{elementTag:e.tag.tag.$refText,isEqual:e.isEqual};if(Wg(e))return this.parseFqnRefExpr(e);ht(e)}parseFqnRefExpr(e){const n=this.parseFqnRef(e.ref);switch(!0){case e.selector==="._":return{ref:n,selector:"expanded"};case e.selector===".**":return{ref:n,selector:"descendants"};case e.selector===".*":return{
ref:n,selector:"children"};default:return{ref:n}}}parseFqnExpressions(e){const n=[];let r=e;for(;r;){try{Ki(r.value)&&this.isValid(r.value)&&n.push(this.parseFqnExpr(r.value))}catch(i){yue.warn(rt(i))}r=r.prev}return n.reverse()}parseRelationExprOrWith(e){if(z_(e))return this.parseRelationExprWith(e);if(c8(e))return this.parseRelationExprOrWhere(e);ht(e)}parseRelationExprWith(e){const n=this.parseRelationExprOrWhere(e.subject);return{customRelation:{...this.parseCustomRelationProperties(e.custom),
expr:n}}}parseCustomRelationProperties(e){return(e?.props??[]).reduce((n,r)=>{if(If(r)||ic(r)||j_(r)){const i=ke(r.value)?Pn(rs(r.value)):void 0;return i&&(n[r.key]=i),n}if(Md(r))return ke(r.value)&&(n[r.key]=r.value),n;if(Co(r)){const i=zp(r);return ke(i)&&(n[r.key]=i),n}if(pf(r))return ke(r.value)&&(n[r.key]=r.value),n;if(xf(r)){const i=r.value.view.ref?.name;return ke(i)&&(n[r.key]=i),n}ht(r)},{})}parseRelationExprOrWhere(e){if(F_(e))return this.parseRelationExprWhere(e);if(hg(e))return this.
parseRelationExpr(e);ht(e)}parseRelationExprWhere(e){Ke(!F_(e.subject),"RelationExprWhere is not allowed as subject of RelationExprWhere");const n=this.parseRelationExpr(e.subject),r=n.where?.expr??n,i=n.where?.condition,s=e.where?uh(e.where):null;let a;return s&&i?a=Lj("and",i,s):a=s??i??{kind:{neq:"--always-true--"}},{where:{expr:r,condition:a}}}parseRelationExpr(e){switch(e.$type){case"DirectedRelationExpr":return this.wrapInWhere({source:this.parseFqnExpr(e.source.from),target:this.parseFqnExpr(
e.target),isBidirectional:e.source.isBidirectional},this.parseInlineKindCondition(e.source));case"InOutRelationExpr":return{inout:this.parseFqnExpr(e.inout.to)};case"OutgoingRelationExpr":return this.wrapInWhere({outgoing:this.parseFqnExpr(e.from)},this.parseInlineKindCondition(e));case"IncomingRelationExpr":return{incoming:this.parseFqnExpr(e.to)};default:ht(e)}}parseInlineKindCondition(e){const n=e.kind??e.dotKind?.kind;return n?(Ke(n.ref,"Kind is not resolved: "+e.$cstNode?.text),{kind:{eq:n.
ref?.name}}):null}wrapInWhere(e,n){return n?{where:{expr:e,condition:n}}:e}}}const hw=Be.getChild("GlobalsParser");function bue(t){return class extends t{parseGlobals(){const{parseResult:e,c4Globals:n}=this.doc,r=this.isValid,i=e.value.globals.filter(r),s=i.flatMap(o=>o.predicates.filter(r));for(const o of s)try{const l=o.name;if(!ke(l))continue;if(l in n.predicates){hw.warn(`Global predicate named "${l}" is already defined`);continue}this.parseAndStoreGlobalPredicateGroupOrDynamic(o,l,n)}catch(l){
hw.warn(rt(l))}const a=i.flatMap(o=>o.styles.filter(r));for(const o of a)try{const l=o.id.name;if(!ke(l))continue;if(l in n.styles){hw.warn(`Global style named "${l}" is already defined`);continue}const c=this.parseGlobalStyleOrGroup(o);xn(c,1)&&(n.styles[l]=c)}catch(l){hw.warn(rt(l))}}parseAndStoreGlobalPredicateGroupOrDynamic(e,n,r){if(af(e)){const i=this.parseGlobalPredicateGroup(e);xn(i,1)&&(r.predicates[n]=i);return}if(sf(e)){const i=this.parseGlobalDynamicPredicateGroup(e);xn(i,1)&&(r.dynamicPredicates[n]=
i);return}ht(e)}parseGlobalPredicateGroup(e){return e.predicates.map(n=>this.parseViewRulePredicate(n))}parseGlobalDynamicPredicateGroup(e){return e.predicates.map(n=>this.parseDynamicViewIncludePredicate(n))}parseGlobalStyleOrGroup(e){if(Ql(e))return[this.parseViewRuleStyle(e)];if(No(e))return e.styles.map(n=>this.parseViewRuleStyle(n));ht(e)}}}const kue=Be.getChild("ImportsParser");function _ue(t){return class extends t{parseImports(){const e=this.doc.parseResult.value.imports??[];for(const n of e){
const r=n.project;let i=n.imports;for(;i;){try{this.doc.c4Imports.set(r,this.resolveFqn(di(i.imported.ref,`ElementRef is empty of imported: ${i.imported.$refText}`)))}catch(s){kue.warn(rt(s))}i=i.prev}}}}}const Rue=Be.getChild("ModelParser");function*Sue(t){const e=t0.from(t.parseResult.value.models.flatMap(i=>i.elements)),n=[];let r;for(;r=e.shift();){if(Qi(r)){n.push(r);continue}if(Zl(r)){yield r;continue}if(r.body&&"elements"in r.body&&r.body.elements&&r.body.elements.length>0)for(const i of r.
body.elements)e.push(i);yield r}yield*n}function $ue(t){return class extends t{parseModel(){const e=this.doc;for(const n of Sue(e))try{if(Vn(n)){e.c4Elements.push(this.parseElement(n));continue}if(Qi(n)){this.isValid(n)&&e.c4Relations.push(this.parseRelation(n));continue}if(Io(n)){const r=this.parseExtendElement(n);r&&e.c4ExtendElements.push(r);continue}if(Zl(n)){const r=this.parseExtendRelation(n);r&&e.c4ExtendRelations.push(r);continue}ht(n)}catch(r){const i=this.getAstNodePath(n),s=rt(r),a=r instanceof
Error?r.message:String(s);Rue.warn(`Error on {eltype}: ${a}
 document: {path}
 astpath: {astPath}
${s}`,{path:e.uri.path,eltype:n.$type,astPath:i})}}parseElement(e){const n=this.isValid,r=this.resolveFqn(e),i=di(e.kind.ref,"Element kind is not resolved").name,s=this.parseTags(e.body),a=this.parseElementStyle(e.body?.props),o=this.getMetadata(e.body?.props.find(Yi)),l=this.getAstNodePath(e);let[c,u,d]=e.props??[];const f=at(e.body?.props??[],nt(n),nt(Jd),ii(v=>[v.key,v.value])),{title:p,...m}=this.parseBaseProps(f,{title:c,summary:u,technology:d}),w=this.parseLinks(e.body);return ds({id:r,kind:i,
astPath:l,title:p??e.name,metadata:o,tags:s??void 0,...w&&Mn(w)&&{links:w},...m,style:a})}parseExtendElement(e){const n=this.resolveFqn(e),r=this.parseTags(e.body),i=this.getMetadata(e.body?.props.find(Yi)),s=this.getAstNodePath(e),a=this.parseLinks(e.body)??[];return!r&&Nt(i??{})&&Nt(a)?null:ds({id:n,astPath:s,metadata:i,tags:r,links:Mn(a)?a:null})}parseExtendRelation(e){const n=this.parseFqnRef(e.source),r=this.parseFqnRef(e.target);Ke(Jn.isModelRef(n)||Jn.isImportRef(n),"Source must be a mode\
l reference"),Ke(Jn.isModelRef(r)||Jn.isImportRef(r),"Target must be a model reference");const i=this.parseTags(e.body),s=this.getMetadata(e.body?.props.find(Yi)),a=this.getAstNodePath(e),o=this.parseLinks(e.body)??[];if(!i&&Nt(s??{})&&Nt(o))return null;const l=(e.kind??e.dotKind?.kind)?.ref?.name,{title:c=""}=this.parseBaseProps({},{title:e.title}),u=ss("extend-relation",Jn.flatten(n),Jn.flatten(r),l??"default",c);return ds({id:u,astPath:a,metadata:s,tags:i,links:Mn(o)?o:null})}_resolveRelationSource(e){
if(Un(e.source)){const n=this.parseFqnRef(e.source);return Ke(Jn.isModelRef(n)||Jn.isImportRef(n),"Relation source must be a model reference"),n}if(Dg(e.$container))return{model:this.resolveFqn(e.$container.$container)};if(zg(e.$container))return{model:this.resolveFqn(e.$container.$container)};throw new Error("RelationRefError: Invalid container for sourceless relation")}parseRelation(e){const n=this.isValid,r=this._resolveRelationSource(e),i=this.parseFqnRef(e.target);Ke(Jn.isModelRef(i)||Jn.isImportRef(
i),"Target must be a model reference");const s=this.parseTags(e)??this.parseTags(e.body),a=this.parseLinks(e.body),o=(e.kind??e.dotKind?.kind)?.ref?.name,l=this.getMetadata(e.body?.props.find(Yi)),c=this.getAstNodePath(e),u=at(e.body?.props??[],nt(If),nt(g=>ke(g.value)),ii(g=>[g.key,g.value])),d=at(e.body?.props??[],nt(xf),It(g=>g.value.view.ref?.name),nt(ke),ql()),{title:f="",description:p,technology:m}=this.parseBaseProps(u,{title:e.title,description:e.description,technology:e.technology}),w=e.
body?.props.find(sy),v=ss(c,r.model,i.model);return ds({id:v,astPath:c,source:r,target:i,title:f,metadata:l,kind:o,tags:s??void 0,links:Mn(a)?a:void 0,navigateTo:d||void 0,description:p,technology:m,...pS(w?.props,n)})}}}function Tue(t){return class extends t{parsePredicate(e){return this.parseExpressionV2(e)}parseElementPredicate(e){if(Vg(e))return this.parseFqnExprWith(e);if(ZI(e))return this.parseFqnExprOrWhere(e);ht(e)}parseElementPredicateOrWhere(e){return this.parseFqnExprOrWhere(e)}parseElementExpression(e){
return this.parseFqnExpr(e)}parseElementPredicateWhere(e){return this.parseFqnExprWhere(e)}parseElementPredicateWith(e){return this.parseFqnExprWith(e)}parseRelationPredicate(e){return this.parseRelationExprOrWith(e)}parseRelationPredicateOrWhere(e){return this.parseRelationExprOrWhere(e)}parseRelationPredicateWhere(e){return this.parseRelationExprWhere(e)}parseRelationPredicateWith(e){return this.parseRelationExprWith(e)}parseRelationExpression(e){return this.parseRelationExpr(e)}}}const La=Be.
getChild("SpecificationParser");function Eue(t){return class extends t{parseSpecification(){const{parseResult:{value:{specifications:e}},c4Specification:n}=this.doc,r=this.isValid;for(const o of e.flatMap(l=>l.elements.filter(r)))try{Object.assign(n.elements,this.parseElementSpecificationNode(o))}catch(l){La.warn(rt(l))}for(const o of e.flatMap(l=>l.deploymentNodes.filter(r)))try{Object.assign(n.deployments,this.parseElementSpecificationNode(o))}catch(l){La.warn(rt(l))}const i=e.flatMap(o=>o.relationships.
filter(this.isValid));for(const{kind:o,props:l}of i)try{const c=o.name;if(!ke(c))continue;if(c in n.relationships){La.warn(`Relationship kind "${c}" is already defined`);continue}const u=at(l.filter(bN)??[],nt(d=>this.isValid(d)&&Ki(d.value)),ii(d=>[d.key,Pn(rs(d.value))]),Rx(Gt));n.relationships[c]={...u,...pS(l.filter(XI),this.isValid)}}catch(c){La.warn(rt(c))}const s=e.flatMap(o=>o.tags.filter(this.isValid));for(const o of s)try{const l=o.tag.name,c=this.getAstNodePath(o.tag),u=o.color&&this.
parseColorLiteral(o.color);if(l in n.tags){La.warn("Tag {tag} is already defined, skipping duplicate",{tag:l});continue}ke(l)&&(n.tags[l]={astPath:c,...u?{color:u}:{}})}catch(l){La.warn(rt(l))}const a=e.flatMap(o=>o.colors.filter(r));for(const{name:o,color:l}of a)try{const c=o.name;if(c in n.colors){La.warn(`Custom color "${c}" is already defined`);continue}n.colors[c]={color:mr(this.parseColorLiteral(l),`Color "${c}" is not valid`)}}catch(c){La.warn(rt(c))}}parseElementSpecificationNode(e){const{
kind:n,props:r}=e,i=n.name;if(!ke(i))throw new Error("DeploymentNodeKind name is not resolved");const s=this.parseTags(e),a=this.parseElementStyle(r.find(Xd)),o=this.parseLinks(e),l=at(r.filter(wN)??[],nt(d=>this.isValid(d)),ii(d=>[d.key,d.value])),c=this.parseBaseProps(l),u=Pn(rs(l.notation));return{[i]:ml({...c,notation:u,tags:s??void 0,...o&&hl.isNonEmptyArray(o)&&{links:o},style:a})}}}}const Ii=Be.getChild("ViewsParser"),Pue=Ii.getChild("rank");function Cue(t){return class extends t{parseViews(){
const e=this.isValid;for(const n of this.doc.parseResult.value.views){const r=n.styles.flatMap(s=>{try{return e(s)?this.parseViewRuleStyleOrGlobalRef(s):[]}catch(a){return Ii.warn(rt(a)),[]}}),i=n.folder&&!Nt(n.folder.trim())?al(n.folder):null;for(const s of n.views)try{if(!e(s))continue;switch(!0){case Lg(s):this.doc.c4Views.push(this.parseElementView(s,r));break;case T_(s):this.doc.c4Views.push(this.parseDynamicElementView(s,r));break;case sN(s):this.doc.c4Views.push(this.parseDeploymentView(s));
break;default:ht(s)}if(i){const a=this.doc.c4Views.at(-1);a.title=i+" / "+(a.title||a.id)}}catch(a){Ii.warn(rt(a))}}}parseElementView(e,n){const r=e.body;Ke(r,"ElementView body is not defined");const i=this.getAstNodePath(e);let s=null;if("viewOf"in e){const p=xa(e.viewOf),m=p&&Vp(()=>this.resolveFqn(p));if(m)s=m;else{const w=e.name??"unnamed",v=e.viewOf.$cstNode?.text??"<unknown>";Ii.warn("viewOf {viewId} not resolved {msg}",{msg:v,viewId:w})}}let a=e.name;a||(a="view_"+ss(this.doc.uri.toString(),
i,s??""));const{title:o=null,description:l=null}=this.parseBaseProps(at(r.props,nt(p=>this.isValid(p)),nt(py),ii(p=>[p.key,p.value]))),c=this.convertTags(r),u=this.convertLinks(r),d=p$(e),f={[hl._type]:"element",id:a,astPath:i,title:al(o)??null,description:l,tags:c,links:Mn(u)?u:null,rules:[...n,...r.rules.flatMap(p=>{try{return this.isValid(p)?this.parseElementViewRule(p):[]}catch(m){return Ii.warn(rt(m)),[]}})],...s&&{viewOf:s},...d&&{manualLayout:d}};if(Qy.writeId(e,f.id),"extends"in e){const p=e.
extends.view.ref;return Ke(p?.name,"view extends is not resolved: "+e.$cstNode?.text),Object.assign(f,{extends:p.name})}return f}parseElementViewRule(e){if(Zf(e))return this.parseViewRulePredicate(e);if(W_(e))return this.parseViewRuleGlobalPredicateRef(e);if(S_(e))return this.parseViewRuleStyleOrGlobalRef(e);if(Hf(e))return hS(e);if(Gf(e))return this.parseViewRuleGroup(e);if(D8(e))return this.parseViewRuleRank(e);ht(e)}parseViewRulePredicate(e){const n=[];let r=e.exprs;for(;r;){const{value:i,prev:s}=r;
try{if(ke(i)&&this.isValid(i)){const a=this.parsePredicate(i);n.unshift(a)}}catch(a){Ii.warn(rt(a))}if(!s)break;r=s}return e.isInclude?{include:n}:{exclude:n}}parseViewRuleGlobalPredicateRef(e){return{predicateId:e.predicate.$refText}}parseViewRuleStyleOrGlobalRef(e){if(pc(e))return this.parseViewRuleStyle(e);if(G_(e))return this.parseViewRuleGlobalStyle(e);ht(e)}parseViewRuleGroup(e){const n=[];for(const r of e.groupRules)try{if(!this.isValid(r))continue;if(Zf(r)){n.push(this.parseViewRulePredicate(
r));continue}if(Gf(r)){n.push(this.parseViewRuleGroup(r));continue}ht(r)}catch(i){Ii.warn(rt(i))}return{title:al(e.title)??null,groupRules:n,...this.parseStyleProps(e.props)}}parseViewRuleRank(e){const n=this.parseFqnExpressions(e.targets).filter(i=>hl.ModelExpression.isFqnExpr(i)),r=e.value??"same";return Pue.debug`Parsed rank constraint ${r} with ${n.length} target(s)`,{rank:r,targets:n}}parseViewRuleStyle(e){const n=this.parseFqnExpressions(e.targets).filter(s=>hl.ModelExpression.isFqnExpr(s)),
r=this.parseStyleProps(e.props.filter(R_)),i=Pn(rs(e.props.find(ic)?.value));return{targets:n,style:r,...i&&{notation:i}}}parseViewRuleGlobalStyle(e){return{styleId:e.style.$refText}}parseDynamicElementView(e,n){const r=e.body;Ke(r,"DynamicElementView body is not defined");const i=this.isValid,s=r.props.filter(i),a=this.getAstNodePath(e);let o=e.name;o||(o="dynamic_"+ss(this.doc.uri.toString(),a));const{title:l=null,description:c=null}=this.parseBaseProps(at(s,nt(py),ii(m=>[m.key,m.value]))),u=this.
convertTags(r),d=this.convertLinks(r);Qy.writeId(e,o);const f=p$(e),p=Ok(s,E_)?.value;return{[hl._type]:"dynamic",id:o,astPath:a,title:al(l)??null,description:c,tags:u,links:Mn(d)?d:null,variant:p,rules:[...n,...r.rules.flatMap(m=>{try{return i(m)?this.parseDynamicViewRule(m):[]}catch(w){return Ii.warn(rt(w)),[]}},[])],steps:r.steps.reduce((m,w)=>{try{i(w)&&(P_(w)?m.push(this.parseDynamicParallelSteps(w)):m.push(this.parseDynamicStep(w)))}catch(v){Ii.warn(rt(v))}return m},[]),...f&&{manualLayout:f}}}parseDynamicViewRule(e){
if(oN(e))return this.parseDynamicViewIncludePredicate(e);if(aN(e))return this.parseViewRuleGlobalPredicateRef(e);if(S_(e))return this.parseViewRuleStyleOrGlobalRef(e);if(Hf(e))return hS(e);ht(e)}parseDynamicViewIncludePredicate(e){const n=[];let r=e.exprs;for(;r;){try{if(Ki(r.value)&&this.isValid(r.value)&&JI(r.value)){const i=this.parseElementPredicate(r.value);n.unshift(i)}}catch(i){Ii.warn(rt(i))}r=r.prev}return{include:n}}parseDynamicParallelSteps(e){const n=m$(e),r=e.steps.map(i=>this.parseDynamicStep(
i));return Ke(Mn(r),"Dynamic parallel steps must have at least one step"),{parallelId:n,__parallel:r}}parseDynamicStep(e){if(dp(e))return Ke(this.isValid(e)),this.parseDynamicStepSingle(e);const n=this.recursiveParseDynamicStepChain(e);return Ke(Mn(n),"Dynamic step chain must have at least one step"),{seriesId:m$(e),__series:n}}recursiveParseDynamicStepChain(e,n){if(dp(e.source)){if(!this.isValid(e.source))return[];const o=this.parseDynamicStepSingle(e.source);if(o.isBackward)return[];const l={...this.
parseAbstractDynamicStep(e),source:o.target};return l.target===o.source?l.isBackward=!0:n&&(n.push([o.source,o.target]),n.push([l.source,l.target])),[o,l]}n??=[];const r=this.recursiveParseDynamicStepChain(e.source,n);if(!Mn(r)||!this.isValid(e))return[];const i=pl(r),s={...this.parseAbstractDynamicStep(e),source:i.target},a=n.findIndex(([o,l])=>o===s.target&&l===s.source);return a!==-1?(s.isBackward=!0,n.splice(a,n.length-a)):n.push([s.source,s.target]),[...r,s]}parseDynamicStepSingle(e){const n=xa(
e.source);if(!n)throw new Error("Invalid reference to source");let r={...this.parseAbstractDynamicStep(e),source:this.resolveFqn(n)};return e.isBackward&&(r={...r,source:r.target,target:r.source,isBackward:!0}),r}parseAbstractDynamicStep(e){const n=xa(e.target);if(!n)throw new Error("Invalid reference to target");const r={target:this.resolveFqn(n),astPath:m$(e)},i=Pn(e.title);i&&(r.title=i);const s=e.kind?.ref?.name??e.dotKind?.kind.ref?.name;s&&(r.kind=s);for(const a of e.custom?.props??[])try{
switch(!0){case xf(a):{const o=a.value.view.ref?.name;ke(o)&&(r.navigateTo=o);break}case If(a):case ic(a):{if(Un(a.value))if(a.key==="description"){const o=Pn(a.value);o&&(r.description=o)}else r[a.key]=Pn(rs(a.value))??"";break}case j_(a):{Un(a.value)&&(r[a.key]=Pn(a.value));break}case Md(a):{Un(a.value)&&(r[a.key]=a.value);break}case Co(a):{const o=zp(a);Un(o)&&(r[a.key]=o);break}case pf(a):{Un(a.value)&&(r[a.key]=a.value);break}default:ht(a)}}catch(o){Ii.warn(rt(o))}return r}}}function m$(t){
let e=t,n=[];for(;!Ag(e);)Zi(e.$containerIndex)&&n.unshift(`@${e.$containerIndex}`),n.unshift(`/${e.$containerProperty??"__invalid__"}`),e=e.$container;return n.join("")}const xue=at(fue,wue,_ue,$ue,mue,gue,Tue,Eue,Cue,bue);class Aue extends xue{}const dh=Be.getChild("ModelParser");class Iue{services;cachedParsers=new l0(e=>this.createParser(e));constructor(e){this.services=e,e.shared.workspace.DocumentBuilder.onDocumentPhase(Ve.Linked,async n=>{this.cachedParsers.has(n)&&(dh.trace("Linked: clea\
r cached parser {projectId} document {doc}",{projectId:n.likec4ProjectId,doc:tt.basename(n.uri)}),this.cachedParsers.delete(n))}),e.shared.workspace.DocumentBuilder.onBuildPhase(Ve.Linked,async n=>{for(const r of n)if(!e.shared.workspace.ProjectsManager.isExcluded(r))try{this.parse(r)}catch(i){ct(i)}}),e.shared.workspace.DocumentBuilder.onDocumentPhase(Ve.Validated,async n=>{n.diagnostics?.some(r=>r.severity===so.Error)&&this.cachedParsers.has(n)&&(dh.trace("Validated: clear cached parser {proje\
ctId} document {doc} because of errors",{projectId:n.likec4ProjectId,doc:tt.basename(n.uri)}),this.cachedParsers.delete(n))})}documents(e){return this.services.shared.workspace.LangiumDocuments.projectDocuments(e).map(n=>this.parse(n))}parse(e){return this.forDocument(e).doc}forDocument(e){return this.cachedParsers.get(e)}createParser(e){An(ns(e),`Document ${e.uri.toString()} is not a LikeC4 document`);const n=tt.basename(e.uri);e.likec4ProjectId?dh.trace("create parser {projectId} document {doc\
}",{projectId:e.likec4ProjectId,doc:n}):dh.warn("create parser for document without project {doc}",{doc:e.uri.fsPath}),e.state<Ve.Linked&&dh.warn("Document {doc} is not linked, state is {state}",{doc:n,state:e.state});const r={c4Specification:{tags:{},elements:{},relationships:{},colors:{},deployments:{}},c4Elements:[],c4ExtendElements:[],c4ExtendDeployments:[],c4ExtendRelations:[],c4Relations:[],c4Deployments:[],c4DeploymentRelations:[],c4Globals:{predicates:{},dynamicPredicates:{},styles:{}},c4Views:[],
c4Imports:new nr(Set)};e=Object.assign(e,r);const i=new Aue(this.services,e);try{i.parseSpecification(),i.parseImports(),i.parseModel(),i.parseGlobals(),i.parseDeployment(),i.parseViews()}catch(s){throw new Error(`Error parsing document ${e.uri.fsPath}`,{cause:s})}return i}}class Nue extends PC{runConverter(e,n,r){return e.name==="MarkdownString"?((n.startsWith('"""')&&n.endsWith('"""')||n.startsWith("'''")&&n.endsWith("'''"))&&(n=n.slice(2,-2)),Gi.convertString(n)):super.runConverter(e,n,r)}}const{
findNodeForKeyword:Due}=ob,Oue=(t,e,n=0)=>{const r=n>0?" ".repeat(n):"";return[r+`style ${t} {`,...Wm(e).map(([i,s])=>r+`  ${i} ${i==="opacity"?s.toString()+"%":s}`),r+"}"]},Lue=(t,e)=>n=>{if(!pc(n)&&!Hd(n))return!1;const r=n.targets.value;if(!r||ke(n.targets.prev)||r.$type!=="FqnRefExpr"||ke(r.selector))return!1;const i=r.ref?.value?.ref;return(i?e.resolve(i):null)===t};function Mue(t,{view:e,viewAst:n,targets:r,style:i}){Ke(n.body,`View ${e.id} has no body`);const s=n.$cstNode;Ke(s,"viewCstNod\
e");const a=pl(n.body.rules)?.$cstNode?.range.end??n.body.$cstNode?.range.end;Ke(a,"insertPos is not defined");const o=s.range.start.character+2,l=t.likec4.FqnIndex,c=nt(n.body.rules,v=>pc(v)||Hd(v)),u=e[Vq]==="element"?e.viewOf??null:null,d=[],f=[];r.forEach(v=>{const g=vx(c,Lue(v,l)),h=u&&Rw(u,v)?v.substring(u.length+1):v;g?d.push({fqn:h,rule:g}):f.push({fqn:h})});const p={start:a,end:a},m=v=>{v.start.line<=p.start.line&&(v.start.line==p.start.line?p.start.character=Math.min(v.start.character,
p.start.character):p.start=v.start),v.end.line>=p.end.line&&(v.end.line==p.end.line?p.end.character=Math.max(v.end.character,p.end.character):p.end=v.end)},w=[];if(f.length>0){const v=f.flatMap(({fqn:g})=>Oue(g,i,o));w.push(Rr.insert(a,`
`+v.join(`
`))),p.start={line:a.line+1,character:o},p.end={line:a.line+v.length,character:pl(v)?.length??0}}if(d.length>0)for(const{rule:v}of d){const g=v.$cstNode;Ke(g,"RuleCstNode not found");for(const[h,y]of Wm(i)){const b=h==="opacity"?y.toString()+"%":y,R=v.props.find(B=>B.key===h);if(R&&R.$cstNode){const{range:{start:B,end:ie}}=R.$cstNode;m({start:B,end:ie}),w.push(Rr.replace({start:B,end:ie},h+" "+b));continue}const T=Due(g,"{")?.range.end;Ke(T,"Opening brace not found");const N=" ".repeat(g.range.start.
character)+"	",q=N+h+" "+b;w.push(Rr.insert(T,`
`+q)),m({start:{line:T.line+1,character:N.length},end:{line:T.line+1,character:q.length}})}}return{modifiedRange:p,edits:w}}const{findNodeForKeyword:jue}=ob;function que(t,{view:e,viewAst:n,layout:r}){Ke(n.body,`View ${e.id} has no body`);const i=n.$cstNode;Ke(i,"viewCstNode");const s=Cie(r.direction),a=vx(n.body.rules,Hf);let o=`autoLayout ${s}`;if(Zi(r.rankSep)&&(o+=` ${r.rankSep}`,Zi(r.nodeSep)&&(o+=` ${r.nodeSep}`)),a&&a.$cstNode)return Rr.replace(a.$cstNode.range,o);const l=jue(n.body.$cstNode,
"}")?.range.start;Ke(l,"Closing brace not found");const c=`	${o}
	`;return Rr.insert(l,c)}async function Mj(t,{lookup:e}){if(!e.view.manualLayout)return!1;const n=e.viewAst.$cstNode;Ke(n,"invalid view.$cstNode");const r=t.shared.lsp.Connection;Ke(r,"LSP Connection not available");const i=Wc(n,["BLOCK_COMMENT"]);return i&&fw(i.text)?(await r.workspace.applyEdit({label:`LikeC4 - remove manual layout v1 for ${e.view.id}`,edit:{changes:{[e.doc.textDocument.uri]:[Rr.del(i.range)]}}})).applied:!1}const mw=Be.getChild("model-changes");class Fue{services;locator;constructor(e){
this.services=e,this.locator=e.likec4.ModelLocator}async applyChange(e){const n=this.services.shared.lsp.Connection;try{let{viewId:r,projectId:i,change:s}=e;const a=this.services.shared.workspace.ProjectsManager.ensureProject(i);mw.debug`Applying model change ${s.op} to view ${r} in project ${a.id}`;const o=this.locator.locateViewAst(r,a.id);if(!o)throw new Error(`View ${r} not found in project ${a.id}`);const l={uri:o.doc.textDocument.uri,version:o.doc.textDocument.version};if(s.op==="save-view\
-snapshot")return Ke(r===s.layout.id,"View ID does not match, expected "+r+", got "+s.layout.id),o.view.manualLayout&&await Mj(this.services,{lookup:o}).catch(f=>{mw.warn(`Failed to remove manual layout v1 for view ${r} in project ${a.id}`,{err:f})}),{success:!0,location:await this.services.likec4.ManualLayouts.write(a,s.layout)};if(s.op==="reset-manual-layout")return o.view.manualLayout&&await Mj(this.services,{lookup:o}).catch(f=>{mw.warn(`Failed to remove manual layout v1 for view ${r} in pro\
ject ${a.id}`,{err:f})}),{success:!0,location:await this.services.likec4.ManualLayouts.remove(a,r)};Ke(n,"This change only supported in IDE (running as Extension)");const{edits:c,modifiedRange:u}=this.convertToTextEdit({lookup:o,change:s});if(!c.length)return{success:!1,error:"No changes to apply"};const d=await n.workspace.applyEdit({label:`LikeC4 - change view ${e.viewId}`,edit:{changes:{[l.uri]:c}}});return d.applied?{success:!0,location:{uri:l.uri,range:u}}:(n.window.showErrorMessage(`Failed\
 to apply changes ${d.failureReason}`),{success:!1,error:`Failed to apply changes ${d.failureReason}`})}catch(r){const i=rt(oA(r,`Failed to apply change ${e.change.op} ${e.viewId}`));return mw.error(i),{success:!1,error:i}}finally{this.services.likec4.ModelBuilder.clearCache()}}convertToTextEdit({lookup:e,change:n}){switch(n.op){case"change-element-style":return Mue(this.services,{...e,targets:n.targets,style:n.style});case"change-autolayout":{const r=que(this.services,{...e,layout:n.layout});return{
modifiedRange:r.range,edits:[r]}}default:ht(n)}}}class zue extends jC{services;constructor(e){super(),this.services=e}getNameStrict(e){return di(this.getName(e),`Failed getName for ${this.services.workspace.AstNodeLocator.getAstNodePath(e)}`)}getName(e){if(zm(e))return e.name;if(Xi(e))return e.imported.$refText;if($r(e))return e.target.modelElement.value.$refText}getNameNode(e){if(zm(e))return super.getNameNode(e);if(Xi(e))return e.imported.$refNode;if($r(e))return e.target.modelElement.value.$refNode}}
function Uue(t){return at(t,zc(e=>`${e.type}.${e.name}`),Wm(),Rs(([e,n])=>n.length===1?n:[]))}class Hue extends FC{constructor(e){super(e)}async computeExports(e,n){const r=[];try{const{specifications:i,models:s,views:a,globals:o,likec4lib:l,deployments:c}=e.parseResult.value;this.exportLibrary(l,r,e),this.exportSpecification(i,r,e),this.exportModel(s,r,e),this.exportViews(a,r,e),this.exportGlobals(o,r,e),this.exportDeployments(c,r,e)}catch(i){ct(i)}return r}exportViews(e,n,r){const i=e?.flatMap(
s=>s.views);if(!(Gt(i)||i.length===0))for(const s of i)try{ke(s.name)&&n.push(this.descriptions.createDescription(s,s.name,r))}catch(a){ct(a)}}exportGlobals(e,n,r){if(!(Gt(e)||e.length===0)){for(const i of e.flatMap(s=>s.predicates))try{const s=i;ke(s.name)&&n.push(this.descriptions.createDescription(s,s.name,r))}catch(s){ct(s)}for(const i of e.flatMap(s=>s.styles))try{const s=i.id;ke(s.name)&&n.push(this.descriptions.createDescription(s,s.name,r))}catch(s){ct(s)}}}exportModel(e,n,r){if(!(Gt(e)||
e.length===0))for(const i of e.flatMap(s=>s.elements))try{Vn(i)&&ke(i.name)&&n.push(this.descriptions.createDescription(i,i.name,r))}catch(s){ct(s)}}exportLibrary(e,n,r){if(!Gt(e))try{for(const i of e.flatMap(s=>s.icons))n.push(this.descriptions.createDescription(i,i.name,r))}catch(i){ct(i)}}exportSpecification(e,n,r){if(!(Gt(e)||e.length===0))for(const i of e.flatMap(s=>[...s.elements,...s.relationships,...s.deploymentNodes,...s.tags,...s.colors]))try{switch(!0){case ac(i):case lc(i):{ke(i.kind.
name)&&n.push(this.descriptions.createDescription(i.kind,i.kind.name,r));continue}case qf(i):{ke(i.tag.name)&&n.push(this.descriptions.createDescription(i.tag,i.tag.name,r));continue}case uc(i):{ke(i.kind.name)&&n.push(this.descriptions.createDescription(i.kind,i.kind.name,r));continue}case ly(i):{ke(i.name.name)&&n.push(this.descriptions.createDescription(i.name,i.name.name,r));continue}default:ht(i)}}catch(s){ct(s)}}exportDeployments(e,n,r){const i=e?.flatMap(s=>s.elements);if(!(Gt(i)||i.length===
0))for(const s of i)try{ur(s)&&ke(s.name)&&n.push(this.descriptions.createDescription(s,s.name,r))}catch(a){ct(a)}}computeLocalScopes(e,n){return new Promise(r=>{const i=e.parseResult.value,s=[],a=new fo;for(const o of i.models)try{s.push(...this.processContainer(o,a,e))}catch(l){ct(l)}for(const o of i.deployments)try{s.push(...this.processDeployments(o,a,e))}catch(l){ct(l)}for(const o of i.imports.flatMap(l=>l.imports))try{let l=o;for(;l;)s.push(this.descriptions.createDescription(l,l.imported.
$refText)),l=l.prev}catch(l){ct(l)}Uue(s).forEach(o=>{a.add(i,o)}),r(a)})}processContainer(e,n,r){const i=new fo,s=[];for(const o of e.elements){if(Qi(o))continue;let l;if(Vn(o)?(ke(o.name)&&i.add(o.name,this.descriptions.createDescription(o,o.name,r)),l=o.body,l&&(n.add(l,this.descriptions.createDescription(o,"this",r)),n.add(l,this.descriptions.createDescription(o,"it",r)))):Io(o)&&(l=o.body),l&&l.elements.length>0)try{s.push(...this.processContainer(l,n,r))}catch(c){ct(c)}}s.length&&at(s,nt(o=>!i.
has(o.name)),zc(o=>o.name),bx((o,l)=>{o.length===1&&i.add(l,o[0])}));const a=[...i.values()];return n.addAll(e,a),a}processDeployments(e,n,r){const i=new fo,s=[];for(const o of e.elements){if(Si(o))continue;let l=o.body;if(!ga(o)){let c=this.nameProvider.getName(o);if(ke(c)){const u=this.descriptions.createDescription(o,c,r);i.add(c,u)}l&&(n.add(l,this.descriptions.createDescription(o,"this",r)),n.add(l,this.descriptions.createDescription(o,"it",r)))}if(l)try{s.push(...this.processDeployments(l,
n,r))}catch(c){ct(c)}}s.length&&at(s,nt(o=>!i.has(o.name)),zc(o=>o.name),bx((o,l)=>{o.length===1&&i.add(l,o[0])}));const a=[...i.values()];return n.addAll(e,a),a}}const{getDocument:jj}=bl;class Vue extends HC{deploymentsIndex;fqnIndex;indexManager;constructor(e){super(e),this.indexManager=e.shared.workspace.IndexManager,this.fqnIndex=e.likec4.FqnIndex,this.deploymentsIndex=e.likec4.DeploymentsIndex}getScope(e){try{const n=wn(e.container),r=this.reflection.getReferenceType(e);try{const i=e.container;
if(fN(i))return new po(this.streamForFqnRef(n,i,e));if(_N(i))return this.getScopeForStrictFqnRef(n,i,e);if(r!==Fr)return this.getProjectScope(n,r,e);if(Xi(i)){const s=wn(i);return new po(this.fqnIndex.rootElements(s))}if(H_(i)&&e.property==="el"){const s=i.parent;return s?new po(this.fqnIndex.directChildrenOf(n,Jo(s))):this.getProjectScope(n,r,e)}return new po(dt(this.computeScope(n,e)))}catch(i){return ct(i),this.getProjectScope(n,r,e)}}catch(n){return ct(n),TK}}*genUniqueDescedants(e){if(!e)return;
const n=wn(e);if(Vn(e)){const r=this.fqnIndex.getFqn(e);yield*this.fqnIndex.uniqueDescedants(n,r);return}if(ur(e)){const r=this.deploymentsIndex.getFqn(e);yield*this.deploymentsIndex.uniqueDescedants(n,r)}}*genScopeExtendElement({element:e}){e.el.$nodeDescription&&(yield e.el.$nodeDescription,yield{...e.el.$nodeDescription,name:"this"},yield{...e.el.$nodeDescription,name:"it"}),yield*this.genUniqueDescedants(xa(e))}*genScopeElementView({viewOf:e,extends:n}){if(e){e.modelElement.value.$nodeDescription&&
(yield e.modelElement.value.$nodeDescription),yield*this.genUniqueDescedants(xa(e));return}if(n){const r=n.view.ref;r&&(yield*this.genScopeElementView(r))}}getScopeForStrictFqnRef(e,n,r){const i=n.parent;return i?new po(this.deploymentsIndex.directChildrenOf(e,Jo(i)).filter(s=>this.reflection.isSubtype(s.type,Ri))):this.getProjectScope(e,Ri,r)}*genScopeExtendDeployment({deploymentNode:e}){e.value.$nodeDescription&&(yield e.value.$nodeDescription);const n=e.value.ref;n&&ur(n)&&(yield*this.genUniqueDescedants(
n))}streamForFqnRef(e,n,r){const i=n.parent;if(!i)return dt(this.genScopeForParentlessFqnRef(e,n,r));const s=i.value.ref;if(!s)return Bc;if(Xi(s))return dt(this.genUniqueDescedants(s.imported.ref));if(ur(s))return dt(this.genUniqueDescedants(s));if($r(s)){const a=s.target.modelElement.value.ref,o=Xi(a)?a.imported.ref:Vn(a)?a:void 0;return dt(this.genUniqueDescedants(o))}return Vn(s)?dt(this.genUniqueDescedants(s)):ht(s)}*genScopeForParentlessFqnRef(e,n,r){pi(n,x_)||Aie(n)?yield*this.computeScope(
e,r,Fr):xie(n)?(yield*this.computeScope(e,r,Fr),yield*this.computeScope(e,r,Ri),yield*this.computeScope(e,r,Ls)):(yield*this.computeScope(e,r,Ri),yield*this.computeScope(e,r,Ls),pi(n,$_)&&(yield*this.computeScope(e,r,Fr)));const i=jj(n).precomputedScopes;i&&(yield*i.values().filter(s=>this.reflection.isSubtype(s.type,ya)))}*computeScope(e,n,r=this.reflection.getReferenceType(n)){const i=this.reflection.isSubtype(r,Fr),s=this.reflection.isSubtype(r,ig),a=jj(n.container).precomputedScopes;if(!a){yield*this.
getProjectScope(e,r,n).getAllElements();return}const o=c=>this.reflection.isSubtype(c.type,r);let l=n.container;for(;l;){const c=a.get(l).filter(o);c.length>0&&(yield*c),s&&N_(l)&&(yield*this.genScopeExtendDeployment(l.$container)),i&&zg(l)&&(yield*this.genScopeExtendElement(l.$container)),i&&A_(l)&&(yield*this.genScopeElementView(l.$container)),l=l.$container}yield*this.getProjectScope(e,r,n).getAllElements()}getProjectScope(e,n,r){return n===qs?super.getGlobalScope(n,r):this.globalScopeCache.get(
`${e}::${n}`,()=>new zC(this.indexManager.projectElements(e,n)))}getGlobalScope(e,n){if(e===qs)return super.getGlobalScope(e,n);const r=wn(n.container);return this.getProjectScope(r,e,n)}}var er=wo(),g$;(function(t){t.type=new er.NotificationType("likec4/onDidChangeModel")})(g$||(g$={}));var y$;(function(t){t.Method="likec4/onDidChangeSnapshot",t.type=new er.NotificationType(t.Method)})(y$||(y$={}));var v$;(function(t){t.type=new er.NotificationType("likec4/onRequestOpenView")})(v$||(v$={}));var w$;
(function(t){t.req=new er.RequestType("likec4/fetchComputedModel")})(w$||(w$={}));var b$;(function(t){t.req=new er.RequestType0("likec4/fetchViewsFromAllProjects")})(b$||(b$={}));var k$;(function(t){t.req=new er.RequestType("likec4/fetchLayoutedModel")})(k$||(k$={}));var _$;(function(t){t.req=new er.RequestType("likec4/layout-view")})(_$||(_$={}));var R$;(function(t){t.req=new er.RequestType("likec4/validate-layout")})(R$||(R$={}));var S$;(function(t){t.req=new er.RequestType0("likec4/reload-pro\
jects")})(S$||(S$={}));var $$;(function(t){t.req=new er.RequestType0("likec4/fetch-projects")})($$||($$={}));var T$;(function(t){t.req=new er.RequestType("likec4/register-project")})(T$||(T$={}));var E$;(function(t){t.req=new er.RequestType("likec4/build")})(E$||(E$={}));var P$;(function(t){t.req=new er.RequestType("likec4/locate")})(P$||(P$={}));var C$;(function(t){t.req=new er.RequestType("likec4/change-view")})(C$||(C$={}));var x$;(function(t){t.req=new er.RequestType0("likec4/metrics")})(x$||
(x$={}));var A$;(function(t){t.req=new er.RequestType("likec4/document-tags")})(A$||(A$={}));const pn=Be.getChild("rpc");class Bue extends xS{services;constructor(e){super(),this.services=e}init(){const e=this.services.shared.lsp.Connection;if(!e){pn.info("no connection, skip init ServerRpc");return}pn.info("init ServerRpc");const n=this.services.likec4,r=this.services.shared.workspace.ProjectsManager,i=this.services.shared.workspace.LangiumDocuments,s=this.services.shared.workspace.DocumentBuilder,
a=D3(c=>{c>1?pn.debug`send ${"onDidChangeModel"} (${c} batched)`:pn.debug`send ${"onDidChangeModel"}`,e.sendNotification(g$.type,"").catch(u=>{pn.warn("[ServerRpc] error sending onDidChangeModel:",{error:u})})},{reducer:(c,u)=>(c??0)+u,triggerAt:"end",minQuietPeriodMs:200,maxBurstDurationMs:400});let o=!0;this.onDispose(n.ModelBuilder.onModelParsed(()=>a.call(1)),e.onRequest(w$.req,async({projectId:c,cleanCaches:u},d)=>{if(pn.debug`received request ${"fetchComputedModel"} for project ${c} (cleanCaches: ${u})`,
u){const p=(c?i.projectDocuments(c):i.allExcludingBuiltin).toArray().map(m=>m.uri);await s.update(p,[],d)}const f=await n.ModelBuilder.computeModel(c,d);return f!==qi.EMPTY?{model:f.$data}:{model:null}}),e.onNotification(y$.type,async({snapshotUri:c})=>{pn.debug`received notification ${"onDidChangeSnapshot"} for snapshot ${c}`;const u=ot.parse(c);await r.rebuidProject(r.belongsTo(u.path))}),e.onRequest(k$.req,async({projectId:c},u)=>{pn.debug`received request ${"fetchLayoutedModel"} for project ${c}`;
const d=await n.LanguageServices.layoutedModel(c);if(d===null)return{model:null};const f=await n.Views.diagrams(c,u);return{model:{...d.$data,_stage:"layouted",views:td(f,p=>p.id)}}}),e.onRequest(_$.req,async({viewId:c,projectId:u,layoutType:d},f)=>(pn.debug`received request ${"layoutView"} for ${c} from project ${u} (layout type: ${d??"not set"})`,{result:await n.Views.layoutView({viewId:c,projectId:u,layoutType:d,cancelToken:f})})),e.onRequest(R$.req,async({projectId:c},u)=>{pn.debug`received request ${"\
validateLayout"} for project ${c}`;const d=await n.Views.layoutAllViews(c,u);return{result:l(d.map(f=>f.diagram))}}),e.onRequest($$.req,async()=>{pn.debug`received request ${"FetchProjects"}`;const c=i.groupedByProject();return{projects:yl(c,(u,d)=>{const{folderUri:f,config:{name:p,title:m}}=r.getProject(d);return{folder:f.toString(),config:{name:p,title:m},docs:It(u,w=>w.uri.toString())}})}}),e.onRequest(S$.req,async c=>{pn.debug`received request ${"ReloadProjects"}`,n.ManualLayouts.clearCaches(),
await r.reloadProjects(c)}),e.onRequest(T$.req,async(c,u)=>{pn.debug`received request ${"RegisterProject"}`;let d;return"configUri"in c?d=await r.registerConfigFile(ot.parse(c.configUri),u):d=await r.registerProject(c,u),{id:d.id}}),e.onRequest(b$.req,async c=>{pn.debug`received request ${"FetchViewsFromAllProjects"}`;const u=[];for(const d of r.all){await mn(c);try{const f=await n.Views.computedViews(d,c);u.push(...at(f,It(p=>({id:p.id,title:p.title??p.id,projectId:d})),Gm((p,m)=>p.id==="index"?
-1:m.id==="index"?1:p.title.localeCompare(m.title))))}catch(f){pn.warn(`Failed to fetch views for project ${d}:`,{error:f})}}return{views:u}}),e.onRequest(E$.req,async({docs:c},u)=>{const d=c.map(m=>ot.parse(m)),f=m=>d.every(w=>!tt.equals(w,m)),p=i.allExcludingBuiltin.toArray().filter(m=>f(m.uri)).map(m=>m.uri);pn.debug(`[ServerRpc] received request to build:
  changed (total ${d.length}):${c.map(m=>`
    - `+m).join("")}
  deleted (total ${p.length}):${p.map(m=>`
    - `+m.toString()).join(`
`)}`),!o&&d.length+p.length>0&&await Promise.allSettled([...d,...p].map(async m=>{const w=m.toString();pn.debug(`clear diagnostics for ${w}`);try{await e.sendDiagnostics({uri:w,diagnostics:[]})}catch(v){pn.warn(`error clearing diagnostics for ${w}: ${v}`)}})),o=!1,await mn(u),await s.update(d,p,u)}),e.onRequest(P$.req,c=>{switch(pn.debug`received request ${"locate"}, ${c}`,!0){case"element"in c:return n.ModelLocator.locateElement(c.element,c.projectId);case"relation"in c:return n.ModelLocator.locateRelation(
c.relation,c.projectId);case"astPath"in c:return n.ModelLocator.locateDynamicViewStep({view:c.view,astPath:c.astPath,projectId:c.projectId});case"view"in c:return n.ModelLocator.locateView(c.view,c.projectId);case"deployment"in c:return n.ModelLocator.locateDeploymentElement(c.deployment,c.projectId);default:ht(c)}}),e.onRequest(C$.req,async(c,u)=>{pn.debug`received request ${"changeView"} of ${c.viewId} from project ${c.projectId}`;const d=await n.ModelChanges.applyChange(c),f=c.change.op;return c.
projectId&&(f==="save-view-snapshot"||f==="reset-manual-layout")&&await r.rebuidProject(c.projectId,u),d}),e.onRequest(x$.req,async c=>{let u=null;for(const d of r.all)try{const f=await n.ModelBuilder.computeModel(d,c);if(f===qi.EMPTY)continue;u??={elementKinds:0,deploymentKinds:0,relationshipKinds:0,tags:0,customColors:0,elements:0,deploymentNodes:0,relationships:0,views:0,projects:0},u.elementKinds+=Lr(f.specification.elements).length,u.deploymentKinds+=Lr(f.specification.deployments).length,u.
relationshipKinds+=Lr(f.specification.relationships).length,u.tags+=Lr(f.specification.tags).length,u.customColors+=Lr(f.specification.customColors??{}).length,u.elements+=Lr(f.$data.elements).length,u.deploymentNodes+=[...f.deployment.nodes()].length,u.relationships+=Lr(f.$data.relations).length,u.views+=Lr(f.$data.views).length,u.projects+=1}catch(f){pn.warn(`Error fetching telemetry metrics for project ${d}`,{err:f})}return await mn(c),{metrics:u}}),e.onRequest(A$.req,async({documentUri:c},u)=>({
tags:await n.ModelLocator.locateDocumentTags(ot.parse(c),u)})),ho.create(()=>{a.cancel()}));function l(c){return at(c,nt(u=>!!u.hasLayoutDrift),It(u=>{const d=n.ModelLocator.locateView(u.id);return Ke(d,`View ${u.id} not found`),{uri:d.uri,viewId:u.id,severity:Ji.DiagnosticSeverity.Warning,message:`Layout drift detected for view '${u.id}'`,range:d.range}}))}}async openView(e){const n=this.services.shared.lsp.Connection;if(!n){pn.warn("No LSP connection");return}await n.sendNotification(v$.type,e)}}
class Wue{services;constructor(e){this.services=e}getSymbolKind(e){const n=Xt(e)?e.$type:e.type,r=(...i)=>i.some(s=>this.services.AstReflection.isSubtype(n,s));switch(!0){case r(Fr,Ao,Ri,Ls,ya):return bi.Constructor;case r(tc,rc,nc,Xl,dc):return bi.Namespace;case r(Eo):return bi.Class;case r(wa,qs,xo,fc):return bi.EnumMember;case r(va,cc):return bi.Event;case r(js,Ms,oc,sc):return bi.TypeParameter}return bi.Field}getCompletionItemKind(e){const n=Xt(e)?e.$type:e.type,r=(...i)=>i.some(s=>this.services.
AstReflection.isSubtype(n,s));switch(!0){case r(xo):return Lt.Color;case r(Fr,Ri,Ls,Ao,ya):return Lt.Constructor;case r(tc,rc,nc,Xl,dc):return Lt.Module;case r(Eo):return Lt.Class;case r(wa,qs,xo,fc):return Lt.EnumMember;case r(va,cc):return Lt.Event;case r(js,oc,Ms,sc):return Lt.TypeParameter;default:return Lt.Reference}}}class Gue extends HI{}const I$=Be.getChild("views");class Kue{services;cache=new WeakMap;viewsWithReportedErrors=new Set;ModelBuilder;constructor(e){this.services=e,this.ModelBuilder=
e.likec4.ModelBuilder}get layouter(){return this.services.likec4.Layouter}async computedViews(e,n){const r=await this.ModelBuilder.computeModel(e,n);return Fc(r.$data.views)}async _layoutAllViews(e,n){const r=Fc(e.$data.views);if(r.length===0)return[];const i=lv(),s=e.project.id,a=I$.getChild(s);a.debug`layoutAll: ${r.length} views`;const o=[],l=e.$styles,c=[];for(const u of r){let d=this.cache.get(u);if(d){a.debug`layout ${u.id} from cache`,c.push(d);continue}o.push({view:u,styles:l})}return o.
length>0&&await this.layouter.batchLayout({batch:o,cancelToken:n,onSuccess:(u,d)=>{c.push(this.viewSucceed(u.view,e,d))},onError:(u,d)=>{a.warn(`Fail layout view ${u.view.id}`,{error:d})}}),n&&n.isCancellationRequested&&await mn(n),c.length!==r.length?a.warn`layouted ${c.length} of ${r.length} views in ${i.pretty}`:c.length>0&&a.debug`layouted all ${c.length} views in ${i.pretty}`,c}async layoutAllViews(e,n){const r=await this.ModelBuilder.computeModel(e,n);return await this._layoutAllViews(r,n)}async layoutView({
viewId:e,layoutType:n,projectId:r,cancelToken:i}){const s=await this.ModelBuilder.computeModel(r,i),a=s.findView(e)?.$view;r=s.project.id;const o=I$.getChild(r);if(!a){o.warn`layoutView ${e} not found`;const l=s.findManualLayout(e);if(l){o.debug`found manual layout for ${e}`;let c={...l};return c.drifts=["not-exists"],c._layout="manual",{diagram:c,dot:"# manual layout"}}return null}try{const l=lv(),c=this.cache.get(a)??await this.layouter.layout({view:a,styles:s.$styles});return this.cache.has(a)?
o.debug`layout ${e} from cache`:(this.viewSucceed(a,s,c),o.debug(`layout {viewId} in ${l.pretty}`,{viewId:e})),ke(n)?{dot:c.dot,diagram:this.withLayoutType(c.diagram,s,n)}:c}catch(l){const c=rt(l);return o.warn(c),this.reportViewError(a,r,c),Promise.reject(l)}}async diagrams(e,n){const r=await this.ModelBuilder.computeModel(e,n);return(await this._layoutAllViews(r,n)).map(({diagram:i})=>this.withLayoutType(i,r,"manual"))}async viewsAsGraphvizOut(e,n){const r="All-LayoutedViews-DotWithSvg",i=this.
services.shared.workspace.Cache;if(i.has(r))return await Promise.resolve(i.get(r));const s=await this.ModelBuilder.computeModel(e,n),a=Fc(s.$data.views);if(a.length===0)return[];const o=a.map(async u=>{const{dot:d,svg:f}=await this.layouter.svg({view:u,styles:s.$styles});return{id:u.id,dot:d,svg:f}}),l=[],c=await Promise.allSettled(o);for(const u of c)u.status==="fulfilled"?l.push(u.value):ct(u.reason);return i.set(r,l),l}async openView(e,n){await this.services.Rpc.openView({viewId:e,projectId:n})}reportViewError(e,n,r){
const i=`${n}-${e.id}`;this.cache.delete(e),this.viewsWithReportedErrors.has(i)||(this.services.shared.lsp.Connection?.window.showErrorMessage(`LikeC4: ${r}`),this.viewsWithReportedErrors.add(i))}withLayoutType(e,n,r){if(!r)return e;const i=n.findManualLayout(e.id);return i?r==="manual"?e[J$]==="manual"?(I$.error(`View ${e.id} already has manual layout, this should not happen`),e):Bq(e,i):Wq(e,i):e}viewSucceed(e,n,r){const i=`${n.project.id}-${e.id}`;return this.viewsWithReportedErrors.delete(i),
this.cache.set(e,r),r}}const qj={manualLayouts:()=>({read:()=>Promise.resolve(null),write:()=>Promise.reject(new Error("NoopLikeC4ManualLayouts: write operation is not supported")),remove:()=>Promise.resolve(null),clearCaches:()=>{}})},Zue=t=>({lsp:{NodeKindProvider:e=>new Wue(e),WorkspaceSymbolProvider:e=>new Gue(e)},workspace:{Cache:e=>new jl(e,Ve.Validated),IndexManager:e=>new jie(e),LangiumDocuments:e=>new zie(e),ProjectsManager:e=>new Zo(e),WorkspaceManager:e=>new Rse(e),FileSystemProvider:e=>t.
fileSystemProvider(e),FileSystemWatcher:e=>t.fileSystemWatcher(e)}});function Ht(t){return e=>new t(e)}const Jue=t=>({documentation:{DocumentationProvider:Ht(Nie)},validation:{DocumentValidator:Ht(aue)},Rpc:Ht(Bue),mcp:{Server:e=>t.mcpServer(e),ServerFactory:Ht(Nle)},likec4:{LanguageServices:Ht(Sse),Layouter:e=>new kL({graphviz:new Zr}),Views:Ht(Kue),ManualLayouts:e=>t.manualLayouts(e),DeploymentsIndex:Ht(Dle),ModelChanges:Ht(Fue),FqnIndex:Ht(kj),ModelParser:Ht(Iue),ModelBuilder:Ht(yce),ModelLocator:Ht(
kce)},lsp:{CompletionProvider:Ht(jse),DocumentHighlightProvider:Ht(qse),DocumentSymbolProvider:Ht(zse),SemanticTokenProvider:Ht(Vse),HoverProvider:Ht(Use),CodeLensProvider:Ht(Lse),DocumentLinkProvider:Ht(Fse),Formatter:Ht(Lie),CodeActionProvider:Ht(Hse)},workspace:{AstNodeDescriptionProvider:Ht(Mie)},references:{NameProvider:Ht(zue),ScopeComputation:Ht(Hue),ScopeProvider:Ht(Vue)},parser:{ValueConverter:Ht(Nue)}});function Yue(t,e,n,r){const i=Xue(t),s=[GZ({shared:i}),U8,Jue({...VL,...qj,...t}),e,
n,r].reduce(Fj,{}),a=Vm(s);return i.ServiceRegistry.register(a),due(a),t.connection?f0(()=>a.Rpc.init()):i.workspace.ConfigurationProvider.initialized({}),{shared:i,likec4:a}}function Xue(t={}){const e={...VL,...GI,...qj,...t};return Vm(ZZ(e),z8,Zue(e))}function Fj(t,e){if(e){for(const[n,r]of Object.entries(e))if(r!==void 0){const i=t[n];i!==null&&r!==null&&typeof i=="object"&&typeof r=="object"?t[n]=Fj(i,r):t[n]=r}}return t}const Que=t=>({start:ji.hrtime.bigint(),command:t.map(e=>ede(Tq(e))).join(
" "),state:{stdout:"",stderr:"",output:"",isIterating:{},nonIterable:[!1,!1]}}),ede=t=>/[^\w./-]/.test(t)?`'${t.replaceAll("'","'\\''")}'`:t,tde=({stdin:t,stdout:e,stderr:n,stdio:r=[t,e,n],env:i,preferLocal:s,cwd:a=".",...o})=>{const l=a instanceof URL?bq(a):ea.resolve(a),c=i?{...ji.env,...i}:void 0,u=r[0]?.string;return{...o,input:u,stdio:u===void 0?r:["pipe",...r.slice(1)],env:s?nde(c??ji.env,l):c,cwd:l}},nde=({Path:t="",PATH:e=t,...n},r)=>{const i=e.split(ea.delimiter),s=zj([],ea.resolve(r)).
map(a=>ea.join(a,"node_modules/.bin")).filter(a=>!i.includes(a));return{...n,PATH:[...s,e].filter(Boolean).join(ea.delimiter)}},zj=(t,e)=>t.at(-1)===e?t:zj([...t,e],ea.resolve(e,"..")),rde=async(t,e,n)=>await ide(t,n)?[N$(t),e.map(r=>cde(r)),{...n,shell:!0}]:[t,e,n],ide=async(t,{shell:e,cwd:n,env:r=ji.env})=>ji.platform==="win32"&&!e&&!await sde(t,n,r),sde=(t,e,{Path:n="",PATH:r=n})=>Hj.some(i=>t.toLowerCase().endsWith(i))||lde(t,e,r),ade={},Uj=t=>(...e)=>ade[e.join("\0")]??=t(...e),ode=Uj(Zq.access),
lde=Uj(async(t,e,n)=>{const r=n.split(ea.delimiter).filter(Boolean).map(i=>i.replace(/^"(.*)"$/,"$1"));try{await Promise.any([e,...r].flatMap(i=>Hj.map(s=>ode(`${ea.resolve(i,t)}${s}`))))}catch{return!1}return!0}),Hj=[".exe",".com"],cde=t=>N$(N$(`"${t.replaceAll(/(\\*)"/g,'$1$1\\"').replace(/(\\*)$/,"$1$1")}"`)),N$=t=>t.replaceAll(/([()\][%!^"`<>&|;, *?])/g,"^$1"),ude=async(t,{input:e},n)=>{const r=await t;e!==void 0&&r.stdin.end(e);const i=h0(r,"close");try{return await Promise.race([i,...r.stdio.
filter(Boolean).map(s=>dde(s))]),fde(n,Bj(r)),Wj(n)}catch(s){throw await Promise.allSettled([i]),Vj(s,r,n)}},dde=async t=>{for await(const[e]of hF(t,"error"))if(!["ERR_STREAM_PREMATURE_CLOSE","EPIPE"].includes(e?.code))throw e},fde=({command:t},{exitCode:e,signalName:n})=>{if(n!==void 0)throw new ol(`Command was terminated with ${n}: ${t}`);if(e!==void 0)throw new ol(`Command failed with exit code ${e}: ${t}`)},Vj=(t,e,n)=>Object.assign(pde(t,n),Bj(e),Wj(n)),pde=(t,{command:e})=>t instanceof ol?
t:new ol(`Command failed: ${e}`,{cause:t});class ol extends Error{name="SubprocessError"}const Bj=({exitCode:t,signalCode:e})=>({...t<1?{}:{exitCode:t},...e===null?{}:{signalName:e}}),Wj=({state:{stdout:t,stderr:e,output:n},command:r,start:i})=>({stdout:D$(t),stderr:D$(e),output:D$(n),command:r,durationMs:Number(ji.hrtime.bigint()-i)/1e6}),D$=t=>t.at(-1)===`
`?t.slice(0,t.at(-2)==="\r"?-2:-1):t,hde=async(t,e,n,r)=>{try{["node","node.exe"].includes(t.toLowerCase())&&(t=ji.execPath,e=[...ji.execArgv.filter(s=>!s.startsWith("--inspect")),...e]),[t,e,n]=await rde(t,e,n),[t,e,n]=mde(t,e,n);const i=NF(t,e,n);return Gj(i.stdout,r,"stdout"),Gj(i.stderr,r,"stderr"),i.once("error",()=>{}),await h0(i,"spawn"),i}catch(i){throw Vj(i,{},r)}},mde=(t,e,n)=>n.shell&&e.length>0?[[t,...e].join(" "),[],n]:[t,e,n],Gj=(t,{state:e},n)=>{t&&(t.setEncoding("utf8"),e.isIterating[n]||
(e.isIterating[n]=!1,t.on("data",r=>{e[n]+=r,e.output+=r})))},gde=async t=>{const[[e,n]]=await Promise.all([Promise.allSettled(t),yde(t)]);if(n.reason)throw n.reason.pipedFrom=e.reason??e.value,n.reason;if(e.reason)throw e.reason;return{...n.value,pipedFrom:e.value}},yde=async t=>{try{const[{stdout:e},{stdin:n}]=await Promise.all(t.map(({nodeChildProcess:r})=>r));if(n===null)throw new Error('The "stdin" option must be set on the first "spawn()" call in the pipeline.');if(e===null)throw new Error(
'The "stdout" option must be set on the last "spawn()" call in the pipeline.');DF(e,n).catch(()=>{})}catch(e){throw await Promise.allSettled(t.map(({nodeChildProcess:n})=>vde(n))),e}},vde=async t=>{const{stdin:e}=await t;e.end()},Kj=async function*(t,{state:e},n,r){if(e.isIterating[n]===!1)throw new Error(`The subprocess must be iterated right away, for example:
	for await (const line of spawn(...)) { ... }`);e.isIterating[n]=!0;try{const{[n]:i}=await t.nodeChildProcess;if(!i){e.nonIterable[r]=!0;const s=e.nonIterable.every(Boolean)?"either the option `stdout` or `stderr`":`the option \`${n}\``;throw new TypeError(`The subprocess cannot be iterated unless ${s} is 'pipe'.`)}wde(t),yield*OF.createInterface({input:i})}finally{await t}},wde=async t=>{try{await t}catch{}},bde=async function*({state:t},...e){try{let n=[];for(;e.length>0;){n=e.map((o,l)=>n[l]??
kde(o,l,t));const[{value:r,done:i},s]=await Promise.race(n.map((o,l)=>Promise.all([o,l]))),[a]=e.splice(s,1);n.splice(s,1),i||(e.push(a),yield r)}}finally{await Promise.all(e.map(n=>n.return()))}},kde=async(t,e,{nonIterable:n})=>{try{return await t.next()}catch(r){return _de(n,e)?t.return():t.throw(r)}},_de=(t,e)=>t.every(Boolean)?e!==t.length-1:t[e];function fh(t,e,n,r){const[i=[],s={}]=Array.isArray(e)?[e,n]:[[],e],a=Que([t,...i]),o=tde(s),l=hde(t,i,o,a);let c=ude(l,o,a);Object.assign(c,{nodeChildProcess:l}),
c=r?gde([r,c]):c;const u=Kj(c,a,"stdout",0),d=Kj(c,a,"stderr",1);return Object.assign(c,{nodeChildProcess:l,stdout:u,stderr:d,[Symbol.asyncIterator]:()=>bde(a,u,d),pipe:(f,p,m)=>fh(f,p,m,c)})}var Ni={},ll={},Zj;function Rde(){if(Zj)return ll;Zj=1,Object.defineProperty(ll,"__esModule",{value:!0}),ll.sync=ll.isexe=void 0;const t=bw,e=w0,n=async(a,o={})=>{const{ignoreErrors:l=!1}=o;try{return i(await(0,e.stat)(a),o)}catch(c){const u=c;if(l||u.code==="EACCES")return!1;throw u}};ll.isexe=n;const r=(a,o={})=>{
const{ignoreErrors:l=!1}=o;try{return i((0,t.statSync)(a),o)}catch(c){const u=c;if(l||u.code==="EACCES")return!1;throw u}};ll.sync=r;const i=(a,o)=>a.isFile()&&s(a,o),s=(a,o)=>{const l=o.uid??process.getuid?.(),c=o.groups??process.getgroups?.()??[],u=o.gid??process.getgid?.()??c[0];if(l===void 0||u===void 0)throw new Error("cannot get uid or gid");const d=new Set([u,...c]),f=a.mode,p=a.uid,m=a.gid,w=parseInt("100",8),v=parseInt("010",8),g=parseInt("001",8),h=w|v;return!!(f&g||f&v&&d.has(m)||f&w&&
p===l||f&h&&l===0)};return ll}var cl={},Jj;function Sde(){if(Jj)return cl;Jj=1,Object.defineProperty(cl,"__esModule",{value:!0}),cl.sync=cl.isexe=void 0;const t=bw,e=w0,n=async(a,o={})=>{const{ignoreErrors:l=!1}=o;try{return s(await(0,e.stat)(a),a,o)}catch(c){const u=c;if(l||u.code==="EACCES")return!1;throw u}};cl.isexe=n;const r=(a,o={})=>{const{ignoreErrors:l=!1}=o;try{return s((0,t.statSync)(a),a,o)}catch(c){const u=c;if(l||u.code==="EACCES")return!1;throw u}};cl.sync=r;const i=(a,o)=>{const{
pathExt:l=process.env.PATHEXT||""}=o,c=l.split(";");if(c.indexOf("")!==-1)return!0;for(let u=0;u<c.length;u++){const d=c[u].toLowerCase(),f=a.substring(a.length-d.length).toLowerCase();if(d&&f===d)return!0}return!1},s=(a,o,l)=>a.isFile()&&i(o,l);return cl}var O$={},Yj;function $de(){return Yj||(Yj=1,Object.defineProperty(O$,"__esModule",{value:!0})),O$}var Xj;function Tde(){return Xj||(Xj=1,(function(t){var e=Ni&&Ni.__createBinding||(Object.create?(function(c,u,d,f){f===void 0&&(f=d);var p=Object.
getOwnPropertyDescriptor(u,d);(!p||("get"in p?!u.__esModule:p.writable||p.configurable))&&(p={enumerable:!0,get:function(){return u[d]}}),Object.defineProperty(c,f,p)}):(function(c,u,d,f){f===void 0&&(f=d),c[f]=u[d]})),n=Ni&&Ni.__setModuleDefault||(Object.create?(function(c,u){Object.defineProperty(c,"default",{enumerable:!0,value:u})}):function(c,u){c.default=u}),r=Ni&&Ni.__importStar||function(c){if(c&&c.__esModule)return c;var u={};if(c!=null)for(var d in c)d!=="default"&&Object.prototype.hasOwnProperty.
call(c,d)&&e(u,c,d);return n(u,c),u},i=Ni&&Ni.__exportStar||function(c,u){for(var d in c)d!=="default"&&!Object.prototype.hasOwnProperty.call(u,d)&&e(u,c,d)};Object.defineProperty(t,"__esModule",{value:!0}),t.sync=t.isexe=t.posix=t.win32=void 0;const s=r(Rde());t.posix=s;const a=r(Sde());t.win32=a,i($de(),t);const l=(process.env._ISEXE_TEST_PLATFORM_||process.platform)==="win32"?a:s;t.isexe=l.isexe,t.sync=l.sync})(Ni)),Ni}var L$,Qj;function Ede(){if(Qj)return L$;Qj=1;const{isexe:t,sync:e}=Tde(),
{join:n,delimiter:r,sep:i,posix:s}=ww,a=process.platform==="win32",o=new RegExp(`[${s.sep}${i===s.sep?"":i}]`.replace(/(\\)/g,"\\$1")),l=new RegExp(`^\\.${o.source}`),c=m=>Object.assign(new Error(`not found: ${m}`),{code:"ENOENT"}),u=(m,{path:w=process.env.PATH,pathExt:v=process.env.PATHEXT,delimiter:g=r})=>{const h=m.match(o)?[""]:[...a?[process.cwd()]:[],...(w||"").split(g)];if(a){const y=v||[".EXE",".CMD",".BAT",".COM"].join(g),b=y.split(g).flatMap(R=>[R,R.toLowerCase()]);return m.includes(".")&&
b[0]!==""&&b.unshift(""),{pathEnv:h,pathExt:b,pathExtExe:y}}return{pathEnv:h,pathExt:[""]}},d=(m,w)=>{const v=/^".*"$/.test(m)?m.slice(1,-1):m;return(!v&&l.test(w)?w.slice(0,2):"")+n(v,w)},f=async(m,w={})=>{const{pathEnv:v,pathExt:g,pathExtExe:h}=u(m,w),y=[];for(const b of v){const R=d(b,m);for(const T of g){const N=R+T;if(await t(N,{pathExt:h,ignoreErrors:!0})){if(!w.all)return N;y.push(N)}}}if(w.all&&y.length)return y;if(w.nothrow)return null;throw c(m)},p=(m,w={})=>{const{pathEnv:v,pathExt:g,
pathExtExe:h}=u(m,w),y=[];for(const b of v){const R=d(b,m);for(const T of g){const N=R+T;if(e(N,{pathExt:h,ignoreErrors:!0})){if(!w.all)return N;y.push(N)}}}if(w.all&&y.length)return y;if(w.nothrow)return null;throw c(m)};return L$=f,f.sync=p,L$}var Pde=Ede();const eq=oo(Pde),Gr=Mr.getChild("graphviz-binary");class Cde{_dotpath;_unflattenpath;constructor(e,n){this._dotpath=e,this._unflattenpath=n}dispose(){}[Symbol.dispose](){}get concurrency(){return Math.max(1,gF.cpus().length-2)}get dotpath(){
return this._dotpath??_h(this,"_dotpath",()=>{const e=eq.sync("dot");return Gr.debug`Found ${e}`,e})}get unflattenpath(){return this._unflattenpath??_h(this,"_unflattenpath",()=>{const e=eq.sync("unflatten");return Gr.debug`Found ${e}`,e})}async unflatten(e){let n;try{const r=await fh(this.unflattenpath,["-l 1","-c 3"],{timeout:1e4,stdin:{string:e}});n=r.stdout,Nt(r.stderr)||Gr.warn(`Command ${r.command} has stderr:
`+r.stderr)}catch(r){Gr.error("FAILED GraphvizBinaryAdapter.unflatten",{error:r}),r instanceof ol&&!Nt(r.stdout)&&(Gr.warn(`Command: '${r.command}' returned result but also failed (exitcode ${r.exitCode}):
`+r.stderr),n=r.stdout)}return n&&(e=n.replaceAll(/\t\[/g," [").replaceAll(/\t/g,"    ")),e}async layoutJson(e){let n;try{const r=await fh(this.dotpath,["-Tjson","-y"],{timeout:1e4,stdin:{string:e}});n=r.stdout,Nt(r.stderr)||Gr.warn(`Command ${r.command} has stderr:
`+r.stderr)}catch(r){if(Gr.error("FAILED GraphvizBinaryAdapter.layoutJson",{error:r}),Gr.warn(`FAILED DOT:
`+e),r instanceof ol&&!Nt(r.stdout))Gr.warn(`Command: '${r.command}' returned result but also failed (exitcode ${r.exitCode}): "${r.stderr}"`),n=r.stdout;else throw r}return n}async acyclic(e){return Promise.reject(new Error("Method not implemented."))}async svg(e){let n;try{const r=await fh(this.dotpath,["-Tsvg","-y"],{timeout:1e4,stdin:{string:e}});n=r.stdout,Nt(r.stderr)||Gr.warn(`Command ${r.command} has stderr:
`+r.stderr)}catch(r){if(Gr.error("FAILED GraphvizBinaryAdapter.svg",{error:r}),Gr.warn(`FAILED DOT:
`+e),r instanceof ol&&!Nt(r.stdout))Gr.warn(`Command: '${r.command}' returned result but also failed (exitcode ${r.exitCode}):
`+r.stderr),n=r.stdout;else throw r}return n}}const xde="likec4",tq="1.47.0",M$=Mr.getChild("cli");function nq(t){const e=Mr.getChild(t);return{info(n){e.info(n)},warn(n){if(n instanceof Error){e.warn(`${Sr.red(n.name+" "+n.message)}`,{msg:n});return}if(typeof n=="string"){e.warn(n);return}e.warn`${n}`},warnOnce(n){e.warn(n)},error(n,r){let i=r?.error??n;if(i instanceof Error){if(n===i){e.error(`${Sr.red(i.name+" "+i.message)}`,{error:i});return}e.error(Sr.red(n),{error:i});return}if(typeof n=="\
string"){e.error(Sr.red(n));return}e.error`${n}`},clearScreen:function(n){},hasErrorLogged:function(n){throw new Error("Function not implemented.")},hasWarned:!1}}const j$=()=>{},Ade={info:j$,warn:j$,error:j$},Ide=1e6;function rq(t){const[e,n]=m0(t),r=e*1e3+n/Ide;return{ms:r,pretty:qL(r)}}function Nde(t){const e=m0();return{stopAndLog(n="done in "){n=Sr.green(`${n}${rq(e).pretty}`),(t||M$).info(n)}}}function Dde(t,e){console.log(IF(t,{padding:1,margin:1,dimBorder:!0,...e}))}class Ode{constructor(e){
this.services=e}isInitialized=!1;async initWorkspace(e){if(this.isInitialized)throw new Error("Workspace already initialized");this.isInitialized=!0;const n=this.services.logger,r=this.services.shared.workspace.WorkspaceManager;n.info(`${Sr.dim("workspace:")} ${e.uri}`),r.initialize({capabilities:{},processId:null,rootUri:null,workspaceFolders:[e]}),await r.initializeWorkspace([e]);const i=this.services.shared.workspace.LangiumDocuments.all.toArray().filter(s=>!Fs(s.uri));if(i.length===0)throw n.
error("no LikeC4 sources found"),new Error("no LikeC4 sources found");n.info(`${Sr.dim("workspace:")} found ${i.length} source files`)}}function Lde(t){return e=>new t(e)}const Mde={logger:()=>{throw new Error("Logger must be provided")},cli:{Workspace:Lde(Ode)}};function iq(t){const e=Iw(t,{useFileSystem:!0,watch:!1,logger:"default",graphviz:"wasm",mcp:!1});let n;switch(e.mcp==="stdio"&&(uA({reset:!0,sinks:{console:P5()}}),e.logger="default"),e.logger){case!1:n=Ade;break;case"vite":n=nq("lang");
break;case"default":n=M$.getChild("lang");break;default:n=e.logger;break}const r=e.graphviz==="binary";n.info(`${Sr.dim("version")} ${tq}`),n.info(`${Sr.dim("layout")} ${r?"binary":"wasm"}`);const i={logger:()=>n,likec4:{Layouter:()=>new kL({graphviz:r?new Cde:new Zr})}},{likec4:s}=Yue({...e.useFileSystem?H7(e.watch):GI,...e.mcp?Dne(e.mcp==="stdio"?"stdio":"sse"):{},...j7},Mde,i);return typeof e.mcp=="object"&&e.mcp.port&&s.mcp.Server.start(e.mcp.port).catch(a=>{n.error(rt(a))}),e.mcp==="stdio"&&
s.mcp.Server.start().catch(a=>{n.error(rt(a))}),s}const sq=t=>new Error(`Invalid model:
${t.getErrors().map(e=>`  ${e.sourceFsPath}:${e.line} ${e.message.slice(0,200)}`).join(`
`)}`);class Ma{constructor(e,n){this.workspace=e,this.langium=n,this.logger=n.logger}static async fromSource(e,n){const r=iq(Iw(n,{useFileSystem:!1,watch:!1,logger:!1,graphviz:"wasm",mcp:!1})),i=ot.from({scheme:"virtual",path:"/workspace"}),s=tt.joinPath(i,"source.likec4"),a=r.shared.workspace.LangiumDocuments.createDocument(s,e);await r.cli.Workspace.initWorkspace({uri:i.toString(),name:"virtual"}),await r.shared.workspace.DocumentBuilder.build([a],{validation:!0});const o=new Ma(i.path,r);return n?.
throwIfInvalid===!0&&o.hasErrors()?(await o.dispose(),Promise.reject(sq(o))):(n?.printErrors!==!1&&o.hasErrors()&&o.printErrors(),o)}static likec4Instances=new Map;static async fromWorkspace(e=".",n){const r=vw(e);if(!mq(r))throw new Error(`Workspace not found: ${r}`);let i=Ma.likec4Instances.get(r);if(!i){const s=iq(Iw(n,{useFileSystem:!0,watch:!1,logger:"default",graphviz:"wasm",mcp:!1}));i=new Ma(r,s),Ma.likec4Instances.set(r,i),await s.cli.Workspace.initWorkspace({uri:kq(r).toString(),name:wq(
r)}),n?.printErrors!==!1&&i.hasErrors()&&i.printErrors()}return n?.throwIfInvalid===!0&&i.hasErrors()?(await i.dispose(),Promise.reject(sq(i))):i}logger;get languageServices(){return this.langium.likec4.LanguageServices}get projectsManager(){return this.langium.shared.workspace.ProjectsManager}get viewsService(){return this.langium.likec4.Views}get LangiumDocuments(){return this.langium.shared.workspace.LangiumDocuments}ensureSingleProject(){const e=this.langium.likec4.LanguageServices.projects();
if(e.length>1)throw this.logger.error(`Multiple projects found:
${e.map(n=>`  - ${n.folder.fsPath}`).join(`
`)}

${Sr.red("Please specify a project folder")}
`),new Error("Multiple projects found")}async diagrams(e){return await this.langium.likec4.Views.diagrams(e)}syncComputedModel(e){const n=this.langium.shared.workspace.ProjectsManager.ensureProjectId(e);return this.langium.likec4.ModelBuilder.unsafeSyncComputeModel(n)}async computedModel(e){return await this.langium.likec4.ModelBuilder.computeModel(e)}projects(){return It(this.langium.likec4.LanguageServices.projects(),_i("id"))}async layoutedModel(e){return await this.langium.likec4.LanguageServices.
layoutedModel(e)}getErrors(){return this.LangiumDocuments.all.toArray().flatMap(e=>(e.diagnostics??[]).filter(n=>n.severity===so.Error).map(({message:n,range:r})=>({message:n,line:r.start.line,range:r,sourceFsPath:e.uri.fsPath})))}hasErrors(){return this.LangiumDocuments.all.some(e=>e.diagnostics?.some(n=>n.severity===so.Error)??!1)}printErrors(){let e=!1;for(const n of this.LangiumDocuments.all){const r=n.diagnostics?.filter(i=>i.severity===1);if(r&&r.length>0){e=!0;const i=r.flatMap(s=>{const a=s.
range.start.line,o=s.message.split(`
`);return o.length>10&&(o.length=10,o.push("...")),o.map((l,c)=>c===0?"    "+Sr.dim(`Line ${a}: `)+Sr.red(l):" ".repeat(10)+Sr.red(l))}).join(`
`);this.logger.error(`Invalid ${n.uri.fsPath}
${i}`)}}return e}onModelUpdate(e){const n=this.langium.likec4.ModelBuilder.onModelParsed(()=>e());return()=>{n.dispose()}}async dispose(){await this.langium.likec4.LanguageServices.dispose();for(const[e,n]of Ma.likec4Instances)n===this&&Ma.likec4Instances.delete(e)}async[Symbol.asyncDispose](){await this.dispose()}}export{ot as $,hse as A,rq as B,et as C,Vs as D,Cv as E,o1 as F,bt as G,I1 as H,c1 as I,R1 as J,B1 as K,Ma as L,K1 as M,j0 as N,J1 as O,Sk as P,i1 as Q,ej as R,Xp as S,vl as T,Ev as U,
Qp as V,fj as W,xde as X,Nt as Y,tq as Z,SS as _,Gm as a,Nde as a0,tt as a1,Cj as a2,uA as a3,lA as a4,E5 as a5,Yk as a6,nt as b,ke as c,ql as d,Gt as e,_l as f,$t as g,nq as h,Xt as i,Hp as j,Mr as k,oo as l,Lr as m,Ss as n,Pc as o,dse as p,M$ as q,Ok as r,fh as s,ii as t,Sr as u,rt as v,sv as w,Dde as x,fa as y,hx as z};
