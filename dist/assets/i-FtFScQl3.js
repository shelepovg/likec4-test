import{r as h,j as n,g as W,i as hl,h as vu,k as hi,R as ln,l as ml,m as O,V as Fa,t as Wa,o as ku,p as fl,n as Le,q as ju,s as Oa,a as Cu,u as mi,v as Su,w as Mr,x as _u,y as mo,z as dn,A as yl,B as Ha,C as ua,D as Me,L as Pu,E as fi,G as on,F as xl,H as bl,I as yi,J as cn,K as ne,M as Mu,N as Nu,O as Eu,P as Iu,Q as Nr}from"./likec4-a5kc96J7.js";import{ay as Er,a6 as I,az as wl,aA as xi,aB as En,a0 as Ru,a1 as je,a2 as bi,aC as wi,aD as rt,aE as ve,aF as Ct,aG as z,aH as vi,aI as vl,aJ as Oe,aK as tt,aL as Ft,aM as kl,aN as bt,aO as Du,aP as jl,ab as Q,aQ as Te,z as ko,aR as he,aS as ee,al as ki,aT as Cl,aU as Bu,aV as Lu,aW as ji,i as q,T as L,aX as st,aY as Ut,aZ as Kt,a_ as In,e as ye,a$ as Xa,b0 as Tu,b1 as Ci,b2 as ge,b3 as He,b4 as St,as as Au,ao as zu,ap as $u,b5 as de,aq as Vu,b6 as Si,B as Ce,b7 as Fu,v as Rn,b8 as re,b9 as Wu,ba as xe,a7 as oe,bb as Ou,bc as Sl,bd as un,be as Be,bf as pn,M as Fe,I as _l,J as Pl,P as Ml,bg as Hu,bh as qe,bi as se,bj as Xu,bk as Nl,bl as vt,bm as qa,bn as qu,bo as Ya,r as ot,bp as _t,bq as _i,br as qt,a8 as Dn,R as El,aa as Bn,G as ce,bs as Ln,bt as Pi,bu as Il,bv as Rl,bw as Tn,a5 as Ze,ax as fo,S as Ee,bx as Yu,by as yo,ar as Xe,bz as An,bA as Gu,bB as Zu,bC as Dl,bD as Ir,bE as Rr,bF as Uu,bG as Ku,bH as Qu,bI as Ju,bJ as Bl,bK as ie,bL as ep,bM as tp,bN as op,bO as np,bP as ap,bQ as ip,bR as De,bS as zn,m as rp,bT as Mi,ag as Ll,ah as Tl,ai as Ga,aj as Vt,bU as sp,bV as lp,bW as dp,bX as uo,bY as pa,bZ as ct,b_ as pt,b$ as A,c0 as Qt,c1 as Ni,c2 as Ei,c3 as Ii,c4 as cp,c5 as $n,c6 as Al,u as up,c7 as pp,c8 as zl,c9 as Vn,ca as gn,h as gp,cb as hp,cc as $l,E as Vl,cd as mp,ce as fp,cf as Ke,cg as Dr,ch as xo,ci as yp,cj as xp,ck as Fl,cl as Et,cm as bp,cn as wp,co as Pt,cp as Wl,cq as Ri,cr as Ol,cs as vp,ct as kp,cu as jp,cv as hn,cw as Fn,cx as Hl,cy as mn,cz as Di,cA as Br,cB as Oo,j as po,t as Wt,cC as Cp,cD as Sp,cE as Xl,cF as Lr,cG as _p,cH as Tr,cI as Pp,cJ as Mp,cK as Np,cL as Ep,cM as Ip,cN as Ar,cO as ql,cP as Rp,cQ as Dp,cR as Bp,cS as Yl,cT as Ue,cU as Lp,cV as Gl,cW as zr,cX as jo,cY as Tp,cZ as Zl,c_ as $r,c$ as Ap,d0 as Ul,d1 as zp,a3 as $p,d2 as Vp,d3 as Fp,d4 as Wp,q as Op,au as Hp,d5 as Xp,d6 as qp,d7 as bo,d8 as Yp,d9 as Vr,da as Kl,db as co,dc as Za,A as Fr,dd as Wr,de as Gp,df as Zp,dg as Wn,dh as Up,di as Kp,dj as Qp,dk as Jp,dl as eg,dm as fn,dn as tg}from"./e-DJqzgwkh.js";function yn(e){return typeof e=="object"&&e!=null&&!Array.isArray(e)}var og=e=>typeof e=="object"&&e!==null;function It(e){return Object.fromEntries(Object.entries(e??{}).filter(([t,o])=>o!==void 0))}var ng=e=>e==="base";function ag(e){return e.slice().filter(t=>!ng(t))}function Or(e){return String.fromCharCode(e+(e>25?39:97))}function ig(e){let t="",o;for(o=Math.abs(e);o>52;o=o/52|0)t=Or(o%52)+t;return Or(o%52)+t}function rg(e,t){let o=t.length;for(;o;)e=e*33^t.charCodeAt(--o);return e}function sg(e){return ig(rg(5381,e)>>>0)}var Ql=/\s*!(important)?/i;function lg(e){return typeof e=="string"?Ql.test(e):!1}function dg(e){return typeof e=="string"?e.replace(Ql,"").trim():e}function Bi(e){return typeof e=="string"?e.replaceAll(" ","_"):e}var be=e=>{const t=new Map;return(...o)=>{const a=JSON.stringify(o);if(t.has(a))return t.get(a);const i=e(...o);return t.set(a,i),i}},cg=new Set(["__proto__","constructor","prototype"]);function Li(...e){return e.reduce((t,o)=>(o&&Object.keys(o).forEach(a=>{if(cg.has(a))return;const i=t[a],r=o[a];yn(i)&&yn(r)?t[a]=Li(i,r):t[a]=r}),t),{})}var ug=e=>e!=null;function Ti(e,t,o={}){const{stop:a,getKey:i}=o;function r(s,l=[]){if(og(s)){const d={};for(const[u,c]of Object.entries(s)){const p=i?.(u,c)??u,g=[...l,p];if(a?.(s,g))return t(s,l);const m=r(c,g);ug(m)&&(d[p]=m)}return d}return t(s,l)}return r(e)}function pg(e,t){return Array.isArray(e)?e.map(o=>t(o)):yn(e)?Ti(e,o=>t(o)):t(e)}function gg(e,t){return e.reduce((o,a,i)=>{const r=t[i];return a!=null&&(o[r]=a),o},{})}function Jl(e,t,o=!0){const{utility:a,conditions:i}=t,{hasShorthand:r,resolveShorthand:s}=a;return Ti(e,l=>Array.isArray(l)?gg(l,i.breakpoints.keys):l,{stop:l=>Array.isArray(l),getKey:o?l=>r?s(l):l:void 0})}var hg={shift:e=>e,finalize:e=>e,breakpoints:{keys:[]}},mg=e=>typeof e=="string"?e.replaceAll(/[\n\s]+/g," "):e;function ed(e){const{utility:t,hash:o,conditions:a=hg}=e,i=s=>[t.prefix,s].filter(Boolean).join("-"),r=(s,l)=>{let d;if(o){const u=[...a.finalize(s),l];d=i(t.toHash(u,sg))}else d=[...a.finalize(s),i(l)].join(":");return d};return be(({base:s,...l}={})=>{const d=Object.assign(l,s),u=Jl(d,e),c=new Set;return Ti(u,(p,g)=>{if(p==null)return;const m=lg(p),[y,...w]=a.shift(g),C=ag(w),b=t.transform(y,dg(mg(p)));let v=r(C,b.className);m&&(v=`${v}!`),c.add(v)}),Array.from(c).join(" ")})}function fg(...e){return e.flat().filter(t=>yn(t)&&Object.keys(It(t)).length>0)}function yg(e){function t(i){const r=fg(...i);return r.length===1?r:r.map(s=>Jl(s,e))}function o(...i){return Li(...t(i))}function a(...i){return Object.assign({},...t(i))}return{mergeCss:be(o),assignCss:a}}var xg=/([A-Z])/g,bg=/^ms-/,wg=be(e=>e.startsWith("--")?e:e.replace(xg,"-$1").replace(bg,"-ms-").toLowerCase()),vg=["min","max","clamp","calc"],kg=new RegExp(`^(${vg.join("|")})\\(.*\\)`),jg=e=>typeof e=="string"&&kg.test(e),Cg="cm,mm,Q,in,pc,pt,px,em,ex,ch,rem,lh,rlh,vw,vh,vmin,vmax,vb,vi,svw,svh,lvw,lvh,dvw,dvh,cqw,cqh,cqi,cqb,cqmin,cqmax,%",Sg=`(?:${Cg.split(",").join("|")})`,_g=new RegExp(`^[+-]?[0-9]*.?[0-9]+(?:[eE][+-]?[0-9]+)?${Sg}$`),Pg=e=>typeof e=="string"&&_g.test(e),Mg=e=>typeof e=="string"&&/^var\(--.+\)$/.test(e),Co={map:pg,isCssFunction:jg,isCssVar:Mg,isCssUnit:Pg},So=(e,t)=>{if(!e?.defaultValues)return t;const o=typeof e.defaultValues=="function"?e.defaultValues(t):e.defaultValues;return Object.assign({},o,It(t))},Ng=(e={})=>{const t=a=>({className:[e.className,a].filter(Boolean).join("__"),base:e.base?.[a]??{},variants:{},defaultVariants:e.defaultVariants??{},compoundVariants:e.compoundVariants?Ai(e.compoundVariants,a):[]}),o=(e.slots??[]).map(a=>[a,t(a)]);for(const[a,i]of Object.entries(e.variants??{}))for(const[r,s]of Object.entries(i))o.forEach(([l,d])=>{d.variants[a]??={},d.variants[a][r]=s[l]??{}});return Object.fromEntries(o)},Ai=(e,t)=>e.filter(o=>o.css[t]).map(o=>({...o,css:o.css[t]}));function fe(e,...t){const o=Object.getOwnPropertyDescriptors(e),a=Object.keys(o),i=s=>{const l={};for(let d=0;d<s.length;d++){const u=s[d];o[u]&&(Object.defineProperty(l,u,o[u]),delete o[u])}return l},r=s=>i(Array.isArray(s)?s:a.filter(s));return t.map(r).concat(i(a))}var Ua=(...e)=>{const t=e.reduce((o,a)=>(a&&a.forEach(i=>o.add(i)),o),new Set([]));return Array.from(t)},td=["htmlSize","htmlTranslate","htmlWidth","htmlHeight"];function Eg(e){return td.includes(e)?e.replace("html","").toLowerCase():e}function Ka(e){return Object.fromEntries(Object.entries(e).map(([t,o])=>[Eg(t),o]))}Ka.keys=td;const Ig="_hover,_focus,_focusWithin,_focusVisible,_disabled,_active,_visited,_target,_readOnly,_readWrite,_empty,_checked,_enabled,_expanded,_highlighted,_complete,_incomplete,_dragging,_before,_after,_firstLetter,_firstLine,_marker,_selection,_file,_backdrop,_first,_last,_only,_even,_odd,_firstOfType,_lastOfType,_onlyOfType,_peerFocus,_peerHover,_peerActive,_peerFocusWithin,_peerFocusVisible,_peerDisabled,_peerChecked,_peerInvalid,_peerExpanded,_peerPlaceholderShown,_groupFocus,_groupHover,_groupActive,_groupFocusWithin,_groupFocusVisible,_groupDisabled,_groupChecked,_groupExpanded,_groupInvalid,_indeterminate,_required,_valid,_invalid,_autofill,_inRange,_outOfRange,_placeholder,_placeholderShown,_pressed,_selected,_grabbed,_underValue,_overValue,_atValue,_default,_optional,_open,_closed,_fullscreen,_loading,_hidden,_current,_currentPage,_currentStep,_today,_unavailable,_rangeStart,_rangeEnd,_now,_topmost,_motionReduce,_motionSafe,_print,_landscape,_portrait,_dark,_light,_osDark,_osLight,_highContrast,_lessContrast,_moreContrast,_ltr,_rtl,_scrollbar,_scrollbarThumb,_scrollbarTrack,_horizontal,_vertical,_icon,_starting,_noscript,_invertedColors,_shapeSizeXs,_shapeSizeSm,_shapeSizeMd,_shapeSizeLg,_shapeSizeXl,_shapeRectangle,_shapePerson,_shapeBrowser,_shapeMobile,_shapeCylinder,_shapeStorage,_shapeQueue,_notDisabled,_reduceGraphics,_reduceGraphicsOnPan,_noReduceGraphics,_whenPanning,_smallZoom,_compoundTransparent,_edgeActive,_whenHovered,_whenSelectable,_whenSelected,_whenDimmed,_whenFocused,_p3,_srgb,_rec2020,xs,xsOnly,xsDown,sm,smOnly,smDown,md,mdOnly,mdDown,lg,lgOnly,lgDown,xl,xlOnly,xlDown,xsToSm,xsToMd,xsToLg,xsToXl,smToMd,smToLg,smToXl,mdToLg,mdToXl,lgToXl,@/xs,@/sm,@/md,@/lg,@likec4-root/xs,@likec4-root/sm,@likec4-root/md,@likec4-root/lg,@likec4-dialog/xs,@likec4-dialog/sm,@likec4-dialog/md,@likec4-dialog/lg,base",od=new Set(Ig.split(",")),Rg=/^@|&|&$/;function Hr(e){return od.has(e)||Rg.test(e)}const Dg=/^_/,Bg=/&|@/;function nd(e){return e.map(t=>od.has(t)?t.replace(Dg,""):Bg.test(t)?`[${Bi(t.trim())}]`:t)}function ad(e){return e.sort((t,o)=>{const a=Hr(t),i=Hr(o);return a&&!i?1:!a&&i?-1:0})}const Lg="aspectRatio:asp,boxDecorationBreak:bx-db,zIndex:z,boxSizing:bx-s,objectPosition:obj-p,objectFit:obj-f,overscrollBehavior:ovs-b,overscrollBehaviorX:ovs-bx,overscrollBehaviorY:ovs-by,position:pos/1,top:top,left:left,inset:inset,insetInline:inset-x/insetX,insetBlock:inset-y/insetY,insetBlockEnd:inset-be,insetBlockStart:inset-bs,insetInlineEnd:inset-e/insetEnd/end,insetInlineStart:inset-s/insetStart/start,right:right,bottom:bottom,float:float,visibility:vis,display:d,hideFrom:hide,hideBelow:show,flexBasis:flex-b,flex:flex,flexDirection:flex-d/flexDir,flexGrow:flex-g,flexShrink:flex-sh,gridTemplateColumns:grid-tc,gridTemplateRows:grid-tr,gridColumn:grid-c,gridRow:grid-r,gridColumnStart:grid-cs,gridColumnEnd:grid-ce,gridAutoFlow:grid-af,gridAutoColumns:grid-ac,gridAutoRows:grid-ar,gap:gap,gridGap:grid-g,gridRowGap:grid-rg,gridColumnGap:grid-cg,rowGap:rg,columnGap:cg,justifyContent:jc,alignContent:ac,alignItems:ai,alignSelf:as,padding:p/1,paddingLeft:pl/1,paddingRight:pr/1,paddingTop:pt/1,paddingBottom:pb/1,paddingBlock:py/1/paddingY,paddingBlockEnd:pbe,paddingBlockStart:pbs,paddingInline:px/paddingX/1,paddingInlineEnd:pe/1/paddingEnd,paddingInlineStart:ps/1/paddingStart,marginLeft:ml/1,marginRight:mr/1,marginTop:mt/1,marginBottom:mb/1,margin:m/1,marginBlock:my/1/marginY,marginBlockEnd:mbe,marginBlockStart:mbs,marginInline:mx/1/marginX,marginInlineEnd:me/1/marginEnd,marginInlineStart:ms/1/marginStart,spaceX:sx,spaceY:sy,outlineWidth:ring-w/ringWidth,outlineColor:ring-c/ringColor,outline:ring/1,outlineOffset:ring-o/ringOffset,focusRing:focus-ring,focusVisibleRing:focus-v-ring,focusRingColor:focus-ring-c,focusRingOffset:focus-ring-o,focusRingWidth:focus-ring-w,focusRingStyle:focus-ring-s,divideX:dvd-x,divideY:dvd-y,divideColor:dvd-c,divideStyle:dvd-s,width:w/1,inlineSize:w-is,minWidth:min-w/minW,minInlineSize:min-w-is,maxWidth:max-w/maxW,maxInlineSize:max-w-is,height:h/1,blockSize:h-bs,minHeight:min-h/minH,minBlockSize:min-h-bs,maxHeight:max-h/maxH,maxBlockSize:max-b,boxSize:size,color:c,fontFamily:ff,fontSize:fs,fontSizeAdjust:fs-a,fontPalette:fp,fontKerning:fk,fontFeatureSettings:ff-s,fontWeight:fw,fontSmoothing:fsmt,fontVariant:fv,fontVariantAlternates:fv-alt,fontVariantCaps:fv-caps,fontVariationSettings:fv-s,fontVariantNumeric:fv-num,letterSpacing:ls,lineHeight:lh,textAlign:ta,textDecoration:td,textDecorationColor:td-c,textEmphasisColor:te-c,textDecorationStyle:td-s,textDecorationThickness:td-t,textUnderlineOffset:tu-o,textTransform:tt,textIndent:ti,textShadow:tsh,textShadowColor:tsh-c/textShadowColor,textOverflow:tov,verticalAlign:va,wordBreak:wb,textWrap:tw,truncate:trunc,lineClamp:lc,listStyleType:li-t,listStylePosition:li-pos,listStyleImage:li-img,listStyle:li-s,backgroundPosition:bg-p/bgPosition,backgroundPositionX:bg-p-x/bgPositionX,backgroundPositionY:bg-p-y/bgPositionY,backgroundAttachment:bg-a/bgAttachment,backgroundClip:bg-cp/bgClip,background:bg/1,backgroundColor:bg-c/bgColor,backgroundOrigin:bg-o/bgOrigin,backgroundImage:bg-i/bgImage,backgroundRepeat:bg-r/bgRepeat,backgroundBlendMode:bg-bm/bgBlendMode,backgroundSize:bg-s/bgSize,backgroundGradient:bg-grad/bgGradient,backgroundLinear:bg-linear/bgLinear,backgroundRadial:bg-radial/bgRadial,backgroundConic:bg-conic/bgConic,textGradient:txt-grad,gradientFromPosition:grad-from-pos,gradientToPosition:grad-to-pos,gradientFrom:grad-from,gradientTo:grad-to,gradientVia:grad-via,gradientViaPosition:grad-via-pos,borderRadius:bdr/rounded,borderTopLeftRadius:bdr-tl/roundedTopLeft,borderTopRightRadius:bdr-tr/roundedTopRight,borderBottomRightRadius:bdr-br/roundedBottomRight,borderBottomLeftRadius:bdr-bl/roundedBottomLeft,borderTopRadius:bdr-t/roundedTop,borderRightRadius:bdr-r/roundedRight,borderBottomRadius:bdr-b/roundedBottom,borderLeftRadius:bdr-l/roundedLeft,borderStartStartRadius:bdr-ss/roundedStartStart,borderStartEndRadius:bdr-se/roundedStartEnd,borderStartRadius:bdr-s/roundedStart,borderEndStartRadius:bdr-es/roundedEndStart,borderEndEndRadius:bdr-ee/roundedEndEnd,borderEndRadius:bdr-e/roundedEnd,border:bd,borderWidth:bd-w,borderTopWidth:bd-t-w,borderLeftWidth:bd-l-w,borderRightWidth:bd-r-w,borderBottomWidth:bd-b-w,borderBlockStartWidth:bd-bs-w,borderBlockEndWidth:bd-be-w,borderColor:bd-c,borderInline:bd-x/borderX,borderInlineWidth:bd-x-w/borderXWidth,borderInlineColor:bd-x-c/borderXColor,borderBlock:bd-y/borderY,borderBlockWidth:bd-y-w/borderYWidth,borderBlockColor:bd-y-c/borderYColor,borderLeft:bd-l,borderLeftColor:bd-l-c,borderInlineStart:bd-s/borderStart,borderInlineStartWidth:bd-s-w/borderStartWidth,borderInlineStartColor:bd-s-c/borderStartColor,borderRight:bd-r,borderRightColor:bd-r-c,borderInlineEnd:bd-e/borderEnd,borderInlineEndWidth:bd-e-w/borderEndWidth,borderInlineEndColor:bd-e-c/borderEndColor,borderTop:bd-t,borderTopColor:bd-t-c,borderBottom:bd-b,borderBottomColor:bd-b-c,borderBlockEnd:bd-be,borderBlockEndColor:bd-be-c,borderBlockStart:bd-bs,borderBlockStartColor:bd-bs-c,opacity:op,boxShadow:bx-sh/shadow,boxShadowColor:bx-sh-c/shadowColor,mixBlendMode:mix-bm,filter:filter,brightness:brightness,contrast:contrast,grayscale:grayscale,hueRotate:hue-rotate,invert:invert,saturate:saturate,sepia:sepia,dropShadow:drop-shadow,blur:blur,backdropFilter:bkdp,backdropBlur:bkdp-blur,backdropBrightness:bkdp-brightness,backdropContrast:bkdp-contrast,backdropGrayscale:bkdp-grayscale,backdropHueRotate:bkdp-hue-rotate,backdropInvert:bkdp-invert,backdropOpacity:bkdp-opacity,backdropSaturate:bkdp-saturate,backdropSepia:bkdp-sepia,borderCollapse:bd-cl,borderSpacing:bd-sp,borderSpacingX:bd-sx,borderSpacingY:bd-sy,tableLayout:tbl,transitionTimingFunction:trs-tmf,transitionDelay:trs-dly,transitionDuration:trs-dur,transitionProperty:trs-prop,transition:transition,animation:anim,animationName:anim-n,animationTimingFunction:anim-tmf,animationDuration:anim-dur,animationDelay:anim-dly,animationPlayState:anim-ps,animationComposition:anim-comp,animationFillMode:anim-fm,animationDirection:anim-dir,animationIterationCount:anim-ic,animationRange:anim-r,animationState:anim-s,animationRangeStart:anim-rs,animationRangeEnd:anim-re,animationTimeline:anim-tl,transformOrigin:trf-o,transformBox:trf-b,transformStyle:trf-s,transform:trf,rotate:rotate,rotateX:rotate-x,rotateY:rotate-y,rotateZ:rotate-z,scale:scale,scaleX:scale-x,scaleY:scale-y,translate:translate,translateX:translate-x/x,translateY:translate-y/y,translateZ:translate-z/z,accentColor:ac-c,caretColor:ca-c,scrollBehavior:scr-bhv,scrollbar:scr-bar,scrollbarColor:scr-bar-c,scrollbarGutter:scr-bar-g,scrollbarWidth:scr-bar-w,scrollMargin:scr-m,scrollMarginLeft:scr-ml,scrollMarginRight:scr-mr,scrollMarginTop:scr-mt,scrollMarginBottom:scr-mb,scrollMarginBlock:scr-my/scrollMarginY,scrollMarginBlockEnd:scr-mbe,scrollMarginBlockStart:scr-mbt,scrollMarginInline:scr-mx/scrollMarginX,scrollMarginInlineEnd:scr-me,scrollMarginInlineStart:scr-ms,scrollPadding:scr-p,scrollPaddingBlock:scr-py/scrollPaddingY,scrollPaddingBlockStart:scr-pbs,scrollPaddingBlockEnd:scr-pbe,scrollPaddingInline:scr-px/scrollPaddingX,scrollPaddingInlineEnd:scr-pe,scrollPaddingInlineStart:scr-ps,scrollPaddingLeft:scr-pl,scrollPaddingRight:scr-pr,scrollPaddingTop:scr-pt,scrollPaddingBottom:scr-pb,scrollSnapAlign:scr-sa,scrollSnapStop:scrs-s,scrollSnapType:scrs-t,scrollSnapStrictness:scrs-strt,scrollSnapMargin:scrs-m,scrollSnapMarginTop:scrs-mt,scrollSnapMarginBottom:scrs-mb,scrollSnapMarginLeft:scrs-ml,scrollSnapMarginRight:scrs-mr,scrollSnapCoordinate:scrs-c,scrollSnapDestination:scrs-d,scrollSnapPointsX:scrs-px,scrollSnapPointsY:scrs-py,scrollSnapTypeX:scrs-tx,scrollSnapTypeY:scrs-ty,scrollTimeline:scrtl,scrollTimelineAxis:scrtl-a,scrollTimelineName:scrtl-n,touchAction:tch-a,userSelect:us,overflow:ov,overflowWrap:ov-wrap,overflowX:ov-x,overflowY:ov-y,overflowAnchor:ov-a,overflowBlock:ov-b,overflowInline:ov-i,overflowClipBox:ovcp-bx,overflowClipMargin:ovcp-m,overscrollBehaviorBlock:ovs-bb,overscrollBehaviorInline:ovs-bi,fill:fill,stroke:stk,strokeWidth:stk-w,strokeDasharray:stk-dsh,strokeDashoffset:stk-do,strokeLinecap:stk-lc,strokeLinejoin:stk-lj,strokeMiterlimit:stk-ml,strokeOpacity:stk-op,srOnly:sr,debug:debug,appearance:ap,backfaceVisibility:bfv,clipPath:cp-path,hyphens:hy,mask:msk,maskImage:msk-i,maskSize:msk-s,textSizeAdjust:txt-adj,container:cq,containerName:cq-n,containerType:cq-t,cursor:cursor,textStyle:textStyle,layerStyle:layerStyle,animationStyle:animationStyle",id=new Map,rd=new Map;Lg.split(",").forEach(e=>{const[t,o]=e.split(":"),[a,...i]=o.split("/");id.set(t,a),i.length&&i.forEach(r=>{rd.set(r==="1"?a:r,t)})});const Xr=e=>rd.get(e)||e,sd={conditions:{shift:ad,finalize:nd,breakpoints:{keys:["base","xs","sm","md","lg","xl"]}},utility:{transform:(e,t)=>{const o=Xr(e);return{className:`${id.get(o)||wg(o)}_${Bi(t)}`}},hasShorthand:!0,toHash:(e,t)=>t(e.join(":")),resolveShorthand:Xr}},Tg=ed(sd),x=(...e)=>Tg(wt(...e));x.raw=(...e)=>wt(...e);const{mergeCss:wt}=yg(sd);function P(){let e="",t=0,o;for(;t<arguments.length;)(o=arguments[t++])&&typeof o=="string"&&(e&&(e+=" "),e+=o);return e}const qr=e=>({base:{},variants:{},defaultVariants:{},compoundVariants:[],...e});function _o(e){const{base:t,variants:o,defaultVariants:a,compoundVariants:i}=qr(e),r=g=>({...a,...It(g)});function s(g={}){const m=r(g);let y={...t};for(const[C,b]of Object.entries(m))o[C]?.[b]&&(y=wt(y,o[C][b]));const w=Qa(i,m);return wt(y,w)}function l(g){const m=qr(g.config),y=Ua(g.variantKeys,Object.keys(o));return _o({base:wt(t,m.base),variants:Object.fromEntries(y.map(w=>[w,wt(o[w],m.variants[w])])),defaultVariants:Li(a,m.defaultVariants),compoundVariants:[...i,...m.compoundVariants]})}function d(g){return x(s(g))}const u=Object.keys(o);function c(g){return fe(g,u)}const p=Object.fromEntries(Object.entries(o).map(([g,m])=>[g,Object.keys(m)]));return Object.assign(be(d),{__cva__:!0,variantMap:p,variantKeys:u,raw:s,config:e,merge:l,splitVariantProps:c,getVariantProps:r})}function Qa(e,t){let o={};return e.forEach(a=>{Object.entries(a).every(([i,r])=>i==="css"?!0:(Array.isArray(r)?r:[r]).some(s=>t[i]===s))&&(o=wt(o,a.css))}),o}function Ag(e,t,o,a){if(t.length>0&&typeof o?.[a]=="object")throw new Error(`[recipe:${e}:${a}] Conditions are not supported when using compound variants.`)}function zg(e){const t=Object.entries(Ng(e)).map(([p,g])=>[p,_o(g)]),o=e.defaultVariants??{},a=t.reduce((p,[g,m])=>(e.className&&(p[g]=m.config.className),p),{});function i(p){const g=t.map(([m,y])=>[m,P(y(p),a[m])]);return Object.fromEntries(g)}function r(p){const g=t.map(([m,y])=>[m,y.raw(p)]);return Object.fromEntries(g)}const s=e.variants??{},l=Object.keys(s);function d(p){return fe(p,l)}const u=p=>({...o,...It(p)}),c=Object.fromEntries(Object.entries(s).map(([p,g])=>[p,Object.keys(g)]));return Object.assign(be(i),{__cva__:!1,raw:r,config:e,variantMap:c,variantKeys:l,classNameMap:a,splitVariantProps:d,getVariantProps:u})}var $g={outline:{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"},filled:{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"currentColor",stroke:"none"}};const T=(e,t,o,a)=>{const i=h.forwardRef(({color:r="currentColor",size:s=24,stroke:l=2,title:d,className:u,children:c,...p},g)=>h.createElement("svg",{ref:g,...$g[e],width:s,height:s,className:["tabler-icon",`tabler-icon-${t}`,u].join(" "),...e==="filled"?{fill:r}:{strokeWidth:l,stroke:r},...p},[d&&h.createElement("title",{key:"svg-title"},d),...a.map(([m,y])=>h.createElement(m,y)),...Array.isArray(c)?c:[c]]));return i.displayName=`${o}`,i},Vg=[["path",{d:"M12 9v4",key:"svg-0"}],["path",{d:"M10.363 3.591l-8.106 13.534a1.914 1.914 0 0 0 1.636 2.871h16.214a1.914 1.914 0 0 0 1.636 -2.87l-8.106 -13.536a1.914 1.914 0 0 0 -3.274 0z",key:"svg-1"}],["path",{d:"M12 16h.01",key:"svg-2"}]],ld=T("outline","alert-triangle","AlertTriangle",Vg),Fg=[["path",{d:"M7 7l10 10",key:"svg-0"}],["path",{d:"M17 8l0 9l-9 0",key:"svg-1"}]],Wg=T("outline","arrow-down-right","ArrowDownRight",Fg),Og=[["path",{d:"M5 12l14 0",key:"svg-0"}],["path",{d:"M5 12l6 6",key:"svg-1"}],["path",{d:"M5 12l6 -6",key:"svg-2"}]],Hg=T("outline","arrow-left","ArrowLeft",Og),Xg=[["path",{d:"M5 12l14 0",key:"svg-0"}],["path",{d:"M13 18l6 -6",key:"svg-1"}],["path",{d:"M13 6l6 6",key:"svg-2"}]],Yt=T("outline","arrow-right","ArrowRight",Xg),qg=[["path",{d:"M13 3l0 7l6 0l-8 11l0 -7l-6 0l8 -11",key:"svg-0"}]],Yg=T("outline","bolt","Bolt",qg),Gg=[["path",{d:"M4 8h16",key:"svg-0"}],["path",{d:"M4 4m0 2a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2z",key:"svg-1"}],["path",{d:"M8 4v4",key:"svg-2"}]],Zg=T("outline","browser","Browser",Gg),Ug=[["path",{d:"M5 12l5 5l10 -10",key:"svg-0"}]],dd=T("outline","check","Check",Ug),Kg=[["path",{d:"M6 9l6 6l6 -6",key:"svg-0"}]],zi=T("outline","chevron-down","ChevronDown",Kg),Qg=[["path",{d:"M15 6l-6 6l6 6",key:"svg-0"}]],cd=T("outline","chevron-left","ChevronLeft",Qg),Jg=[["path",{d:"M9 6l6 6l-6 6",key:"svg-0"}]],gt=T("outline","chevron-right","ChevronRight",Jg),eh=[["path",{d:"M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z",key:"svg-0"}],["path",{d:"M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1",key:"svg-1"}]],th=T("outline","copy","Copy",eh),oh=[["path",{d:"M12 6m-7 0a7 3 0 1 0 14 0a7 3 0 1 0 -14 0",key:"svg-0"}],["path",{d:"M5 6v12c0 1.657 3.134 3 7 3s7 -1.343 7 -3v-12",key:"svg-1"}]],Yr=T("outline","cylinder","Cylinder",oh),nh=[["path",{d:"M6 5a2 2 0 0 1 2 -2h8a2 2 0 0 1 2 2v14a2 2 0 0 1 -2 2h-8a2 2 0 0 1 -2 -2v-14z",key:"svg-0"}],["path",{d:"M11 4h2",key:"svg-1"}],["path",{d:"M12 17v.01",key:"svg-2"}]],ah=T("outline","device-mobile","DeviceMobile",nh),ih=[["path",{d:"M12 6h-6a2 2 0 0 0 -2 2v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-6",key:"svg-0"}],["path",{d:"M11 13l9 -9",key:"svg-1"}],["path",{d:"M15 4h5v5",key:"svg-2"}]],ud=T("outline","external-link","ExternalLink",ih),rh=[["path",{d:"M14 3v4a1 1 0 0 0 1 1h4",key:"svg-0"}],["path",{d:"M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z",key:"svg-1"}],["path",{d:"M10 13l-1 2l1 2",key:"svg-2"}],["path",{d:"M14 13l1 2l-1 2",key:"svg-3"}]],ak=T("outline","file-code","FileCode",rh),sh=[["path",{d:"M4 21v-4a3 3 0 0 1 3 -3h5",key:"svg-0"}],["path",{d:"M9 17l3 -3l-3 -3",key:"svg-1"}],["path",{d:"M14 3v4a1 1 0 0 0 1 1h4",key:"svg-2"}],["path",{d:"M5 11v-6a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2h-9.5",key:"svg-3"}]],Jt=T("outline","file-symlink","FileSymlink",sh),lh=[["path",{d:"M12 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-0"}],["path",{d:"M4 8v-2a2 2 0 0 1 2 -2h2",key:"svg-1"}],["path",{d:"M4 16v2a2 2 0 0 0 2 2h2",key:"svg-2"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v2",key:"svg-3"}],["path",{d:"M16 20h2a2 2 0 0 0 2 -2v-2",key:"svg-4"}]],dh=T("outline","focus-centered","FocusCentered",lh),ch=[["path",{d:"M5 19l2.757 -7.351a1 1 0 0 1 .936 -.649h12.307a1 1 0 0 1 .986 1.164l-.996 5.211a2 2 0 0 1 -1.964 1.625h-14.026a2 2 0 0 1 -2 -2v-11a2 2 0 0 1 2 -2h4l3 3h7a2 2 0 0 1 2 2v2",key:"svg-0"}]],ik=T("outline","folder-open","FolderOpen",ch),uh=[["path",{d:"M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0",key:"svg-0"}],["path",{d:"M12 16v.01",key:"svg-1"}],["path",{d:"M12 13a2 2 0 0 0 .914 -3.782a1.98 1.98 0 0 0 -2.414 .483",key:"svg-2"}]],ph=T("outline","help-circle","HelpCircle",uh),gh=[["path",{d:"M3 4m0 3a3 3 0 0 1 3 -3h12a3 3 0 0 1 3 3v10a3 3 0 0 1 -3 3h-12a3 3 0 0 1 -3 -3z",key:"svg-0"}],["path",{d:"M9 10m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0",key:"svg-1"}],["path",{d:"M15 8l2 0",key:"svg-2"}],["path",{d:"M15 12l2 0",key:"svg-3"}],["path",{d:"M7 16l10 0",key:"svg-4"}]],$i=T("outline","id","Id",gh),hh=[["path",{d:"M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0",key:"svg-0"}],["path",{d:"M12 9h.01",key:"svg-1"}],["path",{d:"M11 12h1v4h1",key:"svg-2"}]],Po=T("outline","info-circle","InfoCircle",hh),mh=[["path",{d:"M4 20l16 0",key:"svg-0"}],["path",{d:"M9 4m0 2a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-2a2 2 0 0 1 -2 -2z",key:"svg-1"}]],fh=T("outline","layout-align-bottom","LayoutAlignBottom",mh),yh=[["path",{d:"M12 4l0 5",key:"svg-0"}],["path",{d:"M12 15l0 5",key:"svg-1"}],["path",{d:"M6 9m0 2a2 2 0 0 1 2 -2h8a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-8a2 2 0 0 1 -2 -2z",key:"svg-2"}]],xh=T("outline","layout-align-center","LayoutAlignCenter",yh),bh=[["path",{d:"M4 4l0 16",key:"svg-0"}],["path",{d:"M8 9m0 2a2 2 0 0 1 2 -2h8a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-8a2 2 0 0 1 -2 -2z",key:"svg-1"}]],wh=T("outline","layout-align-left","LayoutAlignLeft",bh),vh=[["path",{d:"M4 12l5 0",key:"svg-0"}],["path",{d:"M15 12l5 0",key:"svg-1"}],["path",{d:"M9 6m0 2a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-2a2 2 0 0 1 -2 -2z",key:"svg-2"}]],kh=T("outline","layout-align-middle","LayoutAlignMiddle",vh),jh=[["path",{d:"M20 4l0 16",key:"svg-0"}],["path",{d:"M4 9m0 2a2 2 0 0 1 2 -2h8a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-8a2 2 0 0 1 -2 -2z",key:"svg-1"}]],Ch=T("outline","layout-align-right","LayoutAlignRight",jh),Sh=[["path",{d:"M4 4l16 0",key:"svg-0"}],["path",{d:"M9 8m0 2a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-2a2 2 0 0 1 -2 -2z",key:"svg-1"}]],_h=T("outline","layout-align-top","LayoutAlignTop",Sh),Ph=[["path",{d:"M4 4m0 2a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2z",key:"svg-0"}],["path",{d:"M4 12h8",key:"svg-1"}],["path",{d:"M12 15h8",key:"svg-2"}],["path",{d:"M12 9h8",key:"svg-3"}],["path",{d:"M12 4v16",key:"svg-4"}]],Gr=T("outline","layout-board-split","LayoutBoardSplit",Ph),Mh=[["path",{d:"M4 4m0 2a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2z",key:"svg-0"}],["path",{d:"M10 4l4 16",key:"svg-1"}],["path",{d:"M12 12l-8 2",key:"svg-2"}]],Nh=T("outline","layout-collage","LayoutCollage",Mh),Eh=[["path",{d:"M5 4h4a1 1 0 0 1 1 1v6a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1v-6a1 1 0 0 1 1 -1",key:"svg-0"}],["path",{d:"M5 16h4a1 1 0 0 1 1 1v2a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1v-2a1 1 0 0 1 1 -1",key:"svg-1"}],["path",{d:"M15 12h4a1 1 0 0 1 1 1v6a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1v-6a1 1 0 0 1 1 -1",key:"svg-2"}],["path",{d:"M15 4h4a1 1 0 0 1 1 1v2a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1v-2a1 1 0 0 1 1 -1",key:"svg-3"}]],Ih=T("outline","layout-dashboard","LayoutDashboard",Eh),Rh=[["path",{d:"M9 15l6 -6",key:"svg-0"}],["path",{d:"M11 6l.463 -.536a5 5 0 0 1 7.071 7.072l-.534 .464",key:"svg-1"}],["path",{d:"M13 18l-.397 .534a5.068 5.068 0 0 1 -7.127 0a4.972 4.972 0 0 1 0 -7.071l.524 -.463",key:"svg-2"}]],Dh=T("outline","link","Link",Rh),Bh=[["path",{d:"M3 13a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v6a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z",key:"svg-0"}],["path",{d:"M9 16a1 1 0 1 0 2 0a1 1 0 0 0 -2 0",key:"svg-1"}],["path",{d:"M13 11v-4a4 4 0 1 1 8 0v4",key:"svg-2"}]],pd=T("outline","lock-open-2","LockOpen2",Bh),Lh=[["path",{d:"M5 13a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v6a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2v-6z",key:"svg-0"}],["path",{d:"M11 16a1 1 0 1 0 2 0a1 1 0 0 0 -2 0",key:"svg-1"}],["path",{d:"M8 11v-4a4 4 0 1 1 8 0v4",key:"svg-2"}]],Th=T("outline","lock","Lock",Lh),Ah=[["path",{d:"M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z",key:"svg-0"}],["path",{d:"M17 4a2 2 0 0 0 2 2a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2a2 2 0 0 0 2 -2",key:"svg-1"}],["path",{d:"M19 11h2m-1 -1v2",key:"svg-2"}]],rk=T("outline","moon-stars","MoonStars",Ah),zh=[["path",{d:"M21 14.008v-5.018a1.98 1.98 0 0 0 -1 -1.717l-4 -2.008a2.016 2.016 0 0 0 -2 0l-10 5.008c-.619 .355 -1 1.01 -1 1.718v5.018c0 .709 .381 1.363 1 1.717l4 2.008a2.016 2.016 0 0 0 2 0l10 -5.008c.619 -.355 1 -1.01 1 -1.718z",key:"svg-0"}],["path",{d:"M9 21v-7.5",key:"svg-1"}],["path",{d:"M9 13.5l11.5 -5.5",key:"svg-2"}],["path",{d:"M3.5 11l5.5 2.5",key:"svg-3"}]],$h=T("outline","rectangular-prism","RectangularPrism",zh),Vh=[["path",{d:"M3 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v2a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z",key:"svg-0"}],["path",{d:"M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v2a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z",key:"svg-1"}],["path",{d:"M17 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v2a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z",key:"svg-2"}],["path",{d:"M5 11v-3a3 3 0 0 1 3 -3h8a3 3 0 0 1 3 3v3",key:"svg-3"}],["path",{d:"M16.5 8.5l2.5 2.5l2.5 -2.5",key:"svg-4"}]],Fh=T("outline","reorder","Reorder",Vh),Wh=[["path",{d:"M6 19m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0",key:"svg-0"}],["path",{d:"M18 5m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0",key:"svg-1"}],["path",{d:"M12 19h4.5c.71 0 1.372 -.212 1.924 -.576m1.545 -2.459a3.5 3.5 0 0 0 -3.469 -3.965h-.499m-4 0h-3.501a3.5 3.5 0 0 1 -2.477 -5.972m2.477 -1.028h3.5",key:"svg-2"}],["path",{d:"M3 3l18 18",key:"svg-3"}]],Oh=T("outline","route-off","RouteOff",Wh),Hh=[["path",{d:"M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0",key:"svg-0"}],["path",{d:"M21 21l-6 -6",key:"svg-1"}]],Vi=T("outline","search","Search",Hh),Xh=[["path",{d:"M8 9l4 -4l4 4",key:"svg-0"}],["path",{d:"M16 15l-4 4l-4 -4",key:"svg-1"}]],Fi=T("outline","selector","Selector",Xh),qh=[["path",{d:"M6 12m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0",key:"svg-0"}],["path",{d:"M18 6m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0",key:"svg-1"}],["path",{d:"M18 18m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0",key:"svg-2"}],["path",{d:"M8.7 10.7l6.6 -3.4",key:"svg-3"}],["path",{d:"M8.7 13.3l6.6 3.4",key:"svg-4"}]],sk=T("outline","share","Share",qh),Yh=[["path",{d:"M12 4l-8 4l8 4l8 -4l-8 -4",key:"svg-0"}],["path",{d:"M4 12l8 4l8 -4",key:"svg-1"}],["path",{d:"M4 16l8 4l8 -4",key:"svg-2"}]],Wi=T("outline","stack-2","Stack2",Yh),Gh=[["path",{d:"M12 12m-4 0a4 4 0 1 0 8 0a4 4 0 1 0 -8 0",key:"svg-0"}],["path",{d:"M3 12h1m8 -9v1m8 8h1m-9 8v1m-6.4 -15.4l.7 .7m12.1 -.7l-.7 .7m0 11.4l.7 .7m-12.1 -.7l-.7 .7",key:"svg-1"}]],lk=T("outline","sun","Sun",Gh),Zh=[["path",{d:"M12 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-0"}],["path",{d:"M12 12m-5 0a5 5 0 1 0 10 0a5 5 0 1 0 -10 0",key:"svg-1"}],["path",{d:"M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0",key:"svg-2"}]],Uh=T("outline","target","Target",Zh),Kh=[["path",{d:"M3 6a3 3 0 1 0 6 0a3 3 0 0 0 -6 0",key:"svg-0"}],["path",{d:"M21 11v-3a2 2 0 0 0 -2 -2h-6l3 3m0 -6l-3 3",key:"svg-1"}],["path",{d:"M3 13v3a2 2 0 0 0 2 2h6l-3 -3m0 6l3 -3",key:"svg-2"}],["path",{d:"M15 18a3 3 0 1 0 6 0a3 3 0 0 0 -6 0",key:"svg-3"}]],Mo=T("outline","transform","Transform",Kh),Qh=[["path",{d:"M8 7a4 4 0 1 0 8 0a4 4 0 0 0 -8 0",key:"svg-0"}],["path",{d:"M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2",key:"svg-1"}]],Jh=T("outline","user","User",Qh),em=[["path",{d:"M18 6l-12 12",key:"svg-0"}],["path",{d:"M6 6l12 12",key:"svg-1"}]],eo=T("outline","x","X",em),tm=[["path",{d:"M4 8v-2a2 2 0 0 1 2 -2h2",key:"svg-0"}],["path",{d:"M4 16v2a2 2 0 0 0 2 2h2",key:"svg-1"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v2",key:"svg-2"}],["path",{d:"M16 20h2a2 2 0 0 0 2 -2v-2",key:"svg-3"}],["path",{d:"M8 11a3 3 0 1 0 6 0a3 3 0 0 0 -6 0",key:"svg-4"}],["path",{d:"M16 16l-2.5 -2.5",key:"svg-5"}]],$e=T("outline","zoom-scan","ZoomScan",tm),om=[["path",{d:"M10.52 2.614a2.095 2.095 0 0 1 2.835 -.117l.126 .117l7.905 7.905c.777 .777 .816 2.013 .117 2.836l-.117 .126l-7.905 7.905a2.094 2.094 0 0 1 -2.836 .117l-.126 -.117l-7.907 -7.906a2.096 2.096 0 0 1 -.115 -2.835l.117 -.126l7.905 -7.905zm5.969 9.535l.01 -.116l-.003 -.12l-.016 -.114l-.03 -.11l-.044 -.112l-.052 -.098l-.076 -.105l-.07 -.081l-3.5 -3.5l-.095 -.083a1 1 0 0 0 -1.226 0l-.094 .083l-.083 .094a1 1 0 0 0 0 1.226l.083 .094l1.792 1.793h-5.085l-.117 .007a1 1 0 0 0 0 1.986l.117 .007h5.085l-1.792 1.793l-.083 .094a1 1 0 0 0 1.403 1.403l.094 -.083l3.5 -3.5l.097 -.112l.05 -.074l.037 -.067l.05 -.112l.023 -.076l.025 -.117z",key:"svg-0"}]],nm=T("filled","direction-sign-filled","DirectionSignFilled",om),am=[["path",{d:"M9 3a1 1 0 0 1 .608 .206l.1 .087l2.706 2.707h6.586a3 3 0 0 1 2.995 2.824l.005 .176v8a3 3 0 0 1 -2.824 2.995l-.176 .005h-14a3 3 0 0 1 -2.995 -2.824l-.005 -.176v-11a3 3 0 0 1 2.824 -2.995l.176 -.005h4z",key:"svg-0"}]],im=T("filled","folder-filled","FolderFilled",am),rm=[["path",{d:"M6 4v16a1 1 0 0 0 1.524 .852l13 -8a1 1 0 0 0 0 -1.704l-13 -8a1 1 0 0 0 -1.524 .852z",key:"svg-0"}]],sm=T("filled","player-play-filled","PlayerPlayFilled",rm),lm=[["path",{d:"M19.496 4.136l-12 7a1 1 0 0 0 0 1.728l12 7a1 1 0 0 0 1.504 -.864v-14a1 1 0 0 0 -1.504 -.864z",key:"svg-0"}],["path",{d:"M4 4a1 1 0 0 1 .993 .883l.007 .117v14a1 1 0 0 1 -1.993 .117l-.007 -.117v-14a1 1 0 0 1 1 -1z",key:"svg-1"}]],dm=T("filled","player-skip-back-filled","PlayerSkipBackFilled",lm),cm=[["path",{d:"M3 5v14a1 1 0 0 0 1.504 .864l12 -7a1 1 0 0 0 0 -1.728l-12 -7a1 1 0 0 0 -1.504 .864z",key:"svg-0"}],["path",{d:"M20 4a1 1 0 0 1 .993 .883l.007 .117v14a1 1 0 0 1 -1.993 .117l-.007 -.117v-14a1 1 0 0 1 1 -1z",key:"svg-1"}]],um=T("filled","player-skip-forward-filled","PlayerSkipForwardFilled",cm),pm=[["path",{d:"M17 4h-10a3 3 0 0 0 -3 3v10a3 3 0 0 0 3 3h10a3 3 0 0 0 3 -3v-10a3 3 0 0 0 -3 -3z",key:"svg-0"}]],gm=T("filled","player-stop-filled","PlayerStopFilled",pm),hm=[["path",{d:"M8.243 7.34l-6.38 .925l-.113 .023a1 1 0 0 0 -.44 1.684l4.622 4.499l-1.09 6.355l-.013 .11a1 1 0 0 0 1.464 .944l5.706 -3l5.693 3l.1 .046a1 1 0 0 0 1.352 -1.1l-1.091 -6.355l4.624 -4.5l.078 -.085a1 1 0 0 0 -.633 -1.62l-6.38 -.926l-2.852 -5.78a1 1 0 0 0 -1.794 0l-2.853 5.78z",key:"svg-0"}]],mm=T("filled","star-filled","StarFilled",hm),Ja=h.createContext(null);function fm({value:e,children:t}){return h.useContext(Ja)?n.jsx(n.Fragment,{children:t}):n.jsx(Ja.Provider,{value:e,children:t})}function On({element:e,className:t,style:o}){const a=h.useContext(Ja);if(!e||!e.icon||e.icon==="none")return null;let i;return e.icon.startsWith("http://")||e.icon.startsWith("https://")?i=n.jsx("img",{src:e.icon,alt:e.title}):a&&(i=n.jsx(a,{node:e})),i?n.jsx("div",{className:P(t,"likec4-element-icon"),"data-likec4-icon":e.icon,style:o,children:i}):null}const ym={browser:Zg,cylinder:Yr,mobile:ah,person:Jh,queue:Fh,rectangle:$h,storage:Yr};function xm({element:e,className:t}){const o=n.jsx(On,{element:e,className:t});if(o)return o;const a=ym[e.shape];return n.jsx("div",{className:P(t,"likec4-shape-icon"),children:n.jsx(a,{})})}function bm(e){switch(e){case"dots":return pa.Dots;case"lines":return pa.Lines;case"cross":return pa.Cross;default:Le(e)}}const wm=(e,t)=>typeof e.background=="string"&&typeof t.background=="string"?e.background===t.background:I(e.background,t.background),gd=h.memo(({background:e})=>typeof e=="string"?n.jsx(Er,{variant:bm(e),size:2,gap:20}):n.jsx(Er,{...e}),wm);gd.displayName="Background";function D(e){const t=h.useRef(e);t.current=e;const o=h.useRef(null);return o.current==null&&(o.current=((...a)=>t.current?.(...a))),o.current}const vm=()=>{},hd=(e,t)=>{if(e===t)return!0;if(e.length!==t.length)return!1;for(const[o,a]of e.entries())if(!(a===t[o]||oe(a,t[o])))return!1;return!0};function ht(e,t,o,a){const i=yp();xp(i?vm:e,t,hd,a)}function md(){return Pi()}function Oi(e,t){return $n(D(e),t??oe)}function Hi(){return Ln()}const km=e=>Math.round(e.transform[2]*100)/100;function jm(){return $n(km)}const Cm=e=>e.transform[2]<.2;function Sm(){return $n(Cm)}function _m(){const e=typeof window<"u"&&typeof window.devicePixelRatio=="number"?window.devicePixelRatio:1;return De(Math.floor(e),{min:1,max:4})}let Ho;function ut(e){return Ho??=_m(),Ho<2?Math.round(e):Math.round(e*Ho)/Ho}function Zr(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}const ei=e=>({x:Math.round(e.internals.positionAbsolute.x),y:Math.round(e.internals.positionAbsolute.y),width:e.measured?.width??e.width??e.initialWidth??0,height:e.measured?.height??e.height??e.initialHeight??0});function ti(e){const{width:t,height:o}=Et(e),{x:a,y:i}=e.internals.positionAbsolute;return{x:Math.round(a+t/2),y:Math.round(i+o/2)}}function Xo(e,t,o=0){const{width:a,height:i}=e,r=Me.center(e),s=ne(t.x,t.y).subtract(r),l=(o+a/2)/s.x,d=(o+i/2)/s.y,u=Math.min(Math.abs(l),Math.abs(d));return ne(s).multiply(u).add(r).round()}function xn(e){let[t,...o]=e;O(t,"start should be defined");const a=[];for(;xe(o,3);){const[i,r,s,...l]=o,d=new Pp(t[0],t[1],i[0],i[1],r[0],r[1],s[0],s[1]),u=d.inflections();u.length===0&&u.push(.5),u.forEach(c=>{const{x:p,y:g}=d.get(c);a.push({x:Math.round(p),y:Math.round(g)})}),o=l,t=s}return O(o.length===0,"all points should be consumed"),O(xe(a,1),"at least one control point should be generated"),a}function bn(e,t){const o=qa(e)?{x:e[0],y:e[1]}:e,a=qa(t)?{x:t[0],y:t[1]}:t;return Pm(o,a)<2.1}function Pm(e,t){return Math.hypot(t.x-e.x,t.y-e.y)}function ae(e){return e.stopPropagation()}function Mm(e){let[t,...o]=e;O(t,"start should be defined");let a=`M ${t[0]},${t[1]}`;for(;xe(o,3);){const[i,r,s,...l]=o;a=a+` C ${i[0]},${i[1]} ${r[0]},${r[1]} ${s[0]},${s[1]}`,o=l}return O(o.length===0,"all points should be consumed"),a}const Ur=(e,t)=>(e.data.dimmed??!1)===t?e:{...e,data:{...e.data,dimmed:t}};function Nm(e,t){return t!==void 0?Ur(e,t):o=>Ur(o,e)}const Kr=(e,t)=>(e.data.hovered??!1)===t?e:{...e,data:{...e.data,hovered:t}};function Em(e,t){return t!==void 0?Kr(e,t):o=>Kr(o,e)}function Qr(e,t){return Gl(e.data,t)?e:{...e,data:{...e.data,...t}}}function Im(e,t){return t!==void 0?Qr(e,t):o=>Qr(o,e)}const G={setDimmed:Nm,setHovered:Em,setData:Im},nt={Compound:1,Edge:20,Element:20,Max:30},Ae=.05,oi=3,Jr={default:"16px",withControls:{top:"58px",left:"16px",right:"16px",bottom:"16px"}};function Xi({nodes:e,edges:t,onEdgesChange:o,onNodesChange:a,className:i,pannable:r=!0,zoomable:s=!0,nodesSelectable:l=!0,nodesDraggable:d=!1,background:u="dots",children:c,colorMode:p,fitViewPadding:g=0,fitView:m=!0,zoomOnDoubleClick:y=!1,onViewportResize:w,onMoveEnd:C,onNodeMouseEnter:b,onNodeMouseLeave:v,onEdgeMouseEnter:j,onEdgeMouseLeave:f,...k}){const S=h.useMemo(()=>({minZoom:Ae,maxZoom:1,padding:g,includeHiddenNodes:!1}),[g]),E=u!=="transparent"&&u!=="solid",B=Sm(),_=Hi(),{colorScheme:Y}=up();return p||(p=Y==="auto"?"system":Y),n.jsxs(pp,{colorMode:p,nodes:e,edges:t,className:P(u==="transparent"&&"bg-transparent",i),...B&&{"data-likec4-zoom-small":!0},zoomOnPinch:s,zoomOnScroll:!r&&s,...!s&&{zoomActivationKeyCode:null},zoomOnDoubleClick:y,maxZoom:s?oi:1,minZoom:s?Ae:1,fitView:m,fitViewOptions:S,preventScrolling:s||r,defaultMarkerColor:"var(--xy-edge-stroke)",noDragClassName:"nodrag",noPanClassName:"nopan",noWheelClassName:"nowheel",panOnScroll:r,panOnDrag:r,...!r&&{panActivationKeyCode:null,selectionKeyCode:null},elementsSelectable:l,nodesFocusable:d||l,edgesFocusable:!1,nodesDraggable:d,nodeDragThreshold:4,nodeClickDistance:3,paneClickDistance:3,elevateNodesOnSelect:!1,selectNodesOnDrag:!1,onNodesChange:a,onEdgesChange:o,onMoveEnd:D((F,{x:$,y:N,zoom:V})=>{const R=ut($),K=ut(N);($!==R||N!==K)&&_.setState({transform:[R,K,V]}),C?.(F,{x:R,y:K,zoom:V})}),onNodeMouseEnter:D((F,$)=>{if(b){b(F,$);return}a([{id:$.id,type:"replace",item:G.setHovered($,!0)}])}),onNodeMouseLeave:D((F,$)=>{if(v){v(F,$);return}a([{id:$.id,type:"replace",item:G.setHovered($,!1)}])}),onEdgeMouseEnter:D((F,$)=>{if(j){j(F,$);return}o([{id:$.id,type:"replace",item:G.setHovered($,!0)}])}),onEdgeMouseLeave:D((F,$)=>{if(f){f(F,$);return}o([{id:$.id,type:"replace",item:G.setHovered($,!1)}])}),onNodeDoubleClick:ae,onEdgeDoubleClick:ae,...k,children:[E&&n.jsx(gd,{background:u}),w&&n.jsx(Dm,{onViewportResize:w}),c]})}const Rm=({width:e,height:t})=>(e||1)*(t||1),Dm=({onViewportResize:e})=>{const t=$n(Rm);return ht(e,[t]),null},es={};function ts(e,t){return e===t?e:(t=t.map(o=>{const a=e.find(s=>s.id===o.id&&s.type===o.type&&s.source===o.source&&s.target===o.target);if(!a)return o;const i=I(a.data,o.data),r=i?a.data:o.data;return i&&I(a.hidden,o.hidden??a.hidden)&&I(a.selected,o.selected??a.selected)&&I(a.selectable,o.selectable??a.selectable)&&I(a.focusable,o.focusable??a.focusable)&&I(a.animated,o.animated??a.animated)&&I(a.className,o.className)&&I(a.zIndex,o.zIndex??a.zIndex)&&I(a.label,o.label)&&I(a.sourceHandle,o.sourceHandle)&&I(a.targetHandle,o.targetHandle)&&I(a.style??es,o.style??es)?a:{...xo(a,Ue),...xo(o,Ue),data:r}}),Zl(e,t)?e:t)}function qi(e,t){return Ue(t)?ts(e,t):(t=e,o=>ts(o,t))}const qo={};function os(e,t){return e===t?e:(t=t.map(o=>{const a=e.find(p=>p.id===o.id&&p.type===o.type);if(!a)return o;const i=Gl(a.data,o.data);let r=i?a.data:o.data;i||(Ue(a.data.hovered)&&!Ue(o.data.hovered)&&(r={...r,hovered:a.data.hovered}),Ue(a.data.dimmed)&&!Ue(o.data.dimmed)&&(r={...r,dimmed:a.data.dimmed}));const{width:s,height:l}=Et(a),d=Object.hasOwn(a,"handles")||Object.hasOwn(o,"handles"),u=!d||I(a.handles??[],o.handles??[]);if(i&&u&&I(s,o.width??o.initialWidth)&&I(l,o.height??o.initialHeight)&&I(a.parentId??null,o.parentId??null)&&I(a.hidden,o.hidden??a.hidden)&&I(a.selected,o.selected??a.selected)&&I(a.selectable,o.selectable??a.selectable)&&I(a.focusable,o.focusable??a.focusable)&&I(a.draggable,o.draggable??a.draggable)&&I(a.dragHandle,o.dragHandle)&&I(a.className,o.className)&&I(a.zIndex,o.zIndex??a.zIndex)&&I(a.position,o.position)&&I(a.domAttributes??qo,o.domAttributes??qo)&&I(a.style??qo,o.style??qo))return a;const c=d&&u?a.handles:o.handles;return{...xo(a,(p,g)=>Ue(p)&&g!=="parentId"),..."measured"in a&&{measured:{width:o.width??o.initialWidth,height:o.height??o.initialHeight}},...xo(o,Ue),width:o.width??o.initialWidth,height:o.height??o.initialHeight,...c&&{handles:c},data:r}}),Zl(e,t)?e:t)}function wn(e,t){return Ue(t)?os(e,t):(t=e,o=>os(o,t))}const Yi=h.createContext(null);function fd(){const e=h.useContext(Yi);if(!e)throw new Error("useRootContainer must be used within a RootContainer");return e}function Bm(){return fd().ref}function Lm(){return fd().ref.current}const yd=h.createContext(null);function Tm(){const e=h.useContext(yd);return e===null&&console.warn("ReduceGraphicsMode is not provided"),e??!1}const[Am,zm]=wl("PanningAtomSafeCtx is not provided");function $m({id:e,className:t,reduceGraphics:o=!1,children:a}){const[i,r]=h.useState(!1),s=h.useRef(null),l=h.useRef(null);l.current||(l.current=Op(!1)),Hp(()=>{r(!0)},[]),h.useEffect(()=>l.current?.subscribe(u=>{s.current?.setAttribute("data-likec4-diagram-panning",u?"true":"false")}),[]);const d=h.useMemo(()=>({id:e,ref:s}),[e,s]);return n.jsx(Am,{value:l.current,children:n.jsx(yd.Provider,{value:o,children:n.jsx("div",{id:e,className:P("likec4-root",t),ref:s,...o&&{"data-likec4-reduced-graphics":!0},children:i&&!!d.ref.current&&n.jsx(Yi.Provider,{value:d,children:a})})})})}const xd={onNavigateTo:null,onNodeClick:null,onNodeContextMenu:null,onCanvasContextMenu:null,onEdgeClick:null,onEdgeContextMenu:null,onCanvasClick:null,onCanvasDblClick:null,onBurgerMenuClick:null,onOpenSource:null,onInitialized:null,onLayoutTypeChange:null},ni=xi(xd),bd=h.createContext({...En(ni,e=>[e,null]),handlersRef:{current:xd}});function Vm({handlers:e,children:t}){const o=ql(e),a=ni.map(r=>Vn(e[r])),i=h.useMemo(()=>({...En(ni,r=>o.current[r]?[r,(...s)=>o.current[r]?.(...s)]:[r,null]),handlersRef:o}),[o,...a]);return n.jsx(bd.Provider,{value:i,children:t})}function to(){return h.useContext(bd)}const wd={enableEditor:!1,enableReadOnly:!0,enableCompareWithLatest:!1,enableControls:!1,enableDynamicViewWalkthrough:!1,enableElementDetails:!1,enableFocusMode:!1,enableNavigateTo:!1,enableNotations:!1,enableRelationshipBrowser:!1,enableRelationshipDetails:!1,enableSearch:!1,enableNavigationButtons:!1,enableFitView:!1,enableVscode:!1,enableElementTags:!1},ai=h.createContext(wd);function Mt({children:e,features:t,overrides:o}){const a=h.useContext(ai),[i,r]=h.useState(a);return h.useEffect(()=>{r(s=>{const l={...a,...t,...o};return oe(s,l)?s:l})},[a,t,o]),n.jsx(ai.Provider,{value:i,children:e})}const Fm={enableControls:!1,enableReadOnly:!0,enableCompareWithLatest:!1};Mt.Overlays=({children:e})=>n.jsx(Mt,{overrides:Fm,children:e});function Z(){return h.useContext(ai)}function Wm({feature:e,children:t,and:o=!0}){return Z()[`enable${e}`]===!0&&o?n.jsx(n.Fragment,{children:t}):null}const Om=Ru({autoContrast:!0,primaryColor:"indigo",cursorType:"pointer",defaultRadius:"sm",fontFamily:"var(--likec4-app-font, var(--likec4-app-font-default))",headings:{fontWeight:"500",sizes:{h1:{fontWeight:"600"},h2:{fontWeight:"500"}}},components:{Portal:bi.extend({defaultProps:{reuseTargetNode:!0}}),Tooltip:je.extend({defaultProps:{color:"dark"}})}});x({cursor:"pointer","--mantine-cursor-pointer":"pointer","& :where(.likec4-diagram, .likec4-compound-node, .likec4-element-node)":{cursor:"pointer"}});function vd({children:e}){const t=h.useContext(zp);return h.useEffect(()=>{t||console.warn("LikeC4Diagram must be a child of MantineProvider")},[]),t?n.jsx(n.Fragment,{children:e}):n.jsx($p,{defaultColorScheme:"auto",theme:Om,children:e})}vd.displayName="EnsureMantine";const Hm=({reducedMotion:e="user",children:t})=>{const o=wi()?.();return n.jsx(Vp,{features:Fp,strict:!0,children:n.jsx(Wp,{reducedMotion:e,...o&&{nonce:o},children:t})})},Hn=h.createContext(null),Gi=h.createContext(null);function Se(){const e=h.useContext(Hn);if(!e)throw new Error("LikeC4Model not found. Make sure you have LikeC4ModelProvider.");return e}function Xm(){const e=Se(),[t,o]=h.useState(e.$data.specification);return h.useEffect(()=>{o(a=>I(a,e.$data.specification)?a:e.$data.specification)},[e]),t}const kd=h.createContext({}),qm=Eu,Ym=e=>{const t=e.color;if(ml(e))return`
      --colors-likec4-tag-bg: ${t};
      --colors-likec4-tag-bg-hover: color-mix(in oklab, ${t}, var(--colors-likec4-mix-color) 20%);
    `;if(!qm.includes(t))return"";let o="12";return["mint","grass","lime","yellow","amber"].includes(t)&&(o="dark-2"),`
  --colors-likec4-tag-border: var(--colors-${t}-8);
  --colors-likec4-tag-bg: var(--colors-${t}-9);
  --colors-likec4-tag-bg-hover: var(--colors-${t}-10);
  --colors-likec4-tag-text: var(--colors-${t}-${o});
  `};function Gm(e,t){return!e||_t(e)?"":se(zn(e),Xl(([o,a])=>[`:is(${t} [data-likec4-tag="${o}"]) {`,Ym(a),"}"]),Fl(`
`))}function Zm({children:e,rootSelector:t}){const o=Xm().tags,a=Gm(o,t);return n.jsxs(kd.Provider,{value:o,children:[a!==""&&n.jsx(Um,{stylesheet:a}),e]})}const Um=h.memo(({stylesheet:e})=>{const t=wi()?.();return n.jsx("style",{"data-likec4-tags":!0,type:"text/css",dangerouslySetInnerHTML:{__html:e},nonce:t})});function Km(e){return h.useContext(kd)[e]??{color:"tomato"}}const jd=h.createContext(null);function dk({children:e,editor:t}){return n.jsx(jd.Provider,{value:t,children:e})}function Cd(){return h.useContext(jd)}function Qm(){return Al().replace("mantine-","likec4-")}var Jm="css,pos,insetX,insetY,insetEnd,end,insetStart,start,flexDir,p,pl,pr,pt,pb,py,paddingY,paddingX,px,pe,paddingEnd,ps,paddingStart,ml,mr,mt,mb,m,my,marginY,mx,marginX,me,marginEnd,ms,marginStart,ringWidth,ringColor,ring,ringOffset,w,minW,maxW,h,minH,maxH,textShadowColor,bgPosition,bgPositionX,bgPositionY,bgAttachment,bgClip,bg,bgColor,bgOrigin,bgImage,bgRepeat,bgBlendMode,bgSize,bgGradient,bgLinear,bgRadial,bgConic,rounded,roundedTopLeft,roundedTopRight,roundedBottomRight,roundedBottomLeft,roundedTop,roundedRight,roundedBottom,roundedLeft,roundedStartStart,roundedStartEnd,roundedStart,roundedEndStart,roundedEndEnd,roundedEnd,borderX,borderXWidth,borderXColor,borderY,borderYWidth,borderYColor,borderStart,borderStartWidth,borderStartColor,borderEnd,borderEndWidth,borderEndColor,shadow,shadowColor,x,y,z,scrollMarginY,scrollMarginX,scrollPaddingY,scrollPaddingX,aspectRatio,boxDecorationBreak,zIndex,boxSizing,objectPosition,objectFit,overscrollBehavior,overscrollBehaviorX,overscrollBehaviorY,position,top,left,inset,insetInline,insetBlock,insetBlockEnd,insetBlockStart,insetInlineEnd,insetInlineStart,right,bottom,float,visibility,display,hideFrom,hideBelow,flexBasis,flex,flexDirection,flexGrow,flexShrink,gridTemplateColumns,gridTemplateRows,gridColumn,gridRow,gridColumnStart,gridColumnEnd,gridAutoFlow,gridAutoColumns,gridAutoRows,gap,gridGap,gridRowGap,gridColumnGap,rowGap,columnGap,justifyContent,alignContent,alignItems,alignSelf,padding,paddingLeft,paddingRight,paddingTop,paddingBottom,paddingBlock,paddingBlockEnd,paddingBlockStart,paddingInline,paddingInlineEnd,paddingInlineStart,marginLeft,marginRight,marginTop,marginBottom,margin,marginBlock,marginBlockEnd,marginBlockStart,marginInline,marginInlineEnd,marginInlineStart,spaceX,spaceY,outlineWidth,outlineColor,outline,outlineOffset,focusRing,focusVisibleRing,focusRingColor,focusRingOffset,focusRingWidth,focusRingStyle,divideX,divideY,divideColor,divideStyle,width,inlineSize,minWidth,minInlineSize,maxWidth,maxInlineSize,height,blockSize,minHeight,minBlockSize,maxHeight,maxBlockSize,boxSize,color,fontFamily,fontSize,fontSizeAdjust,fontPalette,fontKerning,fontFeatureSettings,fontWeight,fontSmoothing,fontVariant,fontVariantAlternates,fontVariantCaps,fontVariationSettings,fontVariantNumeric,letterSpacing,lineHeight,textAlign,textDecoration,textDecorationColor,textEmphasisColor,textDecorationStyle,textDecorationThickness,textUnderlineOffset,textTransform,textIndent,textShadow,textOverflow,verticalAlign,wordBreak,textWrap,truncate,lineClamp,listStyleType,listStylePosition,listStyleImage,listStyle,backgroundPosition,backgroundPositionX,backgroundPositionY,backgroundAttachment,backgroundClip,background,backgroundColor,backgroundOrigin,backgroundImage,backgroundRepeat,backgroundBlendMode,backgroundSize,backgroundGradient,backgroundLinear,backgroundRadial,backgroundConic,textGradient,gradientFromPosition,gradientToPosition,gradientFrom,gradientTo,gradientVia,gradientViaPosition,borderRadius,borderTopLeftRadius,borderTopRightRadius,borderBottomRightRadius,borderBottomLeftRadius,borderTopRadius,borderRightRadius,borderBottomRadius,borderLeftRadius,borderStartStartRadius,borderStartEndRadius,borderStartRadius,borderEndStartRadius,borderEndEndRadius,borderEndRadius,border,borderWidth,borderTopWidth,borderLeftWidth,borderRightWidth,borderBottomWidth,borderBlockStartWidth,borderBlockEndWidth,borderColor,borderInline,borderInlineWidth,borderInlineColor,borderBlock,borderBlockWidth,borderBlockColor,borderLeft,borderLeftColor,borderInlineStart,borderInlineStartWidth,borderInlineStartColor,borderRight,borderRightColor,borderInlineEnd,borderInlineEndWidth,borderInlineEndColor,borderTop,borderTopColor,borderBottom,borderBottomColor,borderBlockEnd,borderBlockEndColor,borderBlockStart,borderBlockStartColor,opacity,boxShadow,boxShadowColor,mixBlendMode,filter,brightness,contrast,grayscale,hueRotate,invert,saturate,sepia,dropShadow,blur,backdropFilter,backdropBlur,backdropBrightness,backdropContrast,backdropGrayscale,backdropHueRotate,backdropInvert,backdropOpacity,backdropSaturate,backdropSepia,borderCollapse,borderSpacing,borderSpacingX,borderSpacingY,tableLayout,transitionTimingFunction,transitionDelay,transitionDuration,transitionProperty,transition,animation,animationName,animationTimingFunction,animationDuration,animationDelay,animationPlayState,animationComposition,animationFillMode,animationDirection,animationIterationCount,animationRange,animationState,animationRangeStart,animationRangeEnd,animationTimeline,transformOrigin,transformBox,transformStyle,transform,rotate,rotateX,rotateY,rotateZ,scale,scaleX,scaleY,translate,translateX,translateY,translateZ,accentColor,caretColor,scrollBehavior,scrollbar,scrollbarColor,scrollbarGutter,scrollbarWidth,scrollMargin,scrollMarginLeft,scrollMarginRight,scrollMarginTop,scrollMarginBottom,scrollMarginBlock,scrollMarginBlockEnd,scrollMarginBlockStart,scrollMarginInline,scrollMarginInlineEnd,scrollMarginInlineStart,scrollPadding,scrollPaddingBlock,scrollPaddingBlockStart,scrollPaddingBlockEnd,scrollPaddingInline,scrollPaddingInlineEnd,scrollPaddingInlineStart,scrollPaddingLeft,scrollPaddingRight,scrollPaddingTop,scrollPaddingBottom,scrollSnapAlign,scrollSnapStop,scrollSnapType,scrollSnapStrictness,scrollSnapMargin,scrollSnapMarginTop,scrollSnapMarginBottom,scrollSnapMarginLeft,scrollSnapMarginRight,scrollSnapCoordinate,scrollSnapDestination,scrollSnapPointsX,scrollSnapPointsY,scrollSnapTypeX,scrollSnapTypeY,scrollTimeline,scrollTimelineAxis,scrollTimelineName,touchAction,userSelect,overflow,overflowWrap,overflowX,overflowY,overflowAnchor,overflowBlock,overflowInline,overflowClipBox,overflowClipMargin,overscrollBehaviorBlock,overscrollBehaviorInline,fill,stroke,strokeWidth,strokeDasharray,strokeDashoffset,strokeLinecap,strokeLinejoin,strokeMiterlimit,strokeOpacity,srOnly,debug,appearance,backfaceVisibility,clipPath,hyphens,mask,maskImage,maskSize,textSizeAdjust,container,containerName,containerType,cursor,colorPalette,_hover,_focus,_focusWithin,_focusVisible,_disabled,_active,_visited,_target,_readOnly,_readWrite,_empty,_checked,_enabled,_expanded,_highlighted,_complete,_incomplete,_dragging,_before,_after,_firstLetter,_firstLine,_marker,_selection,_file,_backdrop,_first,_last,_only,_even,_odd,_firstOfType,_lastOfType,_onlyOfType,_peerFocus,_peerHover,_peerActive,_peerFocusWithin,_peerFocusVisible,_peerDisabled,_peerChecked,_peerInvalid,_peerExpanded,_peerPlaceholderShown,_groupFocus,_groupHover,_groupActive,_groupFocusWithin,_groupFocusVisible,_groupDisabled,_groupChecked,_groupExpanded,_groupInvalid,_indeterminate,_required,_valid,_invalid,_autofill,_inRange,_outOfRange,_placeholder,_placeholderShown,_pressed,_selected,_grabbed,_underValue,_overValue,_atValue,_default,_optional,_open,_closed,_fullscreen,_loading,_hidden,_current,_currentPage,_currentStep,_today,_unavailable,_rangeStart,_rangeEnd,_now,_topmost,_motionReduce,_motionSafe,_print,_landscape,_portrait,_dark,_light,_osDark,_osLight,_highContrast,_lessContrast,_moreContrast,_ltr,_rtl,_scrollbar,_scrollbarThumb,_scrollbarTrack,_horizontal,_vertical,_icon,_starting,_noscript,_invertedColors,_shapeSizeXs,_shapeSizeSm,_shapeSizeMd,_shapeSizeLg,_shapeSizeXl,_shapeRectangle,_shapePerson,_shapeBrowser,_shapeMobile,_shapeCylinder,_shapeStorage,_shapeQueue,_notDisabled,_reduceGraphics,_reduceGraphicsOnPan,_noReduceGraphics,_whenPanning,_smallZoom,_compoundTransparent,_edgeActive,_whenHovered,_whenSelectable,_whenSelected,_whenDimmed,_whenFocused,_p3,_srgb,_rec2020,xs,xsOnly,xsDown,sm,smOnly,smDown,md,mdOnly,mdDown,lg,lgOnly,lgDown,xl,xlOnly,xlDown,xsToSm,xsToMd,xsToLg,xsToXl,smToMd,smToLg,smToXl,mdToLg,mdToXl,lgToXl,@/xs,@/sm,@/md,@/lg,@likec4-root/xs,@likec4-root/sm,@likec4-root/md,@likec4-root/lg,@likec4-dialog/xs,@likec4-dialog/sm,@likec4-dialog/md,@likec4-dialog/lg,textStyle,layerStyle,animationStyle",ef=Jm.split(","),tf="WebkitAppearance,WebkitBorderBefore,WebkitBorderBeforeColor,WebkitBorderBeforeStyle,WebkitBorderBeforeWidth,WebkitBoxReflect,WebkitLineClamp,WebkitMask,WebkitMaskAttachment,WebkitMaskClip,WebkitMaskComposite,WebkitMaskImage,WebkitMaskOrigin,WebkitMaskPosition,WebkitMaskPositionX,WebkitMaskPositionY,WebkitMaskRepeat,WebkitMaskRepeatX,WebkitMaskRepeatY,WebkitMaskSize,WebkitOverflowScrolling,WebkitTapHighlightColor,WebkitTextFillColor,WebkitTextStroke,WebkitTextStrokeColor,WebkitTextStrokeWidth,WebkitTouchCallout,WebkitUserModify,WebkitUserSelect,accentColor,alignContent,alignItems,alignSelf,alignTracks,all,anchorName,anchorScope,animation,animationComposition,animationDelay,animationDirection,animationDuration,animationFillMode,animationIterationCount,animationName,animationPlayState,animationRange,animationRangeEnd,animationRangeStart,animationTimeline,animationTimingFunction,appearance,aspectRatio,backdropFilter,backfaceVisibility,background,backgroundAttachment,backgroundBlendMode,backgroundClip,backgroundColor,backgroundImage,backgroundOrigin,backgroundPosition,backgroundPositionX,backgroundPositionY,backgroundRepeat,backgroundSize,blockSize,border,borderBlock,borderBlockColor,borderBlockEnd,borderBlockEndColor,borderBlockEndStyle,borderBlockEndWidth,borderBlockStart,borderBlockStartColor,borderBlockStartStyle,borderBlockStartWidth,borderBlockStyle,borderBlockWidth,borderBottom,borderBottomColor,borderBottomLeftRadius,borderBottomRightRadius,borderBottomStyle,borderBottomWidth,borderCollapse,borderColor,borderEndEndRadius,borderEndStartRadius,borderImage,borderImageOutset,borderImageRepeat,borderImageSlice,borderImageSource,borderImageWidth,borderInline,borderInlineColor,borderInlineEnd,borderInlineEndColor,borderInlineEndStyle,borderInlineEndWidth,borderInlineStart,borderInlineStartColor,borderInlineStartStyle,borderInlineStartWidth,borderInlineStyle,borderInlineWidth,borderLeft,borderLeftColor,borderLeftStyle,borderLeftWidth,borderRadius,borderRight,borderRightColor,borderRightStyle,borderRightWidth,borderSpacing,borderStartEndRadius,borderStartStartRadius,borderStyle,borderTop,borderTopColor,borderTopLeftRadius,borderTopRightRadius,borderTopStyle,borderTopWidth,borderWidth,bottom,boxAlign,boxDecorationBreak,boxDirection,boxFlex,boxFlexGroup,boxLines,boxOrdinalGroup,boxOrient,boxPack,boxShadow,boxSizing,breakAfter,breakBefore,breakInside,captionSide,caret,caretColor,caretShape,clear,clip,clipPath,clipRule,color,colorInterpolationFilters,colorScheme,columnCount,columnFill,columnGap,columnRule,columnRuleColor,columnRuleStyle,columnRuleWidth,columnSpan,columnWidth,columns,contain,containIntrinsicBlockSize,containIntrinsicHeight,containIntrinsicInlineSize,containIntrinsicSize,containIntrinsicWidth,container,containerName,containerType,content,contentVisibility,counterIncrement,counterReset,counterSet,cursor,cx,cy,d,direction,display,dominantBaseline,emptyCells,fieldSizing,fill,fillOpacity,fillRule,filter,flex,flexBasis,flexDirection,flexFlow,flexGrow,flexShrink,flexWrap,float,floodColor,floodOpacity,font,fontFamily,fontFeatureSettings,fontKerning,fontLanguageOverride,fontOpticalSizing,fontPalette,fontSize,fontSizeAdjust,fontSmooth,fontStretch,fontStyle,fontSynthesis,fontSynthesisPosition,fontSynthesisSmallCaps,fontSynthesisStyle,fontSynthesisWeight,fontVariant,fontVariantAlternates,fontVariantCaps,fontVariantEastAsian,fontVariantEmoji,fontVariantLigatures,fontVariantNumeric,fontVariantPosition,fontVariationSettings,fontWeight,forcedColorAdjust,gap,grid,gridArea,gridAutoColumns,gridAutoFlow,gridAutoRows,gridColumn,gridColumnEnd,gridColumnGap,gridColumnStart,gridGap,gridRow,gridRowEnd,gridRowGap,gridRowStart,gridTemplate,gridTemplateAreas,gridTemplateColumns,gridTemplateRows,hangingPunctuation,height,hyphenateCharacter,hyphenateLimitChars,hyphens,imageOrientation,imageRendering,imageResolution,imeMode,initialLetter,initialLetterAlign,inlineSize,inset,insetBlock,insetBlockEnd,insetBlockStart,insetInline,insetInlineEnd,insetInlineStart,interpolateSize,isolation,justifyContent,justifyItems,justifySelf,justifyTracks,left,letterSpacing,lightingColor,lineBreak,lineClamp,lineHeight,lineHeightStep,listStyle,listStyleImage,listStylePosition,listStyleType,margin,marginBlock,marginBlockEnd,marginBlockStart,marginBottom,marginInline,marginInlineEnd,marginInlineStart,marginLeft,marginRight,marginTop,marginTrim,marker,markerEnd,markerMid,markerStart,mask,maskBorder,maskBorderMode,maskBorderOutset,maskBorderRepeat,maskBorderSlice,maskBorderSource,maskBorderWidth,maskClip,maskComposite,maskImage,maskMode,maskOrigin,maskPosition,maskRepeat,maskSize,maskType,masonryAutoFlow,mathDepth,mathShift,mathStyle,maxBlockSize,maxHeight,maxInlineSize,maxLines,maxWidth,minBlockSize,minHeight,minInlineSize,minWidth,mixBlendMode,objectFit,objectPosition,offset,offsetAnchor,offsetDistance,offsetPath,offsetPosition,offsetRotate,opacity,order,orphans,outline,outlineColor,outlineOffset,outlineStyle,outlineWidth,overflow,overflowAnchor,overflowBlock,overflowClipBox,overflowClipMargin,overflowInline,overflowWrap,overflowX,overflowY,overlay,overscrollBehavior,overscrollBehaviorBlock,overscrollBehaviorInline,overscrollBehaviorX,overscrollBehaviorY,padding,paddingBlock,paddingBlockEnd,paddingBlockStart,paddingBottom,paddingInline,paddingInlineEnd,paddingInlineStart,paddingLeft,paddingRight,paddingTop,page,pageBreakAfter,pageBreakBefore,pageBreakInside,paintOrder,perspective,perspectiveOrigin,placeContent,placeItems,placeSelf,pointerEvents,position,positionAnchor,positionArea,positionTry,positionTryFallbacks,positionTryOrder,positionVisibility,printColorAdjust,quotes,r,resize,right,rotate,rowGap,rubyAlign,rubyMerge,rubyPosition,rx,ry,scale,scrollBehavior,scrollMargin,scrollMarginBlock,scrollMarginBlockEnd,scrollMarginBlockStart,scrollMarginBottom,scrollMarginInline,scrollMarginInlineEnd,scrollMarginInlineStart,scrollMarginLeft,scrollMarginRight,scrollMarginTop,scrollPadding,scrollPaddingBlock,scrollPaddingBlockEnd,scrollPaddingBlockStart,scrollPaddingBottom,scrollPaddingInline,scrollPaddingInlineEnd,scrollPaddingInlineStart,scrollPaddingLeft,scrollPaddingRight,scrollPaddingTop,scrollSnapAlign,scrollSnapCoordinate,scrollSnapDestination,scrollSnapPointsX,scrollSnapPointsY,scrollSnapStop,scrollSnapType,scrollSnapTypeX,scrollSnapTypeY,scrollTimeline,scrollTimelineAxis,scrollTimelineName,scrollbarColor,scrollbarGutter,scrollbarWidth,shapeImageThreshold,shapeMargin,shapeOutside,shapeRendering,stopColor,stopOpacity,stroke,strokeDasharray,strokeDashoffset,strokeLinecap,strokeLinejoin,strokeMiterlimit,strokeOpacity,strokeWidth,tabSize,tableLayout,textAlign,textAlignLast,textAnchor,textBox,textBoxEdge,textBoxTrim,textCombineUpright,textDecoration,textDecorationColor,textDecorationLine,textDecorationSkip,textDecorationSkipInk,textDecorationStyle,textDecorationThickness,textEmphasis,textEmphasisColor,textEmphasisPosition,textEmphasisStyle,textIndent,textJustify,textOrientation,textOverflow,textRendering,textShadow,textSizeAdjust,textSpacingTrim,textTransform,textUnderlineOffset,textUnderlinePosition,textWrap,textWrapMode,textWrapStyle,timelineScope,top,touchAction,transform,transformBox,transformOrigin,transformStyle,transition,transitionBehavior,transitionDelay,transitionDuration,transitionProperty,transitionTimingFunction,translate,unicodeBidi,userSelect,vectorEffect,verticalAlign,viewTimeline,viewTimelineAxis,viewTimelineInset,viewTimelineName,viewTransitionName,visibility,whiteSpace,whiteSpaceCollapse,widows,width,willChange,wordBreak,wordSpacing,wordWrap,writingMode,x,y,zIndex,zoom,alignmentBaseline,baselineShift,colorInterpolation,colorRendering,glyphOrientationVertical",of=tf.split(",").concat(ef),nf=new Map(of.map(e=>[e,!0])),af=/&|@/,Sd=be(e=>nf.has(e)||e.startsWith("--")||af.test(e));const rf=(e,t)=>!t.includes(e)&&!Sd(e),sf=(e,t)=>e.__shouldForwardProps__&&t?o=>e.__shouldForwardProps__(o)&&t(o):t,lf=(e,t)=>{if(e&&!t)return e;if(!e&&t)return t;if(e.__cva__&&t.__cva__||e.__recipe__&&t.__recipe__)return e.merge(t);const o=new TypeError("Cannot merge cva with recipe. Please use either cva or recipe.");throw TypeError.captureStackTrace?.(o),o},df=e=>typeof e=="string"?e:e?.displayName||e?.name||"Component";function ga(e,t={},o={}){const a=t.__cva__||t.__recipe__?t:_o(t),i=o.shouldForwardProp||rf,r=g=>o.forwardProps?.includes(g)?!0:i(g,a.variantKeys),s=Object.assign(o.dataAttr&&t.__name__?{"data-recipe":t.__name__}:{},o.defaultProps),l=lf(e.__cva__,a),d=sf(e,r),u=e.__base__||e,c=h.forwardRef(function(g,m){const{as:y=u,unstyled:w,children:C,...b}=g,v=h.useMemo(()=>Object.assign({},s,b),[b]),[j,f,k,S,E]=h.useMemo(()=>fe(v,Ka.keys,d,l.variantKeys,Sd),[v]);function B(){const{css:F,...$}=S,N=l.__getCompoundVariantCss__?.(k);return P(l(k,!1),x(N,$,F),v.className)}function _(){const{css:F,...$}=S,N=l.raw(k);return P(x(N,$,F),v.className)}const Y=()=>{if(w){const{css:F,...$}=S;return P(x($,F),v.className)}return t.__recipe__?B():_()};return h.createElement(y,{ref:m,...f,...E,...Ka(j),className:Y()},C??v.children)}),p=df(u);return c.displayName=`styled.${p}`,c.__cva__=l,c.__base__=u,c.__shouldForwardProps__=r,c}function cf(){const e=new Map;return new Proxy(ga,{apply(t,o,a){return ga(...a)},get(t,o){return e.has(o)||e.set(o,ga(o)),e.get(o)}})}const mt=cf(),ns={transform(e){return e}},uf=(e={})=>{const t=So(ns,e);return ns.transform(t,Co)},U=h.forwardRef(function(e,t){const[o,a]=fe(e,[]),i=uf(o),r={ref:t,...i,...a};return h.createElement(mt.div,r)}),as={transform(e){const{justify:t,gap:o,...a}=e;return{display:"flex",alignItems:"center",justifyContent:t,gap:o,flexDirection:"column",...a}},defaultValues:{alignItems:"stretch",gap:"sm"}},Zi=(e={})=>{const t=So(as,e);return as.transform(t,Co)},No=e=>x(Zi(e));No.raw=Zi;const Rt=h.forwardRef(function(e,t){const[o,a]=fe(e,["justify","gap"]),i=Zi(o),r={ref:t,...i,...a};return h.createElement(mt.div,r)}),is={transform(e){const{justify:t,gap:o,...a}=e;return{display:"flex",alignItems:"center",justifyContent:t,gap:o,flexDirection:"row",...a}},defaultValues:{gap:"sm"}},Ui=(e={})=>{const t=So(is,e);return is.transform(t,Co)},me=e=>x(Ui(e));me.raw=Ui;const te=h.forwardRef(function(e,t){const[o,a]=fe(e,["justify","gap"]),i=Ui(o),r={ref:t,...i,...a};return h.createElement(mt.div,r)}),rs={transform(e){return{position:"relative",maxWidth:"8xl",mx:"auto",px:{base:"4",md:"6",lg:"8"},...e}}},_d=(e={})=>{const t=So(rs,e);return rs.transform(t,Co)},Pd=e=>x(_d(e));Pd.raw=_d;const ss={transform(e,{map:t,isCssUnit:o,isCssVar:a}){const{inline:i,block:r,...s}=e,l=d=>o(d)||a(d)?d:`token(spacing.${d}, ${d})`;return{"--bleed-x":t(i,l),"--bleed-y":t(r,l),marginInline:"calc(var(--bleed-x, 0) * -1)",marginBlock:"calc(var(--bleed-y, 0) * -1)",...s}},defaultValues:{inline:"0",block:"0"}},Md=(e={})=>{const t=So(ss,e);return ss.transform(t,Co)},Nd=e=>x(Md(e));Nd.raw=Md;function Ed({error:e,resetErrorBoundary:t}){const o=e instanceof Error?e.message:"Unknown error",a=h.useRef(null);return h.useEffect(()=>{a.current?.showModal()},[]),n.jsx("dialog",{ref:a,className:x({margin:"0",padding:"0",position:"fixed",top:"10",left:"10",width:"[calc(100vw - ({spacing.10} * 2))]",height:"max-content",maxHeight:"[calc(100vh - ({spacing.10} * 3))]",background:"likec4.overlay.body",rounded:"sm",borderWidth:3,borderColor:"likec4.overlay.border",shadow:"xl",outline:"none",_backdrop:{cursor:"zoom-out",backdropFilter:"blur(18px)",bg:"[color-mix(in oklab, {colors.likec4.overlay.backdrop} 60%, transparent)]"}}),onClick:i=>{if(i.stopPropagation(),i.target?.nodeName?.toUpperCase()==="DIALOG"){a.current?.close();return}},onClose:i=>{i.stopPropagation(),t()},children:n.jsxs(te,{p:"xl",gap:"lg",alignItems:"flex-start",flexWrap:"nowrap",children:[n.jsx(Xe,{size:"md",radius:"xl",color:"red",children:n.jsx(eo,{style:{width:20,height:20}})}),n.jsxs(Rt,{flex:"1",children:[n.jsx(L,{fz:"md",children:"Oops, something went wrong"}),n.jsx(qe,{maw:"100%",mah:400,type:"auto",children:n.jsx(L,{fz:"md",c:"red",style:{whiteSpace:"pre-wrap",userSelect:"all"},children:o})}),n.jsxs(te,{gap:"md",mt:"md",children:[n.jsx(Ce,{size:"sm",variant:"default",onClick:()=>t(),children:"Reset"}),n.jsx(L,{fz:"sm",c:"dimmed",children:"See console for more details and report the issue if it persists."})]})]})]})})}function Ki(e){return n.jsx(Vl,{FallbackComponent:Ed,onError:(t,o)=>{console.error(t,o)},...e})}const Qi=h.createContext(null);Qi.displayName="DiagramActorSafeContext";const Ji=h.createContext(null);Ji.displayName="DiagramApiSafeContext";const pf=Qi.Provider,gf=Ji.Provider;function oo(){const e=h.useContext(Qi);if(e===null)throw new Error("DiagramActorRef is not provided");return e}function H(){const e=h.useContext(Ji);if(e===null)throw new Error("DiagramApi is not provided");return e}function er(e,t=oe){const o=oo();return re(o,e,t)}function ze(e,t=oe,o){const a=oo(),i=D(e),r=h.useCallback(s=>i(s.context),o??[]);return re(a,r,t)}function Ne(e,t,o){const a=oo(),i=D(t),r=h.useRef(!1),s=o?.once??!1;h.useEffect(()=>{if(s&&r.current)return;let l=a.on(e,d=>{i(d),r.current=!0,s&&(l?.unsubscribe(),l=null)});return()=>{l?.unsubscribe()}},[a,e,s])}const hf=e=>e.children.overlays;function mf(){return er(hf,Object.is)}const ff=e=>e.children.search??null;function yf(){return er(ff,Object.is)}const xf=e=>e.context.view.id;function Xn(){const e=oo();return re(e,xf)}const bf=e=>e.context.view;function wf(){const e=oo();return re(e,bf,oe)}function vf(){return h.useContext(Gi)}function kf(){const e=h.useContext(Gi);if(!e)throw new Error("No LikeC4ViewModel in context found");return e}function no(){const e=Lm();return h.useMemo(()=>e?{portalProps:{target:e},withinPortal:!0}:{withinPortal:!1},[e])}const jf=rt({delays:{"open timeout":500,"close timeout":350},actions:{"update activatedBy":z({activatedBy:({context:e,event:t})=>{switch(!0){case t.type.includes("click"):return"click";case t.type.includes("mouseEnter"):return"hover";default:return e.activatedBy}}}),"keep dropdown open":z({activatedBy:"click"}),"update selected folder":z(({event:e})=>e.type==="breadcrumbs.click.root"?{selectedFolder:""}:(A(e,["breadcrumbs.click.folder","select.folder"]),{selectedFolder:e.folderPath})),"reset selected folder":z({selectedFolder:({context:e})=>e.viewModel?.folder.path??""}),"update inputs":z(({context:e,event:t})=>{A(t,"update.inputs");const o=t.inputs.viewModel?.id!==e.viewModel?.id;let a=e.selectedFolder;return t.inputs.viewModel?.folder.path.startsWith(a)||(a=t.inputs.viewModel?.folder.path??""),{view:t.inputs.view,viewModel:t.inputs.viewModel,selectedFolder:a,activatedBy:o?"hover":e.activatedBy}}),"reset search query":z({searchQuery:""}),"update search query":z(({event:e})=>(A(e,"searchQuery.change"),{searchQuery:e.value??""})),"emit navigateTo":Mp(({event:e})=>(A(e,"select.view"),{type:"navigateTo",viewId:e.viewId}))},guards:{"was opened on hover":({context:e})=>e.activatedBy==="hover","has search query":({context:e})=>!_t(e.searchQuery),"search query is empty":({context:e})=>_t(e.searchQuery)}}).createMachine({id:"breadcrumbs",context:({input:e})=>({...e,breadcrumbs:[],activatedBy:"hover",selectedFolder:"",searchQuery:"",folderColumns:[]}),initial:"idle",entry:["update activatedBy","reset selected folder"],on:{"update.inputs":{actions:"update inputs"},"searchQuery.change":{actions:["update search query",ve({type:"searchQuery.changed"})]}},states:{idle:{id:"idle",on:{"breadcrumbs.mouseEnter.*":{target:"pending",actions:"update activatedBy"},"breadcrumbs.click.*":{target:"active",actions:"update activatedBy"}}},pending:{on:{"breadcrumbs.mouseEnter.*":{actions:"update activatedBy"},"breadcrumbs.mouseLeave.*":{target:"idle"},"breadcrumbs.click.*":{target:"active",actions:"update activatedBy"}},after:{"open timeout":{target:"active"}}},active:{tags:["active"],initial:"decide",on:{"dropdown.dismiss":{target:"#idle"},"breadcrumbs.mouseLeave":{guard:"was opened on hover",target:".closing"},"dropdown.mouseLeave":{guard:"was opened on hover",target:".closing"},"searchQuery.changed":{target:".decide"}},states:{decide:{always:[{guard:"has search query",target:"search"},{target:"opened"}]},opened:{on:{"searchQuery.changed":{guard:"has search query",actions:"keep dropdown open",target:"search"},"breadcrumbs.click.viewtitle":{actions:"reset selected folder"},"breadcrumbs.click.*":{actions:"update selected folder"},"select.folder":{actions:["keep dropdown open","update selected folder"]},"select.view":{actions:["emit navigateTo"]}}},search:{on:{"breadcrumbs.click.viewtitle":{actions:["reset search query","reset selected folder"],target:"opened"},"breadcrumbs.click.*":{actions:["reset search query","update selected folder"],target:"opened"},"select.view":{actions:["emit navigateTo"]}}},closing:{on:{"breadcrumbs.mouseEnter.*":{target:"decide"},"dropdown.mouseEnter":{target:"decide"}},after:{"close timeout":{target:"#idle"}}}}}}}),Cf=jf;function Sf(e,t){if(e._type==="dynamic")try{if(t??=e.variant,t==="sequence")return e.sequenceLayout.bounds}catch{}return e.bounds}function _f({points:e,controlPoints:t,labelBBox:o}){let a=1/0,i=1/0,r=-1/0,s=-1/0;if(t)for(const l of t)a=Math.min(a,l.x),i=Math.min(i,l.y),r=Math.max(r,l.x),s=Math.max(s,l.y);else for(const[l,d]of e)a=Math.min(a,l),i=Math.min(i,d),r=Math.max(r,l),s=Math.max(s,d);return o&&(a=Math.min(a,o.x),i=Math.min(i,o.y),r=Math.max(r,o.x+o.width),s=Math.max(s,o.y+o.height)),{x:a,y:i,width:r-a,height:s-i}}function Pf({nodes:e,edges:t}){return Me.expand(Me.merge(...e,...t.map(_f)),10)}function Id(e){const{view:{drifts:t,_layout:o,...a},xynodes:i,xystore:r}=e,{nodeLookup:s,edgeLookup:l}=r.getState(),d=new Set,u=ie(a.nodes,p=>{const g=s.get(p.id);if(!g)return console.error(`Internal node not found for ${p.id}`),p;const m=i.find(b=>b.id===p.id)?.data??g.data,y=g.internals.positionAbsolute,{width:w,height:C}=Et(g);return(!bn(y,p)||p.width!==w||p.height!==C)&&d.add(p.id),{...p,shape:m.shape,color:m.color,style:{...m.style},x:Math.floor(y.x),y:Math.floor(y.y),width:Math.ceil(w),height:Math.ceil(C)}}),c=ie(a.edges,p=>{const g=l.get(p.id);if(!g)return console.error(`Internal edge not found for ${p.id}`),p;const m=g.data;let y=m.controlPoints??[];const w=d.has(g.source)||d.has(g.target);y.length===0&&w&&(y=xn(m.points));const C={...ct(p,["controlPoints","labelBBox"]),points:m.points};return m.labelBBox&&(C.labelBBox=m.labelBBox),xe(y,1)&&(C.controlPoints=y),C});return{op:"save-view-snapshot",layout:{...a,_layout:"manual",bounds:Pf({nodes:u,edges:c}),nodes:u,edges:c}}}const Mf=function(e){return e.get("diagram")},Rd=function(e){return e.get("diagram").getSnapshot().context},Dd=()=>ue.raise({type:"sync"},{delay:200,id:"sync"}),Gt=()=>ue.cancel("sync"),Bd=(e=50)=>ue.raise(({event:t})=>t,{delay:e}),Ld=e=>e.op==="reset-manual-layout"||e.op==="save-view-snapshot",Td=Ct(bp(Ld)),Ad=()=>ue.assign(({system:e})=>{const t=Rd(e);return{beforeEditing:{xynodes:t.xynodes.map(({measured:o,...a})=>({...ct(a,["selected","dragging","resizing"]),data:ct(a.data,["dimmed","hovered"]),measured:o,initialWidth:o?.width??a.width??a.initialWidth,initialHeight:o?.height??a.height??a.initialHeight})),xyedges:t.xyedges.map(o=>({...ct(o,["selected"]),data:ct(o.data,["active","dimmed","hovered"])})),change:Id(t),view:t.view,synched:!1}}}),Nf=()=>ue.enqueueActions(({enqueue:e,event:t})=>{e(Ad()),t.type==="edit.start"&&e.assign({editing:t.subject})}),Ef=()=>ue.stopChild("hotkey"),tr=()=>ue.enqueueActions(({check:e,enqueue:t,self:o})=>{const a=e("can undo"),i=o.getSnapshot().children.hotkey;if(!a&&i){t.stopChild(i);return}a&&!i&&t.spawnChild("hotkey",{id:"hotkey"})}),zd=()=>ue.assign(({context:e})=>{const t=e.beforeEditing;return t?{beforeEditing:null,editing:null,history:[...e.history,t]}:{editing:null}}),ha=()=>ue.enqueueActions(({event:e,enqueue:t})=>{if(e.type==="edit.finish"&&e.wasChanged){t(zd()),t(Dd());return}t.assign({beforeEditing:null,editing:null})}),If=()=>ue.assign(({context:e})=>({beforeEditing:e.beforeEditing&&e.beforeEditing.synched===!1?{...e.beforeEditing,synched:!0}:e.beforeEditing,history:e.history.map(t=>({...t,synched:!0}))})),Rf=()=>ue.assign(({context:e})=>e.history.length<=1?{history:[]}:{history:e.history.slice(0,e.history.length-1)}),Df=()=>ue.enqueueActions(({context:e,enqueue:t,system:o})=>{const a=pt(e.history);if(!a)return;t(Gt()),t(Rf()),t(tr());const i=Mf(o);t.sendTo(i,{type:"update.view",view:a.view,xyedges:a.xyedges,xynodes:a.xynodes,source:"editor"}),t.assign({pendingChanges:[]}),a.synched?t.raise({type:"change",change:a.change},{delay:50}):t(Dd())}),ii=()=>ue.assign(({context:e,system:t})=>{const o=Rd(t),a=Id(o);return{pendingChanges:[...Td(e.pendingChanges),a]}}),Bf=Wn(({sendBack:e})=>{const t=fn([["mod + z",o=>{o.stopPropagation(),e({type:"undo"})},{preventDefault:!0}]]);return document.body.addEventListener("keydown",t,{capture:!0}),()=>{document.body.removeEventListener("keydown",t,{capture:!0})}}),Lf=bo(()=>{throw new Error("Not implemented")}),Tf=bo(()=>{throw new Error("Not implemented")}),$d=function(e){return e.system.get("diagram")},ue=rt({delays:{"350ms":350,waitBeforeSync:2e3},actors:{applyLatest:Lf,executeChange:Tf,hotkey:Bf},guards:{"has pending":({context:e})=>e.pendingChanges.length>0,"can undo":({context:e})=>e.history.length>0}}),pe={idle:{target:"#idle"},editing:{target:"#editing"},afterEdit:{target:"#afterEdit"},pending:{target:"#pending"},applyLatestToManual:{target:"#applyLatestToManual"},executeChanges:{target:"#executeChanges"}},Af=ue.createStateConfig({id:"idle",on:{sync:{...pe.pending},"edit.start":{...pe.editing}}}),zf=ue.createStateConfig({id:"editing",tags:"pending",entry:[Nf(),Gt()],on:{change:{actions:ha(),...pe.executeChanges},"edit.finish":{actions:ha(),...pe.afterEdit},undo:{actions:ha(),...pe.idle}}}),$f=ue.createStateConfig({id:"pending",tags:["pending"],entry:tr(),on:{sync:{reenter:!0,...pe.pending},"edit.start":{actions:[ii()],...pe.editing}},after:{waitBeforeSync:{actions:[ii()],...pe.executeChanges}}}),Vf=ue.createStateConfig({id:"afterEdit",always:[{guard:"has pending",...pe.pending},{...pe.idle}]}),Ff=ue.createStateConfig({id:"applyLatestToManual",entry:[Gt(),Ad()],initial:"call",on:{"*":{actions:[vl(({event:e})=>`applyLatestToManual received unexpected event: ${e.type}`),Bd(350)]}},states:{call:{invoke:{src:"applyLatest",input:({context:e})=>{const t=e.beforeEditing?.change.layout;return{current:t&&t._layout==="manual"?t:void 0,viewId:e.viewId}},onDone:{actions:vi($d,({event:e})=>({type:"update.view",view:e.output.updated}),{delay:10}),target:"wait"},onError:{actions:[z({beforeEditing:null,pendingChanges:[]}),({event:e})=>{console.error(e.error)}],...pe.idle}}},wait:{entry:zd(),after:{"350ms":{actions:[ii(),tr()],...pe.executeChanges}}}}}),Wf=ue.createStateConfig({id:"executeChanges",entry:[z(({event:e,context:t})=>{if(e.type==="change"){if(Ld(e.change))return{pendingChanges:[...Td(t.pendingChanges),e.change]};if(!t.pendingChanges.includes(e.change))return{pendingChanges:[...t.pendingChanges,e.change]}}return{}}),Gt()],invoke:{src:"executeChange",input:({context:e})=>({changes:e.pendingChanges,viewId:e.viewId}),onDone:{actions:Oe(({context:e,enqueue:t})=>{const o=fo(e.pendingChanges,a=>a.op==="save-view-snapshot");o&&t.sendTo($d,{type:"update.view-bounds",bounds:o.layout.bounds}),t.assign({pendingChanges:[]})}),...pe.idle},onError:{actions:({event:e})=>{console.error(e.error)},...pe.afterEdit}},on:{"*":{actions:Bd()}}}),Of=ue.createMachine({id:"editor",context:({input:e})=>({viewId:e.viewId,beforeEditing:null,editing:null,pendingChanges:[],history:[]}),initial:"idle",states:{idle:Af,editing:zf,pending:$f,afterEdit:Vf,applyLatestToManual:Ff,executeChanges:Wf},on:{cancel:{actions:[Gt(),z({editing:null,beforeEditing:null,pendingChanges:[]})],...pe.idle},synced:{actions:If()},undo:{guard:"can undo",actions:Df(),...pe.idle},change:{...pe.executeChanges},applyLatestToManual:{...pe.applyLatestToManual},reset:{actions:[Gt(),z({history:[],editing:null,beforeEditing:null,pendingChanges:[]}),Ef()],...pe.idle}}}),Vd=Of,Fd=(e,t)=>e.find(a=>"modelFqn"in a.data&&a.data.modelFqn===t)||null;function J(e){return{get overlaysActorRef(){return e.get("overlays")??null},get diagramActorRef(){return W(e.get("diagram"),"Diagram actor not found")},get searchActorRef(){return e.get("search")??null},get editorActorRef(){return e.get("editor")??null}}}J.editorActor=({system:e})=>e.get("editor");J.overlaysActor=({system:e})=>e.get("overlays");J.diagramActor=({system:e})=>e.get("diagram");J.searchActor=({system:e})=>e.get("search");function Zt(e,t){return e.view.nodes.find(o=>o.id===t)??null}function or(e,t){return e.view.edges.find(o=>o.id===t)??null}function Hf(e){const t=new Map,o=e.context.xynodes.reduce((a,i)=>{let r=i.position;if(i.parentId){const d=t.get(i.parentId)??{x:0,y:0};r={x:r.x+d.x,y:r.y+d.y}}if(t.set(i.id,r),i.hidden||i.data.dimmed)return a;const s=i.measured?.width??i.width??i.initialWidth,l=i.measured?.height??i.height??i.initialHeight;return a.minX=Math.min(a.minX,r.x),a.minY=Math.min(a.minY,r.y),a.maxX=Math.max(a.maxX,r.x+s),a.maxY=Math.max(a.maxY,r.y+l),a},{minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0});return o.minX===1/0?{bounds:e.context.view.bounds}:{duration:350,bounds:{x:o.minX-10,y:o.minY-10,width:o.maxX-o.minX+20,height:o.maxY-o.minY+20}}}const Xf=32;function qf(e){const t=W(e.context.activeWalkthrough),o=W(e.context.xyedges.find(d=>d.id===t.stepId)),a=e.context.xystore.getState(),i=W(a.nodeLookup.get(o.source)),r=W(a.nodeLookup.get(o.target)),s=Cp([i,r],a);let l;if(t.parallelPrefix){const d=e.context.xynodes.find(u=>u.type==="seq-parallel"&&u.data.parallelPrefix===t.parallelPrefix);d&&(l={x:d.position.x,y:d.position.y,...Et(d)})}return l??=Yf(o,a),l?l=Me.merge(l,s):l=s,{duration:350,bounds:Me.expand(l,Xf)}}function Yf(e,t){const o=t.nodeLookup.get(e.source),a=t.nodeLookup.get(e.target);if(!o||!a)return null;const i=Lp({id:e.id,sourceNode:o,targetNode:a,sourceHandle:e.sourceHandle||null,targetHandle:e.targetHandle||null,connectionMode:t.connectionMode});return i?Me.fromPoints([[i.sourceX,i.sourceY],[i.targetX,i.targetY]]):null}function ri(e){switch(e.type){case"element":case"compound-element":case"seq-actor":return e.data.modelFqn;case"deployment":case"compound-deployment":return e.data.modelFqn??e.data.deploymentFqn;case"seq-parallel":case"view-group":return null;default:Le(e)}}function Gf(e,t){const o=e.lastOnNavigate?.fromNode,a=o&&e.xynodes.find(s=>s.id===o),i=a&&ri(a),r=i&&t.xynodes.find(s=>ri(s)===i);return{fromNode:a,toNode:r}}function Zf(e,t){let{width:o,height:a,transform:i}=e.xystore.getState();const r=Math.max(i[2],1);return Qt(t,o,a,Ae,r,e.fitViewPadding)}const si={top:"40px",bottom:"22px",left:"22px",right:"22px"},we={dagre:{ranksep:60,nodesep:35,edgesep:25},edgeLabel:{width:140,height:10,minlen:1,weight:1},emptyNodeOffset:120,nodeWidth:330,nodeHeight:180,compound:{labelHeight:2,paddingTop:50,paddingBottom:32}};function Uf(){const e=new Fn.graphlib.Graph({directed:!0,compound:!0,multigraph:!0});return e.setGraph({...we.dagre,rankdir:"LR"}),e.setDefaultEdgeLabel(()=>({...we.edgeLabel})),e.setDefaultNodeLabel(()=>({})),e}const li="-port";function ma(e,t,o){const a=new cn(r=>({id:`${e}-${r}`,portId:`${e}-${r}`})),i=yi(t);for(const r of i.sorted){const s=i.children(r).length>0,l=r.id,d=`${e}-${l}`,u=s?`${d}${li}`:d;a.set(l,{id:d,portId:u}),o.setNode(d,{column:e,element:r,isCompound:s,portId:u,inPorts:[],outPorts:[],width:we.nodeWidth,height:we.nodeHeight}),s&&(o.setNode(u,{element:r,portId:u,isCompound:s,inPorts:[],outPorts:[],width:we.nodeWidth-we.dagre.ranksep,height:we.compound.labelHeight}),o.setParent(u,d));const c=i.parent(r);c&&o.setParent(d,`${e}-${c.id}`)}return{...i,byId:r=>{const s=i.byId(r),l=a.get(s.id);return{element:s,graph:l}},graphNodes:a}}function Kf(e){return Fn.layout(e,{}),t=>{const o=e.node(t),{x:a,y:i,width:r,height:s}=o;return{position:{x:a-Math.round(r/2),y:i-Math.round(s/2)},width:r,height:s}}}var vn;(e=>{e.Empty="@empty"})(vn||(vn={}));function Qf(e,t){const o=Uf(),a=ma("incomers",e.incomers,o),i=ma("subjects",e.subjects,o),r=ma("outgoers",e.outgoers,o),s=[];se(jp(se(Wa(e.incoming),ie(f=>({id:f.source.id,sourceFqn:f.source.id,targetFqn:f.target.id,source:a.byId(f.source.id).graph,target:i.byId(f.target.id).graph,relation:f}))),se(Wa(e.outgoing),ie(f=>({id:f.target.id,sourceFqn:f.source.id,targetFqn:f.target.id,source:i.byId(f.source.id).graph,target:r.byId(f.target.id).graph,relation:f})))),ie(f=>({...f,expr:`${f.source.id}->${f.target.id}`})),kp(bt("expr")),vp(f=>{const k=f[0].source,S=f[0].target,E=f[0].expr;o.node(k.id).outPorts.push(S.id),o.node(S.id).inPorts.push(k.id),o.setEdge(k.portId,S.portId,{...we.edgeLabel},E),s.push({name:E,sourceFqn:f[0].sourceFqn,targetFqn:f[0].targetFqn,source:k.id,sourceHandle:k.id+"_out"+(o.node(k.id).outPorts.length-1),target:S.id,targetHandle:S.id+"_in"+(o.node(S.id).inPorts.length-1),relations:ie(f,bt("relation"))})}));for(const f of i.graphNodes.values()){const k=f.id,S=o.node(k);if(S.isCompound)continue;const E=Math.max(o.inEdges(k)?.length??0,o.outEdges(k)?.length??0);E>2&&(S.height=S.height+(E-3)*14)}const l=[...a.graphNodes.values(),...i.graphNodes.values(),...r.graphNodes.values()];if(a.graphNodes.size==0){const f="incomers-empty";o.setNode(f,{column:"incomers",element:null,isCompound:!1,portId:f,inPorts:[],outPorts:[],width:we.nodeWidth,height:we.nodeHeight});for(const k of i.graphNodes.values())o.setEdge(f,k.portId);l.push({id:f,portId:f})}if(r.graphNodes.size==0){const f="outgoers-empty";o.setNode(f,{column:"outgoers",element:null,isCompound:!1,portId:f,inPorts:[],outPorts:[],width:we.nodeWidth,height:we.nodeHeight});for(const k of i.graphNodes.values())o.setEdge(k.portId,f);l.push({id:f,portId:f})}const d=o.edgeCount();if(d>10)for(const f of o.edges())o.setEdge(f,{...we.edgeLabel,width:d>25?800:400});const u=Kf(o),c=se(l,Ct(f=>f.id===f.portId),En(f=>[f.id,u(f.id)]));function p(f){return c[f]??=se(o.children(f)??[],Ct(k=>!k.endsWith(li)),ie(k=>p(k)),Hl(k=>{O(k.length>0,`Node ${f} has no nested nodes`)}),An((k,S)=>({minY:Math.min(k.minY,S.position.y),maxY:Math.max(k.maxY,S.position.y+S.height)}),{minY:1/0,maxY:-1/0}),({minY:k,maxY:S})=>{const{position:{x:E},width:B}=u(f);return k=k-we.compound.paddingTop,S=S+we.compound.paddingBottom,{position:{x:E,y:k},width:B,height:S-k}})}function g(f){const k=o.parent(f);return k?g(k)+1:0}function m(f){const k=o.children(f)??[];return k.length===0?0:1+Math.max(...k.map(m))}const y=(f,k,S)=>se(S,ie((E,B)=>({port:f+"_"+k+B,topY:p(E).position.y})),mn(bt("topY")),ie(bt("port")));let w=0,C=0;const[b]=[...i.root];O(b,"Subjects should not be empty");let v=p(i.graphNodes.get(b.id).id);const j=l.map(({id:f})=>{const{element:k,inPorts:S,outPorts:E,column:B}=o.node(f);let{position:_,width:Y,height:F}=p(f);if(!k){if(F=Math.min(v.height,300),_.y=v.position.y+v.height/2-F/2,B==="incomers")Y=v.position.x-we.emptyNodeOffset-_.x;else{const Pe=_.x+Y;_.x=v.position.x+v.width+we.emptyNodeOffset,Y=Pe-_.x}return{id:f,parent:null,x:_.x,y:_.y,title:"empty node",description:null,technology:null,tags:[],links:[],color:"muted",shape:"rectangle",style:{border:"dashed",opacity:50},kind:vn.Empty,level:0,labelBBox:{x:_.x,y:_.y,width:Y,height:F},children:[],width:Y,height:F,column:B,ports:{in:[],out:[]},existsInCurrentView:!1}}const $=o.parent(f),N=(o.children(f)??[]).filter(Pe=>!Pe.endsWith(li));w=Math.min(w,_.x),C=Math.min(C,_.y);const V=t?dn(k.scopedViews(),Pe=>Pe.id!==t.id)?.id??null:null,R=t?.findNodeWithElement(k.id),K=t&&!R?dn(k.ancestors(),Pe=>!!t.findNodeWithElement(Pe.id))?.id:null,_e=R??(K&&t?.findNodeWithElement(K));return{id:f,parent:$??null,x:_.x,y:_.y,title:k.title,description:Ha(k.$element)??null,technology:k.technology,tags:[...k.tags],links:null,color:_e?.color??k.color,shape:R?.shape??k.shape,icon:R?.icon??k.icon??"none",modelRef:k.id,kind:k.kind,level:g(f),labelBBox:{x:_.x,y:_.y,width:Y,height:F},style:ct({...(R??_e)?.style,...k.$element.style},["color","shape","icon"]),navigateTo:V,...N.length>0&&{depth:m(f)},children:N,width:Y,height:F,column:B,ports:{in:y(f,"in",S),out:y(f,"out",E)},existsInCurrentView:!!R}});return{subjectExistsInScope:!t||t.includesElement(b.id),bounds:{x:Math.min(w,0),y:Math.min(C,0),width:o.graph().width??100,height:o.graph().height??100},nodes:j,edges:o.edges().reduce((f,k)=>{const S=o.edge(k),E=k.name;if(!E)return f;const{name:B,source:_,sourceFqn:Y,target:F,targetFqn:$,relations:N,sourceHandle:V,targetHandle:R}=W(fo(s,ke=>ke.name===E)),K=gn(N),_e=K?.title??"untitled",Pe=N.length>1,Dt=gn(hn(N.flatMap(ke=>ke.navigateTo?.id?ke.navigateTo.id:[])));return f.push(yl({id:B,sourceFqn:Y,source:_,sourceHandle:V,targetFqn:$,target:F,targetHandle:R,label:Pe?`${N.length} relationships`:_e,navigateTo:Dt,color:K?.color??"gray",existsInCurrentView:!t||N.every(ke=>t.includesRelation(ke.id)),points:S.points.map(ke=>[ke.x,ke.y]),line:K?.line??"dashed",head:K?.head,tail:K?.tail,relations:N.map(ke=>ke.id),parent:null})),f},[])}}function Jf(e,t,o){const a=Se();return h.useMemo(()=>{const i=t?a.findView(t):null,r=Qf(Mr(e,a,t,o),o==="view"?i:null);return i&&(o==="global"||!r.subjectExistsInScope)&&(r.edges=r.edges.map(s=>(s.existsInCurrentView=s.relations.every(l=>i.includesRelation(l)),s))),Object.assign(r,{subject:e})},[a,e,t,o,Mr])}function Wd(e){const t=[],o=[],a=new Map,i=fi.from(e.nodes.reduce((l,d)=>(a.set(d.id,d),d.parent||l.push({node:d,parent:null}),l),[])),r=l=>W(a.get(l),`Node not found: ${l}`);let s;for(;s=i.dequeue();){const{node:l,parent:d}=s,u=xe(l.children,1)||l.kind==on;if(u)for(const w of l.children)i.enqueue({node:r(w),parent:l});const c={x:l.x,y:l.y};d&&(c.x-=d.x,c.y-=d.y);const p=l.id,g={id:p,position:c,zIndex:u?nt.Compound:nt.Element,style:{width:l.width,height:l.height},initialWidth:l.width,initialHeight:l.height,...d&&{parentId:d.id}},m=l.modelRef??null,y={navigateTo:l.navigateTo??null};switch(!0){case l.kind===vn.Empty:{t.push({...g,type:"empty",data:{column:l.column}});break}case(u&&!!m):{t.push({...g,type:"compound",data:{id:p,column:l.column,title:l.title,color:l.color,shape:l.shape,style:l.style,depth:l.depth??0,icon:l.icon??"none",ports:l.ports,existsInCurrentView:l.existsInCurrentView,fqn:m,...y}});break}default:O(m,"Element should have either modelRef or deploymentRef"),t.push({...g,type:"element",data:{id:p,column:l.column,fqn:m,title:l.title,technology:l.technology,description:l.description,height:l.height,width:l.width,color:l.color,shape:l.shape,icon:l.icon??"none",ports:l.ports,style:l.style,existsInCurrentView:l.existsInCurrentView,tags:l.tags,...y}})}}for(const l of e.edges){const d=l.source,u=l.target,c=l.id;if(!xe(l.points,2)){console.error("edge should have at least 2 points",l);continue}if(!xe(l.relations,1)){console.error("edge should have at least 1 relation",l);continue}o.push({id:c,type:"relationship",source:d,target:u,sourceHandle:l.sourceHandle,targetHandle:l.targetHandle,data:{sourceFqn:l.sourceFqn,targetFqn:l.targetFqn,relations:l.relations,color:l.color??"gray",label:l.label,navigateTo:l.navigateTo??null,line:l.line??"dashed",existsInCurrentView:l.existsInCurrentView},interactionWidth:20})}return{xynodes:t,xyedges:o}}const ls=e=>e.find(t=>t.data.column==="subjects"&&jo(t.parentId)),ey=bo(async({input:e,self:t,signal:o})=>{const{subjectId:a,navigateFromNode:i,xyflow:r,xystore:s,update:l}=e;let{nodes:d,width:u,height:c}=s.getState();const p=Wd(l),g=()=>{const{nodes:_,edges:Y}=s.getState();return{xynodes:wn(_,p.xynodes),xyedges:qi(Y,p.xyedges)}},m=W(t._parent);let y=r.getZoom();const w=Math.max(y,1),C=Qt(l.bounds,u,c,Ae,w,si),b=p.xynodes.find(_=>_.type!=="empty"&&_.data.column==="subjects"&&_.data.fqn===a)??ls(p.xynodes),v=ls(d),j=i?d.find(_=>_.id===i):d.find(_=>_.type!=="empty"&&_.data.column!=="subjects"&&_.data.fqn===a);if(!b||!j||b.type==="empty"||!v||b.data.fqn===v.data.fqn)return await r.setViewport(C),g();const f={x:b.position.x+(b.initialWidth??0)/2,y:b.position.y+(b.initialHeight??0)/2},k=r.getInternalNode(v.id),S=ti(k),E=new Set;if(d.forEach(_=>{if(_.id!==j.id){if(_.data.column==="subjects"){E.add(_.id);return}_.parentId&&(_.parentId===j.id||E.has(_.parentId))&&E.add(_.id)}}),d=wn(d,d.flatMap(_=>E.has(_.id)?[]:_.id!==j.id?{..._,data:{..._.data,dimmed:_.data.column==="subjects"?"immediate":!0}}:{...ct(_,["parentId"]),position:{x:S.x-_.initialWidth/2,y:S.y-_.initialHeight/2},zIndex:nt.Max,hidden:!1,data:{..._.data,dimmed:!1}})),m.send({type:"update.xydata",xynodes:d,xyedges:[]}),await Nr(120),p.xynodes=p.xynodes.map(G.setDimmed(!1)),o.aborted)return g();const B=300;return r.setCenter(S.x,S.y,{zoom:y,duration:B,interpolate:"smooth"}),await Nr(B),await r.setCenter(f.x,f.y,{zoom:y}),g()}),lt=rt({actors:{layouter:ey},guards:{hasViewId:({context:e})=>e.viewId!==null,isReady:({context:e})=>e.xyflow!==null&&e.xystore!==null&&e.layouted!==null,anotherSubject:({context:e,event:t})=>t.type==="update.view"?e.layouted?.subject!==t.layouted.subject:!1}}),ds=()=>lt.assign(({event:e})=>(A(e,"xyflow.init"),{xyflow:e.instance,xystore:e.store})),cs=()=>lt.assign(({event:e})=>(A(e,"update.view"),{layouted:e.layouted,...Wd(e.layouted)})),ty=()=>lt.createAction(({context:e})=>{O(e.xystore,"xystore is not initialized");const{domNode:t,updateNodeInternals:o}=e.xystore.getState(),a=new Set(e.xyedges.flatMap(s=>[s.source,s.target]));if(a.size===0||!t)return;const i=new Map,r=t.querySelectorAll(".react-flow__node");for(const s of r){const l=s.getAttribute("data-id");l&&a.has(l)&&i.set(l,{id:l,nodeElement:s,force:!0})}o(i,{triggerFitView:!1})}),fa=e=>lt.createAction(({context:t,event:o})=>{e??=o.type==="fitDiagram"?o:{};let{duration:a,bounds:i}=e??{};a??=450;const{xyflow:r,xystore:s}=t;O(r,"xyflow is not initialized"),O(s,"xystore is not initialized"),i??=t.layouted?.bounds;const l=Math.max(r.getZoom(),1);if(i){const{width:d,height:u}=s.getState(),c=Qt(i,d,u,Ae,l,si);r.setViewport(c,a>0?{duration:a,interpolate:"smooth"}:void 0).catch(console.error)}else r.fitView({minZoom:Ae,maxZoom:l,padding:si,...a>0&&{duration:a,interpolate:"smooth"}}).catch(console.error)}),oy=()=>lt.assign(({context:e,event:t})=>(A(t,"xyflow.applyNodeChanges"),{xynodes:Ei(t.changes,e.xynodes)})),ny=()=>lt.assign(({context:e,event:t})=>(A(t,"xyflow.applyEdgeChanges"),{xyedges:Ni(t.changes,e.xyedges)})),us=()=>lt.enqueueActions(({system:e,event:t})=>{if(t.type!=="xyflow.edgeClick")return;const o=J(e).diagramActorRef,a=t.edge.data.relations;xe(a,1)&&o.send({type:"open.source",relation:a[0]})}),ps=()=>lt.assign({xyflow:null,layouted:null,xystore:null,xyedges:[],xynodes:[]}),ay=lt.createMachine({id:"relationships-browser",context:({input:e})=>({subject:e.subject,viewId:e.viewId,scope:e.viewId?e.scope:"global",closeable:e.closeable??!0,enableSelectSubject:e.enableSelectSubject??!0,enableChangeScope:e.enableChangeScope??!0,xyflow:null,xystore:null,layouted:null,navigateFromNode:null,xynodes:[],xyedges:[]}),initial:"initializing",on:{"xyflow.applyNodeChanges":{actions:oy()},"xyflow.applyEdgeChanges":{actions:ny()}},states:{initializing:{on:{"xyflow.init":{actions:ds(),target:"isReady"},"update.view":{actions:cs(),target:"isReady"},stop:"closed",close:"closed"}},isReady:{always:[{guard:"isReady",actions:[fa({duration:0}),ve({type:"xyflow.updateNodeInternals"},{delay:150})],target:"active"},{target:"initializing"}]},active:{initial:"idle",tags:["active"],on:{"xyflow.nodeClick":{actions:Oe(({event:e,enqueue:t})=>{if("fqn"in e.node.data){const o=e.node.data.fqn;t.raise({type:"navigate.to",subject:o,fromNode:e.node.id})}})},"xyflow.edgeClick":[{guard:"hasViewId",actions:Oe(({event:e,context:t,system:o,enqueue:a})=>{e.edge.selected||e.edge.data.relations.length>1?a.sendTo(J(o).overlaysActorRef,{type:"open.relationshipDetails",viewId:t.viewId,source:e.edge.data.sourceFqn,target:e.edge.data.targetFqn}):a(us())})},{actions:us()}],"navigate.to":{actions:[z({subject:({event:e})=>e.subject,viewId:({event:e,context:t})=>e.viewId??t.viewId??null,navigateFromNode:({event:e})=>e.fromNode??null})]},"xyflow.paneDblClick":{actions:fa()},"update.view":{actions:cs(),target:".layouting"},"change.scope":{actions:z({scope:({event:e})=>e.scope})},"xyflow.updateNodeInternals":{actions:ty()},fitDiagram:{actions:fa()},"xyflow.resized":{actions:[tt("fitDiagram"),ve({type:"fitDiagram"},{id:"fitDiagram",delay:300})]},"xyflow.init":{actions:ds()},"xyflow.unmount":{target:"initializing"},close:"closed"},states:{idle:{on:{"xyflow.edgeMouseEnter":{actions:[z({xyedges:({context:e,event:t})=>{const o=e.xyedges.some(a=>a.data.dimmed!==!1||a.selected);return e.xyedges.map(a=>a.id===t.edge.id?G.setData(a,{hovered:!0,dimmed:!1}):o&&!a.selected?G.setDimmed(a,"immediate"):a)}}),tt("undim.edges"),tt("dim.nonhovered.edges"),ve({type:"dim.nonhovered.edges"},{id:"dim.nonhovered.edges",delay:200})]},"xyflow.edgeMouseLeave":{actions:[z({xyedges:({context:e,event:t})=>e.xyedges.map(o=>o.id===t.edge.id?G.setHovered(o,!1):o)}),tt("dim.nonhovered.edges"),ve({type:"undim.edges"},{id:"undim.edges",delay:400})]},"dim.nonhovered.edges":{actions:z({xyedges:({context:e})=>e.xyedges.map(t=>t.data.hovered?t:G.setDimmed(t,t.data.dimmed==="immediate"?"immediate":!0))})},"undim.edges":{actions:z({xyedges:({context:e})=>e.xyedges.map(G.setDimmed(!1))})},"xyflow.selectionChange":{actions:Oe(({event:e,context:t,enqueue:o})=>{e.edges.length===0&&t.xyedges.some(a=>a.data.dimmed)&&!t.xyedges.some(a=>a.data.hovered)&&o.raise({type:"undim.edges"})})}}},layouting:{invoke:{id:"layouter",src:"layouter",input:({context:e})=>({subjectId:e.subject,navigateFromNode:e.navigateFromNode,xyflow:W(e.xyflow),xystore:W(e.xystore),update:W(e.layouted)}),onDone:{target:"idle",actions:Oe(({enqueue:e,event:t})=>{e.assign({xynodes:t.output.xynodes,xyedges:t.output.xyedges,navigateFromNode:null}),e.raise({type:"fitDiagram",duration:200},{id:"fitDiagram",delay:50});for(let o=1;o<8;o++)e.raise({type:"xyflow.updateNodeInternals"},{delay:120+o*75})})}},on:{"update.xydata":{actions:z({xynodes:({event:e})=>e.xynodes,xyedges:({event:e})=>e.xyedges})},"xyflow.applyEdgeChanges":{},"xyflow.applyNodeChanges":{}}}}},closed:{id:"closed",type:"final",entry:ps()}},exit:ps()}),Od=ay,iy=rt({actors:{relationshipsBrowserLogic:Od}}).createMachine({id:"element-details",context:({input:e})=>({...e,initiatedFrom:{node:e.initiatedFrom?.node??null,clientRect:e.initiatedFrom?.clientRect??null}}),initial:"active",states:{active:{entry:kl("relationshipsBrowserLogic",{id:({self:e})=>`${e.id}-relationships`,input:({context:e})=>({subject:e.subject,viewId:e.currentView.id,scope:"view",enableSelectSubject:!1,enableChangeScope:!0,closeable:!1})}),exit:[vi(({self:e})=>`${e.id}-relationships`,{type:"close"}),Ft(({self:e})=>`${e.id}-relationships`)],on:{"change.subject":{actions:z({subject:({event:e})=>e.subject})},close:"closed"}},closed:{id:"closed",type:"final"}}}),ry=iy;function sy(e){const t=[],o=[],a=new Map,i=fi.from(e.nodes.reduce((l,d)=>(a.set(d.id,d),d.parent||l.push({node:d,parent:null}),l),[])),r=l=>W(a.get(l),`Node not found: ${l}`);let s;for(;s=i.dequeue();){const{node:l,parent:d}=s,u=xe(l.children,1);if(u)for(const w of l.children)i.enqueue({node:r(w),parent:l});const c={x:l.x,y:l.y};d&&(c.x-=d.x,c.y-=d.y);const p=l.id,g={id:p,draggable:!1,deletable:!1,position:c,zIndex:u?nt.Compound:nt.Element,style:{width:l.width,height:l.height},initialWidth:l.width,initialHeight:l.height,...d&&{parentId:d.id}},m=l.modelRef,y={navigateTo:l.navigateTo??null};switch(!0){case u:{t.push({...g,type:"compound",data:{id:p,column:l.column,title:l.title,color:l.color,style:l.style,depth:l.depth??0,icon:l.icon??"none",ports:l.ports,fqn:m,...y}});break}default:t.push({...g,type:"element",data:{id:p,column:l.column,fqn:m,title:l.title,technology:l.technology,description:l.description??null,height:l.height,width:l.width,color:l.color,shape:l.shape,icon:l.icon??"none",ports:l.ports,style:l.style,tags:l.tags,...y}})}}for(const{source:l,target:d,relationId:u,label:c,technology:p,description:g,navigateTo:m=null,color:y="gray",line:w="dashed",...C}of e.edges){const b=C.id;o.push({id:b,type:"relationship",source:l,target:d,sourceHandle:C.sourceHandle,targetHandle:C.targetHandle,deletable:!1,data:{relationId:u,label:c,color:y,navigateTo:m,line:w,description:g??null,...p&&{technology:p}}})}return{xynodes:t,xyedges:o,bounds:e.bounds}}function gs(e){return"edgeId"in e?(O(Ii(e.edgeId),"edgeId is required"),{edgeId:e.edgeId}):{source:e.source,target:e.target}}const hs={x:"22px",y:"22px"},ly=rt({actions:{"xyflow:fitDiagram":({context:e},t)=>{let{duration:o,bounds:a}=t??{};o??=450;const{xyflow:i,xystore:r}=e;O(i,"xyflow is not initialized"),O(r,"xystore is not initialized"),a??=e.bounds;const s=Math.max(i.getZoom(),1);if(a){const{width:l,height:d}=r.getState(),u=Qt(a,l,d,Ae,s,hs);i.setViewport(u,o>0?{duration:o}:void 0).catch(console.error)}else i.fitView({minZoom:Ae,maxZoom:s,padding:hs,...o>0&&{duration:o,interpolate:"smooth"}}).catch(console.error)},"xyflow:updateNodeInternals":({context:e})=>{O(e.xystore,"xystore is not initialized");const{domNode:t,updateNodeInternals:o}=e.xystore.getState(),a=new Set(e.xyedges.flatMap(r=>[r.source,r.target]));if(a.size===0||!t)return;const i=new Map;for(const r of a){const s=t.querySelector(`.react-flow__node[data-id="${r}"]`);s&&i.set(r,{id:r,nodeElement:s,force:!0})}o(i,{triggerFitView:!1})},updateXYFlow:z(({context:e,event:t})=>{A(t,"xyflow.init");let o=e.initialized;return o.xyflow||(o={...o,xyflow:!0}),{initialized:o,xyflow:t.instance,xystore:t.store}}),updateLayoutData:z(({context:e,event:t})=>{A(t,"update.layoutData");const{xynodes:o,xyedges:a,bounds:i}=sy(t.data);let r=e.initialized;return r.xydata||(r={...r,xydata:!0}),{initialized:r,xynodes:wn(e.xynodes,o),xyedges:qi(e.xyedges,a),bounds:oe(e.bounds,i)?e.bounds:i}}),"open relationship source":Oe(({system:e,event:t})=>{if(t.type!=="xyflow.edgeClick")return;const o=J(e).diagramActorRef,a=t.edge.data.relationId;a&&o.send({type:"open.source",relation:a})})},guards:{isReady:({context:e})=>e.initialized.xydata&&e.initialized.xyflow,"enable: navigate.to":()=>!0}}).createMachine({initial:"initializing",context:({input:e})=>({subject:gs(e),viewId:e.viewId,bounds:{x:0,y:0,width:200,height:200},initialized:{xydata:!1,xyflow:!1},xyflow:null,xystore:null,xynodes:[],xyedges:[]}),states:{initializing:{on:{"xyflow.init":{actions:"updateXYFlow",target:"isReady"},"update.layoutData":{actions:"updateLayoutData",target:"isReady"},close:{target:"closed"}}},isReady:{always:[{guard:"isReady",actions:[{type:"xyflow:fitDiagram",params:{duration:0}},ve({type:"xyflow.updateNodeInternals"},{delay:50})],target:"ready"},{target:"initializing"}]},ready:{on:{"xyflow.edgeMouseEnter":{actions:[z({xyedges:({context:e,event:t})=>{const o=e.xyedges.some(a=>a.data.dimmed===!0||a.data.dimmed==="immediate");return e.xyedges.map(a=>a.id===t.edge.id?G.setData(a,{hovered:!0,dimmed:!1}):o&&!a.selected?G.setDimmed(a,"immediate"):a)}}),tt("undim.edges"),tt("dim.nonhovered.edges"),ve({type:"dim.nonhovered.edges"},{id:"dim.nonhovered.edges",delay:100})]},"xyflow.edgeMouseLeave":{actions:[z({xyedges:({context:e,event:t})=>e.xyedges.map(o=>o.id===t.edge.id?G.setHovered(o,!1):o)}),tt("dim.nonhovered.edges"),ve({type:"undim.edges"},{id:"undim.edges",delay:400})]},"dim.nonhovered.edges":{actions:z({xyedges:({context:e})=>e.xyedges.map(t=>G.setDimmed(t,t.data.hovered!==!0))})},"undim.edges":{actions:z({xyedges:({context:e})=>e.xyedges.some(t=>t.selected===!0)?e.xyedges.map(t=>G.setDimmed(t,t.selected!==!0?t.data.dimmed||"immediate":!1)):e.xyedges.map(G.setDimmed(!1))})},"xyflow.selectionChange":{actions:Oe(({event:e,context:t,enqueue:o})=>{e.edges.length===0&&t.xyedges.some(a=>a.data.dimmed)&&!t.xyedges.some(a=>a.data.hovered)&&o.raise({type:"undim.edges"})})},"update.layoutData":{actions:["updateLayoutData",tt("fitDiagram"),ve({type:"fitDiagram",duration:0},{id:"fitDiagram",delay:50}),ve({type:"xyflow.updateNodeInternals"},{delay:75})]},"xyflow.init":{actions:"updateXYFlow"},"xyflow.applyNodeChanges":{actions:z({xynodes:({context:e,event:t})=>Ei(t.changes,e.xynodes)})},"xyflow.applyEdgeChanges":{actions:z({xyedges:({context:e,event:t})=>Ni(t.changes,e.xyedges)})},"xyflow.paneDblClick":{actions:"xyflow:fitDiagram"},"xyflow.edgeClick":{actions:"open relationship source"},"navigate.to":{actions:z({subject:({event:e})=>gs(e.params),viewId:({context:e,event:t})=>t.params.viewId??e.viewId})},close:{target:"closed"}},exit:z({xyedges:[],xynodes:[],initialized:{xydata:!1,xyflow:!1},xyflow:null,xystore:null})},closed:{type:"final"}},on:{fitDiagram:{actions:{type:"xyflow:fitDiagram",params:bt("event")}},"xyflow.resized":{actions:[tt("fitDiagram"),ve({type:"fitDiagram"},{id:"fitDiagram",delay:200})]},"xyflow.updateNodeInternals":{actions:"xyflow:updateNodeInternals"}}}),dy=ly,cy=Wn(({sendBack:e})=>{const t=fn([["Escape",o=>{o.stopPropagation(),e({type:"close"})},{preventDefault:!0}]]);return document.body.addEventListener("keydown",t,{capture:!0}),()=>{document.body.removeEventListener("keydown",t,{capture:!0})}}),Ye=rt({actors:{relationshipDetails:dy,elementDetails:ry,relationshipsBrowser:Od,hotkey:cy},guards:{"has overlays?":({context:e})=>e.overlays.length>0,"close specific overlay?":({context:e,event:t})=>(A(t,"close"),Ii(t.actorId)&&e.overlays.some(o=>o.id===t.actorId)),"last: is relationshipDetails?":({context:e})=>pt(e.overlays)?.type==="relationshipDetails","last: is relationshipsBrowser?":({context:e})=>pt(e.overlays)?.type==="relationshipsBrowser"}}),uy=()=>Ye.enqueueActions(({context:e,enqueue:t})=>{if(e.overlays.length===0)return;const o=pt(e.overlays)?.id;o&&(t.sendTo(o,{type:"close"}),t.stopChild(o),t.assign({overlays:e.overlays.filter(a=>a.id!==o)}))}),py=()=>Ye.enqueueActions(({context:e,enqueue:t,event:o})=>{A(o,"close");const a=o.actorId;if(!Ii(a))return;const i=e.overlays.find(r=>r.id===a)?.id;i&&(t.sendTo(i,{type:"close"}),t.stopChild(i),t.assign({overlays:e.overlays.filter(r=>r.id!==i)}))}),ms=()=>Ye.enqueueActions(({context:e,enqueue:t})=>{for(const{id:o}of cp(e.overlays))t.sendTo(o,{type:"close"}),t.stopChild(o);t.assign({overlays:[]})}),gy=()=>Ye.enqueueActions(({context:e,enqueue:t,event:o})=>{if(A(o,"open.elementDetails"),e.overlays.some(i=>i.type==="elementDetails"&&i.subject===o.subject))return;const a=`elementDetails-${e.seq}`;t.spawnChild("elementDetails",{id:a,input:o,syncSnapshot:!0}),t.assign({seq:e.seq+1,overlays:[...e.overlays,{id:a,type:"elementDetails",subject:o.subject}]})}),hy=()=>Ye.enqueueActions(({context:e,enqueue:t,event:o})=>{A(o,"open.relationshipDetails");const a=pt(e.overlays);if(a?.type==="relationshipDetails"){t.sendTo(a.id,{...o,type:"navigate.to"});return}const i=`relationshipDetails-${e.seq}`;t.spawnChild("relationshipDetails",{id:i,input:o,syncSnapshot:!0}),t.assign({seq:e.seq+1,overlays:[...e.overlays,{id:i,type:"relationshipDetails"}]})}),my=()=>Ye.enqueueActions(({context:e,enqueue:t,event:o})=>{A(o,"open.relationshipsBrowser");const a=pt(e.overlays);if(a?.type==="relationshipsBrowser"){t.sendTo(a.id,{type:"navigate.to",subject:o.subject,viewId:o.viewId});return}const i=`relationshipsBrowser-${e.seq}`;t.spawnChild("relationshipsBrowser",{id:i,input:o,syncSnapshot:!0}),t.assign({seq:e.seq+1,overlays:[...e.overlays,{id:i,type:"relationshipsBrowser",subject:o.subject}]})}),fs=()=>Ye.enqueueActions(({enqueue:e,event:t})=>{switch(console.log("openOverlay event",t),A(t,["open.elementDetails","open.relationshipDetails","open.relationshipsBrowser"]),t.type){case"open.elementDetails":e(gy());break;case"open.relationshipDetails":e(hy());break;case"open.relationshipsBrowser":e(my());break}}),fy=()=>Ye.spawnChild("hotkey",{id:"hotkey"}),ys=()=>Ye.stopChild("hotkey"),xs=()=>Ye.enqueueActions(({enqueue:e,context:t})=>{t.overlays.length===0&&(console.log("No overlays left, raising close event"),e.raise({type:"close"}))}),yy=Ye.createMachine({id:"overlays",context:()=>({seq:1,overlays:[]}),initial:"idle",states:{idle:{on:{"open.*":{actions:fs(),target:"active"}}},active:{entry:[fy()],exit:[ys()],on:{"open.*":{actions:fs()},close:[{guard:Du("has overlays?"),target:"idle"},{guard:"close specific overlay?",actions:[py(),xs()]},{actions:[uy(),xs()]}],"close.all":{actions:[ms()],target:"idle"}}},final:{entry:[ms(),ys()],type:"final"}}}),xy=yy,by=rt({actions:{"change searchValue":z({searchValue:({event:e,context:t})=>(A(e,["change.search","open"]),e.search??t.searchValue)}),"reset pickViewFor":z({pickViewFor:()=>null})}}).createMachine({id:"search",context:{openedWithSearch:null,searchValue:"",pickViewFor:null},initial:"inactive",on:{close:{target:".inactive",actions:"reset pickViewFor"}},states:{inactive:{on:{open:{target:"opened",actions:[z({openedWithSearch:({event:e})=>e.search??null,searchValue:({event:e,context:t})=>e.search??t.searchValue})]}}},opened:{on:{open:{actions:"change searchValue"},"change.search":{actions:"change searchValue"},"pickview.open":{target:"pickView",actions:z({pickViewFor:({event:e})=>e.elementFqn})}}},pickView:{on:{"pickview.close":{target:"opened",actions:"reset pickViewFor"}}}}}),wy=by,vy=Wn(({sendBack:e})=>{const t=fn([["Escape",a=>{a.stopPropagation(),e({type:"key.esc"})},{preventDefault:!0}]]),o=fn([["ArrowLeft",a=>{a.stopPropagation(),e({type:"key.arrow.left"})},{preventDefault:!0}],["ArrowUp",a=>{a.stopPropagation(),e({type:"key.arrow.up"})},{preventDefault:!0}],["ArrowRight",a=>{a.stopPropagation(),e({type:"key.arrow.right"})},{preventDefault:!0}],["ArrowDown",a=>{a.stopPropagation(),e({type:"key.arrow.down"})},{preventDefault:!0}]]);return document.body.addEventListener("keydown",t),document.body.addEventListener("keydown",o,{capture:!0}),()=>{document.body.removeEventListener("keydown",t),document.body.removeEventListener("keydown",o,{capture:!0})}}),ky=Wn(({sendBack:e})=>{const t=()=>{e({type:"media.print.on"})},o=()=>{e({type:"media.print.off"})};return window.addEventListener("beforeprint",t),window.addEventListener("afterprint",o),()=>{window.removeEventListener("beforeprint",t),window.removeEventListener("afterprint",o)}}),qn=e=>{let t=e.toggledFeatures;const o=ye(e.activeWalkthrough),a=e.features.enableCompareWithLatest&&(t.enableCompareWithLatest??!1)&&ye(e.view._layout)&&!o,i=e.features.enableReadOnly||(t.enableReadOnly??!1)||o||e.dynamicViewVariant==="sequence"&&e.view._type==="dynamic"||a&&e.view._layout==="auto";return{enableCompareWithLatest:a,enableReadOnly:i}},ya=e=>qn(e).enableReadOnly,M=rt({actors:{hotkeyActorLogic:vy,overlaysActorLogic:xy,searchActorLogic:wy,mediaPrintActorLogic:ky,editorActor:Vd},guards:{isReady:({context:e})=>e.initialized.xydata&&e.initialized.xyflow,"enabled: Editor":({context:e})=>e.features.enableEditor,"enabled: FitView":({context:e})=>e.features.enableFitView,"enabled: FocusMode":({context:e})=>e.features.enableFocusMode&&ya(e),"enabled: Readonly":({context:e})=>ya(e),"enabled: RelationshipDetails":({context:e})=>e.features.enableRelationshipDetails,"enabled: Search":({context:e})=>e.features.enableSearch,"enabled: ElementDetails":({context:e})=>e.features.enableElementDetails,"enabled: OpenSource":({context:e})=>e.features.enableVscode,"enabled: DynamicViewWalkthrough":({context:e})=>e.features.enableDynamicViewWalkthrough,"focus.node: autoUnfocus":({event:e})=>(A(e,"focus.node"),e.autoUnfocus===!0),"enabled: Overlays":({context:e})=>e.features.enableElementDetails||e.features.enableRelationshipBrowser||e.features.enableRelationshipDetails,"not readonly":({context:e})=>!ya(e),"is dynamic view":({context:e})=>e.view._type==="dynamic","is same view":({context:e,event:t})=>{if(A(t,["update.view","navigate.to"]),t.type==="update.view")return e.view.id===t.view.id;if(t.type==="navigate.to")return e.view.id===t.viewId;Le(t.type)},"is another view":({context:e,event:t})=>{if(A(t,["update.view","navigate.to"]),t.type==="update.view")return e.view.id!==t.view.id;if(t.type==="navigate.to")return e.view.id!==t.viewId;Le(t.type)},"click: node has modelFqn":({event:e})=>(A(e,"xyflow.nodeClick"),"modelFqn"in e.node.data),"click: selected node":({event:e})=>(A(e,"xyflow.nodeClick"),e.node.selected===!0),"click: same node":({context:e,event:t})=>(A(t,"xyflow.nodeClick"),e.lastClickedNode?.id===t.node.id),"click: focused node":({context:e,event:t})=>(A(t,"xyflow.nodeClick"),e.focusedNode===t.node.id),"click: node has connections":({context:e,event:t})=>(A(t,"xyflow.nodeClick"),e.xyedges.some(o=>o.source===t.node.id||o.target===t.node.id)),"click: selected edge":({event:e})=>(A(e,["xyflow.edgeClick","xyflow.edgeDoubleClick"]),e.edge.selected===!0||e.edge.data.active===!0)}}),le={idle:"#idle",focused:"#focused",walkthrough:"#walkthrough",printing:"#printing",navigating:"#navigating"},jy=({context:e})=>{const t=e.view.drifts??null;if(!e.features.enableCompareWithLatest||!t||t.length===0)return{hasEditor:!1,isEnabled:!1,isEditable:!1,isActive:!1,drifts:[],canApplyLatest:!1,layout:e.view._layout??"auto"};const{enableCompareWithLatest:o,enableReadOnly:a}=qn(e);return{hasEditor:e.features.enableEditor,isEnabled:!0,isEditable:!a,isActive:o===!0,drifts:t,canApplyLatest:!t.includes("type-changed"),layout:e.view._layout??"auto"}};function nr(){const e=oo(),t=re(e,jy,oe),o=D(s=>{if(!t.isEnabled){console.warn("Compare with latest feature is not enabled");return}e.send({type:"emit.onLayoutTypeChange",layoutType:s})}),a=D(s=>{if(!t.isEnabled){console.warn("Compare with latest feature is not enabled");return}const l=s?s==="on":!t.isActive;t.isActive&&!l&&t.layout==="auto"&&o("manual"),e.send({type:"toggle.feature",feature:"CompareWithLatest",forceValue:l})}),i=D(()=>{if(!t.isEnabled){console.warn("Compare with latest feature is not enabled");return}e.send({type:"layout.resetManualLayout"})}),r=D(()=>{if(!t.isEnabled){console.warn("Compare with latest feature is not enabled");return}W(e.system?.get("editor"),"editor actor not found").send({type:"applyLatestToManual"}),t.isActive&&e.send({type:"toggle.feature",feature:"CompareWithLatest",forceValue:!1})});return[t,{toggleCompare:a,switchLayout:o,resetManualLayout:i,applyLatestToManual:r}]}const Ve=(e,t,o)=>{const a=i=>({[e]:"__ignore__",...t,...It(i)});return{recipeFn:(i,r=!0)=>{const s=ed({conditions:{shift:ad,finalize:nd,breakpoints:{keys:["base","xs","sm","md","lg","xl"]}},utility:{toHash:(d,u)=>u(d.join(":")),transform:(d,u)=>(Ag(e,o,i,d),u==="__ignore__"?{className:e}:(u=Bi(u),{className:`${e}--${d}_${u}`}))}}),l=a(i);if(r){const d=Qa(o,l);return P(s(l),x(d))}return s(l)},getVariantProps:a,__getCompoundVariantCss__:i=>Qa(o,a(i))}},Qe=(e,t)=>{if(e&&!t)return e;if(!e&&t)return t;const o=(...r)=>P(e(...r),t(...r)),a=Ua(e.variantKeys,t.variantKeys),i=a.reduce((r,s)=>(r[s]=Ua(e.variantMap[s],t.variantMap[s]),r),{});return Object.assign(o,{__recipe__:!0,__name__:`${e.__name__} ${t.__name__}`,raw:r=>r,variantKeys:a,variantMap:i,splitVariantProps(r){return fe(r,a)}})},xa=Ve("action-btn",{size:"md",radius:"md",variant:"filled"},[]),Hd={variant:["transparent","filled"],size:["sm","md"],radius:["sm","md"]},bs=Object.keys(Hd),Yn=Object.assign(be(xa.recipeFn),{__recipe__:!0,__name__:"actionBtn",__getCompoundVariantCss__:xa.__getCompoundVariantCss__,raw:e=>e,variantKeys:bs,variantMap:Hd,merge(e){return Qe(this,e)},splitVariantProps(e){return fe(e,bs)},getVariantProps:xa.getVariantProps}),ba=Ve("likec4-compound-node",{},[]),Xd={isTransparent:["false","true"],inverseColor:["true","false"],borderStyle:["solid","dashed","dotted","none"]},ws=Object.keys(Xd),Cy=Object.assign(be(ba.recipeFn),{__recipe__:!0,__name__:"compoundNode",__getCompoundVariantCss__:ba.__getCompoundVariantCss__,raw:e=>e,variantKeys:ws,variantMap:Xd,merge(e){return Qe(this,e)},splitVariantProps(e){return fe(e,ws)},getVariantProps:ba.getVariantProps}),wa=Ve("likec4-edge-action-btn",{},[]),qd={},vs=Object.keys(qd),Sy=Object.assign(be(wa.recipeFn),{__recipe__:!0,__name__:"edgeActionBtn",__getCompoundVariantCss__:wa.__getCompoundVariantCss__,raw:e=>e,variantKeys:vs,variantMap:qd,merge(e){return Qe(this,e)},splitVariantProps(e){return fe(e,vs)},getVariantProps:wa.getVariantProps}),va=Ve("likec4-edge-label",{pointerEvents:"all",isStepEdge:!1,cursor:"default"},[]),Yd={pointerEvents:["none","all"],cursor:["pointer","default"],isStepEdge:["false","true"]},ks=Object.keys(Yd),_y=Object.assign(be(va.recipeFn),{__recipe__:!0,__name__:"edgeLabel",__getCompoundVariantCss__:va.__getCompoundVariantCss__,raw:e=>e,variantKeys:ks,variantMap:Yd,merge(e){return Qe(this,e)},splitVariantProps(e){return fe(e,ks)},getVariantProps:va.getVariantProps}),Gd={},Py=[],My=[["path","likec4-edge__path"],["pathBg","likec4-edge__pathBg"],["markersCtx","likec4-edge__markersCtx"],["middlePoint","likec4-edge__middlePoint"]],Ny=My.map(([e,t])=>[e,Ve(t,Gd,Ai(Py,e))]),Ey=be((e={})=>Object.fromEntries(Ny.map(([t,o])=>[t,o.recipeFn(e)]))),js=[],Iy=e=>({...Gd,...It(e)}),Ry=Object.assign(Ey,{__recipe__:!1,__name__:"edgePath",raw:e=>e,classNameMap:{},variantKeys:js,variantMap:{},splitVariantProps(e){return fe(e,js)},getVariantProps:Iy}),ka=Ve("likec4-element-node-data",{},[]),Zd={},Cs=Object.keys(Zd),Dy=Object.assign(be(ka.recipeFn),{__recipe__:!0,__name__:"elementNodeData",__getCompoundVariantCss__:ka.__getCompoundVariantCss__,raw:e=>e,variantKeys:Cs,variantMap:Zd,merge(e){return Qe(this,e)},splitVariantProps(e){return fe(e,Cs)},getVariantProps:ka.getVariantProps}),ja=Ve("likec4-element-shape",{},[]),Ud={shapetype:["html","svg"]},Ss=Object.keys(Ud),Kd=Object.assign(be(ja.recipeFn),{__recipe__:!0,__name__:"elementShapeRecipe",__getCompoundVariantCss__:ja.__getCompoundVariantCss__,raw:e=>e,variantKeys:Ss,variantMap:Ud,merge(e){return Qe(this,e)},splitVariantProps(e){return fe(e,Ss)},getVariantProps:ja.getVariantProps}),Ca=Ve("likec4-tag",{autoTextColor:!1},[]),Qd={autoTextColor:["false","true"]},_s=Object.keys(Qd),By=Object.assign(be(Ca.recipeFn),{__recipe__:!0,__name__:"likec4tag",__getCompoundVariantCss__:Ca.__getCompoundVariantCss__,raw:e=>e,variantKeys:_s,variantMap:Qd,merge(e){return Qe(this,e)},splitVariantProps(e){return fe(e,_s)},getVariantProps:Ca.getVariantProps}),Sa=Ve("likec4-markdown-block",{uselikec4palette:!1,value:"markdown"},[]),Jd={uselikec4palette:["true","false"],value:["markdown","plaintext"]},Ps=Object.keys(Jd),Ly=Object.assign(be(Sa.recipeFn),{__recipe__:!0,__name__:"markdownBlock",__getCompoundVariantCss__:Sa.__getCompoundVariantCss__,raw:e=>e,variantKeys:Ps,variantMap:Jd,merge(e){return Qe(this,e)},splitVariantProps(e){return fe(e,Ps)},getVariantProps:Sa.getVariantProps}),_a=Ve("likec4-navigation-panel-icon",{variant:"default",type:"default"},[{type:"warning",variant:"filled",css:{backgroundColor:{base:"likec4.panel.action.warning.bg",_hover:"likec4.panel.action.warning.bg.hover"}}}]),ec={variant:["default","filled"],type:["default","warning"]},Ms=Object.keys(ec),tc=Object.assign(be(_a.recipeFn),{__recipe__:!0,__name__:"navigationPanelActionIcon",__getCompoundVariantCss__:_a.__getCompoundVariantCss__,raw:e=>e,variantKeys:Ms,variantMap:ec,merge(e){return Qe(this,e)},splitVariantProps(e){return fe(e,Ms)},getVariantProps:_a.getVariantProps}),Pa=Ve("likec4-overlay",{fullscreen:!1,withBackdrop:!0},[]),oc={fullscreen:["false","true"],withBackdrop:["false","true"]},Ns=Object.keys(oc),Ty=Object.assign(be(Pa.recipeFn),{__recipe__:!0,__name__:"overlay",__getCompoundVariantCss__:Pa.__getCompoundVariantCss__,raw:e=>e,variantKeys:Ns,variantMap:oc,merge(e){return Qe(this,e)},splitVariantProps(e){return fe(e,Ns)},getVariantProps:Pa.getVariantProps}),nc={truncateLabel:!1},Ay=[],zy=[["root","likec4-navlink__root"],["body","likec4-navlink__body"],["section","likec4-navlink__section"],["label","likec4-navlink__label"],["description","likec4-navlink__description"]],$y=zy.map(([e,t])=>[e,Ve(t,nc,Ai(Ay,e))]),Vy=be((e={})=>Object.fromEntries($y.map(([t,o])=>[t,o.recipeFn(e)]))),Es=["truncateLabel"],Fy=e=>({...nc,...It(e)}),Wy=Object.assign(Vy,{__recipe__:!1,__name__:"navigationLink",raw:e=>e,classNameMap:{},variantKeys:Es,variantMap:{truncateLabel:["true","false"]},splitVariantProps(e){return fe(e,Es)},getVariantProps:Fy}),ac=je.withProps({color:"dark",fz:"xs",openDelay:600,closeDelay:120,label:"",children:null,offset:8,withinPortal:!1}),ic=()=>n.jsx(Xe,{component:ee,variant:"transparent",size:16,className:x({display:{base:"none","@/md":"flex"},color:{base:"mantine.colors.gray[5]",_dark:"mantine.colors.dark[3]"}}),children:n.jsx(gt,{})});jl.withProps({separator:n.jsx(ic,{}),separatorMargin:4});const at=h.forwardRef(({variant:e="default",className:t,disabled:o=!1,type:a,...i},r)=>n.jsx(Q,{size:"md",variant:"transparent",radius:"sm",component:Te,...!o&&{whileHover:{scale:1.085},whileTap:{scale:1,translateY:1}},disabled:o,...i,className:P(t,tc({variant:e,type:a})),ref:r}));function Oy({disabled:e=!1,onApplyLatestToManual:t,onResetManualLayout:o}){return n.jsxs(Fe,{withinPortal:!1,floatingStrategy:"absolute",shadow:"lg",position:"bottom-start",offset:{mainAxis:4},disabled:e,children:[n.jsx(Fe.Target,{children:n.jsxs(de,{disabled:e,className:P("mantine-active",me({gap:"2",py:"1.5",px:"2",lineHeight:"1",textStyle:"xs",fontWeight:"medium",layerStyle:"likec4.panel.action",userSelect:"none"})),children:[n.jsx(U,{children:"Actions"}),n.jsx(zi,{size:12,stroke:2,opacity:.7})]})}),n.jsxs(Fe.Dropdown,{children:[n.jsxs(Fe.Item,{disabled:!t,onClick:t,rightSection:t&&n.jsx(je,{onClick:ae,position:"right-start",label:n.jsxs(n.Fragment,{children:["Applies changes from the latest auto-layouted",n.jsx("br",{}),"to saved snapshot, preserving (as possible)",n.jsx("br",{}),"manual adjustments.",n.jsx("br",{}),n.jsx("br",{}),"You can undo this action."]}),children:n.jsx(Po,{size:14,stroke:1.7,opacity:.5})}),children:["Sync with latest",!t&&n.jsx(U,{textStyle:"xs",children:"view type is changed"})]}),n.jsx(Fe.Item,{onClick:o,children:"Remove manual layout"})]})]})}function Hy({value:e,onChange:t}){const o=h.useMemo(()=>[{value:"manual",label:"Saved manual"},{value:"auto",label:"Latest auto"}],[]);return n.jsx(ee,{layout:"position",children:n.jsx(Rn,{size:"xs",color:e==="manual"?"orange":"green",value:e,component:ee,onChange:a=>{O(a==="manual"||a==="auto","Invalid layout type"),t(a)},classNames:{label:x({fontSize:"xxs",fontWeight:"medium"})},data:o})})}const Is=ko.withProps({mx:2,size:"xs",orientation:"vertical"});function Xy(){const[e,{toggleCompare:t,switchLayout:o,resetManualLayout:a,applyLatestToManual:i}]=nr();return n.jsxs(n.Fragment,{children:[n.jsx(U,{css:{textStyle:"xs",color:"likec4.panel.text",userSelect:"none"},children:"Compare"}),n.jsx(Hy,{value:e.layout,onChange:o}),e.hasEditor&&n.jsxs(te,{gap:"1",children:[n.jsx(Is,{}),n.jsx(Oy,{disabled:e.layout==="auto",onResetManualLayout:a,onApplyLatestToManual:e.canApplyLatest?i:void 0}),n.jsx(Is,{})]}),n.jsx(at,{size:"sm",onClick:r=>{r.stopPropagation(),t()},children:n.jsx(eo,{})})]})}const rc=h.memo(()=>{const{enableCompareWithLatest:e}=Z();return n.jsx(he,{children:e&&n.jsx(ee,{layout:"position",className:me({gap:"2",layerStyle:"likec4.panel",position:"relative",px:"2",py:"1",pl:"3",pointerEvents:"all"}),initial:{opacity:0,translateX:-20},animate:{opacity:1,translateX:0},exit:{opacity:0,translateX:-20},children:n.jsx(Xy,{})})})});rc.displayName="ComparePanel";const Eo=je.withProps({color:"dark",fz:"xs",openDelay:600,closeDelay:120,label:"",children:null,offset:8,position:"right"}),qy=()=>{const e=H();return n.jsx(Eo,{label:"Center camera",children:n.jsx(at,{onClick:()=>e.fitDiagram(),children:n.jsx(dh,{})})})};x({gap:"xxs",_empty:{display:"none"}});x({top:"md",left:"md",margin:"0",pointerEvents:"none","& :where(button, .action-icon, [role='dialog'])":{pointerEvents:"all"},"& .action-icon":{"--ai-size":"2rem"},"& .tabler-icon":{width:"65%",height:"65%"},_reduceGraphics:{"& .action-icon":{"--ai-radius":"0px"}}});x({shadow:{base:"md",_whenPanning:"none"}});x({"& .tabler-icon":{width:"65%",height:"65%"}});const Yo=x({flex:"1 1 40%",textAlign:"center",fontWeight:500,padding:"[4px 6px]",fontSize:"11px",zIndex:1}),Yy=x({background:"mantine.colors.gray[2]",borderRadius:"sm",border:"1px solid",borderColor:"mantine.colors.gray[4]",_dark:{background:"mantine.colors.dark[5]",borderColor:"mantine.colors.dark[4]"}}),Gy=x({position:"relative",borderRadius:"sm",background:"mantine.colors.gray[3]",boxShadow:"inset 1px 1px 3px 0px #00000024",_dark:{background:"mantine.colors.dark[7]"}}),Zy=x({position:"absolute",width:8,height:8,border:"2px solid",borderColor:"mantine.colors.gray[5]",borderRadius:3,transform:"translate(-50%, -50%)"}),Uy=e=>({viewId:e.view.id,isManualLayout:e.view._layout==="manual",autoLayout:e.view.autoLayout}),Ky=()=>{const e=H(),[t,o]=h.useState(null),[a,i]=h.useState({}),{autoLayout:r,viewId:s,isManualLayout:l}=ze(Uy),{ref:d,hovered:u}=Xa(),c=m=>y=>{a[m]=y,i(a)},p=m=>y=>{y.stopPropagation(),e.fitDiagram(),e.triggerChange({op:"change-autolayout",layout:{...r,direction:m}})},g=(m,y)=>{e.fitDiagram(),e.triggerChange({op:"change-autolayout",layout:{...r,nodeSep:m,rankSep:y}})};return l?null:n.jsxs(st,{position:"right-start",clickOutsideEvents:["pointerdown"],radius:"xs",shadow:"lg",offset:{mainAxis:10},children:[n.jsx(Ut,{children:n.jsx(Eo,{label:"Change Auto Layout",children:n.jsx(at,{children:n.jsx(Ih,{})})})}),n.jsx(Kt,{className:"likec4-top-left-panel",p:8,pt:6,opacity:u?.6:1,children:n.jsxs(q,{pos:"relative",ref:o,children:[n.jsx(wp,{target:a[r.direction],parent:t,className:Yy}),n.jsx(q,{mb:10,children:n.jsx(L,{inline:!0,fz:"xs",c:"dimmed",fw:500,children:"Auto layout:"})}),n.jsxs(Pt,{gap:2,wrap:"wrap",justify:"stretch",maw:160,children:[n.jsx(de,{className:Yo,ref:c("TB"),onClick:p("TB"),children:"Top-Bottom"}),n.jsx(de,{className:Yo,ref:c("BT"),onClick:p("BT"),children:"Bottom-Top"}),n.jsx(de,{className:Yo,ref:c("LR"),onClick:p("LR"),children:"Left-Right"}),n.jsx(de,{className:Yo,ref:c("RL"),onClick:p("RL"),children:"Right-Left"})]}),n.jsx(q,{my:10,children:n.jsx(L,{inline:!0,fz:"xs",c:"dimmed",fw:500,children:"Spacing:"})}),n.jsx(Qy,{ref:d,isVertical:r.direction==="TB"||r.direction==="BT",nodeSep:r.nodeSep,rankSep:r.rankSep,onChange:g},s)]})})]})},Bt=400,Qy=h.forwardRef(({isVertical:e,nodeSep:t,rankSep:o,onChange:a},i)=>{e||([t,o]=[o,t]);const r=ki(({x:g,y:m})=>{e||([g,m]=[m,g]),a(Math.round(g*Bt),Math.round(m*Bt))},[a,e],250,2e3),[s,l]=Cl({defaultValue:Bu({x:(t??100)/Bt,y:(o??120)/Bt}),onChange:r}),{ref:d}=Lu(l);let u=Math.round(s.x*Bt),c=Math.round(s.y*Bt);e||([u,c]=[c,u]);const p=ji(d,i);return n.jsxs(q,{ref:p,className:Gy,pt:"100%",children:[n.jsx(q,{className:Zy,style:{left:`${s.x*100}%`,top:`${s.y*100}%`}}),n.jsx(q,{pos:"absolute",left:2,bottom:2,children:n.jsxs(L,{component:"div",fz:8,c:"dimmed",fw:500,children:[c,", ",u]})})]})}),Je=({label:e,icon:t,onClick:o})=>n.jsx(Eo,{label:e,withinPortal:!1,position:"top",children:n.jsx(at,{classNames:{root:"action-icon",icon:x({"& > svg":{width:"70%",height:"70%"}})},onClick:o,children:t})}),sc=h.memo(()=>{const e=H(),t=no();return n.jsxs(st,{position:"right",offset:{mainAxis:12},clickOutsideEvents:["pointerdown"],...t,children:[n.jsx(Ut,{children:n.jsx(Eo,{label:"Manual layouting tools",children:n.jsx(at,{children:n.jsx(Nh,{})})})}),n.jsx(Kt,{className:me({gap:"0.5",layerStyle:"likec4.panel",padding:"1",pointerEvents:"all"}),children:n.jsxs(In,{children:[n.jsx(Je,{label:"Align in columns",icon:n.jsx(Gr,{}),onClick:o=>{o.stopPropagation(),e.align("Column")}}),n.jsx(Je,{label:"Align left",icon:n.jsx(wh,{}),onClick:o=>{o.stopPropagation(),e.align("Left")}}),n.jsx(Je,{label:"Align center",icon:n.jsx(xh,{}),onClick:o=>{o.stopPropagation(),e.align("Center")}}),n.jsx(Je,{label:"Align right",icon:n.jsx(Ch,{}),onClick:o=>{o.stopPropagation(),e.align("Right")}}),n.jsx(Je,{label:"Align in rows",icon:n.jsx(Gr,{style:{transform:"rotate(90deg)"}}),onClick:o=>{o.stopPropagation(),e.align("Row")}}),n.jsx(Je,{label:"Align top",icon:n.jsx(_h,{}),onClick:o=>{o.stopPropagation(),e.align("Top")}}),n.jsx(Je,{label:"Align middle",icon:n.jsx(kh,{}),onClick:o=>{o.stopPropagation(),e.align("Middle")}}),n.jsx(Je,{label:"Align bottom",icon:n.jsx(fh,{}),onClick:o=>{o.stopPropagation(),e.align("Bottom")}}),n.jsx(Je,{label:"Reset all control points",icon:n.jsx(Oh,{}),onClick:o=>{o.stopPropagation(),e.resetEdgeControlPoints()}})]})})]})});sc.displayName="ManualLayoutToolsButton";const Jy=()=>{const e=H();return n.jsx(Eo,{label:"Switch to Read-only",children:n.jsx(at,{onClick:()=>e.toggleFeature("ReadOnly"),children:n.jsx(pd,{size:14,stroke:2})})})};function ex(){const{enableReadOnly:e}=Z();return n.jsx(he,{children:!e&&n.jsx(ee,{layout:"position",className:No({gap:"xs",layerStyle:"likec4.panel",position:"relative",cursor:"pointer",padding:"xxs",pointerEvents:"all"}),initial:{opacity:0,translateX:-20},animate:{opacity:1,translateX:0},exit:{opacity:0,translateX:-20},children:n.jsxs(In,{openDelay:600,closeDelay:120,children:[n.jsx(Ky,{}),n.jsx(sc,{}),n.jsx(qy,{}),n.jsx(Jy,{})]})})})}const ar=h.createContext(null);ar.displayName="NavigationPanelActorSafeContext";const tx=ar.Provider,ir=()=>{const e=h.useContext(ar);if(e===null)throw new Error("NavigationPanelActorRef is not found in the context");return e};function rr(e,t=oe){const o=ir();return re(o,e,t)}function ox(e,t=oe){return rr(o=>e(o.context),t)}function Io(){const e=ir();return h.useMemo(()=>({actorRef:e,send:t=>e.send(t),selectFolder:t=>e.send({type:"select.folder",folderPath:t}),selectView:t=>e.send({type:"select.view",viewId:t}),isOpened:()=>e.getSnapshot().hasTag("active"),clearSearch:()=>e.send({type:"searchQuery.change",value:""}),closeDropdown:()=>e.send({type:"dropdown.dismiss"})}),[e])}const nx=h.forwardRef((e,t)=>n.jsxs("svg",{ref:t,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 222 56",...e,children:[n.jsx("path",{fill:"#5E98AF",d:"M33.95 33.78V0H2.37A2.37 2.37 0 0 0 0 2.35V33.9h33.95v-.12ZM38.57 33.78H55.6v-14.6c0-1.3-1.06-2.35-2.36-2.35H38.57v16.95ZM33.95 38.37H17.04v14.6c0 1.29 1.06 2.35 2.36 2.35h14.67V38.37h-.12ZM38.57 38.37v16.95h14.67c1.3 0 2.36-1.06 2.36-2.36v-14.6H38.57Z"}),n.jsx("path",{className:x({fill:"[#FCFBF7]",_light:{fill:"[#222221]"}}),d:"M71.61 12.08c-.06 3.61.3 29.95.23 31.87 0 1.8 0 3.6.06 5.41 0 .3.18.58.47.58 4.1.18 8.13-.17 12.22-.11 1.34.05 2.69 0 3.97 0 1.29-.06 1.4-.59 1.35-1.63-.06-1.63-.06-3.08-.06-4.65-.06-.82-.53-1.11-1.23-1.11-2.4.06-4.8-.06-7.19.06-.4.06-.82.06-1.23.06-.7-.06-.87-.24-.93-1v-.86c-.18-4.83.17-9.83.17-14.66-.06-4.07 0-7.73-.06-11.34 0-1.57 0-3.14-.05-4.65-.06-.93 0-1.92-.24-2.85-.11-.35-.29-.81-.7-.81h-5.5c-.93 0-1.22.64-1.28 1.57v4.12ZM103.81 35c-.17-6.63-.1-13.67-.05-20.24 0-2.04-.12-4.25-.12-6.28 0-2.21-.87-2.1-2.04-2.15-1.7-.06-2.46-.06-4.15-.06-1.11-.06-1.58.23-1.58 1.34 0 5.7-.18 21.8-.12 24.13.06 2.33.3 12.91.18 15.24-.06.81 0 1.62.06 2.44.05.29.23.58.7.58 1.93-.12 3.74-.12 5.67-.17.7-.06 1.28-.24 1.58-1 .05-.4-.12-11.04-.12-13.83Zm13.92 4.47c0-2.03-.3-7.56-.23-8.72 0-.17.11-.4.17-.4.12 0 .35.11.41.17 1.87 2.44 10.64 19.36 11.7 19.42.28.06.58.06.87.06 1.99-.12 3.74 0 5.73 0 2.04 0 .7-1.98.35-2.5-.53-.76-7.48-13.14-7.9-13.9-1.16-1.98-2.16-4.13-3.32-6.05-.12-.23-.24-.58-.18-.81.12-.7.3-1.34.59-1.98a93.18 93.18 0 0 1 4.55-8.14c1.88-2.97 2.93-4.83 4.45-7.5.35-.64.58-1.34.82-2.1.05-.29-.18-.58-.53-.58-1.11-.05-5.15 0-6.43 0-.59 0-1.17.12-1.46.64-.76 1.46-8.6 15.7-9.35 16.98-.06.12-.24.18-.41.18 0 0-.12-.18-.12-.3-.06-3.25.53-13.9.4-16.04-.05-1.28-.28-1.4-1.57-1.46-1.4-.05-3.33-.05-4.73-.05-1.3 0-1.4.7-1.58 1.62-.06.18-.06 5.64-.06 8.09 0 3.54-.3 25.76.11 32.8 0 .7.18 1.1.77 1.1 1.57-.12 3.91 0 5.49 0 1.11 0 1.29-.12 1.29-1.98 0-2.5.23-4.77.23-7.85 0-.23-.06-.46-.06-.7Zm25.66-1.4h-.06c0 1.46-.05 2.97 0 4.49.06 1.86.18 3.72.3 5.58 0 .64.17.81.76.93 1.22.29 2.4.35 3.62.35 3.16-.12 6.31.11 9.47 0 1.29-.06 1.87.06 3.16-.18 1.17-.23 1.58-.87 1.58-2.61-.12-1.1-.06-1.57-.06-2.91 0-1.92-1.35-2.56-2.52-2.5-.81.06-4.73-.06-6.31-.06-2.63.06-2.22.4-2.22-2.33 0-2.2.06-5.05.06-7.32 0-1.22.11-1.63 1.28-1.63h7.31c1.17.17 1.99-.64 1.99-1.86 0-1.22.12-1.28.12-2.5l-.18-1.75c-.12-.99-.47-1.33-1.46-1.33-.64 0-1.29.05-1.93.11-2.52.18-3.68-.17-6.14 0-.82 0-.93-.11-1-.87-.23-2.27 0-4.77.24-7.04.06-.93.3-1.1 1.17-1.16l8.24-.06c1.11-.11 1.46-.06 1.4-1.16-.11-1.69.06-3.43-.11-5.12-.12-.93-.41-1.1-1.46-1.1-1.76.05-2.17.05-3.92.17-1.75.06-8.77.06-10.46.06-2.46 0-2.63-.18-2.7 2.8-.1 2.32-.05 4.7-.05 7.09 0 4.07-.23 18.66-.12 21.92Zm47.76-24.82c.06-1.92 0-3.5 0-5.35 0-2.15-3.92-1.92-5.32-1.86a18.95 18.95 0 0 0-15.08 9.77c-.82 1.57-1.4 3.2-1.81 4.88a34 34 0 0 0-.59 12.15c.41 3.78 1.4 7.56 3.74 10.59 4.04 5.3 11.46 7.15 17.83 6.16.3-.06.59-.11.82-.29.18-.11.35-.35.35-.58l.18-3.31c.06-1.05 0-1 0-2.04 0-1.4-2.93-.35-4.74-.35-1.75 0-3.62-.06-5.2-.87-2.8-1.57-4.38-4.71-5.26-7.68-1-3.2-1.23-6.63-.64-9.88.7-4.25 2.74-9.13 7.25-10.59 2.57-.87 5.31-.58 7.89-.29.35.06.58-.17.58-.46Zm26.77 15.3c.06-2.5 0-14.84 0-18.38.06-.82 0-1.63-.11-2.45-.06-.99-.24-1.28-1.29-1.33h-4.44c-.82 0-1.35.4-1.82 1.27-1.34 3.2-10.75 24.02-12.15 26.58-.53.99-1 1.63-1 2.68v4.24c0 .76-.06 1.28 1.23 1.28l11.1-.06c1.47 0 1.47.3 1.47 1.1 0 .88-.12 4.9-.12 5.3 0 .58.12 1.16 1.23 1.16h5.08c1.23 0 1.23-.7 1.23-2.03.06-1.17-.06-3.5-.06-4.66 0-.93.18-.98 1.76-.98 1.22 0 1.75-.12 1.75-.88.06-1.57 0-2.67 0-4.42 0-1.04-.93-.98-2.92-.98-.65 0-.7-.18-.7-1.05-.12-1.8-.24-4.6-.24-6.4Zm-7.25-5.94c-.05.7-.11 10.82-.11 12.27-.06.81-.24 1.05-1 1.1-1.93.06-3.85.06-5.78.06-.47 0-.65-.4-.41-.87.23-.4 4.85-11.57 6.13-14.48.18-.17.24-.35.41-.52.18-.12.41-.18.59-.23.06 0 .23.29.23.46 0 .76-.06 1.51-.06 2.21Z"})]})),ax=h.forwardRef((e,t)=>n.jsx("svg",{ref:t,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 56 56",...e,children:n.jsx("path",{fill:"#5E98AF",d:"M33.95 33.78V0H2.37A2.37 2.37 0 0 0 0 2.35V33.9h33.95v-.12ZM38.57 33.78H55.6v-14.6c0-1.3-1.06-2.35-2.36-2.35H38.57v16.95ZM33.95 38.37H17.04v14.6c0 1.29 1.06 2.35 2.36 2.35h14.67V38.37h-.12ZM38.57 38.37v16.95h14.67c1.3 0 2.36-1.06 2.36-2.36v-14.6H38.57Z"})})),ix=()=>{const e=Io(),{onBurgerMenuClick:t}=to();return n.jsx(ee,{layout:"position",children:n.jsxs(de,{onMouseEnter:()=>{e.send({type:"breadcrumbs.mouseEnter.root"})},onMouseLeave:()=>{e.send({type:"breadcrumbs.mouseLeave.root"})},onClick:o=>{o.stopPropagation(),t&&e.isOpened()&&setTimeout(()=>{t()},100),e.send({type:"breadcrumbs.click.root"})},className:P("mantine-active",me({padding:"0.5",width:{base:"[20px]","@/md":"[64px]"}})),children:[n.jsx(nx,{className:x({display:{base:"none","@/md":"block"}})}),n.jsx(ax,{className:x({display:{base:"block","@/md":"none"}})})]})})},lc=_o({base:{transitionDuration:"normal"},variants:{delay:{true:{transitionDelay:{base:"0.2s",_hover:"0s"}}}}});function rx({data:{hovered:e=!1},icon:t,onClick:o}){const a=Ri(e,e?130:0)[0]&&e;return n.jsx(ee,{initial:!1,animate:{scale:a?1.2:1,x:a?-1:0,y:a?-1:0},whileHover:{scale:1.4,x:-3,y:-1},className:"likec4-compound-navigation compound-action",whileTap:{scale:1},onClick:ae,children:n.jsx(Q,{className:P("nodrag nopan",lc({delay:e&&!a}),Yn({variant:"transparent"})),onClick:o,onDoubleClick:ae,children:t??n.jsx($e,{stroke:2})})})}function dc({data:{hovered:e=!1},icon:t,onClick:o}){const a=Ri(e,e?130:0)[0]&&e;return n.jsx(ee,{initial:!1,animate:{scale:a?1.2:1},whileHover:{scale:1.4},whileTap:{scale:1},className:"likec4-compound-details details-button",children:n.jsx(Q,{className:P("nodrag nopan",lc({delay:e&&!a}),Yn({variant:"transparent"})),onClick:o,onDoubleClick:ae,children:t??n.jsx($i,{stroke:1.8,style:{width:"75%"}})})})}function Ro({nodeProps:{data:{hovered:e=!1,dimmed:t=!1,...o}},className:a,children:i,style:r,...s}){let l=De(o.style.opacity??100,{min:0,max:100});const d=l<99,u=65,c=u+De((100-u)*(l/100),{min:0,max:100-u}),p=Cy({isTransparent:d,inverseColor:l<60,borderStyle:o.style.border??(d?"dashed":"none")}),g=De(o.depth??1,{min:1,max:5});return n.jsx(ee,{className:P(p,a),initial:!1,"data-likec4-hovered":e,"data-likec4-color":o.color,"data-compound-depth":g,...t!==!1&&{"data-likec4-dimmed":t},style:{...r,"--_border-transparency":`${c}%`,"--_compound-transparency":`${l}%`},...s,children:i})}function Do({data:e}){const t=On({element:e,className:"likec4-compound-icon"});return n.jsxs("div",{className:"likec4-compound-title-container",children:[t,n.jsx(L,{component:"h3",className:"likec4-compound-title",truncate:"end",children:e.title})]})}function Gn({icon:e,onClick:t}){return n.jsx(Q,{className:P("nodrag nopan",Sy()),onPointerDownCapture:ae,onClick:t,role:"button",onDoubleClick:ae,children:e??n.jsx($e,{})})}function Bo({className:e,component:t="g",selectable:o=!1,selected:a=!1,data:{color:i="gray",hovered:r=!1,active:s=!1,dimmed:l=!1,...d},animated:u,children:c,style:p}){const g={className:P(e,"likec4-edge-container",a&&"selected",o&&"selectable"),"data-likec4-color":i,"data-edge-dir":d.dir??"forward","data-edge-active":s,"data-edge-animated":u||s,"data-likec4-hovered":r,...a&&{"data-likec4-selected":a},...l!==!1&&{"data-likec4-dimmed":l}};return t==="svg"?n.jsx("svg",{style:p,...g,children:c}):(O(t==="g",'EdgeContainer: component must be "g" or "svg"'),n.jsx("g",{style:p,...g,children:c}))}const Lo=h.forwardRef(({edgeProps:{id:e,data:{label:t,technology:o,hovered:a=!1},selected:i=!1,selectable:r=!1},pointerEvents:s="all",className:l,style:d,children:u,...c},p)=>{const g=hl(e)?vu(e):null,m=ye(t)||ye(o);return n.jsxs(ee,{ref:p,className:P("likec4-edge-label",_y({pointerEvents:s,isStepEdge:g!==null,cursor:r||g!==null?"pointer":"default"}),l),"data-edge-id":e,animate:{scale:a&&!i?1.06:1},...c,children:[g!==null&&n.jsx(U,{className:"likec4-edge-label__step-number",children:g}),m&&n.jsxs(U,{className:"likec4-edge-label__contents",children:[ye(t)&&n.jsx(U,{lineClamp:5,className:"likec4-edge-label__text",children:t}),ye(o)&&n.jsx(U,{className:"likec4-edge-label__technology",children:"[ "+o+" ]"}),u]})]})});Lo.displayName="EdgeLabel";const Rs=e=>{if(e!==void 0)return Ol(e)?`${Math.round(e)}px`:e};function Zn({edgeProps:{id:e,selected:t=!1,data:{hovered:o=!1,active:a=!1,dimmed:i=!1,labelBBox:r,color:s="gray"},animated:l},labelPosition:d,className:u,style:c,children:p,...g}){let m=Oi(h.useCallback(b=>b.edgeLookup.get(e)?.zIndex??nt.Edge,[e]));(o||a)&&(m+=100);let y=d?.x??r?.x,w=d?.y??r?.y;if(y===void 0||w===void 0)return null;const C=d?.translate??"";return n.jsx(Wl,{children:n.jsx("div",{...g,className:P("nodrag nopan","likec4-edge-label-container",u),"data-likec4-hovered":o,"data-likec4-color":s,"data-edge-active":a,"data-edge-animated":l||a,...t!==!1&&{"data-likec4-selected":t},...i!==!1&&{"data-likec4-dimmed":i},style:{...r&&{maxWidth:r.width+18},zIndex:m,...c,transform:`translate(${Rs(y)}, ${Rs(w)}) ${C}`},children:p},e)})}const sx=e=>n.jsx("marker",{viewBox:"-4 -4 14 16",refX:5,refY:4,markerWidth:"7",markerHeight:"8",preserveAspectRatio:"xMaxYMid meet",orient:"auto-start-reverse",...e,children:n.jsx("path",{d:"M0,0 L7,4 L0,8 L4,4 Z",stroke:"context-stroke",fill:"context-stroke",strokeDasharray:0,strokeWidth:1,strokeLinecap:"round"})}),lx=e=>n.jsx("marker",{viewBox:"-1 -1 12 10",refX:4,refY:3,markerWidth:"8",markerHeight:"6",preserveAspectRatio:"xMaxYMid meet",orient:"auto-start-reverse",...e,children:n.jsx("path",{d:"M 0 0 L 8 3 L 0 6 L 1 3 z",fill:"context-stroke",strokeWidth:0})}),dx=e=>n.jsx("marker",{viewBox:"-1 -1 12 12",refX:8,refY:4,markerWidth:"8",markerHeight:"8",preserveAspectRatio:"xMaxYMid meet",orient:"auto-start-reverse",...e,children:n.jsx("path",{d:"M 8 0 L 0 4 L 8 8 M 8 4 L 0 4",fill:"none",strokeWidth:1})}),cx=e=>n.jsx("marker",{viewBox:"-1 -1 12 10",refX:4,refY:3,markerWidth:"8",markerHeight:"6",preserveAspectRatio:"xMaxYMid meet",orient:"auto-start-reverse",...e,children:n.jsx("path",{d:"M 0 0 L 8 3 L 0 6 L 1 3 z",stroke:"context-stroke",fill:"context-stroke",strokeWidth:1.25,strokeLinejoin:"miter",strokeLinecap:"square"})}),ux=e=>n.jsx("marker",{viewBox:"-4 -4 16 14",refX:5,refY:4,markerWidth:"10",markerHeight:"8",preserveAspectRatio:"xMaxYMid meet",orient:"auto-start-reverse",...e,children:n.jsx("path",{d:"M5,0 L10,4 L5,8 L0,4 Z",fill:"context-stroke",strokeWidth:0,strokeLinecap:"round"})}),px=e=>n.jsx("marker",{viewBox:"-4 -4 16 14",refX:6,refY:4,markerWidth:"10",markerHeight:"8",preserveAspectRatio:"xMaxYMid meet",orient:"auto-start-reverse",...e,children:n.jsx("path",{d:"M5,0 L10,4 L5,8 L0,4 Z",stroke:"context-stroke",fill:"context-stroke",strokeWidth:1.25,strokeLinecap:"round"})}),gx=e=>n.jsx("marker",{viewBox:"0 0 10 10",refX:4,refY:4,markerWidth:"6",markerHeight:"6",...e,children:n.jsx("circle",{strokeWidth:0,fill:"context-stroke",cx:4,cy:4,r:3})}),hx=e=>n.jsx("marker",{viewBox:"0 0 10 10",refX:4,refY:4,markerWidth:"6",markerHeight:"6",...e,children:n.jsx("circle",{strokeWidth:1.25,stroke:"context-stroke",fill:"context-stroke",cx:4,cy:4,r:3})}),Ds={Arrow:lx,Crow:dx,OArrow:cx,Open:sx,Diamond:ux,ODiamond:px,Dot:gx,ODot:hx};function Bs(e){if(!(!e||e==="none"))switch(e){case"normal":return"Arrow";case"crow":return"Crow";case"onormal":return"OArrow";case"diamond":return"Diamond";case"odiamond":return"ODiamond";case"open":case"vee":return"Open";case"dot":return"Dot";case"odot":return"ODot";default:Le(e)}}const To=h.forwardRef(({edgeProps:{id:e,data:{line:t,dir:o,tail:a,head:i},selectable:r=!0,style:s,interactionWidth:l},isDragging:d=!1,onEdgePointerDown:u,strokeWidth:c,svgPath:p},g)=>{let m=Bs(a),y=Bs(i??"normal");o==="back"&&([m,y]=[y,m]);const w=m?Ds[m]:null,C=y?Ds[y]:null,b=t==="dotted",v=b||t==="dashed";let j;b?j="1,8":v&&(j="8,10");const f=Ry();return n.jsxs(n.Fragment,{children:[r&&n.jsx("path",{className:P("react-flow__edge-interaction",x({fill:"none"})),onPointerDown:u,d:p,style:{strokeWidth:l??10,stroke:"currentcolor",strokeOpacity:0,...d?{display:"none"}:{}}}),n.jsx("circle",{className:P("likec4-edge-middle-point",f.middlePoint),"data-edge-id":e,style:{offsetPath:`path("${p}")`}}),n.jsxs("g",{className:f.markersCtx,onPointerDown:u,children:[n.jsxs("defs",{children:[w&&n.jsx(w,{id:"start"+e}),C&&n.jsx(C,{id:"end"+e})]}),n.jsx("path",{className:P("react-flow__edge-path","hide-on-reduced-graphics",f.pathBg,d&&x({display:"none"})),d:p,style:s,strokeLinecap:"round"}),n.jsx("path",{ref:g,className:P("react-flow__edge-path",f.path,r&&"react-flow__edge-interaction"),d:p,style:s,strokeWidth:c,strokeLinecap:"round",strokeDasharray:j,markerStart:w?`url(#start${e})`:void 0,markerEnd:C?`url(#end${e})`:void 0})]})]})});To.displayName="EdgePath";const mx=me({position:"absolute",zIndex:1,justifyContent:"center",alignItems:"center",_smallZoom:{display:"none"}}),fx=me({gap:"1.5",justifyContent:"center",alignItems:"center"});function Un({selected:e=!1,data:{hovered:t=!1},buttons:o}){const a=Al();return o.length?n.jsx(U,{className:mx,style:{top:"calc(100% - 30px)",transform:"translateX(-50%)",left:"50%",width:"auto",minHeight:30},children:n.jsx(ee,{layoutRoot:!0,initial:!1,style:{originY:0},animate:{opacity:t||e?1:.75,scale:t?1.1:e?.9:.8,y:t||e?6:0},layoutDependency:`${t}-${e}`,"data-likec4-hovered":t,className:P("nodrag nopan",fx),children:o.map((i,r)=>n.jsx(Q,{component:Te,className:Yn({}),initial:!1,whileTap:{scale:1},whileHover:{scale:1.3},onClick:i.onClick,onDoubleClick:ae,children:i.icon||n.jsx(Yg,{})},`${a}-${i.key??r}`))})}):null}const Nt=h.forwardRef(({value:e,textScale:t=1,uselikec4palette:o=!1,hideIfEmpty:a=!1,emptyText:i="no content",className:r,style:s,fontSize:l,...d},u)=>{if(e.isEmpty&&a)return null;const c=e.nonEmpty?e.isMarkdown?{dangerouslySetInnerHTML:{__html:e.html}}:{children:n.jsx("p",{children:e.text})}:{children:n.jsx(L,{component:"span",fz:"xs",c:"dimmed",style:{userSelect:"none"},children:i})};return n.jsx(U,{ref:u,...d,className:P(Ly({uselikec4palette:o,value:e.isMarkdown?"markdown":"plaintext"}),r),style:{...s,...l&&{"--text-fz":`var(--font-sizes-${l}, var(--font-sizes-md))`},...t!==1&&{"--mantine-scale":t}},...c})});Nt.displayName="Markdown";const cc=h.forwardRef(({className:e,...t},o)=>n.jsx("div",{...t,ref:o,className:P(e,Dy(),"likec4-element")})),uc=({data:e,...t})=>n.jsx(On,{element:e,...t}),pc=h.forwardRef(({className:e,...t},o)=>n.jsx("div",{...t,className:P(e,"likec4-element-node-content"),ref:o})),gc=h.forwardRef(({data:{title:e,style:t},className:o,...a},i)=>{const{size:r}=hi(t),s=r==="sm"||r==="xs";return n.jsx(L,{component:"div",...a,className:P(o,"likec4-element-title"),"data-likec4-node-title":"",lineClamp:s?2:3,ref:i,children:e})}),hc=h.forwardRef(({data:e,children:t,className:o,...a},i)=>{const r=e?.technology??t;return ye(r)?n.jsx(L,{component:"div",...a,className:P(o,"likec4-element-technology"),"data-likec4-node-technology":"",ref:i,children:r}):null}),mc=h.forwardRef(({data:{description:e,style:t},className:o,...a},i)=>{if(!e)return null;const r=ln.from(e),{size:s}=hi(t);return n.jsx(Nt,{...a,className:P(o,"likec4-element-description",x({lineClamp:s==="sm"||s==="xs"?3:5})),"data-likec4-node-description":"",value:r,uselikec4palette:!0,hideIfEmpty:!0,style:{maxHeight:r.isMarkdown?"8rem":void 0},ref:i})});function Ge({iconSize:e,data:t}){return n.jsxs(cc,{style:Ol(e)?{"--likec4-icon-size":`${e}px`}:void 0,children:[n.jsx(uc,{data:t}),n.jsxs(pc,{children:[n.jsx(gc,{data:t}),n.jsx(hc,{data:t}),n.jsx(mc,{data:t})]})]})}Ge.Root=cc;Ge.Icon=uc;Ge.Content=pc;Ge.Title=gc;Ge.Technology=hc;Ge.Description=mc;const yx=x({position:"absolute",top:"0.5",right:"0.5",_shapeBrowser:{right:"[5px]"},_shapeCylinder:{top:"[14px]"},_shapeStorage:{top:"[14px]"},_shapeQueue:{top:"[1px]",right:"3"},_smallZoom:{display:"none"},_print:{display:"none"}});function sr({selected:e=!1,data:{hovered:t=!1},icon:o,onClick:a}){return n.jsx(U,{className:P(yx,"details-button"),children:n.jsx(Q,{className:P("nodrag nopan",Yn({variant:"transparent"})),component:Te,initial:!1,style:{originX:.45,originY:.55},animate:t||e?{scale:1.2,opacity:.8}:{scale:1,opacity:.5},whileHover:{scale:1.4,opacity:1},whileTap:{scale:1.15},onClick:a,onDoubleClick:ae,children:o??n.jsx($i,{stroke:1.8,style:{width:"75%"}})})})}const xx=x({position:"relative",width:"full",height:"full",padding:"0",margin:"0",display:"flex",alignItems:"center",justifyContent:"center",pointerEvents:"none",_focusVisible:{outline:"none"},_whenSelectable:{pointerEvents:"all",_before:{content:'" "',position:"absolute",top:"[calc(100% - 4px)]",left:"0",width:"full",height:"24px",background:"transparent",pointerEvents:"all"}},_reduceGraphicsOnPan:{_before:{display:"none"}},":where(.react-flow__node.selectable:not(.dragging)) &":{cursor:"pointer"}}),ao=h.forwardRef(({nodeProps:{selected:e=!1,selectable:t=!1,data:{hovered:o=!1,dimmed:a=!1,...i}},className:r,style:s,children:l,...d},u)=>{let c=1;switch(!0){case o:c=1.05;break;case e:c=1.02;break}const{size:p,padding:g,textSize:m}=hi(i.style??{});return n.jsx(ee,{ref:u,className:P(xx,"group","likec4-element-node",r),initial:!1,...t&&{animate:{scale:c},whileTap:{scale:.98}},"data-likec4-hovered":o,"data-likec4-color":i.color,"data-likec4-shape":i.shape,"data-likec4-shape-size":p,"data-likec4-spacing":g,"data-likec4-text-size":m,...a!==!1&&{"data-likec4-dimmed":a},style:{...s},...d,children:l})});ao.displayName="ElementNodeContainer";function fc(e,t,o=.065){const a=Math.round(e/2),i=a,r=ut(o*a),s=t-2*r;return{path:`  M ${e},${r}
        a ${i},${r} 0,0,0 ${-e} 0
        l 0,${s}
        a ${i},${r} 0,0,0 ${e} 0
        l 0,${-s}
        z
        `.replace(/\s+/g," ").trim(),ry:r,rx:i}}function yc(e,t,o=.185){const a=t,i=Math.round(a/2),r=ut(a/2*o),s=e-2*r;return{path:`
    M ${r},0
    a ${r},${i} 0,0,0 0 ${a}
    l ${s},0
    a ${r},${i} 0,0,0 0 ${-a}
    z`.replace(/\s+/g," ").trim(),ry:i,rx:r}}const yt={width:115,height:120,path:"M57.9197 0C10.9124 0 33.5766 54.75 33.5766 54.75C38.6131 62.25 45.3285 60.75 45.3285 66C45.3285 70.5 39.4526 72 33.5766 72.75C24.3431 72.75 15.9489 71.25 7.55474 84.75C2.51825 93 0 120 0 120H115C115 120 112.482 93 108.285 84.75C99.8905 70.5 91.4963 72.75 82.2628 72C76.3869 71.25 70.5109 69.75 70.5109 65.25C70.5109 60.75 77.2263 62.25 82.2628 54C82.2628 54.75 104.927 0 57.9197 0V0Z"};function Ls({shape:e,w:t,h:o}){switch(e){case"mobile":return n.jsxs(n.Fragment,{children:[n.jsx("rect",{width:t,height:o,rx:6,"data-likec4-fill":"mix-stroke",strokeWidth:0}),n.jsxs("g",{"data-likec4-fill":"fill",strokeWidth:0,children:[n.jsx("circle",{cx:17,cy:o/2,r:12}),n.jsx("rect",{x:33,y:12,width:t-44,height:o-24,rx:5})]})]});case"browser":return n.jsxs(n.Fragment,{children:[n.jsx("rect",{width:t,height:o,rx:6,"data-likec4-fill":"mix-stroke",strokeWidth:0}),n.jsxs("g",{"data-likec4-fill":"fill",strokeWidth:0,children:[n.jsx("circle",{cx:16,cy:17,r:7}),n.jsx("circle",{cx:36,cy:17,r:7}),n.jsx("circle",{cx:56,cy:17,r:7}),n.jsx("rect",{x:70,y:8,width:t-80,height:17,rx:4}),n.jsx("rect",{x:10,y:32,width:t-20,height:o-42,rx:4})]})]});case"person":return n.jsxs(n.Fragment,{children:[n.jsx("rect",{width:t,height:o,rx:6,strokeWidth:0}),n.jsx("svg",{x:t-yt.width-6,y:o-yt.height,width:yt.width,height:yt.height,viewBox:`0 0 ${yt.width} ${yt.height}`,"data-likec4-fill":"mix-stroke",children:n.jsx("path",{strokeWidth:0,d:yt.path})})]});case"queue":{const{path:a,rx:i,ry:r}=yc(t,o);return n.jsxs(n.Fragment,{children:[n.jsx("path",{d:a,strokeWidth:2}),n.jsx("ellipse",{cx:i,cy:r,ry:r-.75,rx:i,"data-likec4-fill":"mix-stroke",strokeWidth:2})]})}case"storage":case"cylinder":{const{path:a,rx:i,ry:r}=fc(t,o);return n.jsxs(n.Fragment,{children:[n.jsx("path",{d:a,strokeWidth:2}),n.jsx("ellipse",{cx:i,cy:r,ry:r,rx:i-.75,"data-likec4-fill":"mix-stroke",strokeWidth:2})]})}default:return Le(e)}}function bx({shape:e,w:t,h:o}){let a;switch(e){case"queue":a=n.jsx("path",{d:yc(t,o).path});break;case"storage":case"cylinder":{a=n.jsx("path",{d:fc(t,o).path});break}default:{a=n.jsx("rect",{x:-3,y:-3,width:t+6,height:o+6,rx:8});break}}return n.jsx("g",{className:"likec4-shape-outline",children:a})}function wx({multiple:e,withOutLine:t}){return n.jsxs("div",{className:Kd({shapetype:"html"}),children:[e&&n.jsx("div",{className:"likec4-shape-multiple"}),t&&n.jsx("div",{className:"likec4-shape-outline"})]})}function io({data:e,width:t,height:o,showSeletionOutline:a=!0}){let i=t&&t>10?t:e.width,r=o&&o>10?o:e.height;const s=e.style?.multiple??!1;if(e.shape==="rectangle")return n.jsx(wx,{multiple:s,withOutLine:a});const l=Kd({shapetype:"svg"});return n.jsxs(n.Fragment,{children:[s&&n.jsx("svg",{className:l,"data-likec4-shape-multiple":"true",viewBox:`0 0 ${i} ${r}`,children:n.jsx(Ls,{shape:e.shape,w:i,h:r})}),n.jsxs("svg",{className:l,viewBox:`0 0 ${i} ${r}`,children:[a&&n.jsx(bx,{shape:e.shape,w:i,h:r}),n.jsx(Ls,{shape:e.shape,w:i,h:r})]})]})}const Kn=h.forwardRef(({tag:e,cursor:t,className:o,style:a,...i},r)=>{const s=Km(e);return n.jsxs(U,{ref:r,"data-likec4-tag":e,className:P(By({autoTextColor:ml(s)}),o),...i,style:{cursor:t,...a},children:[n.jsx("span",{children:"#"}),n.jsx("span",{children:e})]})}),vx=(e,t)=>e.data.width===t.data.width&&I(e.data.tags,t.data.tags)&&(e.data.hovered??!1)===(t.data.hovered??!1),Ao=h.memo(({id:e,data:{tags:t,width:o,hovered:a=!1}})=>{const{hovered:i,ref:r}=Xa(),{hovered:s,ref:l}=Xa(),[d,u]=Tu(!1,a?120:300);h.useEffect(()=>{u(C=>C?a||i||s:a&&(i||s))},[i,s,a]);const c=jm(),p=c>1.2,g=H(),m=C=>{g.send({type:"tag.highlight",tag:C})},y=h.useCallback(()=>{g.send({type:"tag.unhighlight"})},[]);if(!t||t.length===0)return null;const w=Math.max(Math.round(o*c)-10,200);return n.jsxs(n.Fragment,{children:[n.jsx("div",{ref:r,className:P("likec4-element-tags",me({pointerEvents:"all",gap:"1",alignItems:"flex-end",justifyItems:"stretch",position:"absolute",width:"100%",bottom:"0",left:"0",padding:"1",_shapeCylinder:{bottom:"[5px]"},_shapeStorage:{bottom:"[5px]"},_shapeQueue:{bottom:"0",paddingLeft:"[14px]"}})),onClick:ae,children:t.map(C=>n.jsx(U,{"data-likec4-tag":C,className:x({layerStyle:"likec4.tag",flex:"1",display:"flex",alignItems:"center",justifyContent:"center",maxWidth:50,height:5,_whenHovered:{height:12,borderRadius:4,transitionDelay:".08s"},transition:"fast"})},e+"#"+C))}),n.jsx(Ci,{isVisible:d,align:"start",position:ge.Bottom,children:n.jsx(te,{ref:l,css:{gap:"0.5",alignItems:"baseline",flexWrap:"wrap",pb:"sm",translate:"auto",x:"[-8px]",maxWidth:w},children:t.map(C=>n.jsx(Kn,{tag:C,cursor:"pointer",className:x({userSelect:"none",...p&&{fontSize:"lg",borderRadius:"[4px]",px:"1.5"}}),onClick:b=>{b.stopPropagation(),g.openSearch(`#${C}`)},onMouseEnter:()=>m(C),onMouseLeave:y},C))})})]})},vx);Ao.displayName="ElementTags";const Go=(e,t)=>Math.abs(e-t)<2.5,kx=(e,t)=>e.id===t.id&&I(e.selected??!1,t.selected??!1)&&I(e.animated??!1,t.animated??!1)&&I(e.source,t.source)&&Go(e.sourceX,t.sourceX)&&Go(e.sourceY,t.sourceY)&&I(e.sourceHandleId??null,t.sourceHandleId??null)&&I(e.sourcePosition,t.sourcePosition)&&I(e.target,t.target)&&Go(e.targetY,t.targetY)&&Go(e.targetX,t.targetX)&&I(e.targetHandleId??null,t.targetHandleId??null)&&I(e.targetPosition,t.targetPosition)&&I(e.data,t.data);function lr(e){const t=h.memo(e,kx);return t.displayName=`MemoEdge(${e.displayName||e.name})`,t}function jx(e,t){return e.id===t.id&&I(e.type,t.type)&&I(e.selected??!1,t.selected??!1)&&I(e.dragging??!1,t.dragging??!1)&&I(e.width??0,t.width??0)&&I(e.height??0,t.height??0)&&I(e.zIndex??0,t.zIndex??0)&&I(e.data,t.data)}const Ts=Symbol.for("isMemoized");function et(e,t="Node"){if(e.hasOwnProperty(Ts))return e;const o=h.memo(e,jx);return o.displayName=t,Object.defineProperty(o,Ts,{enumerable:!1,writable:!1,value:!0}),o}const Cx=[ge.Top,ge.Right,ge.Bottom,ge.Left],zo=h.memo(()=>n.jsx(n.Fragment,{children:Cx.map(e=>n.jsxs(h.Fragment,{children:[n.jsx(He,{type:"source",position:e,className:"likec4-node-handle-center"}),n.jsx(He,{type:"target",position:e,className:"likec4-node-handle-center"})]},e))})),Sx=h.forwardRef((e,t)=>n.jsx("svg",{height:"24",width:"24",fill:"currentColor",...e,viewBox:"0 0 24 24",ref:t,children:n.jsx("path",{d:"M12 1C5.923 1 1 5.923 1 12c0 4.867 3.149 8.979 7.521 10.436.55.096.756-.233.756-.522 0-.262-.013-1.128-.013-2.049-2.764.509-3.479-.674-3.699-1.292-.124-.317-.66-1.293-1.127-1.554-.385-.207-.936-.715-.014-.729.866-.014 1.485.797 1.691 1.128.99 1.663 2.571 1.196 3.204.907.096-.715.385-1.196.701-1.471-2.448-.275-5.005-1.224-5.005-5.432 0-1.196.426-2.186 1.128-2.956-.111-.275-.496-1.402.11-2.915 0 0 .921-.288 3.024 1.128a10.193 10.193 0 0 1 2.75-.371c.936 0 1.871.123 2.75.371 2.104-1.43 3.025-1.128 3.025-1.128.605 1.513.221 2.64.111 2.915.701.77 1.127 1.747 1.127 2.956 0 4.222-2.571 5.157-5.019 5.432.399.344.743 1.004.743 2.035 0 1.471-.014 2.654-.014 3.025 0 .289.206.632.756.522C19.851 20.979 23 16.854 23 12c0-6.077-4.922-11-11-11Z"})})),As="https://github.com/",dr=h.forwardRef(({value:e,className:t,...o},a)=>{const i=e.url.includes("://")?e.url:new window.URL(e.url,window.location.href).toString();let r=i.startsWith(As);return n.jsx(St,{ref:a,variant:"default",radius:"sm",size:"sm",tt:"none",leftSection:e.title?n.jsx(n.Fragment,{children:e.title}):null,rightSection:n.jsx(Au,{value:i,timeout:1500,children:({copy:s,copied:l})=>n.jsx(Q,{className:x({opacity:l?1:.45,transition:"fast",_hover:{opacity:1}}),tabIndex:-1,size:"20",variant:l?"light":"transparent",color:l?"teal":"gray","data-active":l,onClick:d=>{d.stopPropagation(),d.preventDefault(),s()},children:l?n.jsx(dd,{}):n.jsx(th,{stroke:2.5})})}),...o,className:P(t,"group"),classNames:{root:x({flexWrap:"nowrap",minHeight:24,maxWidth:500,userSelect:"all",pr:"0",backgroundColor:{base:"transparent",_hover:{base:"mantine.colors.gray[1]",_dark:"mantine.colors.dark[5]"}}}),section:x({'&:is([data-position="left"])':{color:"mantine.colors.dimmed",userSelect:"none",pointerEvents:"none",_groupHover:{color:"[var(--badge-color)]",opacity:.7}}})},children:n.jsxs(mt.a,{href:i,target:"_blank",style:{color:"var(--badge-color)",cursor:"pointer"},css:{transition:"fast",opacity:{base:.7,_hover:1},textDecoration:{base:"none",_hover:"underline"}},children:[r&&n.jsx(Sx,{height:"12",width:"12",style:{verticalAlign:"middle",marginRight:"4px"}}),r?i.replace(As,""):i]})})}),_x=({context:e})=>{const t=e.view;return{id:t.id,title:e.viewModel?.title??(t.title&&xl(t.title))??"Untitled View",description:e.viewModel?.description??ln.from(t.description),tags:t.tags??[],links:t.links??[]}},Px=e=>{const[t,o]=h.useState(!1),a=rr(_x,I),i=no();return n.jsxs(st,{position:"bottom-end",shadow:"xl",clickOutsideEvents:["pointerdown","mousedown","click"],offset:{mainAxis:4},opened:t,onChange:o,...i,...e,children:[n.jsx(Mx,{linksCount:a.links.length,onOpen:()=>o(!0)}),t&&n.jsx(Nx,{data:a,onClose:()=>o(!1)})]})},Mx=({linksCount:e,onOpen:t})=>n.jsx(st.Target,{children:n.jsxs(de,{component:Te,layout:"position",whileTap:{scale:.95,translateY:1},onClick:o=>{o.stopPropagation(),t()},className:P("group",me({gap:"2",paddingInline:"2",paddingBlock:"1",rounded:"sm",userSelect:"none",cursor:"pointer",color:{base:"likec4.panel.action",_hover:"likec4.panel.action.hover"},backgroundColor:{_hover:"likec4.panel.action.bg.hover"},display:{base:"none","@/xs":"flex"}}),""),children:[n.jsx($i,{size:16,stroke:1.8}),e>0&&n.jsxs(te,{gap:"[1px]",children:[n.jsx(Dh,{size:14,stroke:2}),n.jsx(U,{css:{fontSize:"11px",fontWeight:600,lineHeight:1,opacity:.8},children:e})]})]})}),zs=mt("div",{base:{fontSize:"xs",color:"mantine.colors.dimmed",fontWeight:500,userSelect:"none",mb:"xxs"}}),Nx=({data:{id:e,title:t,description:o,tags:a,links:i},onClose:r})=>{const s=H();return Ne("paneClick",r),Ne("nodeClick",r),n.jsxs(st.Dropdown,{className:P("nowheel nopan nodrag",No({margin:"xs",layerStyle:"likec4.dropdown",gap:"md",padding:"md",paddingBottom:"lg",pointerEvents:"all",maxWidth:"calc(100cqw - 52px)",minWidth:"200px",maxHeight:"calc(100cqh - 100px)",width:"max-content",cursor:"default",overflow:"auto",overscrollBehavior:"contain","@/sm":{minWidth:400,maxWidth:550},"@/lg":{maxWidth:700}})),children:[n.jsxs("section",{children:[n.jsx(L,{component:"div",fw:500,size:"xl",lh:"sm",children:t}),n.jsxs(te,{alignItems:"flex-start",mt:"1",children:[n.jsx(Ex,{label:"id",value:e}),n.jsx(te,{gap:"xs",flexWrap:"wrap",children:a.map(l=>n.jsx(Kn,{tag:l,cursor:"pointer",onClick:d=>{d.stopPropagation(),s.openSearch(`#${l}`)}},l))})]})]}),i.length>0&&n.jsxs("section",{className:me({alignItems:"baseline"}),children:[n.jsx(zs,{children:"Links"}),n.jsx(te,{gap:"xs",flexWrap:"wrap",children:i.map((l,d)=>n.jsx(dr,{value:l},`${d}-${l.url}`))})]}),o.isEmpty&&n.jsx(L,{component:"div",fw:500,size:"xs",c:"dimmed",style:{userSelect:"none"},children:"No description"}),o.nonEmpty&&n.jsxs("section",{children:[n.jsx(zs,{children:"Description"}),n.jsx(Nt,{value:o,fontSize:"sm",emptyText:"No description",className:x({userSelect:"all"})})]})]})},Ex=({label:e,value:t})=>n.jsxs(te,{gap:"0.5",children:[n.jsx(Ix,{children:e}),n.jsx(St,{size:"sm",radius:"sm",variant:"light",color:"gray",tt:"none",fw:500,classNames:{root:x({width:"max-content",overflow:"visible",px:"1",color:{_dark:"mantine.colors.gray[4]",_light:"mantine.colors.gray[8]"}}),label:x({overflow:"visible"}),section:x({opacity:.5,userSelect:"none",marginInlineEnd:"0.5"})},children:t})]}),Ix=mt("div",{base:{color:"mantine.colors.dimmed",fontWeight:500,fontSize:"xxs",userSelect:"none"}}),xc=h.memo(()=>{const[e,{toggleCompare:t}]=nr(),o=no(),{drifts:a,isActive:i,isEnabled:r}=e;return n.jsx(he,{propagate:!0,children:r&&!i&&n.jsxs(zu,{position:"bottom-start",openDelay:600,closeDelay:200,floatingStrategy:"absolute",offset:{mainAxis:4,crossAxis:-22},...o,children:[n.jsx($u,{children:n.jsx(de,{component:Te,layout:"position",onClick:s=>{s.stopPropagation(),t()},whileTap:{scale:.95,translateY:1},className:P("group",tc({variant:"filled",type:"warning"}),me({gap:"xxs",padding:"1.5",rounded:"sm",userSelect:"none",cursor:"pointer",fontSize:"xs",fontWeight:600})),children:i?n.jsx(n.Fragment,{children:"Stop Compare"}):n.jsx(ld,{size:18})})}),n.jsx(Vu,{p:"0",children:n.jsxs(Si,{color:"orange",withBorder:!1,withCloseButton:!1,title:"View is out of sync",children:[n.jsx(L,{mt:2,size:"sm",lh:"xs",children:"Model has changed since this view was last updated."}),n.jsxs(L,{mt:4,size:"sm",lh:"xs",children:["Detected changes:",a.map(s=>n.jsxs(h.Fragment,{children:[n.jsx("br",{}),n.jsxs("span",{children:["- ",s]})]},s))]}),n.jsx(Ce,{mt:"xs",size:"compact-sm",variant:"default",onClick:s=>{s.stopPropagation(),t()},children:"Compare with current state"})]})})]})})});xc.displayName="ManualLayoutWarning";const Rx=()=>{const e=H(),{hasStepBack:t,hasStepForward:o}=ze(a=>({hasStepBack:a.navigationHistory.currentIndex>0,hasStepForward:a.navigationHistory.currentIndex<a.navigationHistory.history.length-1}));return n.jsxs(ee,{layout:"position",className:me({gap:"0.5"}),children:[n.jsx(at,{disabled:!t,onClick:a=>{a.stopPropagation(),e.navigate("back")},children:n.jsx(Hg,{size:14})}),n.jsx(at,{disabled:!o,onClick:a=>{a.stopPropagation(),e.navigate("forward")},children:n.jsx(Yt,{size:14})})]})},Dx=()=>{const e=Xn(),{enableVscode:t}=Z(),{onOpenSource:o}=to();return t?n.jsx(ac,{label:"Open View Source",children:n.jsx(at,{onClick:a=>{a.stopPropagation(),o?.({view:e})},children:n.jsx(Jt,{style:{width:"60%",height:"60%"}})})}):null},bc=h.memo(()=>{const{enableSearch:e,enableCompareWithLatest:t}=Z(),o=H(),a=Fu();return n.jsx(he,{children:e&&!t&&n.jsxs(de,{component:Te,layout:"position",onClick:i=>{i.stopPropagation(),o.openSearch()},whileTap:{scale:.95,translateY:1},className:P("group",me({gap:"xxs",paddingInline:"sm",paddingBlock:"xxs",userSelect:"none",layerStyle:"likec4.panel.action.filled",display:{base:"none","@/md":"flex"}})),children:[n.jsx(Vi,{size:14,stroke:2.5}),n.jsx(U,{css:{fontSize:"11px",fontWeight:600,lineHeight:1,opacity:.8,whiteSpace:"nowrap"},children:a?" + K":"Ctrl + K"})]})})});bc.displayName="SearchControl";const Bx=e=>{const t=qn(e).enableCompareWithLatest&&!!e.view.drifts&&e.view._layout==="auto",o=e.view._type==="dynamic"&&e.dynamicViewVariant==="sequence",a=!ye(e.activeWalkthrough);return{visible:e.features.enableEditor&&a,disabled:t||o,isReadOnly:e.toggledFeatures.enableReadOnly??!1}},Lx=()=>{const{visible:e,disabled:t,isReadOnly:o}=ze(Bx),a=H();return n.jsx(he,{mode:"popLayout",children:e&&n.jsxs(de,{component:Te,layout:"position",layoutDependency:o,disabled:t,onClick:i=>{i.stopPropagation(),!t&&a.toggleFeature("ReadOnly")},initial:{opacity:0,scale:.6},animate:{opacity:1,scale:t?.95:1},exit:{opacity:0,scale:.6},whileTap:{translateY:1},className:P("group",me({gap:"0.5",paddingInline:"xxs",paddingBlock:"xxs",userSelect:"none",layerStyle:"likec4.panel.action",backgroundColor:{base:"none",_notDisabled:{_hover:"likec4.panel.action.bg.hover"}}})),children:[n.jsx(pd,{size:14,stroke:2,style:{display:o?"none":void 0}}),n.jsx(Th,{size:14,stroke:2,style:{display:o?void 0:"none"}}),n.jsx(ee,{className:x({fontSize:"11px",fontWeight:600,lineHeight:1,opacity:.8}),style:{display:o?"block":"none"},children:"Edit"})]})})},kn=_o({base:{fontSize:"sm",fontWeight:"500",transition:"fast",color:{base:"likec4.panel.action",_hover:"likec4.panel.action.hover"}},variants:{truncate:{true:{truncate:!0}},dimmed:{true:{color:{base:"likec4.panel.text.dimmed",_hover:"likec4.panel.action"}}}}}),jn=h.createContext(null),wc=[];function ck(){const e=h.useContext(jn);return e?e.projects:wc}const Tx=()=>{},Ax={projects:wc,onProjectChange:Tx};function zx(){return h.useContext(jn)??Ax}function $x(){const e=h.useContext(Hn);if(!e)throw new Error("No LikeC4ModelProvider found");return e.projectId}function vc(){const e=h.useContext(Hn);e||console.error("No LikeC4ModelContext found");const t=e?.$styles??Pu.DEFAULT,[o,a]=h.useState(t);return h.useEffect(()=>{a(i=>i.equals(t)?i:t)},[t]),o}const kc=h.forwardRef((e,t)=>n.jsx(Ce,{variant:"filled",size:"xs",fw:"500",...e,ref:t,component:Te,whileTap:{scale:.95},layout:"position",layoutId:"trigger-dynamic-walkthrough",className:x({flexShrink:0})}));function Vx(){const{enableReadOnly:e,enableCompareWithLatest:t}=Z(),o=H(),a=Io();let i="Start Dynamic View Walkthrough";switch(!0){case!e:i="Walkthrough not available in Edit mode";break;case t:i="Walkthrough not available when Compare is active";break}return n.jsx(ac,{label:i,children:n.jsx(kc,{onClick:r=>{r.stopPropagation(),a.closeDropdown(),o.startWalkthrough()},initial:{opacity:0,scale:.6,translateX:-10},animate:{opacity:1,scale:1,translateX:0},exit:{opacity:0,translateX:-20},size:"compact-xs",h:26,disabled:!e||t,classNames:{label:x({display:{base:"none","@/md":"inherit"}}),section:x({marginInlineStart:{base:"0","@/md":"2"}})},rightSection:n.jsx(sm,{size:10}),children:"Start"})})}const Fx=h.forwardRef(({value:e,onChange:t},o)=>n.jsx(ee,{ref:o,layout:"position",children:n.jsx(Rn,{size:"xs",value:e,component:ee,onChange:a=>{O(a==="diagram"||a==="sequence","Invalid dynamic view variant"),t(a)},classNames:{label:x({fontSize:"xxs"})},data:[{value:"diagram",label:"Diagram"},{value:"sequence",label:"Sequence"}]})}));function Wx(){const e=ze(o=>o.dynamicViewVariant),t=H();return n.jsxs(he,{children:[n.jsx(Fx,{value:e,onChange:o=>{t.switchDynamicViewVariant(o)}}),n.jsx(Vx,{},"trigger-dynamic-walkthrough")]})}const $s=Ce.withProps({component:Te,layout:"position",whileTap:{scale:.95},variant:"light",size:"xs",fw:"500"}),Ox=()=>{const{portalProps:e}=no();return n.jsx(bi,{...e,children:n.jsx(U,{css:{position:"absolute",margin:"0",padding:"0",top:"0",left:"0",width:"100%",height:"100%",border:"2px solid",borderColor:"mantine.colors.orange[6]",pointerEvents:"none",md:{borderWidth:4}}})})};function Hx(){const e=H(),{isParallel:t,hasNext:o,hasPrevious:a,currentStep:i,totalSteps:r}=ze(s=>{const l=s.xyedges.findIndex(d=>d.id===s.activeWalkthrough?.stepId);return{isParallel:ye(s.activeWalkthrough?.parallelPrefix),hasNext:l<s.xyedges.length-1,hasPrevious:l>0,currentStep:l+1,totalSteps:s.xyedges.length}});return n.jsxs(he,{propagate:!0,mode:"popLayout",children:[n.jsx(kc,{variant:"light",size:"xs",color:"orange",mr:"sm",onClick:s=>{s.stopPropagation(),e.stopWalkthrough()},rightSection:n.jsx(gm,{size:10}),children:"Stop"},"stop-walkthrough"),n.jsx($s,{disabled:!a,onClick:()=>e.walkthroughStep("previous"),leftSection:n.jsx(dm,{size:10}),children:"Previous"},"prev"),n.jsxs(St,{component:ee,layout:"position",size:"md",radius:"sm",variant:t?"gradient":"transparent",gradient:{from:"red",to:"orange",deg:90},rightSection:n.jsx(ee,{className:x({fontSize:"xxs",display:t?"block":"none"}),children:"parallel"}),className:x({alignItems:"baseline"}),children:[i," / ",r]},"step-badge"),n.jsx($s,{disabled:!o,onClick:()=>e.walkthroughStep("next"),rightSection:n.jsx(um,{size:10}),children:"Next"},"next"),t&&n.jsx(Ox,{},"parallel-frame")]})}const Xx=({context:e})=>{const t=e.view,o=e.viewModel?.folder;return{folders:!o||o.isRoot?[]:o.breadcrumbs.map(a=>({folderPath:a.path,title:a.title})),viewId:t.id,viewTitle:e.viewModel?.title??(t.title&&xl(t.title))??"Untitled View",isDynamicView:(e.viewModel?._type??t._type)==="dynamic"}},jc=h.memo(()=>{const e=Io(),{enableNavigationButtons:t,enableDynamicViewWalkthrough:o}=Z(),{folders:a,viewTitle:i,isDynamicView:r}=re(e.actorRef,Xx,I),s=a.flatMap(({folderPath:d,title:u},c)=>[n.jsx(de,{component:Te,className:P(kn({dimmed:!0,truncate:!0}),"mantine-active",x({userSelect:"none",maxWidth:"200px",display:{base:"none","@/md":"block"}})),initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},title:u,onMouseEnter:()=>e.send({type:"breadcrumbs.mouseEnter.folder",folderPath:d}),onMouseLeave:()=>e.send({type:"breadcrumbs.mouseLeave.folder",folderPath:d}),onClick:p=>{p.stopPropagation(),e.send({type:"breadcrumbs.click.folder",folderPath:d})},children:u},d),n.jsx(ic,{},`separator-${c}`)]),l=n.jsx(de,{component:Te,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:P("mantine-active",kn({truncate:!0}),x({userSelect:"none"})),title:i,onMouseEnter:()=>e.send({type:"breadcrumbs.mouseEnter.viewtitle"}),onMouseLeave:()=>e.send({type:"breadcrumbs.mouseLeave.viewtitle"}),onClick:d=>{d.stopPropagation(),e.send({type:"breadcrumbs.click.viewtitle"})},children:i},"view-title");return n.jsxs(he,{propagate:!0,mode:"popLayout",children:[n.jsx(ix,{},"burger-button"),t&&n.jsx(Rx,{},"nav-buttons"),n.jsxs(ee,{layout:"position",className:me({gap:"1",flexShrink:1,flexGrow:1,overflow:"hidden"}),children:[s,l]},"breadcrumbs"),n.jsxs(ee,{layout:"position",className:me({gap:"0.5",flexGrow:0,_empty:{display:"none"}}),children:[n.jsx(Px,{onOpen:()=>e.closeDropdown()}),n.jsx(Dx,{}),n.jsx(Lx,{})]},"actions"),o&&r&&n.jsx(Wx,{},"dynamic-view-controls"),n.jsx(bc,{},"search-control"),n.jsx(xc,{},"outdated-manual-layout-warning")]})});jc.displayName="NavigationPanelControls";const di=h.forwardRef(({className:e,truncateLabel:t=!0,...o},a)=>n.jsx(Wu,{...o,component:"button",classNames:Wy({truncateLabel:t}),className:P("group","mantine-active",e),ref:a}));di.displayName="NavigationLink";const Cc=e=>{const{enableNavigateTo:t}=Z(),o=H(),{navigateTo:a}=e.data;return a&&t?n.jsx(rx,{onClick:i=>{i.stopPropagation(),o.navigateTo(a,e.id)},...e}):null},qx=(e,t)=>I(e.data.id,t.data.id)&&I(e.selected??!1,t.selected??!1)&&I(e.data.modelFqn??null,t.data.modelFqn??null)&&I(e.data.navigateTo??null,t.data.navigateTo??null)&&I(e.data.hovered??!1,t.data.hovered??!1)&&(!e.extraButtons&&!t.extraButtons||oe(e.extraButtons,t.extraButtons)),Sc=h.memo(({extraButtons:e,...t})=>{const{enableNavigateTo:o,enableRelationshipBrowser:a}=Z(),i=H(),{id:r,navigateTo:s,modelFqn:l}=t.data;let d=h.useMemo(()=>{const u=[];return s&&o&&u.push({key:"navigate",icon:n.jsx($e,{}),onClick:c=>{c.stopPropagation(),i.navigateTo(s,r)}}),a&&u.push({key:"relationships",icon:n.jsx(Mo,{}),onClick:c=>{c.stopPropagation(),i.openRelationshipsBrowser(l)}}),u},[o,a,l,s,r,i]);return e&&xe(e,1)&&(d=[...d,...e]),n.jsx(Un,{...t,buttons:d})},qx),Yx=({extraButtons:e,...t})=>{const{enableNavigateTo:o,enableRelationshipBrowser:a}=Z(),i=H(),{id:r,navigateTo:s,modelFqn:l}=t.data;let d=h.useMemo(()=>{const u=[];return s&&o&&u.push({key:"navigate",icon:n.jsx($e,{}),onClick:c=>{c.stopPropagation(),i.navigateTo(s,r)}}),a&&l&&u.push({key:"relationships",icon:n.jsx(Mo,{}),onClick:c=>{c.stopPropagation(),i.openRelationshipsBrowser(l)}}),u},[o,a,l,s,r]);return e&&xe(e,1)&&(d=[...d,...e]),n.jsx(Un,{...t,buttons:d})};function ro({nodeProps:{data:e},position:t="bottom"}){const o=e.drifts;if(!o||o.length===0)return null;const a=t==="top"?ge.Top:ge.Bottom;return n.jsx(U,{className:"likec4-node-drifts",css:{display:"contents","& + .likec4-element-shape":{outlineColor:"likec4.compare.manual.outline",outlineWidth:"4px",outlineStyle:"dashed",outlineOffset:"1.5"}},children:n.jsx(Ci,{isVisible:e.hovered===!0,align:"start",position:a,children:n.jsx(Si,{color:"orange",withBorder:!1,withCloseButton:!1,title:"Changes:",children:o.map(i=>n.jsxs(L,{mt:2,size:"sm",lh:"xs",children:["- ",i]},i))})})})}const _c=je.withProps({color:"dark",fz:"xs",openDelay:400,closeDelay:150,label:"",children:null,offset:4,withinPortal:!1});function Qn({fqn:e}){const t=H();return n.jsx(_c,{label:"Browse relationships",children:n.jsx(Q,{size:"sm",variant:"subtle",color:"gray",onClick:o=>{o.stopPropagation(),t.openRelationshipsBrowser(e)},children:n.jsx(Mo,{stroke:2,style:{width:"72%",height:"72%"}})})})}function Jn(e){const{onOpenSource:t}=to();return t?n.jsx(_c,{label:"Open source",children:n.jsx(Q,{size:"sm",variant:"subtle",color:"gray",onClick:o=>{o.stopPropagation(),e.elementId?t?.({element:e.elementId}):e.deploymentId&&t?.({deployment:e.deploymentId})},children:n.jsx(Jt,{stroke:1.8,style:{width:"70%"}})})}):null}const Vs=["primary","secondary","muted"];function ea({elementColor:e,elementOpacity:t,onColorPreview:o,isOpacityEditable:a=!1,onChange:i,...r}){const{theme:s}=vc();return n.jsxs(st,{clickOutsideEvents:["pointerdown","mousedown","click"],position:"right-end",offset:2,withinPortal:!1,...r,children:[n.jsx(Ut,{children:n.jsx(Ce,{variant:"subtle",color:"gray",size:"compact-xs",px:3,children:n.jsx(Za,{color:s.colors[e].elements.fill,size:14,withShadow:!0,style:{color:"#fff",cursor:"pointer"}})})}),n.jsxs(Kt,{p:"xs",children:[n.jsx(Gx,{theme:s,elementColor:e,onColorPreview:o,onChange:l=>i({color:l})}),a&&n.jsxs(n.Fragment,{children:[n.jsx(Fr,{h:"xs"}),n.jsx(ko,{label:"opacity",labelPosition:"left"}),n.jsx(Fr,{h:"xs"}),n.jsx(Zx,{elementOpacity:t,onOpacityChange:l=>{i({opacity:l})}})]})]})]})}function Gx({theme:e,elementColor:t,onColorPreview:o,onChange:a}){const i=s=>l=>{l.stopPropagation(),o(null),t!==s&&a(s)},r=xi(e.colors).filter(s=>!Vs.includes(s));return n.jsx(Ee,{gap:2,onMouseLeave:()=>o(null),children:n.jsxs(In,{openDelay:1e3,closeDelay:300,children:[n.jsx(Pt,{maw:120,gap:"6",justify:"flex-start",align:"flex-start",direction:"row",wrap:"wrap",children:Vs.map(s=>n.jsx(je,{label:s,fz:"xs",color:"dark",offset:2,withinPortal:!1,transitionProps:{duration:140,transition:"slide-up"},children:n.jsx(Za,{color:e.colors[s].elements.fill,size:18,withShadow:!0,onMouseEnter:()=>o(s),onClick:i(s),style:{color:"#fff",cursor:"pointer"},children:t===s&&n.jsx(Wr,{style:{width:ot(10),height:ot(10)}})})},s))}),n.jsx(Pt,{mt:"sm",maw:110,gap:"6",justify:"flex-start",align:"flex-start",direction:"row",wrap:"wrap",children:r.map(s=>n.jsx(je,{label:s,fz:"xs",color:"dark",offset:2,transitionProps:{duration:140,transition:"slide-up"},children:n.jsx(Za,{color:e.colors[s].elements.fill,size:18,onMouseEnter:()=>o(s),onClick:i(s),style:{color:"#fff",cursor:"pointer"},children:t===s&&n.jsx(Wr,{style:{width:ot(10),height:ot(10)}})})},s))})]})})}function Zx({elementOpacity:e=100,onOpacityChange:t}){const[o,a]=h.useState(e);return Gp(()=>{a(e)},[e]),n.jsx(Zp,{size:"sm",color:"dark",value:o,onChange:a,onChangeEnd:t})}const Ux=x({color:"mantine.colors.dimmed",fontSize:"10px",fontWeight:600,maxWidth:"220px",cursor:"default",userSelect:"all",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"}),Kx=()=>ze(e=>e.xynodes.filter(t=>t.selected).length);function ta({title:e,children:t,nodeProps:o,...a}){const i=Kx(),{selected:r=!1,dragging:s=!1,data:{hovered:l=!1}}=o,d=l&&i===0||r&&i===1;let u=150;d?r?u=100:u=1e3:i>0&&(u=50);const[c]=Ri(d,u);return c?n.jsx(Ci,{isVisible:!s,offset:4,...a,children:n.jsx(Mi,{className:P("nodrag","nopan"),px:5,pb:8,pt:4,radius:"sm",shadow:"xl",onDoubleClickCapture:ae,onPointerDown:ae,onClick:ae,onDoubleClick:ae,withBorder:!0,children:n.jsxs(Ee,{gap:"6px",children:[n.jsx(q,{px:"4px",children:n.jsx(L,{className:Ux,children:e})}),n.jsx(ce,{gap:4,children:t})]})})}):null}function oa(e,t){const o=H(),[a,i]=h.useState(null),r=D(l=>{if(l===null){if(!a)return;i(null),o.updateNodeData(t.data.id,{color:a});return}i(d=>d??t.data.color),o.updateNodeData(t.data.id,{color:l})}),s=D(l=>{const{shape:d,color:u,...c}=l;o.updateNodeData(t.data.id,{...d&&{shape:d},...u&&{color:u},style:c}),o.triggerChange({op:"change-element-style",style:l,targets:[e]})});return{elementColor:a??t.data.color,onColorPreview:r,onChange:s}}function Qx(e){const{enableVscode:t,enableRelationshipBrowser:o}=Z(),{data:{style:a,modelFqn:i}}=e,{elementColor:r,onColorPreview:s,onChange:l}=oa(i,e),d=a?.opacity??100;return n.jsxs(ta,{nodeProps:e,title:i,align:"start",children:[n.jsx(ea,{elementColor:r,onColorPreview:s,isOpacityEditable:!0,elementOpacity:d,onChange:l,position:"left-start"}),n.jsx(Pc,{elementBorderStyle:a?.border??(d<99?"dashed":"none"),onChange:l}),t&&n.jsx(Jn,{elementId:i}),o&&n.jsx(Qn,{fqn:i})]})}function Jx(e){const{enableVscode:t,enableRelationshipBrowser:o}=Z(),{data:{deploymentFqn:a,style:i,modelFqn:r}}=e,{elementColor:s,onColorPreview:l,onChange:d}=oa(a,e);return n.jsxs(ta,{nodeProps:e,title:a,align:"start",children:[n.jsx(ea,{elementColor:s,onColorPreview:l,isOpacityEditable:!0,elementOpacity:i?.opacity,onChange:d,position:"left-start"}),n.jsx(Pc,{elementBorderStyle:i?.border,onChange:d}),t&&n.jsx(Jn,{deploymentId:a}),o&&r&&n.jsx(Qn,{fqn:r})]})}function Pc({elementBorderStyle:e="dashed",onChange:t}){const[o,a]=h.useState(e);return h.useEffect(()=>{a(e)},[e]),n.jsx(q,{children:n.jsx(Rn,{size:"xs",fullWidth:!0,withItemsBorders:!1,value:o,onChange:i=>{const r=i;a(r),t({border:r})},styles:{label:{paddingTop:"0.5",paddingBottom:"0.5"}},data:[{label:"Solid",value:"solid"},{label:"Dashed",value:"dashed"},{label:"Dotted",value:"dotted"},{label:"None",value:"none"}]})})}function e0(e){const{enableVscode:t,enableRelationshipBrowser:o}=Z(),{data:{shape:a,modelFqn:i}}=e,{elementColor:r,onColorPreview:s,onChange:l}=oa(i,e);return n.jsxs(ta,{nodeProps:e,title:i,align:"start",children:[n.jsx(Mc,{elementShape:a,onChange:l}),n.jsx(ea,{elementColor:r,onColorPreview:s,onChange:l,position:"right-end"}),t&&n.jsx(Jn,{elementId:i}),o&&n.jsx(Qn,{fqn:i})]})}function t0(e){const{enableVscode:t,enableRelationshipBrowser:o}=Z(),{data:{shape:a,deploymentFqn:i,modelFqn:r}}=e,{elementColor:s,onColorPreview:l,onChange:d}=oa(i,e);return n.jsxs(ta,{nodeProps:e,title:i,align:"start",children:[n.jsx(Mc,{elementShape:a,onChange:d}),n.jsx(ea,{elementColor:s,onColorPreview:l,onChange:d,position:"right-end"}),t&&n.jsx(Jn,{deploymentId:i}),o&&r&&n.jsx(Qn,{fqn:r})]})}function Mc({elementShape:e,onChange:t}){return n.jsxs(Fe,{openDelay:300,closeDelay:450,floatingStrategy:"fixed",closeOnClickOutside:!0,clickOutsideEvents:["pointerdown","mousedown","click"],closeOnEscape:!0,closeOnItemClick:!1,position:"top-start",offset:2,styles:{item:{padding:"calc(var(--mantine-spacing-xs) / 1.5) var(--mantine-spacing-xs)"}},withinPortal:!1,children:[n.jsx(_l,{children:n.jsx(Ce,{variant:"light",color:"gray",size:"compact-xs",rightSection:n.jsx(Fi,{size:12}),children:e})}),n.jsx(Pl,{onDoubleClick:ae,onClick:ae,children:Iu.map(o=>n.jsx(Ml,{fz:12,fw:500,value:o,rightSection:e===o?n.jsx(dd,{size:12}):void 0,onClick:a=>{a.stopPropagation(),t({shape:o})},children:o},o))})]})}function cr(e){const t=H(),o=e.data.modelFqn;return o?n.jsx(sr,{...e,onClick:a=>{a.stopPropagation(),t.openElementDetails(o,e.id)}}):null}function Nc(e){const t=H(),o=e.data.modelFqn;return o?n.jsx(dc,{...e,onClick:a=>{a.stopPropagation(),t.openElementDetails(o,e.id)}}):null}function o0(e){const{enableElementTags:t,enableElementDetails:o,enableReadOnly:a,enableCompareWithLatest:i}=Z();return n.jsxs(ao,{nodeProps:e,children:[i&&n.jsx(ro,{nodeProps:e}),n.jsx(io,{...e}),n.jsx(Ge,{...e}),t&&n.jsx(Ao,{...e}),n.jsx(Sc,{...e}),o&&n.jsx(cr,{...e}),!a&&n.jsx(e0,{...e}),n.jsx(zo,{})]})}function n0(e){const{enableElementTags:t,enableElementDetails:o,enableReadOnly:a,enableCompareWithLatest:i}=Z();return n.jsxs(ao,{nodeProps:e,children:[i&&n.jsx(ro,{nodeProps:e}),n.jsx(io,{...e}),n.jsx(Ge,{...e}),t&&n.jsx(Ao,{...e}),n.jsx(Yx,{...e}),o&&n.jsx(cr,{...e}),!a&&n.jsx(t0,{...e}),n.jsx(zo,{})]})}const ur=x({outlineColor:"likec4.compare.manual.outline",outlineWidth:"4px",outlineStyle:"dashed",outlineOffset:"1.5"}),pr=e=>e.data.drifts&&e.data.drifts.length>0;function a0(e){const{enableElementDetails:t,enableReadOnly:o,enableCompareWithLatest:a}=Z(),i=a&&pr(e);return n.jsxs(Ro,{className:i?ur:void 0,nodeProps:e,children:[a&&n.jsx(ro,{nodeProps:e}),n.jsx(Do,{...e}),n.jsx(Cc,{...e}),t&&n.jsx(Nc,{...e}),!o&&n.jsx(Qx,{...e}),n.jsx(zo,{})]})}function i0(e){const{enableElementDetails:t,enableReadOnly:o,enableCompareWithLatest:a}=Z(),i=a&&pr(e);return n.jsxs(Ro,{className:i?ur:void 0,nodeProps:e,children:[a&&n.jsx(ro,{nodeProps:e}),n.jsx(Do,{...e}),n.jsx(Cc,{...e}),t&&n.jsx(Nc,{...e}),!o&&n.jsx(Jx,{...e}),n.jsx(zo,{})]})}function r0(e){const{enableCompareWithLatest:t}=Z(),o=t&&pr(e);return n.jsxs(Ro,{className:o?ur:void 0,nodeProps:e,children:[t&&n.jsx(ro,{nodeProps:e}),n.jsx(Do,{...e}),n.jsx(zo,{})]})}const s0={left:ge.Left,right:ge.Right,top:ge.Top,bottom:ge.Bottom},l0=({data:e,port:t})=>n.jsxs(n.Fragment,{children:[n.jsx(U,{"data-likec4-color":e.color,className:x({position:"absolute",backgroundColor:"var(--likec4-palette-fill)",rounded:"xs",width:{base:"5px",_whenHovered:"7px",_whenSelected:"7px"},transition:"fast",translateX:"-1/2",translateY:"-1/2",translate:"auto"}),style:{top:t.cy,left:t.cx,height:t.height}}),n.jsx(He,{id:t.id,type:t.type,position:s0[t.position],style:{top:t.cy-3,left:t.cx-3,width:6,height:6,right:"unset",bottom:"unset",visibility:"hidden",transform:t.position==="left"?"translate(-150%, 0)":"translate(100%, 0)"}})]}),d0=e=>ye(e.modelFqn);function c0(e){const{enableElementDetails:t,enableCompareWithLatest:o}=Z(),a=e.data,{id:i,positionAbsoluteY:r,data:{viewHeight:s,hovered:l=!1,ports:d}}=e;return n.jsxs(n.Fragment,{children:[n.jsx(U,{"data-likec4-color":"gray",className:x({position:"absolute",rounded:"xs",top:"1",pointerEvents:"none",transition:"fast",translateX:"-1/2",translate:"auto"}),style:{backgroundColor:"var(--likec4-palette-stroke)",opacity:l?.6:.4,left:"50%",width:l?3:2,height:s-r,zIndex:-1,pointerEvents:"none"}}),n.jsxs(ao,{nodeProps:e,children:[o&&n.jsx(ro,{nodeProps:e}),n.jsx(io,{...e}),n.jsx(Ge,{...e}),d0(a)&&n.jsxs(n.Fragment,{children:[n.jsx(Sc,{...e,data:a}),t&&n.jsx(cr,{id:i,data:a})]})]}),d.map(u=>n.jsx(l0,{port:u,data:e.data},u.id))]})}function u0(e){return n.jsx(U,{"data-likec4-color":e.data.color,css:{width:"100%",height:"100%",border:"default",rounded:"sm",borderWidth:1,"--_color":{base:"var(--likec4-palette-stroke)",_dark:"[color-mix(in oklab, var(--likec4-palette-hiContrast) 40%, var(--likec4-palette-fill))]"},borderColor:"[var(--_color)/30]",backgroundColor:"var(--likec4-palette-fill)/15",pointerEvents:"none",paddingLeft:"2",paddingTop:"0.5",fontSize:"xs",fontWeight:"bold",letterSpacing:".75px",color:"[var(--_color)/75]"},children:"PARALLEL"})}const Zo="--_blur",Uo="--_opacity",p0="--_level",Cn=h.forwardRef(({onClose:e,className:t,classes:o,overlayLevel:a=0,children:i,fullscreen:r=!1,withBackdrop:s=!0,backdrop:l,openDelay:d=130,...u},c)=>{const[p,g]=h.useState(d===0),m=Ou(p),y=h.useRef(null),w=h.useRef(!1),C=Sl()!==!0,b=h.useRef(e);b.current=e;const v=ki(()=>{w.current||(w.current=!0,b.current())},[],50);h.useLayoutEffect(()=>{y.current?.open||y.current?.showModal()},[]),un(()=>{g(!0)},d>0?d:void 0);const j=Ty({fullscreen:r,withBackdrop:s});let f=a>0?"50%":"60%";return l?.opacity!==void 0&&(f=`${l.opacity*100}%`),n.jsx(Be.dialog,{ref:ji(y,m,c),className:P(o?.dialog,t,j,r&&pn.classNames.fullWidth),layout:!0,style:{[p0]:a},...C?{initial:{[Zo]:"0px",[Uo]:"0%",scale:.85,opacity:0},animate:{[Zo]:a>0?"4px":"8px",[Uo]:f,scale:1,opacity:1,translateY:0},exit:{opacity:0,scale:.98,translateY:-20,[Zo]:"0px",[Uo]:"0%"}}:{initial:{[Zo]:"8px",[Uo]:f}},onClick:k=>{if(k.stopPropagation(),k.target?.nodeName?.toUpperCase()==="DIALOG"){y.current?.close();return}},onCancel:k=>{k.preventDefault(),k.stopPropagation(),v()},onDoubleClick:ae,onPointerDown:ae,onClose:k=>{k.stopPropagation(),v()},...u,children:n.jsx(pn,{forwardProps:!0,children:n.jsx("div",{className:P(o?.body,"likec4-overlay-body"),children:p&&n.jsx(n.Fragment,{children:i})})})})});Cn.displayName="Overlay";function g0({children:e}){const t=h.useContext(Yi);if(!t)throw new Error("PortalToContainer must be used within RootContainer");return n.jsx(bi,{target:t.ref.current??`#${t.id}`,children:e})}const h0=h.memo(e=>{const{projects:t,onProjectChange:o}=zx(),a=$x();return t.length<=1?null:n.jsxs(te,{gap:"0.5",alignItems:"baseline",children:[n.jsx(U,{css:{fontWeight:"400",fontSize:"xxs",color:"likec4.panel.text.dimmed",userSelect:"none"},children:"Project"}),n.jsxs(Fe,{withinPortal:!1,shadow:"md",position:"bottom-start",offset:{mainAxis:2},children:[n.jsx(_l,{children:n.jsx(Ce,{tabIndex:-1,autoFocus:!1,variant:"subtle",size:"compact-xs",color:"gray",classNames:{root:x({fontWeight:"400",fontSize:"xxs",height:"auto",lineHeight:1.1,color:{_light:"mantine.colors.gray[9]"}}),section:x({'&:is([data-position="right"])':{marginInlineStart:"1"}})},rightSection:n.jsx(zi,{opacity:.5,size:12,stroke:1.5}),children:a})}),n.jsx(Pl,{children:t.map(({id:i,title:r})=>n.jsx(Ml,{onClick:s=>{if(a===i){s.stopPropagation();return}o(i)},children:r??i},i))})]})]})}),Ec=Nl({siblingSelector:"[data-likec4-focusable]",parentSelector:"[data-likec4-breadcrumbs-dropdown]",activateOnFocus:!1,loop:!0,orientation:"vertical"});function m0(e){return e.context.searchQuery.trim().length>=2}const Ic=h.memo(()=>{const e=Io(),t=rr(m0);Ne("paneClick",()=>{e.closeDropdown()}),Ne("nodeClick",()=>{e.closeDropdown()}),Ne("edgeClick",()=>{e.closeDropdown()});const o=Hu(a=>{e.send({type:"searchQuery.change",value:a})},250);return n.jsxs(Kt,{className:P("nowheel",No({layerStyle:"likec4.dropdown",gap:"xs",pointerEvents:"all"})),"data-likec4-breadcrumbs-dropdown":!0,onMouseLeave:()=>e.send({type:"dropdown.mouseLeave"}),onMouseEnter:()=>e.send({type:"dropdown.mouseEnter"}),children:[n.jsx(h0,{}),n.jsx(te,{gap:"xs",children:n.jsx(P0,{defaultValue:e.actorRef.getSnapshot().context.searchQuery,onChange:o})}),n.jsx(qe,{scrollbars:"x",type:"auto",offsetScrollbars:"present",classNames:{root:x({maxWidth:["calc(100vw - 50px)","calc(100cqw - 50px)"]})},styles:{viewport:{overscrollBehavior:"none"}},children:t?n.jsx(x0,{}):n.jsx(C0,{})})]})});Ic.displayName="NavigationPanelDropdown";function f0(e){return bl(e.context.searchQuery)}const y0=Su(Fa),x0=h.memo(()=>{const e=Se(),t=Io(),o=re(t.actorRef,f0),a=h.useDeferredValue(o),i=a.includes(Fa),r=i?a.split(Fa):a,[s,l]=h.useState([]);return h.useEffect(()=>{l(d=>{const u=se(e.views(),fl(c=>i&&c.$view.title?bl(c.$view.title).toLowerCase().includes(a):c.id.toLowerCase().includes(a)||!!c.title?.toLowerCase().includes(a)),ku(20),Wa(),Xu((c,p)=>y0(c.folder.path,p.folder.path)));return oe(u,d)?d:u})},[e,a,i]),s.length===0?n.jsx("div",{children:"no results"}):n.jsx(qe,{scrollbars:"xy",offsetScrollbars:!1,className:x({width:"100%",maxWidth:["calc(100vw - 250px)","calc(100cqw - 250px)"],maxHeight:["calc(100vh - 200px)","calc(100cqh - 200px)"]}),children:n.jsx(Rt,{gap:"0.5",children:s.map(d=>n.jsx(w0,{view:d,highlight:r,onClick:u=>{u.stopPropagation(),t.selectView(d.id)},"data-likec4-focusable":!0,onKeyDown:Ec},d.id))})})}),b0=me({gap:"xxs",rounded:"sm",px:"xs",py:"xxs",_hover:{backgroundColor:{base:"mantine.colors.gray[1]",_dark:"mantine.colors.dark[5]"}},_focus:{outline:"none",color:"mantine.colors.primary.lightColor!",backgroundColor:"mantine.colors.primary.lightHover!"}}),Fs=x({_groupFocus:{color:"[inherit!]",transition:"none"}});function w0({view:e,highlight:t,...o}){const a=e.folder,i=Dc[e.id==="index"?"index":e._type],r=n.jsx(vt,{component:"div",className:P(Fs,kn({truncate:!0}),x({"& > mark":{backgroundColor:{base:"mantine.colors.yellow[2]/90",_dark:"mantine.colors.yellow[5]/80",_groupFocus:"[transparent]"},color:{_groupFocus:"[inherit!]"}}})),maw:350,highlight:t,children:e.title??e.id},e.id),s=P(o.className,"group",b0);if(a.isRoot)return n.jsxs(de,{...o,className:s,children:[i,r]});const l=a.breadcrumbs.map(d=>n.jsx(vt,{component:"div",className:P(x({_groupHover:{color:"mantine.colors.dimmed"}}),Fs,kn({dimmed:!0,truncate:!0})),maw:170,highlight:qa(t)?t:[],children:d.title},d.path));return l.push(n.jsxs(te,{gap:"[4px]",children:[i,r]})),n.jsxs(de,{...o,className:s,children:[Rc,n.jsx(jl,{separator:n.jsx(gt,{size:12,stroke:1.5}),separatorMargin:3,children:l})]})}const v0=n.jsx(gt,{size:12,stroke:1.5,className:"mantine-rotate-rtl"}),Rc=n.jsx(im,{size:16,className:x({opacity:{base:.3,_groupHover:.5,_groupActive:.5,_groupFocus:.5}})}),Ko=x({opacity:{base:.3,_dark:.5,_groupHover:.8,_groupActive:.8,_groupFocus:.8}}),Dc={index:n.jsx(mm,{size:16,className:Ko}),element:n.jsx($e,{size:18,stroke:2,className:Ko}),deployment:n.jsx(Wi,{size:16,stroke:1.5,className:Ko}),dynamic:n.jsx(nm,{size:18,className:Ko})},k0=qe.withProps({scrollbars:"y",className:x({maxHeight:["calc(100vh - 160px)","calc(100cqh - 160px)"]})});function Ws(e,t){return{folderPath:e.path,items:[...e.folders.map(o=>({type:"folder",folderPath:o.path,title:o.title,selected:t.selectedFolder.startsWith(o.path)})),...e.views.map(o=>({type:"view",viewType:o.id==="index"?"index":o._type,viewId:o.id,title:o.title??o.id,description:o.description.nonEmpty&&o.description.text||null,selected:o.id===t.viewModel?.id}))]}}const j0=e=>{const t=e.viewModel;if(!t)return[];const o=t.$model,a=[Ws(o.rootViewFolder,e)],i=o.viewFolder(e.selectedFolder);if(!i.isRoot)for(const r of i.breadcrumbs)a.push(Ws(r,e));return a},C0=h.memo(()=>{const e=ox(j0,I);return n.jsx(te,{gap:"xs",alignItems:"stretch",children:e.flatMap((t,o)=>[o>0&&n.jsx(ko,{orientation:"vertical"},"divider"+o),n.jsx(S0,{data:t,isLast:o>0&&o==e.length-1},t.folderPath)])})});function S0({data:e,isLast:t}){const o=h.useRef(null),a=ir(),i=r=>s=>{s.stopPropagation(),r.type==="folder"?a.send({type:"select.folder",folderPath:r.folderPath}):a.send({type:"select.view",viewId:r.viewId})};return qu(()=>{t&&o.current&&o.current.scrollIntoView({block:"nearest",inline:"nearest",behavior:"smooth"})}),n.jsx(U,{mb:"1",ref:o,children:n.jsx(k0,{children:n.jsx(Rt,{gap:"0.5",children:e.items.map((r,s)=>n.jsx(_0,{columnItem:r,onClick:i(r)},`${e.folderPath}/${r.type}/${s}`))})})})}function _0({columnItem:e,...t}){switch(e.type){case"folder":return n.jsx(di,{variant:"light",active:e.selected,label:e.title,leftSection:Rc,rightSection:v0,maw:"300px",miw:"200px",...t},e.folderPath);case"view":return n.jsx(di,{variant:"filled",active:e.selected,label:e.title,description:e.description,leftSection:Dc[e.viewType],maw:"300px",miw:"200px",...t},e.viewId);default:Le(e)}}function P0(e){const[t,o]=Cl({...e,finalValue:""});return n.jsx(Ya,{size:"xs",placeholder:"Search by title or id",variant:"unstyled",height:ot(26),value:t,onKeyDown:Ec,onChange:a=>o(a.currentTarget.value),"data-likec4-focusable":!0,classNames:{wrapper:x({flexGrow:1,backgroundColor:{base:"mantine.colors.gray[1]",_dark:"mantine.colors.dark[5]/80",_hover:{base:"mantine.colors.gray[2]",_dark:"mantine.colors.dark[4]"},_focus:{base:"mantine.colors.gray[2]",_dark:"mantine.colors.dark[4]"}},rounded:"sm"}),input:x({_placeholder:{color:"mantine.colors.dimmed"},_focus:{outline:"none"}})},style:{"--input-fz":"var(--mantine-font-size-sm)"},leftSection:n.jsx(Vi,{size:14}),rightSectionPointerEvents:"all",rightSectionWidth:"min-content",rightSection:!e.value||_t(e.value)?null:n.jsx(Ce,{variant:"subtle",h:"100%",size:"compact-xs",color:"gray",onClick:a=>{a.stopPropagation(),o("")},children:"clear"})})}const M0=mt("div",{base:{fontSize:"xs",color:"mantine.colors.dimmed",fontWeight:500,userSelect:"none",mb:"xxs"}});function N0(e){const t=tg(e.activeWalkthrough),o=t?e.xyedges.findIndex(a=>a.id===e.activeWalkthrough?.stepId):-1;return{isActive:t,isParallel:t&&ye(e.activeWalkthrough?.parallelPrefix),hasNext:t&&o<e.xyedges.length-1,hasPrevious:t&&o>0,notes:t?e.xyedges[o]?.data?.notes??null:null}}const E0=h.memo(()=>{const{isActive:e,notes:t}=ze(N0),o=t?ln.from(t):ln.EMPTY;return n.jsx(he,{children:e&&!o.isEmpty&&n.jsx(Be.div,{layout:"position",className:x({position:"relative"}),initial:{opacity:0,translateX:-20},animate:{opacity:1,translateX:0},exit:{opacity:0,translateX:-20},children:n.jsxs(qe,{className:No({position:"absolute",layerStyle:"likec4.dropdown",gap:"sm",padding:"md",paddingTop:"xxs",pointerEvents:"all",maxWidth:"calc(100cqw - 32px)",minWidth:"calc(100cqw - 50px)",maxHeight:"calc(100cqh - 100px)",width:"max-content",cursor:"default",overflow:"auto",overscrollBehavior:"contain","@/sm":{minWidth:400,maxWidth:550},"@/lg":{maxWidth:700}}),type:"scroll",children:[n.jsx(M0,{children:"Notes"}),n.jsx(Nt,{value:o,fontSize:"sm",emptyText:"No description",className:x({userSelect:"all"})})]})})})}),Bc=h.memo(()=>{const e=H(),t=wf(),o=vf(),a=_i(Cf,{input:{view:t,viewModel:o}});return h.useEffect(()=>{const i=a.on("navigateTo",r=>{e.navigateTo(r.viewId)});return()=>i.unsubscribe()},[a,e]),h.useEffect(()=>{a.send({type:"update.inputs",inputs:{viewModel:o,view:t}})},[o,t]),n.jsx(Rt,{css:{alignItems:"flex-start",pointerEvents:"none",position:"absolute",top:"0",left:"0",margin:"0",width:"100%",gap:"xxs",maxWidth:["calc(100vw)","calc(100cqw)"],"@/sm":{margin:"xs",gap:"xs",width:"max-content",maxWidth:["calc(100vw - 2 * {spacing.md})","calc(100cqw - 2 * {spacing.md})"]},_print:{display:"none"}},children:n.jsxs(tx,{value:a,children:[n.jsx(I0,{actor:a}),n.jsx(rc,{}),n.jsx(E0,{}),n.jsx(ex,{})]})})});Bc.displayName="NavigationPanel";const I0=({actor:e})=>{const t=re(e,a=>a.hasTag("active")),o=no();return n.jsxs(st,{offset:{mainAxis:4},opened:t,position:"bottom-start",trapFocus:t,...o,clickOutsideEvents:["pointerdown","mousedown","click"],onDismiss:()=>e.send({type:"dropdown.dismiss"}),children:[n.jsx(R0,{actor:e}),t&&n.jsx(Ic,{})]})},R0=({actor:e})=>{const t=ze(o=>o.activeWalkthrough!==null);return n.jsx(qt,{children:n.jsx(Ut,{children:n.jsx(ee,{layout:!0,layoutDependency:t,className:me({layerStyle:"likec4.panel",position:"relative",gap:"xs",cursor:"pointer",pointerEvents:"all",width:"100%"}),onMouseLeave:()=>e.send({type:"breadcrumbs.mouseLeave"}),children:n.jsx(he,{children:t?n.jsx(Hx,{}):n.jsx(jc,{})})})})})},gr=h.createContext(null);gr.displayName="ElementDetailsActorContext";const D0=()=>{const e=h.useContext(gr);if(e===null)throw new Error("ElementDetailsActorRef is not provided");return e},nn="--_blur",an="--_opacity",B0=x({boxSizing:"border-box",margin:"0",padding:"0",position:"fixed",inset:"0",width:"100vw",height:"100vh",maxWidth:"100vw",maxHeight:"100vh",background:"transparent",border:"transparent",_backdrop:{backdropFilter:"auto",backdropBlur:`var(${nn})`,backgroundColor:`[rgb(36 36 36 / var(${an}, 5%))]`}}),L0=x({position:"absolute",pointerEvents:"all",display:"flex",flexDirection:"column",padding:"4",gap:"lg",justifyContent:"stretch",color:"mantine.colors.text",backgroundColor:{base:"mantine.colors.body",_dark:"mantine.colors.dark[6]"},boxShadow:"md",overflow:"hidden",border:"none",backgroundImage:`
    linear-gradient(180deg,
      color-mix(in oklab, var(--likec4-palette-fill) 60%, transparent),
      color-mix(in oklab, var(--likec4-palette-fill) 20%, transparent) 8px,
      color-mix(in oklab, var(--likec4-palette-fill) 14%, transparent) 20px,
      transparent 80px
    ),
    linear-gradient(180deg, var(--likec4-palette-fill), var(--likec4-palette-fill) 4px, transparent 4px)
  `,"& .react-flow__attribution":{display:"none"}}),T0=x({flex:0,cursor:"move"}),A0=x({display:"block",fontFamily:"likec4.element",fontOpticalSizing:"auto",fontStyle:"normal",fontWeight:600,fontSize:"24px",lineHeight:"xs"}),Ma="40px",z0=x({flex:`0 0 ${Ma}`,height:Ma,width:Ma,display:"flex",alignItems:"center",justifyContent:"center",alignSelf:"flex-start",cursor:"move",_dark:{mixBlendMode:"hard-light"},"& :where(svg, img)":{width:"100%",height:"auto",maxHeight:"100%",pointerEvents:"none",filter:`
    drop-shadow(0 0 3px rgb(0 0 0 / 10%))
    drop-shadow(0 1px 8px rgb(0 0 0 / 5%))
    drop-shadow(1px 1px 16px rgb(0 0 0 / 2%))
  `},"& img":{objectFit:"contain"}}),rn="--view-title-color",Qo="--icon-color",$0=x({width:"100%",background:"mantine.colors.body",borderRadius:"sm",padding:"[10px 8px]",transition:"fast",border:"1px dashed",borderColor:"mantine.colors.defaultBorder",[rn]:"{colors.mantine.colors.dark[1]}",_hover:{background:"mantine.colors.defaultHover",[Qo]:"{colors.mantine.colors.dark[1]}",[rn]:"{colors.mantine.colors.defaultColor}"},_dark:{background:"mantine.colors.dark[6]"},_light:{[Qo]:"{colors.mantine.colors.gray[6]}",[rn]:"{colors.mantine.colors.gray[7]}",_hover:{[Qo]:"{colors.mantine.colors.gray[7]}"}},"& .mantine-ThemeIcon-root":{transition:"fast",color:`[var(${Qo}, {colors.mantine.colors.dark[2]})]`,"--ti-size":"22px",_hover:{color:"mantine.colors.defaultColor"}},"& > *":{transition:"all 130ms {easings.inOut}"},"&:hover > *":{transitionTimingFunction:"out",transform:"translateX(1.6px)"}}),V0=x({transition:"fast",color:`[var(${rn}, {colors.mantine.colors.gray[7]})]`,fontSize:"15px",fontWeight:500,lineHeight:"1.4"}),F0=x({flex:1,display:"flex",flexDirection:"column",justifyContent:"stretch",overflow:"hidden",gap:"sm"}),W0=x({background:"mantine.colors.gray[1]",borderRadius:"sm",flexWrap:"nowrap",gap:"1.5",padding:"1",_dark:{background:"mantine.colors.dark[7]"}}),O0=x({fontSize:"xs",fontWeight:500,flexGrow:1,padding:"[6px 8px]",transition:"fast",borderRadius:"sm",color:"mantine.colors.gray[7]",_hover:{transitionTimingFunction:"out",color:"mantine.colors.defaultColor",background:"mantine.colors.gray[3]"},"&[data-active]":{transition:"none",background:"mantine.colors.white",shadow:"xs",color:"mantine.colors.defaultColor"},_dark:{color:"mantine.colors.dark[1]",_hover:{color:"mantine.colors.white",background:"mantine.colors.dark[6]"},"&:is([data-active])":{color:"mantine.colors.white",background:"mantine.colors.dark[5]"}}}),H0=x({flex:1,overflow:"hidden",position:"relative","&:not(:has(.mantine-ScrollArea-root))":{paddingLeft:"1",paddingRight:"1"},"& .mantine-ScrollArea-root":{width:"100%",height:"100%","& > div":{paddingLeft:"1",paddingRight:"1"}}}),X0=x({flex:1,display:"grid",gridTemplateColumns:"min-content 1fr",gridAutoRows:"min-content max-content",gap:"[24px 20px]",alignItems:"baseline",justifyItems:"stretch"}),q0=x({justifySelf:"end",textAlign:"right",userSelect:"none"}),Y0=x({position:"absolute",width:"14px",height:"14px",border:"3.5px solid",borderColor:"mantine.colors.dark[3]",borderTop:"none",borderLeft:"none",borderRadius:"2px",bottom:"0.5",right:"0.5",transition:"fast",cursor:"se-resize",_hover:{borderWidth:"4px",borderColor:"mantine.colors.dark[1]"}});function Lc({children:e}){return n.jsx(n.Fragment,{children:e})}function Tc({value:e,isExpanded:t}){const[o,a]=h.useState(!1),i=h.useRef(null);return h.useEffect(()=>{i.current&&a(i.current.scrollWidth>i.current.clientWidth)},[e]),n.jsx(je,{label:o&&!t?e:null,multiline:!0,w:300,withinPortal:!0,children:n.jsx(L,{ref:i,component:"div",className:x({fontSize:"sm",padding:"xs",userSelect:"all",color:"mantine.colors.text",lineHeight:1.4,whiteSpace:t?"pre-wrap":"nowrap",overflow:t?"visible":"hidden",textOverflow:t?"unset":"ellipsis",wordBreak:t?"break-word":"normal",minWidth:0,width:"100%"}),children:e})})}function G0({values:e,isExpanded:t}){return t?n.jsx(Ee,{gap:"xs",children:e.map((o,a)=>n.jsxs(Pt,{align:"center",gap:"xs",children:[n.jsx(L,{className:x({fontSize:"xs",color:"mantine.colors.gray[5]",fontWeight:500,flexShrink:0,_dark:{color:"mantine.colors.dark[3]"}}),children:""}),n.jsx(q,{className:x({minHeight:"32px",display:"flex",alignItems:"center",flex:1}),children:n.jsx(Tc,{value:o,isExpanded:!0})})]},a))}):n.jsx(q,{className:x({minHeight:"32px",display:"flex",alignItems:"center",padding:"xs",gap:"xs",flexWrap:"wrap",minWidth:0,overflow:"hidden"}),children:e.map((o,a)=>n.jsxs(Pt,{align:"center",gap:"xs",style:{minWidth:0},children:[n.jsx(L,{className:x({fontSize:"sm",padding:"[4px 8px]",backgroundColor:"mantine.colors.white",color:"mantine.colors.text",borderRadius:"sm",border:"1px solid",borderColor:"mantine.colors.gray[3]",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"min(200px, 100%)",minWidth:"60px",flex:"0 1 auto",userSelect:"all",_dark:{backgroundColor:"mantine.colors.dark[9]",color:"mantine.colors.text",borderColor:"mantine.colors.dark[4]"}}),title:o,children:o}),a<e.length-1&&n.jsx(L,{className:x({fontSize:"xs",color:"mantine.colors.gray[5]",fontWeight:500,flexShrink:0,_dark:{color:"mantine.colors.dark[3]"}}),children:""})]},a))})}function Z0({label:e,value:t}){const o=Array.isArray(t)?t:typeof t=="string"&&t.includes(`
`)?t.split(`
`).map(s=>s.trim()).filter(Boolean):[t],a=o.length>1,[i,r]=h.useState(!1);return n.jsxs(n.Fragment,{children:[a?n.jsx(de,{onClick:()=>{r(!i)},className:x({fontSize:"xs",color:"mantine.colors.dimmed",justifySelf:"end",textAlign:"right",userSelect:"none",display:"flex",alignItems:"center",justifyContent:"flex-end",gap:"xs",padding:"[4px 8px]",borderRadius:"sm",whiteSpace:"nowrap",transition:"all 150ms ease",_hover:{backgroundColor:"mantine.colors.gray[1]",color:"mantine.colors.primary[6]",_dark:{backgroundColor:"mantine.colors.dark[7]",color:"mantine.colors.primary[4]"}}}),children:n.jsxs(Pt,{align:"center",gap:"xs",children:[n.jsxs(L,{component:"span",size:"xs",fw:700,children:[e,":"]}),n.jsx(L,{component:"span",className:x({fontSize:"xs",fontWeight:500,color:"mantine.colors.gray[6]",backgroundColor:"mantine.colors.gray[1]",padding:"[1px 4px]",borderRadius:"xs",_dark:{color:"mantine.colors.dark[2]",backgroundColor:"mantine.colors.dark[6]"}}),children:o.length}),i?n.jsx(zi,{size:12}):n.jsx(gt,{size:12})]})}):n.jsxs(L,{component:"div",className:x({fontSize:"xs",color:"mantine.colors.dimmed",justifySelf:"end",textAlign:"right",userSelect:"none",whiteSpace:"nowrap",padding:"[4px 8px]",fontWeight:700}),children:[e,":"]}),n.jsx(q,{className:x({justifySelf:"stretch",alignSelf:"start"}),children:a?n.jsx(G0,{values:o,isExpanded:i}):n.jsx(q,{className:x({minHeight:"32px",display:"flex",alignItems:"center"}),children:n.jsx(Tc,{value:o[0]||"",isExpanded:i})})})]})}const U0=x({"&[data-level='1']":{marginBottom:"sm"}}),K0=x({cursor:"default",marginTop:"0",marginBottom:"0"}),Ac=x({transition:"fast",color:"mantine.colors.gray[7]",_dark:{color:"mantine.colors.dark[1]"},"& > *":{transition:"fast"},_hover:{transitionTimingFunction:"out","& > :not([data-no-transform])":{transitionTimingFunction:"out",transform:"translateX(1px)"}}}),Q0=P(Ac),J0=P(Ac,x({cursor:"pointer",width:"100%",justifyContent:"stretch",flexWrap:"nowrap",height:"36px",paddingInlineStart:"[16px]",paddingInlineEnd:"2.5",borderRadius:"sm",alignItems:"center",color:"mantine.colors.gray[7]",_dark:{color:"mantine.colors.gray.lightColor"},_hover:{background:"mantine.colors.gray.lightHover"},"& .tabler-icon":{transition:"fast",width:"90%",opacity:.65}})),e1=({node:e})=>n.jsxs(ce,{className:Q0,gap:6,align:"baseline",wrap:"nowrap",children:[n.jsxs(L,{component:"div",fz:11,c:"dimmed",children:[e.kind,":"]}),n.jsx(L,{component:"div",fz:"sm",fw:"500",children:e.title})]}),t1=({instance:e})=>{const t=H(),o=t.currentView.id,a=[...e.views()];return n.jsxs(ce,{className:J0,gap:4,children:[n.jsx(Xe,{color:"gray",variant:"transparent",size:"xs",flex:0,children:n.jsx(Uh,{stroke:1.2})}),n.jsx(L,{component:"div",fz:"sm",fw:"500",flex:"1 1 100%",children:e.title}),n.jsxs(q,{onClick:ae,pos:"relative","data-no-transform":!0,flex:0,children:[a.length===0&&n.jsx(Ce,{size:"compact-xs",variant:"transparent",color:"gray",disabled:!0,children:"no views"}),a.length>0&&n.jsxs(Fe,{shadow:"md",withinPortal:!1,position:"bottom-start",offset:0,closeOnClickOutside:!0,clickOutsideEvents:["pointerdown","mousedown","click"],closeOnEscape:!0,trapFocus:!0,children:[n.jsx(Fe.Target,{children:n.jsxs(Ce,{size:"compact-xs",variant:"subtle",color:"gray",children:[a.length," view",a.length>1?"s":""]})}),n.jsx(Fe.Dropdown,{children:a.map(i=>n.jsx(Fe.Item,{px:"xs",py:4,disabled:i.id===o,leftSection:n.jsx(Xe,{size:"sm",variant:"transparent",color:"gray",children:n.jsx($e,{stroke:1.8,opacity:.65})}),styles:{itemSection:{marginInlineEnd:ot(8)}},onClick:r=>{r.stopPropagation(),t.navigateTo(i.id)},children:i.title},i.id))})]})]})]})},o1=()=>{},n1=h.memo(({elementFqn:e})=>{const t=Se().element(e),o=[...t.deployments()],a=Dn({multiple:!1});a.setHoveredNode=o1;const i=h.useMemo(()=>{let r=[],s=new Map;for(const l of t.deployments()){let d={label:n.jsx(t1,{instance:l}),value:l.id,type:"instance",children:[]};s.set(l.id,d);let u=l.parent;for(;u;){let c=s.get(u.id);if(c){c.children.push(d);break}c={label:n.jsx(e1,{node:u}),value:u.id,type:"node",children:[d]},s.set(u.id,c),d=c,u=u.parent}!u&&!r.includes(d)&&r.push(d)}return r},[t]);return h.useEffect(()=>{a.expandAllNodes()},[i]),o.length===0?n.jsx(El,{variant:"light",color:"gray",icon:n.jsx(Po,{}),children:"This element does not have any deployments"}):n.jsx(Bn,{levelOffset:"sm",allowRangeSelection:!1,classNames:{node:U0,label:K0},styles:{root:{position:"relative",width:"min-content",minWidth:300}},data:i,tree:a,renderNode:({node:r,selected:s,elementProps:l,hasChildren:d})=>n.jsx(q,{...l,style:{...!d&&{marginBottom:ot(4)}},children:d?n.jsx(Ce,{fullWidth:!0,color:"gray",variant:s?"transparent":"subtle",size:"xs",justify:"flex-start",styles:{root:{position:"unset",paddingInlineStart:ot(16)}},children:r.label}):r.label})})}),zc=h.createContext(null);function $c(){return W(h.useContext(zc),"No RelationshipsBrowserActorContext")}function na(e,t=oe){const o=$c();return re(o,e,t)}function $o(){const e=$c();return h.useMemo(()=>({actor:e,get rootElementId(){return`relationships-browser-${e.sessionId.replaceAll(":","_")}`},getState:()=>e.getSnapshot().context,send:e.send,updateView:t=>{e.getSnapshot().status==="active"&&e.send({type:"update.view",layouted:t})},changeScope:t=>{e.send({type:"change.scope",scope:t})},navigateTo:(t,o)=>{e.send({type:"navigate.to",subject:t,fromNode:o})},fitDiagram:()=>{e.send({type:"fitDiagram"})},close:()=>{e._parent?e._parent?.send({type:"close",actorId:e.id}):e.send({type:"close"})}}),[e])}const a1=lr(e=>{const t=$o(),{enableNavigateTo:o}=Z(),{data:{navigateTo:a,relations:i,existsInCurrentView:r}}=e,[s,l,d]=zl(e),u=H(),c=i.length>1||!r,p=c?{...e,data:{...e.data,line:"solid",color:"amber"}}:e;let g=n.jsx(Lo,{edgeProps:p,className:x({transition:"fast"}),children:o&&a&&n.jsx(Gn,{...e,onClick:m=>{m.stopPropagation(),u.navigateTo(a)}})});return r||(g=n.jsx(je,{color:"orange",c:"black",label:"This relationship is not included in the current view",portalProps:{target:`#${t.rootElementId}`},openDelay:800,children:g})),n.jsxs(Bo,{...p,children:[n.jsx(To,{edgeProps:p,svgPath:s,...c&&{strokeWidth:5}}),n.jsx(Zn,{edgeProps:p,labelPosition:{x:l,y:d,translate:"translate(-50%, 0)"},style:{maxWidth:Math.min(Math.abs(e.targetX-e.sourceX-70),250)},children:g})]})}),i1=x({width:"100%",height:"100%",border:"3px dashed",borderColor:"mantine.colors.defaultBorder",borderRadius:"md",display:"flex",justifyContent:"center",alignItems:"center"});function r1({data:{column:e}}){return n.jsx(q,{className:i1,children:n.jsxs(L,{c:"dimmed",fz:"lg",fw:500,children:["No ",e==="incomers"?"incoming":"outgoing"]})})}const s1=e=>e.context.subject,l1=e=>{const{enableNavigateTo:t,enableVscode:o}=Z(),a=H(),i=Xn(),r=$o(),s=na(s1),{navigateTo:l,fqn:d}=e.data,u=h.useMemo(()=>{const c=[];return l&&t&&i!==l&&c.push({key:"navigate",icon:n.jsx($e,{}),onClick:p=>{p.stopPropagation(),a.navigateTo(l)}}),d!==s&&c.push({key:"relationships",icon:n.jsx(Mo,{}),onClick:p=>{p.stopPropagation(),r.navigateTo(d,e.id)}}),o&&c.push({key:"goToSource",icon:n.jsx(Jt,{}),onClick:p=>{p.stopPropagation(),a.openSource({element:d})}}),c},[l,t,i,d,s,o,a,r,e.id]);return n.jsx(Un,{buttons:u,...e})},d1=e=>{const t=H();return n.jsx(sr,{...e,onClick:o=>{o.stopPropagation(),t.openElementDetails(e.data.fqn)}})};function c1(e){const{enableElementTags:t}=Z();return n.jsxs(ao,{layoutId:e.id,nodeProps:e,children:[n.jsx(io,{...e}),n.jsx(Ge,{...e}),t&&n.jsx(Ao,{...e}),n.jsx(d1,{...e}),n.jsx(l1,{...e}),n.jsx(p1,{...e})]},e.id)}function u1(e){const t=H();return n.jsxs(Ro,{layoutId:e.id,nodeProps:e,children:[n.jsx(Do,{...e}),n.jsx(dc,{...e,onClick:o=>{o.stopPropagation(),t.openElementDetails(e.data.fqn)}}),n.jsx(g1,{...e})]},e.id)}const p1=({data:{ports:e,height:t}})=>n.jsxs(n.Fragment,{children:[e.in.map((o,a)=>n.jsx(He,{id:o,type:"target",position:ge.Left,style:{visibility:"hidden",top:`${15+(a+1)*((t-30)/(e.in.length+1))}px`}},o)),e.out.map((o,a)=>n.jsx(He,{id:o,type:"source",position:ge.Right,style:{visibility:"hidden",top:`${15+(a+1)*((t-30)/(e.out.length+1))}px`}},o))]}),g1=({data:e})=>n.jsxs(n.Fragment,{children:[e.ports.in.map((t,o)=>n.jsx(He,{id:t,type:"target",position:ge.Left,style:{visibility:"hidden",top:`${20*(o+1)}px`}},t)),e.ports.out.map((t,o)=>n.jsx(He,{id:t,type:"source",position:ge.Right,style:{visibility:"hidden",top:`${20*(o+1)}px`}},t))]}),wo=(e,t)=>Cu(e.label,t.label);function ci(e){return{label:e.title,value:e.id,children:[...e.children()].map(ci).sort(wo)}}function h1(e){const t=Se();return h.useMemo(()=>e?[...t.view(e).roots()].map(ci).sort(wo):[...t.roots()].map(ci).sort(wo),[t,e??null])}const m1=x({margin:"0"}),f1=x({_hover:{backgroundColor:"mantine.colors.gray[0]",_dark:{backgroundColor:"mantine.colors.defaultHover",color:"mantine.colors.white"}}}),Vc=x({maxHeight:["70vh","calc(100cqh - 70px)"]}),y1=Object.freeze(Object.defineProperty({__proto__:null,label:f1,node:m1,scrollArea:Vc},Symbol.toStringTag,{value:"Module"})),x1=e=>{const t=e.context.layouted?.subjectExistsInScope??!1;return{subjectId:e.context.subject,viewId:e.context.viewId,scope:e.context.scope,subjectExistsInScope:t,enableSelectSubject:e.context.enableSelectSubject,enableChangeScope:e.context.enableChangeScope}},b1=()=>{},w1=h.memo(()=>{const e=$o(),{subjectId:t,viewId:o,scope:a,subjectExistsInScope:i,enableSelectSubject:r,enableChangeScope:s}=na(x1),l=h.useRef(null),d=h.useRef(null),u=Se().findElement(t),c=h1(a==="view"&&o?o:void 0),p=Dn({multiple:!1});return p.setHoveredNode=b1,h.useEffect(()=>{ju(t).reverse().forEach(g=>{p.expand(g)}),p.select(t)},[t]),n.jsxs(ce,{ref:l,gap:"xs",pos:"relative",children:[r&&n.jsxs(ce,{gap:4,wrap:"nowrap",children:[n.jsx(q,{fz:"xs",fw:"500",style:{whiteSpace:"nowrap",userSelect:"none"},children:"Relationships of"}),n.jsx(q,{pos:"relative",children:n.jsxs(st,{position:"bottom-start",shadow:"md",keepMounted:!1,withinPortal:!1,closeOnClickOutside:!0,clickOutsideEvents:["pointerdown","mousedown","click"],offset:4,onOpen:()=>{setTimeout(()=>{d.current?.querySelector(`[data-value="${t}"]`)?.scrollIntoView({behavior:"instant",block:"nearest"})},100)},children:[n.jsx(Ut,{children:n.jsx(Ce,{size:"xs",variant:"default",maw:250,rightSection:n.jsx(Fi,{size:16}),children:n.jsx(L,{fz:"xs",fw:"500",truncate:!0,children:u?.title??"???"})})}),n.jsx(Kt,{p:0,miw:250,maw:400,children:n.jsx(qe,{scrollbars:"y",type:"never",viewportRef:d,className:Vc,children:n.jsx(Bn,{allowRangeSelection:!1,selectOnClick:!1,tree:p,data:c,classNames:y1,levelOffset:8,styles:{root:{maxWidth:400,overflow:"hidden"},label:{paddingTop:5,paddingBottom:6}},renderNode:({node:g,selected:m,expanded:y,elementProps:w,hasChildren:C})=>n.jsxs(ce,{gap:2,wrap:"nowrap",...w,py:"3",children:[n.jsx(Q,{variant:"subtle",size:18,c:"dimmed",style:{visibility:C?"visible":"hidden"},children:n.jsx(gt,{stroke:3.5,style:{transition:"transform 150ms ease",transform:`rotate(${y?"90deg":"0"})`,width:"80%"}})}),n.jsx(q,{flex:"1 1 100%",w:"100%",onClick:b=>{b.stopPropagation(),p.select(g.value),p.expand(g.value),e.navigateTo(g.value)},children:n.jsx(L,{fz:"sm",fw:m?"600":"400",truncate:"end",children:g.label})})]})})})})]})})]}),s&&n.jsxs(ce,{gap:4,wrap:"nowrap",children:[r&&n.jsx(q,{fz:"xs",fw:"500",...!i&&{c:"dimmed"},style:{whiteSpace:"nowrap",userSelect:"none"},children:"Scope"}),n.jsx("div",{children:n.jsx(je,{color:"orange",label:n.jsxs(n.Fragment,{children:["This element does not exist in the current view",a==="view"&&n.jsxs(n.Fragment,{children:[n.jsx("br",{}),"Scope is set to global"]})]}),position:"bottom-start",disabled:i,portalProps:{target:l.current},children:n.jsx(Rn,{flex:"1 0 auto",size:"xs",withItemsBorders:!1,value:a,styles:{label:{paddingLeft:8,paddingRight:8}},onChange:g=>{e.changeScope(g)},data:[{label:"Global",value:"global"},{label:n.jsx("span",{children:"Current view"}),value:"view",disabled:!i}]})})})]})]})}),v1={element:c1,compound:u1,empty:r1},k1={relationship:a1};function Fc({actorRef:e}){const t=h.useRef(null);return t.current==null&&(t.current={initialNodes:[],initialEdges:[]}),n.jsx(zc.Provider,{value:e,children:n.jsx(Di,{...t.current,children:n.jsx(qt,{id:e.sessionId,inherit:!1,children:n.jsx(he,{children:n.jsx(S1,{})})})})})}const j1=e=>({isActive:e.hasTag("active"),nodes:e.context.xynodes,edges:e.context.xyedges}),C1=(e,t)=>e.isActive===t.isActive&&oe(e.nodes,t.nodes)&&oe(e.edges,t.edges),S1=h.memo(()=>{const e=$o(),{isActive:t,nodes:o,edges:a}=na(j1,C1);return n.jsx(Xi,{id:e.rootElementId,nodes:o,edges:a,className:P(t?"initialized":"not-initialized","relationships-browser"),nodeTypes:v1,edgeTypes:k1,fitView:!1,onNodeClick:D((i,r)=>{i.stopPropagation(),e.send({type:"xyflow.nodeClick",node:r})}),onEdgeClick:D((i,r)=>{i.stopPropagation(),e.send({type:"xyflow.edgeClick",edge:r})}),onPaneClick:D(i=>{i.stopPropagation(),e.send({type:"xyflow.paneClick"})}),onDoubleClick:D(i=>{e.send({type:"xyflow.paneDblClick"})}),onViewportResize:D(()=>{e.send({type:"xyflow.resized"})}),onNodesChange:D(i=>{e.send({type:"xyflow.applyNodeChanges",changes:i})}),onEdgesChange:D(i=>{e.send({type:"xyflow.applyEdgeChanges",changes:i})}),onEdgeMouseEnter:D((i,r)=>{r.data.hovered||e.send({type:"xyflow.edgeMouseEnter",edge:r})}),onEdgeMouseLeave:D((i,r)=>{r.data.hovered&&e.send({type:"xyflow.edgeMouseLeave",edge:r})}),onSelectionChange:D(i=>{e.send({type:"xyflow.selectionChange",...i})}),nodesDraggable:!1,nodesSelectable:!0,pannable:!0,zoomable:!0,children:n.jsx(P1,{})})}),_1=e=>({subjectId:e.context.subject,viewId:e.context.viewId,scope:e.context.scope,closeable:e.context.closeable}),P1=h.memo(()=>{const e=$o(),{subjectId:t,viewId:o,scope:a,closeable:i}=na(_1),r=Ln(),s=Pi();h.useEffect(()=>{s.viewportInitialized&&e.send({type:"xyflow.init",instance:s,store:r})},[r,s.viewportInitialized,e]);const l=Jf(t,o,a),[d,u,{history:c,current:p}]=Il(t);h.useEffect(()=>{d!==t&&u.set(t)},[t]),h.useEffect(()=>{d!==t&&e.navigateTo(d)},[d,e]),Rl(()=>{e.updateView(l)},[l,e]);const g=p>0,m=p+1<c.length;return n.jsxs(n.Fragment,{children:[n.jsx(M1,{hasStepBack:g,hasStepForward:m,onStepBack:()=>u.back(),onStepForward:()=>u.forward()}),i&&n.jsx(Tn,{position:"top-right",children:n.jsx(Q,{variant:"default",color:"gray",onClick:y=>{y.stopPropagation(),e.close()},children:n.jsx(eo,{})})})]})}),M1=({hasStepBack:e,hasStepForward:t,onStepBack:o,onStepForward:a})=>n.jsx(Tn,{position:"top-left",children:n.jsxs(ce,{gap:4,wrap:"nowrap",children:[n.jsxs(he,{mode:"popLayout",children:[e&&n.jsx(Be.div,{layout:!0,initial:{opacity:.05,transform:"translateX(-5px)"},animate:{opacity:1,transform:"translateX(0)"},exit:{opacity:.05,transform:"translateX(-10px)"},children:n.jsx(Q,{variant:"default",color:"gray",onClick:i=>{i.stopPropagation(),o()},children:n.jsx(cd,{})})},"back"),t&&n.jsx(Be.div,{layout:!0,initial:{opacity:.05,transform:"translateX(5px)"},animate:{opacity:1,transform:"translateX(0)"},exit:{opacity:0,transform:"translateX(5px)"},children:n.jsx(Q,{variant:"default",color:"gray",onClick:i=>{i.stopPropagation(),a()},children:n.jsx(gt,{})})},"forward")]}),n.jsx(w1,{})]})}),N1=x({display:"inline-block",fontSize:"sm",fontWeight:500,whiteSpace:"nowrap",padding:"[3px 6px]",borderRadius:3,background:"var(--likec4-palette-fill)/75",lineHeight:1.2,color:"var(--likec4-palette-hiContrast)"}),E1=x({_light:{background:"mantine.colors.gray[1]","&[data-missing":{}},"&[data-missing]":{color:"mantine.colors.orange[4]",background:"mantine.colors.orange[8]/15",borderColor:"mantine.colors.orange[5]/20",_light:{color:"mantine.colors.orange[8]"}}}),I1=x({flex:"1 1 100%",position:"relative",width:"100%",height:"100%",background:"mantine.colors.body",border:"1px solid {colors.mantine.colors.defaultBorder}",borderRadius:"sm",_light:{borderColor:"mantine.colors.gray[3]",background:"mantine.colors.gray[1]"}});x({_before:{content:'"scope:"',position:"absolute",top:"0",left:"2",fontSize:"xxs",fontWeight:500,lineHeight:"1",color:"mantine.colors.dimmed",opacity:.85,transform:"translateY(-100%) translateY(-2px)"},_light:{"& .mantine-SegmentedControl-root":{background:"mantine.colors.gray[3]"}}});x({display:"inline-block",fontSize:"xl",fontWeight:600,padding:"[1px 5px]",minWidth:24,textAlign:"center",borderRadius:"sm",background:"mantine.colors.dark[7]",color:"mantine.colors.defaultColor","&[data-zero]":{color:"mantine.colors.dimmed"},"&[data-missing]":{color:"mantine.colors.orange[4]",background:"mantine.colors.orange[8]/20"}});const R1=je.withProps({color:"dark",fz:"xs",openDelay:600,closeDelay:120,label:"",children:null,offset:8,withinPortal:!1});function D1({node:e,element:t}){const o=H(),a=D0(),i=re(a,h.useCallback(c=>c.children[`${a.id}-relationships`],[a.id])),r=[...t.incoming()].map(c=>c.id),s=[...t.outgoing()].map(c=>c.id),l=e?hn([...e.incoming()].flatMap(c=>c.$edge.relations)):[],d=e?hn([...e.outgoing()].flatMap(c=>c.$edge.relations)):[],u=[...r,...s].filter(c=>!l.includes(c)&&!d.includes(c)).length;return n.jsxs(Ee,{gap:"xs",pos:"relative",w:"100%",h:"100%",children:[r.length+s.length>0&&n.jsxs(ce,{gap:"xs",wrap:"nowrap",align:"center",children:[n.jsx(q,{children:n.jsxs(ce,{gap:8,mb:4,wrap:"nowrap",children:[n.jsx(Os,{title:"incoming",total:r.length,included:l.length}),n.jsx(Xe,{size:"sm",variant:"transparent",c:"dimmed",children:n.jsx(Yt,{style:{width:16}})}),n.jsx(L,{className:N1,children:mi(t.id)}),n.jsx(Xe,{size:"sm",variant:"transparent",c:"dimmed",children:n.jsx(Yt,{style:{width:16}})}),n.jsx(Os,{title:"outgoing",total:s.length,included:d.length})]})}),u>0&&n.jsx(R1,{label:"Current view does not include some relationships",children:n.jsxs(ce,{mt:"xs",gap:6,c:"orange",style:{cursor:"pointer"},children:[n.jsx(Po,{style:{width:14}}),n.jsxs(L,{fz:"sm",children:[u," relationship",u>1?"s are":" is"," hidden"]})]})})]}),n.jsx(q,{className:I1,children:i&&n.jsxs(n.Fragment,{children:[n.jsx(Fc,{actorRef:i}),n.jsx(q,{pos:"absolute",top:12,right:12,children:n.jsx(Q,{size:"md",variant:"default",radius:"sm",onClick:c=>{c.stopPropagation();const{subject:p,scope:g,viewId:m}=i.getSnapshot().context;o.overlays().send({type:"open.relationshipsBrowser",subject:p,scope:g,viewId:m})},children:n.jsx(ud,{stroke:1.6,style:{width:"70%"}})})})]})})]})}function Os({title:e,total:t,included:o}){return n.jsx(Mi,{withBorder:!0,shadow:"none",className:E1,px:"md",py:"xs",radius:"md",mod:{zero:t===0,missing:t!==o},children:n.jsxs(Ee,{gap:4,align:"flex-end",children:[n.jsx(L,{component:"div",c:t!==o?"orange":"dimmed",tt:"uppercase",fw:600,fz:10,lh:1,children:e}),n.jsx(L,{fw:600,fz:"xl",component:"div",lh:1,children:t!==o?n.jsxs(n.Fragment,{children:[o," / ",t]}):n.jsx(n.Fragment,{children:t})})]})})}const B1=x({marginTop:"sm",marginBottom:"sm"}),L1=x({display:"inline-flex",transition:"fast",border:"1px dashed",borderColor:"mantine.colors.defaultBorder",borderRadius:"sm",px:"md",py:"xs",alignItems:"center",cursor:"pointer",color:"mantine.colors.gray[7]",_dark:{color:"mantine.colors.dark[1]"},"& > *":{transition:"fast"},_hover:{transitionTimingFunction:"out",borderStyle:"solid",color:"mantine.colors.defaultColor",background:"mantine.colors.defaultHover","& > *":{transitionTimingFunction:"out",transform:"translateX(1px)"}}}),Na=({element:e})=>n.jsx(q,{className:L1,children:n.jsx(L,{component:"div",fz:"sm",fw:"500",children:e.title})}),T1=()=>{};function A1({element:e}){const t=Dn({multiple:!1});t.setHoveredNode=T1;const o=h.useMemo(()=>{let a=1;const i=s=>({label:s,value:`msg${a++}`,type:"message",children:[]}),r={label:n.jsx(Na,{type:"current",element:e}),value:e.id,element:e,type:"current",children:[...e.children()].map(s=>({label:n.jsx(Na,{type:"descedant",element:s}),value:s.id,element:s,type:"descedant",children:[]}))};return r.children.length===0&&r.children.push(i(n.jsx(Ap,{radius:"sm",children:"no nested"}))),[[...e.ancestors()].reduce((s,l)=>({label:n.jsx(Na,{type:"ancestor",element:l}),value:l.id,element:l,type:"ancestor",children:[s]}),r)]},[e]);return h.useEffect(()=>{t.expandAllNodes()},[o]),n.jsxs(n.Fragment,{children:[n.jsxs(El,{variant:"light",color:"orange",title:"In development",icon:n.jsx(Po,{}),children:["We need your feedback. Share your thoughts and ideas -"," ",n.jsx(Tp,{fz:"sm",fw:500,underline:"hover",c:"orange",href:"https://github.com/likec4/likec4/discussions/",target:"_blank",children:"GitHub discussions"})]}),n.jsx(Bn,{levelOffset:"xl",allowRangeSelection:!1,expandOnClick:!1,expandOnSpace:!1,classNames:{label:B1},data:o,tree:t})]})}const Hs=ko.withProps({mb:8,labelPosition:"left",variant:"dashed"}),Xs=je.withProps({color:"dark",fz:"xs",openDelay:400,closeDelay:150,label:"",children:null,offset:4}),qs=L.withProps({component:"div",fz:11,fw:500,c:"dimmed",lh:1}),go=L.withProps({component:"div",fz:"xs",c:"dimmed",className:q0}),Lt=24,z1=["Properties","Relationships","Views","Structure","Deployments"];function $1({viewId:e,fromNode:t,rectFromNode:o,fqn:a,onClose:i}){const[r,s]=h.useState(!1),l=Np(),d=l.width||window.innerWidth||1200,u=l.height||window.innerHeight||800,[c,p]=Ep({key:"likec4:element-details:active-tab",defaultValue:"Properties"}),g=H(),m=kf(),y=t?m.findNode(t):m.findNodeWithElement(a),w=m.$model.element(a),[C,b]=se([...w.views()],ie(X=>X.$view),Bl(X=>X._type==="element"&&X.viewOf===a));let v=y?.navigateTo?.$view??w.defaultView?.$view??null;v?.id===e&&(v=null);const j=gn(w.links),f=Ip(),k=(y?.$node.children?.length??0)>0,S=Math.min(700,d-Lt*2),E=Math.min(650,u-Lt*2),B=o?{x:o.x+(k?o.width-S/2:o.width/2),y:o.y+(k?0:o.height/2)}:{x:d/2,y:u/2},_=o?Math.min(o.width/S,o.height/E,.9):1,Y=Math.round(De(B.x-S/2,{min:Lt,max:d-S-Lt})),F=Math.round(De(B.y-(k?0:60),{min:Lt,max:u-E-Lt})),$=De((B.x-Y)/S,{min:.1,max:.9}),N=De((B.y-F)/E,{min:.1,max:.9}),V=Ar(S),R=Ar(E);ht(()=>{V.set(S),R.set(E)},[S,E]);const K=h.useCallback((X,Ie)=>{V.set(Math.max(V.get()+Ie.delta.x,320)),R.set(Math.max(R.get()+Ie.delta.y,300))},[]),_e=h.useRef(null),Pe=ql(i),Dt=ki(()=>{Pe.current()},[],50),ke=y?.$node.notation??null,la=On({element:{id:a,title:w.title,icon:y?.icon??w.icon},className:z0});return un(()=>{_e.current?.open||_e.current?.showModal()},20),un(()=>{s(!0)},220),n.jsx(Be.dialog,{ref:_e,className:P(B0,pn.classNames.fullWidth),layout:!0,initial:{[nn]:"0px",[an]:"5%"},animate:{[nn]:"3px",[an]:"60%"},exit:{[nn]:"0px",[an]:"0%",transition:{duration:.1}},onClick:X=>{X.stopPropagation(),X.target?.nodeName?.toUpperCase()==="DIALOG"&&_e.current?.close()},onDoubleClick:ae,onPointerDown:ae,onClose:X=>{X.stopPropagation(),Dt()},children:n.jsx(pn,{forwardProps:!0,removeScrollBar:!1,children:n.jsxs(Be.div,{layout:!0,layoutRoot:!0,drag:!0,dragControls:f,dragElastic:0,dragMomentum:!1,dragListener:!1,"data-likec4-color":y?.color??w.color,className:L0,initial:{top:F,left:Y,width:S,height:E,opacity:0,originX:$,originY:N,scale:Math.max(_,.65)},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9,translateY:-10,transition:{duration:.1}},style:{width:V,height:R},children:[n.jsxs("div",{className:T0,onPointerDown:X=>f.start(X),children:[n.jsxs(te,{alignItems:"start",justify:"space-between",gap:"sm",mb:"sm",flexWrap:"nowrap",children:[n.jsxs(te,{alignItems:"start",gap:"sm",style:{cursor:"default"},flexWrap:"nowrap",children:[la,n.jsxs("div",{children:[n.jsx(L,{component:"div",className:A0,children:w.title}),ke&&n.jsx(L,{component:"div",c:"dimmed",fz:"sm",fw:500,lh:1.3,lineClamp:1,children:ke})]})]}),n.jsx(Rp,{size:"lg",onClick:X=>{X.stopPropagation(),Dt()}})]}),n.jsxs(te,{alignItems:"baseline",gap:"sm",flexWrap:"nowrap",children:[n.jsxs("div",{children:[n.jsx(qs,{children:"kind"}),n.jsx(St,{radius:"sm",size:"sm",fw:600,color:"gray",style:{cursor:"pointer"},onClick:X=>{X.stopPropagation(),g.openSearch(`kind:${w.kind}`)},children:w.kind})]}),n.jsxs("div",{style:{flex:1},children:[n.jsx(qs,{children:"tags"}),n.jsxs(Pt,{gap:4,flex:1,mt:6,wrap:"wrap",children:[w.tags.map(X=>n.jsx(Kn,{tag:X,cursor:"pointer",onClick:Ie=>{Ie.stopPropagation(),g.openSearch(`#${X}`)}},X)),w.tags.length===0&&n.jsx(St,{radius:"sm",size:"sm",fw:600,color:"gray",children:""})]})]}),n.jsxs(Dp,{style:{alignSelf:"flex-start"},children:[j&&n.jsx(Q,{component:"a",href:j.url,target:"_blank",size:"lg",variant:"default",radius:"sm",children:n.jsx(ud,{stroke:1.6,style:{width:"65%"}})}),n.jsx(Wm,{feature:"Vscode",children:n.jsx(Xs,{label:"Open source",children:n.jsx(Q,{size:"lg",variant:"default",radius:"sm",onClick:X=>{X.stopPropagation(),g.openSource({element:w.id})},children:n.jsx(Jt,{stroke:1.8,style:{width:"62%"}})})})}),v&&n.jsx(Xs,{label:"Open default view",children:n.jsx(Q,{size:"lg",variant:"default",radius:"sm",onClick:X=>{X.stopPropagation(),g.navigateTo(v.id,t??void 0)},children:n.jsx($e,{style:{width:"70%"}})})})]})]})]}),n.jsx(Lc,{children:n.jsxs(Ll,{value:c,onChange:X=>p(X),variant:"none",classNames:{root:F0,list:W0,tab:O0,panel:H0},children:[n.jsx(Tl,{children:z1.map(X=>n.jsx(Ga,{value:X,children:X},X))}),n.jsx(Vt,{value:"Properties",children:n.jsx(Wt,{scrollbars:"y",type:"scroll",offsetScrollbars:!0,children:n.jsxs(q,{className:X0,pt:"xs",children:[w.hasSummary&&n.jsxs(n.Fragment,{children:[n.jsx(go,{children:"summary"}),n.jsx(Nt,{value:w.summary})]}),n.jsxs(n.Fragment,{children:[n.jsx(go,{children:"description"}),n.jsx(Nt,{value:w.description,emptyText:"no description"})]}),w.technology&&n.jsx(V1,{title:"technology",children:w.technology}),w.links.length>0&&n.jsxs(n.Fragment,{children:[n.jsx(go,{children:"links"}),n.jsx(te,{gap:"xs",flexWrap:"wrap",children:w.links.map((X,Ie)=>n.jsx(dr,{value:X},Ie))})]}),w.$element.metadata&&n.jsx(F1,{value:w.$element.metadata})]})})}),n.jsx(Vt,{value:"Relationships",children:n.jsx(Mt,{overrides:{enableRelationshipBrowser:!1,enableNavigateTo:!1},children:r&&c==="Relationships"&&n.jsx(D1,{element:w,node:y??null})})}),n.jsx(Vt,{value:"Views",children:n.jsx(Wt,{scrollbars:"y",type:"auto",children:n.jsxs(Ee,{gap:"lg",children:[C.length>0&&n.jsxs(q,{children:[n.jsx(Hs,{label:"views of the element (scoped)"}),n.jsx(Ee,{gap:"sm",children:C.map(X=>n.jsx(Ys,{view:X,onNavigateTo:Ie=>g.navigateTo(Ie,t??void 0)},X.id))})]}),b.length>0&&n.jsxs(q,{children:[n.jsx(Hs,{label:"views including this element"}),n.jsx(Ee,{gap:"sm",children:b.map(X=>n.jsx(Ys,{view:X,onNavigateTo:Ie=>g.navigateTo(Ie,t??void 0)},X.id))})]})]})})}),n.jsx(Vt,{value:"Structure",children:n.jsx(Wt,{scrollbars:"y",type:"auto",children:n.jsx(A1,{element:w})})}),n.jsx(Vt,{value:"Deployments",children:n.jsx(Wt,{scrollbars:"y",type:"auto",children:n.jsx(n1,{elementFqn:w.id})})})]})}),n.jsx(Be.div,{className:Y0,drag:!0,dragElastic:0,dragMomentum:!1,onDrag:K,dragConstraints:{top:0,left:0,right:0,bottom:0}})]})})})}const Ys=({view:e,onNavigateTo:t})=>n.jsx(de,{className:$0,onClick:o=>t(e.id,o),children:n.jsxs(ce,{gap:6,align:"start",wrap:"nowrap",children:[n.jsx(Xe,{size:"sm",variant:"transparent",children:e._type==="deployment"?n.jsx(Wi,{stroke:1.8}):n.jsx($e,{stroke:1.8})}),n.jsx(q,{children:n.jsx(L,{component:"div",className:V0,lineClamp:1,children:e.title||"untitled"})})]})});function V1({title:e,emptyValue:t="undefined",children:o,style:a,...i}){return n.jsxs(n.Fragment,{children:[n.jsx(go,{children:e}),n.jsx(L,{component:"div",...jo(o)&&{c:"dimmed"},fz:"md",style:{whiteSpace:"preserve-breaks",userSelect:"all",...a},...i,children:o||t})]})}function F1({value:e}){const t=zn(e).sort(([o],[a])=>o.localeCompare(a));return n.jsx(Lc,{children:n.jsxs(n.Fragment,{children:[n.jsx(go,{style:{justifySelf:"end",textAlign:"right"},children:"metadata"}),n.jsx(q,{className:x({display:"grid",gridTemplateColumns:"min-content 1fr",gridAutoRows:"min-content",gap:"[12px 16px]",alignItems:"baseline",justifyItems:"stretch"}),children:t.map(([o,a])=>n.jsx(Z0,{label:o,value:a},o))})]})})}const W1=e=>({viewId:e.context.currentView.id,fromNode:e.context.initiatedFrom.node,rectFromNode:e.context.initiatedFrom.clientRect,fqn:e.context.subject});function O1({actorRef:e,onClose:t}){const o=re(e,W1,oe);return n.jsx(gr.Provider,{value:e,children:n.jsx($1,{onClose:t,...o})})}const Sn=(e,t)=>e.size>2&&t.size!==e.size?new Set(Oa([...yi(e).flatten(),...t])):e.size>1?new Set(Oa([...e])):e;function H1(e,t){const o=new Set,a=new Set,i=new Set,r={sources:new Set,targets:new Set},s=(l,d)=>{d==="source"?(o.add(l),r.sources.add(l)):(i.add(l),r.targets.add(l))};for(const l of e){const d=t.findEdge(l),u=d?[...d.relationships("model")]:[];if(!d||!xe(u,1)||!d.source.hasElement()||!d.target.hasElement())continue;const c=d.source.element,p=d.target.element;s(c,"source"),s(p,"target");for(const g of u){if(a.add(g),g.source!==c){s(g.source,"source");for(const m of g.source.ancestors()){if(m===c)break;o.add(m)}}if(g.target!==p){s(g.target,"target");for(const m of g.target.ancestors()){if(m===p)break;i.add(m)}}}}return{sources:Sn(o,r.sources),targets:Sn(i,r.targets),relationships:a}}function X1({source:e,target:t}){const o=new Set,a=new Set,i=new Set,r={sources:new Set,targets:new Set},s=(d,u)=>{u==="source"?(o.add(d),r.sources.add(d)):(i.add(d),r.targets.add(d))};e&&s(e,"source"),t&&s(t,"target");const[l]=_u.findConnection(e,t,"directed");if(!l)return{sources:o,targets:i,relationships:a};for(const d of l.relations){const u=d.source,c=d.target;if(s(u,"source"),s(c,"target"),a.add(d),e!==u){O(mo(e,u),`${e.id} is not an ancestor of ${u.id}`);for(const p of u.ancestors()){if(p===e)break;o.add(p)}}if(t!==c){O(mo(t,c),`${t.id} is not an ancestor of ${c.id}`);for(const p of c.ancestors()){if(p===t)break;i.add(p)}}}return{sources:Sn(o,r.sources),targets:Sn(i,r.targets),relationships:a}}const q1=lr(e=>{const{enableNavigateTo:t}=Z(),{data:{navigateTo:o}}=e,[a,i,r]=zl(e),s=H();return n.jsxs(Bo,{...e,children:[n.jsx(To,{edgeProps:e,svgPath:a}),n.jsx(Zn,{edgeProps:e,labelPosition:{x:i,y:r,translate:"translate(-50%, 0)"},style:{maxWidth:Math.abs(e.targetX-e.sourceX-100)},children:n.jsx(Lo,{edgeProps:e,children:t&&o&&n.jsx(Gn,{...e,onClick:l=>{l.stopPropagation(),s.navigateTo(o)}})})})]})}),Y1=e=>{const{enableNavigateTo:t,enableVscode:o}=Z(),a=H(),i=Xn(),r=[],{navigateTo:s,fqn:l}=e.data;return s&&t&&i!==s&&r.push({key:"navigate",icon:n.jsx($e,{}),onClick:d=>{d.stopPropagation(),a.navigateTo(s)}}),l&&r.push({key:"relationships",icon:n.jsx(Mo,{}),onClick:d=>{d.stopPropagation(),a.openRelationshipsBrowser(l)}}),l&&o&&r.push({key:"goToSource",icon:n.jsx(Jt,{}),onClick:d=>{d.stopPropagation(),a.openSource({element:l})}}),n.jsx(Un,{buttons:r,...e})},Wc=e=>{const t=H();return n.jsx(sr,{...e,onClick:o=>{o.stopPropagation(),t.openElementDetails(e.data.fqn)}})},G1=et(e=>{const{enableElementTags:t}=Z();return n.jsxs(ao,{nodeProps:e,children:[n.jsx(io,{...e}),n.jsx(Ge,{...e}),t&&n.jsx(Ao,{...e}),n.jsx(Wc,{...e}),n.jsx(Y1,{...e}),n.jsx(U1,{...e})]})}),Z1=et(e=>n.jsxs(Ro,{nodeProps:e,children:[n.jsx(Wc,{...e}),n.jsx(Do,{...e}),n.jsx(K1,{...e})]})),U1=({data:{ports:e,height:t}})=>n.jsxs(n.Fragment,{children:[e.in.map((o,a)=>n.jsx(He,{id:o,type:"target",position:ge.Left,style:{visibility:"hidden",top:`${15+(a+1)*((t-30)/(e.in.length+1))}px`}},o)),e.out.map((o,a)=>n.jsx(He,{id:o,type:"source",position:ge.Right,style:{visibility:"hidden",top:`${15+(a+1)*((t-30)/(e.out.length+1))}px`}},o))]}),K1=({data:e})=>n.jsxs(n.Fragment,{children:[e.ports.in.map((t,o)=>n.jsx(He,{id:t,type:"target",position:ge.Left,style:{visibility:"hidden",top:`${20*(o+1)}px`}},t)),e.ports.out.map((t,o)=>n.jsx(He,{id:t,type:"source",position:ge.Right,style:{visibility:"hidden",top:`${20*(o+1)}px`}},t))]}),Oc=h.createContext(null);function hr(){return W(h.useContext(Oc),"No RelationshipDetailsActorContext")}function Hc(e,t=oe){const o=D(e),a=hr();return re(a,o,t)}function mr(){const e=hr();return h.useMemo(()=>({actor:e,get rootElementId(){return`relationship-details-${e.sessionId.replaceAll(":","_")}`},getState:()=>e.getSnapshot().context,send:e.send,navigateTo:(...t)=>{t.length===1?e.send({type:"navigate.to",params:{edgeId:t[0]}}):e.send({type:"navigate.to",params:{source:t[0],target:t[1]}})},fitDiagram:()=>{e.send({type:"fitDiagram"})},close:()=>{e._parent?e._parent?.send({type:"close",actorId:e.id}):e.send({type:"close"})}}),[e])}const We={dagre:{ranksep:60,nodesep:35,edgesep:25},edgeLabel:{width:220,height:14},nodeWidth:330,nodeHeight:180,compound:{labelHeight:2,paddingTop:50,paddingBottom:32}};function Q1(){const e=new Fn.graphlib.Graph({directed:!0,compound:!0,multigraph:!0});return e.setGraph({...We.dagre,rankdir:"LR"}),e.setDefaultEdgeLabel(()=>({...We.edgeLabel})),e.setDefaultNodeLabel(()=>({})),e}const ui="-port";function Gs(e,t,o){const a=new cn(r=>({id:`${e}-${r}`,portId:`${e}-${r}`})),i=yi(t);for(const r of i.sorted){const s=i.children(r).length>0,l=r.id,d=`${e}-${l}`,u=s?`${d}${ui}`:d;a.set(l,{id:d,portId:u}),o.setNode(d,{column:e,element:r,isCompound:s,portId:u,inPorts:[],outPorts:[],width:We.nodeWidth,height:We.nodeHeight}),s&&(o.setNode(u,{element:r,portId:u,isCompound:s,inPorts:[],outPorts:[],width:We.nodeWidth-We.dagre.ranksep,height:We.compound.labelHeight}),o.setParent(u,d));const c=i.parent(r);c&&o.setParent(d,`${e}-${c.id}`)}return{...i,byId:r=>{const s=i.byId(r),l=a.get(s.id);return{element:s,graph:l}},graphNodes:a}}function J1(e){return Fn.layout(e,{}),t=>{const o=e.node(t),{x:a,y:i,width:r,height:s}=o;return{position:{x:a-Math.round(r/2),y:i-Math.round(s/2)},width:r,height:s}}}function eb(e,t){const o=Q1(),a=Gs("sources",e.sources,o),i=Gs("targets",e.targets,o),r=Array.from(e.relationships).map(b=>{const v=a.byId(b.source.id).graph,j=i.byId(b.target.id).graph,f=b.id;return o.node(v.id).outPorts.push(j.id),o.node(j.id).inPorts.push(v.id),o.setEdge(v.portId,j.portId,{...We.edgeLabel},f),{name:f,source:v.id,sourceHandle:v.id+"_out"+(o.node(v.id).outPorts.length-1),target:j.id,targetHandle:j.id+"_in"+(o.node(j.id).inPorts.length-1),relationship:b}}),s=[...a.graphNodes.values(),...i.graphNodes.values()];for(const{id:b}of s){const v=o.node(b);if(v.isCompound)continue;const j=Math.max(o.inEdges(b)?.length??0,o.outEdges(b)?.length??0);j>3&&(v.height=v.height+(j-4)*14)}const l=o.edgeCount();if(l>5)for(const b of o.edges())o.setEdge(b,{...We.edgeLabel,width:l>10?800:400});const d=J1(o),u=se(s,Ct(b=>b.id===b.portId),En(b=>[b.id,d(b.id)]));function c(b){return u[b]??=se(o.children(b)??[],Ct(v=>!v.endsWith(ui)),ie(v=>c(v)),Hl(v=>{O(v.length>0,`Node ${b} has no nested nodes`)}),An((v,j)=>({minY:Math.min(v.minY,j.position.y),maxY:Math.max(v.maxY,j.position.y+j.height)}),{minY:1/0,maxY:-1/0}),({minY:v,maxY:j})=>{const{position:{x:f},width:k}=d(b);return v=v-We.compound.paddingTop,j=j+We.compound.paddingBottom,{position:{x:f,y:v},width:k,height:j-v}})}function p(b){const v=o.parent(b);return v?p(v)+1:0}function g(b){const v=o.children(b)??[];return v.length===0?0:1+Math.max(...v.map(g))}const m=(b,v,j)=>se(j,ie((f,k)=>({port:b+"_"+v+k,topY:c(f).position.y})),mn(bt("topY")),ie(bt("port")));let y=0,w=0;const C=s.map(({id:b})=>{const{element:v,inPorts:j,outPorts:f,column:k}=o.node(b);let{position:S,width:E,height:B}=c(b);const _=o.parent(b),Y=(o.children(b)??[]).filter(R=>!R.endsWith(ui));y=Math.min(y,S.x),w=Math.min(w,S.y);const F=t?dn(v.scopedViews(),R=>R.id!==t.id)?.id??null:null,$=t?.findNodeWithElement(v.id),N=t&&!$?dn(v.ancestors(),R=>!!t.findNodeWithElement(R.id))?.id:null,V=$??(N&&t?.findNodeWithElement(N));return yl({id:b,parent:_??null,x:S.x,y:S.y,title:v.title,description:Ha(v.$element)??null,technology:v.technology,tags:[...v.tags],links:null,color:V?.color??v.color,shape:$?.shape??v.shape,icon:$?.icon??v.icon??"none",modelRef:v.id,kind:v.kind,level:p(b),labelBBox:{x:S.x,y:S.y,width:E,height:B},style:ct({...($??V)?.style,...v.$element.style},["shape","color","icon"]),navigateTo:F,...Y.length>0&&{depth:g(b)},children:Y,width:E,height:B,column:k,ports:{in:m(b,"in",j),out:m(b,"out",f)}})});return{bounds:{x:Math.min(y,0),y:Math.min(w,0),width:o.graph().width??100,height:o.graph().height??100},nodes:C,edges:o.edges().reduce((b,v)=>{const j=o.edge(v),f=v.name;if(!f)return b;const{name:k,source:S,target:E,relationship:B,sourceHandle:_,targetHandle:Y}=fo(r,R=>R.name===f),F=B.title??"untitled",$=B.navigateTo?.id??null,N=Ha(B.$relationship)??null,V=B.technology??null;return b.push({id:k,source:S,sourceHandle:_,target:E,targetHandle:Y,label:F,color:B.color,description:N,...$&&{navigateTo:$},...V&&{technology:V},points:j.points.map(R=>[R.x,R.y]),line:B.line,relationId:B.id,parent:null}),b},[])}}const fr=x.raw({display:"inline-flex",alignItems:"center",padding:"[6px 2px 0 2px]","& .mantine-Text-root":{color:"mantine.colors.text/90",fontSize:"xs",fontWeight:500,lineHeight:"1.2"}}),Zs=x({paddingLeft:"1",gridColumn:1},fr),tb=x({gridColumn:2},fr),Us=x({gridColumn:3,paddingRight:"1"},fr),Xc="likec4-edge-label",ob=P(Xc,x({display:"grid",gridColumnStart:1,gridColumnEnd:4,borderBottom:"1px solid",borderBottomColor:"mantine.colors.defaultBorder",marginBottom:"0",padding:"[0 4px 5px 4px]",width:"100%","& .mantine-Text-root":{fontSize:"xxs",fontWeight:400,lineHeight:"xs",color:"mantine.colors.dimmed"}})),nb=x({display:"contents",[`&:last-child .${Xc}`]:{borderBottom:"none",marginBottom:"0"},"& > *":{transition:"all 0.15s ease-in"},"&:is(:hover, [data-selected=true]) > *":{transition:"all 0.15s ease-out",cursor:"pointer",backgroundColor:"mantine.colors.defaultHover"}}),ab=x({display:"grid",gridTemplateColumns:"1fr 30px 1fr",gridAutoRows:"min-content max-content",gap:"0",alignItems:"stretch"});x({display:"grid",gridTemplateColumns:"min-content 1fr",gridAutoRows:"min-content max-content",gap:"[10px 12px]",alignItems:"baseline",justifyItems:"start"});const ib=x({maxHeight:["70vh","calc(100cqh - 70px)"]}),rb=({edge:e,view:t})=>{const o=mr(),a=h.useRef(null),i=t.nodes.find(l=>l.id===e.source),r=t.nodes.find(l=>l.id===e.target),s=t.edges.flatMap(l=>{const d=t.nodes.find(c=>c.id===l.source),u=t.nodes.find(c=>c.id===l.target);return d&&u?{id:l.id,source:d,target:u,label:l.label}:[]});return!i||!r||s.length===0?null:n.jsxs(st,{position:"bottom-start",shadow:"md",keepMounted:!0,withinPortal:!1,closeOnClickOutside:!0,clickOutsideEvents:["pointerdown","mousedown","click"],onOpen:()=>{setTimeout(()=>{a.current?.querySelector(`[data-edge-id="${e.id}"]`)?.scrollIntoView({behavior:"instant",block:"nearest"})},100)},children:[n.jsx(Ut,{children:n.jsxs(Ce,{size:"xs",variant:"default",fw:"500",style:{padding:"0.25rem 0.75rem"},rightSection:n.jsx(Fi,{size:16}),children:[n.jsx(q,{className:Zs,maw:160,p:0,mod:{"likec4-color":i.color},children:n.jsx(L,{component:"span",truncate:!0,children:i.title})}),n.jsx(Xe,{color:"dark",variant:"transparent",size:"xs",children:n.jsx(Yt,{style:{width:"80%"}})}),n.jsx(q,{className:Us,maw:160,p:0,mod:{"likec4-color":r.color},children:n.jsx(L,{component:"span",truncate:!0,children:r.title})})]})}),n.jsx(Kt,{p:0,miw:250,maw:400,children:n.jsx(qe,{className:ib,scrollbars:"y",type:"never",viewportRef:a,children:n.jsx(q,{className:ab,p:"xs",maw:400,children:s.map(l=>n.jsxs("div",{className:nb,"data-selected":l.id===e.id,onClick:d=>{d.stopPropagation(),o.navigateTo(l.id)},children:[n.jsx(q,{className:Zs,mod:{"edge-id":l.id,"likec4-color":l.source.color},children:n.jsx(L,{component:"span",truncate:!0,children:l.source.title})}),n.jsx(q,{className:tb,children:n.jsx(Xe,{color:"dark",variant:"transparent",size:"xs",children:n.jsx(Yt,{style:{width:"80%"}})})}),n.jsx(q,{className:Us,mod:{"likec4-color":l.target.color},children:n.jsx(L,{component:"span",truncate:!0,children:l.target.title})}),n.jsx(q,{className:ob,children:n.jsx(L,{component:"span",truncate:!0,children:l.label||"untitled"})})]},l.id))})})})]})},sb={element:G1,compound:Z1},lb={relationship:q1};function db({actorRef:e}){const t=h.useRef(null);return t.current==null&&(t.current={defaultNodes:[],defaultEdges:[]}),n.jsx(Oc.Provider,{value:e,children:n.jsx(Di,{...t.current,children:n.jsx(qt,{id:e.sessionId,inherit:!1,children:n.jsxs(he,{children:[n.jsx(gb,{},"xyflow"),n.jsx(ub,{},"sync")]})})})})}const cb=e=>({...e.context.subject,viewId:e.context.viewId}),ub=h.memo(()=>{const e=hr(),t=re(e,cb,I),o=Se(),a=o.findView(t.viewId)??null,i=h.useMemo(()=>{let l;if("edgeId"in t&&ye(t.edgeId)){O(a,`view ${t.viewId} not found`);const d=W(a.findEdge(t.edgeId),`edge ${t.edgeId} not found in ${t.viewId}`);l=H1([d.id],a)}else if(t.source&&t.target)l=X1({source:o.element(t.source),target:o.element(t.target)});else return null;return eb(l,a)},[t,a,o]),r=Ln(),s=Pi();return h.useEffect(()=>{s.viewportInitialized&&e.send({type:"xyflow.init",instance:s,store:r})},[r,s.viewportInitialized,e]),h.useEffect(()=>{i!==null&&e.send({type:"update.layoutData",data:i})},[i,e]),null}),pb=({context:e})=>({initialized:e.initialized.xydata&&e.initialized.xyflow,nodes:e.xynodes,edges:e.xyedges}),gb=h.memo(()=>{const e=mr(),{initialized:t,nodes:o,edges:a}=Hc(pb,I);return n.jsxs(Xi,{id:e.rootElementId,nodes:o,edges:a,className:P(t?"initialized":"not-initialized","likec4-relationship-details"),nodeTypes:sb,edgeTypes:lb,onNodesChange:Ze(i=>{e.send({type:"xyflow.applyNodeChanges",changes:i})}),onEdgesChange:Ze(i=>{e.send({type:"xyflow.applyEdgeChanges",changes:i})}),fitViewPadding:.05,onNodeClick:Ze((i,r)=>{i.stopPropagation(),e.send({type:"xyflow.nodeClick",node:r})}),onEdgeClick:Ze((i,r)=>{i.stopPropagation(),e.send({type:"xyflow.edgeClick",edge:r})}),onPaneClick:Ze(()=>{e.send({type:"xyflow.paneClick"})}),onDoubleClick:Ze(()=>{e.send({type:"xyflow.paneDblClick"})}),onViewportResize:Ze(()=>{e.send({type:"xyflow.resized"})}),onEdgeMouseEnter:Ze((i,r)=>{r.data.hovered||e.send({type:"xyflow.edgeMouseEnter",edge:r})}),onEdgeMouseLeave:Ze((i,r)=>{r.data.hovered&&e.send({type:"xyflow.edgeMouseLeave",edge:r})}),onSelectionChange:Ze(i=>{e.send({type:"xyflow.selectionChange",...i})}),nodesDraggable:!1,nodesSelectable:!0,fitView:!1,pannable:!0,zoomable:!0,children:[n.jsx(mb,{}),n.jsx(Tn,{position:"top-right",children:n.jsx(Q,{variant:"default",color:"gray",onClick:i=>{i.stopPropagation(),e.close()},children:n.jsx(eo,{})})})]})}),hb=({context:e})=>({subject:e.subject,viewId:e.viewId}),mb=h.memo(()=>{const{subject:e,viewId:t}=Hc(hb,I),o=Se().findView(t);if(!o||!o.isDiagram())return null;const a=[...o.edges()];let i="edgeId"in e&&ye(e.edgeId)?a.find(r=>r.id===e.edgeId):fo(a,r=>r.source.element?.id===e.source&&r.target.element?.id===e.target)||fo(a,r=>(r.source.element?.id===e.source||mo(r.source.element?.id??"__",e.source??"__"))&&(r.target.element?.id===e.target||mo(r.target.element?.id??"__",e.target??"__")));return i?n.jsx(fb,{edge:i.$edge,view:o.$view}):null}),fb=({edge:e,view:t})=>{const o=mr(),a=e.id,[i,r,{history:s,current:l}]=Il(e.id);h.useEffect(()=>{i!==a&&r.set(a)},[a]),h.useEffect(()=>{i!==a&&o.navigateTo(i)},[i]);const d=l>0,u=l+1<s.length;return n.jsx(Tn,{position:"top-left",children:n.jsx(ce,{gap:4,wrap:"nowrap",children:n.jsxs(he,{mode:"popLayout",children:[d&&n.jsx(Be.div,{layout:!0,initial:{opacity:.05,transform:"translateX(-5px)"},animate:{opacity:1,transform:"translateX(0)"},exit:{opacity:.05,transform:"translateX(-10px)"},children:n.jsx(Q,{variant:"default",color:"gray",onClick:c=>{c.stopPropagation(),r.back()},children:n.jsx(cd,{})})},"back"),u&&n.jsx(Be.div,{layout:!0,initial:{opacity:.05,transform:"translateX(5px)"},animate:{opacity:1,transform:"translateX(0)"},exit:{opacity:0,transform:"translateX(5px)"},children:n.jsx(Q,{variant:"default",color:"gray",onClick:c=>{c.stopPropagation(),r.forward()},children:n.jsx(gt,{})})},"forward"),n.jsx(ce,{gap:"xs",wrap:"nowrap",ml:"sm",children:n.jsx(rb,{edge:e,view:t})})]})})})},yb=e=>e.context.overlays.map(t=>{switch(t.type){case"relationshipsBrowser":return e.children[t.id]?{type:t.type,actorRef:e.children[t.id]}:null;case"relationshipDetails":return e.children[t.id]?{type:t.type,actorRef:e.children[t.id]}:null;case"elementDetails":return e.children[t.id]?{type:t.type,actorRef:e.children[t.id]}:null;default:Le(t)}}).filter($l),xb=(e,t)=>e.length===t.length&&e.every((o,a)=>o.actorRef===t[a].actorRef);function bb({overlaysActorRef:e}){const t=H(),o=re(e,yb,xb),a=Sl()??!1,i=o.some(l=>l.type==="elementDetails");ht(()=>{const l=t.getContext().xystore.getState().domNode?.querySelector(".react-flow__renderer");if(!l||a)return;const d=Up(l,{opacity:i?.7:1,filter:i?"grayscale(1)":"grayscale(0)",transform:i?"perspective(400px) translateZ(-12px) translateY(3px)":"translateY(0)"},{duration:i?.35:.17});let u=null;return i||(u=setTimeout(()=>{l.style.transform="",l.style.filter="",u=null},450)),()=>{u&&clearTimeout(u),d.stop()}},[i]);const r=l=>{e.send({type:"close",actorId:l.id})},s=o.map((l,d)=>{switch(l.type){case"relationshipsBrowser":return n.jsx(Cn,{overlayLevel:d,onClose:()=>r(l.actorRef),children:n.jsx(Fc,{actorRef:l.actorRef})},l.actorRef.sessionId);case"relationshipDetails":return n.jsx(Cn,{overlayLevel:d,onClose:()=>r(l.actorRef),children:n.jsx(db,{actorRef:l.actorRef})},l.actorRef.sessionId);case"elementDetails":return n.jsx(O1,{actorRef:l.actorRef,onClose:()=>r(l.actorRef)},l.actorRef.sessionId);default:Le(l)}});return n.jsx(Mt.Overlays,{children:n.jsx(Ki,{onReset:()=>e.send({type:"close.all"}),children:n.jsx(qt,{children:n.jsx(he,{mode:"popLayout",children:s})})})})}const[wb,ft]=wl("SearchActorContext"),vb=e=>e.context.searchValue;function kb(){const e=ft(),t=re(e,vb),o=h.useCallback(a=>{e.send({type:"change.search",search:a})},[e]);return[t,o]}const jb=e=>{const t=e.context.searchValue.trim().toLowerCase();return t.length>1?t:""};function yr(){const e=ft();return h.useDeferredValue(re(e,jb))}function Cb(){const e=ft();return h.useCallback(t=>{e.send({type:"change.search",search:t})},[e])}const Sb=e=>e.context.pickViewFor;function _b(){const e=ft();return re(e,Sb)}const Ea=x.raw({outline:"none",background:"mantine.colors.primary[8]",borderColor:"mantine.colors.primary[9]"}),aa=".mantine-Tree-node:focus > .mantine-Tree-label &",Pb=x.raw({display:"flex",width:"100%",background:"mantine.colors.body",rounded:"sm",padding:"[12px 8px 12px 14px]",minHeight:"60px",gap:"2",border:"1px solid",borderColor:"mantine.colors.defaultBorder",_hover:{...Ea,borderColor:"mantine.colors.primary[9]",background:"mantine.colors.primary[8]/60"},_focus:Ea,[aa]:Ea,_dark:{borderColor:"transparent",background:"mantine.colors.dark[6]/80"},_light:{background:"mantine.colors.white/80",_hover:{borderColor:"mantine.colors.primary[6]",backgroundColor:"mantine.colors.primary[5]"}}}),ia="likec4-focusable",Jo={ref:"var(--likec4-icon-size, 24px)"},Mb=x.raw({color:{base:"mantine.colors.dimmed",_light:"mantine.colors.gray[5]",_groupHover:"mantine.colors.primary[0]",_groupFocus:"mantine.colors.primary[0]"},[aa]:{color:"mantine.colors.primary[0]"},flex:`0 0 ${Jo.ref}`,height:Jo.ref,width:Jo.ref,display:"flex",alignItems:"center",justifyContent:"center",alignSelf:"flex-start","--ti-size":Jo.ref,"& svg, & img":{width:"100%",height:"auto",maxHeight:"100%",pointerEvents:"none"},"& img":{objectFit:"contain"},"&.likec4-shape-icon svg":{strokeWidth:1.5}}),Nb=x.raw({fontSize:"16px",fontWeight:500,lineHeight:"1.1",":where([data-disabled]) &":{opacity:.4},color:{base:"mantine.colors.dark[1]",_light:"mantine.colors.gray[7]",_groupHover:{base:"mantine.colors.primary[1]",_light:"mantine.colors.white"},_groupFocus:{base:"mantine.colors.primary[1]",_light:"mantine.colors.white"}},[aa]:{color:{base:"mantine.colors.primary[1]",_light:"mantine.colors.white"}}}),qc=x.raw({color:{base:"mantine.colors.dimmed",_groupHover:{base:"mantine.colors.primary[1]",_light:"mantine.colors.primary[0]"},_groupFocus:"mantine.colors.primary[0]"},[aa]:{color:"mantine.colors.primary[0]"}}),Eb=x.raw(qc,{marginTop:"1",fontSize:"12px",lineHeight:"1.4",":where([data-disabled]) &":{opacity:.85}}),Ib=x({width:"100%",height:"100%",border:"2px dashed",borderColor:"mantine.colors.defaultBorder",rounded:"md",display:"flex",justifyContent:"center",alignItems:"center",fontSize:"md",color:"mantine.colors.dimmed",padding:"md",paddingBlock:"xl"}),Yc=zg({slots:["root","icon","title","description","descriptionColor"],className:"search-button",base:{root:Pb,icon:Mb,title:Nb,description:Eb,descriptionColor:qc}}),xr="@container likec4-tree (max-width: 450px)",Rb=x({outline:"none",marginBottom:"2"}),Db=x(Pd.raw({containerName:"likec4-tree"}),{containerType:"inline-size",height:"100%"}),Bb=x({display:"flex",alignItems:"baseline",outline:"none !important",gap:"1"}),Lb=x({marginTop:"2"}),Tb=x({color:"mantine.colors.dimmed"}),Ab=x({[xr]:{flexDirection:"column-reverse",alignItems:"flex-start",gap:"0.5"}}),zb=x({fontSize:"10px",lineHeight:"1.3",display:"block",fontWeight:500,whiteSpace:"nowrap",padding:"[1px 5px]",borderRadius:"4px",background:"mantine.colors.dark[9]/30",_light:{background:"mantine.colors.gray[3]/20"}}),$b=x({"--likec4-icon-size":"24px",[xr]:{"--likec4-icon-size":"18px"}}),Vb=x({flex:0,fontSize:"10px",fontWeight:500,whiteSpace:"nowrap",lineHeight:"1.1",[xr]:{display:"none"}});function Re(e){e.stopPropagation(),e.preventDefault()}function Gc(e){const t=e.getBoundingClientRect();return t.y+Math.floor(t.height/2)}function Vo(e){if(!e){console.error("moveFocusToSearchInput: from is null or undefined");return}const t=e.getRootNode();if(!Vn(t.querySelector)){console.error("moveFocusToSearchInput: root.querySelector is not a function");return}let o=t.querySelector("[data-likec4-search-input]");if(o){const a=o.value.length;o.focus(),o.setSelectionRange(a,a)}}function _n(e){if(!e){console.error("focusToFirstFoundElement: from is null or undefined");return}const t=e.getRootNode();if(!Vn(t.querySelector)){console.error("focusToFirstFoundElement: root.querySelector is not a function");return}t.querySelector(`[data-likec4-search] .${ia}`)?.focus()}function Zc(e,t,o=`.${ia}`){if(!e)return console.error("queryAllFocusable: from is null or undefined"),[];const a=e.getRootNode();return Vn(a.querySelectorAll)?[...a.querySelectorAll(`[data-likec4-search-${t}] ${o}`)]:(console.error("queryAllFocusable: root.querySelectorAll is not a function"),[])}const Fb="likec4-view-btn",Wb=P(x({flexWrap:"nowrap",display:"flex","&[data-disabled] .mantine-ThemeIcon-root":{opacity:.45}}),Fb);x({marginTop:"1",fontSize:"13px",lineHeight:"1.4",":where(.likec4-view-btn[data-disabled]) &":{opacity:.85}});const Uc=()=>n.jsx(U,{className:Ib,children:"Nothing found"}),Ob=h.memo(()=>{const e=h.useRef(null);let t=[...Se().views()],o=yr();return o&&(o.startsWith("kind:")?t=[]:t=t.filter(a=>o.startsWith("#")?a.tags.some(i=>i.toLocaleLowerCase().includes(o.slice(1))):`${a.id} ${a.title} ${a.description.text}`.toLocaleLowerCase().includes(o))),n.jsxs(Ee,{ref:e,renderRoot:a=>n.jsx(ee,{layout:!0,...a}),gap:8,"data-likec4-search-views":!0,onKeyDown:a=>{if(a.key==="ArrowLeft"||a.key==="ArrowRight"){const i=a.target.getBoundingClientRect().y,r=Zc(e.current,"elements",".likec4-element-button");let s=r.length>1?r.find((l,d,u)=>Gc(l)>i||d===u.length-1):null;s??=yo(r),s&&(a.stopPropagation(),s.focus());return}},children:[t.length===0&&n.jsx(Uc,{}),t.length>0&&n.jsx(Yu,{children:n.jsx(de,{"data-likec4-view":!0,tabIndex:-1,onFocus:a=>{a.stopPropagation(),Vo(e.current)}})}),t.map((a,i)=>n.jsx(ee,{layoutId:`@view${a.id}`,children:n.jsx(pi,{view:a,search:o,tabIndex:i===0?0:-1})},a.id))]})}),en=Yc();function pi({className:e,view:t,loop:o=!1,search:a,focusOnElement:i,...r}){const s=ft(),l=H(),d=Xn(),u=t.id===d,c=()=>{s.send({type:"close"}),setTimeout(u&&i?()=>{l.focusOnElement(i)}:()=>{l.navigateTo(t.id,void 0,i)},100)};return n.jsxs(de,{...r,className:P(en.root,"group",ia,Wb,e),"data-likec4-view":t.id,...u&&!i&&{"data-disabled":!0},onClick:p=>{p.stopPropagation(),c()},onKeyDown:Nl({siblingSelector:"[data-likec4-view]",parentSelector:"[data-likec4-search-views]",activateOnFocus:!1,loop:o,orientation:"vertical",onKeyDown:p=>{p.nativeEvent.code==="Space"&&(p.stopPropagation(),c())}}),children:[n.jsx(Xe,{variant:"transparent",className:en.icon,children:t.isDeploymentView()?n.jsx(Wi,{stroke:1.8}):n.jsx($e,{stroke:1.8})}),n.jsxs(U,{style:{flexGrow:1},children:[n.jsxs(ce,{gap:"xs",wrap:"nowrap",align:"center",children:[n.jsx(vt,{component:"div",highlight:a,className:en.title,children:t.title||"untitled"}),u&&n.jsx(St,{size:"xs",fz:9,radius:"sm",children:"current"})]}),n.jsx(vt,{highlight:t.description.nonEmpty?a:"",component:"div",className:en.description,lineClamp:1,children:t.description.text||"No description"})]})]})}const Tt=Yc(),Hb=h.memo(()=>{const e=Se(),t=yr(),o=h.useMemo(()=>{const i=t.split(".");let r;_t(i)||i[0]==="kind:"?r=e.elements():r=fl(e.elements(),u=>t.startsWith("kind:")?u.kind.toLocaleLowerCase().startsWith(t.slice(5)):t.startsWith("#")?u.tags.some(c=>c.toLocaleLowerCase().includes(t.slice(1))):(u.title+" "+u.id+" "+u.summary.text).toLocaleLowerCase().includes(t));const s={},{all:l,roots:d}=se([...r],Oa,An((u,c)=>{const p={label:c.title,value:c.id,element:c,searchTerms:i,children:[]};s[p.value]=p;const g=u.all.findLast(m=>mo(m.value,p.value));return g?(g.children.push(p),g.children.length>1&&g.children.sort(wo)):u.roots.push(p),u.all.push(p),u},{all:[],roots:[]}));return{all:l,byid:s,roots:d.sort(wo)}},[e,t]),a=Kc();return o.all.length===0?n.jsx(Uc,{}):n.jsx(qb,{data:o,handleClick:a})}),Xb=()=>{};function qb({data:{all:e,byid:t,roots:o},handleClick:a}){const i=Dn({multiple:!1});i.setHoveredNode=Xb,h.useEffect(()=>{i.collapseAllNodes();for(const s of e)s.children.length>0&&i.expand(s.value)},[e]);const r=D(s=>{const l=s.target,d=l.getAttribute("data-value"),u=!!d&&t[d];if(u){if(s.key==="ArrowUp"){d===o[0]?.value&&(Re(s),Vo(l));return}if(s.key==="ArrowRight"){if(u.children.length>0&&i.expandedState[d]===!1)return;const c=(s.target.querySelector(".mantine-Tree-label")??l).getBoundingClientRect().y,p=Zc(l,"views");let g=p.length>1?p.find((m,y,w)=>Gc(m)>c||y===w.length-1):null;g??=yo(p),g&&(Re(s),g.focus());return}if(s.key===" "||s.key==="Enter"){Re(s),a(u.element);return}}});return n.jsx(Bn,{"data-likec4-search-elements":!0,allowRangeSelection:!1,clearSelectionOnOutsideClick:!0,selectOnClick:!1,tree:i,data:o,levelOffset:"lg",classNames:{root:Db,node:P(ia,Rb),label:Bb,subtree:Lb},onKeyDownCapture:r,renderNode:Yb})}function Yb({node:e,elementProps:t,hasChildren:o,expanded:a}){const{element:i,searchTerms:r}=e,s=xm({element:{id:i.id,title:i.title,shape:i.shape,icon:i.icon},className:P(Tt.icon,$b)}),l=[...i.views()],d=Kc(),u=`@tree.${e.value}`;return n.jsxs(ee,{layoutId:u,...t,children:[n.jsx(Q,{variant:"transparent",size:16,tabIndex:-1,className:P(Tb),style:{visibility:o?"visible":"hidden"},children:n.jsx(gt,{stroke:3.5,style:{transition:"transform 150ms ease",transform:`rotate(${a?"90deg":"0"})`,width:"100%"}})}),n.jsxs(de,{component:Te,layout:!0,tabIndex:-1,"data-value":i.id,className:P(Tt.root,"group","likec4-element-button"),...l.length>0&&{onClick:c=>{(!o||a)&&(c.stopPropagation(),d(i))}},children:[s,n.jsxs(q,{style:{flexGrow:1},children:[n.jsxs(ce,{gap:"xs",wrap:"nowrap",align:"center",className:Ab,children:[n.jsx(vt,{component:"div",highlight:r,className:Tt.title,children:e.label}),n.jsx(je,{label:i.id,withinPortal:!1,fz:"xs",disabled:!i.id.includes("."),children:n.jsx(vt,{component:"div",highlight:r,className:P(zb,Tt.descriptionColor),children:mi(i.id)})})]}),n.jsx(vt,{component:"div",highlight:r,className:Tt.description,lineClamp:1,children:i.summary.text||"No description"})]}),n.jsx(L,{component:"div",className:P(Vb,Tt.descriptionColor),fz:"xs",children:l.length===0?"No views":n.jsxs(n.Fragment,{children:[l.length," view",l.length>1?"s":""]})})]})]})}function Kc(){const e=H(),t=ft();return D(o=>{const a=[...o.views()];if(a.length===0)return;const i=gn(a);if(i){t.send({type:"close"}),i.id===e.currentView.id?setTimeout(()=>{e.focusOnElement(o.id)},100):setTimeout(()=>{e.navigateTo(i.id,void 0,o.id)},100);return}t.send({type:"pickview.open",elementFqn:o.id})})}const Gb=x({border:"transparent",background:{base:"transparent",_focusWithin:{base:"mantine.colors.gray[4]/55 !important",_dark:"mantine.colors.dark[5]/55 !important"},_groupHover:{base:"mantine.colors.gray[3]/35",_dark:"mantine.colors.dark[5]/35"}}}),Zb=x({position:"absolute",inset:"0",width:"100%",height:"100%",backgroundColor:"[rgb(34 34 34 / 0.7)]",zIndex:902,backdropFilter:"auto",backdropBlur:"10px",_light:{backgroundColor:"[rgb(255 255 255 / 0.6)]"}}),Ub=x({position:"absolute",top:"[2rem]",left:"[50%]",width:"100%",maxWidth:"600px",minWidth:"200px",transform:"translateX(-50%)",zIndex:903}),Ks=x({marginTop:"2","& + &":{marginTop:"[32px]"}});x({height:["100%","100cqh"],"& .mantine-ScrollArea-viewport":{minHeight:"100%","& > div":{minHeight:"100%",height:"100%"}}});function Kb({elementFqn:e}){const t=ft(),o=Se().element(e),a=[],i=[];for(const s of o.views())s.viewOf===o?a.push(s):i.push(s);const r=()=>{t.send({type:"pickview.close"})};return Dl("keydown",s=>{try{s.key==="Escape"&&(s.stopPropagation(),s.preventDefault(),r())}catch(l){console.warn(l)}},{capture:!0}),n.jsxs(n.Fragment,{children:[n.jsx(ee,{className:Zb,onClick:s=>{s.stopPropagation(),r()}},"pickview-backdrop"),n.jsx(Bp,{children:n.jsxs(ee,{initial:{opacity:0,scale:.95,originY:0,translateX:"-50%",translateY:-20},animate:{opacity:1,scale:1,translateY:0},exit:{opacity:0,scale:.98,translateY:-20,transition:{duration:.1}},className:Ub,"data-likec4-search-views":!0,children:[n.jsxs(ce,{px:"sm",py:"md",justify:"space-between",children:[n.jsx(po,{order:2,lh:1,children:"Select view"}),n.jsx(Q,{size:"md",variant:"default",onClick:s=>{s.stopPropagation(),r()},children:n.jsx(eo,{})})]}),n.jsxs(qe,{mah:"calc(100vh - 110px)",type:"never",children:[a.length>0&&n.jsxs(Ee,{gap:"sm",px:"sm",className:Ks,children:[n.jsx(po,{order:6,c:"dimmed",children:"scoped views of the element"}),a.map((s,l)=>n.jsx(pi,{view:s,search:"",loop:!0,focusOnElement:e,mod:{autofocus:l===0}},s.id))]}),i.length>0&&n.jsxs(Ee,{gap:"sm",px:"sm",className:Ks,children:[n.jsx(po,{order:6,c:"dimmed",children:"views including this element"}),i.map((s,l)=>n.jsx(pi,{view:s,search:"",loop:!0,focusOnElement:e,mod:{autofocus:l===0&&a.length===0}},s.id))]})]})]},"pickview")})]})}function Qb(){const e=h.useRef(null);let t=Se().tagsSortedByUsage,o=Cb(),a=yr(),i=t.length,r=!1;if(a.startsWith("#")){const s=a.slice(1);t=t.filter(({tag:l})=>l.toLocaleLowerCase().includes(s)),r=t.length!==i}return t.length===0?null:(t=t.slice(0,15),n.jsxs(te,{ref:e,css:{gap:"md",paddingLeft:"[48px]",flexWrap:"nowrap"},children:[n.jsx(te,{css:{gap:"1.5",flexWrap:"wrap",opacity:r?1:.3,grayscale:r?0:.9,filter:"auto",transition:"fast",_groupHover:{opacity:1,grayscale:0},_groupFocusWithin:{opacity:1,grayscale:0}},children:t.map(({tag:s})=>n.jsx(Kn,{tag:s,className:x({userSelect:"none",cursor:"pointer"}),onClick:l=>{l.stopPropagation(),o(`#${s}`),setTimeout(()=>{_n(e.current)},350)}},s))}),r&&n.jsx(Ce,{size:"compact-xs",variant:"light",onClick:s=>{s.stopPropagation(),o(""),Vo(e.current)},rightSection:n.jsx(eo,{size:14}),children:"Clear"})]}))}function Qs(e){return e.match(/^(k|ki|kin|kind|kind:)$/)!=null}const Jb=["#","kind:"],ew=h.memo(()=>{const e=ft(),t=Se(),o=h.useRef(null),{ref:a,focused:i}=Gu(),[r,s]=kb(),l=Zu({scrollBehavior:"smooth",loop:!1});Dl("keydown",c=>{try{!i&&(c.key==="Backspace"||c.key.startsWith("Arrow")||c.key.match(new RegExp("^\\p{L}$","u")))&&Vo(o.current)}catch(p){console.warn(p)}});let d=[],u=!1;switch(!0){case r.startsWith("#"):{const c=r.toLocaleLowerCase().slice(1),p=t.tags.filter(g=>g.toLocaleLowerCase().includes(c));p.length===0?(u=!1,d=[n.jsx(Ir,{children:"No tags found"},"empty-tags")]):(u=t.tags.some(g=>g.toLocaleLowerCase()===c),d=p.map(g=>n.jsxs(Rr,{value:`#${g}`,children:[n.jsx(L,{component:"span",opacity:.5,mr:1,fz:"sm",children:"#"}),g]},g)));break}case r.startsWith("kind:"):case Qs(r):{const c=r.length>5?r.slice(5).toLocaleLowerCase():"";let p=xi(t.specification.elements);c&&(p=p.filter(g=>g.toLocaleLowerCase().includes(c))),p.length===0?(u=!1,d=[n.jsx(Ir,{children:"No kinds found"},"empty-kinds")]):(u=p.some(g=>g.toLocaleLowerCase()===c),d=p.map(g=>n.jsxs(Rr,{value:`kind:${g}`,children:[n.jsx(L,{component:"span",opacity:.5,mr:1,fz:"sm",children:"kind:"}),g]},g)));break}}return n.jsxs(Uu,{onOptionSubmit:c=>{s(c),l.resetSelectedOption(),Jb.includes(c)||(l.closeDropdown(),setTimeout(()=>{_n(o.current)},350))},width:"max-content",position:"bottom-start",shadow:"md",offset:{mainAxis:4,crossAxis:50},store:l,withinPortal:!1,children:[n.jsx(Ku,{children:n.jsx(Ya,{ref:ji(o,a),placeholder:"Search by title, description or start with # or kind:",autoFocus:!0,"data-autofocus":!0,"data-likec4-search-input":!0,tabIndex:0,classNames:{input:Gb},size:"lg",value:r,leftSection:n.jsx(Vi,{style:{width:ot(20)},stroke:2}),rightSection:n.jsx(Ya.ClearButton,{onClick:c=>{c.stopPropagation();const p=e.getSnapshot().context.openedWithSearch;r===""||r===p?e.send({type:"close"}):s("")}}),rightSectionPointerEvents:"auto",onChange:c=>{s(c.currentTarget.value),l.openDropdown(),l.updateSelectedOptionIndex()},onClick:()=>l.openDropdown(),onFocus:()=>l.openDropdown(),onBlur:()=>l.closeDropdown(),onKeyDownCapture:c=>{if(c.key==="Tab"){switch(!0){case l.getSelectedOptionIndex()>=0:return l.clickSelectedOption(),Re(c);case d.length===1:return l.selectFirstOption()&&l.clickSelectedOption(),Re(c);case Qs(r):return s("kind:"),Re(c)}return}if(c.key==="Backspace"&&l.dropdownOpened){if(r==="kind:")return s(""),l.resetSelectedOption(),Re(c);if(r.startsWith("kind:")&&u)return s("kind:"),l.resetSelectedOption(),Re(c);if(r.startsWith("#")&&u)return s("#"),l.resetSelectedOption(),Re(c)}if(c.key==="Escape"&&l.dropdownOpened&&d.length>0){Re(c),l.closeDropdown();return}if(c.key==="ArrowUp"&&l.dropdownOpened&&r===""&&l.getSelectedOptionIndex()===0){l.closeDropdown(),Re(c);return}if(c.key==="ArrowDown"&&(!l.dropdownOpened||d.length===0||u||r===""&&l.getSelectedOptionIndex()===d.length-1)){l.closeDropdown(),Re(c),_n(o.current);return}}})}),n.jsx(Qu,{hidden:d.length===0,style:{minWidth:300},children:n.jsx(Ju,{children:n.jsx(qe,{mah:"min(322px, calc(100cqh - 50px))",type:"scroll",children:d})})})]})}),tw=x({backgroundColor:"[rgb(34 34 34 / var(--_opacity, 95%))]",_light:{backgroundColor:"[rgb(250 250 250 / var(--_opacity, 95%))]"},backdropFilter:"auto",backdropBlur:"var(--_blur, 10px)"}),ow=x({width:"100%",height:"100%",maxHeight:"100vh",overflow:"hidden",display:"flex",flexDirection:"column",justifyContent:"stretch",gap:"sm",paddingTop:"[20px]",paddingLeft:"md",paddingRight:"md",paddingBottom:"sm",background:"[transparent]"}),nw=e=>!e.matches("inactive");function aw({searchActorRef:e}){const t=re(e,nw),o=()=>{e.send({type:"open"})},a=D(()=>{e.send({type:"close"})});return mp([["mod+k",o,{preventDefault:!0}],["mod+f",o,{preventDefault:!0}]]),n.jsx(wb,{value:e,children:n.jsx(Mt.Overlays,{children:n.jsx(Vl,{FallbackComponent:Ed,onReset:a,children:n.jsx(he,{children:t&&n.jsx(Cn,{fullscreen:!0,withBackdrop:!1,backdrop:{opacity:.9},classes:{dialog:tw,body:ow},openDelay:0,onClose:a,"data-likec4-search":"true",children:n.jsx(iw,{searchActorRef:e})})})})})})}const Js=x({height:["100%","100cqh"],"& .mantine-ScrollArea-viewport":{minHeight:"100%","& > div":{minHeight:"100%",height:"100%"}}}),iw=({searchActorRef:e})=>{const t=h.useRef(null),o=_b();return un(()=>{ye(e.getSnapshot().context.openedWithSearch)&&_n(t.current)},150),n.jsxs(U,{ref:t,display:"contents",children:[n.jsx(ce,{className:"group",wrap:"nowrap",onClick:a=>{a.stopPropagation(),Vo(t.current)},children:n.jsxs(Rt,{flex:1,px:"sm",children:[n.jsx(ew,{}),n.jsx(Qb,{})]})}),n.jsxs(Br,{children:[n.jsx(Oo,{span:6,children:n.jsx(po,{component:"div",order:6,c:"dimmed",pl:"sm",children:"Elements"})}),n.jsx(Oo,{span:6,children:n.jsx(po,{component:"div",order:6,c:"dimmed",pl:"sm",children:"Views"})})]}),n.jsxs(Br,{className:x({containerName:"likec4-search-elements",containerType:"size",overflow:"hidden",flexGrow:1}),children:[n.jsx(Oo,{span:6,children:n.jsx(Wt,{type:"scroll",className:Js,pr:"xs",scrollbars:"y",children:n.jsx(he,{children:n.jsx(qt,{id:"likec4-search-elements",children:n.jsx(Hb,{})})})})}),n.jsx(Oo,{span:6,children:n.jsx(Wt,{type:"scroll",className:Js,pr:"xs",scrollbars:"y",children:n.jsx(he,{children:n.jsx(qt,{id:"likec4-search-views",children:n.jsx(Ob,{})})})})})]}),o&&n.jsx(Kb,{elementFqn:o})]})},rw=rt({delays:{"open timeout":({context:e})=>e.openTimeout,"close timeout":600,"long idle":1500},actions:{"update edgeId":z(({context:e,event:t})=>(A(t,["xyedge.select","xyedge.mouseEnter"]),{edgeId:t.edgeId,edgeSelected:e.edgeSelected||t.type==="xyedge.select"})),"increase open timeout":z(()=>({openTimeout:800})),"decrease open timeout":z(()=>({openTimeout:300})),"reset edgeId":z({edgeId:null,edgeSelected:!1})},guards:{"edge was selected":({context:e})=>e.edgeSelected,"edge was hovered":({context:e})=>!e.edgeSelected}}).createMachine({id:"breadcrumbs",context:()=>({edgeId:null,edgeSelected:!1,openTimeout:800}),initial:"idle",on:{close:{target:"#idle",actions:["reset edgeId","increase open timeout"]}},states:{idle:{id:"idle",on:{"xyedge.mouseEnter":{target:"opening",actions:"update edgeId"},"xyedge.select":{target:"active",actions:"update edgeId"}},after:{"long idle":{actions:"increase open timeout"}}},opening:{on:{"xyedge.mouseLeave":{target:"idle"},"xyedge.select":{target:"active",actions:"update edgeId"}},after:{"open timeout":{actions:"decrease open timeout",target:"active"}}},active:{tags:["opened"],initial:"opened",exit:"reset edgeId",on:{"xyedge.unselect":{target:"idle",actions:"increase open timeout"},"xyedge.select":{actions:"update edgeId"}},states:{opened:{on:{"dropdown.mouseEnter":{target:"hovered"},"xyedge.mouseLeave":{guard:"edge was hovered",target:"closing"}}},hovered:{on:{"dropdown.mouseLeave":[{guard:"edge was selected",target:"opened"},{target:"closing"}]}},closing:{on:{"xyedge.mouseEnter":{guard:"edge was hovered",target:"opened",actions:"update edgeId"},"xyedge.select":{target:"opened",actions:"update edgeId"},"dropdown.mouseEnter":{target:"hovered"}},after:{"close timeout":{target:"#idle"}}}}}}}),sw=rw,el=x({display:"block",fontSize:"xxs",fontWeight:500,whiteSpace:"nowrap",paddingX:"1",paddingY:"0.5",borderRadius:"[2px]",background:{_light:"var(--likec4-palette-fill)/90",_dark:"var(--likec4-palette-fill)/60"},lineHeight:"1",color:{_light:"var(--likec4-palette-hiContrast)",_dark:"var(--likec4-palette-loContrast)"}}),lw=x({whiteSpaceCollapse:"preserve-breaks",fontSize:"sm",lineHeight:"sm",userSelect:"all"});function dw(e){let t=null;for(const o of e.xyedges)if(o.selected){if(t){t=null;break}t=o.data.id}return{viewId:e.view.id,selected:t}}const cw=h.memo(()=>{const e=Se(),t=_i(sw),o=H(),{viewId:a,selected:i}=ze(dw),r=re(t,m=>m.hasTag("opened")?m.context.edgeId:null);Ne("navigateTo",()=>{t.send({type:"close"})}),Ne("edgeMouseEnter",({edge:m})=>{t.send({type:"xyedge.mouseEnter",edgeId:m.data.id})}),Ne("edgeMouseLeave",()=>{t.send({type:"xyedge.mouseLeave"})}),Ne("walkthroughStarted",()=>{t.send({type:"close"})}),h.useEffect(()=>{i?t.send({type:"xyedge.select",edgeId:i}):t.send({type:"xyedge.unselect"})},[i]);const s=h.useCallback(m=>{if(!r)return;t.send({type:"dropdown.mouseEnter"});const y=o.findEdge(r);y&&!y.data.hovered&&o.send({type:"xyflow.edgeMouseEnter",edge:y,event:m})},[t,o,r]),l=h.useCallback(m=>{if(!r)return;t.send({type:"dropdown.mouseLeave"});const y=o.findEdge(r);y?.data.hovered&&o.send({type:"xyflow.edgeMouseLeave",edge:y,event:m})},[t,o,r]),{diagramEdge:d,sourceNode:u,targetNode:c}=ze(m=>{const y=r?or(m,r):null,w=y?Zt(m,y.source):null,C=y?Zt(m,y.target):null;return{diagramEdge:y,sourceNode:w,targetNode:C}},oe,[r]);if(!d||!u||!c||_t(d.relations))return null;const[p,g]=se(d.relations,ie(m=>{try{return e.relationship(m)}catch(y){return console.error(`View is cached and likec4model missing relationship ${m} from ${u.id} -> ${c.id}`,y),null}}),Ct(ye),Bl(m=>m.source.id===u.id&&m.target.id===c.id));return p.length===0&&g.length===0?(console.warn("No relationships found  diagram edge",{diagramEdge:d,sourceNode:u,targetNode:c}),null):n.jsx(g0,{children:n.jsx(gw,{viewId:a,direct:p,nested:g,diagramEdge:d,sourceNode:u,targetNode:c,onMouseEnter:s,onMouseLeave:l})})}),uw=(e,t)=>t?.querySelector(`.likec4-edge-label[data-edge-id="${e}"]`)??t?.querySelector(`.likec4-edge-middle-point[data-edge-id="${e}"]`)??null,pw=8,gw=({viewId:e,diagramEdge:t,direct:o,nested:a,sourceNode:i,targetNode:r,onMouseEnter:s,onMouseLeave:l})=>{const d=h.useRef(null),{enableNavigateTo:u,enableVscode:c,enableCompareWithLatest:p}=Z(),{onOpenSource:g}=to(),m=Bm(),[y,w]=h.useState(null);h.useLayoutEffect(()=>{w(uw(t.id,m.current))},[t]),h.useEffect(()=>{const v=y,j=d.current;if(!v||!j)return;let f=!1;const k=ep(v,j,()=>{tp(v,j,{placement:"bottom-start",middleware:[op(4),np({crossAxis:!0,allowedPlacements:["bottom-start","bottom-end","left-start","top-start","top-end","right-start","right-end","left-end"]}),ap({apply({availableHeight:S,availableWidth:E,elements:B}){f||Object.assign(B.floating.style,{maxWidth:`${De(ut(E),{min:220,max:400})}px`,maxHeight:`${De(ut(S),{min:100,max:500})}px`})}}),ip({padding:pw*2})]}).then(({x:S,y:E,middlewareData:B})=>{f||(j.style.transform=`translate(${ut(S)}px, ${ut(E)}px)`,j.style.visibility=B.hide?.referenceHidden?"hidden":"visible")})},{ancestorResize:!1,animationFrame:!0});return()=>{f=!0,k()}},[y]);const C=H(),b=h.useCallback((v,j)=>n.jsxs(h.Fragment,{children:[j>0&&n.jsx(ko,{}),n.jsx(mw,{viewId:e,relationship:v,sourceNode:i,targetNode:r,onNavigateTo:u?f=>{C.navigateTo(f)}:void 0,...g&&c&&{onOpenSource:()=>g({relation:v.id})}})]},v.id),[e,i,r,C,u,g,c]);return n.jsx(qe,{ref:d,onMouseEnter:s,onMouseLeave:l,type:"auto",scrollbars:"y",scrollbarSize:6,styles:{viewport:{overscrollBehavior:"contain",minWidth:200,minHeight:40}},className:P(x({layerStyle:"likec4.dropdown",p:"0",pointerEvents:{base:"all",_whenPanning:"none"},position:"absolute",top:"0",left:"0",width:"max-content",cursor:"default"})),children:n.jsxs(Rt,{css:{gap:"3",padding:"4",paddingTop:"2"},children:[p&&n.jsx(hw,{diagramEdge:t}),n.jsx(Ce,{variant:"default",color:"gray",size:"compact-xs",style:{alignSelf:"flex-start",fontWeight:500,"--button-fz":"var(--font-sizes-xxs)"},onClick:v=>{v.stopPropagation(),C.openRelationshipDetails(t.id)},children:"browse relationships"}),o.length>0&&n.jsxs(n.Fragment,{children:[n.jsx(Ot,{children:"DIRECT RELATIONSHIPS"}),o.map(b)]}),a.length>0&&n.jsxs(n.Fragment,{children:[n.jsx(Ot,{css:{mt:o.length>0?"2":"0"},children:"RESOLVED FROM NESTED"}),a.map(b)]})]})})},hw=({diagramEdge:e})=>{const t=e.drifts;return!t||t.length===0?null:n.jsx(Si,{color:"orange",withBorder:!1,withCloseButton:!1,title:"Changes:",children:t.map(o=>n.jsxs(L,{mt:2,size:"sm",lh:"xs",children:["- ",o]},o))})},mw=h.forwardRef(({viewId:e,relationship:t,sourceNode:o,targetNode:a,onNavigateTo:i,onOpenSource:r},s)=>{const l=tl(t,"source",o),d=tl(t,"target",a),u=i&&t.navigateTo?.id!==e?t.navigateTo?.id:void 0,c=t.links,p=t.hasMetadata()?zn(t.getMetadata()).sort(([m],[y])=>m.localeCompare(y)):null,g=p&&n.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"6px"},children:[n.jsx("div",{style:{fontWeight:600,fontSize:"10px",color:"#868e96",marginBottom:"2px",letterSpacing:"0.5px",textTransform:"uppercase"},children:"Metadata"}),n.jsx("div",{style:{borderTop:"1px solid rgba(0, 0, 0, 0.1)",paddingTop:"6px",display:"flex",flexDirection:"column",gap:"6px"},children:p.map(([m,y])=>{const w=Array.isArray(y)?y.join(", "):y;return n.jsxs("div",{style:{display:"flex",gap:"12px",fontSize:"12px",lineHeight:"1.4"},children:[n.jsxs("span",{style:{fontWeight:600,minWidth:"110px",color:"#495057"},children:[m,":"]}),n.jsx("span",{style:{color:"#212529",wordBreak:"break-word",flex:1},children:w})]},m)})})]});return n.jsxs(Rt,{ref:s,className:Nd({block:"2",inline:"2",paddingY:"2.5",paddingX:"2",gap:"1",rounded:"sm",backgroundColor:{_hover:{base:"mantine.colors.gray[1]",_dark:"mantine.colors.dark[5]/70"}}}),children:[n.jsx(te,{gap:"0.5",children:n.jsxs(In,{openDelay:200,children:[n.jsx(so,{label:l.full,offset:2,position:"top-start",children:n.jsx(L,{component:"div","data-likec4-color":o.color,className:el,children:l.short})}),n.jsx(Yt,{stroke:2.5,size:"11px",opacity:.65}),n.jsx(so,{label:d.full,offset:2,position:"top-start",children:n.jsx(L,{component:"div","data-likec4-color":a.color,className:el,children:d.short})}),u&&n.jsx(so,{label:"Open dynamic view",children:n.jsx(Q,{size:"sm",radius:"sm",variant:"default",onClick:m=>{m.stopPropagation(),i?.(u)},style:{alignSelf:"flex-end"},role:"button",children:n.jsx($e,{size:"80%",stroke:2})})}),r&&n.jsx(so,{label:"Open source",children:n.jsx(Q,{size:"sm",radius:"sm",variant:"default",onClick:m=>{m.stopPropagation(),r()},role:"button",children:n.jsx(Jt,{size:"80%",stroke:2})})})]})}),n.jsxs(te,{gap:"xs",alignItems:"center",children:[n.jsx(U,{className:lw,children:t.title||"untitled"}),g&&n.jsx(so,{label:g,w:350,position:"right",offset:10,openDelay:300,withArrow:!0,bg:"white",c:"dark",withinPortal:!0,styles:{tooltip:{boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)",border:"1px solid #dee2e6"}},children:n.jsx(U,{display:"inline-flex",children:n.jsx(Po,{size:14,opacity:.5,style:{flexShrink:0,cursor:"help"}})})})]}),t.kind&&n.jsxs(te,{gap:"2",children:[n.jsx(Ot,{children:"kind"}),n.jsx(L,{size:"xs",className:x({userSelect:"all"}),children:t.kind})]}),t.technology&&n.jsxs(te,{gap:"2",children:[n.jsx(Ot,{children:"technology"}),n.jsx(L,{size:"xs",className:x({userSelect:"all"}),children:t.technology})]}),t.summary.nonEmpty&&n.jsxs(n.Fragment,{children:[n.jsx(Ot,{children:"description"}),n.jsx(U,{css:{paddingLeft:"2.5",py:"1.5",borderLeft:"2px dotted",borderLeftColor:{base:"mantine.colors.gray[3]",_dark:"mantine.colors.dark[4]"}},children:n.jsx(Nt,{value:t.summary,fontSize:"sm",textScale:.875})})]}),c.length>0&&n.jsxs(n.Fragment,{children:[n.jsx(Ot,{children:"links"}),n.jsx(te,{gap:"1",flexWrap:"wrap",children:c.map(m=>n.jsx(dr,{size:"sm",value:m},m.url))})]})]})}),Ot=mt("div",{base:{display:"block",fontSize:"xxs",fontWeight:500,userSelect:"none",lineHeight:"sm",color:"mantine.colors.dimmed"}}),so=je.withProps({color:"dark",fz:"xs",label:"",children:null,offset:8,withinPortal:!1});function tl(e,t,o){const a=e.isDeploymentRelation()?o.id:o.modelRef||"",i=e[t].id,r=mi(a)+i.slice(a.length);return{full:i,short:r}}const fw=h.memo(()=>{const[{layout:e,isActive:t},{toggleCompare:o}]=nr(),a=e==="manual"?"var(--mantine-color-orange-6)":"var(--mantine-color-green-6)";return n.jsx(U,{className:me({position:"absolute",top:"0",left:"0",width:"full",height:"full",border:"default",borderWidth:4,pointerEvents:"none",alignItems:"flex-start",justifyContent:"center"}),style:{zIndex:"9999",display:t?void 0:"none",borderColor:a},children:n.jsx(yw,{style:{backgroundColor:a},onClick:i=>{i.stopPropagation(),o()},children:"Close compare"})})}),yw=de.withProps({className:x({fontSize:"xs",fontWeight:"medium",py:"1.5",lineHeight:"1",borderBottomLeftRadius:"sm",borderBottomRightRadius:"sm",transform:"translateY(-4px)",px:"4",color:"mantine.colors.gray[9]",pointerEvents:"all",_active:{transform:"translateY(-3px)"}})}),Ia=x({position:"absolute",bottom:"0",right:"0",padding:"2",margin:"0",width:"min-content",height:"min-content",_print:{display:"none"}}),xw=x({"--ai-radius":"0px",_noReduceGraphics:{"--ai-radius":"{radii.md}"}}),bw=x({cursor:"default",userSelect:"none",minWidth:200,maxWidth:"calc(100vw - 20px)",backgroundColor:"mantine.colors.body/80",sm:{minWidth:300,maxWidth:"65vw"},md:{maxWidth:"40vw"},_dark:{backgroundColor:"mantine.colors.dark[6]/80"}}),ww=x({padding:"xxs"}),vw=x({backgroundColor:"transparent",transition:"all 100ms ease-in",_hover:{transition:"all 120ms ease-out",backgroundColor:"mantine.colors.primary[2]/50"},_dark:{_hover:{backgroundColor:"mantine.colors.dark[3]/40"}}});x({fill:"var(--likec4-palette-fill)",stroke:"var(--likec4-palette-stroke)",strokeWidth:1,overflow:"visible",width:"100%",height:"auto",filter:`
    drop-shadow(0 2px 3px rgb(0 0 0 / 22%))
    drop-shadow(0 1px 8px rgb(0 0 0 / 10%))
  `});const kw=x({fontWeight:500,letterSpacing:"0.2px",paddingTop:"0",paddingBottom:"0",textTransform:"lowercase",transition:"all 150ms ease-in-out",cursor:"pointer","--badge-radius":"2px","--badge-fz":"9.5px","--badge-padding-x":"3px","--badge-height":"13.5px","--badge-lh":"1","--badge-bg":"var(--likec4-palette-fill)","--badge-color":"var(--likec4-palette-hiContrast)"}),jw=({value:e})=>{const{title:t,color:o="primary",shape:a="rectangle"}=e,[i,r]=h.useState(null),s=H(),l=300,d=200;return n.jsx(gp,{shadow:"none",px:"xs",py:"sm",className:P(vw),"data-likec4-color":o,onMouseEnter:()=>{r(null),s.highlightNotation(e)},onMouseLeave:()=>{r(null),s.unhighlightNotation()},children:n.jsxs(ce,{gap:"sm",align:"stretch",wrap:"nowrap",children:[n.jsx(q,{flex:"0 0 70px",style:{position:"relative",width:70,height:hp(70*(d/l),0)},children:n.jsx(io,{data:{shape:a,width:l,height:d}})}),n.jsxs(Ee,{gap:4,flex:1,children:[n.jsx(ce,{gap:4,flex:"0 0 auto",children:e.kinds.map(u=>n.jsx(St,{className:P(kw),onMouseEnter:()=>{r(u),s.highlightNotation(e,u)},onMouseLeave:()=>{r(null),s.highlightNotation(e)},opacity:$l(i)&&i!==u?.25:1,children:u},u))}),n.jsx(L,{component:"div",fz:"sm",fw:500,lh:"1.25",style:{textWrap:"pretty"},children:t})]})]})})},Cw=e=>({id:e.view.id,notations:e.view.notation?.nodes??[]}),Sw=h.memo(()=>{const e=Oi(l=>l.height),{id:t,notations:o}=ze(Cw),[a,i]=rp({key:"notation-webview-collapsed",defaultValue:!0}),r=o.length>0,s=no();return n.jsxs(he,{children:[!r&&n.jsx(Be.div,{initial:{opacity:.75,translateX:"50%"},animate:{opacity:1,translateX:0},exit:{translateX:"100%",opacity:.6},className:Ia,children:n.jsx(je,{label:"View has no notations",color:"orange",...s,children:n.jsx(Xe,{size:"lg",variant:"light",color:"orange",radius:"md",children:n.jsx(ld,{})})})},"empty"),r&&a&&n.jsx(Be.div,{initial:{opacity:.75,translateX:"50%"},animate:{opacity:1,translateX:0},exit:{translateX:"100%",opacity:.6},className:Ia,children:n.jsx(je,{label:"Show notation",color:"dark",fz:"xs",...s,children:n.jsx(Q,{size:"lg",variant:"default",color:"gray",className:xw,onClick:()=>i(!1),children:n.jsx(ph,{stroke:1.5})})})},"collapsed"),r&&!a&&n.jsx(Be.div,{initial:{opacity:.75,scale:.2},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.25},className:P("react-flow__panel",Ia),style:{transformOrigin:"bottom right"},children:n.jsx(Mi,{radius:"sm",withBorder:!0,shadow:"lg",className:bw,children:n.jsxs(Ll,{defaultValue:"first",radius:"xs",children:[n.jsxs(Tl,{children:[n.jsx(Q,{size:"md",variant:"subtle",color:"gray",ml:2,style:{alignSelf:"center"},onClick:()=>i(!0),children:n.jsx(Wg,{stroke:2})}),n.jsx(Ga,{value:"first",fz:"xs",children:"Elements"}),n.jsx(Ga,{value:"second",fz:"xs",disabled:!0,children:"Relationships"})]}),n.jsx(Vt,{value:"first",className:ww,hidden:a,children:n.jsx(qe,{viewportProps:{style:{maxHeight:`min(40vh, ${Math.max(e-60,50)}px)`}},children:n.jsx(Ee,{gap:0,children:o.map((l,d)=>n.jsx(jw,{value:l},d))})})})]})})},t)]})}),Qc=h.memo(()=>{const{enableControls:e,enableNotations:t,enableSearch:o,enableRelationshipDetails:a,enableReadOnly:i,enableCompareWithLatest:r}=Z(),s=sp(),l=mf(),d=yf(),u=h.useCallback(()=>{console.warn("DiagramUI: resetting error boundary and rerendering..."),s()},[]);return n.jsxs(Ki,{onReset:u,children:[e&&n.jsx(Bc,{}),l&&n.jsx(bb,{overlaysActorRef:l}),t&&n.jsx(Sw,{}),o&&d&&n.jsx(aw,{searchActorRef:d}),a&&i&&n.jsx(cw,{}),r&&n.jsx(fw,{})]})});Qc.displayName="DiagramUI";function Jc({edgeProps:{data:e},svgPath:t}){const o=e.drifts;return!o||o.length===0?null:n.jsx("path",{className:P("react-flow__edge-path",x({pointerEvents:"none",stroke:"likec4.compare.manual.outline",fill:"none",strokeWidth:{base:"8px",_whenHovered:"12px"},strokeOpacity:.5})),d:t,strokeLinecap:"round"})}const _w=x({overflow:"visible",position:"absolute",pointerEvents:"none",top:"0",left:"0",mixBlendMode:{_dark:"screen",_light:"multiply"}}),Pw=x({fill:"[var(--xy-edge-stroke)]",stroke:"transparent",fillOpacity:.5,strokeWidth:10,r:4,cursor:"grab",pointerEvents:"all",visibility:"hidden",transitionDuration:"120ms",transitionProperty:"visibility, fill, fill-opacity, r",transitionTimingFunction:"inOut",transitionDelay:"20ms",":where([data-likec4-selected='true'], [data-likec4-hovered='true']) &":{visibility:"visible",fillOpacity:1,transitionTimingFunction:"out",transitionDelay:"0ms"},":where([data-likec4-selected='true']) &":{r:6},":is([data-likec4-hovered='true']) &":{r:8},_hover:{fill:"mantine.colors.primary.filledHover",r:10,transitionDuration:"100ms"},_groupActive:{cursor:"grabbing"}});function Mw({sourceX:e,sourceY:t,targetX:o,targetY:a,data:i}){const[r,s]=h.useState(()=>i.controlPoints??xn(i.points));ht(()=>{const d=i.controlPoints??xn(i.points);s(u=>I(u,d)?u:d)},[i.controlPoints?.map(d=>`${Math.round(d.x)},${Math.round(d.y)}`).join("|")??"",i.points.map(d=>`${Math.round(d[0])},${Math.round(d[1])}`).join("|")]);const l=D(({x:d,y:u})=>{const c=ne(e,t),p=ne(o,a),g=[i.dir==="back"?p:c,...r.map(ne)||[],i.dir==="back"?c:p],m=ne(d,u).round();let y=0,w=1/0;for(let b=0;b<g.length-1;b++){const v=g[b],j=g[b+1],f=j.subtract(v),k=m.subtract(v),S=m.subtract(j);if(f.dot(k)*f.dot(S)<0){const E=Math.abs(f.cross(k))/f.length();E<w&&(w=E,y=b)}}const C=r.slice();return C.splice(y,0,{x:m.x,y:m.y}),s(C),C});return{controlPoints:r,setControlPoints:s,insertControlPoint:l}}const Nw=lp().curve(dp.alpha(.7)).x(e=>Math.round(e.x)).y(e=>Math.round(e.y)),Ew=(e,t)=>Zr(e.sourceNode,t.sourceNode)&&Zr(e.targetNode,t.targetNode);function Iw({props:{sourceX:e,sourceY:t,source:o,target:a,targetX:i,targetY:r,data:s},controlPoints:l,isControlPointDragging:d}){const{sourceNode:u,targetNode:c}=Oi(h.useCallback(({nodeLookup:p})=>{const g=W(p.get(o),`source node ${o} not found`),m=W(p.get(a),`target node ${a} not found`);return{sourceNode:ei(g),targetNode:ei(m)}},[o,a]),Ew);if(ye(s.controlPoints)||d){const p={x:e,y:t},g={x:i,y:r},m=6,y=s.dir==="back"?[g,Xo(c,yo(l)??p,m),...l,Xo(u,pt(l)??g,m),p]:[p,Xo(u,yo(l)??g,m),...l,Xo(c,pt(l)??p,m),g];return W(Nw(y))}return Mm(s.points)}const ol=e=>{const t=e.getPointAtLength(e.getTotalLength()*.5);return{x:Math.round(t.x),y:Math.round(t.y)}},eu=lr(e=>{const[t,o]=h.useState(!1),a=h.useRef(t);a.current=t;const i=md(),r=H(),{enableNavigateTo:s,enableReadOnly:l,enableCompareWithLatest:d}=Z(),u=!l,{id:c,selected:p=!1,data:{labelBBox:g,labelXY:m,...y}}=e,w=s&&!t?y.navigateTo:void 0,{controlPoints:C,setControlPoints:b,insertControlPoint:v}=Mw(e);let j=Iw({props:e,controlPoints:C,isControlPointDragging:t}),f=g?.x??0,k=g?.y??0;const[S,E]=h.useState({x:m?.x??f,y:m?.y??k});ht(()=>{if(a.current)return;const R={x:f,y:k};E(K=>bn(K,R)?K:R)},[f,k]);const B=h.useRef(null);h.useEffect(()=>{const R=B.current;if(!R||!t)return;const K=ol(R);E(_e=>bn(_e,K)?_e:K)},[j,t]);const _=D(R=>{const K=B.current?ol(B.current):null;g&&K?r.updateEdgeData(c,{controlPoints:R,labelBBox:{...g,...K}}):r.updateEdgeData(c,{controlPoints:R}),r.stopEditing(!0),o(!1)}),Y=D(()=>{r.startEditing("edge"),o(!0)}),F=D(()=>{r.stopEditing(),o(!1)}),$=D(R=>{b(R),requestAnimationFrame(()=>{_(R)})}),N=D(R=>{r.startEditing("edge"),o(!0),b(R),requestAnimationFrame(()=>{_(R)})}),V=D(R=>{if(R.pointerType!=="mouse"||R.button!==2&&!p)return;R.stopPropagation(),R.preventDefault(),r.startEditing("edge");const K=v(i.screenToFlowPosition({x:R.clientX,y:R.clientY},{snapToGrid:!1}));r.updateEdgeData(c,{controlPoints:K}),r.stopEditing(!0)});return t&&!e.data.hovered&&(e={...e,data:{...e.data,hovered:!0}}),n.jsxs(n.Fragment,{children:[n.jsxs(Bo,{...e,className:x({"& .react-flow__edge-interaction":{cursor:u&&p?"copy":void 0}}),children:[n.jsx(To,{edgeProps:e,svgPath:j,ref:B,isDragging:t,...u&&{onEdgePointerDown:V}}),d&&n.jsx(Jc,{edgeProps:e,svgPath:j}),g&&n.jsx(Zn,{edgeProps:e,labelPosition:t?S:{x:f,y:k},children:n.jsx(Lo,{pointerEvents:u?"none":"all",edgeProps:e,children:w&&n.jsx(Gn,{onClick:R=>{R.stopPropagation(),r.navigateTo(w)}})})})]}),u&&C.length>0&&n.jsx(Rw,{isControlPointDragging:t,edgeProps:e,controlPoints:C,onMove:b,onStartMove:Y,onCancelMove:F,onFinishMove:$,onDelete:N,zIndex:9999})]})});eu.displayName="RelationshipEdge";function Rw({isControlPointDragging:e,edgeProps:t,controlPoints:o,onMove:a,onStartMove:i,onCancelMove:r,onFinishMove:s,onDelete:l,zIndex:d}){const u=Hi(),c=md(),p=t.data.id,g=(C,b,v)=>{let j=!1,f={x:b.clientX,y:b.clientY},k=null,S=o;const E=_=>{const Y={x:_.clientX,y:_.clientY};bn(f,Y)||(j||(j=!0,i()),f=Y,k??=requestAnimationFrame(()=>{k=null,S=S.slice();const{x:F,y:$}=c.screenToFlowPosition(f,{snapToGrid:!1});S[C]={x:Math.round(F),y:Math.round($)},a(S)})),_.stopPropagation()},B=_=>{_.stopPropagation(),v.removeEventListener("pointermove",E,{capture:!0}),v.removeEventListener("click",Ra,{capture:!0}),j?s(S):r()};v.addEventListener("pointermove",E,{capture:!0}),v.addEventListener("pointerup",B,{once:!0,capture:!0}),v.addEventListener("click",Ra,{capture:!0,once:!0})},m=(C,b)=>{if(o.length<=1)return;b.stopPropagation(),b.preventDefault();const v=o.slice();v.splice(C,1),setTimeout(()=>{l(v)},10)},y=D(C=>{const{domNode:b,addSelectedEdges:v,edges:j,unselectNodesAndEdges:f}=u.getState();if(!b||C.pointerType!=="mouse")return;const k=parseFloat(C.currentTarget.getAttribute("data-control-point-index")||"");if(isNaN(k))throw new Error("data-control-point-index is not a number");switch(C.button){case 0:{C.stopPropagation(),f({edges:j.filter(S=>S.selected&&S.id!==p)}),v([p]),g(k,C,b);break}case 2:m(k,C);break}}),w=D(C=>{const{domNode:b}=u.getState();if(!b||C.pointerType!=="mouse")return;const v=parseFloat(C.currentTarget.getAttribute("data-control-point-index")||"");if(isNaN(v))throw new Error("data-control-point-index is not a number");m(v,C)});return n.jsx(Wl,{children:n.jsx(Bo,{component:"svg",className:_w,...t,style:{...t.style,zIndex:d},children:n.jsx("g",{"data-active":e?!0:void 0,className:"group",onContextMenu:Ra,children:o.map((C,b)=>n.jsx("circle",{"data-control-point-index":b,onPointerDownCapture:y,onDoubleClick:w,className:P("nodrag nopan",Pw),cx:C.x,cy:C.y},"controlPoints"+p+"#"+b))})})})}const Ra=e=>{e.stopPropagation(),e.preventDefault()},tn=16;function Dw(e){const{enableNavigateTo:t,enableCompareWithLatest:o}=Z(),a=H(),{navigateTo:i}=e.data,r=e.source===e.target,s=e.sourceX>e.targetX,[l]=Yp({sourceX:e.sourceX,sourceY:e.sourceY,sourcePosition:e.sourcePosition,targetX:e.targetX,targetY:e.targetY,targetPosition:e.targetPosition,...r&&{offset:30,borderRadius:16}});let d=e.sourceX;switch(!0){case r:d=e.sourceX+24+tn;break;case s:d=e.sourceX-tn;break;default:d=e.sourceX+tn;break}return n.jsxs(Bo,{...e,children:[n.jsx(To,{edgeProps:e,svgPath:l}),o&&n.jsx(Jc,{edgeProps:e,svgPath:l}),n.jsx(Zn,{edgeProps:e,labelPosition:{x:d,y:e.sourceY+(r?0:tn),translate:s?"translate(-100%, 0)":void 0},children:n.jsx(Lo,{edgeProps:e,children:t&&i&&n.jsx(Gn,{onClick:u=>{u.stopPropagation(),a.navigateTo(i)}})})})]})}const xt={ElementNode:o0,DeploymentNode:n0,CompoundElementNode:a0,CompoundDeploymentNode:i0,ViewGroupNode:r0,SequenceActorNode:c0,SequenceParallelArea:u0},nl={RelationshipEdge:eu,SequenceStepEdge:Dw};class Ht{static LeftPadding=42;static RightPadding=42;static TopPadding=60;static BottomPadding=42;id;minX=1/0;minY=1/0;maxX=-1/0;maxY=-1/0;initialX;initialY;get positionAbsolute(){return{x:this.minX,y:this.minY}}get initialPositionAbsolute(){return{x:this.initialX,y:this.initialY}}set positionAbsolute(t){const o=Math.round(t.x),a=Math.round(t.y);this.maxX+=o-this.minX,this.maxY+=a-this.minY,this.minX=o,this.minY=a}get dimensions(){return{width:Math.round(this.maxX-this.minX),height:Math.round(this.maxY-this.minY)}}get diff(){return{x:Math.round(this.positionAbsolute.x-this.initialX),y:Math.round(this.positionAbsolute.y-this.initialY)}}get isMoved(){return this.diff.x!==0||this.diff.y!==0}get position(){const t=this.positionAbsolute;if(!this.parent)return t;const o=this.parent.positionAbsolute;return{x:t.x-o.x,y:t.y-o.y}}constructor(t,o=null){this.id=t.id,this.positionAbsolute=o?{x:t.position.x+o.minX,y:t.position.y+o.minY}:t.position;const{width:a,height:i}=Et(t);this.maxX=this.minX+Math.ceil(a),this.maxY=this.minY+Math.ceil(i),this.initialX=this.positionAbsolute.x,this.initialY=this.positionAbsolute.y,o&&o.children.push(this)}}class Da extends Ht{constructor(t,o=null){super(t,o),this.parent=o}children=[]}class Bw extends Ht{constructor(t,o=null){super(t,o),this.parent=o}}function Lw(e,t){const o=e.data.controlPoints??null;return a=>{const i=W(a.get(e.id),`Edge ${e.id} not found`),{x:r,y:s}=t.diff;return r===0&&s===0?{id:e.id,type:"replace",item:Ke(i,l=>{l.data.points=e.data.points,l.data.controlPoints=o,l.data.labelBBox=e.data.labelBBox})}:{id:e.id,type:"replace",item:Ke(i,l=>{l.data.points=ie(e.data.points,d=>[d[0]+r,d[1]+s]),o&&(l.data.controlPoints=o.map(d=>({x:d.x+r,y:d.y+s}))),e.data.labelBBox&&(l.data.labelBBox={x:e.data.labelBBox.x+r,y:e.data.labelBBox.y+s,width:e.data.labelBBox.width,height:e.data.labelBBox.height})})}}}function Tw(e,t,o,a){const i=e.data.controlPoints??xn(e.data.points),r=ne(Me.center(o)),s=ne(Me.center(a)),l=r.subtract(s),d=l.length();return u=>{const c=W(u.get(e.id),`Edge ${e.id} not found`),{x:p,y:g}=t.diff;if(p===0&&g===0)return{id:e.id,type:"replace",item:Ke(c,w=>{w.data.points=e.data.points,w.data.controlPoints=e.data.controlPoints,w.data.labelBBox=e.data.labelBBox})};const m=ne(p,g),y=w=>{const C=ne(w),b=C.subtract(s).dot(l),v=De(b/d**2,{min:-1,max:1});return C.add(m.multiply(v)).round().toObject()};return{id:e.id,type:"replace",item:Ke(c,w=>{if(w.data.controlPoints=i.map(y),e.data.labelBBox){w.data.labelBBox??=e.data.labelBBox;const{x:C,y:b}=y(e.data.labelBBox);w.data.labelBBox.x=C,w.data.labelBBox.y=b}})}}}function tu(e,t){const{parentLookup:o,nodeLookup:a,edges:i}=e.getState(),r=new Map,s=new cn(j=>{let f=a.get(j)?.parentId;return f?[f,...s.get(f)]:[]}),l=new cn(j=>{const f=o.get(j);if(!f||f.size===0)return new Set;const k=new Set;for(const S of f.values()){k.add(S.id);for(const E of l.get(S.id))k.add(E)}return k});if(xe(t,2)){const j=se(t,Xl(f=>[...l.get(f)]),hn(),f=>Sp(t,f));O(xe(j,1),"All editing nodes are nested within each other"),t=j}const d=new Set(t.flatMap(j=>s.get(j))),u=[...a.values()].flatMap(j=>j.parentId?[]:{xynode:j,parent:null});for(;u.length>0;){const{xynode:j,parent:f}=u.shift();if(!t.includes(j.id)&&d.has(j.id)){const k=new Da(j,f);r.set(j.id,k),o.get(j.id)?.forEach(S=>{u.push({xynode:S,parent:k})});continue}r.set(j.id,new Bw(j,f))}const c=[...r.values()],p=new Map,g=j=>r.get(j)??s.get(j).map(f=>r.get(f)).find(f=>!!f)??null,m=new Set(t.flatMap(j=>[j,...l.get(j)]));for(const j of i){const f=m.has(j.source),k=m.has(j.target);if(f&&k){let S=r.get(j.source)??r.get(j.target)??g(j.source)??g(j.target);S&&p.set(j,Lw(j,S));continue}if(f!==k){const S=g(f?j.source:j.target);if(!S)continue;const[E,B]=se([j.source,j.target],ie(F=>W(a.get(F),`Node ${F} not found`)),ie(ei)),[_,Y]=f?[E,B]:[B,E];p.set(j,Tw(j,S,_,Y));continue}}function y(j){for(const f of j){if(!(f instanceof Da))continue;y(f.children);const k={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};for(const S of f.children)k.minX=Math.min(k.minX,S.minX),k.minY=Math.min(k.minY,S.minY),k.maxX=Math.max(k.maxX,S.maxX),k.maxY=Math.max(k.maxY,S.maxY);f.minX=k.minX-Ht.LeftPadding,f.minY=k.minY-Ht.TopPadding,f.maxX=k.maxX+Ht.RightPadding,f.maxY=k.maxY+Ht.BottomPadding}}const w=[...p.values()];function C(){y(c);const j=c.reduce((B,_)=>(B.push({id:_.id,type:"position",dragging:!1,position:_.position,positionAbsolute:_.positionAbsolute}),_ instanceof Da&&B.push({id:_.id,type:"dimensions",setAttributes:!0,dimensions:_.dimensions}),B),[]),{edgeLookup:f,triggerNodeChanges:k,triggerEdgeChanges:S}=e.getState();k(j);const E=w.map(B=>B(f));E.length>0&&S(E)}let b=null;function v(){c.length!==0&&(b??=requestAnimationFrame(()=>{b=null;for(const j of t){const f=r.get(j);if(!f){console.warn(`Rect not found for id ${j}`);continue}const k=a.get(j);if(!k){console.warn(`Node not found for id ${j}`);continue}f.positionAbsolute=k.internals.positionAbsolute}C()}))}return{rects:r,onMove:v,updateXYFlow:C}}function Aw(){const e=Hi(),t=H(),o=h.useRef(void 0);return h.useMemo(()=>({onNodeDragStart:(a,i)=>{t.startEditing("node");const{nodeLookup:r}=e.getState(),s=se(Array.from(r.values()),Ct(l=>l.dragging===!0||l.id===i.id||l.selected===!0),ie(l=>l.id));xe(s,1)&&(o.current=tu(e,s))},onNodeDrag:a=>{o.current?.onMove()},onNodeDragStop:a=>{const i=o.current?Nu(o.current.rects.values(),r=>r.isMoved):!1;t.stopEditing(i),o.current=void 0}}),[e,t])}const zw={relationship:nl.RelationshipEdge,"seq-step":nl.SequenceStepEdge},dt={element:et(xt.ElementNode),deployment:et(xt.DeploymentNode),"compound-element":et(xt.CompoundElementNode),"compound-deployment":et(xt.CompoundDeploymentNode),"view-group":et(xt.ViewGroupNode),"seq-actor":et(xt.SequenceActorNode),"seq-parallel":et(xt.SequenceParallelArea)};function $w(e){return!e||_t(e)?dt:{element:e.element??dt.element,deployment:e.deployment??dt.deployment,"compound-element":e.compoundElement??dt["compound-element"],"compound-deployment":e.compoundDeployment??dt["compound-deployment"],"view-group":e.viewGroup??dt["view-group"],"seq-actor":e.seqActor??dt["seq-actor"],"seq-parallel":e.seqParallel??dt["seq-parallel"]}}const Vw=({context:e,children:t})=>{const{enableReadOnly:o}=qn(e),a=o||t.editor?.getSnapshot().context.editing!=="edge";return{enableReadOnly:o,initialized:e.initialized.xydata&&e.initialized.xyflow,nodes:e.xynodes,edges:e.xyedges,pannable:e.pannable,zoomable:e.zoomable,nodesDraggable:!o&&e.nodesDraggable,nodesSelectable:e.nodesSelectable&&a,fitViewPadding:e.fitViewPadding,enableFitView:e.features.enableFitView,...!e.features.enableFitView&&{viewport:{x:-e.view.bounds.x,y:-e.view.bounds.y,zoom:1}}}},Fw=(e,t)=>e.enableReadOnly===t.enableReadOnly&&e.initialized===t.initialized&&e.pannable===t.pannable&&e.zoomable===t.zoomable&&e.nodesDraggable===t.nodesDraggable&&e.nodesSelectable===t.nodesSelectable&&e.enableFitView===t.enableFitView&&oe(e.fitViewPadding,t.fitViewPadding)&&oe(e.nodes,t.nodes)&&oe(e.edges,t.edges)&&oe(e.viewport??null,t.viewport??null);function Ww({background:e="dots",reactFlowProps:t={},children:o,renderNodes:a}){const i=H();let{enableReadOnly:r,initialized:s,nodes:l,edges:d,enableFitView:u,nodesDraggable:c,nodesSelectable:p,...g}=er(Vw,Fw);const{onNodeContextMenu:m,onCanvasContextMenu:y,onEdgeContextMenu:w,onNodeClick:C,onEdgeClick:b,onCanvasClick:v,onCanvasDblClick:j}=to(),f=Tm(),k=Aw(),S=zm(),E=Xp(()=>{S.set(!0)},f?120:400),B=qp(()=>{E.clear(),S.set(!1)},f?350:200),_=D(N=>{N&&(S.get()||E.start(),B())}),Y=D((N,V)=>{E.clear(),i.send({type:"xyflow.viewportMoved",viewport:V,manually:!!N})}),F=D(()=>{i.send({type:"xyflow.resized"})}),$=Ul(()=>$w(a),[a],hd);return ht(()=>{console.warn("renderNodes changed - this might degrade performance")},[$]),n.jsx(Xi,{nodes:l,edges:d,className:P(s?"initialized":"not-initialized"),nodeTypes:$,edgeTypes:zw,onNodesChange:D(N=>{i.send({type:"xyflow.applyNodeChanges",changes:N})}),onEdgesChange:D(N=>{i.send({type:"xyflow.applyEdgeChanges",changes:N})}),background:s?e:"transparent",fitView:!1,onNodeClick:D((N,V)=>{N.stopPropagation(),i.send({type:"xyflow.nodeClick",node:V}),C?.(i.findDiagramNode(V.id),N)}),onEdgeClick:D((N,V)=>{N.stopPropagation(),i.send({type:"xyflow.edgeClick",edge:V}),b?.(i.findDiagramEdge(V.id),N)}),onEdgeDoubleClick:D((N,V)=>{N.stopPropagation(),i.send({type:"xyflow.edgeDoubleClick",edge:V})}),onPaneClick:D(N=>{N.stopPropagation(),i.send({type:"xyflow.paneClick"}),v?.(N)}),onDoubleClick:D(N=>{N.stopPropagation(),N.preventDefault(),i.send({type:"xyflow.paneDblClick"}),j?.(N)}),onNodeMouseEnter:D((N,V)=>{N.stopPropagation(),i.send({type:"xyflow.nodeMouseEnter",node:V})}),onNodeMouseLeave:D((N,V)=>{N.stopPropagation(),i.send({type:"xyflow.nodeMouseLeave",node:V})}),onEdgeMouseEnter:D((N,V)=>{N.stopPropagation(),i.send({type:"xyflow.edgeMouseEnter",edge:V,event:N})}),onEdgeMouseLeave:D((N,V)=>{N.stopPropagation(),i.send({type:"xyflow.edgeMouseLeave",edge:V,event:N})}),onMove:_,onMoveEnd:Y,onInit:D(N=>{i.send({type:"xyflow.init",instance:N})}),onNodeContextMenu:D((N,V)=>{const R=W(i.findDiagramNode(V.id),`diagramNode ${V.id} not found`);m?.(R,N)}),onEdgeContextMenu:D((N,V)=>{const R=W(i.findDiagramEdge(V.id),`diagramEdge ${V.id} not found`);w?.(R,N)}),...y&&{onPaneContextMenu:y},...u&&{onViewportResize:F},nodesDraggable:c,nodesSelectable:p,elevateEdgesOnSelect:!r,...c&&k,...g,...t,children:o})}function Ow(e,t){try{return Vr(!1),Hw(e,t)}finally{Vr(!0)}}const ou=e=>jo(e.parent);function Hw(e,t){O(e.id===t.id,"View IDs do not match"),O(e._type===t._type,"View types do not match"),O(e._layout==="manual"&&t._layout==="auto","Views must be manual and auto");const o=new Set,a=new Set,i=c=>!o.has(typeof c=="string"?c:c.id),r=c=>a.has(c.source)&&a.has(c.target)&&i(c.source)&&i(c.target),s=new Map(t.nodes.map(c=>{c.children&&c.children.length>0&&o.add(c.id);const p=e.nodes.find(g=>g.id===c.id);return p?[c.id,qw({latest:c,manual:p})]:(a.add(c.id),[c.id,Ba(c)])}));if(a.size===s.size)return Ke(t,c=>{c._layout="manual",c.nodes=co([...s.values()]),c.edges=co(t.edges.map(Ba)),delete c.drifts});o.size>0&&Xw(s);const l=[...s.values()],d=t.edges.map(c=>{const p=c.dir??"forward",g=C=>C.source===c.source&&C.target===c.target&&(C.dir===p||!C.dir&&!c.dir);let m=e.edges.find(C=>C.id===c.id&&g(C));if(m||(m=e.edges.find(C=>g(C))),m)return Yw({latest:c,manual:m});if(r(c))return Ba(c);const y=s.get(c.source),w=s.get(c.target);return Gw(c,y,w)}),u=Me.merge(...l.filter(ou));return Ke(t,c=>{c._layout="manual",c.nodes=co(l),c.edges=co(d),c.bounds=u,delete c.drifts})}const At={Left:42,Right:42,Top:60,Bottom:42};function Xw(e){function t(o){const a=W(e.get(o),`Node ${o} not found`);if(a.children.length===0)return a;const i=[];for(const s of a.children)i.push(t(s));const r=Me.merge(...i);return a.x=r.x-At.Left,a.y=r.y-At.Top,a.width=r.width+At.Left+At.Right,a.height=r.height+At.Top+At.Bottom,a}for(const o of e.values())!ou(o)||o.children.length===0||t(o.id)}function qw({latest:e,manual:t}){return O(t.id===e.id,"Node IDs do not match"),Ke(e,o=>{o.x=t.x,o.y=t.y,o.drifts=null})}function Yw(e){const{manual:t,latest:o}=e;return Ke(o,a=>{t.controlPoints?a.controlPoints=t.controlPoints:delete a.controlPoints,a.points=co(t.points),t.labelBBox&&(a.labelBBox=o.labelBBox??t.labelBBox,a.labelBBox.x=t.labelBBox.x,a.labelBBox.y=t.labelBBox.y),a.drifts=null})}function Ba(e){if("drifts"in e&&e.drifts!==null){const t={...e};return t.drifts=null,t}return e}function Gw(e,t,o){const a=Zw(t,o),i=a[0];return Ke(e,r=>{r.controlPoints=a,e.labelBBox&&(r.labelBBox.x=i.x,r.labelBBox.y=i.y),delete r.drifts})}function al(e,t,o){const a=e.width/2/o.x,i=e.height/2/o.y,r=Math.min(Math.abs(a),Math.abs(i));return ne(o).multiply(r).add(t)}function Zw(e,t){const o=ne(Me.center(e)),a=ne(Me.center(t));if(e===t){const l=ne(0,e.height||0).multiply(-.5).add(o);return[l.add(ne(-80/2.5,-80)).round().toObject(),l.add(ne(80/2.5,-80)).round().toObject()]}const i=a.subtract(o),r=al(e,o,i),s=al(t,a,i.multiply(-1)).subtract(r);return[r.add(s.multiply(.4)).round().toObject(),r.add(s.multiply(.6)).round().toObject()]}function Uw(e){const t=Cd(),o=D(async({input:{viewId:i,current:r}})=>{if(!t)return console.error("No editor port available for applying latest to manual layout"),Promise.reject(new Error("No editor port"));const[s,l]=await Promise.all([r??Promise.resolve().then(()=>t.fetchView(i,"manual")),Promise.resolve().then(()=>t.fetchView(i,"auto"))]).catch(d=>(console.error("Failed to fetch views for applying latest to manual layout",d),Promise.reject(d)));return{updated:Ow(s,l)}}),a=D(async({input:i})=>{if(!t)return console.error("No editor port available for executing change"),Promise.reject(new Error("No editor port"));for(const r of i.changes)await Promise.resolve().then(()=>t.handleChange(e,r)).catch(s=>(console.error("Failed to execute change",{change:r,err:s}),Promise.reject(s)));return{}});return Vd.provide({actors:{applyLatest:bo(o),executeChange:bo(a)}})}function il(e){return{ref:e,get actor(){return e.current},overlays(){return W(e.current.getSnapshot().children.overlays,"Overlays actor not found")},send:t=>e.current.send(t),navigateTo:(t,o,a)=>{e.current.send({type:"navigate.to",viewId:t,...o&&{fromNode:o},...a&&{focusOnElement:a}})},navigate:t=>{e.current.send({type:`navigate.${t}`})},fitDiagram:(t=350)=>{e.current.send({type:"xyflow.fitDiagram",duration:t})},openRelationshipsBrowser:t=>{e.current.send({type:"open.relationshipsBrowser",fqn:t})},openSource:t=>{e.current.send({type:"open.source",...t})},openElementDetails:(t,o)=>{e.current.send({type:"open.elementDetails",fqn:t,fromNode:o})},openRelationshipDetails:(...t)=>{t.length===1?e.current.send({type:"open.relationshipDetails",params:{edgeId:t[0]}}):e.current.send({type:"open.relationshipDetails",params:{source:t[0],target:t[1]}})},updateNodeData:(t,o)=>{e.current.send({type:"update.nodeData",nodeId:t,data:o})},updateEdgeData:(t,o)=>{e.current.send({type:"update.edgeData",edgeId:t,data:o})},startEditing:t=>{const o=J(e.current.system).editorActorRef;O(o,"No editor actor found in diagram actor system"),o.send({type:"edit.start",subject:t})},stopEditing:(t=!1)=>{const o=J(e.current.system).editorActorRef;O(o,"No editor actor found in diagram actor system"),o.send({type:"edit.finish",wasChanged:t})},undoEditing:()=>{const t=J(e.current.system).editorActorRef;O(t,"No editor actor found in diagram actor system");const o=t.getSnapshot().context.history.length>0;return o&&t.send({type:"undo"}),o},align:t=>{e.current.send({type:"layout.align",mode:t})},resetEdgeControlPoints:()=>{e.current.send({type:"layout.resetEdgeControlPoints"})},focusNode:t=>{e.current.send({type:"focus.node",nodeId:t})},focusOnElement:t=>{const o=e.current.getSnapshot().context,a=Fd(o.xynodes,t);a&&e.current.send({type:"focus.node",nodeId:a.id,autoUnfocus:!0})},get currentView(){return e.current.getSnapshot().context.view},getContext:()=>e.current.getSnapshot().context,findDiagramNode:t=>Zt(e.current.getSnapshot().context,t),findEdge:t=>e.current.getSnapshot().context.xyedges.find(o=>o.data.id===t)??null,findDiagramEdge:t=>or(e.current.getSnapshot().context,t),startWalkthrough:()=>{e.current.send({type:"walkthrough.start"})},walkthroughStep:(t="next")=>{e.current.send({type:"walkthrough.step",direction:t})},stopWalkthrough:()=>{e.current.send({type:"walkthrough.end"})},toggleFeature:(t,o)=>{e.current.send({type:"toggle.feature",feature:t,...o!==void 0&&{forceValue:o}})},highlightNotation:(t,o)=>{e.current.send({type:"notations.highlight",notation:t,...o&&{kind:o}})},unhighlightNotation:()=>{e.current.send({type:"notations.unhighlight"})},openSearch:t=>{e.current.send({type:"open.search",...t&&{search:t}})},triggerChange:t=>{e.current.send({type:"trigger.change",change:t})},switchDynamicViewVariant:t=>{e.current.send({type:"switch.dynamicViewVariant",variant:t})}}}function gi(e,t){const o=t.view,a=e.view.id===o.id;if(o._type==="dynamic"&&o.variant==="sequence")return{xynodes:t.xynodes,xyedges:t.xyedges,view:o};const i=wn(e.xynodes,t.xynodes),r=a?qi(e.xyedges,t.xyedges):t.xyedges;return{xynodes:i,xyedges:r,view:o}}function Kw(e){const{xynodes:t,xyedges:o,focusedNode:a}=e;if(!a)return null;const i=new Set([a]),r=o.map(s=>s.source===a||s.target===a?(i.add(s.source),i.add(s.target),G.setData(s,{dimmed:!1,active:!0})):G.setData(s,{dimmed:!0,active:!1}));return{xynodes:t.map(s=>G.setDimmed(s,!i.has(s.id))),xyedges:r}}function Qw({context:e,event:t}){return A(t,"update.nodeData"),{xynodes:e.xynodes.map(o=>{if(o.id!==t.nodeId)return o;const a=Kl(o.data,t.data);return I(a,o.data)?o:{...o,data:a}})}}function Jw({context:e,event:t}){return A(t,"update.edgeData"),{xyedges:e.xyedges.map(o=>{if(o.id!==t.edgeId)return o;const a=Kl(o.data,t.data);return I(a,o.data)?o:{...o,data:a}})}}function rl(e,t,o){const a=Et(e),i=a.width/2/o.x,r=a.height/2/o.y,s=Math.min(Math.abs(i),Math.abs(r));return ne(o).multiply(s).add(t)}function nu(e,t){const o=W(e.get(t.source),`Source node ${t.source} not found`),a=W(e.get(t.target),`Target node ${t.target} not found`),i=ne(ti(o)),r=ne(ti(a));if(o===a){const u=ne(0,o.height||0).multiply(-.5).add(i);return[u.add(ne(-80/2.5,-80)).round().toObject(),u.add(ne(80/2.5,-80)).round().toObject()]}const s=r.subtract(i),l=rl(o,i,s),d=rl(a,r,s.multiply(-1)).subtract(l);return[l.add(d.multiply(.4)).round().toObject(),l.add(d.multiply(.6)).round().toObject()]}function ev(e){const{view:t}=e,o=[],a=[],i=new Map,r=fi.from(t.nodes.reduce((c,p)=>(i.set(p.id,p),p.parent||c.push({node:p,parent:null}),c),[]));let s=c=>!0;if(e.where)try{const c=Mu(e.where);s=p=>c({...Yl(p,["tags","kind"]),..."source"in p?{source:d(p.source)}:p,..."target"in p?{target:d(p.target)}:p})}catch(c){console.error("Error in where filter:",c)}const l="",d=c=>W(i.get(c),`Node not found: ${c}`);let u;for(;u=r.dequeue();){const{node:c,parent:p}=u,g=xe(c.children,1)||c.kind==on;if(g)for(const f of c.children)r.enqueue({node:d(f),parent:c});const m={x:c.x,y:c.y};p&&(m.x-=p.x,m.y-=p.y);const y={id:l+c.id,deletable:!1,position:m,zIndex:g?nt.Compound:nt.Element,style:{width:c.width,height:c.height},initialWidth:c.width,initialHeight:c.height,hidden:c.kind!==on&&!s(c),...p&&{parentId:l+p.id}},w={viewId:t.id,id:c.id,title:c.title,color:c.color,shape:c.shape,style:c.style,depth:c.depth??0,icon:c.icon??"none",tags:c.tags??null,x:c.x,y:c.y,drifts:c.drifts??null},C={viewId:t.id,id:c.id,title:c.title,technology:c.technology??null,description:c.description??null,height:c.height,width:c.width,level:c.level,color:c.color,shape:c.shape,style:c.style,icon:c.icon??null,tags:c.tags,x:c.x,y:c.y,isMultiple:c.style?.multiple??!1,drifts:c.drifts??null};if(c.kind===on){o.push({...y,type:"view-group",data:{isViewGroup:!0,...w},dragHandle:".likec4-compound-title-container"});continue}const b=c.modelRef??null,v=c.deploymentRef??null;if(!b&&!v)throw console.error("Invalid node",c),new Error("Element should have either modelRef or deploymentRef");const j={navigateTo:c.navigateTo??null};switch(!0){case(g&&!!v):{o.push({...y,type:"compound-deployment",data:{...w,...j,deploymentFqn:v,modelFqn:b}});break}case g:{O(!!b,"ModelRef expected"),o.push({...y,type:"compound-element",data:{...w,...j,modelFqn:b}});break}case!!v:{o.push({...y,type:"deployment",data:{...C,...j,deploymentFqn:v,modelFqn:b}});break}default:O(!!b,"ModelRef expected"),o.push({...y,type:"element",data:{...C,...j,modelFqn:b}})}}for(const c of t.edges){const p=c.source,g=c.target,m=l+c.id;if(!xe(c.points,2)){console.error("edge should have at least 2 points",c);continue}a.push({id:m,type:"relationship",source:l+p,target:l+g,zIndex:nt.Edge,hidden:!s(c),deletable:!1,data:{id:c.id,label:c.label,technology:c.technology,notes:c.notes??null,navigateTo:c.navigateTo,controlPoints:c.controlPoints??null,labelBBox:c.labelBBox??null,labelXY:null,points:c.points,color:c.color??"gray",line:c.line??"dashed",dir:c.dir??"forward",head:c.head??"normal",tail:c.tail??"none",astPath:c.astPath,drifts:c.drifts??null},interactionWidth:20})}return{bounds:t.bounds,xynodes:o,xyedges:a}}const au={parallel:1,actor:10},Pn={default:"gray",active:"amber"};function tv(e){const{actors:t,steps:o,compounds:a,parallelAreas:i,bounds:r}=e.sequenceLayout,s=[],l=[],d=u=>W(e.nodes.find(c=>c.id===u));for(const u of a)s.push(ov(u,d(u.origin),e));for(const u of i)s.push(nv(u,e));for(const u of t)s.push(av(u,d(u.id),r,e));for(const u of o){const c=e.edges.find(p=>p.id===u.id);if(!c)throw new Error(`Edge ${u.id} not found`);l.push(iv(u,c))}return{bounds:r,xynodes:s,xyedges:l}}function ov({id:e,x:t,y:o,width:a,height:i,depth:r},s,l){return{id:e,type:"view-group",data:{id:s.id,title:s.title,color:s.color??"gray",shape:s.shape,style:s.style,tags:s.tags,x:t,y:o,viewId:l.id,depth:r,isViewGroup:!0,drifts:s.drifts??null},position:{x:t,y:o},draggable:!1,selectable:!1,focusable:!1,style:{pointerEvents:"none"},width:a,initialWidth:a,height:i,initialHeight:i}}function nv({parallelPrefix:e,x:t,y:o,width:a,height:i},r){return{id:`seq-parallel-${e}`,type:"seq-parallel",data:{id:`seq-parallel-${e}`,title:"PARALLEL",technology:null,color:Pn.default,shape:"rectangle",style:{},tags:[],x:t,y:o,level:0,icon:null,width:a,height:i,description:null,viewId:r.id,parallelPrefix:e,drifts:null},zIndex:au.parallel,position:{x:t,y:o},draggable:!1,deletable:!1,selectable:!1,focusable:!1,style:{pointerEvents:"none"},width:a,initialWidth:a,height:i,initialHeight:i}}function av({id:e,x:t,y:o,width:a,height:i,ports:r},s,l,d){return{id:e,type:"seq-actor",data:{id:s.id,x:t,y:o,level:0,icon:s.icon??null,isMultiple:s.style.multiple??!1,title:s.title,width:a,height:i,color:s.color,navigateTo:s.navigateTo??null,shape:s.shape,style:s.style,tags:s.tags,modelFqn:s.modelRef??null,technology:s.technology??null,description:s.description??null,viewHeight:l.height,viewId:d.id,ports:r,drifts:s.drifts??null},deletable:!1,selectable:!0,zIndex:au.actor,position:{x:t,y:o},width:a,initialWidth:a,height:i,initialHeight:i}}function iv({id:e,labelBBox:t,sourceHandle:o,targetHandle:a},i){return{id:e,type:"seq-step",data:{id:e,label:i.label,technology:i.technology,notes:i.notes??null,navigateTo:i.navigateTo,controlPoints:null,labelBBox:{x:0,y:0,width:t?.width??i.labelBBox?.width??32,height:t?.height??i.labelBBox?.height??32},labelXY:null,points:i.points,color:i.color,line:i.line,dir:"forward",head:i.head??"normal",tail:i.tail??"none",astPath:i.astPath,drifts:i.drifts??null},selectable:!0,focusable:!1,zIndex:20,interactionWidth:40,source:i.source,sourceHandle:o,target:i.target,targetHandle:a}}function iu({dynamicViewVariant:e,...t}){const o=t.view,a=o._type==="dynamic",{bounds:i,xynodes:r,xyedges:s}=a&&e==="sequence"?tv(o):ev(t);return a&&o.variant!==e?{view:{...o,bounds:i,variant:e},xynodes:r,xyedges:s}:{view:i===o.bounds?o:{...o,bounds:i},xynodes:r,xyedges:s}}class ru{}class zt extends ru{constructor(t,o,a){super(),this.getEdgePosition=t,this.computePosition=o,this.propertyToEdit=a}alignTo;computeLayout(t){this.alignTo=this.getEdgePosition(t)}applyPosition(t){return{[this.propertyToEdit]:this.computePosition(this.alignTo,t)}}}class rv extends ru{layout=new Map;axisPreset;get primaryAxisCoord(){return this.axisPreset.primaryAxisCoord}get secondaryAxisCoord(){return this.axisPreset.secondaryAxisCoord}get primaryAxisDimension(){return this.axisPreset.primaryAxisDimension}get secondaryAxisDimension(){return this.axisPreset.secondaryAxisDimension}constructor(t){super(),this.axisPreset=t==="Column"?{primaryAxisDimension:"width",secondaryAxisDimension:"height",primaryAxisCoord:"x",secondaryAxisCoord:"y"}:{primaryAxisDimension:"height",secondaryAxisDimension:"width",primaryAxisCoord:"y",secondaryAxisCoord:"x"}}applyPosition(t){return this.layout?.get(t.id)??{}}computeLayout(t){const o=se(t,mn(r=>r[this.primaryAxisCoord])),a=this.getLayoutRect(o),i=this.getLayers(o);this.layout=this.buildLayout(i,a,o)}getLayoutRect(t){const o=Math.min(...t.map(s=>s.x)),a=Math.min(...t.map(s=>s.y)),i=Math.max(...t.map(s=>s.x+s.width)),r=Math.max(...t.map(s=>s.y+s.height));return{x:o,y:a,width:i-o,height:r-a}}getLayers(t){const o=[];let a=0,i=null;for(let r of t)if(i&&r[this.primaryAxisCoord]<a)i.nodes.push(r),i.primaryAxisSize=Math.max(i.primaryAxisSize,r[this.primaryAxisDimension]),i.occupiedSpace+=r[this.secondaryAxisDimension],a=Math.max(r[this.primaryAxisCoord]+r[this.primaryAxisDimension],a);else{i={primaryAxisSize:r[this.primaryAxisDimension],nodes:[r],occupiedSpace:r[this.secondaryAxisDimension],layout:null},o.push(i),a=r[this.primaryAxisCoord]+r[this.primaryAxisDimension];continue}return o.forEach(r=>r.nodes.sort((s,l)=>s[this.secondaryAxisCoord]-l[this.secondaryAxisCoord])),o}buildLayout(t,o,a){const i=new Map(a.map(y=>[y.id,y])),r=[],s=t.reduce((y,w)=>y+w.primaryAxisSize,0),l=t.length>1?(o[this.primaryAxisDimension]-s)/(t.length-1):0,d=t.reduce((y,w,C)=>t[y].occupiedSpace<w.occupiedSpace?C:y,0),u=t[d],c=t.slice(0,d).reduce((y,w)=>y+w.primaryAxisSize+l,o[this.primaryAxisCoord]),p=this.buildLayerLayout(u,o,c,i,null);u.layout=p,r.push(...p.nodePositions);let g=c+u.primaryAxisSize+l,m=u;for(let y=d+1;y<t.length;y++){const w=t[y];w.layout=this.buildLayerLayout(w,o,g,i,m),r.push(...w.layout.nodePositions),m=w.layout.refLayer??w,g+=w.primaryAxisSize+l}g=c,m=u;for(let y=d-1;y>=0;y--){const w=t[y];g-=w.primaryAxisSize+l,w.layout=this.buildLayerLayout(w,o,g,i,m),r.push(...w.layout.nodePositions),m=w.layout.refLayer??w}return new Map(r)}buildLayerLayout(t,o,a,i,r){let s=this.scoreLayout(this.spaceAround(t,o,a),i);if(t.nodes.length!=1){const l=this.scoreLayout(this.spaceBetween(t,o,a),i);s=l[0]<s[0]?l:s}if(r&&r.nodes.length-1>=t.nodes.length){const l=this.scoreLayout(this.placeInGaps(t,a,r),i);s=l[0]<s[0]?l:s}if(r&&r.nodes.length>=t.nodes.length){const l=this.scoreLayout(this.placeInCells(t,a,r),i);s=l[0]<s[0]?l:s}return s[1]}spaceBetween(t,o,a){const i=(o[this.secondaryAxisDimension]-t.occupiedSpace)/(t.nodes.length-1);let r=o[this.secondaryAxisCoord];const s=new Map;for(let l of t.nodes)s.set(l.id,{[this.secondaryAxisCoord]:r,[this.primaryAxisCoord]:a}),r+=l[this.secondaryAxisDimension]+i;return{nodePositions:s,refLayer:null}}spaceAround(t,o,a){const i=(o[this.secondaryAxisDimension]-t.occupiedSpace)/(t.nodes.length+1);let r=o[this.secondaryAxisCoord]+i;const s=new Map;for(let l of mn(t.nodes,d=>d[this.secondaryAxisCoord]))s.set(l.id,{[this.secondaryAxisCoord]:r,[this.primaryAxisCoord]:a}),r+=l[this.secondaryAxisDimension]+i;return{nodePositions:s,refLayer:null}}placeInGaps(t,o,a){const i=new Map,r=t.nodes,s=this.getGapsPositions(a);let l=0;for(let d=0,u=r[d];d<r.length;d++,u=r[d]){const c=u[this.secondaryAxisCoord]+u[this.secondaryAxisDimension]/2;let p=1/0;for(;l-d<=s.length-r.length;){const g=s[l]-c;if(Math.abs(g)<Math.abs(p))p=g,l++;else break}i.set(u.id,{[this.secondaryAxisCoord]:u[this.secondaryAxisCoord]+p,[this.primaryAxisCoord]:o})}return{nodePositions:i,refLayer:a}}placeInCells(t,o,a){const i=new Map,r=t.nodes,s=this.getNodePositions(a);let l=0;for(let d=0,u=r[d];d<r.length;d++,u=r[d]){const c=u[this.secondaryAxisCoord]+u[this.secondaryAxisDimension]/2;let p=1/0;for(;l-d<=s.length-r.length;){const g=s[l]-c;if(Math.abs(g)<Math.abs(p))p=g,l++;else break}i.set(u.id,{[this.secondaryAxisCoord]:u[this.secondaryAxisCoord]+p,[this.primaryAxisCoord]:o})}return{nodePositions:i,refLayer:a}}scoreLayout(t,o){return[se(Array.from(t.nodePositions),ie(([a,i])=>{const r=o.get(a);return O(r,`Could not find original rect for node ${a}`),[Yl(r,["x","y"]),i]}),ie(([a,i])=>Math.abs(a[this.secondaryAxisCoord]-i[this.secondaryAxisCoord])),An((a,i)=>a+i,0)),t]}getGapsPositions(t){const o=[],{layout:a,nodes:i}=t;O(a,"Layout of the layer must be computed before calling getGapsPositions");for(let r=1;r<i.length;r++){const s=i[r-1],l=i[r],d=a.nodePositions.get(s.id),u=a.nodePositions.get(l.id);o.push((u[this.secondaryAxisCoord]+d[this.secondaryAxisCoord]+s[this.secondaryAxisDimension])/2)}return o}getNodePositions(t){const o=[],{layout:a,nodes:i}=t;O(a,"Layout of the layer must be computed before calling getGapsPositions");for(let r=0;r<i.length;r++){const s=i[r],l=a.nodePositions.get(s.id);o.push(l[this.secondaryAxisCoord]+s[this.secondaryAxisDimension]/2)}return o}}function sv(e){switch(e){case"Left":return new zt(t=>Math.min(...t.map(o=>o.x)),(t,o)=>Math.floor(t),"x");case"Top":return new zt(t=>Math.min(...t.map(o=>o.y)),(t,o)=>Math.floor(t),"y");case"Right":return new zt(t=>Math.max(...t.map(o=>o.x+o.width)),(t,o)=>Math.floor(t-o.width),"x");case"Bottom":return new zt(t=>Math.max(...t.map(o=>o.y+o.height)),(t,o)=>Math.floor(t-o.height),"y");case"Center":return new zt(t=>Math.min(...t.map(o=>o.x+o.width/2)),(t,o)=>Math.floor(t-o.width/2),"x");case"Middle":return new zt(t=>Math.min(...t.map(o=>o.y+o.height/2)),(t,o)=>Math.floor(t-o.height/2),"y")}}function sl(e){const{width:t,height:o}=Et(e);return{...e.internals.positionAbsolute,id:e.id,width:t,height:o}}function lv(e){switch(e){case"Left":case"Right":case"Top":case"Bottom":case"Center":case"Middle":return sv(e);case"Column":case"Row":return new rv(e);default:Le(e)}}const vo=e=>M.createAction(({context:t,event:o})=>{let a,i;e?(a=e.viewport,i=e.duration):(A(o,"xyflow.setViewport"),a=o.viewport,i=o.duration),i=i??400;const{panZoom:r}=W(t.xystore).getState(),s=i>0?{duration:i,interpolate:"smooth"}:void 0;r?.setViewport({x:Math.round(a.x),y:Math.round(a.y),zoom:a.zoom},s).catch(l=>{console.error("Error during fitDiagram panZoom setViewport",{err:l})})}),ra=e=>M.enqueueActions(({context:t,event:o,enqueue:a})=>{let i=t.view.bounds,r;e?(i=e.bounds??t.view.bounds,r=e.duration):o.type==="xyflow.fitDiagram"&&(i=o.bounds??t.view.bounds,r=o.duration,a.assign({viewportChangedManually:!1})),r??=450;const{width:s,height:l,panZoom:d,transform:u}=W(t.xystore).getState(),c=Math.max(1,u[2]),p=Qt(i,s,l,Ae,c,t.fitViewPadding);p.x=Math.round(p.x),p.y=Math.round(p.y);const g=r>0?{duration:r,interpolate:"smooth"}:void 0;d?.setViewport(p,g).catch(m=>{console.error("Error during fitDiagram panZoom setViewport",{err:m})})}),ho=()=>M.createAction(({context:e})=>{const t=!!e.activeWalkthrough&&e.dynamicViewVariant==="sequence",{bounds:o,duration:a=450}=t?qf({context:e}):Hf({context:e}),{width:i,height:r,panZoom:s,transform:l}=W(e.xystore).getState(),d=Math.max(1,l[2]),u=Qt(o,i,r,Ae,d,e.fitViewPadding);u.x=Math.round(u.x),u.y=Math.round(u.y);const c=a>0?{duration:a,interpolate:"smooth"}:void 0;s?.setViewport(u,c).catch(p=>{console.error("Error during fitFocusedBounds panZoom setViewport",{err:p})})}),br=30,su=e=>{const{delay:t=br,...o}=e??{};return M.raise({type:"xyflow.setViewport",...o},{id:"fitDiagram",delay:t})},it=()=>M.cancel("fitDiagram"),sa=e=>{const{delay:t=br,...o}=e??{};return M.raise({type:"xyflow.fitDiagram",...o},{id:"fitDiagram",delay:t})},dv=e=>M.raise(({context:t})=>({type:"update.view",view:t.view}),{delay:br}),wr=e=>M.assign(({context:t})=>({viewportBefore:{wasChangedManually:t.viewportChangedManually,value:{...t.viewport}}})),vr=e=>M.enqueueActions(({enqueue:t,context:{viewportBefore:o}})=>{t(it()),o?(t.assign({viewportChangedManually:o.wasChangedManually,viewportBefore:null}),e&&e.delay===0?t(vo({viewport:o.value,...e})):t(su({viewport:o.value,...e}))):e&&e.delay===0?t(ra({...e})):t(sa({...e}))}),lu=()=>M.assign(({context:e})=>({toggledFeatures:{...e.toggledFeatures,enableCompareWithLatest:!1},viewportOnAutoLayout:null,viewportOnManualLayout:null})),cv=()=>M.assign(({context:e,event:t})=>{if(A(t,"xyflow.edgeDoubleClick"),!t.edge.data.controlPoints)return{};const{nodeLookup:o}=e.xystore.getState();return{xyedges:e.xyedges.map(a=>{if(a.id===t.edge.id){const i=nu(o,a),r=i[0];return{...a,data:{...a.data,controlPoints:i,labelBBox:a.data.labelBBox?{...a.data.labelBBox,...r}:null,labelXY:null}}}return a})}}),kt=()=>M.assign(({context:e,event:t})=>{A(t,"xyflow.nodeClick");const{lastClickedNode:o}=e;return!o||o.id!==t.node.id?{lastClickedNode:{id:t.node.id,clicks:1,timestamp:Date.now()}}:{lastClickedNode:{id:o.id,clicks:o.clicks+1,timestamp:Date.now()}}}),sn=()=>M.assign(({event:e})=>{let t,o=!1;switch(e.type){case"xyflow.nodeClick":t=e.node.data.id;break;case"focus.node":t=e.nodeId,o=e.autoUnfocus===!0;break;default:throw new Error(`Unexpected event type: ${e.type} in action 'assign: focusedNode'`)}return{focusedNode:t,autoUnfocusTimer:o}}),Xt=()=>M.assign(()=>({lastClickedNode:null})),du=()=>M.assign(({event:e})=>(A(e,"update.features"),{features:{...e.features}})),uv=()=>M.assign(({event:e})=>(A(e,"update.inputs"),{...e.inputs})),cu=e=>M.assign(({context:t,event:o})=>{let a;A(o,"update.view"),a="xynodes"in o?o:iu({dynamicViewVariant:t.dynamicViewVariant,view:o.view,where:t.where});const i=gi(t,a);let{lastClickedNode:r,focusedNode:s,activeWalkthrough:l}=t;if(r||s||l){const d=new Set(i.xynodes.map(c=>c.id));r&&!d.has(r.id)&&(r=null),s&&!d.has(s)&&(s=null);const u=l?.stepId;return u&&!i.xyedges.some(c=>c.id===u)&&(l=null),{...i,lastClickedNode:r,focusedNode:s,activeWalkthrough:l}}return i}),lo=()=>M.enqueueActions(({context:e,enqueue:t})=>{const o=Kw(e);o?t.assign(o):t.raise({type:"key.esc"})}),Mn=()=>M.assign(({context:e})=>({xynodes:e.xynodes.map(G.setDimmed(!1)),xyedges:e.xyedges.map(G.setData({dimmed:!1,active:!1}))})),pv=()=>M.assign(({event:e})=>(A(e,"switch.dynamicViewVariant"),{dynamicViewVariant:e.variant})),gv=e=>M.assign(({context:t,event:o})=>{let a=e?.node;return a||(A(o,"xyflow.nodeMouseEnter"),a=o.node),{xynodes:t.xynodes.map(i=>i.id===a.id?G.setHovered(i,!0):i)}}),hv=e=>M.assign(({context:t,event:o})=>{let a=e?.node;return a||(A(o,"xyflow.nodeMouseLeave"),a=o.node),{xynodes:t.xynodes.map(i=>i.id===a.id?G.setHovered(i,!1):i)}}),kr=()=>M.emit(()=>({type:"paneClick"})),uu=e=>M.emit(({event:t})=>e?{type:"openSource",params:e}:(A(t,"open.source"),{type:"openSource",params:t})),mv=()=>M.emit(({context:e})=>(O(e.xyflow,"XYFlow instance not found"),{type:"initialized",instance:e.xyflow})),jt=()=>M.emit(({context:e,event:t})=>(A(t,"xyflow.nodeClick"),{type:"nodeClick",node:W(Zt(e,t.node.id),`Node ${t.node.id} not found in diagram`),xynode:t.node})),La=e=>M.emit(({context:t})=>({type:"navigateTo",viewId:e?.viewId??W(t.lastOnNavigate,"Invalid state, lastOnNavigate is null").toView})),jr=()=>M.emit(({context:e,event:t})=>(A(t,"xyflow.edgeClick"),{type:"edgeClick",edge:W(or(e,t.edge.id),`Edge ${t.edge.id} not found in diagram`),xyedge:t.edge})),pu=e=>M.enqueueActions(({event:t,enqueue:o})=>{let a=e;a||(A(t,"trigger.change"),a=t.change),o.assign({viewportChangedManually:!0}),o.sendTo(J.editorActor,{type:"change",change:a})}),fv=()=>M.enqueueActions(({event:e,system:t,context:o,enqueue:a})=>{if(!o.features.enableCompareWithLatest){console.warn("Layout type cannot be changed while CompareWithLatest feature is disabled");return}const i=o.view._layout;let r=i==="auto"?"manual":"auto";if(e.type==="emit.onLayoutTypeChange"&&(r=e.layoutType),i===r){console.warn("Ignoring layout type change event, layout type is already",i);return}if(o.toggledFeatures.enableCompareWithLatest===!0){i==="manual"&&r==="auto"&&J(t).editorActorRef?.send({type:"cancel"});const s=o.viewport;i==="auto"&&a.assign({viewportOnAutoLayout:s}),i==="manual"&&a.assign({viewportOnManualLayout:s})}a.emit({type:"onLayoutTypeChange",layoutType:r})}),yv=e=>M.createAction(({context:t,event:o})=>{let a;A(o,"layout.align"),a=o.mode;const i=W(t.xystore,"xystore is not initialized"),{nodeLookup:r,parentLookup:s}=i.getState(),l=[...new Set(r.values().filter(p=>p.selected).map(p=>p.id)).difference(new Set(s.keys()))];if(!xe(l,2)){console.warn("At least 2 nodes must be selected to align");return}const d=tu(i,l),u=lv(a),c=l.map(p=>({node:W(r.get(p)),rect:W(d.rects.get(p))}));u.computeLayout(c.map(({node:p})=>sl(p)));for(const{rect:p,node:g}of c)p.positionAbsolute={...p.positionAbsolute,...u.applyPosition(sl(g))};d.updateXYFlow()}),xv=()=>M.assign(({context:e})=>{const{nodeLookup:t}=e.xystore.getState();return{xyedges:e.xyedges.map(o=>{if(!o.data.controlPoints)return o;const a=nu(t,o),i=a[0];return{...o,data:{...o.data,controlPoints:a,labelBBox:o.data.labelBBox?{...o.data.labelBBox,x:i.x,y:i.y}:null,labelXY:o.data.labelXY?i:null}}})}}),bv=()=>M.assign(({context:e,event:t})=>{A(t,"notations.highlight");const{notation:o,kind:a}=t,i=a?[a]:o.kinds,r=d=>d.notation===o.title&&d.shape===o.shape&&d.color===o.color&&i.includes(d.kind),s=e.xynodes.map(d=>{const u=Zt(e,d.id),c=u&&r(u);return G.setDimmed(d,c?!1:"immediate")}),l=e.xyedges.map(d=>G.setDimmed(d,!0));return{xynodes:s,xyedges:l}}),wv=()=>M.assign(({context:e,event:t})=>(A(t,"tag.highlight"),{xynodes:e.xynodes.map(o=>o.data.tags?.includes(t.tag)?G.setDimmed(o,!1):G.setDimmed(o,!0))})),vv=()=>M.assign(({context:e,event:t})=>{A(t,"toggle.feature");const o=e.toggledFeatures[`enable${t.feature}`]??e.features[`enable${t.feature}`],a=t.forceValue??!o;return{toggledFeatures:{...e.toggledFeatures,[`enable${t.feature}`]:a}}}),kv=()=>M.sendTo(J.searchActor,{type:"close"}),jv=()=>M.sendTo(J.overlaysActor,{type:"close.all"}),gu=()=>M.enqueueActions(({enqueue:e,system:t})=>{const o=J(t).editorActorRef;o&&e.stopChild(o)}),Ta=()=>M.enqueueActions(({enqueue:e,context:t,system:o,check:a})=>{const i=a("enabled: Editor"),r=J(o).editorActorRef;if(!i&&r){e.stopChild(r);return}i&&!r&&e.spawnChild("editorActor",{id:"editor",systemId:"editor",input:{viewId:t.view.id},syncSnapshot:!0})}),Aa=(e="node")=>M.sendTo(J.editorActor,{type:"edit.start",subject:e}),Cv=()=>M.sendTo(J.editorActor,{type:"synced"}),za=(e=!0)=>M.sendTo(J.editorActor,{type:"edit.finish",wasChanged:e}),hu=()=>M.sendTo(J.editorActor,{type:"cancel"}),ll=e=>"modelFqn"in e.data&&ye(e.data.modelFqn),Cr=e=>M.enqueueActions(({context:t,event:o,enqueue:a})=>{let i=null,r,s;switch(!0){case o.type==="xyflow.nodeClick":{if(!ll(o.node)){console.warn("No modelFqn in clicked node data");return}s=o.node.data.modelFqn,r=o.node.data.id;break}case o.type==="open.elementDetails":{s=o.fqn,r=o.fromNode;break}default:{if(!t.lastClickedNode){console.warn("No last clicked node");return}r=t.lastClickedNode.id;const d=t.xynodes.find(u=>u.id===r);if(!d||!ll(d)){console.warn("No modelFqn in last clicked node");return}s=d.data.modelFqn;break}}const l=r?t.xystore.getState().nodeLookup.get(r):null;if(r&&l){const d=fp(l),u=t.xyflow.getZoom(),c={...t.xyflow.flowToScreenPosition(d),width:d.width*u,height:d.height*u};i={node:r,clientRect:c}}a.sendTo(J.overlaysActor,{type:"open.elementDetails",subject:s,currentView:t.view,...i&&{initiatedFrom:i}})}),$a=()=>M.enqueueActions(({context:e,event:t,enqueue:o,check:a})=>{if(A(t,["open.relationshipsBrowser","open.relationshipDetails","open.elementDetails"]),!a("enabled: Overlays")){console.warn("Overlays feature is disabled");return}switch(t.type){case"open.elementDetails":{a("enabled: ElementDetails")?o(Cr()):console.warn("ElementDetails feature is disabled");break}case"open.relationshipsBrowser":{o.sendTo(J.overlaysActor,{type:"open.relationshipsBrowser",subject:t.fqn,viewId:e.view.id,scope:"view",closeable:!0,enableChangeScope:!0,enableSelectSubject:!0});break}case"open.relationshipDetails":{o.sendTo(J.overlaysActor,{type:"open.relationshipDetails",viewId:e.view.id,...t.params});break}default:Le(t)}}),Nn=()=>M.enqueueActions(({context:e,enqueue:t})=>{const o=e.focusedNode??e.lastClickedNode?.id;if(!o||!e.features.enableVscode)return;const a=Zt(e,o);a&&(a.deploymentRef?t.raise({type:"open.source",deployment:a.deploymentRef}):a.modelRef&&t.raise({type:"open.source",element:a.modelRef}))}),dl=()=>M.enqueueActions(({enqueue:e,check:t,system:o})=>{const a=t("enabled: Overlays"),i=J(o).overlaysActorRef;if(a&&!i){e.spawnChild("overlaysActorLogic",{id:"overlays",systemId:"overlays"});return}!a&&i&&(e.sendTo(i,{type:"close.all"}),e.stopChild("overlays"))}),cl=()=>M.enqueueActions(({enqueue:e,context:{features:{enableSearch:t}},system:o})=>{const a=J(o).searchActorRef;if(t&&!a){e.spawnChild("searchActorLogic",{id:"search",systemId:"search"});return}!t&&a&&(e.sendTo(a,{type:"close"}),e.stopChild("search"))}),Sv=()=>M.enqueueActions(({enqueue:e,context:t,event:o})=>{A(o,"xyflow.edgeMouseEnter");let a=o.edge;e.assign({xyedges:t.xyedges.map(i=>i.id===o.edge.id?(a=G.setHovered(i,!0),a):i)}),e.emit({type:"edgeMouseEnter",edge:a,event:o.event})}),_v=()=>M.enqueueActions(({enqueue:e,context:t,event:o})=>{A(o,"xyflow.edgeMouseLeave");let a=o.edge;e.assign({xyedges:t.xyedges.map(i=>i.id===o.edge.id?(a=G.setHovered(i,!1),a):i)}),e.emit({type:"edgeMouseLeave",edge:a,event:o.event})}),mu=()=>M.spawnChild("hotkeyActorLogic",{id:"hotkey"}),fu=()=>M.stopChild("hotkey"),ul=3e3,Pv=()=>M.enqueueActions(({context:e,enqueue:t})=>{e.autoUnfocusTimer&&ul>0&&t.raise({type:"focus.autoUnfocus"},{delay:ul,id:"autoUnfocusTimer"})}),Mv=()=>M.cancel("autoUnfocusTimer"),Nv=()=>M.enqueueActions(({enqueue:e,context:t,event:o})=>{A(o,["navigate.to","navigate.back","navigate.forward"]);const{view:a,focusedNode:i,activeWalkthrough:r,dynamicViewVariant:s,viewport:l,viewportChangedManually:d,viewportBefore:u,navigationHistory:{currentIndex:c,history:p}}=t;let g=[...p];if(c<p.length){const m=Ke(p[c],y=>{y.viewport={...l},y.viewportChangedManually=d,y.focusedNode=i,a._type==="dynamic"?(y.activeWalkthrough=r?.stepId??null,y.dynamicViewVariant=s):(y.activeWalkthrough=null,y.dynamicViewVariant=null),u?y.viewportBefore=u:delete y.viewportBefore});g=[...p],g[c]=m}switch(o.type){case"navigate.to":{e.assign({navigationHistory:{currentIndex:c,history:g},lastOnNavigate:{fromView:t.view.id,toView:o.viewId,fromNode:o.fromNode??null,focusOnElement:o.focusOnElement??null}}),e(La());break}case"navigate.back":{O(c>0,"Cannot navigate back");const m=g[c-1];e.assign({navigationHistory:{currentIndex:c-1,history:g},lastOnNavigate:null}),e(La({viewId:m.viewId}));break}case"navigate.forward":{O(c<g.length-1,"Cannot navigate forward");const m=g[c+1];e.assign({navigationHistory:{currentIndex:c+1,history:g},lastOnNavigate:null}),e(La({viewId:m.viewId}));break}default:Le(o)}}),Sr=()=>M.enqueueActions(({enqueue:e,event:t,context:o})=>{if(t.type!=="update.view"){console.warn(`Ignoring unexpected event type: ${t.type} in action 'update.view'`);return}const a=t.view;if(a.id!==o.view.id){console.warn("updateView called for another view - ignoring",{event:t});return}if(e(cu()),t.source==="editor")return;e(Cv());let i=!o.viewportChangedManually&&!o.focusedNode&&!o.activeWalkthrough;if(o.toggledFeatures.enableCompareWithLatest===!0&&o.view._layout!==a._layout){if(a._layout==="auto"&&o.viewportOnAutoLayout){e(vo({viewport:o.viewportOnAutoLayout,duration:0}));return}if(a._layout==="manual"&&o.viewportOnManualLayout){e(vo({viewport:o.viewportOnManualLayout,duration:0}));return}}i=i||a._type==="dynamic"&&o.view._type==="dynamic"&&a.variant!==o.view.variant,i=i||o.toggledFeatures.enableCompareWithLatest===!0&&!!a._layout&&o.view._layout!==a._layout,i&&(e(it()),e(sa({bounds:t.view.bounds})))}),Ev=M.createStateConfig({on:{"xyflow.init":{actions:z(({context:e,event:t})=>({initialized:{...e.initialized,xyflow:!0},xyflow:t.instance})),target:"isReady"},"update.view":{actions:[cu(),z(({context:e})=>({initialized:{...e.initialized,xydata:!0}}))],target:"isReady"}}}),Iv=M.createStateConfig({always:[{guard:"isReady",actions:[ra({duration:0}),z(({context:e})=>({navigationHistory:{currentIndex:0,history:[{viewId:e.view.id,viewport:{...e.xyflow.getViewport()},viewportChangedManually:!1}]}})),mv()],target:"ready"},{target:"initializing"}]}),Rv=()=>M.assign(({context:e,event:t})=>{A(t,"update.view");let{lastOnNavigate:o,navigationHistory:{currentIndex:a,history:i}}=e;const r=i[a];if(!r||r.viewId===t.view.id||o)return{};const s=a>0?W(i[a-1]):null;if(s&&s.viewId===t.view.id)return{navigationHistory:{currentIndex:a-1,history:i},lastOnNavigate:null};const l=a<i.length-1?W(i[a+1]):null;if(l&&l.viewId===t.view.id)return{navigationHistory:{currentIndex:a+1,history:i},lastOnNavigate:null};if(t.view._type==="element"&&t.view.viewOf){const d=t.view.viewOf,u=e.xynodes.find(c=>ri(c)===d);if(u)return{lastOnNavigate:{fromView:e.view.id,toView:t.view.id,fromNode:u.id}}}return{}}),Dv=M.createStateConfig({id:le.navigating.slice(1),always:{target:le.idle,actions:[it(),Rv(),lu(),Oe(({enqueue:e,context:t,event:o})=>{A(o,"update.view");const{xyflow:a,xystore:i,navigationHistory:{currentIndex:r,history:s}}=t,l="xynodes"in o?o:{...o,...iu({dynamicViewVariant:t.dynamicViewVariant,view:o.view,where:t.where})};O(a,"xyflow is not initialized");const d=C=>{const b=a.getZoom(),v=C.zoom<b?.8:.4;return b+(C.zoom-b)*v},u=s[r];if(u&&u.viewId===o.view.id){e.assign({...gi(t,l),dynamicViewVariant:u.dynamicViewVariant??t.dynamicViewVariant,viewportChangedManually:u.viewportChangedManually});const C=u.focusedNode,b=u.activeWalkthrough,v=u.viewportBefore;v&&(C||b)&&e.assign({viewport:v.value,viewportChangedManually:v.wasChangedManually,viewportBefore:null});const j=Me.center(o.view.bounds),f=d(u.viewport);if(a.setCenter(j.x,j.y,{zoom:f,duration:0}),C){e.raise({type:"focus.node",nodeId:C},{delay:50});return}if(b){e.raise({type:"walkthrough.start",stepId:b},{delay:50});return}e(su({delay:80,viewport:u.viewport}));return}const c=Zf(t,o.view.bounds),{fromNode:p,toNode:g}=Gf(t,l);if(p&&g){const C=a.getInternalNode(p.id),b=a.flowToScreenPosition({x:C.internals.positionAbsolute.x,y:C.internals.positionAbsolute.y}),v=a.flowToScreenPosition({x:g.data.x,y:g.data.y});i.getState().panBy({x:Math.round(b.x-v.x),y:Math.round(b.y-v.y)})}else{const C=d(c),b=Me.center(o.view.bounds);a.setCenter(b.x,b.y,{zoom:C,duration:0})}const m=r<s.length-1?s.slice(0,r+1):[...s];m.push({viewId:o.view.id,viewport:{...c},viewportChangedManually:!1});const y=t.lastOnNavigate?.focusOnElement,w=ye(y)?Fd(l.xynodes,y):null;e.assign({...gi(t,l),viewportChangedManually:!1,lastOnNavigate:null,navigationHistory:{currentIndex:m.length-1,history:m}}),w?e.raise({type:"focus.node",nodeId:w.id,autoUnfocus:!0},{delay:150}):e(sa({delay:100}))})]}}),Bv=M.createStateConfig({id:le.focused.slice(1),entry:[it(),lo(),wr(),Nn(),mu(),ho(),Pv()],exit:[fu(),Mn(),vr(),Mv(),z({focusedNode:null,autoUnfocusTimer:!1})],on:{"focus.autoUnfocus":{target:le.idle},"xyflow.nodeClick":[{guard:uo(["enabled: ElementDetails","click: focused node","click: node has modelFqn"]),actions:[kt(),Cr(),jt()]},{guard:"click: focused node",actions:[kt(),jt()],target:le.idle},{actions:[kt(),ve(({event:e})=>({type:"focus.node",nodeId:e.node.id})),jt()]}],"focus.node":{actions:[sn(),lo(),Nn(),ho()]},"key.esc":{target:le.idle},"xyflow.paneClick":{actions:[Xt(),kr()],target:le.idle},"notations.unhighlight":{actions:lo()},"tag.unhighlight":{actions:lo()},"update.view":{guard:"is same view",actions:[Sr(),lo()]}}}),Lv=M.createStateConfig({id:le.idle.slice(1),on:{"xyflow.nodeClick":[{guard:uo(["enabled: Readonly","enabled: FocusMode","click: node has connections",Dr(["click: same node","click: selected node"])]),actions:[kt(),sn(),jt()],target:le.focused},{guard:uo(["enabled: Readonly","enabled: ElementDetails","click: node has modelFqn",Dr(["click: same node","click: selected node"])]),actions:[kt(),Nn(),Cr(),jt()]},{actions:[kt(),Nn(),jt()]}],"xyflow.paneClick":{actions:[Xt(),kr()]},"xyflow.paneDblClick":{actions:[Xt(),Oe(({context:e,enqueue:t,check:o})=>{o("enabled: FitView")&&t(ra()),t(uu({view:e.view.id}))})]},"focus.node":[{guard:"focus.node: autoUnfocus",actions:sn(),target:le.focused},{guard:"enabled: FocusMode",actions:sn(),target:le.focused}],"xyflow.edgeClick":{guard:uo(["enabled: Readonly","is dynamic view","enabled: DynamicViewWalkthrough","click: selected edge"]),actions:[Xt(),ve(({event:e})=>({type:"walkthrough.start",stepId:e.edge.id})),jr()]}}}),Tv=M.createStateConfig({id:le.printing.slice(1),entry:[it(),wr(),Oe(({enqueue:e,context:t})=>{const o=t.view.bounds,a=16;e(vo({viewport:{x:o.x+a,y:o.y+a,zoom:1},duration:0}))})],exit:[vr({delay:0,duration:0})],on:{"media.print.off":{target:le.idle},"*":{actions:[vl(({event:e})=>`Printing state - ignoring event: ${e.type}`)]}}}),$t=()=>M.enqueueActions(({context:e,enqueue:t})=>{const{activeWalkthrough:o}=e;if(!o){console.warn("Active walkthrough is null"),t.raise({type:"walkthrough.end"});return}const{stepId:a,parallelPrefix:i}=o,r=e.xyedges.find(s=>s.id===a);if(!r){console.warn("Invalid walkthrough stepId:",a),t.raise({type:"walkthrough.end"});return}t.assign({xyedges:e.xyedges.map(s=>{const l=a===s.id||!!i&&s.id.startsWith(i);return G.setData(s,{active:l,dimmed:a!==s.id})}),xynodes:e.xynodes.map(s=>{const l=r.source!==s.id&&r.target!==s.id;return s.type==="seq-parallel"?G.setData(s,{color:i===s.data.parallelPrefix?Pn.active:Pn.default,dimmed:l}):G.setDimmed(s,l)})})}),Av=()=>M.emit(({context:e})=>{const t=e.xyedges.find(o=>o.id===e.activeWalkthrough?.stepId);return O(t,"Invalid walkthrough state"),{type:"walkthroughStarted",edge:t}}),zv=()=>M.emit(()=>({type:"walkthroughStopped"})),pl=()=>M.emit(({context:e})=>{const t=e.xyedges.find(o=>o.id===e.activeWalkthrough?.stepId);return O(t,"Invalid walkthrough state"),{type:"walkthroughStep",edge:t}}),$v=M.createStateConfig({id:le.walkthrough.slice(1),entry:[mu(),hu(),it(),wr(),z({activeWalkthrough:({context:e,event:t})=>{A(t,"walkthrough.start");const o=t.stepId??yo(e.xyedges).id;return{stepId:o,parallelPrefix:ua(o)}}}),$t(),ho(),Av()],exit:[fu(),Oe(({enqueue:e,context:t})=>{e.assign({activeWalkthrough:null}),t.dynamicViewVariant==="sequence"&&t.activeWalkthrough?.parallelPrefix&&e.assign({xynodes:t.xynodes.map(o=>o.type==="seq-parallel"?G.setData(o,{color:Pn.default}):o)})}),Mn(),vr(),zv()],on:{"key.esc":{target:le.idle},"key.arrow.left":{actions:ve({type:"walkthrough.step",direction:"previous"})},"key.arrow.up":{actions:ve({type:"walkthrough.step",direction:"previous"})},"key.arrow.right":{actions:ve({type:"walkthrough.step",direction:"next"})},"key.arrow.down":{actions:ve({type:"walkthrough.step",direction:"next"})},"walkthrough.step":{actions:[z(({context:e,event:t})=>{const{stepId:o}=e.activeWalkthrough,a=e.xyedges.findIndex(s=>s.id===o),i=De(t.direction==="next"?a+1:a-1,{min:0,max:e.xyedges.length-1});if(i===a)return{};const r=e.xyedges[i].id;return{activeWalkthrough:{stepId:r,parallelPrefix:ua(r)}}}),$t(),ho(),pl()]},"xyflow.edgeClick":{actions:[z(({event:e,context:t})=>!hl(e.edge.id)||e.edge.id===t.activeWalkthrough?.stepId?{}:{activeWalkthrough:{stepId:e.edge.id,parallelPrefix:ua(e.edge.id)}}),$t(),ho(),jr(),pl()]},"notations.unhighlight":{actions:$t()},"tag.unhighlight":{actions:$t()},"update.view":{guard:"is same view",actions:[Sr(),$t()]},"walkthrough.end":{target:le.idle},"xyflow.paneDblClick":{target:le.idle}}}),Vv=M.createStateConfig({initial:"idle",entry:[kl("mediaPrintActorLogic",{id:"mediaPrint"}),Ta(),dl(),cl()],exit:[it(),Ft("mediaPrint"),jv(),kv(),gu()],states:{idle:Lv,focused:Bv,walkthrough:$v,printing:Tv},on:{"navigate.*":{actions:Nv()},"layout.align":{guard:"not readonly",actions:[Aa("node"),yv(),za(!0)]},"layout.resetEdgeControlPoints":{guard:"not readonly",actions:[Aa("edge"),xv(),za(!0)]},"layout.resetManualLayout":{guard:"not readonly",actions:[hu(),lu(),pu({op:"reset-manual-layout"})]},"xyflow.resized":{guard:({context:e})=>e.features.enableFitView&&!e.viewportChangedManually,actions:[it(),sa({delay:200})]},"open.elementDetails":{actions:$a()},"open.relationshipsBrowser":{actions:$a()},"open.relationshipDetails":{actions:$a()},"open.source":{guard:"enabled: OpenSource",actions:uu()},"walkthrough.start":{guard:"is dynamic view",target:le.walkthrough},"toggle.feature":{actions:[vv(),Ta()]},"update.features":{actions:[du(),dl(),cl(),Ta()]},"xyflow.nodeMouseEnter":{actions:gv()},"xyflow.nodeMouseLeave":{actions:hv()},"xyflow.edgeMouseEnter":{actions:Sv()},"xyflow.edgeMouseLeave":{actions:_v()},"xyflow.edgeDoubleClick":{guard:uo(["not readonly",({event:e})=>!!e.edge.data.controlPoints&&e.edge.data.controlPoints.length>0]),actions:[Aa("edge"),cv(),za(!0)]},"notations.highlight":{actions:bv()},"notations.unhighlight":{actions:Mn()},"tag.highlight":{actions:wv()},"tag.unhighlight":{actions:Mn()},"open.search":{guard:"enabled: Search",actions:vi(({system:e})=>J(e).searchActorRef,({event:e})=>({type:"open",search:e.search}))},"xyflow.paneClick":{actions:[Xt(),kr()]},"xyflow.nodeClick":{actions:[kt(),jt()]},"xyflow.edgeClick":{actions:[Xt(),jr()]},"xyflow.fitDiagram":{guard:"enabled: FitView",actions:ra()},"xyflow.setViewport":{actions:vo()},"update.view":[{guard:"is another view",target:le.navigating},{actions:Sr()}],"media.print.on":{target:le.printing}}}),Va="likec4:diagram:toggledFeatures",yu={read(){try{let e=sessionStorage.getItem(Va);return e?JSON.parse(e):null}catch(e){return console.error(`Error reading fromStorage ${Va}:`,e),null}},write(e){return sessionStorage.setItem(Va,JSON.stringify(xo(e,Kp))),e}},Fv=M.createMachine({initial:"initializing",context:({input:e})=>({...e,xyedges:[],xynodes:[],features:{...wd},toggledFeatures:yu.read()??{enableReadOnly:!0,enableCompareWithLatest:!1},initialized:{xydata:!1,xyflow:!1},viewportChangedManually:!1,lastOnNavigate:null,lastClickedNode:null,focusedNode:null,autoUnfocusTimer:!1,activeElementDetails:null,viewportBefore:null,viewportOnManualLayout:null,viewportOnAutoLayout:null,navigationHistory:{currentIndex:0,history:[]},viewport:{x:0,y:0,zoom:1},xyflow:null,dynamicViewVariant:e.dynamicViewVariant??(e.view._type==="dynamic"?e.view.variant:"diagram")??"diagram",activeWalkthrough:null}),states:{initializing:Ev,isReady:Iv,ready:Vv,navigating:Dv,final:{type:"final",entry:[gu(),it(),Ft("hotkey"),Ft("overlays"),Ft("search"),Ft("mediaPrint"),z({xyflow:null,xystore:null,xyedges:[],xynodes:[],initialized:{xydata:!1,xyflow:!1}})]}},on:{"update.nodeData":{actions:z(Qw)},"update.edgeData":{actions:z(Jw)},"switch.dynamicViewVariant":{guard:({context:e,event:t})=>e.dynamicViewVariant!==t.variant,actions:[pv(),dv()]},"update.inputs":{actions:uv()},"update.view-bounds":{actions:z(({context:e,event:t})=>({view:{...e.view,bounds:t.bounds}}))},"update.features":{actions:du()},"trigger.change":{actions:pu()},"emit.onLayoutTypeChange":{actions:fv()},"xyflow.applyNodeChanges":{actions:z({xynodes:({context:e,event:t})=>Ei(t.changes,e.xynodes)})},"xyflow.applyEdgeChanges":{actions:z({xyedges:({context:e,event:t})=>Ni(t.changes,e.xyedges)})},"xyflow.viewportMoved":{actions:z(({event:e,context:t})=>({viewportChangedManually:t.viewportChangedManually||e.manually,viewport:e.viewport}))},destroy:{target:".final"}}}),Wv=Fv;function Ov({view:e,zoomable:t,pannable:o,nodesDraggable:a,nodesSelectable:i,fitViewPadding:r,where:s,children:l,dynamicViewVariant:d}){const u=Ln(),c=Uw(e.id),p=_i(Wv.provide({actors:{editorActor:c}}),{id:"diagram",systemId:"diagram",input:{xystore:u,view:e,zoomable:t,pannable:o,fitViewPadding:r,nodesDraggable:a,nodesSelectable:i,where:s,dynamicViewVariant:d}}),g=h.useRef(p);g.current!==p&&(console.warn("DiagramMachine actor instance changed",{context:{previous:g.current.getSnapshot().context,current:p.getSnapshot().context}}),g.current=p);const[m,y]=h.useState(()=>il(g));h.useEffect(()=>{y(C=>C.ref===g?C:(console.warn("DiagramMachine actorRef changed, creating new DiagramApi instance, this should not happen during the lifetime of the actor"),il(g)))},[g]);const w=Z();return h.useEffect(()=>p.send({type:"update.features",features:w}),[w,p]),h.useEffect(()=>p.send({type:"update.inputs",inputs:{zoomable:t,where:s,pannable:o,fitViewPadding:r,nodesDraggable:a,nodesSelectable:i}}),[t,s,o,r,p,a,i]),ht(()=>{d&&p.send({type:"switch.dynamicViewVariant",variant:d})},[d,p]),Rl(()=>p.send({type:"update.view",view:e,source:"external"}),[p,e]),n.jsx(pf,{value:p,children:n.jsxs(gf,{value:m,children:[n.jsx(Ki,{children:n.jsx(qv,{actorRef:p,children:l})}),n.jsx(Yv,{})]})})}const Hv=({context:e})=>{let t=e.toggledFeatures;const o=e.view.drifts!=null&&e.view.drifts.length>0,a=e.features.enableCompareWithLatest&&(t.enableCompareWithLatest??!1)&&jo(e.activeWalkthrough)&&o,i=e.features.enableReadOnly||t.enableReadOnly||!!e.activeWalkthrough||e.dynamicViewVariant==="sequence"&&e.view._type==="dynamic"||a&&e.view._layout==="auto";return(t.enableReadOnly!==i||t.enableCompareWithLatest!==a)&&(t={...t,enableCompareWithLatest:a,enableReadOnly:i}),{toggledFeatures:t,viewId:e.view.id}},Xv=(e,t)=>e.viewId===t.viewId&&oe(e.toggledFeatures,t.toggledFeatures);function qv({children:e,actorRef:t}){const{viewId:o,toggledFeatures:a}=re(t,Hv,Xv),i=Se().findView(o);return n.jsx(Gi.Provider,{value:i,children:n.jsx(Mt,{overrides:a,children:e})})}const Yv=h.memo(()=>{const e=H(),{onNavigateTo:t,onOpenSource:o,onLayoutTypeChange:a,handlersRef:i}=to();Ne("openSource",({params:s})=>o?.(s)),Ne("navigateTo",({viewId:s})=>t?.(s)),Ne("onLayoutTypeChange",({layoutType:s})=>{a?.(s)}),Ne("initialized",({instance:s})=>{try{i.current.onInitialized?.({diagram:e,xyflow:s})}catch(l){console.error(l)}},{once:!0});const r=ze(s=>s.toggledFeatures,oe);return ht(()=>{yu.write(Qp(r,jo))},[r]),null}),Gv=e=>`[data-mantine-color-scheme="${e}"]`,xu=Gv("dark"),Zv=5,Uv=(e,t,o,a)=>{const i=l=>zr($r(l,{l:-22-5*a,s:-10-6*a})),r=l=>zr($r(l,{l:-20-3*a,s:-3-6*a})),s=`:where(${e} [data-likec4-color="${t}"][data-compound-depth="${a}"])`;return`
${s} {
  --likec4-palette-fill: ${r(o.elements.fill)};
  --likec4-palette-stroke: ${r(o.elements.stroke)};
}
${xu} ${s} {
  --likec4-palette-fill: ${i(o.elements.fill)};
  --likec4-palette-stroke: ${i(o.elements.stroke)};
}
  `.trim()};function Kv(e,t,o){const{elements:a,relationships:i}=o,r=`:where(${e} [data-likec4-color=${t}])`;return[`
${r} {
  --likec4-palette-fill: ${a.fill};
  --likec4-palette-stroke: ${a.stroke};
  --likec4-palette-hiContrast: ${a.hiContrast};
  --likec4-palette-loContrast: ${a.loContrast};
  --likec4-palette-relation-stroke: ${i.line};
  --likec4-palette-relation-label: ${i.label};
  --likec4-palette-relation-label-bg: ${i.labelBg};
  --likec4-palette-relation-stroke-selected: ${Lr(Tr(i.line,"black",85))};
}
${xu} ${r} {
  --likec4-palette-relation-stroke-selected: ${Lr(Tr(i.line,"white",70))};
}

  `.trim(),..._p(1,Zv+1).map(s=>Uv(e,t,o,s))].join(`
`)}function Qv(e,t){return se(t.colors,zn(),ie(([o,a])=>Kv(e,o,a)),Fl(`
`))}const Jv=h.memo(({id:e})=>{const t=`#${e}`,o=wi()?.(),{theme:a}=vc(),i=Qv(t,a);return n.jsx("style",{type:"text/css","data-likec4-colors":e,dangerouslySetInnerHTML:{__html:i},nonce:o})});function ek({onCanvasClick:e,onCanvasContextMenu:t,onCanvasDblClick:o,onEdgeClick:a,onEdgeContextMenu:i,onNavigateTo:r,onNodeClick:s,onNodeContextMenu:l,onOpenSource:d,onBurgerMenuClick:u,onLayoutTypeChange:c,onInitialized:p,view:g,className:m,controls:y=!0,fitView:w=!0,fitViewPadding:C=y?Jr.withControls:Jr.default,pannable:b=!0,zoomable:v=!0,background:j="dots",enableElementTags:f=!1,enableFocusMode:k=!1,enableElementDetails:S=!1,enableRelationshipDetails:E=!1,enableRelationshipBrowser:B=!1,enableCompareWithLatest:_=!!c,nodesSelectable:Y,enableNotations:F=!1,showNavigationButtons:$=!!r,enableDynamicViewWalkthrough:N=!1,dynamicViewVariant:V,enableSearch:R=!1,initialWidth:K,initialHeight:_e,reduceGraphics:Pe="auto",renderIcon:Dt,where:ke,reactFlowProps:la,renderNodes:X,children:Ie}){const da=Qm(),ca=h.useRef(null),Fo=!!Cd(),bu=!Fo;Y??=Fo||k||!!r||!!s;const Wo=Sf(g,V),_r=tk(C);ca.current==null&&(ca.current={defaultEdges:[],defaultNodes:[],initialWidth:K??Wo.width,initialHeight:_e??Wo.height,initialFitViewOptions:{maxZoom:oi,minZoom:Ae,padding:_r},initialMaxZoom:oi,initialMinZoom:Ae});const Pr=Pe==="auto"?b&&(Wo.width??1)*(Wo.height??1)>6e6&&g.nodes.some(wu=>wu.children?.length>0):Pe;return n.jsx(vd,{children:n.jsx(Hm,{...Pr&&{reducedMotion:"always"},children:n.jsx(fm,{value:Dt??null,children:n.jsx(Mt,{features:{enableFitView:w,enableEditor:Fo,enableReadOnly:bu,enableFocusMode:k,enableNavigateTo:!!r,enableElementDetails:S,enableRelationshipDetails:E,enableRelationshipBrowser:B,enableSearch:R,enableNavigationButtons:$&&!!r,enableDynamicViewWalkthrough:g._type==="dynamic"&&N,enableNotations:F,enableVscode:!!d,enableControls:y,enableElementTags:f,enableCompareWithLatest:_&&!!c},children:n.jsxs(Vm,{handlers:{onCanvasClick:e,onCanvasContextMenu:t,onCanvasDblClick:o,onEdgeClick:a,onEdgeContextMenu:i,onNavigateTo:r,onNodeClick:s,onNodeContextMenu:l,onOpenSource:d,onBurgerMenuClick:u,onInitialized:p,onLayoutTypeChange:c},children:[n.jsx(Jv,{id:da}),n.jsx(Zm,{rootSelector:`#${da}`,children:n.jsx($m,{id:da,className:m,reduceGraphics:Pr,children:n.jsx(Di,{fitView:w,...ca.current,children:n.jsxs(Ov,{view:g,zoomable:v,pannable:b,fitViewPadding:_r,nodesDraggable:Fo,nodesSelectable:Y,where:ke??null,dynamicViewVariant:V,children:[n.jsx(Ww,{background:j,reactFlowProps:la,renderNodes:X,children:Ie}),n.jsx(Qc,{})]})})})})]})})})})})}const gl=e=>typeof e=="number"?`${e}px`:e;function tk(e){return Ul(()=>{if(Jp(e))return eg(e,gl);const t=gl(e);return{x:t,y:t}},[e],I)}function uk({children:e,likec4model:t}){return n.jsx(Hn.Provider,{value:t,children:e})}function pk({children:e,projects:t,onProjectChange:o}){h.useContext(jn)&&console.warn("LikeC4ProjectsProvider should not be nested inside another one");const a=D(o),[i,r]=h.useState(()=>({projects:t,onProjectChange:a}));return h.useEffect(()=>{r(s=>I(s.projects,t)?s:{projects:t,onProjectChange:a})},[t]),n.jsx(jn.Provider,{value:i,children:e})}function gk({view:e,fitView:t=!0,fitViewPadding:o="8px",enableRelationshipDetails:a=!1,enableRelationshipBrowser:i=a,background:r="transparent",className:s,...l}){return n.jsx(ek,{view:e,className:P(s,"likec4-static-view"),fitView:t,fitViewPadding:o,pannable:!1,zoomable:!1,controls:!1,background:r,enableNotations:!1,enableElementDetails:!1,enableRelationshipDetails:a,enableRelationshipBrowser:i,enableDynamicViewWalkthrough:!1,showNavigationButtons:!1,enableCompareWithLatest:!1,enableFocusMode:!1,enableSearch:!1,nodesSelectable:!1,enableElementTags:!1,...l})}export{U as B,Hg as I,pk as L,Nt as M,gk as S,mm as a,sk as b,x as c,zi as d,ht as e,fm as f,uk as g,Wi as h,Ih as i,rk as j,lk as k,ek as l,Se as m,dk as n,ak as o,Sf as p,ik as q,im as r,ud as s,ze as t,ck as u,dd as v,th as w,ld as x};
